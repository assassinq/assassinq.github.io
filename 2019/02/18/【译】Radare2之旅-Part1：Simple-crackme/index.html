<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>ã€è¯‘ã€‘Radare2ä¹‹æ—…-Part1ï¼šSimple crackme | AssassinQ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="retranslation">
  
  
  
  
  <meta name="description" content="ç¿»è¯‘è‡ªMegabeetsã€‚">
<meta name="keywords" content="re,translation">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€è¯‘ã€‘Radare2ä¹‹æ—…-Part1ï¼šSimple crackme">
<meta property="og:url" content="https://qianfei11.github.io/2019/02/18/ã€è¯‘ã€‘Radare2ä¹‹æ—…-Part1ï¼šSimple-crackme/index.html">
<meta property="og:site_name" content="AssassinQ">
<meta property="og:description" content="ç¿»è¯‘è‡ªMegabeetsã€‚">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://www.megabeets.net/uploads/r2_part1_1.png">
<meta property="og:image" content="https://www.megabeets.net/uploads/r2_learning_curve.png">
<meta property="og:image" content="https://www.megabeets.net/uploads/visualMode_1.png">
<meta property="og:image" content="https://www.megabeets.net/uploads/visualGraph_1.png">
<meta property="og:image" content="https://www.megabeets.net/uploads/visualGraph_beet1.png">
<meta property="og:image" content="https://www.megabeets.net/uploads/visualGraph_beet2.png">
<meta property="og:updated_time" content="2019-08-26T01:13:50.215Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ã€è¯‘ã€‘Radare2ä¹‹æ—…-Part1ï¼šSimple crackme">
<meta name="twitter:description" content="ç¿»è¯‘è‡ªMegabeetsã€‚">
<meta name="twitter:image" content="https://www.megabeets.net/uploads/r2_part1_1.png">
  
    <link rel="alternate" href="/atom.xml" title="AssassinQ" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css">
  <link rel="stylesheet" href="/css/fashion.css">
  <link rel="stylesheet" href="/css/glyphs.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>
</html>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-header-image">
    <img id="originBg" width="100%" alt="Hike News" src>
  </div>

  <div id="header-blur" class="site-header-image blur" style="position: absolute; top:0; height: 207px; min-height: 207px; min-width: 100%;">
    <img id="blurBg" width="100%" style="top: 96%" alt="Hike News" src>
  </div>

  <script>
        var imgUrls = "css/images/pose01.jpg".split(",");
        var random = Math.floor((Math.random() * imgUrls.length ));
        if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
          document.getElementById("originBg").src=imgUrls[random];
          document.getElementById("blurBg").src=imgUrls[random];
        } else {
          document.getElementById("originBg").src='/' + imgUrls[random];
          document.getElementById("blurBg").src='/' + imgUrls[random];
        }
    </script>




<header id="allheader" class="site-header" role="banner" style="width: 100%; position: absolute; top:0; background: rgba(255,255,255,.8);">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="AssassinQ" rel="home"> AssassinQ </a>
            
          </h1>
          
          
            <div class="site-description">ZJGSU-IS-17</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows" style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/tags">Tags</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/about">About</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-ã€è¯‘ã€‘Radare2ä¹‹æ—…-Part1ï¼šSimple-crackme" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      ã€è¯‘ã€‘Radare2ä¹‹æ—…-Part1ï¼šSimple crackme
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/02/18/ã€è¯‘ã€‘Radare2ä¹‹æ—…-Part1ï¼šSimple-crackme/" class="article-date">
	  <time datetime="2019-02-18T04:17:27.000Z" itemprop="datePublished">February 18, 2019</time>
	</a>

       
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>ç¿»è¯‘è‡ª<a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/" target="_blank" rel="noopener">Megabeets</a>ã€‚</p>
<a id="more"></a>
<h1 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h1><p>è¿‡å»ä¸€å¹´é‡Œçš„ CTF æ¯”èµ›ä¸­ï¼Œä¸è®ºæ˜¯é€†å‘å·¥ç¨‹ï¼ˆREï¼‰è¿˜æ˜¯æ¼æ´æŒ–æ˜ï¼ˆPWNï¼‰ï¼Œæˆ‘ä¸€ç›´åœ¨ç”¨<code>radare2</code>ã€‚æˆ‘å‘ç°<code>radare2</code>å¯¹äºå¾ˆå¤š CTF çš„é¢˜ç›®æ¥è¯´éƒ½å¾ˆæœ‰ç”¨ï¼Œæå¤§åœ°ç¼©çŸ­äº†æˆ‘çš„åšé¢˜æ—¶é—´ã€‚é—æ†¾çš„æ˜¯ç†Ÿæ‚‰ radare2 çš„äººå¤ªå°‘äº†ã€‚å¯èƒ½å¤§å®¶éƒ½ä¹ æƒ¯äº†ä½¿ç”¨<code>IDA Pro</code>ã€<code>OllyDBG</code>è¿˜æœ‰<code>gdb</code>ï¼Œæˆ–è€…æ²¡æœ‰å¬è¯´è¿‡å®ƒã€‚ä¸ç®¡æ€ä¹ˆæ ·ï¼Œæˆ‘éƒ½è®¤ä¸º<code>radare2</code>åº”è¯¥æˆä¸ºä½ å·¥å…·ç®±ä¸­çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p>å› ä¸ºæˆ‘çœŸçš„ç‰¹åˆ«å–œæ¬¢è¿™ä¸ªé¡¹ç›®ï¼Œè€Œä¸”æˆ‘å¸Œæœ›èƒ½æœ‰è¶Šæ¥è¶Šå¤šçš„äººå¼€å§‹ç†Ÿæ‚‰å®ƒã€ä½¿ç”¨å®ƒï¼Œèƒ½å¯¹é¡¹ç›®åšå‡ºä¸€äº›è´¡çŒ®ã€‚æˆ‘è®¡åˆ’å†™ä¸€ç³»åˆ—çš„æ–‡ç« ä»¥åŠä½¿ç”¨<code>r2</code>çš„ä¾‹å­ã€‚å› ä¸ºé‚£äº›æ–‡ç« éƒ½æ¶‰åŠ<code>radare2</code>çš„ç‰¹ç‚¹å’ŒåŠŸèƒ½ï¼Œæˆ‘ä¼šè§£é‡Šçš„æ›´åŠ è¯¦ç»†ã€‚</p>
<p><img src="https://www.megabeets.net/uploads/r2_part1_1.png" alt="Welcome to IDA 10.0. ï¼ˆåœ¨ radare2/doc/fortunes.fun æŸ¥çœ‹æ›´å¤šï¼‰"></p>
<h1 id="radare2"><a href="#radare2" class="headerlink" title="radare2"></a><code>radare2</code></h1><p><code>radare2</code>æ˜¯ä¸€ä¸ªé€†å‘å·¥ç¨‹å’ŒäºŒè¿›åˆ¶åˆ†æçš„å¼€æºæ¡†æ¶ï¼Œå®ƒæœ‰å¾ˆå¤šå‘½ä»¤è¡Œæ¥å£ï¼ŒåŒ…æ‹¬åæ±‡ç¼–ã€åˆ†ææ•°æ®ã€æ‰“è¡¥ä¸ã€æ¯”è¾ƒæ•°æ®ã€æŸ¥æ‰¾ã€æ›¿æ¢ã€å¯è§†åŒ–ç­‰ç­‰åŠŸèƒ½ã€‚åŒæ—¶å®ƒå¯ä»¥åœ¨å‡ ä¹æ‰€æœ‰çš„ä¸»è¦æ“ä½œç³»ç»Ÿï¼ˆ<code>GNU/Linux</code>ã€<code>.Windows</code>ã€<code>*BSD</code>ã€<code>iOS</code>ã€<code>OSX</code>ã€<code>Solaris</code>ç­‰ç­‰ï¼‰ä¸Šè¿è¡Œï¼Œå¹¶ä¸”æ”¯æŒè®¸å¤š CPU æ¶æ„å’Œæ–‡ä»¶æ ¼å¼ã€‚ä»–æ‰€æœ‰çš„ç‰¹ç‚¹å¯ä»¥å±•ç°å‡ºä¸€ä¸ªæ€æƒ³â€”â€”<code>radare2</code>æ˜¯ç»å¯¹è‡ªç”±çš„ã€‚</p>
<p>è¯¥æ¡†æ¶æ˜¯ä¸€ä¸ªå·¥å…·çš„é›†åˆï¼Œæ—¢å¯ä»¥åœ¨<code>r2</code>ç»™å‡ºçš„ shell ä¸‹ä½¿ç”¨ï¼Œåˆå¯ä»¥ç‹¬ç«‹ä½¿ç”¨â€”â€”æ¯”å¦‚æˆ‘ä»¬å°†è¦äº†è§£çš„<code>rahash2</code>ã€<code>rabin2</code>ã€<code>ragg2</code>ä¸‰ä¸ªç»„ä»¶ã€‚æ‰€æœ‰çš„ç»„ä»¶èµ‹äºˆäº†<code>radare2</code>å¼ºå¤§çš„é™æ€æˆ–åŠ¨æ€åˆ†æã€åå…­è¿›åˆ¶ç¼–è¾‘ä»¥åŠæ¼æ´æŒ–æ˜èƒ½åŠ›ï¼ˆåœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­æˆ‘ä¼šæ›´æ·±å…¥åœ°è®²è¿°ï¼‰ã€‚</p>
<p>æˆ‘ä»¬å¿…é¡»æ„è¯†åˆ°å­¦ä¹ <code>r2</code>æ˜¯ä¸€ä¸ªååˆ†è‰°éš¾çš„è¿‡ç¨‹â€”â€”è™½ç„¶<code>r2</code>æœ‰ GUI å’Œ WebUIã€‚åœ¨æˆ‘çœ‹æ¥ï¼ŒIDA çš„ GUI å’Œæ–¹ä¾¿æ€§ç¡®å®æ›´ä½³ã€‚ä½†æ˜¯å®ƒçš„å‘½ä»¤è¡Œæ¥å£ï¼ŒåŒ…æ‹¬å…¶å¯è§†åŒ–æ¨¡å¼ï¼Œä»ç„¶æ˜¯<code>radare2</code>çš„æ ¸å¿ƒä»¥åŠé­…åŠ›æ‰€åœ¨ã€‚å› ä¸ºå®ƒçš„å¤æ‚æ€§ï¼Œæˆ‘ä¼šå°½åŠ›è®²å¾—æµ…æ˜¾æ˜“æ‡‚ã€‚</p>
<p><img src="https://www.megabeets.net/uploads/r2_learning_curve.png" alt="è¿™å·®ä¸å¤šæ˜¯r2çš„å­¦ä¹ æ›²çº¿"></p>
<p>åœ¨å¼€å§‹ä¹‹å‰ï¼Œä½ å¯ä»¥çœ‹ä¸€çœ‹<a href="https://www.radare.org/r/cmp.html" target="_blank" rel="noopener">â€œr2ã€IDA Pro å’Œ Hopper ç­‰å·¥å…·é—´çš„æ¯”è¾ƒâ€</a>æ¥äº†è§£å®ƒã€‚</p>
<h1 id="è·å–radare2"><a href="#è·å–radare2" class="headerlink" title="è·å–radare2"></a>è·å–<code>radare2</code></h1><h2 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h2><p><code>radare2</code>çš„ç¯å¢ƒé…ç½®éå¸¸å¿«â€”â€”æˆ‘ä»¬æ¯å¤©éƒ½ä¼šæ›´æ–°ï¼Œæ‰€ä»¥æ›´æ¨èä½ å»ä½¿ç”¨ git çš„ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯ç¨³å®šç‰ˆæœ¬ã€‚æœ‰æ—¶å€™ç¨³å®šç‰ˆæœ¬å¯èƒ½æ²¡æœ‰ git ç‰ˆæœ¬æ›´ç¨³å®šã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> git <span class="built_in">clone</span> https://github.com/radare/radare2.git</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> <span class="built_in">cd</span> radare2</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> ./sys/install.sh</span></span><br></pre></td></tr></table></figure>
<p>å¦‚æœä½ ä¸æƒ³ä¸‹è½½ git ç‰ˆæœ¬æˆ–è€…ä½ æƒ³è¦ä¸åŒæ“ä½œç³»ç»Ÿï¼ˆ<code>Windows</code>ã€<code>OS X</code>ã€<code>iOS</code>ç­‰ç­‰ï¼‰ä¸Šçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¯ä»¥åœ¨<a href="https://www.radare.org/r/down.html" target="_blank" rel="noopener">radare2 å®˜ç½‘ä¸‹è½½ç•Œé¢</a>æŸ¥çœ‹ã€‚</p>
<h2 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h2><p>æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œæ›´æ¨èå¤§å®¶ä½¿ç”¨ git ä»“åº“é‡Œæœ€æ–°ç‰ˆçš„<code>r2</code>ã€‚ä» git æ›´æ–°<code>r2</code>åªéœ€è¦æ‰§è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ./sys/install.sh</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åä½ å°±èƒ½ä» git è·å¾—æœ€æ–°çš„ç‰ˆæœ¬ã€‚æˆ‘é€šå¸¸æ¯å¤©æ—©ä¸Šä¼šæ›´æ–°ä¸€ä¸‹<code>radare2</code>ï¼Œåœ¨è¿™æœŸé—´å¯ä»¥çœ‹çœ‹ä¸€ä¼šå„¿è§†é¢‘æ¶ˆé£ã€‚</p>
<h2 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h2><p>æˆ‘å®åœ¨æƒ³ä¸å‡ºä»€ä¹ˆç†ç”±ä¼šè®©ä½ åœ¨çœ‹è¿™ç¯‡æ–‡ç« æ—¶æƒ³è¦å¸è½½<code>radare2</code>ã€‚å¦‚æœè¦å¸è½½çš„è¯åªéœ€è¦æ‰§è¡Œï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> make uninstall</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> make purge</span></span><br></pre></td></tr></table></figure>
<h1 id="å¼€å§‹å­¦ä¹ "><a href="#å¼€å§‹å­¦ä¹ " class="headerlink" title="å¼€å§‹å­¦ä¹ "></a>å¼€å§‹å­¦ä¹ </h1><p>ä½ å¯ä»¥åœ¨<a href="https://github.com/ITAYC0HEN/A-journey-into-Radare2/blob/master/Part%201%20-%20Simple%20crackme/megabeets_0x1" target="_blank" rel="noopener">è¿™é‡Œ</a>ä¸‹è½½ Crackmeã€‚</p>
<p>ç°åœ¨ä½ å·²ç»åœ¨è‡ªå·±çš„ç³»ç»Ÿä¸Šä¸‹è½½äº†<code>radare2</code>å’Œæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹æ¢ç´¢<code>radare2</code>çš„åŸºç¡€ä½¿ç”¨ã€‚æˆ‘ä¼šåœ¨<a href="https://remnux.org/" target="_blank" rel="noopener">REMunx</a>ä¸Šè°ƒè¯•ï¼Œå¤§éƒ¨åˆ†çš„å‘½ä»¤å’Œè¯´æ˜è·Ÿ<code>Windows</code>æˆ–è€…å…¶ä»–ç³»ç»Ÿä¸Šæ˜¯ä¸€æ ·çš„ã€‚</p>
<h2 id="å‘½ä»¤è¡Œå‚æ•°"><a href="#å‘½ä»¤è¡Œå‚æ•°" class="headerlink" title="å‘½ä»¤è¡Œå‚æ•°"></a>å‘½ä»¤è¡Œå‚æ•°</h2><p>å’Œå¤§éƒ¨åˆ†å‘½ä»¤è¡Œå·¥å…·ä¸€æ ·ï¼ŒæŸ¥çœ‹å¯é€‰å‚æ•°çš„æ–¹å¼æ˜¯æ‰§è¡Œ<code>-h</code>å‚æ•°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> r2 -h</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä¸æŠŠå®Œæ•´çš„è¾“å‡ºæ”¾ä¸Šæ¥ï¼Œè€Œæ˜¯æ”¾ä¸€äº›æˆ‘æ—¥å¸¸å·¥ä½œä¸­å¸¸ç”¨çš„å‚æ•°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Usage: r2 [-ACdfLMnNqStuvwz] [-P patch] [-p prj] [-a arch] [-b bits] [-i file]</span><br><span class="line">          [-s addr] [-B baddr] [-M maddr] [-c cmd] [-e k=v] file|pid|-|--|=</span><br><span class="line"></span><br><span class="line">-d: Debug the executable 'file' or running process 'pid'</span><br><span class="line">-A: Analyze executable at load time (xrefs, etc)</span><br><span class="line">-q: Quiet mode, exit after processing commands</span><br><span class="line">-w: Write mode enabled</span><br><span class="line">-L: List of supported IO plugins</span><br><span class="line">-i [file]: Interprets a r2 script</span><br><span class="line">-n: Bare load. Do not load executable info as the entrypoint</span><br><span class="line">-c 'command; command; ...': Run r2 and execute commands (eg: r2 's main; px 60')</span><br><span class="line">-p [prj]: Creates a project for the file being analyzed</span><br><span class="line">-: Opens r2 with the malloc plugin that gives a 512 bytes memory area to play with</span><br></pre></td></tr></table></figure>
<h2 id="äºŒè¿›åˆ¶ä¿¡æ¯"><a href="#äºŒè¿›åˆ¶ä¿¡æ¯" class="headerlink" title="äºŒè¿›åˆ¶ä¿¡æ¯"></a>äºŒè¿›åˆ¶ä¿¡æ¯</h2><p>é¢å¯¹ä¸€ä¸ªæ–°çš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ç¬¬ä¸€ä»¶æƒ³åšçš„äº‹å°±æ˜¯è·å–æ–‡ä»¶çš„ä¿¡æ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>r2</code>æ¡†æ¶ä¸­æœ€å¼ºå¤§çš„å·¥å…·ä¹‹ä¸€â€”â€”<code>rabin2</code>æ¥è·å–ä¿¡æ¯ã€‚</p>
<blockquote>
<ul>
<li><p><code>rabin2</code>å¯ä»¥ä»äºŒè¿›åˆ¶æ–‡ä»¶ä¸­è·å–ä¿¡æ¯ï¼ŒåŒ…æ‹¬åŒºæ®µã€æ–‡ä»¶å¤´ã€å¯¼å…¥å¯¼å‡ºè¡¨ã€å­—ç¬¦ä¸²ã€å…¥å£ç‚¹ç­‰ç­‰ã€‚åŒæ—¶å…·æœ‰ä¸åŒçš„æ ¼å¼çš„è¾“å‡ºã€‚<code>rabin2</code>æ”¯æŒ<code>ELF</code>ã€<code>PE</code>ã€<code>Mach-O</code>ã€<code>Java CLASS</code>ç­‰æ–‡ä»¶ã€‚</p>
</li>
<li><p>ä½¿ç”¨<code>man rabin2</code>æŸ¥çœ‹æ›´å¤šçš„ä¿¡æ¯ã€‚</p>
</li>
</ul>
</blockquote>
<p>æˆ‘ä»¬æ‰§è¡Œ<code>rabin2</code>å¹¶ä½¿ç”¨å‚æ•°<code>-I</code>è¾“å‡ºäºŒè¿›åˆ¶ä¿¡æ¯ï¼Œä¾‹å¦‚æ“ä½œç³»ç»Ÿã€è¯­è¨€ã€å­—èŠ‚åºã€æ¡†æ¶ä»¥åŠä¿æŠ¤æŠ€æœ¯ï¼ˆæ¯”å¦‚<code>Canary</code>ã€<code>PIC</code>ã€<code>NX</code>ï¼‰ç­‰ç­‰ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> rabin2 -I megabeets_0x1</span></span><br><span class="line">havecode true</span><br><span class="line">pic      false</span><br><span class="line">canary   false</span><br><span class="line">nx       false</span><br><span class="line">crypto   false</span><br><span class="line">va       true</span><br><span class="line">intrp    /lib/ld-linux.so.2</span><br><span class="line">bintype  elf</span><br><span class="line">class    ELF32</span><br><span class="line">lang     c</span><br><span class="line">arch     x86</span><br><span class="line">bits     32</span><br><span class="line">machine  Intel 80386</span><br><span class="line">os       linux</span><br><span class="line">minopsz  1</span><br><span class="line">maxopsz  16</span><br><span class="line">pcalign  0</span><br><span class="line">subsys   linux</span><br><span class="line">endian   little</span><br><span class="line">stripped false</span><br><span class="line">static   false</span><br><span class="line">linenum  true</span><br><span class="line">lsyms    true</span><br><span class="line">relocs   true</span><br><span class="line">rpath    NONE</span><br><span class="line">binsz    6220</span><br></pre></td></tr></table></figure>
<p>ä½ å¯ä»¥æ¸…æ¥šåœ°çœ‹åˆ°ï¼Œè¿™æ˜¯ä¸€ä¸ª 32 ä½ elf æ–‡ä»¶ï¼Œæ²¡æœ‰ç¬¦å·è¡¨å¹¶ä¸”æ˜¯åŠ¨æ€é“¾æ¥ã€‚å®ƒæ²¡æœ‰ä»»ä½•æ¼æ´åˆ©ç”¨æŠ€æœ¯â€”â€”ä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬è®²å­¦ä¹ ä½¿ç”¨<code>radare2</code>æ¥å¯¹æ¼æ´è¿›è¡Œåˆ©ç”¨ã€‚<br>è®©æˆ‘ä»¬è·‘ä¸€ä¸‹ç¨‹åºï¼Œçœ‹çœ‹å®ƒåšäº†ä»€ä¹ˆã€‚</p>
<blockquote>
<ul>
<li>æ³¨æ„ï¼šè™½ç„¶æˆ‘å¯ä»¥å‘ä½ ä¿è¯è¿™ä¸ªç¨‹åºæ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯é€†å‘ä¸€ä¸ªæœªçŸ¥çš„ç¨‹åºæ—¶ï¼ŒåŠ¡å¿…åœ¨ä¸€ä¸ªè™šæ‹Ÿç¯å¢ƒä¸‹è¿è¡Œã€‚</li>
<li>ä¸è¿‡ä½ å¯ä»¥ç›¸ä¿¡æˆ‘ï¼Œå› ä¸ºç¨‹åºç¡®å®æ˜¯å®‰å…¨çš„ã€‚ğŸ˜›</li>
</ul>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ./megabeets_0x1</span></span><br><span class="line"></span><br><span class="line">  .:: Megabeets ::.</span><br><span class="line">Think you can make it?</span><br><span class="line">Nop, Wrong argument.</span><br><span class="line"></span><br><span class="line"><span class="meta">$</span><span class="bash"> ./megabeets_0x1 abcdef</span></span><br><span class="line"></span><br><span class="line">  .:: Megabeets ::.</span><br><span class="line">Think you can make it?</span><br><span class="line">Nop, Wrong argument.</span><br></pre></td></tr></table></figure>
<p>ç¬¬ä¸€æ¬¡è·‘çš„æ—¶å€™ï¼Œè¾“å‡ºäº†<code>Nop, Wrong argument</code>ã€‚å‡è®¾æˆ‘ä»¬éœ€è¦æä¾›ä¸€ä¸ªå‚æ•°ï¼Œç¬¬äºŒæ¬¡è¾“å…¥<code>abcdef</code>ä½œä¸ºå‚æ•°ï¼Œä¾æ—§å¤±è´¥äº†ã€‚æ˜¾ç„¶éœ€è¦ç‰¹å®šçš„å­—ç¬¦ä¸²æ‰èƒ½ç»•è¿‡ã€‚</p>
<p>è®©æˆ‘ä»¬ç”¨<code>radare2</code>æ¥æµ‹è¯•ç¨‹åºï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> r2 ./megabeets_0x1</span></span><br><span class="line"> â€” Thank you for using radare2. Have a nice night!</span><br><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"></span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª<code>radare2</code>çš„ shellï¼Œè¿˜æœ‰ä¸€ä¸ªæ¬¢è¿ç•Œé¢ã€‚æˆ‘ä»¬å¯ä»¥æ‰§è¡Œ<code>fo</code>æ¥è¾“å‡ºä¸€ä¸ªæ–°çš„å¥å­ï¼Œæœ‰äº›å¾ˆæç¬‘åŒæ—¶æœ‰äº›ä¹Ÿå¾ˆæœ‰è¶£ã€‚ç°åœ¨<code>r2</code>çš„ shell æ­£åœ¨ç­‰ç€æˆ‘ä»¬è¾“å…¥å‘½ä»¤ï¼Œå¹¶ä¸”å±•ç¤ºç»™æˆ‘ä»¬æ­¤åˆ»æ‰€åœ¨çš„åœ°å€ï¼ˆ0x08048370ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹æˆ‘ä»¬è‡ªåŠ¨åœ¨å…¥å£ç‚¹å¤„ã€‚è®©æˆ‘ä»¬çœ‹çœ‹æ˜¯å¦æ­£ç¡®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> ie</span></span><br><span class="line">[Entrypoints]</span><br><span class="line">vaddr=0x08048370 paddr=0x00000370 baddr=0x08048000 laddr=0x00000000 haddr=0x00000018 type=program1 entrypoints</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬ä½¿ç”¨<code>ie</code>å‘½ä»¤è¾“å‡ºäº†æ–‡ä»¶çš„å…¥å£ç‚¹åœ°å€ã€‚<code>r2</code>å‘½ä»¤æœ‰ä¸€ç³»åˆ—æœ‰æ„ä¹‰çš„å­—æ¯ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œ<code>ie</code>ä»£è¡¨äº†<code>info &gt;&gt; entrypoint</code>ã€‚å› æ­¤åœ¨ä½ ç†Ÿæ‚‰äº†<code>radare2</code>çš„èƒ½åŠ›ä¹‹åï¼Œå‘½ä»¤éƒ½æ˜¯æ¯”è¾ƒå¥½è®°çš„ã€‚ä½†æ˜¯ä½ ä¸éœ€è¦è®°ä½æ‰€æœ‰çš„å‘½ä»¤â€”â€”ä½ å¯ä»¥ä»…ä»…éœ€è¦åœ¨ï¼ˆå‡ ä¹ï¼‰æ¯ä¸ªå­—æ¯åé¢åŠ ä¸Š<code>?</code>æ¥è·å¾—å‘½ä»¤çš„ä¿¡æ¯ä»¥åŠå®ƒçš„å­å‘½ä»¤ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> i?</span></span><br><span class="line">|Usage: i Get info from opened file (see rabin2â€™s manpage)</span><br><span class="line">| Output mode:</span><br><span class="line">| â€˜*â€™                Output in radare commands</span><br><span class="line">| â€˜jâ€™                Output in json</span><br><span class="line">| â€˜qâ€™                Simple quiet output</span><br><span class="line">| Actions:</span><br><span class="line">| i|ij               Show info of current file (in JSON)</span><br><span class="line">| iA                 List archs</span><br><span class="line">| ia                 Show all info (imports, exports, sections..)</span><br><span class="line">| ib                 Reload the current buffer for setting of the bin (use once only)</span><br><span class="line">| ic                 List classes, methods and fields</span><br><span class="line">| iC                 Show signature info (entitlements, â€¦)</span><br><span class="line">| id                 Debug information (source lines)</span><br><span class="line">| iD lang sym        demangle symbolname for given language</span><br><span class="line">| ie                 Entrypoint</span><br><span class="line">| iE                 Exports (global symbols)</span><br><span class="line">| ih                 Headers (alias for iH)</span><br><span class="line">| iHH                Verbose Headers in raw text</span><br><span class="line">| ii                 Imports</span><br><span class="line">| iI                 Binary info</span><br><span class="line">| ik [query]         Key-value database from RBinObject</span><br><span class="line">| il                 Libraries</span><br><span class="line">| iL                 List all RBin plugins loaded</span><br><span class="line">| im                 Show info about predefined memory allocation</span><br><span class="line">| iM                 Show main address</span><br><span class="line">| io [file]          Load info from file (or last opened) use bin.baddr</span><br><span class="line">| ir|iR              Relocs</span><br><span class="line">| is                 Symbols</span><br><span class="line">| iS [entropy,sha1]  Sections (choose which hash algorithm to use)</span><br><span class="line">| iV                 Display file version info</span><br><span class="line">| iz                 Strings in data sections</span><br><span class="line">| izz                Search for Strings in the whole binary</span><br><span class="line">| iZ                 Guess size of binary program</span><br></pre></td></tr></table></figure>
<p><code>i</code>å‘½ä»¤ç›®çš„æ˜¯ä»æ‰“å¼€çš„æ–‡ä»¶ä¸­è·å–ä¿¡æ¯ï¼Œå®ƒå°±æ˜¯é›†æˆåˆ°<code>radare2</code>çš„ shell é‡Œçš„<code>rabin2</code>ï¼ˆä¹‹å‰æåˆ°çš„ï¼‰ã€‚</p>
<h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><p>é»˜è®¤æƒ…å†µä¸‹<code>radare2</code>ä¸ä¼šè‡ªåŠ¨åˆ†ææ–‡ä»¶ï¼Œå› ä¸ºåˆ†ææ–‡ä»¶æ˜¯ä¸€ä¸ªå¤æ‚çš„è¿‡ç¨‹ï¼Œå°¤å…¶æ˜¯æ¯”è¾ƒå¤§çš„æ–‡ä»¶ã€‚äº†è§£æ›´å¤šå…³äºåˆ†æçš„å†…å®¹ï¼Œä½ å¯ä»¥çœ‹ä¸€çœ‹åœ¨<code>radare2</code>åšå®¢ä¸Šçš„<a href="http://radare.today/posts/analysis-by-default/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ã€‚</p>
<p>æ˜¾ç„¶åˆ†æä»ç„¶æ˜¯å¯èƒ½çš„ï¼Œ<code>r2</code>æä¾›äº†è®¸å¤šç§ç±»çš„åˆ†ææ–¹å¼ã€‚æ­£å¦‚æˆ‘ä¹‹å‰æåˆ°çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å¯¹<code>a</code>å‘½ä»¤åé¢æ·»åŠ <code>?</code>æ¥æŸ¥æ‰¾åˆ†æé€‰é¡¹ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> a?</span></span><br><span class="line">|Usage: a[abdefFghoprxstc] [â€¦]</span><br><span class="line">| ab [hexpairs]    analyze bytes</span><br><span class="line">| abb [len]        analyze N basic blocks in [len] (section.size by default)</span><br><span class="line">| aa[?]            analyze all (fcns + bbs) (aa0 to avoid sub renaming)</span><br><span class="line">| ac[?] [cycles]   analyze which op could be executed in [cycles]</span><br><span class="line">| ad[?]            analyze data trampoline (wip)</span><br><span class="line">| ad [from] [to]   analyze data pointers to (from-to)</span><br><span class="line">| ae[?] [expr]     analyze opcode eval expression (see ao)</span><br><span class="line">| af[?]            analyze Functions</span><br><span class="line">| aF               same as above, but using anal.depth=1</span><br><span class="line">| ag[?] [options]  output Graphviz code</span><br><span class="line">| ah[?]            analysis hints (force opcode size, â€¦)</span><br><span class="line">| ai [addr]        address information (show perms, stack, heap, â€¦)</span><br><span class="line">| ao[?] [len]      analyze Opcodes (or emulate it)</span><br><span class="line">| aO               Analyze N instructions in M bytes</span><br><span class="line">| ar[?]            like â€˜drâ€™ but for the esil vm. (registers)</span><br><span class="line">| ap               find prelude for current offset</span><br><span class="line">| ax[?]            manage refs/xrefs (see also afx?)</span><br><span class="line">| as[?] [num]      analyze syscall using dbg.reg</span><br><span class="line">| at[?] [.]        analyze execution traces</span><br><span class="line">Examples:</span><br><span class="line">f ts @ S*~text:0[3]; f t @ section..text</span><br><span class="line">f ds @ S*~data:0[3]; f d @ section..data</span><br><span class="line">.ad t t+ts @ d:ds</span><br></pre></td></tr></table></figure>
<p>æˆ‘é€šå¸¸å¼€å§‹åˆ†ææ—¶ä¼šæ‰§è¡Œ<code>aa</code>ï¼ˆ<code>analyse all</code>ï¼‰ã€‚è¿™ä¸ªåç§°æœ‰ä¸€ç‚¹å®¹æ˜“è¯¯è§£ï¼Œå› ä¸ºé™¤æ­¤ä¹‹å¤–è¿˜æœ‰å¾ˆå¤šå¯ä»¥åˆ†æçš„ï¼ˆæ‰§è¡Œ<code>aa?</code>å¯ä»¥çœ‹åˆ°æ›´å¤šçš„ç”¨æ³•ï¼‰ï¼Œä½†å¯¹äºè¿™ä¸ªç¨‹åºæ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚è¿™æ¬¡æˆ‘ä»¬ç›´æ¥æ‰§è¡Œ<code>aaa</code>ï¼Œæ›´ç®€å•äº›ã€‚ä½ ä¹Ÿå¯ä»¥æ‰§è¡Œ<code>radare2</code>ç”¨<code>-A</code>å‚æ•°æ¥åˆ†ææ–‡ä»¶ï¼Œç›´æ¥åœ¨å¼€å§‹å°±æ‰§è¡Œ<code>aaa</code>ï¼ˆä¾‹å¦‚<code>r2 -A megabeets_0x1</code>ï¼‰</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> aaa</span></span><br><span class="line">[x] Analyze all flags starting with sym. and entry0 (aa)</span><br><span class="line">[x] Analyze len bytes of instructions for references (aar)</span><br><span class="line">[x] Analyze function calls (aac)</span><br><span class="line">[*] Use -AA or aaaa to perform additional experimental analysis.</span><br><span class="line">[x] Constructing a function name for fcn.* and sym.func.* functions (aan)</span><br></pre></td></tr></table></figure>
<h2 id="æ ‡å¿—"><a href="#æ ‡å¿—" class="headerlink" title="æ ‡å¿—"></a>æ ‡å¿—</h2><p>åœ¨åˆ†æä¹‹åï¼Œ<code>radare2</code>æŠŠä¸€äº›ç‰¹å®šçš„åå­—å’Œåç§»è”ç³»åœ¨ä¸€èµ·ï¼Œä¾‹å¦‚åŒºæ®µã€å‡½æ•°ã€ç¬¦å·è¡¨ã€å­—ç¬¦ä¸²ç­‰ç­‰ã€‚ä»–ä»¬è¢«ç§°ä½œä¸ºæ ‡å¿—ã€‚æ ‡å¿—è¢«æ•´åˆè¿›æ ‡å¿—ç©ºé—´ï¼Œä¸€ä¸ªæ ‡å¿—ç©ºé—´æ˜¯æ‰€æœ‰ç±»ä¼¼ç‰¹å¾çš„æ ‡å¿—çš„é›†åˆã€‚æ‰§è¡Œ<code>fs</code>ä»¥æŸ¥çœ‹æ‰€æœ‰çš„æ ‡å¿—ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> fs</span></span><br><span class="line">0    4 . strings</span><br><span class="line">1   35 . symbols</span><br><span class="line">2   82 . sections</span><br><span class="line">3    5 . relocs</span><br><span class="line">4    5 . imports</span><br><span class="line">5    1 . functions</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<code>fs &lt;flagspace&gt;</code>æ¥æŸ¥çœ‹æŸä¸ªç‰¹å®šçš„æ ‡å¿—ç©ºé—´ï¼Œç„¶åç”¨<code>f</code>è¾“å‡ºæ‰€æœ‰çš„æ ‡å¿—ã€‚æˆ‘ä»¬ä½¿ç”¨åˆ†å·å°†ä¸€è¡Œä¸­çš„å¤šä¸ªå‘½ä»¤åˆ†å¼€ï¼ˆæ¯”å¦‚<code>å‘½ä»¤ä¸€; å‘½ä»¤äºŒ; å‘½ä»¤ä¸‰;...</code>ï¼‰ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> fs imports; f</span></span><br><span class="line">0x08048320 6 sym.imp.strcmp</span><br><span class="line">0x08048330 6 sym.imp.strcpy</span><br><span class="line">0x08048340 6 sym.imp.puts</span><br><span class="line">0xffffffff 16 loc.imp.__gmon_start__</span><br><span class="line">0x08048350 6 sym.imp.__libc_start_main</span><br></pre></td></tr></table></figure>
<p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œ<code>radare2</code>å°†æ‰€æœ‰ç¨‹åºæ‰€ä½¿ç”¨çš„å¯¼å…¥è¡¨è¾“å‡ºâ€”â€”å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„<code>strcmp</code>ã€<code>strcpy</code>ã€<code>puts</code>ç­‰ï¼ŒåŒ…æ‹¬ç›¸å…³çš„åœ°å€ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ—å‡ºå­—ç¬¦ä¸²çš„æ ‡å¿—ç©ºé—´ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> fs strings; f</span></span><br><span class="line">0x08048700 21 str._n__.::_Megabeets_::.</span><br><span class="line">0x08048715 23 str.Think_you_can_make_it_</span><br><span class="line">0x0804872c 10 str.Success__n</span><br><span class="line">0x08048736 22 str.Nop__Wrong_argument._n</span><br></pre></td></tr></table></figure>
<h2 id="å­—ç¬¦ä¸²"><a href="#å­—ç¬¦ä¸²" class="headerlink" title="å­—ç¬¦ä¸²"></a>å­—ç¬¦ä¸²</h2><p>æˆ‘ä»¬çœ‹åˆ°<code>r2</code>åˆ—å‡ºäº†ä¸€äº›å­—ç¬¦ä¸²çš„åç§»ï¼Œè¿˜æœ‰ä¸€äº›å˜é‡åã€‚è®©æˆ‘ä»¬ä¸»è¦æ¥çœ‹çœ‹å­—ç¬¦ä¸²ã€‚æœ‰å¾ˆå¤šå¯ä»¥åˆ—å‡ºç¨‹åºä¸­å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œä½ å¯ä»¥é€‰æ‹©ä½ æœ€éœ€è¦çš„ä¸€ç§ã€‚<br><code>iz</code> â€“ åˆ—å‡ºåœ¨æ•°æ®çŸ­çš„å­—ç¬¦ä¸²<br><code>izz</code> â€“ åœ¨æ•´ä¸ªç¨‹åºä¸­æŸ¥æ‰¾å­—ç¬¦ä¸²</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> iz</span></span><br><span class="line">vaddr=0x08048700 paddr=0x00000700 ordinal=000 sz=21 len=20 section=.rodata type=ascii string=\n .:: Megabeets ::.</span><br><span class="line">vaddr=0x08048715 paddr=0x00000715 ordinal=001 sz=23 len=22 section=.rodata type=ascii string=Think you can make it?</span><br><span class="line">vaddr=0x0804872c paddr=0x0000072c ordinal=002 sz=10 len=9 section=.rodata type=ascii string=Success!\n</span><br><span class="line">vaddr=0x08048736 paddr=0x00000736 ordinal=003 sz=22 len=21 section=.rodata type=ascii string=Nop, Wrong argument.\n</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å·²ç»ç†Ÿæ‚‰äº†å¤§éƒ¨åˆ†å­—ç¬¦ä¸²â€”â€”è¿˜è®°å¾—æˆ‘ä»¬ä¸€å¼€å§‹è¿è¡Œç¨‹åºæ—¶çš„é‚£å‡ è¡Œå­—ç¬¦ä¸²å§ã€‚ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°<code>Success</code>ï¼Œè¿™åº”è¯¥æ˜¯æˆ‘ä»¬è¾“å…¥æ­£ç¡®å­—ç¬¦ä¸²åçš„æç¤ºã€‚æ—¢ç„¶æˆ‘ä»¬å·²ç»å¾—åˆ°äº†å­—ç¬¦ä¸²ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å®ƒä»¬åœ¨ç¨‹åºçš„ä»€ä¹ˆåœ°æ–¹è¢«ä½¿ç”¨äº†ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> axt @@ str.*</span></span><br><span class="line">data 0x8048609 push str._n__.::_Megabeets_::. in main</span><br><span class="line">data 0x8048619 push str.Think_you_can_make_it_ in main</span><br><span class="line">data 0x8048646 push str._n_tSuccess__n in main</span><br><span class="line">data 0x8048658 push str._n_tNop__Wrong_argument._n in main</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªå‘½ä»¤å±•ç¤ºç»™æˆ‘ä»¬<code>radare2</code>æ›´å¤šçš„ç‰¹ç‚¹ã€‚<code>axt</code>å‘½ä»¤ç”¨æ¥åœ¨æ•°æ®æ®µæˆ–ç¨‹åºæ®µäº¤å‰æŸ¥æ‰¾æŸä¸ªåœ°å€ï¼ˆè¯•è¯•<code>ax?</code>ï¼‰ã€‚<code>@@</code>æ˜¯ä¸€ä¸ªè¿­ä»£å™¨æ ‡å¿—ï¼Œç”¨æ¥åœ¨ä¸€æ®µåç§»ä¸Šé‡å¤æŸä¸ªå‘½ä»¤ï¼ˆè¯•è¯•<code>@@?</code>ï¼‰ã€‚<code>str.*</code>æ˜¯ä¸€ä¸ªå¯¹æ‰€æœ‰å¼€å¤´ä¸º<code>str.</code>çš„æ ‡å¿—çš„é€šé…ã€‚è¿™æ¡å‘½ä»¤èƒ½å¸®åŠ©æˆ‘åˆ—å‡ºå­—ç¬¦ä¸²æ ‡å¿—ä»¥åŠå¯¹åº”æ‰€åœ¨çš„å‡½æ•°åã€‚åœ¨è¿™ä¹‹å‰è¦ç¡®ä¿é€‰æ‹©äº†å­—ç¬¦ä¸²çš„æ ‡å¿—ç©ºé—´ï¼ˆé»˜è®¤æ—¶æ˜¯<code>fs *</code>ï¼‰ã€‚</p>
<h2 id="å®šä½"><a href="#å®šä½" class="headerlink" title="å®šä½"></a>å®šä½</h2><p>æ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œä¹‹å‰æˆ‘ä»¬ä¸€ç›´åœ¨ç¨‹åºçš„å…¥å£ç‚¹ï¼Œç°åœ¨åº”è¯¥å»å…¶ä»–åœ°æ–¹çœ‹çœ‹äº†ã€‚æˆ‘ä»¬åˆšåˆ—å‡ºæ¥çš„å­—ç¬¦ä¸²éƒ½æ˜¯åœ¨<code>main</code>å‡½æ•°ä¸­çš„ã€‚ä¸ºäº†å®šä½åˆ°å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨<code>seek</code>å‘½ä»¤ï¼Œç”¨<code>s</code>æ›¿ä»£ã€‚æ­£å¦‚å¤§å®¶æ‰€çŸ¥é“çš„ï¼Œåœ¨ï¼ˆå‡ ä¹ï¼‰æ¯ä¸ªå‘½ä»¤ååŠ ä¸Š<code>?</code>ä¼šè§£å†³ä½ æ‰€æœ‰çš„é—®é¢˜ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> s?</span></span><br><span class="line">|Usage: s  # Seek commands</span><br><span class="line">| s                 Print current address</span><br><span class="line">| s addr            Seek to address</span><br><span class="line">| s-                Undo seek</span><br><span class="line">| s- n              Seek n bytes backward</span><br><span class="line">| sâ€“                Seek blocksize bytes backward</span><br><span class="line">| s+                Redo seek</span><br><span class="line">| s+ n              Seek n bytes forward</span><br><span class="line">| s++               Seek blocksize bytes forward</span><br><span class="line">| s[j*=]            List undo seek history (JSON, =list, *r2)</span><br><span class="line">| s/ DATA           Search for next occurrence of â€˜DATAâ€™</span><br><span class="line">| s/x 9091          Search for next occurrence of \x90\x91</span><br><span class="line">| s.hexoff          Seek honoring a base from core-&gt;offset</span><br><span class="line">| sa [[+-]a] [asz]  Seek asz (or bsize) aligned to addr</span><br><span class="line">| sb                Seek aligned to bb start</span><br><span class="line">| sC[?] string      Seek to comment matching given string</span><br><span class="line">| sf                Seek to next function (f-&gt;addr+f-&gt;size)</span><br><span class="line">| sf function       Seek to address of specified function</span><br><span class="line">| sg/sG             Seek begin (sg) or end (sG) of section or file</span><br><span class="line">| sl[?] [+-]line    Seek to line</span><br><span class="line">| sn/sp             Seek next/prev scr.nkey</span><br><span class="line">| so [N]            Seek to N next opcode(s)</span><br><span class="line">| sr pc             Seek to register</span><br></pre></td></tr></table></figure>
<p><code>seek</code>å‘½ä»¤æ˜¯æ¥æ”¶ä¸€ä¸ªåœ°å€æˆ–æ˜¯ä¸€ä¸ªæ•°å­¦è¡¨è¾¾å¼ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªè¡¨è¾¾å¼å¯ä»¥æ˜¯æ•°å­¦è¿ç®—ã€æ ‡å¿—æˆ–è€…å†…å­˜è®¿é—®æ“ä½œã€‚æˆ‘ä»¬å¯ä»¥æ‰§è¡Œ<code>s main</code>æ¥å®šä½åˆ° main å‡½æ•°ã€‚è®©æˆ‘ä»¬å…ˆé€šè¿‡<code>afl</code>å‘½ä»¤ï¼ˆAnalyze Functions Listï¼‰æ¥æŸ¥çœ‹<code>radare2</code>ä¸ºæˆ‘ä»¬åˆ—å‡ºäº†å“ªäº›å‡½æ•°ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> afl</span></span><br><span class="line">0x080482ec    3 35           sym._init</span><br><span class="line">0x08048320    1 6            sym.imp.strcmp</span><br><span class="line">0x08048330    1 6            sym.imp.strcpy</span><br><span class="line">0x08048340    1 6            sym.imp.puts</span><br><span class="line">0x08048350    1 6            sym.imp.__libc_start_main</span><br><span class="line">0x08048360    1 6            sub.__gmon_start___252_360</span><br><span class="line">0x08048370    1 33           entry0</span><br><span class="line">0x080483a0    1 4            sym.__x86.get_pc_thunk.bx</span><br><span class="line">0x080483b0    4 43           sym.deregister_tm_clones</span><br><span class="line">0x080483e0    4 53           sym.register_tm_clones</span><br><span class="line">0x08048420    3 30           sym.__do_global_dtors_aux</span><br><span class="line">0x08048440    4 43   -&gt; 40   sym.frame_dummy</span><br><span class="line">0x0804846b   19 282          sym.rot13</span><br><span class="line">0x08048585    1 112          sym.beet</span><br><span class="line">0x080485f5    5 127          main</span><br><span class="line">0x08048680    4 93           sym.__libc_csu_init</span><br><span class="line">0x080486e0    1 2            sym.__libc_csu_fini</span><br><span class="line">0x080486e4    1 20           sym._fini</span><br></pre></td></tr></table></figure>
<p>è¿™äº›å¯¼å…¥å‡½æ•°æ­£æ˜¯æˆ‘ä»¬ä¹‹å‰æ‰€çœ‹åˆ°çš„ï¼ŒåŒ…æ‹¬å…¥å£ç‚¹ã€libcã€main å‡½æ•°å’Œä¸¤ä¸ªå¼•äººæ³¨æ„çš„å‡½æ•°åˆ†åˆ«å«åš<code>sym.beet</code>å’Œ<code>sym.rot13</code>ã€‚</p>
<h1 id="åæ±‡ç¼–"><a href="#åæ±‡ç¼–" class="headerlink" title="åæ±‡ç¼–"></a>åæ±‡ç¼–</h1><h2 id="main-å‡½æ•°"><a href="#main-å‡½æ•°" class="headerlink" title="main å‡½æ•°"></a>main å‡½æ•°</h2><p>æ˜¯æ—¶å€™å»çœ‹çœ‹æ±‡ç¼–ä»£ç äº†ã€‚é¦–å…ˆæˆ‘ä»¬ç”¨<code>s main</code>æ¥å®šä½åˆ° main å‡½æ•°ï¼Œç„¶åç”¨<code>pdf</code>å‘½ä»¤ï¼ˆPrint Disassemble Functionï¼‰æ¥åæ±‡ç¼–ã€‚æ³¨æ„åœ°å€æ˜¯æ€ä¹ˆå‡†ç¡®åœ°å˜æˆ main å‡½æ•°çš„åœ°å€çš„ã€‚</p>
<blockquote>
<ul>
<li>æ³¨æ„ï¼šæ­£å¦‚æˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œè¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯æ•™å¤§å®¶å­¦ä¹ å’Œäº†è§£<code>radare2</code>ï¼Œè€Œä¸æ˜¯æ•™æ±‡ç¼–è¯­è¨€çš„ã€‚å› æ­¤æˆ‘ä¸ä¼šå½»åº•åœ°è§£é‡Šä»£ç ã€‚å®é™…ä¸Šï¼Œè¿™ä¸ªç¨‹åºä¹Ÿå¾ˆç®€å•ï¼Œä½ åªè¦æœ‰ä¸€ç‚¹ç‚¹åŸºç¡€çš„é€†å‘å·¥ç¨‹çŸ¥è¯†å°±èƒ½æŒæ¡ã€‚</li>
</ul>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0x08048370]&gt;</span><span class="bash"> s main</span></span><br><span class="line"><span class="meta">[0x080485f5]&gt;</span><span class="bash"> pdf</span></span><br><span class="line">          ;â€“ main:</span><br><span class="line">/ (fcn) main 127</span><br><span class="line">|   main ();</span><br><span class="line">|           ; var int local_8h @ ebp-0x8</span><br><span class="line">|           ; var int local_4h @ esp+0x4</span><br><span class="line">|              ; DATA XREF from 0x08048387 (entry0)</span><br><span class="line">|           0x080485f5      8d4c2404       lea ecx, [esp + local_4h]   ; 0x4</span><br><span class="line">|           0x080485f9      83e4f0         and esp, 0xfffffff0</span><br><span class="line">|           0x080485fc      ff71fc         push dword [ecx â€“ 4]</span><br><span class="line">|           0x080485ff      55             push ebp</span><br><span class="line">|           0x08048600      89e5           mov ebp, esp</span><br><span class="line">|           0x08048602      53             push ebx</span><br><span class="line">|           0x08048603      51             push ecx</span><br><span class="line">|           0x08048604      89cb           mov ebx, ecx</span><br><span class="line">|           0x08048606      83ec0c         sub esp, 0xc</span><br><span class="line">|           0x08048609      6800870408     push str._n__.::_Megabeets_::. ; str._n__.::_Megabeets_::.</span><br><span class="line">|           0x0804860e      e82dfdffff     call sym.imp.puts          ; int puts(const char *s)</span><br><span class="line">|           0x08048613      83c410         add esp, 0x10</span><br><span class="line">|           0x08048616      83ec0c         sub esp, 0xc</span><br><span class="line">|           0x08048619      6815870408     push str.Think_you_can_make_it_ ; â€œThink you can make it?â€ @ 0x8048715</span><br><span class="line">|           0x0804861e      e81dfdffff     call sym.imp.puts          ; int puts(const char *s)</span><br><span class="line">|           0x08048623      83c410         add esp, 0x10</span><br><span class="line">|           0x08048626      833b01         cmp dword [ebx], 1          ; [0x1:4]=0x1464c45</span><br><span class="line">|       ,=&lt; 0x08048629      7e2a           jle 0x8048655</span><br><span class="line">|       |   0x0804862b      8b4304         mov eax, dword [ebx + 4]    ; [0x4:4]=0x10101</span><br><span class="line">|       |   0x0804862e      83c004         add eax, 4</span><br><span class="line">|       |   0x08048631      8b00           mov eax, dword [eax]</span><br><span class="line">|       |   0x08048633      83ec0c         sub esp, 0xc</span><br><span class="line">|       |   0x08048636      50             push eax</span><br><span class="line">|       |   0x08048637      e849ffffff     call sym.beet</span><br><span class="line">|       |   0x0804863c      83c410         add esp, 0x10</span><br><span class="line">|       |   0x0804863f      85c0           test eax, eax</span><br><span class="line">|      ,==&lt; 0x08048641      7412           je 0x8048655</span><br><span class="line">|      ||   0x08048643      83ec0c         sub esp, 0xc</span><br><span class="line">|      ||   0x08048646      682c870408     push str.Success__n ; â€œSuccess!.â€ @ 0x804872c</span><br><span class="line">|      ||   0x0804864b      e8f0fcffff     call sym.imp.puts          ; int puts(const char *s)</span><br><span class="line">|      ||   0x08048650      83c410         add esp, 0x10</span><br><span class="line">|     ,===&lt; 0x08048653      eb10           jmp 0x8048665</span><br><span class="line">|     |||      ; JMP XREF from 0x08048629 (main)</span><br><span class="line">|     |||      ; JMP XREF from 0x08048641 (main)</span><br><span class="line">|     |-&gt; 0x08048655      83ec0c         sub esp, 0xc</span><br><span class="line">|     |     0x08048658      6836870408     push str.Nop__Wrong_argument._n ; â€œNop, Wrong argument..â€ @ 0x8048736</span><br><span class="line">|     |     0x0804865d      e8defcffff     call sym.imp.puts          ; int puts(const char *s)</span><br><span class="line">|     |     0x08048662      83c410         add esp, 0x10</span><br><span class="line">|     |        ; JMP XREF from 0x08048653 (main)</span><br><span class="line">|     `â€”&gt; 0x08048665      b800000000     mov eax, 0</span><br><span class="line">|           0x0804866a      8d65f8         lea esp, [ebp â€“ local_8h]</span><br><span class="line">|           0x0804866d      59             pop ecx</span><br><span class="line">|           0x0804866e      5b             pop ebx</span><br><span class="line">|           0x0804866f      5d             pop ebp</span><br><span class="line">|           0x08048670      8d61fc         lea esp, [ecx â€“ 4]</span><br><span class="line">\           0x08048673      c3             ret</span><br></pre></td></tr></table></figure>
<p>çœ‹è¿‡æ±‡ç¼–ä»£ç åï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºä¸€æ®µç®€å•çš„ä¼ªä»£ç ï¼š</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (argc &gt; <span class="number">1</span> &amp;&amp; beet(argv[<span class="number">1</span>]) == <span class="literal">true</span>)</span><br><span class="line"><span class="meta"># i.e - <span class="meta-keyword">if</span> any argument passed to the program AND the result of beet, given the passed argument, is true</span></span><br><span class="line"><span class="meta"># argc is the number of arguments passed to the program</span></span><br><span class="line"><span class="meta"># argc will be at least 1 becuase the first argument is the program name</span></span><br><span class="line"><span class="meta"># argv is the array of parameters passed to the program</span></span><br><span class="line">&#123;</span><br><span class="line">    print <span class="string">"success"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">     print <span class="string">"fail"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>
<h2 id="å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼"><a href="#å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼" class="headerlink" title="å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼"></a>å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼</h2><p><code>radare2</code>æœ‰ç€ä¸€ä¸ªéå¸¸å¼ºå¤§ã€æ•ˆç‡æé«˜çš„å¯è§†åŒ–æ¨¡å¼ã€‚å¯è§†åŒ–æ¨¡å¼å¯¹ç”¨æˆ·éå¸¸å‹å¥½å¹¶ä¸”å°†ä½¿ç”¨<code>r2</code>çš„é€†å‘è¿‡ç¨‹å¸¦åˆ°äº†ä¸€ä¸ªæ–°çš„é«˜åº¦ã€‚æŒ‰ä¸‹<code>V</code>é”®å¼€å¯å¯è§†åŒ–æ¨¡å¼ã€‚æŒ‰ä¸‹<code>p</code>/<code>P</code>é”®ç”¨æ¥åˆ‡æ¢æ¨¡å¼ã€‚åœ¨å±å¹•çš„æœ€ä¸Šæ–¹å¯ä»¥çœ‹åˆ°ä½ è¾“å…¥çš„å‘½ä»¤ã€‚è¿™é‡ŒæŒ‰<code>p</code>å¯ä»¥åˆ‡æ¢å›åŸæ¥çš„åæ±‡ç¼–æ¨¡å¼ã€‚</p>
<p><img src="https://www.megabeets.net/uploads/visualMode_1.png" alt></p>
<h3 id="å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤"><a href="#å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤" class="headerlink" title="å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤"></a>å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤</h3><h4 id="ç§»åŠ¨"><a href="#ç§»åŠ¨" class="headerlink" title="ç§»åŠ¨"></a>ç§»åŠ¨</h4><p>ä½ å¯ä»¥é€šè¿‡<code>k</code>å‘ä¸Šç§»åŠ¨ï¼Œé€šè¿‡<code>j</code>å‘ä¸‹ç§»åŠ¨ã€‚å›è½¦é”®å¯ä»¥<code>jmp</code>æˆ–è€…<code>call</code>åˆ°ç›®æ ‡åœ°å€ã€‚åŒæ—¶åœ¨æ¯ä¸ª<code>jmp</code>æˆ–<code>call</code>å³ä¾§æ³¨é‡Šçš„æ–¹æ‹¬å·ä¸­æœ‰æ•°å­—ï¼Œç›´æ¥æŒ‰ç›¸åº”çš„æ•°å­—å¯è·³è½¬åˆ°å¯¹åº”åœ°å€ã€‚</p>
<h4 id="å¸®åŠ©"><a href="#å¸®åŠ©" class="headerlink" title="å¸®åŠ©"></a>å¸®åŠ©</h4><p>æ­£å¦‚ä¹‹å‰å‘½ä»¤è¡Œä¸‹çš„<code>radare2</code>ï¼ŒæŒ‰ä¸‹<code>?</code>å¯ä»¥ä¸ºä½ å±•ç°å¸®åŠ©çª—å£ï¼Œä½ å¯ä»¥å­¦ä¹ å¯è§†åŒ–æ¨¡å¼ä¸‹çš„å„ä¸ªå‘½ä»¤ã€‚</p>
<h4 id="äº¤å‰å¼•ç”¨"><a href="#äº¤å‰å¼•ç”¨" class="headerlink" title="äº¤å‰å¼•ç”¨"></a>äº¤å‰å¼•ç”¨</h4><p>ç”¨<code>x</code>/<code>X</code>åˆ†åˆ«æ¥åˆ—å‡ºå½“å‰å‡½æ•°çš„å¼•ç”¨å’Œè°ƒç”¨çš„æƒ…å†µã€‚æŒ‰ä¸‹å¯¹åº”æ•°å­—æ¥è·³è½¬ã€‚</p>
<h4 id="radare2å‘½ä»¤"><a href="#radare2å‘½ä»¤" class="headerlink" title="radare2å‘½ä»¤"></a><code>radare2</code>å‘½ä»¤</h4><p>ä½¿ç”¨ï¼šåœ¨å¯è§†åŒ–æ¨¡å¼ä¸‹è¾“å…¥<code>:command</code>æ¥æ‰§è¡Œ<code>r2</code>å‘½ä»¤</p>
<h4 id="æ³¨é‡Š"><a href="#æ³¨é‡Š" class="headerlink" title="æ³¨é‡Š"></a>æ³¨é‡Š</h4><p>ä½ å¯ä»¥é€šè¿‡<code>;[-]comment</code>æ¥æ·»åŠ æˆ–åˆ å»æ³¨é‡Šã€‚</p>
<h4 id="æ ‡è®°"><a href="#æ ‡è®°" class="headerlink" title="æ ‡è®°"></a>æ ‡è®°</h4><p><code>m&lt;key&gt;</code>å¯ä»¥ç”¨æ¥æ ‡è®°ç‰¹å®šçš„åç§»åœ°å€ã€‚<code>&#39;&lt;key&gt;</code>æ¥è·³åˆ°æŒ‡å®šåœ°å€ã€‚</p>
<h4 id="é€€å‡º"><a href="#é€€å‡º" class="headerlink" title="é€€å‡º"></a>é€€å‡º</h4><p>æŒ‰ä¸‹<code>q</code>é”®è¿”å›åˆ°<code>r2</code>çš„ shellã€‚</p>
<h3 id="å¯è§†åŒ–å›¾å½¢æ¨¡å¼"><a href="#å¯è§†åŒ–å›¾å½¢æ¨¡å¼" class="headerlink" title="å¯è§†åŒ–å›¾å½¢æ¨¡å¼"></a>å¯è§†åŒ–å›¾å½¢æ¨¡å¼</h3><p>å’Œå…¶ä»–çš„ä¸€äº›åæ±‡ç¼–å™¨ä¸€æ ·ï¼Œ<code>radare2</code>ä¹Ÿæœ‰å›¾å½¢è§†å›¾ã€‚ä½ å¯ä»¥è¾“å…¥<code>VV</code>ä» shell è¿›å…¥å›¾å½¢è§†å›¾ï¼Œé€šè¿‡<code>k</code>/<code>j</code>/<code>h</code>/<code>l</code>å‘ä¸Š/ä¸‹/å·¦/å³ç§»åŠ¨ï¼ŒæŒ‰<code>g</code>é”®è·³è½¬åˆ°ç›®æ ‡å‡½æ•°ï¼ˆä¾‹å¦‚<code>gd</code>ï¼‰ã€‚</p>
<p><img src="https://www.megabeets.net/uploads/visualGraph_1.png" alt></p>
<p>æŒ‰<code>?</code>æ¥åˆ—å‡ºæ‰€æœ‰çš„å‘½ä»¤ï¼Œå…¶ä¸­<code>R</code>å‘½ä»¤å€¼å¾—ä¸€å­¦ã€‚</p>
<h2 id="åæ±‡ç¼–beetå‡½æ•°"><a href="#åæ±‡ç¼–beetå‡½æ•°" class="headerlink" title="åæ±‡ç¼–beetå‡½æ•°"></a>åæ±‡ç¼–<code>beet</code>å‡½æ•°</h2><p>æ¥ä¸‹æ¥å›åˆ°åæ±‡ç¼–å‡½æ•°ä¸Šï¼Œçœ‹çœ‹<code>beet</code>å‡½æ•°ã€‚æ­£å¦‚æˆ‘ä»¬ä¹‹å‰æ‰€çœ‹åˆ°çš„ï¼Œæˆ‘ä»¬çš„ç¨‹åºæ£€æŸ¥äº†<code>beet</code>çš„è¿”å›ç»“æœï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æ–¹å¼è¾“å‡º<code>beet</code>çš„è¿”å›å€¼ï¼Œè¿™é‡Œåˆ—å‡ºå‡ ç§ï¼š</p>
<ol>
<li>åœ¨<code>r2</code>çš„ shell ä¸­å®šä½åˆ°<code>beet</code>å‡½æ•°ï¼Œç„¶åé€šè¿‡<code>s sym.beet</code>ï¼ˆ<code>sym.beet</code>æ˜¯<code>beet</code>å‡½æ•°çš„ä¸€ä¸ªæ ‡å¿—ã€‚ä½ å¯ä»¥é€šè¿‡<code>f sym.&lt;tab&gt;</code>è¾“å‡ºå‡º<code>sym</code>çš„æ ‡å¿—ï¼‰è¾“å‡ºå‡½æ•°ï¼Œç„¶åæ‰§è¡Œ<code>pdf</code>ï¼ˆPrint Disassemble Functionï¼‰ï¼›</li>
<li>åœ¨<code>r2</code>çš„ shell ä¸‹ï¼Œé€šè¿‡<code>pdf @ sym.beet</code>è¾“å‡º<code>beet</code>å‡½æ•°ã€‚<code>@</code>æ˜¯ä¸´æ—¶çš„å®šä½ï¼ˆè¾“å‡º<code>sym.beet</code>åœ°å€å¤„çš„å‡½æ•°ï¼‰ï¼›</li>
<li>å¯è§†åŒ–æ¨¡å¼ä¸‹åœ¨ main å‡½æ•°ä¸‹è·³åˆ°<code>beet</code>å‡½æ•°ï¼›</li>
<li>å¯è§†åŒ–å›¾å½¢ç•Œé¢ä¸‹åœ¨ main å‡½æ•°ä¸­ä½¿ç”¨<code>gd</code>ï¼ˆ<code>d</code>æ˜¯<code>call</code>è¾¹ä¸Šçš„å­—æ¯ï¼‰</li>
</ol>
<p>è¿™æ˜¯<code>beet</code>å‡½æ•°åœ¨å›¾å½¢è§†å›¾ä¸‹çš„æ ·å­ï¼š</p>
<p><img src="https://www.megabeets.net/uploads/visualGraph_beet1.png" alt></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¾“å…¥çš„å‚æ•°è¢«å¤åˆ¶ç»™äº†ä¸€ä¸ªç¼“å†²ç©ºé—´ã€‚ç¼“å­˜åŒºçš„ä½ç½®åœ¨<code>ebp - local_88h</code>ã€‚<code>local_88h</code>å…¶å®æ˜¯ 0x88ï¼Œä¹Ÿå°±æ˜¯åè¿›åˆ¶çš„ 136ã€‚åœ¨å¯è§†åŒ–æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>:</code>æ‰§è¡Œ<code>r2</code>çš„å‘½ä»¤<code>? 0x88</code>æŸ¥çœ‹ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:&gt; ? 0x88</span><br><span class="line">136 0x88 0210 136 0000:0088 136 â€œ\x88â€ 10001000 136.0 136.000000f 136.000000</span><br></pre></td></tr></table></figure>
<p>ç”±äº 4 ä¸ªå­—èŠ‚ä¿å­˜äº†å‰ä¸€ä¸ªæ ˆå¸§çš„ ebp å€¼ï¼Œæ¥ä¸‹æ¥çš„ 4 ä¸ªå­—èŠ‚åˆ™æ˜¯è¿”å›åœ°å€ï¼Œå› æ­¤åœ¨æ ˆä¸Šçš„ç¼“å†²åŒºå¤§å°ä¸º 128 ä¸ªå­—èŠ‚ï¼Œæ€»å…±ä¸º 136 ä¸ªå­—èŠ‚ã€‚</p>
<p>åœ¨ç¼“å†²åŒºä¹‹åæ˜¯æˆ‘ä»¬è¾“å…¥çš„å‚æ•°ï¼Œå®ƒå’Œå‡½æ•°<code>sym.rot13</code>çš„ç»“æœè¿›è¡Œæ¯”è¾ƒã€‚<a href="https://en.wikipedia.org/wiki/ROT13" target="_blank" rel="noopener">Rot-13</a>æ˜¯ä¸€ä¸ªè‘—åçš„ç½®æ¢åŠ å¯†ï¼Œç»å¸¸åœ¨ CTF ä»¥åŠ Crackme ä¸­ä½¿ç”¨ã€‚è¿™ä¸ªå‡½æ•°æ¥æ”¶äº† 9 ä¸ªåå…­è¿›åˆ¶æ•°ï¼Œçœ‹èµ·æ¥<code>radare2</code>æ²¡æœ‰æŠŠå®ƒä»¬è¯†åˆ«æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚æˆ‘ä»¬å¯ä»¥åœ¨å…¶åœ°å€ä¸Šæ‰§è¡Œ<code>ahi s</code>ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:&gt; ahi s @@=0x080485a3 0x080485ad 0x080485b7</span><br></pre></td></tr></table></figure>
<p><code>ahi s</code>ç”¨æ¥å°†å°†å…·ä½“åœ°å€è½¬æ¢æˆå­—ç¬¦ä¸²ï¼ˆè¯•è¯•<code>ahi?</code>ï¼‰ã€‚<code>@@</code>æ˜¯ä¸€ä¸ªè¿­ä»£å™¨ï¼ˆè¯•è¯•<code>@@</code>ï¼‰ï¼Œç„¶åè¿™äº›åœ°å€åˆ™æ˜¯<code>sym.beet</code>å‡½æ•°ä¸­æ²¡è¢«<code>radare2</code>è¯†åˆ«æˆå­—ç¬¦ä¸²çš„éƒ¨åˆ†ã€‚æ‰§è¡Œå®Œè¿™æ¡å‘½ä»¤åï¼Œå›¾å½¢è§†å›¾ä¼šè‡ªåŠ¨åˆ·æ–°ï¼ˆå¦‚æœæ²¡æœ‰è‡ªåŠ¨åˆ·æ–°ï¼Œæ‰§è¡Œ<code>r</code>ï¼‰æˆè¿™æ ·ï¼š</p>
<p><img src="https://www.megabeets.net/uploads/visualGraph_beet2.png" alt></p>
<p>çœ‹èµ·æ¥æ²¡è¢«è¯†åˆ«å‡ºæ¥çš„å­—ç¬¦ä¸²æ˜¯<code>Megabeets</code>ï¼ˆæ ¹æ®<a href="https://en.wikipedia.org/wiki/Endianness" target="_blank" rel="noopener">å­—èŠ‚åº</a>åå‘å‹æ ˆå¾—åˆ°ï¼‰ã€‚</p>
<p>è¯¥ç¨‹åºé€šè¿‡<code>strcmp</code>å°†ç»è¿‡ rot13 å¤„ç†åçš„<code>Megabeets</code>ä¸æˆ‘ä»¬è¾“å…¥çš„å‚æ•°è¿›è¡Œæ¯”è¾ƒã€‚å¹¸è¿çš„æ˜¯æˆ‘ä»¬ä¸éœ€è¦è¾›è‹¦åœ°åˆ†æ rot13 çš„å…·ä½“ç®—æ³•ï¼Œå› ä¸º<code>r2</code>æ¡†æ¶ä¸­çš„<code>rahash2</code>å·¥å…·å·²ç»åŒ…å«äº† rot13 åŠ å¯†ã€‚</p>
<p><code>rahash2</code>é€šè¿‡ä¸åŒçš„ç®—æ³•è®¡ç®—æ–‡ä»¶æˆ–æ˜¯å­—ç¬¦ä¸²çš„æ ¡éªŒå€¼ã€‚</p>
<p>ä½¿ç”¨<code>man rahash2</code>æŸ¥çœ‹æ›´å¤šçš„ç”¨æ³•ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">:&gt; !rahash2 -E rot -S s:13 -s â€˜Megabeets\nâ€™</span><br><span class="line">Zrtnorrgf</span><br></pre></td></tr></table></figure>
<p><code>rahash2</code>æ‰§è¡Œäº†<code>rot13(â€œMegabeetsâ€)</code>åå¾—åˆ°äº†å­—ç¬¦ä¸²<code>Zrtnorrgf</code>ã€‚è¾“å…¥<code>!</code>å¯ä»¥åœ¨<code>r2</code>çš„ shell ä¸‹æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚æˆ‘ä»¬å‡è®¾<code>Zrtnorrgf</code>å°±æ˜¯è¦å’Œæˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œæ¯”è¾ƒçš„å­—ç¬¦ä¸²ã€‚è®©æˆ‘ä»¬åœ¨è°ƒè¯•æ¨¡å¼ä¸‹æ‰“å¼€ç¨‹åºï¼Œä½¿ç”¨<code>ood</code>ï¼ˆè¯•è¯•<code>ood?</code>ï¼‰å¹¶å°†<code>Zrtnorrgf</code>ä½œä¸ºå‚æ•°ï¼Œçœ‹çœ‹æˆ‘ä»¬ä¼šå¾—åˆ°ä»€ä¹ˆã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">[0xf7749be9]&gt;</span><span class="bash"> ood?</span></span><br><span class="line">| ood [args]    reopen in debugger mode (with args)</span><br><span class="line"><span class="meta">[0xf7749be9]&gt;</span><span class="bash"> ood Zrtnorrgf</span></span><br><span class="line">Wait event received by different pid 7415</span><br><span class="line">Wait event received by different pid 7444</span><br><span class="line">Process with PID 7575 startedâ€¦</span><br><span class="line">File dbg:///home/remnux/Desktop/tutorials/megabeets_0x1 Zrtnorrgf reopened in read-write mode</span><br><span class="line">= attach 7575 7575</span><br><span class="line">Assuming filepath /home/remnux/Desktop/tutorials/megabeets_0x1</span><br><span class="line"><span class="meta">[0xf7749be9]&gt;</span><span class="bash"> dc</span></span><br><span class="line">Selecting and continuing: 7575.:: Megabeets ::.</span><br><span class="line">Think you can make it?</span><br><span class="line">Success!PTRACE_EVENT_EXIT pid=7575, status=0x0</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬æ”¶åˆ°äº†æˆåŠŸçš„æç¤ºï¼Œç ´è§£äº†è¿™ä¸ª Crackmeã€‚åœ¨æˆåŠŸç ´è§£ä¹‹åï¼Œæˆ‘ä»¬ç»ˆäºå¯ä»¥è¯´è¿™ä¸ªç¨‹åºå°±æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°ä¸<code>rot13(â€œMegabeetsâ€)</code>è¿›è¡Œäº†æ¯”è¾ƒï¼Œä¹Ÿå°±æ˜¯<code>Zrtnorrgf</code>ã€‚</p>
<p>ä½ å¯ä»¥åœ¨<a href="https://github.com/ITAYC0HEN/A-journey-into-Radare2/blob/master/Part%201%20-%20Simple%20crackme/megabeets_0x1.c" target="_blank" rel="noopener">è¿™é‡Œ</a>æŸ¥çœ‹ Crackme çš„å®Œæ•´æºç ã€‚</p>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p><code>Radare2</code>ä¹‹æ—…ç¬¬ä¸€éƒ¨åˆ†å°±å‘Šä¸€æ®µè½äº†ã€‚æˆ‘ä»¬åªæ¥è§¦äº†<code>radare2</code>çš„è¡¨çš®ï¼Œä»…ä»…äº†è§£äº†å®ƒæœ€æœ€åŸºç¡€çš„ä¸€äº›åŠŸèƒ½ã€‚åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå­¦ä¹ æ›´å¤šçš„å…³äº<code>radare2</code>çš„åŠŸèƒ½ï¼ŒåŒ…æ‹¬è„šæœ¬å¤„ç†ã€æ¶æ„è½¯ä»¶åˆ†æå’Œæ¼æ´åˆ©ç”¨ã€‚æˆ‘çŸ¥é“å¯¹äºå¾ˆå¤šäººæ¥è¯´ä¸€å¼€å§‹æ˜¯å¾ˆéš¾çš„ï¼Œä¸ç®¡æ˜¯èƒ½å¦æ„Ÿå—åˆ°<code>radare2</code>çš„å¼ºå¤§ä¹‹å¤„ï¼Œäº¦æˆ–æ˜¯å°†ä½ çš„ä»¥å‰çš„ä¹ æƒ¯æ”¾åˆ°ä¸€è¾¹è€Œç†Ÿæ‚‰ä½¿ç”¨<code>radare2</code>ã€‚ä¸ç®¡ä½ æ˜¯ä¸€ä¸ªé€†å‘å·¥ç¨‹å¸ˆã€ä¸€ä¸ª CTF æ¯”èµ›é€‰æ‰‹æˆ–è€…åªæ˜¯ä¸€ä¸ªå®‰å…¨çˆ±å¥½è€…ï¼Œæˆ‘æ•¢ä¿è¯å°†<code>radare2</code>æ”¶å…¥ä½ çš„å·¥å…·ç®±ç»å¯¹ä¸€ä¸ªæ˜¯æ˜æ™ºçš„é€‰æ‹©ã€‚</p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/re/">re</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/translation/">translation</a></li></ul>

      
        
	<div id="comment">
		<!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
		</div>
		<!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ -->
	</div>



      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/02/20/ã€è½¬ã€‘Installing-Minimal-Ubuntu-for-REMnux/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          ã€è½¬ã€‘Installing Minimal Ubuntu for REMnux
        
      </div>
    </a>
  
  
    <a href="/2019/02/15/ç»•è¿‡ELFçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶Canary/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">ç»•è¿‡ELFçš„å®‰å…¨é˜²æŠ¤æœºåˆ¶Canary</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    
      <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#åºè¨€"><span class="nav-number">1.</span> <span class="nav-text">åºè¨€</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#radare2"><span class="nav-number">2.</span> <span class="nav-text">radare2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#è·å–radare2"><span class="nav-number">3.</span> <span class="nav-text">è·å–radare2</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ä¸‹è½½"><span class="nav-number">3.1.</span> <span class="nav-text">ä¸‹è½½</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ›´æ–°"><span class="nav-number">3.2.</span> <span class="nav-text">æ›´æ–°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¸è½½"><span class="nav-number">3.3.</span> <span class="nav-text">å¸è½½</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#å¼€å§‹å­¦ä¹ "><span class="nav-number">4.</span> <span class="nav-text">å¼€å§‹å­¦ä¹ </span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#å‘½ä»¤è¡Œå‚æ•°"><span class="nav-number">4.1.</span> <span class="nav-text">å‘½ä»¤è¡Œå‚æ•°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#äºŒè¿›åˆ¶ä¿¡æ¯"><span class="nav-number">4.2.</span> <span class="nav-text">äºŒè¿›åˆ¶ä¿¡æ¯</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åˆ†æ"><span class="nav-number">4.3.</span> <span class="nav-text">åˆ†æ</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#æ ‡å¿—"><span class="nav-number">4.4.</span> <span class="nav-text">æ ‡å¿—</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å­—ç¬¦ä¸²"><span class="nav-number">4.5.</span> <span class="nav-text">å­—ç¬¦ä¸²</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å®šä½"><span class="nav-number">4.6.</span> <span class="nav-text">å®šä½</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#åæ±‡ç¼–"><span class="nav-number">5.</span> <span class="nav-text">åæ±‡ç¼–</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#main-å‡½æ•°"><span class="nav-number">5.1.</span> <span class="nav-text">main å‡½æ•°</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼"><span class="nav-number">5.2.</span> <span class="nav-text">å¯è§†åŒ–æ¨¡å¼å’Œå›¾å½¢æ¨¡å¼</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤"><span class="nav-number">5.2.1.</span> <span class="nav-text">å¯è§†åŒ–æ¨¡å¼åŸºæœ¬å‘½ä»¤</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ç§»åŠ¨"><span class="nav-number">5.2.1.1.</span> <span class="nav-text">ç§»åŠ¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#å¸®åŠ©"><span class="nav-number">5.2.1.2.</span> <span class="nav-text">å¸®åŠ©</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#äº¤å‰å¼•ç”¨"><span class="nav-number">5.2.1.3.</span> <span class="nav-text">äº¤å‰å¼•ç”¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#radare2å‘½ä»¤"><span class="nav-number">5.2.1.4.</span> <span class="nav-text">radare2å‘½ä»¤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ³¨é‡Š"><span class="nav-number">5.2.1.5.</span> <span class="nav-text">æ³¨é‡Š</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ ‡è®°"><span class="nav-number">5.2.1.6.</span> <span class="nav-text">æ ‡è®°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é€€å‡º"><span class="nav-number">5.2.1.7.</span> <span class="nav-text">é€€å‡º</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#å¯è§†åŒ–å›¾å½¢æ¨¡å¼"><span class="nav-number">5.2.2.</span> <span class="nav-text">å¯è§†åŒ–å›¾å½¢æ¨¡å¼</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#åæ±‡ç¼–beetå‡½æ•°"><span class="nav-number">5.3.</span> <span class="nav-text">åæ±‡ç¼–beetå‡½æ•°</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#åè®°"><span class="nav-number">6.</span> <span class="nav-text">åè®°</span></a></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2019 AssassinQ All Rights Reserved.
        
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
      var headerblur = document.getElementById("header-blur");
      headerblur.style.minHeight = window.getComputedStyle(document.getElementById("allheader"), null).height;
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>








  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>
