<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>攻防世界-REVERSE-新手练习区 | AssassinQ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="ctfwpre">
  
  
  
  
  <meta name="description" content="做了一遍ADWorld上简单的逆向。">
<meta name="keywords" content="ctf,wp,re">
<meta property="og:type" content="article">
<meta property="og:title" content="攻防世界-REVERSE-新手练习区">
<meta property="og:url" content="https://qianfei11.github.io/2019/04/08/攻防世界-REVERSE-新手练习区/index.html">
<meta property="og:site_name" content="AssassinQ">
<meta property="og:description" content="做了一遍ADWorld上简单的逆向。">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-08-26T05:49:42.231Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="攻防世界-REVERSE-新手练习区">
<meta name="twitter:description" content="做了一遍ADWorld上简单的逆向。">
  
    <link rel="alternate" href="/atom.xml" title="AssassinQ" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css">
  <link rel="stylesheet" href="/css/fashion.css">
  <link rel="stylesheet" href="/css/glyphs.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>
</html>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-header-image">
    <img id="originBg" width="100%" alt="Hike News" src>
  </div>

  <div id="header-blur" class="site-header-image blur" style="position: absolute; top:0; height: 207px; min-height: 207px; min-width: 100%;">
    <img id="blurBg" width="100%" style="top: 96%" alt="Hike News" src>
  </div>

  <script>
        var imgUrls = "css/images/pose01.jpg".split(",");
        var random = Math.floor((Math.random() * imgUrls.length ));
        if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
          document.getElementById("originBg").src=imgUrls[random];
          document.getElementById("blurBg").src=imgUrls[random];
        } else {
          document.getElementById("originBg").src='/' + imgUrls[random];
          document.getElementById("blurBg").src='/' + imgUrls[random];
        }
    </script>




<header id="allheader" class="site-header" role="banner" style="width: 100%; position: absolute; top:0; background: rgba(255,255,255,.8);">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="AssassinQ" rel="home"> AssassinQ </a>
            
          </h1>
          
          
            <div class="site-description">ZJGSU-IS-17</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows" style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/tags">Tags</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/about">About</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-攻防世界-REVERSE-新手练习区" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      攻防世界-REVERSE-新手练习区
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2019/04/08/攻防世界-REVERSE-新手练习区/" class="article-date">
	  <time datetime="2019-04-08T07:03:27.000Z" itemprop="datePublished">April 8, 2019</time>
	</a>

       
      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>做了一遍ADWorld上简单的逆向。</p>
<a id="more"></a>
<h1 id="re1"><a href="#re1" class="headerlink" title="re1"></a>re1</h1><p>没查到壳，拖进OD，单步到输入的地方，发现程序将<code>[ebp-0x24]</code>和<code>[ebp-0x44]</code>处的数据进行比较：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">0126103D    68 603E2701     push re1.01273E60                        ; ASCII &quot;这是一道很可爱很简单的逆向题呦\n&quot;</span><br><span class="line">01261042    E8 34020000     call re1.0126127B</span><br><span class="line">01261047    68 803E2701     push re1.01273E80                        ; ASCII &quot;输入flag吧:&quot;</span><br><span class="line">0126104C    E8 2A020000     call re1.0126127B</span><br><span class="line">01261051    8D45 DC         lea eax,dword ptr ss:[ebp-0x24]</span><br><span class="line">01261054    50              push eax</span><br><span class="line">01261055    68 8C3E2701     push re1.01273E8C                        ; ASCII &quot;%s&quot;</span><br><span class="line">0126105A    E8 72000000     call re1.012610D1</span><br><span class="line">0126105F    83C4 14         add esp,0x14</span><br><span class="line">01261062    8D45 DC         lea eax,dword ptr ss:[ebp-0x24]</span><br><span class="line">01261065    8D4D BC         lea ecx,dword ptr ss:[ebp-0x44]</span><br><span class="line">01261068    8A11            mov dl,byte ptr ds:[ecx]</span><br><span class="line">0126106A    3A10            cmp dl,byte ptr ds:[eax]</span><br><span class="line">0126106C    75 1A           jnz short re1.01261088</span><br><span class="line">0126106E    84D2            test dl,dl</span><br><span class="line">01261070    74 12           je short re1.01261084</span><br><span class="line">01261072    8A51 01         mov dl,byte ptr ds:[ecx+0x1]</span><br><span class="line">01261075    3A50 01         cmp dl,byte ptr ds:[eax+0x1]</span><br><span class="line">01261078    75 0E           jnz short re1.01261088</span><br><span class="line">0126107A    83C1 02         add ecx,0x2</span><br><span class="line">0126107D    83C0 02         add eax,0x2</span><br><span class="line">01261080    84D2            test dl,dl</span><br><span class="line">01261082  ^ 75 E4           jnz short re1.01261068</span><br><span class="line">01261084    33C0            xor eax,eax</span><br><span class="line">01261086    EB 05           jmp short re1.0126108D</span><br><span class="line">01261088    1BC0            sbb eax,eax</span><br><span class="line">0126108A    83C8 01         or eax,0x1</span><br><span class="line">0126108D    85C0            test eax,eax</span><br><span class="line">0126108F    75 07           jnz short re1.01261098</span><br><span class="line">01261091    68 903E2701     push re1.01273E90                        ; ASCII &quot;flag get√\n&quot;</span><br><span class="line">01261096    EB 05           jmp short re1.0126109D</span><br><span class="line">01261098    68 9C3E2701     push re1.01273E9C                        ; ASCII &quot;flag不太对呦，再试试呗，加油呦\n&quot;</span><br><span class="line">0126109D    E8 D9010000     call re1.0126127B</span><br><span class="line">012610A2    83C4 04         add esp,0x4</span><br><span class="line">012610A5    68 BC3E2701     push re1.01273EBC                        ; ASCII &quot;pause&quot;</span><br><span class="line">012610AA    E8 C2000000     call re1.01261171</span><br><span class="line">012610AF    8B4D FC         mov ecx,dword ptr ss:[ebp-0x4]</span><br><span class="line">012610B2    83C4 04         add esp,0x4</span><br><span class="line">012610B5    33CD            xor ecx,ebp</span><br><span class="line">012610B7    33C0            xor eax,eax</span><br><span class="line">012610B9    E8 04000000     call re1.012610C2</span><br><span class="line">012610BE    8BE5            mov esp,ebp</span><br><span class="line">012610C0    5D              pop ebp</span><br><span class="line">012610C1    C3              retn</span><br></pre></td></tr></table></figure>
<p>在数据窗口跟随，找到在栈上的flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">0015FAC4  44 55 54 43 54 46 7B 57 65 31 63 30 6D 65 74 30  DUTCTF&#123;We1c0met0</span><br><span class="line">0015FAD4  44 55 54 43 54 46 7D 00 00 00 00 00 00 00 15 00  DUTCTF&#125;........</span><br><span class="line">0015FAE4  32 33 33 00 40 FB 15 00 90 2C 26 01 8E C6 5F 84  233.@?.?&amp;幤_?</span><br><span class="line">0015FAF4  00 00 00 00 00 00 00 00 00 00 00 00 10 FB 15 00  ............?.</span><br></pre></td></tr></table></figure>
<h1 id="game"><a href="#game" class="headerlink" title="game"></a>game</h1><p>程序很复杂，用调试有点困难。直接搜索字符串找到关键部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line">0119E968  |.  68 F0B02401   push game.0124B0F0                       ;  done!!! the flag is</span><br><span class="line">0119E96D  |.  E8 4CBEFFFF   call game.0119A7BE</span><br><span class="line">0119E972  |.  83C4 04       add esp,0x4</span><br><span class="line">0119E975  |.  C645 BC 12    mov byte ptr ss:[ebp-0x44],0x12</span><br><span class="line">0119E979  |.  C645 BD 40    mov byte ptr ss:[ebp-0x43],0x40</span><br><span class="line">0119E97D  |.  C645 BE 62    mov byte ptr ss:[ebp-0x42],0x62</span><br><span class="line">0119E981  |.  C645 BF 05    mov byte ptr ss:[ebp-0x41],0x5</span><br><span class="line">0119E985  |.  C645 C0 02    mov byte ptr ss:[ebp-0x40],0x2</span><br><span class="line">0119E989  |.  C645 C1 04    mov byte ptr ss:[ebp-0x3F],0x4</span><br><span class="line">0119E98D  |.  C645 C2 06    mov byte ptr ss:[ebp-0x3E],0x6</span><br><span class="line">0119E991  |.  C645 C3 03    mov byte ptr ss:[ebp-0x3D],0x3</span><br><span class="line">0119E995  |.  C645 C4 06    mov byte ptr ss:[ebp-0x3C],0x6</span><br><span class="line">0119E999  |.  C645 C5 30    mov byte ptr ss:[ebp-0x3B],0x30</span><br><span class="line">0119E99D  |.  C645 C6 31    mov byte ptr ss:[ebp-0x3A],0x31</span><br><span class="line">0119E9A1  |.  C645 C7 41    mov byte ptr ss:[ebp-0x39],0x41</span><br><span class="line">0119E9A5  |.  C645 C8 20    mov byte ptr ss:[ebp-0x38],0x20</span><br><span class="line">0119E9A9  |.  C645 C9 0C    mov byte ptr ss:[ebp-0x37],0xC</span><br><span class="line">0119E9AD  |.  C645 CA 30    mov byte ptr ss:[ebp-0x36],0x30</span><br><span class="line">0119E9B1  |.  C645 CB 41    mov byte ptr ss:[ebp-0x35],0x41</span><br><span class="line">0119E9B5  |.  C645 CC 1F    mov byte ptr ss:[ebp-0x34],0x1F</span><br><span class="line">0119E9B9  |.  C645 CD 4E    mov byte ptr ss:[ebp-0x33],0x4E</span><br><span class="line">0119E9BD  |.  C645 CE 3E    mov byte ptr ss:[ebp-0x32],0x3E</span><br><span class="line">0119E9C1  |.  C645 CF 20    mov byte ptr ss:[ebp-0x31],0x20</span><br><span class="line">0119E9C5  |.  C645 D0 31    mov byte ptr ss:[ebp-0x30],0x31</span><br><span class="line">0119E9C9  |.  C645 D1 20    mov byte ptr ss:[ebp-0x2F],0x20</span><br><span class="line">0119E9CD  |.  C645 D2 01    mov byte ptr ss:[ebp-0x2E],0x1</span><br><span class="line">0119E9D1  |.  C645 D3 39    mov byte ptr ss:[ebp-0x2D],0x39</span><br><span class="line">0119E9D5  |.  C645 D4 60    mov byte ptr ss:[ebp-0x2C],0x60</span><br><span class="line">0119E9D9  |.  C645 D5 03    mov byte ptr ss:[ebp-0x2B],0x3</span><br><span class="line">0119E9DD  |.  C645 D6 15    mov byte ptr ss:[ebp-0x2A],0x15</span><br><span class="line">0119E9E1  |.  C645 D7 09    mov byte ptr ss:[ebp-0x29],0x9</span><br><span class="line">0119E9E5  |.  C645 D8 04    mov byte ptr ss:[ebp-0x28],0x4</span><br><span class="line">0119E9E9  |.  C645 D9 3E    mov byte ptr ss:[ebp-0x27],0x3E</span><br><span class="line">0119E9ED  |.  C645 DA 03    mov byte ptr ss:[ebp-0x26],0x3</span><br><span class="line">0119E9F1  |.  C645 DB 05    mov byte ptr ss:[ebp-0x25],0x5</span><br><span class="line">0119E9F5  |.  C645 DC 04    mov byte ptr ss:[ebp-0x24],0x4</span><br><span class="line">0119E9F9  |.  C645 DD 01    mov byte ptr ss:[ebp-0x23],0x1</span><br><span class="line">0119E9FD  |.  C645 DE 02    mov byte ptr ss:[ebp-0x22],0x2</span><br><span class="line">0119EA01  |.  C645 DF 03    mov byte ptr ss:[ebp-0x21],0x3</span><br><span class="line">0119EA05  |.  C645 E0 2C    mov byte ptr ss:[ebp-0x20],0x2C</span><br><span class="line">0119EA09  |.  C645 E1 41    mov byte ptr ss:[ebp-0x1F],0x41</span><br><span class="line">0119EA0D  |.  C645 E2 4E    mov byte ptr ss:[ebp-0x1E],0x4E</span><br><span class="line">0119EA11  |.  C645 E3 20    mov byte ptr ss:[ebp-0x1D],0x20</span><br><span class="line">0119EA15  |.  C645 E4 10    mov byte ptr ss:[ebp-0x1C],0x10</span><br><span class="line">0119EA19  |.  C645 E5 61    mov byte ptr ss:[ebp-0x1B],0x61</span><br><span class="line">0119EA1D  |.  C645 E6 36    mov byte ptr ss:[ebp-0x1A],0x36</span><br><span class="line">0119EA21  |.  C645 E7 10    mov byte ptr ss:[ebp-0x19],0x10</span><br><span class="line">0119EA25  |.  C645 E8 2C    mov byte ptr ss:[ebp-0x18],0x2C</span><br><span class="line">0119EA29  |.  C645 E9 34    mov byte ptr ss:[ebp-0x17],0x34</span><br><span class="line">0119EA2D  |.  C645 EA 20    mov byte ptr ss:[ebp-0x16],0x20</span><br><span class="line">0119EA31  |.  C645 EB 40    mov byte ptr ss:[ebp-0x15],0x40</span><br><span class="line">0119EA35  |.  C645 EC 59    mov byte ptr ss:[ebp-0x14],0x59</span><br><span class="line">0119EA39  |.  C645 ED 2D    mov byte ptr ss:[ebp-0x13],0x2D</span><br><span class="line">0119EA3D  |.  C645 EE 20    mov byte ptr ss:[ebp-0x12],0x20</span><br><span class="line">0119EA41  |.  C645 EF 41    mov byte ptr ss:[ebp-0x11],0x41</span><br><span class="line">0119EA45  |.  C645 F0 0F    mov byte ptr ss:[ebp-0x10],0xF</span><br><span class="line">0119EA49  |.  C645 F1 22    mov byte ptr ss:[ebp-0xF],0x22</span><br><span class="line">0119EA4D  |.  C645 F2 12    mov byte ptr ss:[ebp-0xE],0x12</span><br><span class="line">0119EA51  |.  C645 F3 10    mov byte ptr ss:[ebp-0xD],0x10</span><br><span class="line">0119EA55  |.  C645 F4 00    mov byte ptr ss:[ebp-0xC],0x0</span><br><span class="line">0119EA59  |.  C685 78FFFFFF&gt;mov byte ptr ss:[ebp-0x88],0x7B</span><br><span class="line">0119EA60  |.  C685 79FFFFFF&gt;mov byte ptr ss:[ebp-0x87],0x20</span><br><span class="line">0119EA67  |.  C685 7AFFFFFF&gt;mov byte ptr ss:[ebp-0x86],0x12</span><br><span class="line">0119EA6E  |.  C685 7BFFFFFF&gt;mov byte ptr ss:[ebp-0x85],0x62</span><br><span class="line">0119EA75  |.  C685 7CFFFFFF&gt;mov byte ptr ss:[ebp-0x84],0x77</span><br><span class="line">0119EA7C  |.  C685 7DFFFFFF&gt;mov byte ptr ss:[ebp-0x83],0x6C</span><br><span class="line">0119EA83  |.  C685 7EFFFFFF&gt;mov byte ptr ss:[ebp-0x82],0x41</span><br><span class="line">0119EA8A  |.  C685 7FFFFFFF&gt;mov byte ptr ss:[ebp-0x81],0x29</span><br><span class="line">0119EA91  |.  C645 80 7C    mov byte ptr ss:[ebp-0x80],0x7C</span><br><span class="line">0119EA95  |.  C645 81 50    mov byte ptr ss:[ebp-0x7F],0x50</span><br><span class="line">0119EA99  |.  C645 82 7D    mov byte ptr ss:[ebp-0x7E],0x7D</span><br><span class="line">0119EA9D  |.  C645 83 26    mov byte ptr ss:[ebp-0x7D],0x26</span><br><span class="line">0119EAA1  |.  C645 84 7C    mov byte ptr ss:[ebp-0x7C],0x7C</span><br><span class="line">0119EAA5  |.  C645 85 6F    mov byte ptr ss:[ebp-0x7B],0x6F</span><br><span class="line">0119EAA9  |.  C645 86 4A    mov byte ptr ss:[ebp-0x7A],0x4A</span><br><span class="line">0119EAAD  |.  C645 87 31    mov byte ptr ss:[ebp-0x79],0x31</span><br><span class="line">0119EAB1  |.  C645 88 53    mov byte ptr ss:[ebp-0x78],0x53</span><br><span class="line">0119EAB5  |.  C645 89 6C    mov byte ptr ss:[ebp-0x77],0x6C</span><br><span class="line">0119EAB9  |.  C645 8A 5E    mov byte ptr ss:[ebp-0x76],0x5E</span><br><span class="line">0119EABD  |.  C645 8B 6C    mov byte ptr ss:[ebp-0x75],0x6C</span><br><span class="line">0119EAC1  |.  C645 8C 54    mov byte ptr ss:[ebp-0x74],0x54</span><br><span class="line">0119EAC5  |.  C645 8D 06    mov byte ptr ss:[ebp-0x73],0x6</span><br><span class="line">0119EAC9  |.  C645 8E 60    mov byte ptr ss:[ebp-0x72],0x60</span><br><span class="line">0119EACD  |.  C645 8F 53    mov byte ptr ss:[ebp-0x71],0x53</span><br><span class="line">0119EAD1  |.  C645 90 2C    mov byte ptr ss:[ebp-0x70],0x2C</span><br><span class="line">0119EAD5  |.  C645 91 79    mov byte ptr ss:[ebp-0x6F],0x79</span><br><span class="line">0119EAD9  |.  C645 92 68    mov byte ptr ss:[ebp-0x6E],0x68</span><br><span class="line">0119EADD  |.  C645 93 6E    mov byte ptr ss:[ebp-0x6D],0x6E</span><br><span class="line">0119EAE1  |.  C645 94 20    mov byte ptr ss:[ebp-0x6C],0x20</span><br><span class="line">0119EAE5  |.  C645 95 5F    mov byte ptr ss:[ebp-0x6B],0x5F</span><br><span class="line">0119EAE9  |.  C645 96 75    mov byte ptr ss:[ebp-0x6A],0x75</span><br><span class="line">0119EAED  |.  C645 97 65    mov byte ptr ss:[ebp-0x69],0x65</span><br><span class="line">0119EAF1  |.  C645 98 63    mov byte ptr ss:[ebp-0x68],0x63</span><br><span class="line">0119EAF5  |.  C645 99 7B    mov byte ptr ss:[ebp-0x67],0x7B</span><br><span class="line">0119EAF9  |.  C645 9A 7F    mov byte ptr ss:[ebp-0x66],0x7F</span><br><span class="line">0119EAFD  |.  C645 9B 77    mov byte ptr ss:[ebp-0x65],0x77</span><br><span class="line">0119EB01  |.  C645 9C 60    mov byte ptr ss:[ebp-0x64],0x60</span><br><span class="line">0119EB05  |.  C645 9D 30    mov byte ptr ss:[ebp-0x63],0x30</span><br><span class="line">0119EB09  |.  C645 9E 6B    mov byte ptr ss:[ebp-0x62],0x6B</span><br><span class="line">0119EB0D  |.  C645 9F 47    mov byte ptr ss:[ebp-0x61],0x47</span><br><span class="line">0119EB11  |.  C645 A0 5C    mov byte ptr ss:[ebp-0x60],0x5C</span><br><span class="line">0119EB15  |.  C645 A1 1D    mov byte ptr ss:[ebp-0x5F],0x1D</span><br><span class="line">0119EB19  |.  C645 A2 51    mov byte ptr ss:[ebp-0x5E],0x51</span><br><span class="line">0119EB1D  |.  C645 A3 6B    mov byte ptr ss:[ebp-0x5D],0x6B</span><br><span class="line">0119EB21  |.  C645 A4 5A    mov byte ptr ss:[ebp-0x5C],0x5A</span><br><span class="line">0119EB25  |.  C645 A5 55    mov byte ptr ss:[ebp-0x5B],0x55</span><br><span class="line">0119EB29  |.  C645 A6 40    mov byte ptr ss:[ebp-0x5A],0x40</span><br><span class="line">0119EB2D  |.  C645 A7 0C    mov byte ptr ss:[ebp-0x59],0xC</span><br><span class="line">0119EB31  |.  C645 A8 2B    mov byte ptr ss:[ebp-0x58],0x2B</span><br><span class="line">0119EB35  |.  C645 A9 4C    mov byte ptr ss:[ebp-0x57],0x4C</span><br><span class="line">0119EB39  |.  C645 AA 56    mov byte ptr ss:[ebp-0x56],0x56</span><br><span class="line">0119EB3D  |.  C645 AB 0D    mov byte ptr ss:[ebp-0x55],0xD</span><br><span class="line">0119EB41  |.  C645 AC 72    mov byte ptr ss:[ebp-0x54],0x72</span><br><span class="line">0119EB45  |.  C645 AD 01    mov byte ptr ss:[ebp-0x53],0x1</span><br><span class="line">0119EB49  |.  C645 AE 75    mov byte ptr ss:[ebp-0x52],0x75</span><br><span class="line">0119EB4D  |.  C645 AF 7E    mov byte ptr ss:[ebp-0x51],0x7E</span><br><span class="line">0119EB51  |.  C645 B0 00    mov byte ptr ss:[ebp-0x50],0x0</span><br><span class="line">0119EB55  |.  C785 6CFFFFFF&gt;mov [local.37],0x0</span><br><span class="line">0119EB5F  |.  EB 0F         jmp short game.0119EB70</span><br><span class="line">0119EB61  |&gt;  8B85 6CFFFFFF /mov eax,[local.37]</span><br><span class="line">0119EB67  |.  83C0 01       |add eax,0x1</span><br><span class="line">0119EB6A  |.  8985 6CFFFFFF |mov [local.37],eax                      ;  kernel32.BaseThreadInitThunk</span><br><span class="line">0119EB70  |&gt;  83BD 6CFFFFFF&gt; cmp [local.37],0x38</span><br><span class="line">0119EB77  |.  7D 48         |jge short game.0119EBC1</span><br><span class="line">0119EB79  |.  8B85 6CFFFFFF |mov eax,[local.37]</span><br><span class="line">0119EB7F  |.  0FBE4C05 BC   |movsx ecx,byte ptr ss:[ebp+eax-0x44]</span><br><span class="line">0119EB84  |.  8B95 6CFFFFFF |mov edx,[local.37]</span><br><span class="line">0119EB8A  |.  0FBE8415 78FF&gt;|movsx eax,byte ptr ss:[ebp+edx-0x88]</span><br><span class="line">0119EB92  |.  33C1          |xor eax,ecx                             ; xor(enc[i], key[i])</span><br><span class="line">0119EB94  |.  8B8D 6CFFFFFF |mov ecx,[local.37]</span><br><span class="line">0119EB9A  |.  88840D 78FFFF&gt;|mov byte ptr ss:[ebp+ecx-0x88],al</span><br><span class="line">0119EBA1  |.  8B85 6CFFFFFF |mov eax,[local.37]</span><br><span class="line">0119EBA7  |.  0FBE8C05 78FF&gt;|movsx ecx,byte ptr ss:[ebp+eax-0x88]</span><br><span class="line">0119EBAF  |.  83F1 13       |xor ecx,0x13                            ; xor(enc[i], 0x13)</span><br><span class="line">0119EBB2  |.  8B95 6CFFFFFF |mov edx,[local.37]</span><br><span class="line">0119EBB8  |.  888C15 78FFFF&gt;|mov byte ptr ss:[ebp+edx-0x88],cl</span><br><span class="line">0119EBBF  |.^ EB A0         \jmp short game.0119EB61</span><br><span class="line">0119EBC1  |&gt;  8D85 78FFFFFF lea eax,[local.34]</span><br><span class="line">0119EBC7  |.  50            push eax                                 ;  kernel32.BaseThreadInitThunk</span><br><span class="line">0119EBC8  |.  68 0CB12401   push game.0124B10C                       ;  %s\n</span><br><span class="line">0119EBCD  |.  E8 ECBBFFFF   call game.0119A7BE</span><br><span class="line">0119EBD2  |.  83C4 08       add esp,0x8</span><br><span class="line">0119EBD5  |.  52            push edx                                 ;  game.&lt;ModuleEntryPoint&gt;</span><br><span class="line">0119EBD6  |.  8BCD          mov ecx,ebp</span><br><span class="line">0119EBD8  |.  50            push eax                                 ;  kernel32.BaseThreadInitThunk</span><br><span class="line">0119EBD9  |.  8D15 04EC1901 lea edx,dword ptr ds:[0x119EC04]</span><br><span class="line">0119EBDF  |.  E8 05AFFFFF   call game.01199AE9</span><br><span class="line">0119EBE4  |.  58            pop eax                                  ;  kernel32.776533CA</span><br><span class="line">0119EBE5  |.  5A            pop edx                                  ;  kernel32.776533CA</span><br><span class="line">0119EBE6  |.  5F            pop edi                                  ;  kernel32.776533CA</span><br><span class="line">0119EBE7  |.  5E            pop esi                                  ;  kernel32.776533CA</span><br><span class="line">0119EBE8  |.  5B            pop ebx                                  ;  kernel32.776533CA</span><br><span class="line">0119EBE9  |.  8B4D FC       mov ecx,[local.1]</span><br><span class="line">0119EBEC  |.  33CD          xor ecx,ebp</span><br><span class="line">0119EBEE  |.  E8 13B0FFFF   call game.01199C06</span><br><span class="line">0119EBF3  |.  81C4 58010000 add esp,0x158</span><br><span class="line">0119EBF9  |.  3BEC          cmp ebp,esp</span><br><span class="line">0119EBFB  |.  E8 019CFFFF   call game.01198801</span><br><span class="line">0119EC00  |.  8BE5          mov esp,ebp</span><br><span class="line">0119EC02  |.  5D            pop ebp                                  ;  kernel32.776533CA</span><br><span class="line">0119EC03  \.  C3            retn</span><br></pre></td></tr></table></figure>
<p>总共有两组数据，<code>flag</code>的值为两组数据异或后的结果再与<code>0x13</code>异或：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">key = [<span class="number">0x12</span>, <span class="number">0x40</span>, <span class="number">0x62</span>, <span class="number">0x5</span>, <span class="number">0x2</span>, <span class="number">0x4</span>, <span class="number">0x6</span>, <span class="number">0x3</span>, <span class="number">0x6</span>, <span class="number">0x30</span>, <span class="number">0x31</span>, <span class="number">0x41</span>, <span class="number">0x20</span>, <span class="number">0xC</span>, <span class="number">0x30</span>, <span class="number">0x41</span>, <span class="number">0x1F</span>, <span class="number">0x4E</span>, <span class="number">0x3E</span>, <span class="number">0x20</span>, <span class="number">0x31</span>, <span class="number">0x20</span>, <span class="number">0x1</span>, <span class="number">0x39</span>, <span class="number">0x60</span>, <span class="number">0x3</span>, <span class="number">0x15</span>, <span class="number">0x9</span>, <span class="number">0x4</span>, <span class="number">0x3E</span>, <span class="number">0x3</span>, <span class="number">0x5</span>, <span class="number">0x4</span>, <span class="number">0x1</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x2C</span>, <span class="number">0x41</span>, <span class="number">0x4E</span>, <span class="number">0x20</span>, <span class="number">0x10</span>, <span class="number">0x61</span>, <span class="number">0x36</span>, <span class="number">0x10</span>, <span class="number">0x2C</span>, <span class="number">0x34</span>, <span class="number">0x20</span>, <span class="number">0x40</span>, <span class="number">0x59</span>, <span class="number">0x2D</span>, <span class="number">0x20</span>, <span class="number">0x41</span>, <span class="number">0xF</span>, <span class="number">0x22</span>, <span class="number">0x12</span>, <span class="number">0x10</span>, <span class="number">0x0</span>]</span><br><span class="line">enc = [<span class="number">0x7B</span>, <span class="number">0x20</span>, <span class="number">0x12</span>, <span class="number">0x62</span>, <span class="number">0x77</span>, <span class="number">0x6C</span>, <span class="number">0x41</span>, <span class="number">0x29</span>, <span class="number">0x7C</span>, <span class="number">0x50</span>, <span class="number">0x7D</span>, <span class="number">0x26</span>, <span class="number">0x7C</span>, <span class="number">0x6F</span>, <span class="number">0x4A</span>, <span class="number">0x31</span>, <span class="number">0x53</span>, <span class="number">0x6C</span>, <span class="number">0x5E</span>, <span class="number">0x6C</span>, <span class="number">0x54</span>, <span class="number">0x6</span>, <span class="number">0x60</span>, <span class="number">0x53</span>, <span class="number">0x2C</span>, <span class="number">0x79</span>, <span class="number">0x68</span>, <span class="number">0x6E</span>, <span class="number">0x20</span>, <span class="number">0x5F</span>, <span class="number">0x75</span>, <span class="number">0x65</span>, <span class="number">0x63</span>, <span class="number">0x7B</span>, <span class="number">0x7F</span>, <span class="number">0x77</span>, <span class="number">0x60</span>, <span class="number">0x30</span>, <span class="number">0x6B</span>, <span class="number">0x47</span>, <span class="number">0x5C</span>, <span class="number">0x1D</span>, <span class="number">0x51</span>, <span class="number">0x6B</span>, <span class="number">0x5A</span>, <span class="number">0x55</span>, <span class="number">0x40</span>, <span class="number">0xC</span>, <span class="number">0x2B</span>, <span class="number">0x4C</span>, <span class="number">0x56</span>, <span class="number">0xD</span>, <span class="number">0x72</span>, <span class="number">0x1</span>, <span class="number">0x75</span>, <span class="number">0x7E</span>, <span class="number">0x0</span>]</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    tmp = enc[i] ^ key[i]</span><br><span class="line">    flag += chr(tmp ^ <span class="number">0x13</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="comment"># zsctf&#123;T9is_tOpic_1s_v5ry_int7resting_b6t_others_are_n0t&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="Hello-CTF"><a href="#Hello-CTF" class="headerlink" title="Hello, CTF"></a>Hello, CTF</h1><p>关键部分代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line">00401000  /$  83EC 60       sub esp,0x60</span><br><span class="line">00401003  |.  B9 08000000   mov ecx,0x8</span><br><span class="line">00401008  |.  53            push ebx</span><br><span class="line">00401009  |.  55            push ebp</span><br><span class="line">0040100A  |.  56            push esi</span><br><span class="line">0040100B  |.  57            push edi</span><br><span class="line">0040100C  |.  BE 68804000   mov esi,helloctf.00408068                ;  437261636b4d654a757374466f7246756e</span><br><span class="line">00401011  |.  8D7C24 4C     lea edi,dword ptr ss:[esp+0x4C]</span><br><span class="line">00401015  |.  F3:A5         rep movs dword ptr es:[edi],dword ptr ds&gt;</span><br><span class="line">00401017  |.  66:A5         movs word ptr es:[edi],word ptr ds:[esi]</span><br><span class="line">00401019  |.  A4            movs byte ptr es:[edi],byte ptr ds:[esi]</span><br><span class="line">0040101A  |&gt;  B9 08000000   /mov ecx,0x8</span><br><span class="line">0040101F  |.  33C0          |xor eax,eax</span><br><span class="line">00401021  |.  8D7C24 28     |lea edi,dword ptr ss:[esp+0x28]</span><br><span class="line">00401025  |.  68 4C804000   |push helloctf.0040804C                  ;  please input your serial:</span><br><span class="line">0040102A  |.  F3:AB         |rep stos dword ptr es:[edi]</span><br><span class="line">0040102C  |.  66:AB         |stos word ptr es:[edi]</span><br><span class="line">0040102E  |.  AA            |stos byte ptr es:[edi]</span><br><span class="line">0040102F  |.  E8 17030000   |call helloctf.0040134B</span><br><span class="line">00401034  |.  8D4424 18     |lea eax,dword ptr ss:[esp+0x18]</span><br><span class="line">00401038  |.  50            |push eax</span><br><span class="line">00401039  |.  68 48804000   |push helloctf.00408048                  ;  %s</span><br><span class="line">0040103E  |.  E8 F1020000   |call helloctf.00401334</span><br><span class="line">00401043  |.  8D7C24 20     |lea edi,dword ptr ss:[esp+0x20]</span><br><span class="line">00401047  |.  83C9 FF       |or ecx,-0x1</span><br><span class="line">0040104A  |.  33C0          |xor eax,eax</span><br><span class="line">0040104C  |.  83C4 0C       |add esp,0xC</span><br><span class="line">0040104F  |.  F2:AE         |repne scas byte ptr es:[edi]</span><br><span class="line">00401051  |.  F7D1          |not ecx</span><br><span class="line">00401053  |.  49            |dec ecx</span><br><span class="line">00401054  |.  83F9 11       |cmp ecx,0x11</span><br><span class="line">00401057  |.  0F87 B0000000 |ja helloctf.0040110D</span><br><span class="line">0040105D  |.  33DB          |xor ebx,ebx</span><br><span class="line">0040105F  |&gt;  8A441C 14     |/mov al,byte ptr ss:[esp+ebx+0x14]</span><br><span class="line">00401063  |.  84C0          ||test al,al</span><br><span class="line">00401065  |.  74 49         ||je short helloctf.004010B0</span><br><span class="line">00401067  |.  0FBEC8        ||movsx ecx,al</span><br><span class="line">0040106A  |.  51            ||push ecx</span><br><span class="line">0040106B  |.  8D5424 16     ||lea edx,dword ptr ss:[esp+0x16]</span><br><span class="line">0040106F  |.  68 44804000   ||push helloctf.00408044                 ;  %x 转十六进制ASCII码</span><br><span class="line">00401074  |.  52            ||push edx</span><br><span class="line">00401075  |.  E8 68020000   ||call helloctf.004012E2</span><br><span class="line">0040107A  |.  8D7C24 1E     ||lea edi,dword ptr ss:[esp+0x1E]</span><br><span class="line">0040107E  |.  83C9 FF       ||or ecx,-0x1</span><br><span class="line">00401081  |.  33C0          ||xor eax,eax</span><br><span class="line">00401083  |.  83C4 0C       ||add esp,0xC</span><br><span class="line">00401086  |.  F2:AE         ||repne scas byte ptr es:[edi]</span><br><span class="line">00401088  |.  F7D1          ||not ecx</span><br><span class="line">0040108A  |.  2BF9          ||sub edi,ecx</span><br><span class="line">0040108C  |.  8D5424 28     ||lea edx,dword ptr ss:[esp+0x28]</span><br><span class="line">00401090  |.  8BF7          ||mov esi,edi</span><br><span class="line">00401092  |.  8BE9          ||mov ebp,ecx</span><br><span class="line">00401094  |.  8BFA          ||mov edi,edx</span><br><span class="line">00401096  |.  83C9 FF       ||or ecx,-0x1</span><br><span class="line">00401099  |.  F2:AE         ||repne scas byte ptr es:[edi]</span><br><span class="line">0040109B  |.  8BCD          ||mov ecx,ebp</span><br><span class="line">0040109D  |.  4F            ||dec edi</span><br><span class="line">0040109E  |.  C1E9 02       ||shr ecx,0x2</span><br><span class="line">004010A1  |.  F3:A5         ||rep movs dword ptr es:[edi],dword ptr &gt;</span><br><span class="line">004010A3  |.  8BCD          ||mov ecx,ebp</span><br><span class="line">004010A5  |.  83E1 03       ||and ecx,0x3</span><br><span class="line">004010A8  |.  43            ||inc ebx</span><br><span class="line">004010A9  |.  83FB 11       ||cmp ebx,0x11</span><br><span class="line">004010AC  |.  F3:A4         ||rep movs byte ptr es:[edi],byte ptr ds&gt;</span><br><span class="line">004010AE  |.^ 7C AF         |\jl short helloctf.0040105F              ;  整个转换的循环</span><br><span class="line">004010B0  |&gt;  8D7424 4C     |lea esi,dword ptr ss:[esp+0x4C]</span><br><span class="line">004010B4  |.  8D4424 28     |lea eax,dword ptr ss:[esp+0x28]</span><br><span class="line">004010B8  |&gt;  8A10          |/mov dl,byte ptr ds:[eax]</span><br><span class="line">004010BA  |.  8A1E          ||mov bl,byte ptr ds:[esi]</span><br><span class="line">004010BC  |.  8ACA          ||mov cl,dl</span><br><span class="line">004010BE  |.  3AD3          ||cmp dl,bl</span><br><span class="line">004010C0  |.  75 1E         ||jnz short helloctf.004010E0</span><br><span class="line">004010C2  |.  84C9          ||test cl,cl</span><br><span class="line">004010C4  |.  74 16         ||je short helloctf.004010DC</span><br><span class="line">004010C6  |.  8A50 01       ||mov dl,byte ptr ds:[eax+0x1]</span><br><span class="line">004010C9  |.  8A5E 01       ||mov bl,byte ptr ds:[esi+0x1]</span><br><span class="line">004010CC  |.  8ACA          ||mov cl,dl</span><br><span class="line">004010CE  |.  3AD3          ||cmp dl,bl</span><br><span class="line">004010D0  |.  75 0E         ||jnz short helloctf.004010E0</span><br><span class="line">004010D2  |.  83C0 02       ||add eax,0x2</span><br><span class="line">004010D5  |.  83C6 02       ||add esi,0x2</span><br><span class="line">004010D8  |.  84C9          ||test cl,cl</span><br><span class="line">004010DA  |.^ 75 DC         |\jnz short helloctf.004010B8</span><br><span class="line">004010DC  |&gt;  33C0          |xor eax,eax</span><br><span class="line">004010DE  |.  EB 05         |jmp short helloctf.004010E5</span><br><span class="line">004010E0  |&gt;  1BC0          |sbb eax,eax</span><br><span class="line">004010E2  |.  83D8 FF       |sbb eax,-0x1</span><br><span class="line">004010E5  |&gt;  85C0          |test eax,eax</span><br><span class="line">004010E7  |.  75 12         |jnz short helloctf.004010FB</span><br><span class="line">004010E9  |.  68 38804000   |push helloctf.00408038                  ;  success!\n</span><br><span class="line">004010EE  |.  E8 58020000   |call helloctf.0040134B</span><br><span class="line">004010F3  |.  83C4 04       |add esp,0x4</span><br><span class="line">004010F6  |.^ E9 1FFFFFFF   |jmp helloctf.0040101A</span><br><span class="line">004010FB  |&gt;  68 30804000   |push helloctf.00408030                  ;  wrong!\n</span><br><span class="line">00401100  |.  E8 46020000   |call helloctf.0040134B</span><br><span class="line">00401105  |.  83C4 04       |add esp,0x4</span><br><span class="line">00401108  |.^ E9 0DFFFFFF   \jmp helloctf.0040101A</span><br><span class="line">0040110D  |&gt;  68 30804000   push helloctf.00408030                   ;  wrong!\n</span><br><span class="line">00401112  |.  E8 34020000   call helloctf.0040134B</span><br><span class="line">00401117  |.  A1 94804000   mov eax,dword ptr ds:[0x408094]</span><br><span class="line">0040111C  |.  83C4 04       add esp,0x4</span><br><span class="line">0040111F  |.  48            dec eax</span><br><span class="line">00401120  |.  5F            pop edi</span><br><span class="line">00401121  |.  5E            pop esi</span><br><span class="line">00401122  |.  5D            pop ebp</span><br><span class="line">00401123  |.  A3 94804000   mov dword ptr ds:[0x408094],eax</span><br><span class="line">00401128  |.  5B            pop ebx</span><br><span class="line">00401129  |.  78 0A         js short helloctf.00401135</span><br><span class="line">0040112B  |.  FF05 90804000 inc dword ptr ds:[0x408090]              ;  helloctf.0040AE80</span><br><span class="line">00401131  |.  83C4 60       add esp,0x60</span><br><span class="line">00401134  |.  C3            retn</span><br></pre></td></tr></table></figure>
<p>前面一大段代码是将输入的字符转换为<code>ASCII</code>码，之后将得到的字符串与在内存中的字符串进行比较：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">s = <span class="string">'437261636b4d654a757374466f7246756e'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(s)/<span class="number">2</span>):</span><br><span class="line">    flag += chr(int(s[<span class="number">2</span>*i:<span class="number">2</span>*i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="comment"># CrackMeJustForFun</span></span><br></pre></td></tr></table></figure>
<h1 id="open-source"><a href="#open-source" class="headerlink" title="open-source"></a>open-source</h1><p>面向源码逆向：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">4</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">"what?\n"</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> first = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (first != <span class="number">0xcafe</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">"you are wrong, sorry.\n"</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> second = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">if</span> (second % <span class="number">5</span> == <span class="number">3</span> || second % <span class="number">17</span> != <span class="number">8</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">"ha, you won't get it!\n"</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(<span class="string">"h4cky0u"</span>, argv[<span class="number">3</span>])) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">"so close, dude!\n"</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Brr wrrr grr\n"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> hash = first * <span class="number">31337</span> + (second % <span class="number">17</span>) * <span class="number">11</span> + <span class="built_in">strlen</span>(argv[<span class="number">3</span>]) - <span class="number">1615810207</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"Get your key: "</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%x\n"</span>, hash);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>就第二个参数需要爆破一下，直接算出哈希：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">argv1 = <span class="number">0xcafe</span></span><br><span class="line"><span class="keyword">print</span> argv1</span><br><span class="line">argv2 = <span class="number">0</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">5</span> != <span class="number">3</span> <span class="keyword">and</span> i % <span class="number">17</span> == <span class="number">8</span>:</span><br><span class="line">        argv2 = i</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"><span class="keyword">print</span> argv2</span><br><span class="line">argv3 = <span class="string">'h4cky0u'</span></span><br><span class="line">h = argv1 * <span class="number">31337</span> + (argv2 % <span class="number">17</span>) * <span class="number">11</span> + len(argv3) - <span class="number">1615810207</span></span><br><span class="line"><span class="keyword">print</span> hex(h)</span><br><span class="line"><span class="comment"># $ ./code 51966 25 h4cky0u</span></span><br><span class="line"><span class="comment"># Brr wrrr grr</span></span><br><span class="line"><span class="comment"># Get your key: c0ffee</span></span><br><span class="line"><span class="comment"># 0xc0ffee</span></span><br></pre></td></tr></table></figure>
<h1 id="simple-unpack"><a href="#simple-unpack" class="headerlink" title="simple-unpack"></a>simple-unpack</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@cadfc5b767d3:~/tmp# file ./simple2 </span><br><span class="line">./simple2: ELF 64-bit LSB executable, x86-64, version 1 (GNU/Linux), statically linked, stripped</span><br></pre></td></tr></table></figure>
<p>用gdb调试发现没有任何信息，根据提示知道是因为加了壳。可以用<code>DIE</code>查壳，发现是upx，直接<code>upx -d</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@cadfc5b767d3:~/tmp# upx -d ./simple2 </span><br><span class="line">                       Ultimate Packer for eXecutables</span><br><span class="line">                          Copyright (C) 1996 - 2013</span><br><span class="line">UPX 3.91        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Sep 30th 2013</span><br><span class="line"></span><br><span class="line">        File size         Ratio      Format      Name</span><br><span class="line">   --------------------   ------   -----------   -----------</span><br><span class="line">    914906 &lt;-    352624   38.54%  linux/ElfAMD   simple2</span><br><span class="line"></span><br><span class="line">Unpacked 1 file.</span><br></pre></td></tr></table></figure>
<p>再调试的时候在内存中就可以找到flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">   0x4009db &lt;main+45&gt;:	lea    rax,[rbp-0x70]</span><br><span class="line">   0x4009df &lt;main+49&gt;:	mov    esi,0x6ca0a0</span><br><span class="line">   0x4009e4 &lt;main+54&gt;:	mov    rdi,rax</span><br><span class="line">=&gt; 0x4009e7 &lt;main+57&gt;:	call   0x400360</span><br><span class="line">   0x4009ec &lt;main+62&gt;:	test   eax,eax</span><br><span class="line">   0x4009ee &lt;main+64&gt;:	jne    0x4009fc &lt;main+78&gt;</span><br><span class="line">   0x4009f0 &lt;main+66&gt;:	mov    edi,0x4a12c9</span><br><span class="line">   0x4009f5 &lt;main+71&gt;:	call   0x40fcc0 &lt;puts&gt;</span><br><span class="line">Guessed arguments:</span><br><span class="line">arg[0]: 0x7fffffffe5c0 --&gt; 0x333332 (&apos;233&apos;)</span><br><span class="line">arg[1]: 0x6ca0a0 (&quot;flag&#123;Upx_1s_n0t_a_d3liv3r_c0mp4ny&#125;&quot;)</span><br></pre></td></tr></table></figure>
<h1 id="insanity"><a href="#insanity" class="headerlink" title="insanity"></a>insanity</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@825dd8583221:~/tmp# file insanity </span><br><span class="line">insanity: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-, for GNU/Linux 2.6.26, BuildID[sha1]=5b8ef7c72fce77481f4edd6802bbdb7c6100dc6e, not stripped</span><br></pre></td></tr></table></figure>
<p>因为知道了题目来源是<code>9447 CTF 2014</code>，gdb里<code>searchmem</code>一下得到flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; searchmem 9447</span><br><span class="line">Searching for &apos;9447&apos; in: None ranges</span><br><span class="line">Found 2 results, display max 2 items:</span><br><span class="line">insanity : 0x8048788 (&quot;9447&#123;This_is_a_flag&#125;&quot;)</span><br><span class="line">insanity : 0x8049788 (&quot;9447&#123;This_is_a_flag&#125;&quot;)</span><br></pre></td></tr></table></figure>
<h1 id="logmein"><a href="#logmein" class="headerlink" title="logmein"></a>logmein</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@825dd8583221:~/tmp# file logmein </span><br><span class="line">logmein: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 2.6.32, BuildID[sha1]=c8f7fb137d9be24a19eb4f10efc29f7a421578a7, stripped</span><br></pre></td></tr></table></figure>
<p>直接上gdb调试。判断出长度为17，然后每次从内存中读取一个数和被加密的数据进行异或：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">0x400754:	movsxd rax,DWORD PTR [rbp-0x54]</span><br><span class="line">0x400758:	mov    cl,BYTE PTR [rbp+rax*1-0x20]</span><br><span class="line">0x40075c:	mov    BYTE PTR [rbp-0x55],cl</span><br><span class="line">0x40075f:	mov    eax,DWORD PTR [rbp-0x54]</span><br><span class="line">0x400762:	cdq    </span><br><span class="line">0x400763:	idiv   DWORD PTR [rbp-0x2c]</span><br><span class="line">0x400766:	movsxd rsi,edx</span><br><span class="line">0x400769:	mov    cl,BYTE PTR [rbp+rsi*1-0x28]</span><br><span class="line">0x400770:	movsx  edx,BYTE PTR [rbp-0x55]</span><br><span class="line">0x400774:	movsx  edi,BYTE PTR [rbp-0x56]</span><br><span class="line">0x400778:	xor    edx,edi</span><br><span class="line">0x40077a:	mov    cl,dl</span><br><span class="line">0x40077c:	mov    BYTE PTR [rbp-0x57],cl</span><br><span class="line">0x40077f:	movsxd rsi,DWORD PTR [rbp-0x54]</span><br><span class="line">0x400783:	movsx  edx,BYTE PTR [rbp+rsi*1-0x50]</span><br><span class="line">0x400788:	movsx  edi,BYTE PTR [rbp-0x57]</span><br><span class="line">0x40078c:	cmp    edx,edi</span><br><span class="line">0x40078e:	je     0x400799</span><br><span class="line">0x400794:	call   0x4007c0</span><br></pre></td></tr></table></figure>
<p>内存中的值：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; x/s $rbp-0x20</span><br><span class="line">0x7fffffffe670:	&quot;:\&quot;AL_RT^L*.?+6/46&quot;</span><br><span class="line">assassinq&gt;&gt; x/s $rbp-0x28</span><br><span class="line">0x7fffffffe668:	&quot;harambe&quot;</span><br></pre></td></tr></table></figure>
<p>最后的值即为flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">enc = <span class="string">':\"AL_RT^L*.?+6/46'</span></span><br><span class="line">key = <span class="string">'harambe'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    flag += chr(ord(enc[i]) ^ ord(key[i % len(key)]))</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="comment"># RC3-2016-XORISGUD</span></span><br></pre></td></tr></table></figure>
<h1 id="no-strings-attached"><a href="#no-strings-attached" class="headerlink" title="no-strings-attached"></a>no-strings-attached</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@8c972bcfc38f:~/tmp# file no_strings_attached </span><br><span class="line">no_strings_attached: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-, for GNU/Linux 2.6.24, BuildID[sha1]=c8d273ed1363a1878f348d6c506048f2354849d0, not stripped</span><br></pre></td></tr></table></figure>
<p>直接上gdb调试：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">EAX: 0x804c418 --&gt; 0x39 (&apos;9&apos;)</span><br><span class="line">EBX: 0x0 </span><br><span class="line">ECX: 0x1480 </span><br><span class="line">EDX: 0x7d (&apos;&#125;&apos;)</span><br><span class="line">...</span><br><span class="line">   0x8048711 &lt;authenticate+9&gt;:	mov    DWORD PTR [esp+0x4],0x8048a90</span><br><span class="line">   0x8048719 &lt;authenticate+17&gt;:	mov    DWORD PTR [esp],0x8048aa8</span><br><span class="line">   0x8048720 &lt;authenticate+24&gt;:	call   0x8048658 &lt;decrypt&gt;</span><br><span class="line">=&gt; 0x8048725 &lt;authenticate+29&gt;:	mov    DWORD PTR [ebp-0xc],eax</span><br><span class="line">   0x8048728 &lt;authenticate+32&gt;:	mov    eax,ds:0x804a03c</span><br><span class="line">   0x804872d &lt;authenticate+37&gt;:	mov    DWORD PTR [esp+0x8],eax</span><br><span class="line">   0x8048731 &lt;authenticate+41&gt;:	mov    DWORD PTR [esp+0x4],0x2000</span><br><span class="line">   0x8048739 &lt;authenticate+49&gt;:	lea    eax,[ebp-0x800c]</span><br><span class="line">[ebp-0xc] : 0xffffd76c --&gt; 0x0</span><br></pre></td></tr></table></figure>
<p>在<code>authenticate</code>中发现一个<code>decrypt</code>函数，在运行完这个函数后发现返回值是一个<code>&quot;9&quot;</code>开头的字符串，即为flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; x/ws 0x804c418</span><br><span class="line">0x804c418:	U&quot;9447&#123;you_are_an_international_mystery&#125;&quot;</span><br></pre></td></tr></table></figure>
<h1 id="python-trade"><a href="#python-trade" class="headerlink" title="python-trade"></a>python-trade</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@8c972bcfc38f:~/tmp# file Py.pyc </span><br><span class="line">Py.pyc: python 2.7 byte-compiled</span><br></pre></td></tr></table></figure>
<p>用<a href="https://github.com/rocky/python-uncompyle6" target="_blank" rel="noopener">uncompyle6</a>反编译一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># uncompyle6 version 3.2.4</span></span><br><span class="line"><span class="comment"># Python bytecode 2.7 (62211)</span></span><br><span class="line"><span class="comment"># Decompiled from: Python 2.7.16 (default, Apr 12 2019, 15:32:52) </span></span><br><span class="line"><span class="comment"># [GCC 4.2.1 Compatible Apple LLVM 10.0.0 (clang-1000.11.45.5)]</span></span><br><span class="line"><span class="comment"># Embedded file name: 1.py</span></span><br><span class="line"><span class="comment"># Compiled at: 2017-06-03 10:20:43</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span><span class="params">(message)</span>:</span></span><br><span class="line">    s = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> message:</span><br><span class="line">        x = ord(i) ^ <span class="number">32</span></span><br><span class="line">        x = x + <span class="number">16</span></span><br><span class="line">        s += chr(x)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">correct = <span class="string">'XlNkVmtUI1MgXWBZXCFeKY+AaXNt'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">print</span> <span class="string">'Input flag:'</span></span><br><span class="line">flag = raw_input()</span><br><span class="line"><span class="keyword">if</span> encode(flag) == correct:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'correct'</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'wrong'</span></span><br></pre></td></tr></table></figure>
<p>异或、加法还有<code>base64</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">enc = <span class="string">'XlNkVmtUI1MgXWBZXCFeKY+AaXNt'</span></span><br><span class="line">enc = base64.b64decode(enc)</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    flag += chr((ord(enc[i]) - <span class="number">16</span>) ^ <span class="number">32</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="comment"># nctf&#123;d3c0mpil1n9_PyC&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="csaw2013reversing2"><a href="#csaw2013reversing2" class="headerlink" title="csaw2013reversing2"></a>csaw2013reversing2</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ file csaw2013reversing2.exe</span><br><span class="line">csaw2013reversing2.exe: PE32 executable (console) Intel 80386, for MS Windows</span><br></pre></td></tr></table></figure>
<p>这道题上IDA比较清楚：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __cdecl __<span class="function">noreturn <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">const</span> <span class="keyword">char</span> **argv, <span class="keyword">const</span> <span class="keyword">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// ecx</span></span><br><span class="line">  CHAR *flag; <span class="comment">// [esp+8h] [ebp-Ch]</span></span><br><span class="line">  HANDLE hHeap; <span class="comment">// [esp+10h] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  hHeap = HeapCreate(<span class="number">0x40000</span>u, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  flag = (CHAR *)HeapAlloc(hHeap, <span class="number">8u</span>, MaxCount + <span class="number">1</span>);</span><br><span class="line">  memcpy_s(flag, MaxCount, &amp;enc, MaxCount);</span><br><span class="line">  <span class="keyword">if</span> ( sub_40102A() || IsDebuggerPresent() )</span><br><span class="line">  &#123;</span><br><span class="line">    __debugbreak();</span><br><span class="line">    sub_401000(v3 + <span class="number">4</span>, flag);</span><br><span class="line">    ExitProcess(<span class="number">0xFFFFFFFF</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  MessageBoxA(<span class="number">0</span>, flag + <span class="number">1</span>, <span class="string">"Flag"</span>, <span class="number">2u</span>);</span><br><span class="line">  HeapFree(hHeap, <span class="number">0</span>, flag);</span><br><span class="line">  HeapDestroy(hHeap);</span><br><span class="line">  ExitProcess(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>直接运行会出现一堆乱码，只有经过了<code>sub_401000</code>的操作才会得到真正的flag：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> __<span class="function">fastcall <span class="title">sub_401000</span><span class="params">(<span class="keyword">int</span> v3_4, <span class="keyword">char</span> *flag)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> *v3; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v4; <span class="comment">// ecx</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> result; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  v2 = key;</span><br><span class="line">  v3 = &amp;flag[<span class="built_in">strlen</span>(flag + <span class="number">1</span>) + <span class="number">2</span>];</span><br><span class="line">  v4 = <span class="number">0</span>;</span><br><span class="line">  result = ((<span class="keyword">unsigned</span> <span class="keyword">int</span>)(v3 - (flag + <span class="number">2</span>)) &gt;&gt; <span class="number">2</span>) + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( result )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">      *(_DWORD *)&amp;flag[<span class="number">4</span> * v4++] ^= v2;</span><br><span class="line">    <span class="keyword">while</span> ( v4 &lt; result );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一个while循环，对双字的一个异或可以得到flag：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">key = <span class="number">0xDDCCAABB</span></span><br><span class="line">enc = [<span class="number">0xBCA0CCBB</span>, <span class="number">0xB8BED1DC</span>, <span class="number">0xAEBECFCD</span>, <span class="number">0x82ABC4D2</span>, <span class="number">0xB393D9D2</span>, <span class="number">0xA993DED4</span>, <span class="number">0x82B8CBD3</span>, <span class="number">0xB9BECBD3</span>, <span class="number">0xDDCCD79A</span>]</span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    tmp = enc[i] ^ key</span><br><span class="line">    flag += chr(tmp &amp; <span class="number">0xFF</span>)</span><br><span class="line">    flag += chr((tmp &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    flag += chr((tmp &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line">    flag += chr((tmp &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="comment"># flag&#123;reversing_is_not_that_hard!&#125;</span></span><br></pre></td></tr></table></figure>
<h1 id="getit"><a href="#getit" class="headerlink" title="getit"></a>getit</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@19292a3658cc:~/tmp# file getit </span><br><span class="line">getit: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 2.6.24, BuildID[sha1]=e389cd7a4b9272ba80f85d7eb604176f6106c61e, not stripped</span><br></pre></td></tr></table></figure>
<p>gdb可以直接调出flag：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; searchmem Sharif</span><br><span class="line">Searching for &apos;Sharif&apos; in: None ranges</span><br><span class="line">Found 1 results, display max 1 items:</span><br><span class="line">getit : 0x6010e0 (&quot;SharifCTF&#123;b70c59275fcfa8aebf2d5911223c6589&#125;&quot;)</span><br></pre></td></tr></table></figure>
<p>审汇编也比较简单，<code>0x6010a0</code>处的字符串逐个对ASCII码判断：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; disassemble main</span><br><span class="line">Dump of assembler code for function main:</span><br><span class="line">...</span><br><span class="line">   0x000000000040077b &lt;+37&gt;:	mov    edi,0x6010a0</span><br><span class="line">   0x0000000000400780 &lt;+42&gt;:	call   0x4005e0 &lt;strlen@plt&gt;</span><br><span class="line">   0x0000000000400785 &lt;+47&gt;:	cmp    rbx,rax</span><br><span class="line">   0x0000000000400788 &lt;+50&gt;:	jae    0x4007c7 &lt;main+113&gt;</span><br><span class="line">   0x000000000040078a &lt;+52&gt;:	mov    eax,DWORD PTR [rbp-0x40]</span><br><span class="line">   0x000000000040078d &lt;+55&gt;:	lea    edx,[rax+0xa]</span><br><span class="line">   0x0000000000400790 &lt;+58&gt;:	mov    eax,DWORD PTR [rbp-0x40]</span><br><span class="line">   0x0000000000400793 &lt;+61&gt;:	cdqe   </span><br><span class="line">   0x0000000000400795 &lt;+63&gt;:	movzx  eax,BYTE PTR [rax+0x6010a0]</span><br><span class="line">   0x000000000040079c &lt;+70&gt;:	mov    ecx,eax</span><br><span class="line">   0x000000000040079e &lt;+72&gt;:	mov    eax,DWORD PTR [rbp-0x40]</span><br><span class="line">   0x00000000004007a1 &lt;+75&gt;:	and    eax,0x1</span><br><span class="line">   0x00000000004007a4 &lt;+78&gt;:	test   eax,eax</span><br><span class="line">   0x00000000004007a6 &lt;+80&gt;:	je     0x4007af &lt;main+89&gt;</span><br><span class="line">   0x00000000004007a8 &lt;+82&gt;:	mov    eax,0x1</span><br><span class="line">   0x00000000004007ad &lt;+87&gt;:	jmp    0x4007b4 &lt;main+94&gt;</span><br><span class="line">   0x00000000004007af &lt;+89&gt;:	mov    eax,0xffffffff</span><br><span class="line">   0x00000000004007b4 &lt;+94&gt;:	add    eax,ecx</span><br><span class="line">   0x00000000004007b6 &lt;+96&gt;:	mov    ecx,eax</span><br><span class="line">   0x00000000004007b8 &lt;+98&gt;:	movsxd rax,edx</span><br><span class="line">   0x00000000004007bb &lt;+101&gt;:	mov    BYTE PTR [rax+0x6010e0],cl</span><br><span class="line">   0x00000000004007c1 &lt;+107&gt;:	add    DWORD PTR [rbp-0x40],0x1</span><br><span class="line">   0x00000000004007c5 &lt;+111&gt;:	jmp    0x400775 &lt;main+31&gt;</span><br><span class="line">...</span><br><span class="line">End of assembler dump.</span><br></pre></td></tr></table></figure>
<p>如果是奇数则减一，反之加一</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line">h = <span class="string">'c61b68366edeb7bdce3c6820314b7498'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(h)):</span><br><span class="line">  <span class="keyword">if</span> ord(h[i]) % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">    flag += chr(ord(h[i]) + <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    flag += chr(ord(h[i]) - <span class="number">1</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="comment"># b70c79277dedc6cebd2b7931205c6589</span></span><br></pre></td></tr></table></figure>
<h1 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@19292a3658cc:~/tmp# file maze </span><br><span class="line">maze: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, for GNU/Linux 2.6.32, BuildID[sha1]=eda1df76eec45447cd0e1ad208a7eff914e86758, stripped</span><br></pre></td></tr></table></figure>
<p><a href="https://qianfei11.github.io/2018/11/22/南邮-逆向/">南邮的一道题</a></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/re/">re</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/">wp</a></li></ul>

      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>



      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/04/15/Some-Linux-Category-Challenges/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Some Linux Category Challenges
        
      </div>
    </a>
  
  
    <a href="/2019/03/31/2019-b00t2root-CTF/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2019-b00t2root-CTF</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    
      <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#re1"><span class="nav-number">1.</span> <span class="nav-text">re1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#game"><span class="nav-number">2.</span> <span class="nav-text">game</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hello-CTF"><span class="nav-number">3.</span> <span class="nav-text">Hello, CTF</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#open-source"><span class="nav-number">4.</span> <span class="nav-text">open-source</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#simple-unpack"><span class="nav-number">5.</span> <span class="nav-text">simple-unpack</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#insanity"><span class="nav-number">6.</span> <span class="nav-text">insanity</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#logmein"><span class="nav-number">7.</span> <span class="nav-text">logmein</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#no-strings-attached"><span class="nav-number">8.</span> <span class="nav-text">no-strings-attached</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#python-trade"><span class="nav-number">9.</span> <span class="nav-text">python-trade</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#csaw2013reversing2"><span class="nav-number">10.</span> <span class="nav-text">csaw2013reversing2</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#getit"><span class="nav-number">11.</span> <span class="nav-text">getit</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#maze"><span class="nav-number">12.</span> <span class="nav-text">maze</span></a></li></ol>
    
    </div>
  </aside>
</section>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2019 AssassinQ All Rights Reserved.
        
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
      var headerblur = document.getElementById("header-blur");
      headerblur.style.minHeight = window.getComputedStyle(document.getElementById("allheader"), null).height;
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>








  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>
