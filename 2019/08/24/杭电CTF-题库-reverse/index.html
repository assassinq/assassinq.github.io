<!DOCTYPE html>
<html lang="en">





<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#005f6b">
  <meta name="description" content="ZJGSU-IS-17">
  <meta name="author" content>
  <meta name="keywords" content>
  <title>杭电CTF-题库-reverse - AssassinQ</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css">
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css">

<link rel="stylesheet" href="/css/main.css">


  <link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css">


<!-- 自定义样式保持在最底部 -->


<link rel="alternate" href="/atom.xml" title="AssassinQ" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>AssassinQ</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">Archives</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">Tags</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">About</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">Links</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <p class="mt-3 post-meta">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                  Saturday, August 24th 2019, 11:33 am
                </p>
              

              <p class="mt-1">
                
                  
                  <span class="post-meta">
                    <i class="far fa-chart-bar"></i>
                    3.4k 字
                  </span>
                

                
                  
                  <span class="post-meta">
                      <i class="far fa-clock"></i>
                      20 分钟
                  </span>
                

                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5 z-depth-3" id="board">
          <div class="post-content mx-auto" id="post">
            
            <div class="markdown-body">
              <p>在杭电的平台上做了几道题。</p>
<a id="more"></a>
<h1 id="ebCTF-Teaser-BIN100-Dice"><a href="#ebCTF-Teaser-BIN100-Dice" class="headerlink" title="ebCTF-Teaser-BIN100-Dice"></a>ebCTF-Teaser-BIN100-Dice</h1><pre><code>$ file ebCTF-Teaser-BIN100-Dice.exe
ebCTF-Teaser-BIN100-Dice.exe: PE32 executable (console) Intel 80386 (stripped to external PDB), for MS Windows
</code></pre><p>拖进 OD，搜索字符串：</p>
<p><img src="/pics/杭电CTF-题库-reverse/1.png" srcset="/img/loading.gif" alt></p>
<p>大概可以看出是一个摇骰子的游戏，如果全部正确就能得到 flag。最直接的想法就是用 OD 边调试边修改寄存器的值，最后就能得到 flag：</p>
<p><img src="/pics/杭电CTF-题库-reverse/2.png" srcset="/img/loading.gif" alt></p>
<p>更方便的方式是直接在 IDA 里把所有判断不正确的跳转 patch 掉，这样就能直接得到结果：</p>
<p><img src="/pics/杭电CTF-题库-reverse/3.png" srcset="/img/loading.gif" alt></p>
<p>也可以在 IDA 里直接逆，关键部分代码：</p>
<pre><code class="cpp">...
          if ( v82 == 7 )
          {
            fctx.call_site = 1;
            v43 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(
                    (int)&amp;std::cout,
                    &quot;[*] You rolled a seven, with a six sided dice! How awesome are you?!&quot;);
            v44 = std::ostream::operator&lt;&lt;(v43, std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
            std::ostream::operator&lt;&lt;(v44, std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
            v85 *= 2;
            v85 *= 50;
            v85 /= 50;
            v85 += 65;
            v85 -= 65;
            v85 *= 42;
            v85 /= 42;
            v49 = time(0);
            v79 = v49;
            v81 = v49 - v80;
            if ( v49 - v80 &gt; 2 )
              v85 *= 2;
            for ( i = 0; ; ++i )
            {
              fctx.call_site = 1;
              v50 = std::string::size((std::string *)&amp;v87);
              if ( i &gt;= v50 )
                break;
              v51 = (_BYTE *)std::string::operator[]((std::string *)&amp;v87, i);
              *v51 ^= v85;
            }
            i = 0;
            for ( j = 0; ; ++j )
            {
              fctx.call_site = 1;
              v52 = std::string::size((std::string *)&amp;v84);
              if ( j &gt;= v52 )
                break;
              v64 = (_BYTE *)std::string::operator[]((std::string *)&amp;v84, j);
              v53 = (_BYTE *)std::string::operator[]((std::string *)&amp;v87, i);
              *v64 ^= *v53;
              ++i;
              v54 = std::string::length((std::string *)&amp;v87);
              if ( i &gt;= v54 )
                i = 0;
            }
            fctx.call_site = 1;
            if ( std::string::find((std::string *)&amp;v84, &quot;ebCTF&quot;, 0) == -1 )
            {
              fctx.call_site = 1;
              v59 = std::ostream::operator&lt;&lt;(&amp;std::cout, std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
              v60 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(
                      v59,
                      &quot;[!] It seems you did something wrong :( No flag for you.&quot;);
              v61 = std::ostream::operator&lt;&lt;(v60, std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
              std::ostream::operator&lt;&lt;(v61, std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
              fctx.call_site = 3;
              std::string::~string((std::string *)&amp;v72);
              fctx.call_site = 5;
              std::string::~string((std::string *)&amp;v73);
              fctx.call_site = 7;
              std::string::~string((std::string *)&amp;v74);
              fctx.call_site = 9;
              std::string::~string((std::string *)&amp;v75);
              fctx.call_site = 11;
              std::string::~string((std::string *)&amp;v76);
              fctx.call_site = 13;
              std::string::~string((std::string *)&amp;v77);
              fctx.call_site = 15;
              std::string::~string((std::string *)&amp;v78);
              fctx.call_site = 16;
              std::string::~string((std::string *)&amp;v83);
              fctx.call_site = 17;
              std::string::~string((std::string *)&amp;v84);
              fctx.call_site = -1;
              std::string::~string((std::string *)&amp;v87);
              v65 = 0;
            }
            else
            {
              v55 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;(
                      (int)&amp;std::cout,
                      &quot;[*] You rolled 3-1-3-3-7, what does that make you? ELEET! \\o/&quot;);
              std::ostream::operator&lt;&lt;(v55, std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
              v56 = std::operator&lt;&lt;&lt;std::char_traits&lt;char&gt;&gt;((int)&amp;std::cout, &quot;[*] Nice job, here is the flag: &quot;);
              v57 = std::operator&lt;&lt;&lt;char,std::char_traits&lt;char&gt;,std::allocator&lt;char&gt;&gt;(v56, &amp;v84);
              v58 = std::ostream::operator&lt;&lt;(v57, std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
              std::ostream::operator&lt;&lt;(v58, std::endl&lt;char,std::char_traits&lt;char&gt;&gt;);
              fctx.call_site = 3;
              std::string::~string((std::string *)&amp;v72);
              fctx.call_site = 5;
              std::string::~string((std::string *)&amp;v73);
              fctx.call_site = 7;
              std::string::~string((std::string *)&amp;v74);
              fctx.call_site = 9;
              std::string::~string((std::string *)&amp;v75);
              fctx.call_site = 11;
              std::string::~string((std::string *)&amp;v76);
              fctx.call_site = 13;
              std::string::~string((std::string *)&amp;v77);
              fctx.call_site = 15;
              std::string::~string((std::string *)&amp;v78);
              fctx.call_site = 16;
              std::string::~string((std::string *)&amp;v83);
              fctx.call_site = 17;
              std::string::~string((std::string *)&amp;v84);
              fctx.call_site = -1;
              std::string::~string((std::string *)&amp;v87);
            }
          }
...
</code></pre>
<p>脚本：</p>
<pre><code class="python">#!/usr/bin/env python
key = [0x02, 0x37, 0x0F, 0x35, 0x0F, 0x3C, 0x15, 0x07, 0x3C, 0x30, 0x2A, 0x30, 0x55, 0x12, 0x37, 0x15, 0x1E, 0x35, 0x01, 0x51]
enc = [0x13, 0x21, 0x38, 0x15, 0x3D, 0x33, 0x57, 0x47, 0x2D, 0x27, 0x6A, 0x73, 0x44, 0x05, 0x26, 0x59, 0x5C, 0x79, 0x17, 0x44, 0x45, 0x77, 0x1A, 0x75, 0x49, 0x7D, 0x05, 0x4A, 0x78, 0x74, 0x6A, 0x70, 0x42, 0x02, 0x71, 0x05, 0x0F, 0x22, 0x08]
k = 116
flag = &#39;&#39;
lenEnc = len(enc)
lenKey = len(key)
for i in range(lenKey):
    key[i] = key[i] ^ k
for i in range(lenEnc):
    flag += chr(enc[i] ^ key[i % lenKey])
print flag
</code></pre>
<h1 id="keylead"><a href="#keylead" class="headerlink" title="keylead"></a>keylead</h1><pre><code>$ file keylead
keylead: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=c1d5a4a7ffa57a2335f88093530dc89c1c71ec72, stripped
</code></pre><p>发现功能和前一题一模一样，就是变成了 elf，在 IDA 里各种 patch 就能直接出 flag：</p>
<pre><code>┌─[root][bead49282cbc][~/tmp]
└─▪ ./keylead
hi all ----------------------
Welcome to dice game!
You have to roll 5 dices and get 3, 1, 3, 3, 7 in order.
Press enter to roll.

You rolled 5, 3, 4, 4, 5.
You rolled as I said! I&#39;ll give you the flag.
ASIS{1fc1089e328eaf737c882ca0b10fcfe6}
</code></pre><p>输出 flag 的函数也不用逆，直接照着实现就行：</p>
<pre><code class="cpp">void func()
{
  int v0; // ST0C_4
  int v1; // ST08_4
  int v2; // ST0C_4
  int v3; // ST0C_4
  int v4; // ST08_4
  int v5; // ST0C_4
  int v6; // ST08_4
  int n; // [rsp+8h] [rbp-8h]
  int v8; // [rsp+8h] [rbp-8h]
  int i; // [rsp+8h] [rbp-8h]
  int j; // [rsp+8h] [rbp-8h]
  int m; // [rsp+Ch] [rbp-4h]
  int v12; // [rsp+Ch] [rbp-4h]
  int v13; // [rsp+Ch] [rbp-4h]
  int v14; // [rsp+Ch] [rbp-4h]
  int v15; // [rsp+Ch] [rbp-4h]
  int v16; // [rsp+Ch] [rbp-4h]

  m = 0;
  n = 0;
  while ( m != 1 )
  {
    putchar(enc[14 * m++]);
    do
    {
      while ( n &lt;= 1 )
        putchar(enc[20 * m - 8 * n++]);
      v1 = n + 1;
      v2 = 3 * m;
      putchar(enc[2 * v2 + 11 + v1]);
      v2 *= 5;
      v8 = v1 - 1;
      putchar(enc[2 * v2 + v8]);
      v12 = v2 / 3;
      while ( 1 )
      {
        while ( 1 )
        {
LABEL_12:
          if ( !v8 )
          {
            putchar(enc[2 * v12]);
            v15 = v12 ^ 2;
            while ( 2 )
            {
              for ( i = 1; i &lt;= 9; ++i )
                putchar(enc[10 * (i % 2) + 3 + v15]);
              v13 = v15 + 1;
LABEL_44:
              putchar(enc[v13 / 3]);
              if ( i == 10 )
              {
                v13 += 2 * v13 + 13;
                i = 19;
                goto LABEL_33;
              }
              if ( i == 2 )
              {
                i = v13-- + 2;
                goto LABEL_4;
              }
              if ( (unsigned int)(i - 22) &lt;= 0xA )
              {
                v14 = v13 - 3;
                for ( j = i - v14; ; j = 8 )
                {
LABEL_58:
                  putchar(enc[v14 + 1]);
                  v16 = v14 + 1;
                  if ( j == 11 )
                  {
                    v13 = (v16 + 14) / 2;
                    i = 11 * (v13 / 6);
                    goto LABEL_44;
                  }
                  if ( j != 13 )
                    break;
                  v12 = v16 + 8;
                  v8 = 2;
LABEL_51:
                  while ( 2 )
                  {
                    putchar(enc[v12 - 10]);
                    if ( v8 == v12 )
                    {
                      v4 = v8 + 2;
                      v5 = v12 + 2;
                      putchar(enc[v5 / 2 + v4 / 5]);
                      i = v4 / 2;
                      putchar(enc[i / 5 + v5]);
                      v13 = v5 + i - 1 + v5;
                      while ( 1 )
                      {
LABEL_33:
                        putchar(enc[v13 - 19]);
                        if ( i == 2 )
                        {
                          v3 = v13 + 1;
                          putchar(enc[v3 / 2 - 3]);
                          v13 = v3 / 5 + 2;
                          i = 2;
                          goto LABEL_44;
                        }
                        if ( i &lt;= 2 )
                          break;
                        if ( i == 10 )
                        {
                          v12 = v13 - 31;
                          v8 = 9;
                          goto LABEL_51;
                        }
                        if ( i != 19 )
                          goto LABEL_44;
                        i = 2;
                      }
                      if ( i == 1 )
                      {
                        v8 = 17;
                        v12 = v13 % 5 - 17 + v13;
LABEL_20:
                        putchar(enc[v12 - v8 + 9]);
                        v12 += ~v8++;
                        continue;
                      }
                      goto LABEL_44;
                    }
                    break;
                  }
                  if ( v8 != 9 )
                  {
                    if ( v8 != 2 )
                      goto LABEL_12;
                    j = 2;
                    v16 = v12 - 18;
LABEL_64:
                    v6 = 9 * j;
                    putchar(enc[v16 / 2 + v6 + v6 % 10]);
                    m = v16 + 1;
                    n = v6 % 10;
                    goto LABEL_21;
                  }
                  putchar(enc[v12 - 16]);
                  v14 = v12 / 2;
                }
                if ( j == 8 )
                {
                  v15 = v16 + 1;
                  i = 7;
                  continue;
                }
                goto LABEL_64;
              }
              goto LABEL_4;
            }
          }
          if ( v8 == 2 )
            break;
          if ( v12 == 7 )
          {
            putchar(enc[21 - v8]);
            v13 = 49;
            i = v8 / 3;
            goto LABEL_33;
          }
          if ( v8 != 3 )
            goto LABEL_20;
          putchar(enc[2 * (v12 / 3)]);
          v13 = v12 / 3;
          i = 9;
          do
          {
            while ( 1 )
            {
              if ( v13 == 10 )
              {
                putchar(enc[i + 8]);
                v14 = 9;
                j = i + 1;
                goto LABEL_58;
              }
              if ( v13 == 11 )
              {
                putchar(enc[i / 7]);
                v13 = i-- - 11;
              }
LABEL_4:
              if ( i != 9 )
                break;
              putchar(enc[v13 * v13 + 7]);
              v13 = v13 * v13 + 1;
              i = 10;
            }
          }
          while ( i != 13 );
          putchar(enc[2 * v13 + 12]);
          v8 = 3;
          v12 = 3 * v13;
        }
        putchar(enc[3 * v12 + 1]);
        v0 = v12 * v12;
        putchar(enc[v0 - 15]);
        m = v0 - 15;
        n = 4;
        putchar(enc[4]);
LABEL_21:
        if ( n != 4 )
          break;
        putchar(enc[m + 6]);
        v12 = m - 3;
        v8 = 3;
      }
    }
    while ( n != 8 );
    putchar(enc[2 * m + 32]);
  }
}
</code></pre>
<h1 id="Reverse02"><a href="#Reverse02" class="headerlink" title="Reverse02"></a>Reverse02</h1><pre><code>$ file Reverse02.exe
Reverse02.exe: PE32 executable (GUI) Intel 80386, for MS Windows
</code></pre><p>定位到 <code>MessageBoxA</code>，把这部分逆一下就完事了：</p>
<pre><code class="cpp">int func()
{
  char *v0; // eax
  char Dst; // [esp+0h] [ebp-38h]
  char v3; // [esp+1h] [ebp-37h]
  char v4; // [esp+Fh] [ebp-29h]

  Dst = 0;
  memset(&amp;v3, 0, 0x30u);
  strncpy_s(&amp;Dst, 0x31u, &quot;flag:{NSCTF_md57e0cad17016b0&gt;?45?f7c&gt;0&gt;4a&gt;1c3a0}&quot;, 0x30u);
  v0 = &amp;v4;
  if ( v4 != &#39;}&#39; )
  {
    do
    {
      *v0 ^= 7u;
      ++v0;
    }
    while ( *v0 != &#39;}&#39; );
  }
  return MessageBoxA(0, &amp;Dst, &quot;Flag&quot;, 0);
}
</code></pre>
<p>脚本：</p>
<pre><code class="python">#!/usr/bin/env python
enc = &#39;7e0cad17016b0&gt;?45?f7c&gt;0&gt;4a&gt;1c3a0&#39;
flag = &#39;&#39;
for i in range(len(enc)):
    flag += chr(ord(enc[i]) ^ 7)
print flag
</code></pre>
<h1 id="Reverse-100"><a href="#Reverse-100" class="headerlink" title="Reverse 100"></a>Reverse 100</h1><pre><code>$ file Reverse\ 100.exe
Reverse 100.exe: PE32 executable (console) Intel 80386, for MS Windows
</code></pre><p>main 函数看到有一个密码：</p>
<pre><code class="cpp">int __cdecl main(int argc, const char **argv, const char **envp)
{
  signed int i; // edi
  char password; // [esp+10h] [ebp-104h]
  char Dst; // [esp+11h] [ebp-103h]

  password = 0;
  memset(&amp;Dst, 0, 0xFFu);
  printf(&quot;please input ns-ctf password: &quot;);
  scanf_s(&quot;%s&quot;, &amp;password);
  for ( i = 1; strncmp(&quot;nsF0cuS!x01&quot;, &amp;password, 0xBu); ++i )
  {
    printf(&quot;try again!\n&quot;);
    memset(&amp;password, 0, 0x100u);
    printf(&quot;please input ns-ctf password: &quot;);
    scanf_s(&quot;%s&quot;, &amp;password);
  }
  dword_403368 = 1;
  if ( &amp;password + strlen(&amp;password) + 1 != &amp;Dst )
  {
    if ( i &gt; 3 )
    {
      func();
      return 0;
    }
    printf(&quot;flag:{NSCTF_md5065ca&gt;01??ab7e0f4&gt;&gt;a701c&gt;cd17340}&quot;);
  }
  return 0;
}
</code></pre>
<p>发现和前一题一模一样：</p>
<pre><code class="cpp">int func()
{
  char *v0; // eax
  char Format; // [esp+0h] [ebp-38h]
  char Dst; // [esp+1h] [ebp-37h]
  char v4; // [esp+Fh] [ebp-29h]

  Format = 0;
  memset(&amp;Dst, 0, 0x30u);
  strncpy_s(&amp;Format, 0x31u, &quot;flag:{NSCTF_md5065ca&gt;01??ab7e0f4&gt;&gt;a701c&gt;cd17340}&quot;, 0x30u);
  v0 = &amp;v4;
  if ( v4 != 125 )
  {
    do
    {
      *v0 ^= 7u;
      ++v0;
    }
    while ( *v0 != 125 );
  }
  return printf(&amp;Format);
}
</code></pre>
<p>异或一下：</p>
<pre><code class="python">#!/usr/bin/env python
enc = &#39;065ca&gt;01??ab7e0f4&gt;&gt;a701c&gt;cd17340&#39;
flag = &#39;&#39;
for i in range(len(enc)):
    flag += chr(ord(enc[i]) ^ 7)
print flag
</code></pre>
<h1 id="第五题"><a href="#第五题" class="headerlink" title="第五题"></a>第五题</h1><pre><code>$ file 5.exe
5.exe: PE32 executable (console) Intel 80386, for MS Windows
</code></pre><p>用 OD 搜索字符串，定位关键函数：</p>
<p><img src="/pics/杭电CTF-题库-reverse/4.png" srcset="/img/loading.gif" alt></p>
<p>在 IDA 里找到函数：</p>
<pre><code class="cpp">void __cdecl sub_401000()
{
  int i; // [esp+0h] [ebp-18h]
  char v1[20]; // [esp+4h] [ebp-14h]

  for ( i = 0; i &lt; 19; ++i )
    v1[i] = off_409030[47 * i % 100];
  sub_401129((int)&amp;unk_4092CC, i);
}
</code></pre>
<p>正向实现一下就行了：</p>
<pre><code class="python">#!/usr/bin/env python
table = [0x28, 0x2A, 0x26, 0x54, 0x49, 0x4F, 0x75, 0x68, 0x33, 0x6C, 0x31, 0x6A, 0x34, 0x68, 0x73, 0x64, 0x38, 0x37, 0x76, 0x67, 0x68, 0x28, 0x26, 0x25, 0x59, 0x47, 0x6B, 0x6A, 0x62, 0x76, 0x62, 0x61, 0x6C, 0x64, 0x6B, 0x66, 0x68, 0x5E, 0x26, 0x25, 0x2A, 0x26, 0x5E, 0x52, 0x31, 0x32, 0x6A, 0x33, 0x62, 0x65, 0x61, 0x73, 0x6F, 0x69, 0x64, 0x68, 0x63, 0x66, 0x39, 0x48, 0x43, 0x4C, 0x4B, 0x48, 0x56, 0x28, 0x2A, 0x47, 0x48, 0x44, 0x66, 0x68, 0x62, 0x6F, 0x71, 0x69, 0x77, 0x75, 0x65, 0x66, 0x38, 0x39, 0x32, 0x71, 0x33, 0x37, 0x78, 0x63, 0x76, 0x3B, 0x6C, 0x6B, 0x6A, 0x68, 0x71, 0x61, 0x73, 0x64, 0x6C, 0x6B, 0x66, 0x6A, 0x3B, 0x6C, 0x6B, 0x63, 0x6A, 0x76, 0x3B, 0x6C, 0x4C, 0x4B, 0x48, 0x61, 0x73, 0x64, 0x66, 0x6B, 0x6C, 0x6E, 0x4C, 0x4B, 0x6A, 0x68, 0x3B, 0x6C, 0x61, 0x73, 0x6B, 0x64, 0x66, 0x68, 0x6E, 0x49, 0x4F, 0x2A, 0x26, 0x59, 0x4F, 0x49, 0x55, 0x48, 0x4E, 0x6C, 0x6B, 0x69, 0x64, 0x66, 0x68, 0x76, 0x38, 0x30, 0x37, 0x39, 0x68, 0x6C, 0x6B, 0x6A, 0x42, 0x4F, 0x49, 0x55, 0x54, 0x36, 0x74, 0x66, 0x32, 0x33, 0x70, 0x30, 0x34, 0x2D, 0x30, 0x39, 0x75, 0x6A, 0x6C, 0x76, 0x3B, 0x6B, 0x6E, 0x30, 0x39, 0x38, 0x59, 0x49, 0x55, 0x68, 0x72, 0x6C, 0x6B, 0x34, 0x72, 0x6E, 0x5B, 0x70, 0x39, 0x75, 0x64, 0x76, 0x6C, 0x6B, 0x6D, 0x31, 0x70, 0x39, 0x79, 0x68, 0x38, 0x55, 0x47, 0x6B, 0x6A, 0x68, 0x70, 0x49, 0x48, 0x52, 0x50, 0x4F, 0x4E, 0x2A, 0x26, 0x5E, 0x52, 0x46, 0x43, 0x4C, 0x4B, 0x4A, 0x4E, 0x50, 0x4F, 0x49, 0x55, 0x45, 0x57, 0x44, 0x49, 0x55, 0x48, 0x33, 0x6F, 0x34, 0x69, 0x66, 0x67, 0x6F, 0x69, 0x76, 0x63, 0x33, 0x6F, 0x39, 0x38, 0x37, 0x34, 0x39, 0x26, 0x2A, 0x66, 0x6F, 0x69, 0x6A, 0x7A, 0x78, 0x62, 0x63, 0x76, 0x2A, 0x26, 0x2A, 0x26, 0x74, 0x33, 0x32, 0x31, 0x34, 0x61, 0x73, 0x64, 0x76, 0x7A, 0x78, 0x63, 0x43, 0x4C, 0x49, 0x4B, 0x4B, 0x48, 0x39, 0x38, 0x64, 0x75, 0x79, 0x66, 0x69, 0x32, 0x77, 0x6A, 0x6E, 0x65, 0x70, 0x66, 0x6F, 0x69, 0x63, 0x70, 0x69, 0x6B, 0x76, 0x70, 0x6F, 0x69, 0x73, 0x75, 0x64, 0x66, 0x2D, 0x39, 0x30, 0x38, 0x75, 0x33, 0x34, 0x72, 0x73, 0x64, 0x3B, 0x6C, 0x64, 0x66, 0x6B, 0x6E, 0x76, 0x3B, 0x6C, 0x64, 0x6B, 0x73, 0x66, 0x68, 0x76, 0x30, 0x39, 0x38, 0x79, 0x39, 0x75, 0x69, 0x68, 0x6E, 0x30, 0x34, 0x38, 0x79, 0x66, 0x70, 0x4F, 0x49, 0x55, 0x48, 0x29, 0x28, 0x38, 0x66, 0x68, 0x34, 0x32, 0x33, 0x6B, 0x6A, 0x35, 0x74, 0x68, 0x6E, 0x67, 0x6F, 0x78, 0x66, 0x63, 0x68, 0x76, 0x6A, 0x6B, 0x6E, 0x68, 0x30, 0x28, 0x2A, 0x59, 0x6F, 0x70, 0x69, 0x65, 0x72, 0x6E, 0x74, 0x30, 0x39, 0x75, 0x38, 0x32, 0x68, 0x67, 0x6B, 0x6A, 0x64, 0x66, 0x6E, 0x63, 0x76, 0x30, 0x39, 0x38, 0x59, 0x70, 0x66, 0x6F, 0x69, 0x6E, 0x32, 0x33, 0x34, 0x70, 0x66, 0x75, 0x69, 0x68, 0x39, 0x65, 0x77, 0x75, 0x69, 0x68, 0x6E, 0x72, 0x66, 0x67, 0x4B, 0x4C, 0x4A, 0x53, 0x41, 0x4F, 0x49, 0x70, 0x65, 0x75, 0x79, 0x68, 0x34, 0x75, 0x6E, 0x66, 0x67, 0x3B, 0x66, 0x6B, 0x76, 0x62, 0x30, 0x39, 0x38, 0x34, 0x33, 0x68, 0x6B, 0x6A, 0x76, 0x6E, 0x70, 0x49, 0x2A, 0x59, 0x4F, 0x49, 0x45, 0x6E, 0x72, 0x70, 0x32, 0x6F, 0x33, 0x69, 0x6A, 0x66, 0x39, 0x69, 0x6A, 0x78, 0x64, 0x63, 0x70, 0x4C, 0x49, 0x48, 0x4A, 0x2D, 0x39, 0x38, 0x66, 0x79, 0x32, 0x33, 0x6B, 0x6E, 0x66, 0x70, 0x6F, 0x73, 0x64, 0x69, 0x75, 0x76, 0x2D, 0x33, 0x39, 0x6A, 0x65, 0x66, 0x6F, 0x69, 0x6B, 0x31, 0x68, 0x72, 0x66, 0x38, 0x39, 0x75, 0x6A, 0x66, 0x64, 0x76, 0x6D, 0x6B, 0x70, 0x49, 0x75, 0x64, 0x31, 0x69, 0x6A, 0x65, 0x2D, 0x66, 0x39, 0x32, 0x4C, 0x4F, 0x49, 0x58, 0x4A, 0x48, 0x43, 0x28, 0x49, 0x6E, 0x65, 0x6D, 0x70, 0x77, 0x71, 0x6B, 0x66, 0x6E, 0x70, 0x39, 0x32, 0x33, 0x34, 0x75, 0x66, 0x2D, 0x30, 0x65, 0x69, 0x6B, 0x66, 0x31, 0x70, 0x33, 0x69, 0x6F, 0x34, 0x66, 0x6A, 0x2D, 0x39, 0x66, 0x6F, 0x76, 0x3B, 0x6C, 0x6B, 0x77, 0x71, 0x6E, 0x66, 0x64, 0x70, 0x76, 0x69, 0x4A, 0x4F, 0x53, 0x44, 0x6A, 0x66, 0x70, 0x32, 0x6F, 0x69, 0x33, 0x72, 0x6A, 0x66, 0x2D, 0x30, 0x39, 0x64, 0x66, 0x6A, 0x76, 0x3B, 0x6C, 0x6B, 0x31, 0x33, 0x6D, 0x66, 0x69, 0x6A, 0x2D, 0x31, 0x33, 0x30, 0x39, 0x34, 0x66, 0x75, 0x71, 0x77, 0x6B, 0x6C, 0x31, 0x70, 0x5B, 0x33, 0x34, 0x30, 0x39, 0x72, 0x6F, 0x63, 0x66, 0x6D, 0x76, 0x00]
v3 = &#39;&#39;
for i in range(19):
    v3 += chr(table[47 * i % 100])
print v3
</code></pre>
<h1 id="第六题"><a href="#第六题" class="headerlink" title="第六题"></a>第六题</h1><pre><code>$ file 6.exe
6.exe: PE32 executable (console) Intel 80386, for MS Windows
</code></pre><p>在 IDA 里硬逆就完事了：</p>
<pre><code class="cpp">int __cdecl main(int argc, const char **argv, const char **envp)
{
  int v3; // eax
  signed int v4; // esi
  signed int v5; // eax
  signed int v6; // ebx
  signed int v7; // edi
  signed int v8; // esi
  int v9; // edx
  int *v10; // eax
  char v11; // cl
  int *v12; // eax
  char v13; // cl
  char *v14; // eax
  char v15; // cl
  signed int v16; // esi
  int *v17; // edi
  signed int i; // esi
  int v20; // [esp+Ch] [ebp-ACh]
  signed int v21; // [esp+10h] [ebp-A8h]
  int *v22; // [esp+14h] [ebp-A4h]
  signed int v23; // [esp+18h] [ebp-A0h]
  int v24; // [esp+1Ch] [ebp-9Ch]
  int v25; // [esp+20h] [ebp-98h]
  int v26; // [esp+24h] [ebp-94h]
  int v27; // [esp+28h] [ebp-90h]
  int v28; // [esp+2Ch] [ebp-8Ch]
  int v29; // [esp+30h] [ebp-88h]
  int v30; // [esp+34h] [ebp-84h]
  int v31; // [esp+38h] [ebp-80h]
  int v32; // [esp+3Ch] [ebp-7Ch]
  int v33; // [esp+40h] [ebp-78h]
  int v34; // [esp+44h] [ebp-74h]
  int v35; // [esp+48h] [ebp-70h]
  int v36; // [esp+4Ch] [ebp-6Ch]
  int v37[3]; // [esp+50h] [ebp-68h]
  char v38; // [esp+5Ch] [ebp-5Ch]
  int v39; // [esp+68h] [ebp-50h]
  int v40; // [esp+6Ch] [ebp-4Ch]
  int v41; // [esp+70h] [ebp-48h]
  __int16 v42; // [esp+74h] [ebp-44h]
  int v43; // [esp+78h] [ebp-40h]
  __int16 v44; // [esp+7Ch] [ebp-3Ch]
  int v45; // [esp+7Eh] [ebp-3Ah]
  int v46; // [esp+82h] [ebp-36h]
  int v47; // [esp+86h] [ebp-32h]
  __int16 v48; // [esp+8Ah] [ebp-2Eh]
  int v49; // [esp+8Ch] [ebp-2Ch]
  char v50; // [esp+90h] [ebp-28h]
  int v51; // [esp+91h] [ebp-27h]
  int v52; // [esp+95h] [ebp-23h]
  int v53; // [esp+99h] [ebp-1Fh]
  __int16 v54; // [esp+9Dh] [ebp-1Bh]
  char v55; // [esp+9Fh] [ebp-19h]
  int v56; // [esp+A0h] [ebp-18h]
  __int16 v57; // [esp+A4h] [ebp-14h]
  int v58; // [esp+A6h] [ebp-12h]
  int v59; // [esp+AAh] [ebp-Eh]
  int v60; // [esp+AEh] [ebp-Ah]
  __int16 v61; // [esp+B2h] [ebp-6h]

  v44 = 0;
  v50 = 0;
  v49 = 6451010;
  v57 = 0;
  v56 = 1819435331;
  v40 = 1231382892;
  v43 = 2036624961;
  v39 = 1866884462;
  v45 = 0;
  v46 = 0;
  v47 = 0;
  v48 = 0;
  v51 = 0;
  v52 = 0;
  v53 = 0;
  v54 = 0;
  v55 = 0;
  v58 = 0;
  v59 = 0;
  v60 = 0;
  v61 = 0;
  v24 = 2;
  v25 = 5;
  v26 = 9;
  v27 = 6;
  v28 = 7;
  v29 = 0;
  v30 = 10;
  v31 = 8;
  v32 = 12;
  v33 = 11;
  v34 = 3;
  v35 = 4;
  v36 = 1;
  v41 = 1213493864;
  v42 = 101;
  v23 = 0;
  do
  {
    v3 = _time64(0);
    srand(v23 + v3);
    v4 = 0;
    do
      *(&amp;v36 + ++v4) = rand() % 100;
    while ( v4 &lt; 3 );
    v5 = 3;
    v21 = 3;
    do
    {
      v6 = 1;
      if ( v5 &gt; 1 )
      {
        v22 = &amp;v49;
        v7 = 28;
        v8 = -12;
        do
        {
          v9 = *(&amp;v36 + v6);
          v20 = v37[v6];
          if ( v20 &gt; v9 )
          {
            v10 = v22;
            do
            {
              v11 = *(_BYTE *)v10;
              LOBYTE(v10[v8]) = *(_BYTE *)v10;
              v10 = (int *)((char *)v10 + 1);
            }
            while ( v11 );
            v37[v6] = v9;
            v12 = v22 - 5;
            do
            {
              v13 = *(_BYTE *)v12;
              *((_BYTE *)v12 + 20) = *(_BYTE *)v12;
              v12 = (int *)((char *)v12 + 1);
            }
            while ( v13 );
            *(&amp;v36 + v6) = v20;
            v14 = &amp;v38;
            do
            {
              v15 = *v14;
              v14[v7] = *v14;
              ++v14;
            }
            while ( v15 );
            v5 = v21;
          }
          v22 += 5;
          ++v6;
          v8 -= 5;
          v7 += 20;
        }
        while ( v6 &lt; v5 );
      }
      v21 = --v5;
    }
    while ( v5 &gt; 0 );
    v16 = 0;
    v17 = &amp;v43;
    do
    {
      printf(&quot;%s\t%d\n&quot;, v17, v37[v16++]);
      v17 += 5;
    }
    while ( v16 &lt; 3 );
    if ( strcmp((const char *)&amp;v43, &quot;Andy&quot;) )
      break;
    ++v23;
  }
  while ( v23 &lt; 13 );
  if ( !strcmp((const char *)&amp;v43, &quot;Andy&quot;) )
  {
    for ( i = 0; i &lt; v23; ++i )
      printf(&quot;%c&quot;, *((char *)&amp;v39 + *(&amp;v24 + i)));
  }
  system(&quot;pause&quot;);
  return 0;
}
</code></pre>
<p>脚本：</p>
<pre><code class="python">#!/usr/bin/env python
k = [2, 5, 9, 6, 7, 0, 0xA, 8, 0xC, 0xB, 3, 4, 1]
t = &#39;oFen&#39;[::-1] + &#39;Ieil&#39;[::-1] + &#39;HTrh&#39;[::-1] + &#39;e&#39;
flag = &#39;&#39;
for i in range(13):
    flag += t[k[i]]
print flag
</code></pre>
<h1 id="第七题"><a href="#第七题" class="headerlink" title="第七题"></a>第七题</h1><pre><code>$ file 7.exe
7.exe: PE32 executable (console) Intel 80386, for MS Windows
</code></pre><p>简单地异或一下：</p>
<pre><code class="cpp">_BYTE *__cdecl sub_401000(char *a1)
{
  _BYTE *v2; // [esp+0h] [ebp-8h]
  signed int i; // [esp+4h] [ebp-4h]

  v2 = malloc(0xAu);
  for ( i = 0; i &lt; 9; ++i )
    v2[i] = a1[i] + 2;
  v2[9] = 0;
  return v2;
}
</code></pre>
<p>脚本：</p>
<pre><code class="python">#!/usr/bin/env python
enc = &#39;asdfghjklq&#39;
flag = &#39;&#39;
for i in range(9):
    flag += chr(ord(enc[i]) + 2)
print flag
</code></pre>

            </div>
            <hr>
            <div>
              <p>
                
                
                  <span>
                <i class="iconfont icon-tag"></i>
                    
                      <a class="hover-with-bg" href="/tags/re/">re</a>
                    
                      <a class="hover-with-bg" href="/tags/ctf/">ctf</a>
                    
                      <a class="hover-with-bg" href="/tags/wp/">wp</a>
                    
                  </span>
                
              </p>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-12 col-md-6">
                    
                      <a href="/2019/09/01/如何使用IDA创建结构体/">
                        <i class="fa fa-chevron-left"></i>
                        <span>如何使用IDA创建结构体</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-12 col-md-6">
                    
                      <a href="/2019/08/22/Python实现TEA、XTEA、XXTEA加密解密算法/">
                        <span>Python实现TEA、XTEA、XXTEA加密解密算法</span>
                        <i class="fa fa-chevron-right"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

              
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc-start"></div>
<div id="toc">
  <p class="h5"><i class="far fa-list-alt"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="http://blog.b3ale.cn" target="_blank" rel="nofollow noopener"><b>Hard Work Pays Off.</b></a>
    </div>
    
  <div>
    
      <!-- 不蒜子统计PV -->
      
      <span id="busuanzi_container_site_pv" style="display: none">
      总访问量 <span id="busuanzi_value_site_pv"></span> 次
    </span>
    
    
      <!-- 不蒜子统计UV -->
      
      <span id="busuanzi_container_site_uv" style="display: none">
      总访客数 <span id="busuanzi_value_site_uv"></span> 人
    </span>
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js"></script>
<script src="/js/main.js"></script>


  <script src="/js/lazyload.js"></script>



  
  <script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script>
  <script>
    $(document).ready(function () {
      var navHeight = $('#navbar').height();
      var toc = $('#toc');
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;
      var tocLimMax = 2 * boardTop + boardCtn.height();

      $(window).scroll(function () {
        var tocLimMin = $('#toc-start').offset().top - navHeight;
        var scroH = document.body.scrollTop + document.documentElement.scrollTop;

        if (tocLimMin <= scroH && scroH <= tocLimMax) {
          toc.css({
            'display': 'block',
            'position': 'fixed',
            'top': navHeight,
          });
        } else if (scroH <= tocLimMin) {
          toc.css({
            'position': '',
            'top': '',
          });
        } else if (scroH > tocLimMax) {
          toc.css('display', 'none');
        }
      });
      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc > p').css('visibility', 'visible');
      }
      var offset = boardCtn.css('margin-right')
      $('#toc-ctn').css({
        'right': offset
      })
    });
  </script>







  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<!-- Plugins -->



  <script src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js"></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "杭电CTF-题库-reverse&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js"></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>



  

  
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
              processEscapes: true,
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
          }
      });

      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });

    </script>

    <script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  










</body>
</html>
