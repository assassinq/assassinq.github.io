<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>2020春节-吾爱破解解题领红包活动 | AssassinQ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="rewp">
  
  
  
  
  <meta name="description" content="第二次参加领红包活动，这次有两题是 apk。">
<meta name="keywords" content="re,wp">
<meta property="og:type" content="article">
<meta property="og:title" content="2020春节-吾爱破解解题领红包活动">
<meta property="og:url" content="blog.b3ale.cn/2020/02/11/[TODO]2020春节-吾爱破解解题领红包活动/index.html">
<meta property="og:site_name" content="AssassinQ">
<meta property="og:description" content="第二次参加领红包活动，这次有两题是 apk。">
<meta property="og:locale" content="default">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/1.jpg">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/2.png">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/3.png">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/4.png">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/5.png">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/6.png">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/7.png">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/8.jpg">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/9.png">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/10.png">
<meta property="og:image" content="/pics/2020春节-吾爱破解解题领红包活动/11.jpg">
<meta property="og:updated_time" content="2020-03-15T04:07:00.942Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2020春节-吾爱破解解题领红包活动">
<meta name="twitter:description" content="第二次参加领红包活动，这次有两题是 apk。">
<meta name="twitter:image" content="/pics/2020春节-吾爱破解解题领红包活动/1.jpg">
  
    <link rel="alternate" href="/atom.xml" title="AssassinQ" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css">
  <link rel="stylesheet" href="/css/fashion.css">
  <link rel="stylesheet" href="/css/glyphs.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>
</html>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-header-image">
    <img id="originBg" width="100%" alt="Hike News" src>
  </div>

  <div id="header-blur" class="site-header-image blur" style="position: absolute; top:0; height: 207px; min-height: 207px; min-width: 100%;">
    <img id="blurBg" width="100%" style="top: 96%" alt="Hike News" src>
  </div>

  <script>
        var imgUrls = "css/images/pose01.jpg".split(",");
        var random = Math.floor((Math.random() * imgUrls.length ));
        if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
          document.getElementById("originBg").src=imgUrls[random];
          document.getElementById("blurBg").src=imgUrls[random];
        } else {
          document.getElementById("originBg").src='/' + imgUrls[random];
          document.getElementById("blurBg").src='/' + imgUrls[random];
        }
    </script>




<header id="allheader" class="site-header" role="banner" style="width: 100%; position: absolute; top:0; background: rgba(255,255,255,.8);">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="AssassinQ" rel="home"> AssassinQ </a>
            
          </h1>
          
          
            <div class="site-description">ZJGSU-IS-17</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows" style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/tags">Tags</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/about">About</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-[TODO]2020春节-吾爱破解解题领红包活动" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      2020春节-吾爱破解解题领红包活动
    </h1>
  

      </header>
    
    <div class="article-meta">
      	<a href="/2020/02/11/[TODO]2020春节-吾爱破解解题领红包活动/" class="article-date">
	  <time datetime="2020-02-11T03:37:58.000Z" itemprop="datePublished">February 11, 2020</time>
	</a>

       
      

	  |
	  5.3k words
	  |
	  29 minute(s) to read
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>第二次参加领红包活动，这次有两题是 apk。</p>
<a id="more"></a>
<h1 id="【春节】解题领红包之一"><a href="#【春节】解题领红包之一" class="headerlink" title="【春节】解题领红包之一"></a>【春节】解题领红包之一</h1><p>公众号回复直接得到口令：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/1.jpg" alt="公众号直接获取口令"></p>
<h1 id="【春节】解题领红包之二"><a href="#【春节】解题领红包之二" class="headerlink" title="【春节】解题领红包之二"></a>【春节】解题领红包之二</h1><p>查壳发现有 ASPack 壳，直接上 ESP 定律把壳脱掉：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/2.png" alt="Exeinfo查壳"></p>
<p>然后用 OD 看一下 dump 下来的程序，先搜索字符串，可以看到输入正确后返回的字符串：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/3.png" alt="发现关键字符串"></p>
<p>然后定位到具体的函数位置，看下来感觉有点复杂，但大概可以看到涉及到了三个字符串，可以判断出是类似 MD5 的哈希摘要：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">00617D34   .  8D4D F0       LEA ECX,DWORD PTR SS:[EBP-0x10]</span><br><span class="line">00617D37   .  8B15 04786200 MOV EDX,DWORD PTR DS:[0x627804]   ;  dumped_.0062B6AC</span><br><span class="line">00617D3D   .  8B12          MOV EDX,DWORD PTR DS:[EDX]</span><br><span class="line">00617D3F   .  8D45 FC       LEA EAX,DWORD PTR SS:[EBP-0x4]</span><br><span class="line">00617D42   .  E8 597DE1FF   CALL dumped_.0042FAA0</span><br><span class="line">00617D47   .  8B45 F0       MOV EAX,DWORD PTR SS:[EBP-0x10]</span><br><span class="line">00617D4A   .  BA B87E6100   MOV EDX,dumped_.00617EB8          ;  E7EE5F4653E31955CACC7CD68E2A7839</span><br><span class="line">00617D4F   .  E8 A42DDFFF   CALL dumped_.0040AAF8</span><br><span class="line">00617D54   .  0F9445 E7     SETE BYTE PTR SS:[EBP-0x19]</span><br><span class="line">00617D58   .  33C0          XOR EAX,EAX</span><br><span class="line">00617D5A   .  5A            POP EDX</span><br><span class="line">00617D5B   .  59            POP ECX</span><br><span class="line">00617D5C   .  59            POP ECX</span><br><span class="line">00617D5D   .  64:8910       MOV DWORD PTR FS:[EAX],EDX</span><br><span class="line">00617D60   .  68 757D6100   PUSH dumped_.00617D75</span><br><span class="line">00617D65   &gt;  8D45 F0       LEA EAX,DWORD PTR SS:[EBP-0x10]</span><br><span class="line">00617D68   .  E8 4F1FDFFF   CALL dumped_.00409CBC</span><br><span class="line">00617D6D   .  C3            RETN</span><br><span class="line">00617D6E   .- E9 6515DFFF   JMP dumped_.004092D8</span><br><span class="line">00617D73   .^ EB F0         JMP SHORT dumped_.00617D65</span><br><span class="line">00617D75   .  807D E7 00    CMP BYTE PTR SS:[EBP-0x19],0x0</span><br><span class="line">00617D79   .  74 57         JE SHORT dumped_.00617DD2</span><br><span class="line">00617D7B   .  33C0          XOR EAX,EAX</span><br><span class="line">00617D7D   .  55            PUSH EBP</span><br><span class="line">00617D7E   .  68 CB7D6100   PUSH dumped_.00617DCB</span><br><span class="line">00617D83   .  64:FF30       PUSH DWORD PTR FS:[EAX]</span><br><span class="line">00617D86   .  64:8920       MOV DWORD PTR FS:[EAX],ESP</span><br><span class="line">00617D89   .  8D45 EC       LEA EAX,DWORD PTR SS:[EBP-0x14]</span><br><span class="line">00617D8C   .  E8 2B1FDFFF   CALL dumped_.00409CBC</span><br><span class="line">00617D91   .  8D4D EC       LEA ECX,DWORD PTR SS:[EBP-0x14]</span><br><span class="line">00617D94   .  8B15 04786200 MOV EDX,DWORD PTR DS:[0x627804]   ;  dumped_.0062B6AC</span><br><span class="line">00617D9A   .  8B12          MOV EDX,DWORD PTR DS:[EDX]</span><br><span class="line">00617D9C   .  8D45 F8       LEA EAX,DWORD PTR SS:[EBP-0x8]</span><br><span class="line">00617D9F   .  E8 7C7CE1FF   CALL dumped_.0042FA20</span><br><span class="line">00617DA4   .  8B45 EC       MOV EAX,DWORD PTR SS:[EBP-0x14]</span><br><span class="line">00617DA7   .  BA 087F6100   MOV EDX,dumped_.00617F08          ;  ea6b2efbdd4255a9f1b3bbc6399b58f4</span><br><span class="line">00617DAC   .  E8 472DDFFF   CALL dumped_.0040AAF8</span><br><span class="line">00617DB1   .  0F9445 E6     SETE BYTE PTR SS:[EBP-0x1A]</span><br><span class="line">00617DB5   .  33C0          XOR EAX,EAX</span><br><span class="line">00617DB7   .  5A            POP EDX</span><br><span class="line">00617DB8   .  59            POP ECX</span><br><span class="line">00617DB9   .  59            POP ECX</span><br><span class="line">00617DBA   .  64:8910       MOV DWORD PTR FS:[EAX],EDX</span><br><span class="line">00617DBD   .  68 D67D6100   PUSH dumped_.00617DD6</span><br><span class="line">00617DC2   &gt;  8D45 EC       LEA EAX,DWORD PTR SS:[EBP-0x14]</span><br><span class="line">00617DC5   .  E8 F21EDFFF   CALL dumped_.00409CBC</span><br><span class="line">00617DCA   .  C3            RETN</span><br><span class="line">00617DCB   .- E9 0815DFFF   JMP dumped_.004092D8</span><br><span class="line">00617DD0   .^ EB F0         JMP SHORT dumped_.00617DC2</span><br><span class="line">00617DD2   &gt;  C645 E6 00    MOV BYTE PTR SS:[EBP-0x1A],0x0</span><br><span class="line">00617DD6   .  807D E6 00    CMP BYTE PTR SS:[EBP-0x1A],0x0</span><br><span class="line">00617DDA   .  74 6D         JE SHORT dumped_.00617E49</span><br><span class="line">00617DDC   .  33C0          XOR EAX,EAX</span><br><span class="line">00617DDE   .  55            PUSH EBP</span><br><span class="line">00617DDF   .  68 2C7E6100   PUSH dumped_.00617E2C</span><br><span class="line">00617DE4   .  64:FF30       PUSH DWORD PTR FS:[EAX]</span><br><span class="line">00617DE7   .  64:8920       MOV DWORD PTR FS:[EAX],ESP</span><br><span class="line">00617DEA   .  8D45 E8       LEA EAX,DWORD PTR SS:[EBP-0x18]</span><br><span class="line">00617DED   .  E8 CA1EDFFF   CALL dumped_.00409CBC</span><br><span class="line">00617DF2   .  8D4D E8       LEA ECX,DWORD PTR SS:[EBP-0x18]</span><br><span class="line">00617DF5   .  8B15 04786200 MOV EDX,DWORD PTR DS:[0x627804]   ;  dumped_.0062B6AC</span><br><span class="line">00617DFB   .  8B12          MOV EDX,DWORD PTR DS:[EDX]</span><br><span class="line">00617DFD   .  8D45 F4       LEA EAX,DWORD PTR SS:[EBP-0xC]</span><br><span class="line">00617E00   .  E8 1B7CE1FF   CALL dumped_.0042FA20</span><br><span class="line">00617E05   .  8B45 E8       MOV EAX,DWORD PTR SS:[EBP-0x18]</span><br><span class="line">00617E08   .  BA 587F6100   MOV EDX,dumped_.00617F58          ;  c8d46d341bea4fd5bff866a65ff8aea9</span><br><span class="line">00617E0D   .  E8 E62CDFFF   CALL dumped_.0040AAF8</span><br><span class="line">00617E12   .  0F9445 E5     SETE BYTE PTR SS:[EBP-0x1B]</span><br><span class="line">00617E16   .  33C0          XOR EAX,EAX</span><br><span class="line">00617E18   .  5A            POP EDX</span><br><span class="line">00617E19   .  59            POP ECX</span><br><span class="line">00617E1A   .  59            POP ECX</span><br><span class="line">00617E1B   .  64:8910       MOV DWORD PTR FS:[EAX],EDX</span><br><span class="line">00617E1E   .  68 337E6100   PUSH dumped_.00617E33</span><br><span class="line">00617E23   &gt;  8D45 E8       LEA EAX,DWORD PTR SS:[EBP-0x18]</span><br><span class="line">00617E26   .  E8 911EDFFF   CALL dumped_.00409CBC</span><br><span class="line">00617E2B   .  C3            RETN</span><br><span class="line">00617E2C   .- E9 A714DFFF   JMP dumped_.004092D8</span><br><span class="line">00617E31   .^ EB F0         JMP SHORT dumped_.00617E23</span><br><span class="line">00617E33   .  807D E5 00    CMP BYTE PTR SS:[EBP-0x1B],0x0</span><br><span class="line">00617E37   .  74 10         JE SHORT dumped_.00617E49</span><br><span class="line">00617E39   .  83C9 FF       OR ECX,-0x1</span><br><span class="line">00617E3C   .  83CA FF       OR EDX,-0x1</span><br><span class="line">00617E3F   .  B8 A87F6100   MOV EAX,dumped_.00617FA8          ;  请把答案回复到论坛公众号！</span><br><span class="line">00617E44   .  E8 236BF5FF   CALL dumped_.0056E96C</span><br></pre></td></tr></table></figure>
<p>抛弃 OD，把 dump 下来的程序导入 IDA，根据前面找到的 unicode 字符串定位到函数，反编译后得到如下代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">TForm1_edtPwdChange</span><span class="params">(<span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> v1; <span class="comment">// ebx</span></span><br><span class="line">  <span class="keyword">int</span> v2; <span class="comment">// edx</span></span><br><span class="line">  <span class="keyword">int</span> len; <span class="comment">// eax</span></span><br><span class="line">  <span class="keyword">int</span> md5Handler; <span class="comment">// esi</span></span><br><span class="line">  <span class="keyword">char</span> v5; <span class="comment">// zf</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v7; <span class="comment">// [esp-18h] [ebp-58h]</span></span><br><span class="line">  <span class="keyword">int</span> *v8; <span class="comment">// [esp-14h] [ebp-54h]</span></span><br><span class="line">  <span class="keyword">char</span> *v9; <span class="comment">// [esp-10h] [ebp-50h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> v10; <span class="comment">// [esp-Ch] [ebp-4Ch]</span></span><br><span class="line">  <span class="keyword">void</span> *v11; <span class="comment">// [esp-8h] [ebp-48h]</span></span><br><span class="line">  <span class="keyword">int</span> *v12; <span class="comment">// [esp-4h] [ebp-44h]</span></span><br><span class="line">  <span class="keyword">int</span> v13; <span class="comment">// [esp+8h] [ebp-38h]</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// [esp+Ch] [ebp-34h]</span></span><br><span class="line">  <span class="keyword">int</span> v15; <span class="comment">// [esp+10h] [ebp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [esp+14h] [ebp-2Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// [esp+18h] [ebp-28h]</span></span><br><span class="line">  <span class="keyword">int</span> v18; <span class="comment">// [esp+1Ch] [ebp-24h]</span></span><br><span class="line">  <span class="keyword">int</span> v19; <span class="comment">// [esp+20h] [ebp-20h]</span></span><br><span class="line">  <span class="keyword">char</span> v20; <span class="comment">// [esp+25h] [ebp-1Bh]</span></span><br><span class="line">  <span class="keyword">char</span> v21; <span class="comment">// [esp+26h] [ebp-1Ah]</span></span><br><span class="line">  <span class="keyword">char</span> v22; <span class="comment">// [esp+27h] [ebp-19h]</span></span><br><span class="line">  <span class="keyword">char</span> *string3; <span class="comment">// [esp+28h] [ebp-18h]</span></span><br><span class="line">  <span class="keyword">char</span> *string2; <span class="comment">// [esp+2Ch] [ebp-14h]</span></span><br><span class="line">  <span class="keyword">char</span> *string1; <span class="comment">// [esp+30h] [ebp-10h]</span></span><br><span class="line">  <span class="keyword">char</span> s3; <span class="comment">// [esp+34h] [ebp-Ch]</span></span><br><span class="line">  <span class="keyword">char</span> s2; <span class="comment">// [esp+38h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">char</span> s1; <span class="comment">// [esp+3Ch] [ebp-4h]</span></span><br><span class="line">  <span class="keyword">int</span> savedregs; <span class="comment">// [esp+40h] [ebp+0h]</span></span><br><span class="line"></span><br><span class="line">  v1 = a1;</span><br><span class="line">  v12 = &amp;savedregs;</span><br><span class="line">  v11 = &amp;loc_617E9C;</span><br><span class="line">  v10 = __readfsdword(<span class="number">0</span>);</span><br><span class="line">  __writefsdword(<span class="number">0</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;v10);</span><br><span class="line">  sub_541DB8(*(Controls::TControl **)(a1 + <span class="number">976</span>), &amp;v19);</span><br><span class="line">  len = v19;</span><br><span class="line">  <span class="keyword">if</span> ( v19 )</span><br><span class="line">    len = *(_DWORD *)(v19 - <span class="number">4</span>);</span><br><span class="line">  <span class="keyword">if</span> ( len == <span class="number">15</span> )                              <span class="comment">// input's length should be 15</span></span><br><span class="line">  &#123;</span><br><span class="line">    LOBYTE(v2) = <span class="number">1</span>;</span><br><span class="line">    md5Handler = sub_616B84(&amp;cls_IdHashMessageDigest_TIdHashMessageDigest5, v2);<span class="comment">// get MD5 handler</span></span><br><span class="line">    v9 = &amp;s1;</span><br><span class="line">    sub_541DB8(*(Controls::TControl **)(v1 + <span class="number">976</span>), &amp;v17);</span><br><span class="line">    sub_50F2EC(v17, <span class="number">7</span>, &amp;v18);</span><br><span class="line">    registerFunc(md5Handler, v18, <span class="number">0</span>, (<span class="keyword">int</span>)&amp;s1);</span><br><span class="line">    v9 = &amp;s2;</span><br><span class="line">    v8 = &amp;v16;</span><br><span class="line">    sub_541DB8(*(Controls::TControl **)(v1 + <span class="number">976</span>), &amp;v15);</span><br><span class="line">    Compprod::TComponentsPageProducer::HandleTag(&amp;v16);</span><br><span class="line">    registerFunc(md5Handler, v16, <span class="number">0</span>, (<span class="keyword">int</span>)&amp;s2);</span><br><span class="line">    v9 = &amp;s3;</span><br><span class="line">    sub_541DB8(*(Controls::TControl **)(v1 + <span class="number">976</span>), &amp;v13);</span><br><span class="line">    unknown_libname_807(v13, <span class="number">4</span>, &amp;v14);</span><br><span class="line">    registerFunc(md5Handler, v14, <span class="number">0</span>, (<span class="keyword">int</span>)&amp;s3);</span><br><span class="line">    v9 = (<span class="keyword">char</span> *)&amp;savedregs;</span><br><span class="line">    v8 = (<span class="keyword">int</span> *)&amp;loc_617D6E;</span><br><span class="line">    v7 = __readfsdword(<span class="number">0</span>);</span><br><span class="line">    __writefsdword(<span class="number">0</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;v7);</span><br><span class="line">    freeMem(&amp;string1);</span><br><span class="line">    sub_42FAA0((<span class="keyword">int</span> *)&amp;s1, <span class="number">0</span>, (<span class="keyword">int</span> *)&amp;string1);</span><br><span class="line">    compareStr(string1, (<span class="keyword">char</span> *)<span class="string">L"E7EE5F4653E31955CACC7CD68E2A7839"</span>);<span class="comment">// compare string1</span></span><br><span class="line">    v22 = v5;</span><br><span class="line">    __writefsdword(<span class="number">0</span>, v7);</span><br><span class="line">    v9 = (<span class="keyword">char</span> *)&amp;loc_617D75;</span><br><span class="line">    freeMem(&amp;string1);</span><br><span class="line">    <span class="keyword">if</span> ( v22 )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = (<span class="keyword">char</span> *)&amp;savedregs;</span><br><span class="line">      v8 = (<span class="keyword">int</span> *)&amp;loc_617DCB;</span><br><span class="line">      v7 = __readfsdword(<span class="number">0</span>);</span><br><span class="line">      __writefsdword(<span class="number">0</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;v7);</span><br><span class="line">      freeMem(&amp;string2);</span><br><span class="line">      sub_42FA20(&amp;s2, <span class="number">0</span>, &amp;string2);</span><br><span class="line">      compareStr(string2, (<span class="keyword">char</span> *)<span class="string">L"ea6b2efbdd4255a9f1b3bbc6399b58f4"</span>);<span class="comment">// compare string2</span></span><br><span class="line">      v21 = v5;</span><br><span class="line">      __writefsdword(<span class="number">0</span>, v7);</span><br><span class="line">      v9 = (<span class="keyword">char</span> *)&amp;loc_617DD6;</span><br><span class="line">      freeMem(&amp;string2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">      v21 = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( v21 )</span><br><span class="line">    &#123;</span><br><span class="line">      v9 = (<span class="keyword">char</span> *)&amp;savedregs;</span><br><span class="line">      v8 = (<span class="keyword">int</span> *)&amp;loc_617E2C;</span><br><span class="line">      v7 = __readfsdword(<span class="number">0</span>);</span><br><span class="line">      __writefsdword(<span class="number">0</span>, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;v7);</span><br><span class="line">      freeMem(&amp;string3);</span><br><span class="line">      sub_42FA20(&amp;s3, <span class="number">0</span>, &amp;string3);</span><br><span class="line">      compareStr(string3, (<span class="keyword">char</span> *)<span class="string">L"c8d46d341bea4fd5bff866a65ff8aea9"</span>);<span class="comment">// compare string3</span></span><br><span class="line">      v20 = v5;</span><br><span class="line">      __writefsdword(<span class="number">0</span>, v7);</span><br><span class="line">      v9 = (<span class="keyword">char</span> *)&amp;loc_617E33;</span><br><span class="line">      freeMem(&amp;string3);</span><br><span class="line">      <span class="keyword">if</span> ( v20 )                                <span class="comment">// Success</span></span><br><span class="line">        createDialog((<span class="keyword">int</span>)<span class="string">L"请把答案回复到论坛公众号！"</span>, <span class="number">-1</span>, <span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  __writefsdword(<span class="number">0</span>, v10);</span><br><span class="line">  v12 = (<span class="keyword">int</span> *)&amp;loc_617EA3;</span><br><span class="line">  freeMem(&amp;v13);</span><br><span class="line">  freeMem(&amp;v14);</span><br><span class="line">  freeMem(&amp;v15);</span><br><span class="line">  freeMem(&amp;v16);</span><br><span class="line">  freeMem(&amp;v17);</span><br><span class="line">  freeMem(&amp;v18);</span><br><span class="line">  freeMem(&amp;v19);</span><br><span class="line">  <span class="keyword">return</span> sub_409D1C(&amp;string3, <span class="number">6</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>反编译后的代码也比较含糊，但可以猜到，输入的字符串长度为 15，字符串被分成了 3 部分，每部分分别进行 MD5 哈希，并与内存中的字符串进行比较，字符串正确就会弹出一个正确的对话窗口。MD5 在理论上是不可逆的，但可以在通过搜索引擎查找网上已经被爆破出的对应的明文。第一部分的解密结果：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/4.png" alt="第一个md5的原字符串"></p>
<p>第二部分的解密结果：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/5.png" alt="第二个md5的原字符串"></p>
<p>第三部分的解密结果：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/6.png" alt="第三个md5的原字符串"></p>
<p>将得到的字符串拼接并进行验证：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/7.png" alt="检验字符串"></p>
<p>回复公众号得到口令</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/8.jpg" alt="得到口令"></p>
<h1 id="【春节】解题领红包之三"><a href="#【春节】解题领红包之三" class="headerlink" title="【春节】解题领红包之三"></a>【春节】解题领红包之三</h1><p>这题给的是一个 apk，先使用 jdax 打开，查看程序入口点 MainActivity，得到如下代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wuaipojie.crackme01;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.View.OnClickListener;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">OnClickListener</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Button btn_click;</span><br><span class="line">    <span class="keyword">private</span> EditText editText;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">native</span> <span class="keyword">boolean</span> <span class="title">checkFlag</span><span class="params">(String str)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="comment">/* JADX: method processing error */</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">Error: java.lang.NullPointerException</span></span><br><span class="line"><span class="comment">	at jadx.core.dex.visitors.regions.ProcessTryCatchRegions.searchTryCatchDominators(ProcessTryCatchRegions.java:75)</span></span><br><span class="line"><span class="comment">	at jadx.core.dex.visitors.regions.ProcessTryCatchRegions.process(ProcessTryCatchRegions.java:45)</span></span><br><span class="line"><span class="comment">	at jadx.core.dex.visitors.regions.RegionMakerVisitor.postProcessRegions(RegionMakerVisitor.java:63)</span></span><br><span class="line"><span class="comment">	at jadx.core.dex.visitors.regions.RegionMakerVisitor.visit(RegionMakerVisitor.java:58)</span></span><br><span class="line"><span class="comment">	at jadx.core.dex.visitors.DepthTraversal.visit(DepthTraversal.java:31)</span></span><br><span class="line"><span class="comment">	at jadx.core.dex.visitors.DepthTraversal.visit(DepthTraversal.java:17)</span></span><br><span class="line"><span class="comment">	at jadx.core.ProcessClass.process(ProcessClass.java:37)</span></span><br><span class="line"><span class="comment">	at jadx.api.JadxDecompiler.processClass(JadxDecompiler.java:280)</span></span><br><span class="line"><span class="comment">	at jadx.api.JavaClass.decompile(JavaClass.java:62)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        r0 = "crack_j2c";	 Catch:&#123; UnsatisfiedLinkError -&gt; 0x0005 &#125;</span></span><br><span class="line"><span class="comment">        java.lang.System.loadLibrary(r0);	 Catch:&#123; UnsatisfiedLinkError -&gt; 0x0005 &#125;</span></span><br><span class="line"><span class="comment">    L_0x0005:</span></span><br><span class="line"><span class="comment">        return;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> UnsupportedOperationException(<span class="string">"Method not decompiled: com.wuaipojie.crackme01.MainActivity.&lt;clinit&gt;():void"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle bundle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(bundle);</span><br><span class="line">        setContentView((<span class="keyword">int</span>) R.layout.activity_main);</span><br><span class="line">        <span class="keyword">this</span>.editText = (EditText) findViewById(R.id.input_flag);</span><br><span class="line">        Button button = (Button) findViewById(R.id.button);</span><br><span class="line">        <span class="keyword">this</span>.btn_click = button;</span><br><span class="line">        button.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>主要有三个函数，<code>onCreate()</code> 在 Java 层中实现，可以看出整个界面中有一个文本框和一个按钮，并设置了一个按钮的监听事件，即 onClick；<code>onClick()</code> 和 <code>checkFlag()</code> 可以看到是在 Native 层进行实现的，可以从 lib 文件夹中找到 so 文件，接下来用 IDA 对 so 中的两个函数进行分析。导入 IDA 后，通过函数名可以看出两个函数通过静态注册：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/9.png" alt="Native函数通过静态注册"></p>
<p>然后先来看 onClick 函数。这边略过一些导入 jni.h 等一些分析的过程（一般静态注册函数的第一个参数是 JNIEnv 等等），在分析的过程中大致猜测出两个函数 <code>sub_5288</code> 和 <code>sub_539C</code> 两个函数分别用来获取指定的方法（getMethod）或者是域（getField）。接下来直接来看分析过后的代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> __<span class="function">fastcall <span class="title">Java_com_wuaipojie_crackme01_MainActivity_onClick__Landroid_view_View_2</span><span class="params">(_JNIEnv *env, <span class="keyword">int</span> a2, <span class="keyword">int</span> a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _JNIEnv *env_; <span class="comment">// r4</span></span><br><span class="line">  <span class="keyword">int</span> v4; <span class="comment">// r5</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// r9</span></span><br><span class="line">  <span class="keyword">int</span> v6; <span class="comment">// r0</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// r5</span></span><br><span class="line">  jstring (__cdecl *v8)(JNIEnv *, <span class="keyword">const</span> <span class="keyword">char</span> *); <span class="comment">// r2</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// r6</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// r6</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// r8</span></span><br><span class="line">  <span class="keyword">int</span> len; <span class="comment">// r5</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// r5</span></span><br><span class="line">  <span class="keyword">const</span> <span class="keyword">char</span> *v15; <span class="comment">// r1</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// r6</span></span><br><span class="line">  <span class="keyword">int</span> v17; <span class="comment">// r5</span></span><br><span class="line">  <span class="keyword">int</span> result; <span class="comment">// r0</span></span><br><span class="line">  JNINativeMethod method; <span class="comment">// [sp+4h] [bp-74h]</span></span><br><span class="line">  <span class="keyword">int</span> v20; <span class="comment">// [sp+10h] [bp-68h]</span></span><br><span class="line">  <span class="keyword">int</span> v21; <span class="comment">// [sp+14h] [bp-64h]</span></span><br><span class="line">  <span class="keyword">int</span> v22; <span class="comment">// [sp+18h] [bp-60h]</span></span><br><span class="line">  <span class="keyword">int</span> v23; <span class="comment">// [sp+1Ch] [bp-5Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v24; <span class="comment">// [sp+20h] [bp-58h]</span></span><br><span class="line">  <span class="keyword">int</span> v25; <span class="comment">// [sp+24h] [bp-54h]</span></span><br><span class="line">  <span class="keyword">int</span> a3a; <span class="comment">// [sp+28h] [bp-50h]</span></span><br><span class="line">  <span class="keyword">int</span> v27; <span class="comment">// [sp+2Ch] [bp-4Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v28; <span class="comment">// [sp+30h] [bp-48h]</span></span><br><span class="line">  <span class="keyword">int</span> v29; <span class="comment">// [sp+34h] [bp-44h]</span></span><br><span class="line">  <span class="keyword">int</span> v30; <span class="comment">// [sp+38h] [bp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> a2a; <span class="comment">// [sp+3Ch] [bp-3Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v32; <span class="comment">// [sp+40h] [bp-38h]</span></span><br><span class="line">  <span class="keyword">int</span> v33; <span class="comment">// [sp+48h] [bp-30h]</span></span><br><span class="line">  <span class="keyword">int</span> v34; <span class="comment">// [sp+50h] [bp-28h]</span></span><br><span class="line">  <span class="keyword">int</span> v35; <span class="comment">// [sp+58h] [bp-20h]</span></span><br><span class="line"></span><br><span class="line">  env_ = env;</span><br><span class="line">  v4 = a3;</span><br><span class="line">  a2a = <span class="number">0</span>;</span><br><span class="line">  v29 = <span class="number">0</span>;</span><br><span class="line">  v30 = <span class="number">0</span>;</span><br><span class="line">  v27 = <span class="number">0</span>;</span><br><span class="line">  v28 = <span class="number">0</span>;</span><br><span class="line">  v25 = <span class="number">0</span>;</span><br><span class="line">  a3a = <span class="number">0</span>;</span><br><span class="line">  v23 = <span class="number">0</span>;</span><br><span class="line">  v24 = <span class="number">0</span>;</span><br><span class="line">  v21 = <span class="number">0</span>;</span><br><span class="line">  v22 = <span class="number">0</span>;</span><br><span class="line">  method.fnPtr = <span class="number">0</span>;</span><br><span class="line">  v20 = <span class="number">0</span>;</span><br><span class="line">  v5 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env-&gt;functions-&gt;NewLocalRef)(env, a2);</span><br><span class="line">  v6 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;NewLocalRef)(env_, v4);</span><br><span class="line">  <span class="keyword">if</span> ( !v5 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_38;</span><br><span class="line">  v7 = v6;</span><br><span class="line">  method.name = <span class="string">"editText"</span>;</span><br><span class="line">  method.signature = <span class="string">"Landroid/widget/EditText;"</span>;</span><br><span class="line">  <span class="keyword">if</span> ( getFields(env_, &amp;a2a, &amp;a3a, <span class="number">0</span>, <span class="string">"com/wuaipojie/crackme01/MainActivity"</span>, method) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  v9 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, <span class="keyword">int</span>))env_-&gt;functions-&gt;GetObjectField)(env_, v5, a3a);</span><br><span class="line">  <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  <span class="keyword">if</span> ( v7 )</span><br><span class="line">    ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v7);</span><br><span class="line">  <span class="keyword">if</span> ( !v9 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_38;</span><br><span class="line">  <span class="keyword">if</span> ( !v25 )</span><br><span class="line">  &#123;</span><br><span class="line">    method.name = <span class="string">"getText"</span>;</span><br><span class="line">    method.signature = <span class="string">"()Landroid/text/Editable;"</span>;</span><br><span class="line">    <span class="keyword">if</span> ( getMethods(env_, &amp;v30, &amp;v25, <span class="number">0</span>, <span class="string">"android/widget/EditText"</span>, method) )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  &#125;</span><br><span class="line">  v10 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallObjectMethodA)(env_, v9);<span class="comment">// get input string</span></span><br><span class="line">  <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v9);</span><br><span class="line">  <span class="keyword">if</span> ( !v10 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_38;</span><br><span class="line">  <span class="keyword">if</span> ( !v24 )</span><br><span class="line">  &#123;</span><br><span class="line">    method.name = <span class="string">"toString"</span>;</span><br><span class="line">    method.signature = <span class="string">"()Ljava/lang/String;"</span>;</span><br><span class="line">    <span class="keyword">if</span> ( getMethods(env_, &amp;v29, &amp;v24, <span class="number">0</span>, <span class="string">"java/lang/Object"</span>, method) )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  &#125;</span><br><span class="line">  v11 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallObjectMethodA)(env_, v10);<span class="comment">// convert object to string</span></span><br><span class="line">  <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v10);</span><br><span class="line">  <span class="keyword">if</span> ( !v11 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_38;</span><br><span class="line">  <span class="keyword">if</span> ( !v23 )</span><br><span class="line">  &#123;</span><br><span class="line">    method.name = <span class="string">"trim"</span>;</span><br><span class="line">    method.signature = <span class="string">"()Ljava/lang/String;"</span>;</span><br><span class="line">    <span class="keyword">if</span> ( getMethods(env_, &amp;v28, &amp;v23, <span class="number">0</span>, <span class="string">"java/lang/String"</span>, method) )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  &#125;</span><br><span class="line">  v12 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallObjectMethodA)(env_, v11);<span class="comment">// trim string</span></span><br><span class="line">  <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v11);</span><br><span class="line">  <span class="keyword">if</span> ( !v12 )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_38;</span><br><span class="line">  <span class="keyword">if</span> ( !v22 )</span><br><span class="line">  &#123;</span><br><span class="line">    method.name = <span class="string">"length"</span>;</span><br><span class="line">    method.signature = <span class="string">"()I"</span>;</span><br><span class="line">    <span class="keyword">if</span> ( getMethods(env_, &amp;v28, &amp;v22, <span class="number">0</span>, <span class="string">"java/lang/String"</span>, method) )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  &#125;</span><br><span class="line">  len = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallIntMethodA)(env_, v12);<span class="comment">// get string's length</span></span><br><span class="line">  <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">  <span class="keyword">if</span> ( len == <span class="number">30</span> )                              <span class="comment">// len(flag) == 30</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( !v21 )</span><br><span class="line">    &#123;</span><br><span class="line">      method.name = <span class="string">"checkFlag"</span>;</span><br><span class="line">      method.signature = <span class="string">"(Ljava/lang/String;)Z"</span>;</span><br><span class="line">      <span class="keyword">if</span> ( getMethods(env_, &amp;a2a, &amp;v21, <span class="number">0</span>, <span class="string">"com/wuaipojie/crackme01/MainActivity"</span>, method) )</span><br><span class="line">        <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">    &#125;</span><br><span class="line">    v32 = v12;</span><br><span class="line">    v14 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallBooleanMethodA)(env_, v5);<span class="comment">// invoke checkFlag method</span></span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_39;</span><br><span class="line">    ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v12);</span><br><span class="line">    v8 = env_-&gt;functions-&gt;NewStringUTF;</span><br><span class="line">    <span class="keyword">if</span> ( !v14 )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_40;</span><br><span class="line">    v15 = <span class="string">"正确！！！回复你输入的内容到吾爱破解论坛公众号"</span>;            <span class="comment">// correct</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">    ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v12);</span><br><span class="line">    v15 = <span class="string">"flag长度必须为30位"</span>;                       <span class="comment">// flag's length must equal to 30</span></span><br><span class="line">    v8 = env_-&gt;functions-&gt;NewStringUTF;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v16 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">const</span> <span class="keyword">char</span> *))v8)(env_, v15);</span><br><span class="line">    <span class="keyword">if</span> ( v20</span><br><span class="line">      || (method.name = <span class="string">"makeText"</span>,</span><br><span class="line">          method.signature = <span class="string">"(Landroid/content/Context;Ljava/lang/CharSequence;I)Landroid/widget/Toast;"</span>,</span><br><span class="line">          !getMethods(env_, &amp;v27, &amp;v20, <span class="number">1</span>, <span class="string">"android/widget/Toast"</span>, method)) )</span><br><span class="line">    &#123;</span><br><span class="line">      v33 = v16;</span><br><span class="line">      v32 = v5;</span><br><span class="line">      v34 = <span class="number">0</span>;</span><br><span class="line">      v17 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallStaticObjectMethodA)(env_, v27);</span><br><span class="line">      <span class="keyword">if</span> ( !((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">if</span> ( v16 )</span><br><span class="line">          ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v16);</span><br><span class="line">        <span class="keyword">if</span> ( v17 )</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="keyword">if</span> ( method.fnPtr</span><br><span class="line">            || (method.name = <span class="string">"show"</span>,</span><br><span class="line">                method.signature = <span class="string">"()V"</span>,</span><br><span class="line">                !getMethods(env_, &amp;v27, (<span class="keyword">int</span> *)&amp;method.fnPtr, <span class="number">0</span>, <span class="string">"android/widget/Toast"</span>, method)) )</span><br><span class="line">          &#123;</span><br><span class="line">            ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallVoidMethodA)(env_, v17);</span><br><span class="line">            ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">LABEL_38:</span><br><span class="line">          sub_4EC0(env_, <span class="string">"java/lang/NullPointerException"</span>, <span class="string">"NullPointerException"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_39:</span><br><span class="line">    result = _stack_chk_guard - v35;</span><br><span class="line">    <span class="keyword">if</span> ( _stack_chk_guard == v35 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">LABEL_40:</span><br><span class="line">    v15 = <span class="string">"验证错误，继续加油"</span>;                          <span class="comment">// wrong</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>onClick 函数中的内容主要为在点击按钮后获取输入内容，并判断输入的字符串长度是否为 30，然后调用 checkFlag 函数对字符串进行判断。接下来再看看 checkFlag 函数，这个函数比较长，分成几段来看。首先调用了 <code>isDebuggerConnected()</code> 函数，猜测应该是用来反调试：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">method1.name = <span class="string">"isDebuggerConnected"</span>;</span><br><span class="line">method1.signature = <span class="string">"()Z"</span>;</span><br><span class="line"><span class="keyword">if</span> ( !getMethods(env_, &amp;jclass, &amp;jmethodid, <span class="number">1</span>, <span class="string">"android/os/Debug"</span>, method1) )<span class="comment">// anti-debug??</span></span><br><span class="line">&#123;</span><br><span class="line">  t1 = (<span class="keyword">unsigned</span> <span class="keyword">int</span>)&amp;t_;</span><br><span class="line">  v8 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">int</span> *))env_-&gt;functions-&gt;CallStaticBooleanMethodA)(</span><br><span class="line">         env_,</span><br><span class="line">         jclass,</span><br><span class="line">         jmethodid,</span><br><span class="line">         &amp;t_);</span><br><span class="line">  <span class="keyword">if</span> ( !(((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) | v8) )</span><br><span class="line">  &#123;</span><br><span class="line">    key1 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">signed</span> <span class="keyword">int</span>))env_-&gt;functions-&gt;NewByteArray)(env_, <span class="number">9</span>);</span><br><span class="line">    <span class="keyword">if</span> ( !((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_7;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">goto</span> LABEL_4;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来将一串字符串分成三部分（key1 = “thisiskey”，key2 = “52pojie_2020_happy_chinese_new_year”，key3 = “20200125”）并分给了三个变量：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">v6 = <span class="number">0</span>;</span><br><span class="line">((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, _DWORD, <span class="keyword">signed</span> <span class="keyword">int</span>, <span class="keyword">const</span> <span class="keyword">char</span> *))env_-&gt;functions-&gt;SetByteArrayRegion)(</span><br><span class="line">  env_,</span><br><span class="line">  key1,</span><br><span class="line">  <span class="number">0</span>,</span><br><span class="line">  <span class="number">9</span>,</span><br><span class="line">  <span class="string">"thisiskey52pojie_2020_happy_chinese_new_year20200125"</span>);<span class="comment">// key1 = "thisiskey"</span></span><br><span class="line">key2 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">signed</span> <span class="keyword">int</span>))env_-&gt;functions-&gt;NewByteArray)(env_, <span class="number">35</span>);</span><br><span class="line"><span class="keyword">if</span> ( !((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">&#123;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, _DWORD, <span class="keyword">signed</span> <span class="keyword">int</span>, <span class="keyword">char</span> *))env_-&gt;functions-&gt;SetByteArrayRegion)(</span><br><span class="line">    env_,</span><br><span class="line">    key2,</span><br><span class="line">    <span class="number">0</span>,</span><br><span class="line">    <span class="number">35</span>,</span><br><span class="line">    <span class="string">"52pojie_2020_happy_chinese_new_year20200125"</span>);<span class="comment">// key2 = "52pojie_2020_happy_chinese_new_year"</span></span><br><span class="line">  key3 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">signed</span> <span class="keyword">int</span>))env_-&gt;functions-&gt;NewByteArray)(env_, <span class="number">8</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = <span class="number">0</span>;</span><br><span class="line">    ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, _DWORD, <span class="keyword">signed</span> <span class="keyword">int</span>, <span class="keyword">char</span> *))env_-&gt;functions-&gt;SetByteArrayRegion)(</span><br><span class="line">      env_,</span><br><span class="line">      key3,</span><br><span class="line">      <span class="number">0</span>,</span><br><span class="line">      <span class="number">8</span>,</span><br><span class="line">      <span class="string">"20200125"</span>);                          <span class="comment">// key3 = "20200125"</span></span><br></pre></td></tr></table></figure>
<p>然后新建了一个 35 位的 Byte 数组，做一个循环，当 i 不为 0 且 i 是 4 的倍数时，下标设置为 <code>(i &gt;&gt; 2) - 1</code>，取 key3 中的值来 append 到数组中；反之，下标设置为 i，取 key2 中的值来 append 到数组中：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">        arr = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">signed</span> <span class="keyword">int</span>))env_-&gt;functions-&gt;NewByteArray)(env_, <span class="number">35</span>);</span><br><span class="line">        <span class="keyword">if</span> ( !((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">        &#123;</span><br><span class="line">          i = <span class="number">0</span>;</span><br><span class="line">          arr_ = arr;</span><br><span class="line">          key1_ = key1;</span><br><span class="line">          <span class="keyword">do</span></span><br><span class="line">          &#123;</span><br><span class="line">            <span class="keyword">if</span> ( !i || i &amp; <span class="number">3</span> )</span><br><span class="line">            &#123;</span><br><span class="line">              <span class="keyword">if</span> ( !key2 )</span><br><span class="line">                <span class="keyword">goto</span> LABEL_41;</span><br><span class="line">              pointer = key2;</span><br><span class="line">              i_ = i;</span><br><span class="line">              GetByteArrayRegion_ = env_-&gt;functions-&gt;GetByteArrayRegion;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>                                <span class="comment">// if i != 0 and i % 4 == 0</span></span><br><span class="line">            &#123;</span><br><span class="line">              pointer = key3;</span><br><span class="line">              <span class="keyword">if</span> ( !key3 )</span><br><span class="line">                <span class="keyword">goto</span> LABEL_41;</span><br><span class="line">              GetByteArrayRegion_ = env_-&gt;functions-&gt;GetByteArrayRegion;</span><br><span class="line">              i_ = (i &gt;&gt; <span class="number">2</span>) - <span class="number">1</span>;                <span class="comment">// 0,1,2,3,4,5,6,7</span></span><br><span class="line">            &#125;</span><br><span class="line">            ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">signed</span> <span class="keyword">int</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span>))GetByteArrayRegion_)(</span><br><span class="line">              env_,</span><br><span class="line">              pointer,</span><br><span class="line">              i_,</span><br><span class="line">              <span class="number">1</span>,</span><br><span class="line">              t1);</span><br><span class="line">            key1 = (<span class="keyword">unsigned</span> __int8)t_;</span><br><span class="line">            <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_4;</span><br><span class="line">            <span class="keyword">if</span> ( !arr_ )</span><br><span class="line">            &#123;</span><br><span class="line">LABEL_41:</span><br><span class="line">              sub_4EC0(env_, <span class="string">"java/lang/NullPointerException"</span>, <span class="string">"NullPointerException"</span>);</span><br><span class="line">              <span class="keyword">goto</span> LABEL_4;</span><br><span class="line">            &#125;</span><br><span class="line">            LOBYTE(t_) = key1;</span><br><span class="line">            ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">signed</span> <span class="keyword">int</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span>))env_-&gt;functions-&gt;SetByteArrayRegion)(</span><br><span class="line">              env_,</span><br><span class="line">              arr_,</span><br><span class="line">              i,</span><br><span class="line">              <span class="number">1</span>,</span><br><span class="line">              t1);</span><br><span class="line">            <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_4;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">while</span> ( i++ &lt; <span class="number">0x22</span> );                 <span class="comment">// for i in range(35)</span></span><br></pre></td></tr></table></figure>
<p>接下来对 byte 数组进行 MD5 哈希，然后取摘要生成 16 位的 byte 数组：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">          md5Str = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">const</span> <span class="keyword">char</span> *))env_-&gt;functions-&gt;NewStringUTF)(env_, <span class="string">"MD5"</span>);</span><br><span class="line">          <span class="keyword">if</span> ( !v47 )</span><br><span class="line">          &#123;</span><br><span class="line">            method2.name = <span class="string">"getInstance"</span>;</span><br><span class="line">            method2.signature = <span class="string">"(Ljava/lang/String;)Ljava/security/MessageDigest;"</span>;</span><br><span class="line">            <span class="keyword">if</span> ( getMethods(env_, &amp;v52, &amp;v47, <span class="number">1</span>, <span class="string">"java/security/MessageDigest"</span>, method2) )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          &#125;</span><br><span class="line">          t_ = md5Str;</span><br><span class="line">          v18 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallStaticObjectMethodA)(env_, v52);<span class="comment">// md5 function</span></span><br><span class="line">          <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          <span class="keyword">if</span> ( md5Str )</span><br><span class="line">            ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, md5Str);</span><br><span class="line">          <span class="keyword">if</span> ( !v18 )</span><br><span class="line">          &#123;</span><br><span class="line">LABEL_87:</span><br><span class="line">            sub_4EC0(env_, <span class="string">"java/lang/NullPointerException"</span>, <span class="string">"NullPointerException"</span>);</span><br><span class="line">            <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="keyword">if</span> ( !v46 )</span><br><span class="line">          &#123;</span><br><span class="line">            method2.name = <span class="string">"digest"</span>;</span><br><span class="line">            method2.signature = <span class="string">"([B)[B"</span>;</span><br><span class="line">            <span class="keyword">if</span> ( getMethods(env_, &amp;v52, &amp;v46, <span class="number">0</span>, <span class="string">"java/security/MessageDigest"</span>, method2) )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          &#125;</span><br><span class="line">          t_ = arr_;</span><br><span class="line">          md5Digest = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallObjectMethodA)(env_, v18);<span class="comment">// get hash digest</span></span><br><span class="line">          <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v18);</span><br><span class="line">          <span class="keyword">if</span> ( !md5Digest )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_87;</span><br></pre></td></tr></table></figure>
<p>然后做一个循环，对数组中的元素和 key1 进行逐位异或：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">len = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;GetArrayLength)(env_, md5Digest);</span><br><span class="line"><span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">idx = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span> ( <span class="number">1</span> )                           <span class="comment">// for i in range(16)</span></span><br><span class="line">&#123;</span><br><span class="line">  t1 = <span class="number">0x38E38E39</span> * (<span class="keyword">unsigned</span> __int64)(<span class="keyword">unsigned</span> <span class="keyword">int</span>)idx &gt;&gt; <span class="number">32</span>;<span class="comment">// div 9? useless</span></span><br><span class="line">  <span class="keyword">if</span> ( idx &gt;= len )</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">signed</span> <span class="keyword">int</span>, <span class="keyword">int</span> *))env_-&gt;functions-&gt;GetByteArrayRegion)(</span><br><span class="line">    env_,</span><br><span class="line">    md5Digest,</span><br><span class="line">    idx,</span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    &amp;t_);</span><br><span class="line">  key1 = (<span class="keyword">unsigned</span> __int8)t_;</span><br><span class="line">  <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">  <span class="keyword">if</span> ( !key1_ )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_87;</span><br><span class="line">  ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span>, <span class="keyword">signed</span> <span class="keyword">int</span>, <span class="keyword">int</span> *))env_-&gt;functions-&gt;GetByteArrayRegion)(</span><br><span class="line">    env_,</span><br><span class="line">    key1_,</span><br><span class="line">    idx % <span class="number">9u</span>,                         <span class="comment">// mod 9</span></span><br><span class="line">    <span class="number">1</span>,</span><br><span class="line">    &amp;t_);</span><br><span class="line">  ch = t_;</span><br><span class="line">  <span class="keyword">if</span> ( !((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">  &#123;</span><br><span class="line">    LOBYTE(t_) = ch ^ key1;           <span class="comment">// xor</span></span><br><span class="line">    ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">signed</span> <span class="keyword">int</span>, <span class="keyword">int</span> *))env_-&gt;functions-&gt;SetByteArrayRegion)(</span><br><span class="line">      env_,</span><br><span class="line">      md5Digest,</span><br><span class="line">      idx,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      &amp;t_);</span><br><span class="line">    <span class="keyword">if</span> ( !((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">    &#123;</span><br><span class="line">      len = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;GetArrayLength)(env_, md5Digest);</span><br><span class="line">      ++idx;</span><br><span class="line">      <span class="keyword">if</span> ( !((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接下来，将得到的 byte 数组逐位转成 hex 字符串，如果小于 0xF，即只有一位，高位补 0。将结果逐位 append 到一个新的字符串中，得到一个 32 位的字符串：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">len__ = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;GetArrayLength)(env_, md5Digest);</span><br><span class="line"><span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">  <span class="keyword">goto</span> LABEL_88;</span><br><span class="line"><span class="keyword">if</span> ( len__ &gt;= <span class="number">1</span> )</span><br><span class="line">&#123;</span><br><span class="line">  j = <span class="number">0</span>;</span><br><span class="line">  classInteger = <span class="string">"java/lang/Integer"</span>;</span><br><span class="line">  toHexString_ = <span class="string">"toHexString"</span>;</span><br><span class="line">  method2.fnPtr = <span class="string">"(I)Ljava/lang/String;"</span>;</span><br><span class="line">  zeroPad = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>, <span class="keyword">int</span>, <span class="keyword">signed</span> <span class="keyword">int</span>, <span class="keyword">int</span> *))env_-&gt;functions-&gt;GetByteArrayRegion)(</span><br><span class="line">      env_,</span><br><span class="line">      md5Digest,</span><br><span class="line">      j,</span><br><span class="line">      <span class="number">1</span>,</span><br><span class="line">      &amp;t_);</span><br><span class="line">    t1 = (<span class="keyword">unsigned</span> __int8)t_;</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( t1 &lt;= <span class="number">0xF</span> )                  <span class="comment">// if x &lt; 0xF then append a zero</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">if</span> ( zeroPad )</span><br><span class="line">        ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, zeroPad);</span><br><span class="line">      zeroPad = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">const</span> <span class="keyword">char</span> *))env_-&gt;functions-&gt;NewStringUTF)(env_, <span class="string">"0"</span>);</span><br><span class="line">      <span class="keyword">if</span> ( !v44 )</span><br><span class="line">      &#123;</span><br><span class="line">        method2.name = <span class="string">"append"</span>;</span><br><span class="line">        method2.signature = <span class="string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span>;</span><br><span class="line">        <span class="keyword">if</span> ( getMethods(env_, &amp;v51, &amp;v44, <span class="number">0</span>, <span class="string">"java/lang/StringBuilder"</span>, method2) )</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      t_ = zeroPad;</span><br><span class="line">      v24 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallObjectMethodA)(env_, v22);<span class="comment">// append zero</span></span><br><span class="line">      <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">if</span> ( v24 )</span><br><span class="line">        ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v24);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( !v43 )</span><br><span class="line">    &#123;</span><br><span class="line">      *(_QWORD *)&amp;method2.name = __PAIR__((<span class="keyword">unsigned</span> <span class="keyword">int</span>)method2.fnPtr, (<span class="keyword">unsigned</span> <span class="keyword">int</span>)toHexString_);</span><br><span class="line">      <span class="keyword">if</span> ( getMethods(env_, &amp;v50, &amp;v43, <span class="number">1</span>, classInteger, method2) )<span class="comment">// get toHexString method</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    t_ = t1;</span><br><span class="line">    t1 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallStaticObjectMethodA)(env_, v50);</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( arr_ )</span><br><span class="line">      ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, arr_);</span><br><span class="line">    <span class="keyword">if</span> ( !v44 )</span><br><span class="line">    &#123;</span><br><span class="line">      method2.name = <span class="string">"append"</span>;</span><br><span class="line">      method2.signature = <span class="string">"(Ljava/lang/String;)Ljava/lang/StringBuilder;"</span>;</span><br><span class="line">      <span class="keyword">if</span> ( getMethods(env_, &amp;v51, &amp;v44, <span class="number">0</span>, <span class="string">"java/lang/StringBuilder"</span>, method2) )</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    t_ = t1;</span><br><span class="line">    key1 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallObjectMethodA)(env_, v22);</span><br><span class="line">    <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">if</span> ( key1 )</span><br><span class="line">      ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, key1);</span><br><span class="line">    ++j;</span><br><span class="line">    arr_ = t1;</span><br><span class="line">    <span class="keyword">if</span> ( j &gt;= len__ )</span><br><span class="line">      <span class="keyword">goto</span> LABEL_75;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>最后将取字符串字符串的 1~31 位作为新的字符串，并与我们的输入进行比较：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( !v42 )</span><br><span class="line">          &#123;</span><br><span class="line">            method2.name = <span class="string">"toString"</span>;</span><br><span class="line">            method2.signature = <span class="string">"()Ljava/lang/String;"</span>;</span><br><span class="line">            <span class="keyword">if</span> ( getMethods(env_, &amp;v51, &amp;v42, <span class="number">0</span>, <span class="string">"java/lang/StringBuilder"</span>, method2) )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          &#125;</span><br><span class="line">          v25 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallObjectMethodA)(env_, v22);<span class="comment">// convert StringBuilder to string</span></span><br><span class="line">          <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v22);</span><br><span class="line">          <span class="keyword">if</span> ( !v25 )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_87;</span><br><span class="line">          <span class="keyword">if</span> ( !v41 )</span><br><span class="line">          &#123;</span><br><span class="line">            method2.name = <span class="string">"substring"</span>;</span><br><span class="line">            method2.signature = <span class="string">"(II)Ljava/lang/String;"</span>;</span><br><span class="line">            <span class="keyword">if</span> ( getMethods(env_, &amp;v49, &amp;v41, <span class="number">0</span>, <span class="string">"java/lang/String"</span>, method2) )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          &#125;</span><br><span class="line">          v55 = <span class="number">31</span>;                             <span class="comment">// slice 1-31</span></span><br><span class="line">          t_ = <span class="number">1</span>;</span><br><span class="line">          v26 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallObjectMethodA)(env_, v25);</span><br><span class="line">          <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          ((<span class="keyword">void</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;DeleteLocalRef)(env_, v25);</span><br><span class="line">          <span class="keyword">if</span> ( !v26 )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_87;</span><br><span class="line">          <span class="keyword">if</span> ( !v40 )</span><br><span class="line">          &#123;</span><br><span class="line">            method2.name = <span class="string">"equals"</span>;</span><br><span class="line">            method2.signature = <span class="string">"(Ljava/lang/Object;)Z"</span>;</span><br><span class="line">            <span class="keyword">if</span> ( getMethods(env_, &amp;v49, &amp;v40, <span class="number">0</span>, <span class="string">"java/lang/String"</span>, method2) )</span><br><span class="line">              <span class="keyword">goto</span> LABEL_88;</span><br><span class="line">          &#125;</span><br><span class="line">          t_ = v39;</span><br><span class="line">          v6 = ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *, <span class="keyword">int</span>))env_-&gt;functions-&gt;CallBooleanMethodA)(env_, v26);<span class="comment">// compare string</span></span><br><span class="line">          <span class="keyword">if</span> ( ((<span class="keyword">int</span> (__fastcall *)(_JNIEnv *))env_-&gt;functions-&gt;ExceptionCheck)(env_) )</span><br><span class="line">            <span class="keyword">goto</span> LABEL_88;</span><br></pre></td></tr></table></figure>
<p>只需要正向地实现就能得到对应的字符串，我这里用 Python 实现了一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">key = <span class="string">'thisiskey52pojie_2020_happy_chinese_new_year20200125'</span></span><br><span class="line">key1 = key[:<span class="number">0x7D</span><span class="number">-0x74</span>]</span><br><span class="line">key2 = key[<span class="number">0x7D</span><span class="number">-0x74</span>:<span class="number">0xA0</span><span class="number">-0x74</span>]</span><br><span class="line">key3 = key[<span class="number">0xA0</span><span class="number">-0x74</span>:]</span><br><span class="line"></span><br><span class="line">arr = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">35</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> i <span class="keyword">or</span> i &amp; <span class="number">3</span>:</span><br><span class="line">        arr += key2[i]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        arr += key3[(i &gt;&gt; <span class="number">2</span>) - <span class="number">1</span>]</span><br><span class="line"><span class="keyword">print</span> arr</span><br><span class="line"></span><br><span class="line">md5str = hashlib.md5(arr).digest()</span><br><span class="line"><span class="keyword">print</span> md5str.encode(<span class="string">'hex'</span>)</span><br><span class="line"></span><br><span class="line">xorlist = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    xorlist.append(ord(key1[i % <span class="number">9</span>]) ^ ord(md5str[i]))</span><br><span class="line"><span class="keyword">print</span> xorlist</span><br><span class="line"></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>):</span><br><span class="line">    flag += hex(xorlist[i])[<span class="number">2</span>:].zfill(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line">flag = flag[<span class="number">1</span>:<span class="number">31</span>]</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="keyword">assert</span> len(flag) == <span class="number">30</span></span><br></pre></td></tr></table></figure>
<p>跑出来后在手机上验证一下结果的正确性：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/10.png" alt="在手机上进行验证"></p>
<p>回复公众号得到口令：</p>
<p><img src="/pics/2020春节-吾爱破解解题领红包活动/11.jpg" alt="得到口令"></p>
<h1 id="【春节】解题领红包之四"><a href="#【春节】解题领红包之四" class="headerlink" title="【春节】解题领红包之四"></a>【春节】解题领红包之四</h1><p>用 jadx 分析，在 <code>onCreate()</code> 函数中，需要输入 uid 和目标字符串，其中 uid 用 0 补齐成 7 位。然后调用在 Native 层实现的 <code>checkSn()</code> 函数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.wuaipojie.crackme02;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> android.os.Bundle;</span><br><span class="line"><span class="keyword">import</span> android.view.View;</span><br><span class="line"><span class="keyword">import</span> android.view.View.OnClickListener;</span><br><span class="line"><span class="keyword">import</span> android.widget.Button;</span><br><span class="line"><span class="keyword">import</span> android.widget.EditText;</span><br><span class="line"><span class="keyword">import</span> android.widget.Toast;</span><br><span class="line"><span class="keyword">import</span> androidx.appcompat.app.AppCompatActivity;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Button btn;</span><br><span class="line">    <span class="keyword">private</span> EditText input_flag;</span><br><span class="line">    <span class="keyword">private</span> EditText input_uid;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">native</span> <span class="keyword">boolean</span> <span class="title">checkSn</span><span class="params">(String str, String str2)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.loadLibrary(<span class="string">"xtian"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle bundle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(bundle);</span><br><span class="line">        setContentView((<span class="keyword">int</span>) R.layout.activity_main);</span><br><span class="line">        <span class="keyword">this</span>.input_uid = (EditText) findViewById(R.id.input_uid);</span><br><span class="line">        <span class="keyword">this</span>.input_flag = (EditText) findViewById(R.id.input_flag);</span><br><span class="line">        Button button = (Button) findViewById(R.id.button);</span><br><span class="line">        <span class="keyword">this</span>.btn = button;</span><br><span class="line">        button.setOnClickListener(<span class="keyword">new</span> OnClickListener() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View view)</span> </span>&#123;</span><br><span class="line">                view = MainActivity.<span class="keyword">this</span>.input_uid.getText().toString().trim();</span><br><span class="line">                <span class="keyword">if</span> (view.length() &lt; <span class="number">7</span>) &#123;</span><br><span class="line">                    <span class="keyword">int</span> length = <span class="number">7</span> - view.length();</span><br><span class="line">                    StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">                    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">                        stringBuilder.append(<span class="string">"0"</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    StringBuilder stringBuilder2 = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">                    stringBuilder2.append(stringBuilder.toString());</span><br><span class="line">                    stringBuilder2.append(view);</span><br><span class="line">                    view = stringBuilder2.toString();</span><br><span class="line">                &#125;</span><br><span class="line">                MainActivity mainActivity = MainActivity.<span class="keyword">this</span>;</span><br><span class="line">                <span class="keyword">if</span> (mainActivity.checkSn(view, mainActivity.input_flag.getText().toString().trim()) != <span class="keyword">null</span>) &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"\u6b63\u786e\uff01\uff01\uff01\u8bf7\u628a\u7ed3\u679c\u76f4\u63a5\u63d0\u4ea4\u5230\u8bba\u575b\u9886\u53d6\u5956\u52b1\u5427"</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    Toast.makeText(MainActivity.<span class="keyword">this</span>, <span class="string">"\u9a8c\u8bc1\u9519\u8bef\uff0c\u7ee7\u7eed\u52a0\u6cb9"</span>, <span class="number">0</span>).show();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>把 unicode 输出，可以看到通过了 <code>checkSn</code> 的检测就成功了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">In [1]: print u&quot;\u6b63\u786e\uff01\uff01\uff01\u8bf7\u628a\u7ed3\u679c\u76f4\u63a5\u63d0\u4ea4\u5230\u8bba\u575b\u9886\u53d6\u5956\u52b1\u5427&quot;</span><br><span class="line">正确！！！请把结果直接提交到论坛领取奖励吧</span><br><span class="line"></span><br><span class="line">In [2]: print u&quot;\u9a8c\u8bc1\u9519\u8bef\uff0c\u7ee7\u7eed\u52a0\u6cb9&quot;</span><br><span class="line">验证错误，继续加油</span><br></pre></td></tr></table></figure>
<p>接下来打开 IDA 分析一下 so 文件。没有找到 checkSn 函数，基本上都被混淆了，说明函数是被动态注册的。JNI_OnLoad 的部分：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span> __fastcall __<span class="function">noreturn <span class="title">JNI_OnLoad</span><span class="params">(_JavaVM *vm)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  _JavaVM *vm_; <span class="comment">// r11</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v2; <span class="comment">// r2</span></span><br><span class="line">  <span class="keyword">int</span> v3; <span class="comment">// lr</span></span><br><span class="line">  <span class="keyword">int</span> (__fastcall *v4)(_JavaVM *, <span class="keyword">int</span> *, <span class="keyword">signed</span> <span class="keyword">int</span>); <span class="comment">// r4</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// lr</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> i; <span class="comment">// r12</span></span><br><span class="line">  <span class="keyword">int</span> v7; <span class="comment">// [sp+8h] [bp-C0h]</span></span><br><span class="line">  <span class="keyword">int</span> *v8; <span class="comment">// [sp+10h] [bp-B8h]</span></span><br><span class="line">  <span class="keyword">int</span> v9; <span class="comment">// [sp+18h] [bp-B0h]</span></span><br><span class="line">  <span class="keyword">int</span> v10; <span class="comment">// [sp+20h] [bp-A8h]</span></span><br><span class="line">  <span class="keyword">int</span> v11; <span class="comment">// [sp+28h] [bp-A0h]</span></span><br><span class="line">  <span class="keyword">int</span> v12; <span class="comment">// [sp+30h] [bp-98h]</span></span><br><span class="line">  <span class="keyword">int</span> *v13; <span class="comment">// [sp+38h] [bp-90h]</span></span><br><span class="line">  <span class="keyword">int</span> v14; <span class="comment">// [sp+40h] [bp-88h]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> v15; <span class="comment">// [sp+48h] [bp-80h]</span></span><br><span class="line">  <span class="keyword">int</span> v16; <span class="comment">// [sp+50h] [bp-78h]</span></span><br><span class="line">  <span class="keyword">int</span> *v17; <span class="comment">// [sp+7Ch] [bp-4Ch]</span></span><br><span class="line">  <span class="keyword">void</span> *v18; <span class="comment">// [sp+80h] [bp-48h]</span></span><br><span class="line">  <span class="keyword">int</span> *v19; <span class="comment">// [sp+84h] [bp-44h]</span></span><br><span class="line">  <span class="keyword">int</span> *v20; <span class="comment">// [sp+88h] [bp-40h]</span></span><br><span class="line">  <span class="keyword">int</span> *v21; <span class="comment">// [sp+8Ch] [bp-3Ch]</span></span><br><span class="line">  <span class="keyword">int</span> *v22; <span class="comment">// [sp+90h] [bp-38h]</span></span><br><span class="line">  <span class="keyword">int</span> *v23; <span class="comment">// [sp+94h] [bp-34h]</span></span><br><span class="line">  <span class="keyword">int</span> *v24; <span class="comment">// [sp+98h] [bp-30h]</span></span><br><span class="line">  <span class="keyword">void</span> **v25; <span class="comment">// [sp+9Ch] [bp-2Ch]</span></span><br><span class="line">  <span class="keyword">signed</span> <span class="keyword">int</span> *v26; <span class="comment">// [sp+A0h] [bp-28h]</span></span><br><span class="line"></span><br><span class="line">  vm_ = vm;</span><br><span class="line">  v23 = &amp;Oo0O_8;</span><br><span class="line">  v24 = &amp;O0OO_9;</span><br><span class="line">  v18 = &amp;_stack_chk_guard;</span><br><span class="line">  v2 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> ( O0OO_9 &lt; <span class="number">10</span> )</span><br><span class="line">    v2 = <span class="number">1</span>;</span><br><span class="line">  v3 = v2 | ~((Oo0O_8 - <span class="number">1</span>) * Oo0O_8) &amp; <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">if</span> ( v3 != <span class="number">1</span> )</span><br><span class="line">    <span class="keyword">goto</span> LABEL_5;</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    v26 = &amp;v15;</span><br><span class="line">    v15 = <span class="number">0x58D3C185</span>;</span><br><span class="line">    v12 = <span class="number">0x58D3C185</span>;</span><br><span class="line">    v13 = &amp;v10;</span><br><span class="line">    <span class="keyword">if</span> ( v3 )</span><br><span class="line">    &#123;</span><br><span class="line">      v22 = &amp;v11;</span><br><span class="line">      v17 = (<span class="keyword">int</span> *)&amp;v13;</span><br><span class="line">      v20 = &amp;v16;</span><br><span class="line">      v21 = &amp;v12;</span><br><span class="line">      v4 = (<span class="keyword">int</span> (__fastcall *)(_JavaVM *, <span class="keyword">int</span> *, <span class="keyword">signed</span> <span class="keyword">int</span>))(*((_DWORD *)off_1D7B0 + <span class="number">0x1FEC2733</span>) - <span class="number">0x58D3C184</span>);</span><br><span class="line">      v14 = v4(vm, &amp;v10, <span class="number">0x10004</span>);</span><br><span class="line">      v5 = *v23;</span><br><span class="line">      <span class="keyword">for</span> ( i = *v24; *v24 &gt;= <span class="number">10</span> &amp;&amp; ((_BYTE)v5 - <span class="number">1</span>) * (_BYTE)v5 &amp; <span class="number">1</span>; i = *v24 )</span><br><span class="line">      &#123;</span><br><span class="line">        v14 = v4(vm_, &amp;v10, <span class="number">0x10004</span>);</span><br><span class="line">        v14 = v4(vm_, &amp;v10, <span class="number">0x10004</span>);</span><br><span class="line">        v5 = *v23;</span><br><span class="line">      &#125;</span><br><span class="line">      v19 = &amp;v14;</span><br><span class="line">      v25 = &amp;off_1D7B0;</span><br><span class="line">      <span class="keyword">if</span> ( i &lt; <span class="number">10</span> || !(((_BYTE)v5 - <span class="number">1</span>) * (_BYTE)v5 &amp; <span class="number">1</span>) )</span><br><span class="line">        JUMPOUT(__CS__, *((_DWORD *)off_1D7B4 + <span class="number">0x1FEC27A2</span>) - <span class="number">0x49F16B40</span>);</span><br><span class="line">      <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">        ;</span><br><span class="line">    &#125;</span><br><span class="line">LABEL_5:</span><br><span class="line">    v9 = <span class="number">0x58D3C185</span>;</span><br><span class="line">    v8 = &amp;v7;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>TODO:</p>
<h1 id="References"><a href="#References" class="headerlink" title="References"></a>References</h1><p><a href="https://www.52pojie.cn/thread-732955-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-732955-1-1.html</a><br><a href="https://www.52pojie.cn/thread-749955-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-749955-1-1.html</a><br><a href="https://stackoverflow.com/questions/27260524/need-explanation-on-assembly-instructions-of-kr-fahr-to-cels-example" target="_blank" rel="noopener">https://stackoverflow.com/questions/27260524/need-explanation-on-assembly-instructions-of-kr-fahr-to-cels-example</a><br><a href="https://www.52pojie.cn/thread-1101266-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-1101266-1-1.html</a><br><a href="https://www.bodkin.ren/index.php/archives/533/" target="_blank" rel="noopener">https://www.bodkin.ren/index.php/archives/533/</a><br><a href="https://www.52pojie.cn/thread-778654-1-1.html" target="_blank" rel="noopener">https://www.52pojie.cn/thread-778654-1-1.html</a></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/re/">re</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/">wp</a></li></ul>

      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>



      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2020/02/12/Android逆向入门（三）/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Android逆向入门（三）
        
      </div>
    </a>
  
  
    <a href="/2020/02/05/Nexus5刷机、Root并安装Xposed框架/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Nexus5刷机、Root并安装Xposed框架</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    
      <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#【春节】解题领红包之一"><span class="nav-number">1.</span> <span class="nav-text">【春节】解题领红包之一</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#【春节】解题领红包之二"><span class="nav-number">2.</span> <span class="nav-text">【春节】解题领红包之二</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#【春节】解题领红包之三"><span class="nav-number">3.</span> <span class="nav-text">【春节】解题领红包之三</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#【春节】解题领红包之四"><span class="nav-number">4.</span> <span class="nav-text">【春节】解题领红包之四</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#References"><span class="nav-number">5.</span> <span class="nav-text">References</span></a></li></ol>
    
    </div>
  </aside>

</section>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2020 AssassinQ All Rights Reserved.
        
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
      var headerblur = document.getElementById("header-blur");
      headerblur.style.minHeight = window.getComputedStyle(document.getElementById("allheader"), null).height;
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>








  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>
